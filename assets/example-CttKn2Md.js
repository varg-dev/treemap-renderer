function Sv(T,n){for(var b=0;b<n.length;b++){const y=n[b];if(typeof y!="string"&&!Array.isArray(y)){for(const p in y)if(p!=="default"&&!(p in T)){const t=Object.getOwnPropertyDescriptor(y,p);t&&Object.defineProperty(T,p,t.get?t:{enumerable:!0,get:()=>y[p]})}}}return Object.freeze(Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}))}var H=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ov(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var Xf={exports:{}},$u={},Ur={},Hu={},Gr={},Oc;function Ce(){if(Oc)return Gr;Oc=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.isFunction=void 0;function T(n){return typeof n=="function"}return Gr.isFunction=T,Gr}var Vt={},qr={},Wr={},Rc;function yr(){if(Rc)return Wr;Rc=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.createErrorClass=void 0;function T(n){var b=function(p){Error.call(p),p.stack=new Error().stack},y=n(b);return y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y}return Wr.createErrorClass=T,Wr}var wc;function Yf(){if(wc)return qr;wc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.UnsubscriptionError=void 0;var T=yr();return qr.UnsubscriptionError=T.createErrorClass(function(n){return function(y){n(this),this.message=y?y.length+` errors occurred during unsubscription:
`+y.map(function(p,t){return t+1+") "+p.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=y}}),qr}var Vr={},Pc;function Zt(){if(Pc)return Vr;Pc=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.arrRemove=void 0;function T(n,b){if(n){var y=n.indexOf(b);0<=y&&n.splice(y,1)}}return Vr.arrRemove=T,Vr}var Lc;function Ot(){if(Lc)return Vt;Lc=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},n=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,o=[],u;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)o.push(s.value)}catch(m){u={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return o},b=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.isSubscription=Vt.EMPTY_SUBSCRIPTION=Vt.Subscription=void 0;var y=Ce(),p=Yf(),t=Zt(),i=function(){function c(f){this.initialTeardown=f,this.closed=!1,this._parentage=null,this._finalizers=null}return c.prototype.unsubscribe=function(){var f,d,h,s,o;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var m=T(u),v=m.next();!v.done;v=m.next()){var _=v.value;_.remove(this)}}catch(R){f={error:R}}finally{try{v&&!v.done&&(d=m.return)&&d.call(m)}finally{if(f)throw f.error}}else u.remove(this);var g=this.initialTeardown;if(y.isFunction(g))try{g()}catch(R){o=R instanceof p.UnsubscriptionError?R.errors:[R]}var x=this._finalizers;if(x){this._finalizers=null;try{for(var E=T(x),w=E.next();!w.done;w=E.next()){var S=w.value;try{r(S)}catch(R){o=o??[],R instanceof p.UnsubscriptionError?o=b(b([],n(o)),n(R.errors)):o.push(R)}}}catch(R){h={error:R}}finally{try{w&&!w.done&&(s=E.return)&&s.call(E)}finally{if(h)throw h.error}}}if(o)throw new p.UnsubscriptionError(o)}},c.prototype.add=function(f){var d;if(f&&f!==this)if(this.closed)r(f);else{if(f instanceof c){if(f.closed||f._hasParent(this))return;f._addParent(this)}(this._finalizers=(d=this._finalizers)!==null&&d!==void 0?d:[]).push(f)}},c.prototype._hasParent=function(f){var d=this._parentage;return d===f||Array.isArray(d)&&d.includes(f)},c.prototype._addParent=function(f){var d=this._parentage;this._parentage=Array.isArray(d)?(d.push(f),d):d?[d,f]:f},c.prototype._removeParent=function(f){var d=this._parentage;d===f?this._parentage=null:Array.isArray(d)&&t.arrRemove(d,f)},c.prototype.remove=function(f){var d=this._finalizers;d&&t.arrRemove(d,f),f instanceof c&&f._removeParent(this)},c.EMPTY=function(){var f=new c;return f.closed=!0,f}(),c}();Vt.Subscription=i,Vt.EMPTY_SUBSCRIPTION=i.EMPTY;function a(c){return c instanceof i||c&&"closed"in c&&y.isFunction(c.remove)&&y.isFunction(c.add)&&y.isFunction(c.unsubscribe)}Vt.isSubscription=a;function r(c){y.isFunction(c)?c():c.unsubscribe()}return Vt}var $r={},Mc;function ys(){return Mc||(Mc=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.config=void 0,$r.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}),$r}var Hr={},Xu={},Ic;function Zf(){return Ic||(Ic=1,function(T){var n=H&&H.__read||function(y,p){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),a,r=[],c;try{for(;(p===void 0||p-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(f){c={error:f}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return r},b=H&&H.__spreadArray||function(y,p){for(var t=0,i=p.length,a=y.length;t<i;t++,a++)y[a]=p[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.timeoutProvider=void 0,T.timeoutProvider={setTimeout:function(y,p){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var a=T.timeoutProvider.delegate;return a!=null&&a.setTimeout?a.setTimeout.apply(a,b([y,p],n(t))):setTimeout.apply(void 0,b([y,p],n(t)))},clearTimeout:function(y){var p=T.timeoutProvider.delegate;return((p==null?void 0:p.clearTimeout)||clearTimeout)(y)},delegate:void 0}}(Xu)),Xu}var Fc;function Kf(){if(Fc)return Hr;Fc=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.reportUnhandledError=void 0;var T=ys(),n=Zf();function b(y){n.timeoutProvider.setTimeout(function(){var p=T.config.onUnhandledError;if(p)p(y);else throw y})}return Hr.reportUnhandledError=b,Hr}var Xr={},Cc;function ut(){if(Cc)return Xr;Cc=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.noop=void 0;function T(){}return Xr.noop=T,Xr}var Ft={},Nc;function Rv(){if(Nc)return Ft;Nc=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.createNotification=Ft.nextNotification=Ft.errorNotification=Ft.COMPLETE_NOTIFICATION=void 0,Ft.COMPLETE_NOTIFICATION=function(){return b("C",void 0,void 0)}();function T(y){return b("E",void 0,y)}Ft.errorNotification=T;function n(y){return b("N",y,void 0)}Ft.nextNotification=n;function b(y,p,t){return{kind:y,value:p,error:t}}return Ft.createNotification=b,Ft}var er={},zc;function ml(){if(zc)return er;zc=1,Object.defineProperty(er,"__esModule",{value:!0}),er.captureError=er.errorContext=void 0;var T=ys(),n=null;function b(p){if(T.config.useDeprecatedSynchronousErrorHandling){var t=!n;if(t&&(n={errorThrown:!1,error:null}),p(),t){var i=n,a=i.errorThrown,r=i.error;if(n=null,a)throw r}}else p()}er.errorContext=b;function y(p){T.config.useDeprecatedSynchronousErrorHandling&&n&&(n.errorThrown=!0,n.error=p)}return er.captureError=y,er}var Bc;function Es(){return Bc||(Bc=1,function(T){var n=H&&H.__extends||function(){var _=function(g,x){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,w){E.__proto__=w}||function(E,w){for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(E[S]=w[S])},_(g,x)};return function(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");_(g,x);function E(){this.constructor=g}g.prototype=x===null?Object.create(x):(E.prototype=x.prototype,new E)}}();Object.defineProperty(T,"__esModule",{value:!0}),T.EMPTY_OBSERVER=T.SafeSubscriber=T.Subscriber=void 0;var b=Ce(),y=Ot(),p=ys(),t=Kf(),i=ut(),a=Rv(),r=Zf(),c=ml(),f=function(_){n(g,_);function g(x){var E=_.call(this)||this;return E.isStopped=!1,x?(E.destination=x,y.isSubscription(x)&&x.add(E)):E.destination=T.EMPTY_OBSERVER,E}return g.create=function(x,E,w){return new o(x,E,w)},g.prototype.next=function(x){this.isStopped?v(a.nextNotification(x),this):this._next(x)},g.prototype.error=function(x){this.isStopped?v(a.errorNotification(x),this):(this.isStopped=!0,this._error(x))},g.prototype.complete=function(){this.isStopped?v(a.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},g.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_.prototype.unsubscribe.call(this),this.destination=null)},g.prototype._next=function(x){this.destination.next(x)},g.prototype._error=function(x){try{this.destination.error(x)}finally{this.unsubscribe()}},g.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},g}(y.Subscription);T.Subscriber=f;var d=Function.prototype.bind;function h(_,g){return d.call(_,g)}var s=function(){function _(g){this.partialObserver=g}return _.prototype.next=function(g){var x=this.partialObserver;if(x.next)try{x.next(g)}catch(E){u(E)}},_.prototype.error=function(g){var x=this.partialObserver;if(x.error)try{x.error(g)}catch(E){u(E)}else u(g)},_.prototype.complete=function(){var g=this.partialObserver;if(g.complete)try{g.complete()}catch(x){u(x)}},_}(),o=function(_){n(g,_);function g(x,E,w){var S=_.call(this)||this,R;if(b.isFunction(x)||!x)R={next:x??void 0,error:E??void 0,complete:w??void 0};else{var O;S&&p.config.useDeprecatedNextContext?(O=Object.create(x),O.unsubscribe=function(){return S.unsubscribe()},R={next:x.next&&h(x.next,O),error:x.error&&h(x.error,O),complete:x.complete&&h(x.complete,O)}):R=x}return S.destination=new s(R),S}return g}(f);T.SafeSubscriber=o;function u(_){p.config.useDeprecatedSynchronousErrorHandling?c.captureError(_):t.reportUnhandledError(_)}function m(_){throw _}function v(_,g){var x=p.config.onStoppedNotification;x&&r.timeoutProvider.setTimeout(function(){return x(_,g)})}T.EMPTY_OBSERVER={closed:!0,next:i.noop,error:m,complete:i.noop}}(Hu)),Hu}var Yr={},Dc;function io(){return Dc||(Dc=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.observable=void 0,Yr.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()),Yr}var tr={},Zr={},jc;function lt(){if(jc)return Zr;jc=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.identity=void 0;function T(n){return n}return Zr.identity=T,Zr}var kc;function no(){if(kc)return tr;kc=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.pipeFromArray=tr.pipe=void 0;var T=lt();function n(){for(var y=[],p=0;p<arguments.length;p++)y[p]=arguments[p];return b(y)}tr.pipe=n;function b(y){return y.length===0?T.identity:y.length===1?y[0]:function(t){return y.reduce(function(i,a){return a(i)},t)}}return tr.pipeFromArray=b,tr}var Uc;function ze(){if(Uc)return Ur;Uc=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Observable=void 0;var T=Es(),n=Ot(),b=io(),y=no(),p=ys(),t=Ce(),i=ml(),a=function(){function d(h){h&&(this._subscribe=h)}return d.prototype.lift=function(h){var s=new d;return s.source=this,s.operator=h,s},d.prototype.subscribe=function(h,s,o){var u=this,m=f(h)?h:new T.SafeSubscriber(h,s,o);return i.errorContext(function(){var v=u,_=v.operator,g=v.source;m.add(_?_.call(m,g):g?u._subscribe(m):u._trySubscribe(m))}),m},d.prototype._trySubscribe=function(h){try{return this._subscribe(h)}catch(s){h.error(s)}},d.prototype.forEach=function(h,s){var o=this;return s=r(s),new s(function(u,m){var v=new T.SafeSubscriber({next:function(_){try{h(_)}catch(g){m(g),v.unsubscribe()}},error:m,complete:u});o.subscribe(v)})},d.prototype._subscribe=function(h){var s;return(s=this.source)===null||s===void 0?void 0:s.subscribe(h)},d.prototype[b.observable]=function(){return this},d.prototype.pipe=function(){for(var h=[],s=0;s<arguments.length;s++)h[s]=arguments[s];return y.pipeFromArray(h)(this)},d.prototype.toPromise=function(h){var s=this;return h=r(h),new h(function(o,u){var m;s.subscribe(function(v){return m=v},function(v){return u(v)},function(){return o(m)})})},d.create=function(h){return new d(h)},d}();Ur.Observable=a;function r(d){var h;return(h=d??p.config.Promise)!==null&&h!==void 0?h:Promise}function c(d){return d&&t.isFunction(d.next)&&t.isFunction(d.error)&&t.isFunction(d.complete)}function f(d){return d&&d instanceof T.Subscriber||c(d)&&n.isSubscription(d)}return Ur}var Kr={},Qr={},rr={},Gc;function ie(){if(Gc)return rr;Gc=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.operate=rr.hasLift=void 0;var T=Ce();function n(y){return T.isFunction(y==null?void 0:y.lift)}rr.hasLift=n;function b(y){return function(p){if(n(p))return p.lift(function(t){try{return y(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}return rr.operate=b,rr}var ir={},qc;function ue(){if(qc)return ir;qc=1;var T=H&&H.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(ir,"__esModule",{value:!0}),ir.OperatorSubscriber=ir.createOperatorSubscriber=void 0;var n=Es();function b(p,t,i,a,r){return new y(p,t,i,a,r)}ir.createOperatorSubscriber=b;var y=function(p){T(t,p);function t(i,a,r,c,f,d){var h=p.call(this,i)||this;return h.onFinalize=f,h.shouldUnsubscribe=d,h._next=a?function(s){try{a(s)}catch(o){i.error(o)}}:p.prototype._next,h._error=c?function(s){try{c(s)}catch(o){i.error(o)}finally{this.unsubscribe()}}:p.prototype._error,h._complete=r?function(){try{r()}catch(s){i.error(s)}finally{this.unsubscribe()}}:p.prototype._complete,h}return t.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var a=this.closed;p.prototype.unsubscribe.call(this),!a&&((i=this.onFinalize)===null||i===void 0||i.call(this))}},t}(n.Subscriber);return ir.OperatorSubscriber=y,ir}var Wc;function Qf(){if(Wc)return Qr;Wc=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.refCount=void 0;var T=ie(),n=ue();function b(){return T.operate(function(y,p){var t=null;y._refCount++;var i=n.createOperatorSubscriber(p,void 0,void 0,void 0,function(){if(!y||y._refCount<=0||0<--y._refCount){t=null;return}var a=y._connection,r=t;t=null,a&&(!r||a===r)&&a.unsubscribe(),p.unsubscribe()});y.subscribe(i),i.closed||(t=y.connect())})}return Qr.refCount=b,Qr}var Vc;function ao(){if(Vc)return Kr;Vc=1;var T=H&&H.__extends||function(){var a=function(r,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(f[h]=d[h])},a(r,c)};return function(r,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(r,c);function f(){this.constructor=r}r.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)}}();Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.ConnectableObservable=void 0;var n=ze(),b=Ot(),y=Qf(),p=ue(),t=ie(),i=function(a){T(r,a);function r(c,f){var d=a.call(this)||this;return d.source=c,d.subjectFactory=f,d._subject=null,d._refCount=0,d._connection=null,t.hasLift(c)&&(d.lift=c.lift),d}return r.prototype._subscribe=function(c){return this.getSubject().subscribe(c)},r.prototype.getSubject=function(){var c=this._subject;return(!c||c.isStopped)&&(this._subject=this.subjectFactory()),this._subject},r.prototype._teardown=function(){this._refCount=0;var c=this._connection;this._subject=this._connection=null,c==null||c.unsubscribe()},r.prototype.connect=function(){var c=this,f=this._connection;if(!f){f=this._connection=new b.Subscription;var d=this.getSubject();f.add(this.source.subscribe(p.createOperatorSubscriber(d,void 0,function(){c._teardown(),d.complete()},function(h){c._teardown(),d.error(h)},function(){return c._teardown()}))),f.closed&&(this._connection=null,f=b.Subscription.EMPTY)}return f},r.prototype.refCount=function(){return y.refCount()(this)},r}(n.Observable);return Kr.ConnectableObservable=i,Kr}var Jr={},Yu={},$c;function wv(){return $c||($c=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.performanceTimestampProvider=void 0,T.performanceTimestampProvider={now:function(){return(T.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}}(Yu)),Yu}var Zu={},Hc;function Jf(){return Hc||(Hc=1,function(T){var n=H&&H.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(f)throw f.error}}return c},b=H&&H.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrameProvider=void 0;var y=Ot();T.animationFrameProvider={schedule:function(p){var t=requestAnimationFrame,i=cancelAnimationFrame,a=T.animationFrameProvider.delegate;a&&(t=a.requestAnimationFrame,i=a.cancelAnimationFrame);var r=t(function(c){i=void 0,p(c)});return new y.Subscription(function(){return i==null?void 0:i(r)})},requestAnimationFrame:function(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.requestAnimationFrame)||requestAnimationFrame).apply(void 0,b([],n(p)))},cancelAnimationFrame:function(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,b([],n(p)))},delegate:void 0}}(Zu)),Zu}var Xc;function Pv(){if(Xc)return Jr;Xc=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.animationFrames=void 0;var T=ze(),n=wv(),b=Jf();function y(i){return i?p(i):t}Jr.animationFrames=y;function p(i){return new T.Observable(function(a){var r=i||n.performanceTimestampProvider,c=r.now(),f=0,d=function(){a.closed||(f=b.animationFrameProvider.requestAnimationFrame(function(h){f=0;var s=r.now();a.next({timestamp:i?s:h,elapsed:s-c}),d()}))};return d(),function(){f&&b.animationFrameProvider.cancelAnimationFrame(f)}})}var t=p();return Jr}var nr={},ei={},Yc;function e_(){if(Yc)return ei;Yc=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.ObjectUnsubscribedError=void 0;var T=yr();return ei.ObjectUnsubscribedError=T.createErrorClass(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ei}var Zc;function ct(){if(Zc)return nr;Zc=1;var T=H&&H.__extends||function(){var c=function(f,d){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,s){h.__proto__=s}||function(h,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(h[o]=s[o])},c(f,d)};return function(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");c(f,d);function h(){this.constructor=f}f.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),n=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(nr,"__esModule",{value:!0}),nr.AnonymousSubject=nr.Subject=void 0;var b=ze(),y=Ot(),p=e_(),t=Zt(),i=ml(),a=function(c){T(f,c);function f(){var d=c.call(this)||this;return d.closed=!1,d.currentObservers=null,d.observers=[],d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return f.prototype.lift=function(d){var h=new r(this,this);return h.operator=d,h},f.prototype._throwIfClosed=function(){if(this.closed)throw new p.ObjectUnsubscribedError},f.prototype.next=function(d){var h=this;i.errorContext(function(){var s,o;if(h._throwIfClosed(),!h.isStopped){h.currentObservers||(h.currentObservers=Array.from(h.observers));try{for(var u=n(h.currentObservers),m=u.next();!m.done;m=u.next()){var v=m.value;v.next(d)}}catch(_){s={error:_}}finally{try{m&&!m.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}}})},f.prototype.error=function(d){var h=this;i.errorContext(function(){if(h._throwIfClosed(),!h.isStopped){h.hasError=h.isStopped=!0,h.thrownError=d;for(var s=h.observers;s.length;)s.shift().error(d)}})},f.prototype.complete=function(){var d=this;i.errorContext(function(){if(d._throwIfClosed(),!d.isStopped){d.isStopped=!0;for(var h=d.observers;h.length;)h.shift().complete()}})},f.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(f.prototype,"observed",{get:function(){var d;return((d=this.observers)===null||d===void 0?void 0:d.length)>0},enumerable:!1,configurable:!0}),f.prototype._trySubscribe=function(d){return this._throwIfClosed(),c.prototype._trySubscribe.call(this,d)},f.prototype._subscribe=function(d){return this._throwIfClosed(),this._checkFinalizedStatuses(d),this._innerSubscribe(d)},f.prototype._innerSubscribe=function(d){var h=this,s=this,o=s.hasError,u=s.isStopped,m=s.observers;return o||u?y.EMPTY_SUBSCRIPTION:(this.currentObservers=null,m.push(d),new y.Subscription(function(){h.currentObservers=null,t.arrRemove(m,d)}))},f.prototype._checkFinalizedStatuses=function(d){var h=this,s=h.hasError,o=h.thrownError,u=h.isStopped;s?d.error(o):u&&d.complete()},f.prototype.asObservable=function(){var d=new b.Observable;return d.source=this,d},f.create=function(d,h){return new r(d,h)},f}(b.Observable);nr.Subject=a;var r=function(c){T(f,c);function f(d,h){var s=c.call(this)||this;return s.destination=d,s.source=h,s}return f.prototype.next=function(d){var h,s;(s=(h=this.destination)===null||h===void 0?void 0:h.next)===null||s===void 0||s.call(h,d)},f.prototype.error=function(d){var h,s;(s=(h=this.destination)===null||h===void 0?void 0:h.error)===null||s===void 0||s.call(h,d)},f.prototype.complete=function(){var d,h;(h=(d=this.destination)===null||d===void 0?void 0:d.complete)===null||h===void 0||h.call(d)},f.prototype._subscribe=function(d){var h,s;return(s=(h=this.source)===null||h===void 0?void 0:h.subscribe(d))!==null&&s!==void 0?s:y.EMPTY_SUBSCRIPTION},f}(a);return nr.AnonymousSubject=r,nr}var ti={},Kc;function t_(){if(Kc)return ti;Kc=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ti,"__esModule",{value:!0}),ti.BehaviorSubject=void 0;var n=ct(),b=function(y){T(p,y);function p(t){var i=y.call(this)||this;return i._value=t,i}return Object.defineProperty(p.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),p.prototype._subscribe=function(t){var i=y.prototype._subscribe.call(this,t);return!i.closed&&t.next(this._value),i},p.prototype.getValue=function(){var t=this,i=t.hasError,a=t.thrownError,r=t._value;if(i)throw a;return this._throwIfClosed(),r},p.prototype.next=function(t){y.prototype.next.call(this,this._value=t)},p}(n.Subject);return ti.BehaviorSubject=b,ti}var ri={},Ku={},Qc;function gl(){return Qc||(Qc=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.dateTimestampProvider=void 0,T.dateTimestampProvider={now:function(){return(T.dateTimestampProvider.delegate||Date).now()},delegate:void 0}}(Ku)),Ku}var Jc;function bl(){if(Jc)return ri;Jc=1;var T=H&&H.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(ri,"__esModule",{value:!0}),ri.ReplaySubject=void 0;var n=ct(),b=gl(),y=function(p){T(t,p);function t(i,a,r){i===void 0&&(i=1/0),a===void 0&&(a=1/0),r===void 0&&(r=b.dateTimestampProvider);var c=p.call(this)||this;return c._bufferSize=i,c._windowTime=a,c._timestampProvider=r,c._buffer=[],c._infiniteTimeWindow=!0,c._infiniteTimeWindow=a===1/0,c._bufferSize=Math.max(1,i),c._windowTime=Math.max(1,a),c}return t.prototype.next=function(i){var a=this,r=a.isStopped,c=a._buffer,f=a._infiniteTimeWindow,d=a._timestampProvider,h=a._windowTime;r||(c.push(i),!f&&c.push(d.now()+h)),this._trimBuffer(),p.prototype.next.call(this,i)},t.prototype._subscribe=function(i){this._throwIfClosed(),this._trimBuffer();for(var a=this._innerSubscribe(i),r=this,c=r._infiniteTimeWindow,f=r._buffer,d=f.slice(),h=0;h<d.length&&!i.closed;h+=c?1:2)i.next(d[h]);return this._checkFinalizedStatuses(i),a},t.prototype._trimBuffer=function(){var i=this,a=i._bufferSize,r=i._timestampProvider,c=i._buffer,f=i._infiniteTimeWindow,d=(f?1:2)*a;if(a<1/0&&d<c.length&&c.splice(0,c.length-d),!f){for(var h=r.now(),s=0,o=1;o<c.length&&c[o]<=h;o+=2)s=o;s&&c.splice(0,s+1)}},t}(n.Subject);return ri.ReplaySubject=y,ri}var ii={},eh;function yl(){if(eh)return ii;eh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ii,"__esModule",{value:!0}),ii.AsyncSubject=void 0;var n=ct(),b=function(y){T(p,y);function p(){var t=y!==null&&y.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return p.prototype._checkFinalizedStatuses=function(t){var i=this,a=i.hasError,r=i._hasValue,c=i._value,f=i.thrownError,d=i.isStopped,h=i._isComplete;a?t.error(f):(d||h)&&(r&&t.next(c),t.complete())},p.prototype.next=function(t){this.isStopped||(this._value=t,this._hasValue=!0)},p.prototype.complete=function(){var t=this,i=t._hasValue,a=t._value,r=t._isComplete;r||(this._isComplete=!0,i&&y.prototype.next.call(this,a),y.prototype.complete.call(this))},p}(n.Subject);return ii.AsyncSubject=b,ii}var Qu={},ni={},ai={},si={},th;function Lv(){if(th)return si;th=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(si,"__esModule",{value:!0}),si.Action=void 0;var n=Ot(),b=function(y){T(p,y);function p(t,i){return y.call(this)||this}return p.prototype.schedule=function(t,i){return this},p}(n.Subscription);return si.Action=b,si}var Ju={},rh;function Mv(){return rh||(rh=1,function(T){var n=H&&H.__read||function(y,p){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),a,r=[],c;try{for(;(p===void 0||p-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(f){c={error:f}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return r},b=H&&H.__spreadArray||function(y,p){for(var t=0,i=p.length,a=y.length;t<i;t++,a++)y[a]=p[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.intervalProvider=void 0,T.intervalProvider={setInterval:function(y,p){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var a=T.intervalProvider.delegate;return a!=null&&a.setInterval?a.setInterval.apply(a,b([y,p],n(t))):setInterval.apply(void 0,b([y,p],n(t)))},clearInterval:function(y){var p=T.intervalProvider.delegate;return((p==null?void 0:p.clearInterval)||clearInterval)(y)},delegate:void 0}}(Ju)),Ju}var ih;function Ts(){if(ih)return ai;ih=1;var T=H&&H.__extends||function(){var t=function(i,a){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,c){r.__proto__=c}||function(r,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(r[f]=c[f])},t(i,a)};return function(i,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");t(i,a);function r(){this.constructor=i}i.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(ai,"__esModule",{value:!0}),ai.AsyncAction=void 0;var n=Lv(),b=Mv(),y=Zt(),p=function(t){T(i,t);function i(a,r){var c=t.call(this,a,r)||this;return c.scheduler=a,c.work=r,c.pending=!1,c}return i.prototype.schedule=function(a,r){var c;if(r===void 0&&(r=0),this.closed)return this;this.state=a;var f=this.id,d=this.scheduler;return f!=null&&(this.id=this.recycleAsyncId(d,f,r)),this.pending=!0,this.delay=r,this.id=(c=this.id)!==null&&c!==void 0?c:this.requestAsyncId(d,this.id,r),this},i.prototype.requestAsyncId=function(a,r,c){return c===void 0&&(c=0),b.intervalProvider.setInterval(a.flush.bind(a,this),c)},i.prototype.recycleAsyncId=function(a,r,c){if(c===void 0&&(c=0),c!=null&&this.delay===c&&this.pending===!1)return r;r!=null&&b.intervalProvider.clearInterval(r)},i.prototype.execute=function(a,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var c=this._execute(a,r);if(c)return c;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(a,r){var c=!1,f;try{this.work(a)}catch(d){c=!0,f=d||new Error("Scheduled action threw falsy error")}if(c)return this.unsubscribe(),f},i.prototype.unsubscribe=function(){if(!this.closed){var a=this,r=a.id,c=a.scheduler,f=c.actions;this.work=this.state=this.scheduler=null,this.pending=!1,y.arrRemove(f,this),r!=null&&(this.id=this.recycleAsyncId(c,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},i}(n.Action);return ai.AsyncAction=p,ai}var el={},ar={},nh;function Iv(){if(nh)return ar;nh=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.TestTools=ar.Immediate=void 0;var T=1,n,b={};function y(p){return p in b?(delete b[p],!0):!1}return ar.Immediate={setImmediate:function(p){var t=T++;return b[t]=!0,n||(n=Promise.resolve()),n.then(function(){return y(t)&&p()}),t},clearImmediate:function(p){y(p)}},ar.TestTools={pending:function(){return Object.keys(b).length}},ar}var ah;function Fv(){return ah||(ah=1,function(T){var n=H&&H.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(a===void 0||a-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},b=H&&H.__spreadArray||function(i,a){for(var r=0,c=a.length,f=i.length;r<c;r++,f++)i[f]=a[r];return i};Object.defineProperty(T,"__esModule",{value:!0}),T.immediateProvider=void 0;var y=Iv(),p=y.Immediate.setImmediate,t=y.Immediate.clearImmediate;T.immediateProvider={setImmediate:function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=T.immediateProvider.delegate;return((r==null?void 0:r.setImmediate)||p).apply(void 0,b([],n(i)))},clearImmediate:function(i){var a=T.immediateProvider.delegate;return((a==null?void 0:a.clearImmediate)||t)(i)},delegate:void 0}}(el)),el}var sh;function Cv(){if(sh)return ni;sh=1;var T=H&&H.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(ni,"__esModule",{value:!0}),ni.AsapAction=void 0;var n=Ts(),b=Fv(),y=function(p){T(t,p);function t(i,a){var r=p.call(this,i,a)||this;return r.scheduler=i,r.work=a,r}return t.prototype.requestAsyncId=function(i,a,r){return r===void 0&&(r=0),r!==null&&r>0?p.prototype.requestAsyncId.call(this,i,a,r):(i.actions.push(this),i._scheduled||(i._scheduled=b.immediateProvider.setImmediate(i.flush.bind(i,void 0))))},t.prototype.recycleAsyncId=function(i,a,r){var c;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return p.prototype.recycleAsyncId.call(this,i,a,r);var f=i.actions;a!=null&&((c=f[f.length-1])===null||c===void 0?void 0:c.id)!==a&&(b.immediateProvider.clearImmediate(a),i._scheduled===a&&(i._scheduled=void 0))},t}(n.AsyncAction);return ni.AsapAction=y,ni}var oi={},ui={},li={},oh;function r_(){if(oh)return li;oh=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Scheduler=void 0;var T=gl(),n=function(){function b(y,p){p===void 0&&(p=b.now),this.schedulerActionCtor=y,this.now=p}return b.prototype.schedule=function(y,p,t){return p===void 0&&(p=0),new this.schedulerActionCtor(this,y).schedule(t,p)},b.now=T.dateTimestampProvider.now,b}();return li.Scheduler=n,li}var uh;function xs(){if(uh)return ui;uh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ui,"__esModule",{value:!0}),ui.AsyncScheduler=void 0;var n=r_(),b=function(y){T(p,y);function p(t,i){i===void 0&&(i=n.Scheduler.now);var a=y.call(this,t,i)||this;return a.actions=[],a._active=!1,a}return p.prototype.flush=function(t){var i=this.actions;if(this._active){i.push(t);return}var a;this._active=!0;do if(a=t.execute(t.state,t.delay))break;while(t=i.shift());if(this._active=!1,a){for(;t=i.shift();)t.unsubscribe();throw a}},p}(n.Scheduler);return ui.AsyncScheduler=b,ui}var lh;function Nv(){if(lh)return oi;lh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(oi,"__esModule",{value:!0}),oi.AsapScheduler=void 0;var n=xs(),b=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var a=this.actions,r;t=t||a.shift();do if(r=t.execute(t.state,t.delay))break;while((t=a[0])&&t.id===i&&a.shift());if(this._active=!1,r){for(;(t=a[0])&&t.id===i&&a.shift();)t.unsubscribe();throw r}},p}(n.AsyncScheduler);return oi.AsapScheduler=b,oi}var ch;function zv(){return ch||(ch=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.asap=T.asapScheduler=void 0;var n=Cv(),b=Nv();T.asapScheduler=new b.AsapScheduler(n.AsapAction),T.asap=T.asapScheduler}(Qu)),Qu}var tl={},hh;function Tt(){return hh||(hh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.async=T.asyncScheduler=void 0;var n=Ts(),b=xs();T.asyncScheduler=new b.AsyncScheduler(n.AsyncAction),T.async=T.asyncScheduler}(tl)),tl}var rl={},ci={},dh;function Bv(){if(dh)return ci;dh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ci,"__esModule",{value:!0}),ci.QueueAction=void 0;var n=Ts(),b=function(y){T(p,y);function p(t,i){var a=y.call(this,t,i)||this;return a.scheduler=t,a.work=i,a}return p.prototype.schedule=function(t,i){return i===void 0&&(i=0),i>0?y.prototype.schedule.call(this,t,i):(this.delay=i,this.state=t,this.scheduler.flush(this),this)},p.prototype.execute=function(t,i){return i>0||this.closed?y.prototype.execute.call(this,t,i):this._execute(t,i)},p.prototype.requestAsyncId=function(t,i,a){return a===void 0&&(a=0),a!=null&&a>0||a==null&&this.delay>0?y.prototype.requestAsyncId.call(this,t,i,a):(t.flush(this),0)},p}(n.AsyncAction);return ci.QueueAction=b,ci}var hi={},fh;function Dv(){if(fh)return hi;fh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(hi,"__esModule",{value:!0}),hi.QueueScheduler=void 0;var n=xs(),b=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p}(n.AsyncScheduler);return hi.QueueScheduler=b,hi}var _h;function jv(){return _h||(_h=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.queue=T.queueScheduler=void 0;var n=Bv(),b=Dv();T.queueScheduler=new b.QueueScheduler(n.QueueAction),T.queue=T.queueScheduler}(rl)),rl}var il={},di={},ph;function kv(){if(ph)return di;ph=1;var T=H&&H.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(di,"__esModule",{value:!0}),di.AnimationFrameAction=void 0;var n=Ts(),b=Jf(),y=function(p){T(t,p);function t(i,a){var r=p.call(this,i,a)||this;return r.scheduler=i,r.work=a,r}return t.prototype.requestAsyncId=function(i,a,r){return r===void 0&&(r=0),r!==null&&r>0?p.prototype.requestAsyncId.call(this,i,a,r):(i.actions.push(this),i._scheduled||(i._scheduled=b.animationFrameProvider.requestAnimationFrame(function(){return i.flush(void 0)})))},t.prototype.recycleAsyncId=function(i,a,r){var c;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return p.prototype.recycleAsyncId.call(this,i,a,r);var f=i.actions;a!=null&&((c=f[f.length-1])===null||c===void 0?void 0:c.id)!==a&&(b.animationFrameProvider.cancelAnimationFrame(a),i._scheduled=void 0)},t}(n.AsyncAction);return di.AnimationFrameAction=y,di}var fi={},vh;function Uv(){if(vh)return fi;vh=1;var T=H&&H.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(fi,"__esModule",{value:!0}),fi.AnimationFrameScheduler=void 0;var n=xs(),b=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var a=this.actions,r;t=t||a.shift();do if(r=t.execute(t.state,t.delay))break;while((t=a[0])&&t.id===i&&a.shift());if(this._active=!1,r){for(;(t=a[0])&&t.id===i&&a.shift();)t.unsubscribe();throw r}},p}(n.AsyncScheduler);return fi.AnimationFrameScheduler=b,fi}var mh;function Gv(){return mh||(mh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrame=T.animationFrameScheduler=void 0;var n=kv(),b=Uv();T.animationFrameScheduler=new b.AnimationFrameScheduler(n.AnimationFrameAction),T.animationFrame=T.animationFrameScheduler}(il)),il}var sr={},gh;function qv(){if(gh)return sr;gh=1;var T=H&&H.__extends||function(){var i=function(a,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(c[d]=f[d])},i(a,r)};return function(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");i(a,r);function c(){this.constructor=a}a.prototype=r===null?Object.create(r):(c.prototype=r.prototype,new c)}}();Object.defineProperty(sr,"__esModule",{value:!0}),sr.VirtualAction=sr.VirtualTimeScheduler=void 0;var n=Ts(),b=Ot(),y=xs(),p=function(i){T(a,i);function a(r,c){r===void 0&&(r=t),c===void 0&&(c=1/0);var f=i.call(this,r,function(){return f.frame})||this;return f.maxFrames=c,f.frame=0,f.index=-1,f}return a.prototype.flush=function(){for(var r=this,c=r.actions,f=r.maxFrames,d,h;(h=c[0])&&h.delay<=f&&(c.shift(),this.frame=h.delay,!(d=h.execute(h.state,h.delay))););if(d){for(;h=c.shift();)h.unsubscribe();throw d}},a.frameTimeFactor=10,a}(y.AsyncScheduler);sr.VirtualTimeScheduler=p;var t=function(i){T(a,i);function a(r,c,f){f===void 0&&(f=r.index+=1);var d=i.call(this,r,c)||this;return d.scheduler=r,d.work=c,d.index=f,d.active=!0,d.index=r.index=f,d}return a.prototype.schedule=function(r,c){if(c===void 0&&(c=0),Number.isFinite(c)){if(!this.id)return i.prototype.schedule.call(this,r,c);this.active=!1;var f=new a(this.scheduler,this.work);return this.add(f),f.schedule(r,c)}else return b.Subscription.EMPTY},a.prototype.requestAsyncId=function(r,c,f){f===void 0&&(f=0),this.delay=r.frame+f;var d=r.actions;return d.push(this),d.sort(a.sortActions),1},a.prototype.recycleAsyncId=function(r,c,f){},a.prototype._execute=function(r,c){if(this.active===!0)return i.prototype._execute.call(this,r,c)},a.sortActions=function(r,c){return r.delay===c.delay?r.index===c.index?0:r.index>c.index?1:-1:r.delay>c.delay?1:-1},a}(n.AsyncAction);return sr.VirtualAction=t,sr}var nl={},al={},bh;function kt(){return bh||(bh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.empty=T.EMPTY=void 0;var n=ze();T.EMPTY=new n.Observable(function(p){return p.complete()});function b(p){return p?y(p):T.EMPTY}T.empty=b;function y(p){return new n.Observable(function(t){return p.schedule(function(){return t.complete()})})}}(al)),al}var _i={},$t={},pi={},yh;function so(){if(yh)return pi;yh=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isScheduler=void 0;var T=Ce();function n(b){return b&&T.isFunction(b.schedule)}return pi.isScheduler=n,pi}var Eh;function xt(){if(Eh)return $t;Eh=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.popNumber=$t.popScheduler=$t.popResultSelector=void 0;var T=Ce(),n=so();function b(i){return i[i.length-1]}function y(i){return T.isFunction(b(i))?i.pop():void 0}$t.popResultSelector=y;function p(i){return n.isScheduler(b(i))?i.pop():void 0}$t.popScheduler=p;function t(i,a){return typeof b(i)=="number"?i.pop():a}return $t.popNumber=t,$t}var vi={},mi={},gi={},st={},bi={},Th;function El(){return Th||(Th=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.isArrayLike=void 0,bi.isArrayLike=function(T){return T&&typeof T.length=="number"&&typeof T!="function"}),bi}var yi={},xh;function i_(){if(xh)return yi;xh=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.isPromise=void 0;var T=Ce();function n(b){return T.isFunction(b==null?void 0:b.then)}return yi.isPromise=n,yi}var Ei={},Ah;function n_(){if(Ah)return Ei;Ah=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.isInteropObservable=void 0;var T=io(),n=Ce();function b(y){return n.isFunction(y[T.observable])}return Ei.isInteropObservable=b,Ei}var Ti={},Sh;function a_(){if(Sh)return Ti;Sh=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.isAsyncIterable=void 0;var T=Ce();function n(b){return Symbol.asyncIterator&&T.isFunction(b==null?void 0:b[Symbol.asyncIterator])}return Ti.isAsyncIterable=n,Ti}var xi={},Oh;function s_(){if(Oh)return xi;Oh=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.createInvalidObservableTypeError=void 0;function T(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}return xi.createInvalidObservableTypeError=T,xi}var Ai={},or={},Rh;function o_(){if(Rh)return or;Rh=1,Object.defineProperty(or,"__esModule",{value:!0}),or.iterator=or.getSymbolIterator=void 0;function T(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}return or.getSymbolIterator=T,or.iterator=T(),or}var wh;function u_(){if(wh)return Ai;wh=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.isIterable=void 0;var T=o_(),n=Ce();function b(y){return n.isFunction(y==null?void 0:y[T.iterator])}return Ai.isIterable=b,Ai}var ur={},Ph;function Tl(){if(Ph)return ur;Ph=1;var T=H&&H.__generator||function(i,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,f,d,h;return h={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function s(u){return function(m){return o([u,m])}}function o(u){if(c)throw new TypeError("Generator is already executing.");for(;r;)try{if(c=1,f&&(d=u[0]&2?f.return:u[0]?f.throw||((d=f.return)&&d.call(f),0):f.next)&&!(d=d.call(f,u[1])).done)return d;switch(f=0,d&&(u=[u[0]&2,d.value]),u[0]){case 0:case 1:d=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,f=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!d||u[1]>d[0]&&u[1]<d[3])){r.label=u[1];break}if(u[0]===6&&r.label<d[1]){r.label=d[1],d=u;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(u);break}d[2]&&r.ops.pop(),r.trys.pop();continue}u=a.call(i,r)}catch(m){u=[6,m],f=0}finally{c=d=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},n=H&&H.__await||function(i){return this instanceof n?(this.v=i,this):new n(i)},b=H&&H.__asyncGenerator||function(i,a,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=r.apply(i,a||[]),f,d=[];return f={},h("next"),h("throw"),h("return"),f[Symbol.asyncIterator]=function(){return this},f;function h(_){c[_]&&(f[_]=function(g){return new Promise(function(x,E){d.push([_,g,x,E])>1||s(_,g)})})}function s(_,g){try{o(c[_](g))}catch(x){v(d[0][3],x)}}function o(_){_.value instanceof n?Promise.resolve(_.value.v).then(u,m):v(d[0][2],_)}function u(_){s("next",_)}function m(_){s("throw",_)}function v(_,g){_(g),d.shift(),d.length&&s(d[0][0],d[0][1])}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.isReadableStreamLike=ur.readableStreamLikeToAsyncGenerator=void 0;var y=Ce();function p(i){return b(this,arguments,function(){var r,c,f,d;return T(this,function(h){switch(h.label){case 0:r=i.getReader(),h.label=1;case 1:h.trys.push([1,,9,10]),h.label=2;case 2:return[4,n(r.read())];case 3:return c=h.sent(),f=c.value,d=c.done,d?[4,n(void 0)]:[3,5];case 4:return[2,h.sent()];case 5:return[4,n(f)];case 6:return[4,h.sent()];case 7:return h.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}ur.readableStreamLikeToAsyncGenerator=p;function t(i){return y.isFunction(i==null?void 0:i.getReader)}return ur.isReadableStreamLike=t,ur}var Lh;function ye(){if(Lh)return st;Lh=1;var T=H&&H.__awaiter||function(S,R,O,I){function D(j){return j instanceof O?j:new O(function(k){k(j)})}return new(O||(O=Promise))(function(j,k){function G(Y){try{K(I.next(Y))}catch(re){k(re)}}function Z(Y){try{K(I.throw(Y))}catch(re){k(re)}}function K(Y){Y.done?j(Y.value):D(Y.value).then(G,Z)}K((I=I.apply(S,R||[])).next())})},n=H&&H.__generator||function(S,R){var O={label:0,sent:function(){if(j[0]&1)throw j[1];return j[1]},trys:[],ops:[]},I,D,j,k;return k={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function G(K){return function(Y){return Z([K,Y])}}function Z(K){if(I)throw new TypeError("Generator is already executing.");for(;O;)try{if(I=1,D&&(j=K[0]&2?D.return:K[0]?D.throw||((j=D.return)&&j.call(D),0):D.next)&&!(j=j.call(D,K[1])).done)return j;switch(D=0,j&&(K=[K[0]&2,j.value]),K[0]){case 0:case 1:j=K;break;case 4:return O.label++,{value:K[1],done:!1};case 5:O.label++,D=K[1],K=[0];continue;case 7:K=O.ops.pop(),O.trys.pop();continue;default:if(j=O.trys,!(j=j.length>0&&j[j.length-1])&&(K[0]===6||K[0]===2)){O=0;continue}if(K[0]===3&&(!j||K[1]>j[0]&&K[1]<j[3])){O.label=K[1];break}if(K[0]===6&&O.label<j[1]){O.label=j[1],j=K;break}if(j&&O.label<j[2]){O.label=j[2],O.ops.push(K);break}j[2]&&O.ops.pop(),O.trys.pop();continue}K=R.call(S,O)}catch(Y){K=[6,Y],D=0}finally{I=j=0}if(K[0]&5)throw K[1];return{value:K[0]?K[1]:void 0,done:!0}}},b=H&&H.__asyncValues||function(S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=S[Symbol.asyncIterator],O;return R?R.call(S):(S=typeof y=="function"?y(S):S[Symbol.iterator](),O={},I("next"),I("throw"),I("return"),O[Symbol.asyncIterator]=function(){return this},O);function I(j){O[j]=S[j]&&function(k){return new Promise(function(G,Z){k=S[j](k),D(G,Z,k.done,k.value)})}}function D(j,k,G,Z){Promise.resolve(Z).then(function(K){j({value:K,done:G})},k)}},y=H&&H.__values||function(S){var R=typeof Symbol=="function"&&Symbol.iterator,O=R&&S[R],I=0;if(O)return O.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&I>=S.length&&(S=void 0),{value:S&&S[I++],done:!S}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(st,"__esModule",{value:!0}),st.fromReadableStreamLike=st.fromAsyncIterable=st.fromIterable=st.fromPromise=st.fromArrayLike=st.fromInteropObservable=st.innerFrom=void 0;var p=El(),t=i_(),i=ze(),a=n_(),r=a_(),c=s_(),f=u_(),d=Tl(),h=Ce(),s=Kf(),o=io();function u(S){if(S instanceof i.Observable)return S;if(S!=null){if(a.isInteropObservable(S))return m(S);if(p.isArrayLike(S))return v(S);if(t.isPromise(S))return _(S);if(r.isAsyncIterable(S))return x(S);if(f.isIterable(S))return g(S);if(d.isReadableStreamLike(S))return E(S)}throw c.createInvalidObservableTypeError(S)}st.innerFrom=u;function m(S){return new i.Observable(function(R){var O=S[o.observable]();if(h.isFunction(O.subscribe))return O.subscribe(R);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}st.fromInteropObservable=m;function v(S){return new i.Observable(function(R){for(var O=0;O<S.length&&!R.closed;O++)R.next(S[O]);R.complete()})}st.fromArrayLike=v;function _(S){return new i.Observable(function(R){S.then(function(O){R.closed||(R.next(O),R.complete())},function(O){return R.error(O)}).then(null,s.reportUnhandledError)})}st.fromPromise=_;function g(S){return new i.Observable(function(R){var O,I;try{for(var D=y(S),j=D.next();!j.done;j=D.next()){var k=j.value;if(R.next(k),R.closed)return}}catch(G){O={error:G}}finally{try{j&&!j.done&&(I=D.return)&&I.call(D)}finally{if(O)throw O.error}}R.complete()})}st.fromIterable=g;function x(S){return new i.Observable(function(R){w(S,R).catch(function(O){return R.error(O)})})}st.fromAsyncIterable=x;function E(S){return x(d.readableStreamLikeToAsyncGenerator(S))}st.fromReadableStreamLike=E;function w(S,R){var O,I,D,j;return T(this,void 0,void 0,function(){var k,G;return n(this,function(Z){switch(Z.label){case 0:Z.trys.push([0,5,6,11]),O=b(S),Z.label=1;case 1:return[4,O.next()];case 2:if(I=Z.sent(),!!I.done)return[3,4];if(k=I.value,R.next(k),R.closed)return[2];Z.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return G=Z.sent(),D={error:G},[3,11];case 6:return Z.trys.push([6,,9,10]),I&&!I.done&&(j=O.return)?[4,j.call(O)]:[3,8];case 7:Z.sent(),Z.label=8;case 8:return[3,10];case 9:if(D)throw D.error;return[7];case 10:return[7];case 11:return R.complete(),[2]}})})}return st}var Si={},Oi={},Mh;function Kt(){if(Mh)return Oi;Mh=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.executeSchedule=void 0;function T(n,b,y,p,t){p===void 0&&(p=0),t===void 0&&(t=!1);var i=b.schedule(function(){y(),t?n.add(this.schedule(null,p)):this.unsubscribe()},p);if(n.add(i),!t)return i}return Oi.executeSchedule=T,Oi}var Ih;function oo(){if(Ih)return Si;Ih=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.observeOn=void 0;var T=Kt(),n=ie(),b=ue();function y(p,t){return t===void 0&&(t=0),n.operate(function(i,a){i.subscribe(b.createOperatorSubscriber(a,function(r){return T.executeSchedule(a,p,function(){return a.next(r)},t)},function(){return T.executeSchedule(a,p,function(){return a.complete()},t)},function(r){return T.executeSchedule(a,p,function(){return a.error(r)},t)}))})}return Si.observeOn=y,Si}var Ri={},Fh;function uo(){if(Fh)return Ri;Fh=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.subscribeOn=void 0;var T=ie();function n(b,y){return y===void 0&&(y=0),T.operate(function(p,t){t.add(b.schedule(function(){return p.subscribe(t)},y))})}return Ri.subscribeOn=n,Ri}var Ch;function Wv(){if(Ch)return gi;Ch=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.scheduleObservable=void 0;var T=ye(),n=oo(),b=uo();function y(p,t){return T.innerFrom(p).pipe(b.subscribeOn(t),n.observeOn(t))}return gi.scheduleObservable=y,gi}var wi={},Nh;function Vv(){if(Nh)return wi;Nh=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.schedulePromise=void 0;var T=ye(),n=oo(),b=uo();function y(p,t){return T.innerFrom(p).pipe(b.subscribeOn(t),n.observeOn(t))}return wi.schedulePromise=y,wi}var Pi={},zh;function $v(){if(zh)return Pi;zh=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.scheduleArray=void 0;var T=ze();function n(b,y){return new T.Observable(function(p){var t=0;return y.schedule(function(){t===b.length?p.complete():(p.next(b[t++]),p.closed||this.schedule())})})}return Pi.scheduleArray=n,Pi}var Li={},Bh;function l_(){if(Bh)return Li;Bh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.scheduleIterable=void 0;var T=ze(),n=o_(),b=Ce(),y=Kt();function p(t,i){return new T.Observable(function(a){var r;return y.executeSchedule(a,i,function(){r=t[n.iterator](),y.executeSchedule(a,i,function(){var c,f,d;try{c=r.next(),f=c.value,d=c.done}catch(h){a.error(h);return}d?a.complete():a.next(f)},0,!0)}),function(){return b.isFunction(r==null?void 0:r.return)&&r.return()}})}return Li.scheduleIterable=p,Li}var Mi={},Dh;function c_(){if(Dh)return Mi;Dh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.scheduleAsyncIterable=void 0;var T=ze(),n=Kt();function b(y,p){if(!y)throw new Error("Iterable cannot be null");return new T.Observable(function(t){n.executeSchedule(t,p,function(){var i=y[Symbol.asyncIterator]();n.executeSchedule(t,p,function(){i.next().then(function(a){a.done?t.complete():t.next(a.value)})},0,!0)})})}return Mi.scheduleAsyncIterable=b,Mi}var Ii={},jh;function Hv(){if(jh)return Ii;jh=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.scheduleReadableStreamLike=void 0;var T=c_(),n=Tl();function b(y,p){return T.scheduleAsyncIterable(n.readableStreamLikeToAsyncGenerator(y),p)}return Ii.scheduleReadableStreamLike=b,Ii}var kh;function h_(){if(kh)return mi;kh=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.scheduled=void 0;var T=Wv(),n=Vv(),b=$v(),y=l_(),p=c_(),t=n_(),i=i_(),a=El(),r=u_(),c=a_(),f=s_(),d=Tl(),h=Hv();function s(o,u){if(o!=null){if(t.isInteropObservable(o))return T.scheduleObservable(o,u);if(a.isArrayLike(o))return b.scheduleArray(o,u);if(i.isPromise(o))return n.schedulePromise(o,u);if(c.isAsyncIterable(o))return p.scheduleAsyncIterable(o,u);if(r.isIterable(o))return y.scheduleIterable(o,u);if(d.isReadableStreamLike(o))return h.scheduleReadableStreamLike(o,u)}throw f.createInvalidObservableTypeError(o)}return mi.scheduled=s,mi}var Uh;function Qt(){if(Uh)return vi;Uh=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.from=void 0;var T=h_(),n=ye();function b(y,p){return p?T.scheduled(y,p):n.innerFrom(y)}return vi.from=b,vi}var Gh;function xl(){if(Gh)return _i;Gh=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.of=void 0;var T=xt(),n=Qt();function b(){for(var y=[],p=0;p<arguments.length;p++)y[p]=arguments[p];var t=T.popScheduler(y);return n.from(y,t)}return _i.of=b,_i}var Fi={},qh;function d_(){if(qh)return Fi;qh=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.throwError=void 0;var T=ze(),n=Ce();function b(y,p){var t=n.isFunction(y)?y:function(){return y},i=function(a){return a.error(t())};return new T.Observable(p?function(a){return p.schedule(i,0,a)}:i)}return Fi.throwError=b,Fi}var Wh;function Al(){return Wh||(Wh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.observeNotification=T.Notification=T.NotificationKind=void 0;var n=kt(),b=xl(),y=d_(),p=Ce();(function(a){a.NEXT="N",a.ERROR="E",a.COMPLETE="C"})(T.NotificationKind||(T.NotificationKind={}));var t=function(){function a(r,c,f){this.kind=r,this.value=c,this.error=f,this.hasValue=r==="N"}return a.prototype.observe=function(r){return i(this,r)},a.prototype.do=function(r,c,f){var d=this,h=d.kind,s=d.value,o=d.error;return h==="N"?r==null?void 0:r(s):h==="E"?c==null?void 0:c(o):f==null?void 0:f()},a.prototype.accept=function(r,c,f){var d;return p.isFunction((d=r)===null||d===void 0?void 0:d.next)?this.observe(r):this.do(r,c,f)},a.prototype.toObservable=function(){var r=this,c=r.kind,f=r.value,d=r.error,h=c==="N"?b.of(f):c==="E"?y.throwError(function(){return d}):c==="C"?n.EMPTY:0;if(!h)throw new TypeError("Unexpected notification kind "+c);return h},a.createNext=function(r){return new a("N",r)},a.createError=function(r){return new a("E",void 0,r)},a.createComplete=function(){return a.completeNotification},a.completeNotification=new a("C"),a}();T.Notification=t;function i(a,r){var c,f,d,h=a,s=h.kind,o=h.value,u=h.error;if(typeof s!="string")throw new TypeError('Invalid notification, missing "kind"');s==="N"?(c=r.next)===null||c===void 0||c.call(r,o):s==="E"?(f=r.error)===null||f===void 0||f.call(r,u):(d=r.complete)===null||d===void 0||d.call(r)}T.observeNotification=i}(nl)),nl}var Ci={},Vh;function Xv(){if(Vh)return Ci;Vh=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.isObservable=void 0;var T=ze(),n=Ce();function b(y){return!!y&&(y instanceof T.Observable||n.isFunction(y.lift)&&n.isFunction(y.subscribe))}return Ci.isObservable=b,Ci}var Ni={},zi={},$h;function Er(){if($h)return zi;$h=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.EmptyError=void 0;var T=yr();return zi.EmptyError=T.createErrorClass(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}}),zi}var Hh;function Yv(){if(Hh)return Ni;Hh=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.lastValueFrom=void 0;var T=Er();function n(b,y){var p=typeof y=="object";return new Promise(function(t,i){var a=!1,r;b.subscribe({next:function(c){r=c,a=!0},error:i,complete:function(){a?t(r):p?t(y.defaultValue):i(new T.EmptyError)}})})}return Ni.lastValueFrom=n,Ni}var Bi={},Xh;function Zv(){if(Xh)return Bi;Xh=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.firstValueFrom=void 0;var T=Er(),n=Es();function b(y,p){var t=typeof p=="object";return new Promise(function(i,a){var r=new n.SafeSubscriber({next:function(c){i(c),r.unsubscribe()},error:a,complete:function(){t?i(p.defaultValue):a(new T.EmptyError)}});y.subscribe(r)})}return Bi.firstValueFrom=b,Bi}var Di={},Yh;function f_(){if(Yh)return Di;Yh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.ArgumentOutOfRangeError=void 0;var T=yr();return Di.ArgumentOutOfRangeError=T.createErrorClass(function(n){return function(){n(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}),Di}var ji={},Zh;function __(){if(Zh)return ji;Zh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.NotFoundError=void 0;var T=yr();return ji.NotFoundError=T.createErrorClass(function(n){return function(y){n(this),this.name="NotFoundError",this.message=y}}),ji}var ki={},Kh;function p_(){if(Kh)return ki;Kh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.SequenceError=void 0;var T=yr();return ki.SequenceError=T.createErrorClass(function(n){return function(y){n(this),this.name="SequenceError",this.message=y}}),ki}var sl={},Ui={},Qh;function Sl(){if(Qh)return Ui;Qh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.isValidDate=void 0;function T(n){return n instanceof Date&&!isNaN(n)}return Ui.isValidDate=T,Ui}var Jh;function _l(){return Jh||(Jh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.timeout=T.TimeoutError=void 0;var n=Tt(),b=Sl(),y=ie(),p=ye(),t=yr(),i=ue(),a=Kt();T.TimeoutError=t.createErrorClass(function(f){return function(h){h===void 0&&(h=null),f(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=h}});function r(f,d){var h=b.isValidDate(f)?{first:f}:typeof f=="number"?{each:f}:f,s=h.first,o=h.each,u=h.with,m=u===void 0?c:u,v=h.scheduler,_=v===void 0?d??n.asyncScheduler:v,g=h.meta,x=g===void 0?null:g;if(s==null&&o==null)throw new TypeError("No timeout provided.");return y.operate(function(E,w){var S,R,O=null,I=0,D=function(j){R=a.executeSchedule(w,_,function(){try{S.unsubscribe(),p.innerFrom(m({meta:x,lastValue:O,seen:I})).subscribe(w)}catch(k){w.error(k)}},j)};S=E.subscribe(i.createOperatorSubscriber(w,function(j){R==null||R.unsubscribe(),I++,w.next(O=j),o>0&&D(o)},void 0,void 0,function(){R!=null&&R.closed||R==null||R.unsubscribe(),O=null})),!I&&D(s!=null?typeof s=="number"?s:+s-_.now():o)})}T.timeout=r;function c(f){throw new T.TimeoutError(f)}}(sl)),sl}var Gi={},qi={},Wi={},Vi={},ed;function Tr(){if(ed)return Vi;ed=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.map=void 0;var T=ie(),n=ue();function b(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){i.next(y.call(p,r,a++))}))})}return Vi.map=b,Vi}var td;function xr(){if(td)return Wi;td=1;var T=H&&H.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(a===void 0||a-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},n=H&&H.__spreadArray||function(i,a){for(var r=0,c=a.length,f=i.length;r<c;r++,f++)i[f]=a[r];return i};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.mapOneOrManyArgs=void 0;var b=Tr(),y=Array.isArray;function p(i,a){return y(a)?i.apply(void 0,n([],T(a))):i(a)}function t(i){return b.map(function(a){return p(i,a)})}return Wi.mapOneOrManyArgs=t,Wi}var rd;function v_(){if(rd)return qi;rd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,o=[],u;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)o.push(s.value)}catch(m){u={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return o},n=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(qi,"__esModule",{value:!0}),qi.bindCallbackInternals=void 0;var b=so(),y=ze(),p=uo(),t=xr(),i=oo(),a=yl();function r(c,f,d,h){if(d)if(b.isScheduler(d))h=d;else return function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return r(c,f,h).apply(this,s).pipe(t.mapOneOrManyArgs(d))};return h?function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return r(c,f).apply(this,s).pipe(p.subscribeOn(h),i.observeOn(h))}:function(){for(var s=this,o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var m=new a.AsyncSubject,v=!0;return new y.Observable(function(_){var g=m.subscribe(_);if(v){v=!1;var x=!1,E=!1;f.apply(s,n(n([],T(o)),[function(){for(var w=[],S=0;S<arguments.length;S++)w[S]=arguments[S];if(c){var R=w.shift();if(R!=null){m.error(R);return}}m.next(1<w.length?w:w[0]),E=!0,x&&m.complete()}])),E&&m.complete(),x=!0}return g})}}return qi.bindCallbackInternals=r,qi}var id;function Kv(){if(id)return Gi;id=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.bindCallback=void 0;var T=v_();function n(b,y,p){return T.bindCallbackInternals(!1,b,y,p)}return Gi.bindCallback=n,Gi}var $i={},nd;function Qv(){if(nd)return $i;nd=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.bindNodeCallback=void 0;var T=v_();function n(b,y,p){return T.bindCallbackInternals(!0,b,y,p)}return $i.bindNodeCallback=n,$i}var lr={},Hi={},ad;function m_(){if(ad)return Hi;ad=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.argsArgArrayOrObject=void 0;var T=Array.isArray,n=Object.getPrototypeOf,b=Object.prototype,y=Object.keys;function p(i){if(i.length===1){var a=i[0];if(T(a))return{args:a,keys:null};if(t(a)){var r=y(a);return{args:r.map(function(c){return a[c]}),keys:r}}}return{args:i,keys:null}}Hi.argsArgArrayOrObject=p;function t(i){return i&&typeof i=="object"&&n(i)===b}return Hi}var Xi={},sd;function g_(){if(sd)return Xi;sd=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.createObject=void 0;function T(n,b){return n.reduce(function(y,p,t){return y[p]=b[t],y},{})}return Xi.createObject=T,Xi}var od;function Ol(){if(od)return lr;od=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.combineLatestInit=lr.combineLatest=void 0;var T=ze(),n=m_(),b=Qt(),y=lt(),p=xr(),t=xt(),i=g_(),a=ue(),r=Kt();function c(){for(var h=[],s=0;s<arguments.length;s++)h[s]=arguments[s];var o=t.popScheduler(h),u=t.popResultSelector(h),m=n.argsArgArrayOrObject(h),v=m.args,_=m.keys;if(v.length===0)return b.from([],o);var g=new T.Observable(f(v,o,_?function(x){return i.createObject(_,x)}:y.identity));return u?g.pipe(p.mapOneOrManyArgs(u)):g}lr.combineLatest=c;function f(h,s,o){return o===void 0&&(o=y.identity),function(u){d(s,function(){for(var m=h.length,v=new Array(m),_=m,g=m,x=function(w){d(s,function(){var S=b.from(h[w],s),R=!1;S.subscribe(a.createOperatorSubscriber(u,function(O){v[w]=O,R||(R=!0,g--),g||u.next(o(v.slice()))},function(){--_||u.complete()}))},u)},E=0;E<m;E++)x(E)},u)}}lr.combineLatestInit=f;function d(h,s,o){h?r.executeSchedule(o,h,s):s()}return lr}var Yi={},Zi={},Ki={},Qi={},Ji={},ud;function Rl(){if(ud)return Ji;ud=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.mergeInternals=void 0;var T=ye(),n=Kt(),b=ue();function y(p,t,i,a,r,c,f,d){var h=[],s=0,o=0,u=!1,m=function(){u&&!h.length&&!s&&t.complete()},v=function(g){return s<a?_(g):h.push(g)},_=function(g){c&&t.next(g),s++;var x=!1;T.innerFrom(i(g,o++)).subscribe(b.createOperatorSubscriber(t,function(E){r==null||r(E),c?v(E):t.next(E)},function(){x=!0},void 0,function(){if(x)try{s--;for(var E=function(){var w=h.shift();f?n.executeSchedule(t,f,function(){return _(w)}):_(w)};h.length&&s<a;)E();m()}catch(w){t.error(w)}}))};return p.subscribe(b.createOperatorSubscriber(t,v,function(){u=!0,m()})),function(){d==null||d()}}return Ji.mergeInternals=y,Ji}var ld;function Jt(){if(ld)return Qi;ld=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.mergeMap=void 0;var T=Tr(),n=ye(),b=ie(),y=Rl(),p=Ce();function t(i,a,r){return r===void 0&&(r=1/0),p.isFunction(a)?t(function(c,f){return T.map(function(d,h){return a(c,d,f,h)})(n.innerFrom(i(c,f)))},r):(typeof a=="number"&&(r=a),b.operate(function(c,f){return y.mergeInternals(c,f,i,r)}))}return Qi.mergeMap=t,Qi}var cd;function lo(){if(cd)return Ki;cd=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.mergeAll=void 0;var T=Jt(),n=lt();function b(y){return y===void 0&&(y=1/0),T.mergeMap(n.identity,y)}return Ki.mergeAll=b,Ki}var hd;function wl(){if(hd)return Zi;hd=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.concatAll=void 0;var T=lo();function n(){return T.mergeAll(1)}return Zi.concatAll=n,Zi}var dd;function co(){if(dd)return Yi;dd=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.concat=void 0;var T=wl(),n=xt(),b=Qt();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return T.concatAll()(b.from(p,n.popScheduler(p)))}return Yi.concat=y,Yi}var en={},tn={},fd;function ho(){if(fd)return tn;fd=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.defer=void 0;var T=ze(),n=ye();function b(y){return new T.Observable(function(p){n.innerFrom(y()).subscribe(p)})}return tn.defer=b,tn}var _d;function Jv(){if(_d)return en;_d=1,Object.defineProperty(en,"__esModule",{value:!0}),en.connectable=void 0;var T=ct(),n=ze(),b=ho(),y={connector:function(){return new T.Subject},resetOnDisconnect:!0};function p(t,i){i===void 0&&(i=y);var a=null,r=i.connector,c=i.resetOnDisconnect,f=c===void 0?!0:c,d=r(),h=new n.Observable(function(s){return d.subscribe(s)});return h.connect=function(){return(!a||a.closed)&&(a=b.defer(function(){return t}).subscribe(d),f&&a.add(function(){return d=r()})),a},h}return en.connectable=p,en}var rn={},pd;function em(){if(pd)return rn;pd=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.forkJoin=void 0;var T=ze(),n=m_(),b=ye(),y=xt(),p=ue(),t=xr(),i=g_();function a(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];var f=y.popResultSelector(r),d=n.argsArgArrayOrObject(r),h=d.args,s=d.keys,o=new T.Observable(function(u){var m=h.length;if(!m){u.complete();return}for(var v=new Array(m),_=m,g=m,x=function(w){var S=!1;b.innerFrom(h[w]).subscribe(p.createOperatorSubscriber(u,function(R){S||(S=!0,g--),v[w]=R},function(){return _--},void 0,function(){(!_||!S)&&(g||u.next(s?i.createObject(s,v):v),u.complete())}))},E=0;E<m;E++)x(E)});return f?o.pipe(t.mapOneOrManyArgs(f)):o}return rn.forkJoin=a,rn}var nn={},vd;function tm(){if(vd)return nn;vd=1;var T=H&&H.__read||function(u,m){var v=typeof Symbol=="function"&&u[Symbol.iterator];if(!v)return u;var _=v.call(u),g,x=[],E;try{for(;(m===void 0||m-- >0)&&!(g=_.next()).done;)x.push(g.value)}catch(w){E={error:w}}finally{try{g&&!g.done&&(v=_.return)&&v.call(_)}finally{if(E)throw E.error}}return x};Object.defineProperty(nn,"__esModule",{value:!0}),nn.fromEvent=void 0;var n=ye(),b=ze(),y=Jt(),p=El(),t=Ce(),i=xr(),a=["addListener","removeListener"],r=["addEventListener","removeEventListener"],c=["on","off"];function f(u,m,v,_){if(t.isFunction(v)&&(_=v,v=void 0),_)return f(u,m,v).pipe(i.mapOneOrManyArgs(_));var g=T(o(u)?r.map(function(w){return function(S){return u[w](m,S,v)}}):h(u)?a.map(d(u,m)):s(u)?c.map(d(u,m)):[],2),x=g[0],E=g[1];if(!x&&p.isArrayLike(u))return y.mergeMap(function(w){return f(w,m,v)})(n.innerFrom(u));if(!x)throw new TypeError("Invalid event target");return new b.Observable(function(w){var S=function(){for(var R=[],O=0;O<arguments.length;O++)R[O]=arguments[O];return w.next(1<R.length?R:R[0])};return x(S),function(){return E(S)}})}nn.fromEvent=f;function d(u,m){return function(v){return function(_){return u[v](m,_)}}}function h(u){return t.isFunction(u.addListener)&&t.isFunction(u.removeListener)}function s(u){return t.isFunction(u.on)&&t.isFunction(u.off)}function o(u){return t.isFunction(u.addEventListener)&&t.isFunction(u.removeEventListener)}return nn}var an={},md;function rm(){if(md)return an;md=1,Object.defineProperty(an,"__esModule",{value:!0}),an.fromEventPattern=void 0;var T=ze(),n=Ce(),b=xr();function y(p,t,i){return i?y(p,t).pipe(b.mapOneOrManyArgs(i)):new T.Observable(function(a){var r=function(){for(var f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];return a.next(f.length===1?f[0]:f)},c=p(r);return n.isFunction(t)?function(){return t(r,c)}:void 0})}return an.fromEventPattern=y,an}var sn={},gd;function im(){if(gd)return sn;gd=1;var T=H&&H.__generator||function(i,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,f,d,h;return h={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function s(u){return function(m){return o([u,m])}}function o(u){if(c)throw new TypeError("Generator is already executing.");for(;r;)try{if(c=1,f&&(d=u[0]&2?f.return:u[0]?f.throw||((d=f.return)&&d.call(f),0):f.next)&&!(d=d.call(f,u[1])).done)return d;switch(f=0,d&&(u=[u[0]&2,d.value]),u[0]){case 0:case 1:d=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,f=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!d||u[1]>d[0]&&u[1]<d[3])){r.label=u[1];break}if(u[0]===6&&r.label<d[1]){r.label=d[1],d=u;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(u);break}d[2]&&r.ops.pop(),r.trys.pop();continue}u=a.call(i,r)}catch(m){u=[6,m],f=0}finally{c=d=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(sn,"__esModule",{value:!0}),sn.generate=void 0;var n=lt(),b=so(),y=ho(),p=l_();function t(i,a,r,c,f){var d,h,s,o;arguments.length===1?(d=i,o=d.initialState,a=d.condition,r=d.iterate,h=d.resultSelector,s=h===void 0?n.identity:h,f=d.scheduler):(o=i,!c||b.isScheduler(c)?(s=n.identity,f=c):s=c);function u(){var m;return T(this,function(v){switch(v.label){case 0:m=o,v.label=1;case 1:return!a||a(m)?[4,s(m)]:[3,4];case 2:v.sent(),v.label=3;case 3:return m=r(m),[3,1];case 4:return[2]}})}return y.defer(f?function(){return p.scheduleIterable(u(),f)}:u)}return sn.generate=t,sn}var on={},bd;function nm(){if(bd)return on;bd=1,Object.defineProperty(on,"__esModule",{value:!0}),on.iif=void 0;var T=ho();function n(b,y,p){return T.defer(function(){return b()?y:p})}return on.iif=n,on}var un={},ln={},yd;function Ar(){if(yd)return ln;yd=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.timer=void 0;var T=ze(),n=Tt(),b=so(),y=Sl();function p(t,i,a){t===void 0&&(t=0),a===void 0&&(a=n.async);var r=-1;return i!=null&&(b.isScheduler(i)?a=i:r=i),new T.Observable(function(c){var f=y.isValidDate(t)?+t-a.now():t;f<0&&(f=0);var d=0;return a.schedule(function(){c.closed||(c.next(d++),0<=r?this.schedule(void 0,r):c.complete())},f)})}return ln.timer=p,ln}var Ed;function b_(){if(Ed)return un;Ed=1,Object.defineProperty(un,"__esModule",{value:!0}),un.interval=void 0;var T=Tt(),n=Ar();function b(y,p){return y===void 0&&(y=0),p===void 0&&(p=T.asyncScheduler),y<0&&(y=0),n.timer(y,y,p)}return un.interval=b,un}var cn={},Td;function am(){if(Td)return cn;Td=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.merge=void 0;var T=lo(),n=ye(),b=kt(),y=xt(),p=Qt();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=y.popScheduler(i),c=y.popNumber(i,1/0),f=i;return f.length?f.length===1?n.innerFrom(f[0]):T.mergeAll(c)(p.from(f,r)):b.EMPTY}return cn.merge=t,cn}var ol={},xd;function Ad(){return xd||(xd=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.never=T.NEVER=void 0;var n=ze(),b=ut();T.NEVER=new n.Observable(b.noop);function y(){return T.NEVER}T.never=y}(ol)),ol}var hn={},dn={},Sd;function Pr(){if(Sd)return dn;Sd=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.argsOrArgArray=void 0;var T=Array.isArray;function n(b){return b.length===1&&T(b[0])?b[0]:b}return dn.argsOrArgArray=n,dn}var Od;function y_(){if(Od)return hn;Od=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.onErrorResumeNext=void 0;var T=ze(),n=Pr(),b=ue(),y=ut(),p=ye();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=n.argsOrArgArray(i);return new T.Observable(function(c){var f=0,d=function(){if(f<r.length){var h=void 0;try{h=p.innerFrom(r[f++])}catch{d();return}var s=new b.OperatorSubscriber(c,void 0,y.noop,y.noop);h.subscribe(s),s.add(d)}else c.complete()};d()})}return hn.onErrorResumeNext=t,hn}var fn={},Rd;function sm(){if(Rd)return fn;Rd=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.pairs=void 0;var T=Qt();function n(b,y){return T.from(Object.entries(b),y)}return fn.pairs=n,fn}var _n={},pn={},wd;function om(){if(wd)return pn;wd=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.not=void 0;function T(n,b){return function(y,p){return!n.call(b,y,p)}}return pn.not=T,pn}var vn={},Pd;function Lr(){if(Pd)return vn;Pd=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.filter=void 0;var T=ie(),n=ue();function b(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){return y.call(p,r,a++)&&i.next(r)}))})}return vn.filter=b,vn}var Ld;function um(){if(Ld)return _n;Ld=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.partition=void 0;var T=om(),n=Lr(),b=ye();function y(p,t,i){return[n.filter(t,i)(b.innerFrom(p)),n.filter(T.not(t,i))(b.innerFrom(p))]}return _n.partition=y,_n}var cr={},Md;function E_(){if(Md)return cr;Md=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.raceInit=cr.race=void 0;var T=ze(),n=ye(),b=Pr(),y=ue();function p(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return i=b.argsOrArgArray(i),i.length===1?n.innerFrom(i[0]):new T.Observable(t(i))}cr.race=p;function t(i){return function(a){for(var r=[],c=function(d){r.push(n.innerFrom(i[d]).subscribe(y.createOperatorSubscriber(a,function(h){if(r){for(var s=0;s<r.length;s++)s!==d&&r[s].unsubscribe();r=null}a.next(h)})))},f=0;r&&!a.closed&&f<i.length;f++)c(f)}}return cr.raceInit=t,cr}var mn={},Id;function lm(){if(Id)return mn;Id=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.range=void 0;var T=ze(),n=kt();function b(y,p,t){if(p==null&&(p=y,y=0),p<=0)return n.EMPTY;var i=p+y;return new T.Observable(t?function(a){var r=y;return t.schedule(function(){r<i?(a.next(r++),this.schedule()):a.complete()})}:function(a){for(var r=y;r<i&&!a.closed;)a.next(r++);a.complete()})}return mn.range=b,mn}var gn={},Fd;function cm(){if(Fd)return gn;Fd=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.using=void 0;var T=ze(),n=ye(),b=kt();function y(p,t){return new T.Observable(function(i){var a=p(),r=t(a),c=r?n.innerFrom(r):b.EMPTY;return c.subscribe(i),function(){a&&a.unsubscribe()}})}return gn.using=y,gn}var bn={},Cd;function Pl(){if(Cd)return bn;Cd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,o=[],u;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)o.push(s.value)}catch(m){u={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return o},n=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(bn,"__esModule",{value:!0}),bn.zip=void 0;var b=ze(),y=ye(),p=Pr(),t=kt(),i=ue(),a=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=a.popResultSelector(c),h=p.argsOrArgArray(c);return h.length?new b.Observable(function(s){var o=h.map(function(){return[]}),u=h.map(function(){return!1});s.add(function(){o=u=null});for(var m=function(_){y.innerFrom(h[_]).subscribe(i.createOperatorSubscriber(s,function(g){if(o[_].push(g),o.every(function(E){return E.length})){var x=o.map(function(E){return E.shift()});s.next(d?d.apply(void 0,n([],T(x))):x),o.some(function(E,w){return!E.length&&u[w]})&&s.complete()}},function(){u[_]=!0,!o[_].length&&s.complete()}))},v=0;!s.closed&&v<h.length;v++)m(v);return function(){o=u=null}}):t.EMPTY}return bn.zip=r,bn}var ul={},Nd;function hm(){return Nd||(Nd=1,Object.defineProperty(ul,"__esModule",{value:!0})),ul}var yn={},zd;function T_(){if(zd)return yn;zd=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.audit=void 0;var T=ie(),n=ye(),b=ue();function y(p){return T.operate(function(t,i){var a=!1,r=null,c=null,f=!1,d=function(){if(c==null||c.unsubscribe(),c=null,a){a=!1;var s=r;r=null,i.next(s)}f&&i.complete()},h=function(){c=null,f&&i.complete()};t.subscribe(b.createOperatorSubscriber(i,function(s){a=!0,r=s,c||n.innerFrom(p(s)).subscribe(c=b.createOperatorSubscriber(i,d,h))},function(){f=!0,(!a||!c||c.closed)&&i.complete()}))})}return yn.audit=y,yn}var En={},Bd;function dm(){if(Bd)return En;Bd=1,Object.defineProperty(En,"__esModule",{value:!0}),En.auditTime=void 0;var T=Tt(),n=T_(),b=Ar();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.audit(function(){return b.timer(p,t)})}return En.auditTime=y,En}var Tn={},Dd;function fm(){if(Dd)return Tn;Dd=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.buffer=void 0;var T=ie(),n=ut(),b=ue(),y=ye();function p(t){return T.operate(function(i,a){var r=[];return i.subscribe(b.createOperatorSubscriber(a,function(c){return r.push(c)},function(){a.next(r),a.complete()})),y.innerFrom(t).subscribe(b.createOperatorSubscriber(a,function(){var c=r;r=[],a.next(c)},n.noop)),function(){r=null}})}return Tn.buffer=p,Tn}var xn={},jd;function _m(){if(jd)return xn;jd=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(xn,"__esModule",{value:!0}),xn.bufferCount=void 0;var n=ie(),b=ue(),y=Zt();function p(t,i){return i===void 0&&(i=null),i=i??t,n.operate(function(a,r){var c=[],f=0;a.subscribe(b.createOperatorSubscriber(r,function(d){var h,s,o,u,m=null;f++%i===0&&c.push([]);try{for(var v=T(c),_=v.next();!_.done;_=v.next()){var g=_.value;g.push(d),t<=g.length&&(m=m??[],m.push(g))}}catch(w){h={error:w}}finally{try{_&&!_.done&&(s=v.return)&&s.call(v)}finally{if(h)throw h.error}}if(m)try{for(var x=T(m),E=x.next();!E.done;E=x.next()){var g=E.value;y.arrRemove(c,g),r.next(g)}}catch(w){o={error:w}}finally{try{E&&!E.done&&(u=x.return)&&u.call(x)}finally{if(o)throw o.error}}},function(){var d,h;try{for(var s=T(c),o=s.next();!o.done;o=s.next()){var u=o.value;r.next(u)}}catch(m){d={error:m}}finally{try{o&&!o.done&&(h=s.return)&&h.call(s)}finally{if(d)throw d.error}}r.complete()},void 0,function(){c=null}))})}return xn.bufferCount=p,xn}var An={},kd;function pm(){if(kd)return An;kd=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(An,"__esModule",{value:!0}),An.bufferTime=void 0;var n=Ot(),b=ie(),y=ue(),p=Zt(),t=Tt(),i=xt(),a=Kt();function r(c){for(var f,d,h=[],s=1;s<arguments.length;s++)h[s-1]=arguments[s];var o=(f=i.popScheduler(h))!==null&&f!==void 0?f:t.asyncScheduler,u=(d=h[0])!==null&&d!==void 0?d:null,m=h[1]||1/0;return b.operate(function(v,_){var g=[],x=!1,E=function(R){var O=R.buffer,I=R.subs;I.unsubscribe(),p.arrRemove(g,R),_.next(O),x&&w()},w=function(){if(g){var R=new n.Subscription;_.add(R);var O=[],I={buffer:O,subs:R};g.push(I),a.executeSchedule(R,o,function(){return E(I)},c)}};u!==null&&u>=0?a.executeSchedule(_,o,w,u,!0):x=!0,w();var S=y.createOperatorSubscriber(_,function(R){var O,I,D=g.slice();try{for(var j=T(D),k=j.next();!k.done;k=j.next()){var G=k.value,Z=G.buffer;Z.push(R),m<=Z.length&&E(G)}}catch(K){O={error:K}}finally{try{k&&!k.done&&(I=j.return)&&I.call(j)}finally{if(O)throw O.error}}},function(){for(;g!=null&&g.length;)_.next(g.shift().buffer);S==null||S.unsubscribe(),_.complete(),_.unsubscribe()},void 0,function(){return g=null});v.subscribe(S)})}return An.bufferTime=r,An}var Sn={},Ud;function vm(){if(Ud)return Sn;Ud=1;var T=H&&H.__values||function(r){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&r[c],d=0;if(f)return f.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&d>=r.length&&(r=void 0),{value:r&&r[d++],done:!r}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.bufferToggle=void 0;var n=Ot(),b=ie(),y=ye(),p=ue(),t=ut(),i=Zt();function a(r,c){return b.operate(function(f,d){var h=[];y.innerFrom(r).subscribe(p.createOperatorSubscriber(d,function(s){var o=[];h.push(o);var u=new n.Subscription,m=function(){i.arrRemove(h,o),d.next(o),u.unsubscribe()};u.add(y.innerFrom(c(s)).subscribe(p.createOperatorSubscriber(d,m,t.noop)))},t.noop)),f.subscribe(p.createOperatorSubscriber(d,function(s){var o,u;try{for(var m=T(h),v=m.next();!v.done;v=m.next()){var _=v.value;_.push(s)}}catch(g){o={error:g}}finally{try{v&&!v.done&&(u=m.return)&&u.call(m)}finally{if(o)throw o.error}}},function(){for(;h.length>0;)d.next(h.shift());d.complete()}))})}return Sn.bufferToggle=a,Sn}var On={},Gd;function mm(){if(Gd)return On;Gd=1,Object.defineProperty(On,"__esModule",{value:!0}),On.bufferWhen=void 0;var T=ie(),n=ut(),b=ue(),y=ye();function p(t){return T.operate(function(i,a){var r=null,c=null,f=function(){c==null||c.unsubscribe();var d=r;r=[],d&&a.next(d),y.innerFrom(t()).subscribe(c=b.createOperatorSubscriber(a,f,n.noop))};f(),i.subscribe(b.createOperatorSubscriber(a,function(d){return r==null?void 0:r.push(d)},function(){r&&a.next(r),a.complete()},void 0,function(){return r=c=null}))})}return On.bufferWhen=p,On}var Rn={},qd;function gm(){if(qd)return Rn;qd=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.catchError=void 0;var T=ye(),n=ue(),b=ie();function y(p){return b.operate(function(t,i){var a=null,r=!1,c;a=t.subscribe(n.createOperatorSubscriber(i,void 0,void 0,function(f){c=T.innerFrom(p(f,y(p)(t))),a?(a.unsubscribe(),a=null,c.subscribe(i)):r=!0})),r&&(a.unsubscribe(),a=null,c.subscribe(i))})}return Rn.catchError=y,Rn}var wn={},Pn={},Ln={},Mn={},In={},Fn={},Wd;function x_(){if(Wd)return Fn;Wd=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.scanInternals=void 0;var T=ue();function n(b,y,p,t,i){return function(a,r){var c=p,f=y,d=0;a.subscribe(T.createOperatorSubscriber(r,function(h){var s=d++;f=c?b(f,h,s):(c=!0,h),t&&r.next(f)},i&&function(){c&&r.next(f),r.complete()}))}}return Fn.scanInternals=n,Fn}var Vd;function As(){if(Vd)return In;Vd=1,Object.defineProperty(In,"__esModule",{value:!0}),In.reduce=void 0;var T=x_(),n=ie();function b(y,p){return n.operate(T.scanInternals(y,p,arguments.length>=2,!1,!0))}return In.reduce=b,In}var $d;function A_(){if($d)return Mn;$d=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.toArray=void 0;var T=As(),n=ie(),b=function(p,t){return p.push(t),p};function y(){return n.operate(function(p,t){T.reduce(b,[])(p).subscribe(t)})}return Mn.toArray=y,Mn}var Hd;function S_(){if(Hd)return Ln;Hd=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.joinAllInternals=void 0;var T=lt(),n=xr(),b=no(),y=Jt(),p=A_();function t(i,a){return b.pipe(p.toArray(),y.mergeMap(function(r){return i(r)}),a?n.mapOneOrManyArgs(a):T.identity)}return Ln.joinAllInternals=t,Ln}var Xd;function O_(){if(Xd)return Pn;Xd=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.combineLatestAll=void 0;var T=Ol(),n=S_();function b(y){return n.joinAllInternals(T.combineLatest,y)}return Pn.combineLatestAll=b,Pn}var Yd;function bm(){if(Yd)return wn;Yd=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.combineAll=void 0;var T=O_();return wn.combineAll=T.combineLatestAll,wn}var Cn={},Nn={},Zd;function ym(){if(Zd)return Nn;Zd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,o=[],u;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)o.push(s.value)}catch(m){u={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return o},n=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.combineLatest=void 0;var b=Ol(),y=ie(),p=Pr(),t=xr(),i=no(),a=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=a.popResultSelector(c);return d?i.pipe(r.apply(void 0,n([],T(c))),t.mapOneOrManyArgs(d)):y.operate(function(h,s){b.combineLatestInit(n([h],T(p.argsOrArgArray(c))))(s)})}return Nn.combineLatest=r,Nn}var Kd;function Em(){if(Kd)return Cn;Kd=1;var T=H&&H.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(f)throw f.error}}return c},n=H&&H.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.combineLatestWith=void 0;var b=ym();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return b.combineLatest.apply(void 0,n([],T(p)))}return Cn.combineLatestWith=y,Cn}var zn={},Qd;function R_(){if(Qd)return zn;Qd=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.concatMap=void 0;var T=Jt(),n=Ce();function b(y,p){return n.isFunction(p)?T.mergeMap(y,p,1):T.mergeMap(y,1)}return zn.concatMap=b,zn}var Bn={},Jd;function Tm(){if(Jd)return Bn;Jd=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.concatMapTo=void 0;var T=R_(),n=Ce();function b(y,p){return n.isFunction(p)?T.concatMap(function(){return y},p):T.concatMap(function(){return y})}return Bn.concatMapTo=b,Bn}var Dn={},jn={},e0;function xm(){if(e0)return jn;e0=1;var T=H&&H.__read||function(a,r){var c=typeof Symbol=="function"&&a[Symbol.iterator];if(!c)return a;var f=c.call(a),d,h=[],s;try{for(;(r===void 0||r-- >0)&&!(d=f.next()).done;)h.push(d.value)}catch(o){s={error:o}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(s)throw s.error}}return h},n=H&&H.__spreadArray||function(a,r){for(var c=0,f=r.length,d=a.length;c<f;c++,d++)a[d]=r[c];return a};Object.defineProperty(jn,"__esModule",{value:!0}),jn.concat=void 0;var b=ie(),y=wl(),p=xt(),t=Qt();function i(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];var c=p.popScheduler(a);return b.operate(function(f,d){y.concatAll()(t.from(n([f],T(a)),c)).subscribe(d)})}return jn.concat=i,jn}var t0;function Am(){if(t0)return Dn;t0=1;var T=H&&H.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(f)throw f.error}}return c},n=H&&H.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.concatWith=void 0;var b=xm();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return b.concat.apply(void 0,n([],T(p)))}return Dn.concatWith=y,Dn}var kn={},Un={},r0;function Sm(){if(r0)return Un;r0=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.fromSubscribable=void 0;var T=ze();function n(b){return new T.Observable(function(y){return b.subscribe(y)})}return Un.fromSubscribable=n,Un}var i0;function Ll(){if(i0)return kn;i0=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.connect=void 0;var T=ct(),n=ye(),b=ie(),y=Sm(),p={connector:function(){return new T.Subject}};function t(i,a){a===void 0&&(a=p);var r=a.connector;return b.operate(function(c,f){var d=r();n.innerFrom(i(y.fromSubscribable(d))).subscribe(f),f.add(c.subscribe(d))})}return kn.connect=t,kn}var Gn={},n0;function Om(){if(n0)return Gn;n0=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.count=void 0;var T=As();function n(b){return T.reduce(function(y,p,t){return!b||b(p,t)?y+1:y},0)}return Gn.count=n,Gn}var qn={},a0;function Rm(){if(a0)return qn;a0=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.debounce=void 0;var T=ie(),n=ut(),b=ue(),y=ye();function p(t){return T.operate(function(i,a){var r=!1,c=null,f=null,d=function(){if(f==null||f.unsubscribe(),f=null,r){r=!1;var h=c;c=null,a.next(h)}};i.subscribe(b.createOperatorSubscriber(a,function(h){f==null||f.unsubscribe(),r=!0,c=h,f=b.createOperatorSubscriber(a,d,n.noop),y.innerFrom(t(h)).subscribe(f)},function(){d(),a.complete()},void 0,function(){c=f=null}))})}return qn.debounce=p,qn}var Wn={},s0;function wm(){if(s0)return Wn;s0=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.debounceTime=void 0;var T=Tt(),n=ie(),b=ue();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.operate(function(i,a){var r=null,c=null,f=null,d=function(){if(r){r.unsubscribe(),r=null;var s=c;c=null,a.next(s)}};function h(){var s=f+p,o=t.now();if(o<s){r=this.schedule(void 0,s-o),a.add(r);return}d()}i.subscribe(b.createOperatorSubscriber(a,function(s){c=s,f=t.now(),r||(r=t.schedule(h,p),a.add(r))},function(){d(),a.complete()},void 0,function(){c=r=null}))})}return Wn.debounceTime=y,Wn}var Vn={},o0;function fo(){if(o0)return Vn;o0=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.defaultIfEmpty=void 0;var T=ie(),n=ue();function b(y){return T.operate(function(p,t){var i=!1;p.subscribe(n.createOperatorSubscriber(t,function(a){i=!0,t.next(a)},function(){i||t.next(y),t.complete()}))})}return Vn.defaultIfEmpty=b,Vn}var $n={},Hn={},Xn={},u0;function _o(){if(u0)return Xn;u0=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.take=void 0;var T=kt(),n=ie(),b=ue();function y(p){return p<=0?function(){return T.EMPTY}:n.operate(function(t,i){var a=0;t.subscribe(b.createOperatorSubscriber(i,function(r){++a<=p&&(i.next(r),p<=a&&i.complete())}))})}return Xn.take=y,Xn}var Yn={},l0;function w_(){if(l0)return Yn;l0=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.ignoreElements=void 0;var T=ie(),n=ue(),b=ut();function y(){return T.operate(function(p,t){p.subscribe(n.createOperatorSubscriber(t,b.noop))})}return Yn.ignoreElements=y,Yn}var Zn={},c0;function P_(){if(c0)return Zn;c0=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.mapTo=void 0;var T=Tr();function n(b){return T.map(function(){return b})}return Zn.mapTo=n,Zn}var h0;function L_(){if(h0)return Hn;h0=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.delayWhen=void 0;var T=co(),n=_o(),b=w_(),y=P_(),p=Jt(),t=ye();function i(a,r){return r?function(c){return T.concat(r.pipe(n.take(1),b.ignoreElements()),c.pipe(i(a)))}:p.mergeMap(function(c,f){return t.innerFrom(a(c,f)).pipe(n.take(1),y.mapTo(c))})}return Hn.delayWhen=i,Hn}var d0;function Pm(){if(d0)return $n;d0=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.delay=void 0;var T=Tt(),n=L_(),b=Ar();function y(p,t){t===void 0&&(t=T.asyncScheduler);var i=b.timer(p,t);return n.delayWhen(function(){return i})}return $n.delay=y,$n}var Kn={},f0;function Lm(){if(f0)return Kn;f0=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.dematerialize=void 0;var T=Al(),n=ie(),b=ue();function y(){return n.operate(function(p,t){p.subscribe(b.createOperatorSubscriber(t,function(i){return T.observeNotification(i,t)}))})}return Kn.dematerialize=y,Kn}var Qn={},_0;function Mm(){if(_0)return Qn;_0=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.distinct=void 0;var T=ie(),n=ue(),b=ut(),y=ye();function p(t,i){return T.operate(function(a,r){var c=new Set;a.subscribe(n.createOperatorSubscriber(r,function(f){var d=t?t(f):f;c.has(d)||(c.add(d),r.next(f))})),i&&y.innerFrom(i).subscribe(n.createOperatorSubscriber(r,function(){return c.clear()},b.noop))})}return Qn.distinct=p,Qn}var Jn={},p0;function M_(){if(p0)return Jn;p0=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.distinctUntilChanged=void 0;var T=lt(),n=ie(),b=ue();function y(t,i){return i===void 0&&(i=T.identity),t=t??p,n.operate(function(a,r){var c,f=!0;a.subscribe(b.createOperatorSubscriber(r,function(d){var h=i(d);(f||!t(c,h))&&(f=!1,c=h,r.next(d))}))})}Jn.distinctUntilChanged=y;function p(t,i){return t===i}return Jn}var ea={},v0;function Im(){if(v0)return ea;v0=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.distinctUntilKeyChanged=void 0;var T=M_();function n(b,y){return T.distinctUntilChanged(function(p,t){return y?y(p[b],t[b]):p[b]===t[b]})}return ea.distinctUntilKeyChanged=n,ea}var ta={},ra={},m0;function po(){if(m0)return ra;m0=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.throwIfEmpty=void 0;var T=Er(),n=ie(),b=ue();function y(t){return t===void 0&&(t=p),n.operate(function(i,a){var r=!1;i.subscribe(b.createOperatorSubscriber(a,function(c){r=!0,a.next(c)},function(){return r?a.complete():a.error(t())}))})}ra.throwIfEmpty=y;function p(){return new T.EmptyError}return ra}var g0;function Fm(){if(g0)return ta;g0=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.elementAt=void 0;var T=f_(),n=Lr(),b=po(),y=fo(),p=_o();function t(i,a){if(i<0)throw new T.ArgumentOutOfRangeError;var r=arguments.length>=2;return function(c){return c.pipe(n.filter(function(f,d){return d===i}),p.take(1),r?y.defaultIfEmpty(a):b.throwIfEmpty(function(){return new T.ArgumentOutOfRangeError}))}}return ta.elementAt=t,ta}var ia={},b0;function Cm(){if(b0)return ia;b0=1;var T=H&&H.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return f},n=H&&H.__spreadArray||function(t,i){for(var a=0,r=i.length,c=t.length;a<r;a++,c++)t[c]=i[a];return t};Object.defineProperty(ia,"__esModule",{value:!0}),ia.endWith=void 0;var b=co(),y=xl();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return function(a){return b.concat(a,y.of.apply(void 0,n([],T(t))))}}return ia.endWith=p,ia}var na={},y0;function Nm(){if(y0)return na;y0=1,Object.defineProperty(na,"__esModule",{value:!0}),na.every=void 0;var T=ie(),n=ue();function b(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){y.call(p,r,a++,t)||(i.next(!1),i.complete())},function(){i.next(!0),i.complete()}))})}return na.every=b,na}var aa={},sa={},oa={},E0;function I_(){if(E0)return oa;E0=1,Object.defineProperty(oa,"__esModule",{value:!0}),oa.exhaustMap=void 0;var T=Tr(),n=ye(),b=ie(),y=ue();function p(t,i){return i?function(a){return a.pipe(p(function(r,c){return n.innerFrom(t(r,c)).pipe(T.map(function(f,d){return i(r,f,c,d)}))}))}:b.operate(function(a,r){var c=0,f=null,d=!1;a.subscribe(y.createOperatorSubscriber(r,function(h){f||(f=y.createOperatorSubscriber(r,void 0,function(){f=null,d&&r.complete()}),n.innerFrom(t(h,c++)).subscribe(f))},function(){d=!0,!f&&r.complete()}))})}return oa.exhaustMap=p,oa}var T0;function F_(){if(T0)return sa;T0=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.exhaustAll=void 0;var T=I_(),n=lt();function b(){return T.exhaustMap(n.identity)}return sa.exhaustAll=b,sa}var x0;function zm(){if(x0)return aa;x0=1,Object.defineProperty(aa,"__esModule",{value:!0}),aa.exhaust=void 0;var T=F_();return aa.exhaust=T.exhaustAll,aa}var ua={},A0;function Bm(){if(A0)return ua;A0=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.expand=void 0;var T=ie(),n=Rl();function b(y,p,t){return p===void 0&&(p=1/0),p=(p||0)<1?1/0:p,T.operate(function(i,a){return n.mergeInternals(i,a,y,p,void 0,!0,t)})}return ua.expand=b,ua}var la={},S0;function Dm(){if(S0)return la;S0=1,Object.defineProperty(la,"__esModule",{value:!0}),la.finalize=void 0;var T=ie();function n(b){return T.operate(function(y,p){try{y.subscribe(p)}finally{p.add(b)}})}return la.finalize=n,la}var hr={},O0;function C_(){if(O0)return hr;O0=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.createFind=hr.find=void 0;var T=ie(),n=ue();function b(p,t){return T.operate(y(p,t,"value"))}hr.find=b;function y(p,t,i){var a=i==="index";return function(r,c){var f=0;r.subscribe(n.createOperatorSubscriber(c,function(d){var h=f++;p.call(t,d,h,r)&&(c.next(a?h:d),c.complete())},function(){c.next(a?-1:void 0),c.complete()}))}}return hr.createFind=y,hr}var ca={},R0;function jm(){if(R0)return ca;R0=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.findIndex=void 0;var T=ie(),n=C_();function b(y,p){return T.operate(n.createFind(y,p,"index"))}return ca.findIndex=b,ca}var ha={},w0;function km(){if(w0)return ha;w0=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.first=void 0;var T=Er(),n=Lr(),b=_o(),y=fo(),p=po(),t=lt();function i(a,r){var c=arguments.length>=2;return function(f){return f.pipe(a?n.filter(function(d,h){return a(d,h,f)}):t.identity,b.take(1),c?y.defaultIfEmpty(r):p.throwIfEmpty(function(){return new T.EmptyError}))}}return ha.first=i,ha}var da={},P0;function Um(){if(P0)return da;P0=1,Object.defineProperty(da,"__esModule",{value:!0}),da.groupBy=void 0;var T=ze(),n=ye(),b=ct(),y=ie(),p=ue();function t(i,a,r,c){return y.operate(function(f,d){var h;!a||typeof a=="function"?h=a:(r=a.duration,h=a.element,c=a.connector);var s=new Map,o=function(x){s.forEach(x),x(d)},u=function(x){return o(function(E){return E.error(x)})},m=0,v=!1,_=new p.OperatorSubscriber(d,function(x){try{var E=i(x),w=s.get(E);if(!w){s.set(E,w=c?c():new b.Subject);var S=g(E,w);if(d.next(S),r){var R=p.createOperatorSubscriber(w,function(){w.complete(),R==null||R.unsubscribe()},void 0,void 0,function(){return s.delete(E)});_.add(n.innerFrom(r(S)).subscribe(R))}}w.next(h?h(x):x)}catch(O){u(O)}},function(){return o(function(x){return x.complete()})},u,function(){return s.clear()},function(){return v=!0,m===0});f.subscribe(_);function g(x,E){var w=new T.Observable(function(S){m++;var R=E.subscribe(S);return function(){R.unsubscribe(),--m===0&&v&&_.unsubscribe()}});return w.key=x,w}})}return da.groupBy=t,da}var fa={},L0;function Gm(){if(L0)return fa;L0=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.isEmpty=void 0;var T=ie(),n=ue();function b(){return T.operate(function(y,p){y.subscribe(n.createOperatorSubscriber(p,function(){p.next(!1),p.complete()},function(){p.next(!0),p.complete()}))})}return fa.isEmpty=b,fa}var _a={},pa={},M0;function N_(){if(M0)return pa;M0=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(pa,"__esModule",{value:!0}),pa.takeLast=void 0;var n=kt(),b=ie(),y=ue();function p(t){return t<=0?function(){return n.EMPTY}:b.operate(function(i,a){var r=[];i.subscribe(y.createOperatorSubscriber(a,function(c){r.push(c),t<r.length&&r.shift()},function(){var c,f;try{for(var d=T(r),h=d.next();!h.done;h=d.next()){var s=h.value;a.next(s)}}catch(o){c={error:o}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(c)throw c.error}}a.complete()},void 0,function(){r=null}))})}return pa.takeLast=p,pa}var I0;function qm(){if(I0)return _a;I0=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.last=void 0;var T=Er(),n=Lr(),b=N_(),y=po(),p=fo(),t=lt();function i(a,r){var c=arguments.length>=2;return function(f){return f.pipe(a?n.filter(function(d,h){return a(d,h,f)}):t.identity,b.takeLast(1),c?p.defaultIfEmpty(r):y.throwIfEmpty(function(){return new T.EmptyError}))}}return _a.last=i,_a}var va={},F0;function Wm(){if(F0)return va;F0=1,Object.defineProperty(va,"__esModule",{value:!0}),va.materialize=void 0;var T=Al(),n=ie(),b=ue();function y(){return n.operate(function(p,t){p.subscribe(b.createOperatorSubscriber(t,function(i){t.next(T.Notification.createNext(i))},function(){t.next(T.Notification.createComplete()),t.complete()},function(i){t.next(T.Notification.createError(i)),t.complete()}))})}return va.materialize=y,va}var ma={},C0;function Vm(){if(C0)return ma;C0=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.max=void 0;var T=As(),n=Ce();function b(y){return T.reduce(n.isFunction(y)?function(p,t){return y(p,t)>0?p:t}:function(p,t){return p>t?p:t})}return ma.max=b,ma}var ga={},N0;function $m(){if(N0)return ga;N0=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.flatMap=void 0;var T=Jt();return ga.flatMap=T.mergeMap,ga}var ba={},z0;function Hm(){if(z0)return ba;z0=1,Object.defineProperty(ba,"__esModule",{value:!0}),ba.mergeMapTo=void 0;var T=Jt(),n=Ce();function b(y,p,t){return t===void 0&&(t=1/0),n.isFunction(p)?T.mergeMap(function(){return y},p,t):(typeof p=="number"&&(t=p),T.mergeMap(function(){return y},t))}return ba.mergeMapTo=b,ba}var ya={},B0;function Xm(){if(B0)return ya;B0=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.mergeScan=void 0;var T=ie(),n=Rl();function b(y,p,t){return t===void 0&&(t=1/0),T.operate(function(i,a){var r=p;return n.mergeInternals(i,a,function(c,f){return y(r,c,f)},t,function(c){r=c},!1,void 0,function(){return r=null})})}return ya.mergeScan=b,ya}var Ea={},Ta={},D0;function Ym(){if(D0)return Ta;D0=1;var T=H&&H.__read||function(r,c){var f=typeof Symbol=="function"&&r[Symbol.iterator];if(!f)return r;var d=f.call(r),h,s=[],o;try{for(;(c===void 0||c-- >0)&&!(h=d.next()).done;)s.push(h.value)}catch(u){o={error:u}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(o)throw o.error}}return s},n=H&&H.__spreadArray||function(r,c){for(var f=0,d=c.length,h=r.length;f<d;f++,h++)r[h]=c[f];return r};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.merge=void 0;var b=ie(),y=Pr(),p=lo(),t=xt(),i=Qt();function a(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];var f=t.popScheduler(r),d=t.popNumber(r,1/0);return r=y.argsOrArgArray(r),b.operate(function(h,s){p.mergeAll(d)(i.from(n([h],T(r)),f)).subscribe(s)})}return Ta.merge=a,Ta}var j0;function Zm(){if(j0)return Ea;j0=1;var T=H&&H.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(f)throw f.error}}return c},n=H&&H.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.mergeWith=void 0;var b=Ym();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return b.merge.apply(void 0,n([],T(p)))}return Ea.mergeWith=y,Ea}var xa={},k0;function Km(){if(k0)return xa;k0=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.min=void 0;var T=As(),n=Ce();function b(y){return T.reduce(n.isFunction(y)?function(p,t){return y(p,t)<0?p:t}:function(p,t){return p<t?p:t})}return xa.min=b,xa}var Aa={},U0;function Ml(){if(U0)return Aa;U0=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.multicast=void 0;var T=ao(),n=Ce(),b=Ll();function y(p,t){var i=n.isFunction(p)?p:function(){return p};return n.isFunction(t)?b.connect(t,{connector:i}):function(a){return new T.ConnectableObservable(a,i)}}return Aa.multicast=y,Aa}var dr={},G0;function Qm(){if(G0)return dr;G0=1;var T=H&&H.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return f},n=H&&H.__spreadArray||function(t,i){for(var a=0,r=i.length,c=t.length;a<r;a++,c++)t[c]=i[a];return t};Object.defineProperty(dr,"__esModule",{value:!0}),dr.onErrorResumeNext=dr.onErrorResumeNextWith=void 0;var b=Pr(),y=y_();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var a=b.argsOrArgArray(t);return function(r){return y.onErrorResumeNext.apply(void 0,n([r],T(a)))}}return dr.onErrorResumeNextWith=p,dr.onErrorResumeNext=p,dr}var Sa={},q0;function Jm(){if(q0)return Sa;q0=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.pairwise=void 0;var T=ie(),n=ue();function b(){return T.operate(function(y,p){var t,i=!1;y.subscribe(n.createOperatorSubscriber(p,function(a){var r=t;t=a,i&&p.next([r,a]),i=!0}))})}return Sa.pairwise=b,Sa}var Oa={},W0;function e2(){if(W0)return Oa;W0=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.pluck=void 0;var T=Tr();function n(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];var p=b.length;if(p===0)throw new Error("list of properties cannot be empty.");return T.map(function(t){for(var i=t,a=0;a<p;a++){var r=i==null?void 0:i[b[a]];if(typeof r<"u")i=r;else return}return i})}return Oa.pluck=n,Oa}var Ra={},V0;function t2(){if(V0)return Ra;V0=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.publish=void 0;var T=ct(),n=Ml(),b=Ll();function y(p){return p?function(t){return b.connect(p)(t)}:function(t){return n.multicast(new T.Subject)(t)}}return Ra.publish=y,Ra}var wa={},$0;function r2(){if($0)return wa;$0=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.publishBehavior=void 0;var T=t_(),n=ao();function b(y){return function(p){var t=new T.BehaviorSubject(y);return new n.ConnectableObservable(p,function(){return t})}}return wa.publishBehavior=b,wa}var Pa={},H0;function i2(){if(H0)return Pa;H0=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.publishLast=void 0;var T=yl(),n=ao();function b(){return function(y){var p=new T.AsyncSubject;return new n.ConnectableObservable(y,function(){return p})}}return Pa.publishLast=b,Pa}var La={},X0;function n2(){if(X0)return La;X0=1,Object.defineProperty(La,"__esModule",{value:!0}),La.publishReplay=void 0;var T=bl(),n=Ml(),b=Ce();function y(p,t,i,a){i&&!b.isFunction(i)&&(a=i);var r=b.isFunction(i)?i:void 0;return function(c){return n.multicast(new T.ReplaySubject(p,t,a),r)(c)}}return La.publishReplay=y,La}var Ma={},Y0;function a2(){if(Y0)return Ma;Y0=1;var T=H&&H.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(a===void 0||a-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},n=H&&H.__spreadArray||function(i,a){for(var r=0,c=a.length,f=i.length;r<c;r++,f++)i[f]=a[r];return i};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.raceWith=void 0;var b=E_(),y=ie(),p=lt();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return i.length?y.operate(function(r,c){b.raceInit(n([r],T(i)))(c)}):p.identity}return Ma.raceWith=t,Ma}var Ia={},Z0;function s2(){if(Z0)return Ia;Z0=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.repeat=void 0;var T=kt(),n=ie(),b=ue(),y=ye(),p=Ar();function t(i){var a,r=1/0,c;return i!=null&&(typeof i=="object"?(a=i.count,r=a===void 0?1/0:a,c=i.delay):r=i),r<=0?function(){return T.EMPTY}:n.operate(function(f,d){var h=0,s,o=function(){if(s==null||s.unsubscribe(),s=null,c!=null){var m=typeof c=="number"?p.timer(c):y.innerFrom(c(h)),v=b.createOperatorSubscriber(d,function(){v.unsubscribe(),u()});m.subscribe(v)}else u()},u=function(){var m=!1;s=f.subscribe(b.createOperatorSubscriber(d,void 0,function(){++h<r?s?o():m=!0:d.complete()})),m&&o()};u()})}return Ia.repeat=t,Ia}var Fa={},K0;function o2(){if(K0)return Fa;K0=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.repeatWhen=void 0;var T=ye(),n=ct(),b=ie(),y=ue();function p(t){return b.operate(function(i,a){var r,c=!1,f,d=!1,h=!1,s=function(){return h&&d&&(a.complete(),!0)},o=function(){return f||(f=new n.Subject,T.innerFrom(t(f)).subscribe(y.createOperatorSubscriber(a,function(){r?u():c=!0},function(){d=!0,s()}))),f},u=function(){h=!1,r=i.subscribe(y.createOperatorSubscriber(a,void 0,function(){h=!0,!s()&&o().next()})),c&&(r.unsubscribe(),r=null,c=!1,u())};u()})}return Fa.repeatWhen=p,Fa}var Ca={},Q0;function u2(){if(Q0)return Ca;Q0=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.retry=void 0;var T=ie(),n=ue(),b=lt(),y=Ar(),p=ye();function t(i){i===void 0&&(i=1/0);var a;i&&typeof i=="object"?a=i:a={count:i};var r=a.count,c=r===void 0?1/0:r,f=a.delay,d=a.resetOnSuccess,h=d===void 0?!1:d;return c<=0?b.identity:T.operate(function(s,o){var u=0,m,v=function(){var _=!1;m=s.subscribe(n.createOperatorSubscriber(o,function(g){h&&(u=0),o.next(g)},void 0,function(g){if(u++<c){var x=function(){m?(m.unsubscribe(),m=null,v()):_=!0};if(f!=null){var E=typeof f=="number"?y.timer(f):p.innerFrom(f(g,u)),w=n.createOperatorSubscriber(o,function(){w.unsubscribe(),x()},function(){o.complete()});E.subscribe(w)}else x()}else o.error(g)})),_&&(m.unsubscribe(),m=null,v())};v()})}return Ca.retry=t,Ca}var Na={},J0;function l2(){if(J0)return Na;J0=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.retryWhen=void 0;var T=ye(),n=ct(),b=ie(),y=ue();function p(t){return b.operate(function(i,a){var r,c=!1,f,d=function(){r=i.subscribe(y.createOperatorSubscriber(a,void 0,void 0,function(h){f||(f=new n.Subject,T.innerFrom(t(f)).subscribe(y.createOperatorSubscriber(a,function(){return r?d():c=!0}))),f&&f.next(h)})),c&&(r.unsubscribe(),r=null,c=!1,d())};d()})}return Na.retryWhen=p,Na}var za={},ef;function z_(){if(ef)return za;ef=1,Object.defineProperty(za,"__esModule",{value:!0}),za.sample=void 0;var T=ye(),n=ie(),b=ut(),y=ue();function p(t){return n.operate(function(i,a){var r=!1,c=null;i.subscribe(y.createOperatorSubscriber(a,function(f){r=!0,c=f})),T.innerFrom(t).subscribe(y.createOperatorSubscriber(a,function(){if(r){r=!1;var f=c;c=null,a.next(f)}},b.noop))})}return za.sample=p,za}var Ba={},tf;function c2(){if(tf)return Ba;tf=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.sampleTime=void 0;var T=Tt(),n=z_(),b=b_();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.sample(b.interval(p,t))}return Ba.sampleTime=y,Ba}var Da={},rf;function h2(){if(rf)return Da;rf=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.scan=void 0;var T=ie(),n=x_();function b(y,p){return T.operate(n.scanInternals(y,p,arguments.length>=2,!0))}return Da.scan=b,Da}var ja={},nf;function d2(){if(nf)return ja;nf=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.sequenceEqual=void 0;var T=ie(),n=ue(),b=ye();function y(t,i){return i===void 0&&(i=function(a,r){return a===r}),T.operate(function(a,r){var c=p(),f=p(),d=function(s){r.next(s),r.complete()},h=function(s,o){var u=n.createOperatorSubscriber(r,function(m){var v=o.buffer,_=o.complete;v.length===0?_?d(!1):s.buffer.push(m):!i(m,v.shift())&&d(!1)},function(){s.complete=!0;var m=o.complete,v=o.buffer;m&&d(v.length===0),u==null||u.unsubscribe()});return u};a.subscribe(h(c,f)),b.innerFrom(t).subscribe(h(f,c))})}ja.sequenceEqual=y;function p(){return{buffer:[],complete:!1}}return ja}var ka={},af;function B_(){if(af)return ka;af=1;var T=H&&H.__read||function(r,c){var f=typeof Symbol=="function"&&r[Symbol.iterator];if(!f)return r;var d=f.call(r),h,s=[],o;try{for(;(c===void 0||c-- >0)&&!(h=d.next()).done;)s.push(h.value)}catch(u){o={error:u}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(o)throw o.error}}return s},n=H&&H.__spreadArray||function(r,c){for(var f=0,d=c.length,h=r.length;f<d;f++,h++)r[h]=c[f];return r};Object.defineProperty(ka,"__esModule",{value:!0}),ka.share=void 0;var b=ye(),y=ct(),p=Es(),t=ie();function i(r){r===void 0&&(r={});var c=r.connector,f=c===void 0?function(){return new y.Subject}:c,d=r.resetOnError,h=d===void 0?!0:d,s=r.resetOnComplete,o=s===void 0?!0:s,u=r.resetOnRefCountZero,m=u===void 0?!0:u;return function(v){var _,g,x,E=0,w=!1,S=!1,R=function(){g==null||g.unsubscribe(),g=void 0},O=function(){R(),_=x=void 0,w=S=!1},I=function(){var D=_;O(),D==null||D.unsubscribe()};return t.operate(function(D,j){E++,!S&&!w&&R();var k=x=x??f();j.add(function(){E--,E===0&&!S&&!w&&(g=a(I,m))}),k.subscribe(j),!_&&E>0&&(_=new p.SafeSubscriber({next:function(G){return k.next(G)},error:function(G){S=!0,R(),g=a(O,h,G),k.error(G)},complete:function(){w=!0,R(),g=a(O,o),k.complete()}}),b.innerFrom(D).subscribe(_))})(v)}}ka.share=i;function a(r,c){for(var f=[],d=2;d<arguments.length;d++)f[d-2]=arguments[d];if(c===!0){r();return}if(c!==!1){var h=new p.SafeSubscriber({next:function(){h.unsubscribe(),r()}});return b.innerFrom(c.apply(void 0,n([],T(f)))).subscribe(h)}}return ka}var Ua={},sf;function f2(){if(sf)return Ua;sf=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.shareReplay=void 0;var T=bl(),n=B_();function b(y,p,t){var i,a,r,c,f=!1;return y&&typeof y=="object"?(i=y.bufferSize,c=i===void 0?1/0:i,a=y.windowTime,p=a===void 0?1/0:a,r=y.refCount,f=r===void 0?!1:r,t=y.scheduler):c=y??1/0,n.share({connector:function(){return new T.ReplaySubject(c,p,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:f})}return Ua.shareReplay=b,Ua}var Ga={},of;function _2(){if(of)return Ga;of=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.single=void 0;var T=Er(),n=p_(),b=__(),y=ie(),p=ue();function t(i){return y.operate(function(a,r){var c=!1,f,d=!1,h=0;a.subscribe(p.createOperatorSubscriber(r,function(s){d=!0,(!i||i(s,h++,a))&&(c&&r.error(new n.SequenceError("Too many matching values")),c=!0,f=s)},function(){c?(r.next(f),r.complete()):r.error(d?new b.NotFoundError("No matching values"):new T.EmptyError)}))})}return Ga.single=t,Ga}var qa={},uf;function p2(){if(uf)return qa;uf=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.skip=void 0;var T=Lr();function n(b){return T.filter(function(y,p){return b<=p})}return qa.skip=n,qa}var Wa={},lf;function v2(){if(lf)return Wa;lf=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.skipLast=void 0;var T=lt(),n=ie(),b=ue();function y(p){return p<=0?T.identity:n.operate(function(t,i){var a=new Array(p),r=0;return t.subscribe(b.createOperatorSubscriber(i,function(c){var f=r++;if(f<p)a[f]=c;else{var d=f%p,h=a[d];a[d]=c,i.next(h)}})),function(){a=null}})}return Wa.skipLast=y,Wa}var Va={},cf;function m2(){if(cf)return Va;cf=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.skipUntil=void 0;var T=ie(),n=ue(),b=ye(),y=ut();function p(t){return T.operate(function(i,a){var r=!1,c=n.createOperatorSubscriber(a,function(){c==null||c.unsubscribe(),r=!0},y.noop);b.innerFrom(t).subscribe(c),i.subscribe(n.createOperatorSubscriber(a,function(f){return r&&a.next(f)}))})}return Va.skipUntil=p,Va}var $a={},hf;function g2(){if(hf)return $a;hf=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.skipWhile=void 0;var T=ie(),n=ue();function b(y){return T.operate(function(p,t){var i=!1,a=0;p.subscribe(n.createOperatorSubscriber(t,function(r){return(i||(i=!y(r,a++)))&&t.next(r)}))})}return $a.skipWhile=b,$a}var Ha={},df;function b2(){if(df)return Ha;df=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.startWith=void 0;var T=co(),n=xt(),b=ie();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=n.popScheduler(p);return b.operate(function(a,r){(i?T.concat(p,a,i):T.concat(p,a)).subscribe(r)})}return Ha.startWith=y,Ha}var Xa={},Ya={},ff;function vo(){if(ff)return Ya;ff=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.switchMap=void 0;var T=ye(),n=ie(),b=ue();function y(p,t){return n.operate(function(i,a){var r=null,c=0,f=!1,d=function(){return f&&!r&&a.complete()};i.subscribe(b.createOperatorSubscriber(a,function(h){r==null||r.unsubscribe();var s=0,o=c++;T.innerFrom(p(h,o)).subscribe(r=b.createOperatorSubscriber(a,function(u){return a.next(t?t(h,u,o,s++):u)},function(){r=null,d()}))},function(){f=!0,d()}))})}return Ya.switchMap=y,Ya}var _f;function y2(){if(_f)return Xa;_f=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.switchAll=void 0;var T=vo(),n=lt();function b(){return T.switchMap(n.identity)}return Xa.switchAll=b,Xa}var Za={},pf;function E2(){if(pf)return Za;pf=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.switchMapTo=void 0;var T=vo(),n=Ce();function b(y,p){return n.isFunction(p)?T.switchMap(function(){return y},p):T.switchMap(function(){return y})}return Za.switchMapTo=b,Za}var Ka={},vf;function T2(){if(vf)return Ka;vf=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.switchScan=void 0;var T=vo(),n=ie();function b(y,p){return n.operate(function(t,i){var a=p;return T.switchMap(function(r,c){return y(a,r,c)},function(r,c){return a=c,c})(t).subscribe(i),function(){a=null}})}return Ka.switchScan=b,Ka}var Qa={},mf;function x2(){if(mf)return Qa;mf=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.takeUntil=void 0;var T=ie(),n=ue(),b=ye(),y=ut();function p(t){return T.operate(function(i,a){b.innerFrom(t).subscribe(n.createOperatorSubscriber(a,function(){return a.complete()},y.noop)),!a.closed&&i.subscribe(a)})}return Qa.takeUntil=p,Qa}var Ja={},gf;function A2(){if(gf)return Ja;gf=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.takeWhile=void 0;var T=ie(),n=ue();function b(y,p){return p===void 0&&(p=!1),T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){var c=y(r,a++);(c||p)&&i.next(r),!c&&i.complete()}))})}return Ja.takeWhile=b,Ja}var es={},bf;function S2(){if(bf)return es;bf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.tap=void 0;var T=Ce(),n=ie(),b=ue(),y=lt();function p(t,i,a){var r=T.isFunction(t)||i||a?{next:t,error:i,complete:a}:t;return r?n.operate(function(c,f){var d;(d=r.subscribe)===null||d===void 0||d.call(r);var h=!0;c.subscribe(b.createOperatorSubscriber(f,function(s){var o;(o=r.next)===null||o===void 0||o.call(r,s),f.next(s)},function(){var s;h=!1,(s=r.complete)===null||s===void 0||s.call(r),f.complete()},function(s){var o;h=!1,(o=r.error)===null||o===void 0||o.call(r,s),f.error(s)},function(){var s,o;h&&((s=r.unsubscribe)===null||s===void 0||s.call(r)),(o=r.finalize)===null||o===void 0||o.call(r)}))}):y.identity}return es.tap=p,es}var ts={},yf;function D_(){if(yf)return ts;yf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.throttle=void 0;var T=ie(),n=ue(),b=ye();function y(p,t){return T.operate(function(i,a){var r=t??{},c=r.leading,f=c===void 0?!0:c,d=r.trailing,h=d===void 0?!1:d,s=!1,o=null,u=null,m=!1,v=function(){u==null||u.unsubscribe(),u=null,h&&(x(),m&&a.complete())},_=function(){u=null,m&&a.complete()},g=function(E){return u=b.innerFrom(p(E)).subscribe(n.createOperatorSubscriber(a,v,_))},x=function(){if(s){s=!1;var E=o;o=null,a.next(E),!m&&g(E)}};i.subscribe(n.createOperatorSubscriber(a,function(E){s=!0,o=E,!(u&&!u.closed)&&(f?x():g(E))},function(){m=!0,!(h&&s&&u&&!u.closed)&&a.complete()}))})}return ts.throttle=y,ts}var rs={},Ef;function O2(){if(Ef)return rs;Ef=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.throttleTime=void 0;var T=Tt(),n=D_(),b=Ar();function y(p,t,i){t===void 0&&(t=T.asyncScheduler);var a=b.timer(p,t);return n.throttle(function(){return a},i)}return rs.throttleTime=y,rs}var fr={},Tf;function R2(){if(Tf)return fr;Tf=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.TimeInterval=fr.timeInterval=void 0;var T=Tt(),n=ie(),b=ue();function y(t){return t===void 0&&(t=T.asyncScheduler),n.operate(function(i,a){var r=t.now();i.subscribe(b.createOperatorSubscriber(a,function(c){var f=t.now(),d=f-r;r=f,a.next(new p(c,d))}))})}fr.timeInterval=y;var p=function(){function t(i,a){this.value=i,this.interval=a}return t}();return fr.TimeInterval=p,fr}var is={},xf;function w2(){if(xf)return is;xf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.timeoutWith=void 0;var T=Tt(),n=Sl(),b=_l();function y(p,t,i){var a,r,c;if(i=i??T.async,n.isValidDate(p)?a=p:typeof p=="number"&&(r=p),t)c=function(){return t};else throw new TypeError("No observable provided to switch to");if(a==null&&r==null)throw new TypeError("No timeout provided.");return b.timeout({first:a,each:r,scheduler:i,with:c})}return is.timeoutWith=y,is}var ns={},Af;function P2(){if(Af)return ns;Af=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.timestamp=void 0;var T=gl(),n=Tr();function b(y){return y===void 0&&(y=T.dateTimestampProvider),n.map(function(p){return{value:p,timestamp:y.now()}})}return ns.timestamp=b,ns}var as={},Sf;function L2(){if(Sf)return as;Sf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.window=void 0;var T=ct(),n=ie(),b=ue(),y=ut(),p=ye();function t(i){return n.operate(function(a,r){var c=new T.Subject;r.next(c.asObservable());var f=function(d){c.error(d),r.error(d)};return a.subscribe(b.createOperatorSubscriber(r,function(d){return c==null?void 0:c.next(d)},function(){c.complete(),r.complete()},f)),p.innerFrom(i).subscribe(b.createOperatorSubscriber(r,function(){c.complete(),r.next(c=new T.Subject)},y.noop,f)),function(){c==null||c.unsubscribe(),c=null}})}return as.window=t,as}var ss={},Of;function M2(){if(Of)return ss;Of=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ss,"__esModule",{value:!0}),ss.windowCount=void 0;var n=ct(),b=ie(),y=ue();function p(t,i){i===void 0&&(i=0);var a=i>0?i:t;return b.operate(function(r,c){var f=[new n.Subject],d=0;c.next(f[0].asObservable()),r.subscribe(y.createOperatorSubscriber(c,function(h){var s,o;try{for(var u=T(f),m=u.next();!m.done;m=u.next()){var v=m.value;v.next(h)}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}var _=d-t+1;if(_>=0&&_%a===0&&f.shift().complete(),++d%a===0){var g=new n.Subject;f.push(g),c.next(g.asObservable())}},function(){for(;f.length>0;)f.shift().complete();c.complete()},function(h){for(;f.length>0;)f.shift().error(h);c.error(h)},function(){f=null}))})}return ss.windowCount=p,ss}var os={},Rf;function I2(){if(Rf)return os;Rf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.windowTime=void 0;var T=ct(),n=Tt(),b=Ot(),y=ie(),p=ue(),t=Zt(),i=xt(),a=Kt();function r(c){for(var f,d,h=[],s=1;s<arguments.length;s++)h[s-1]=arguments[s];var o=(f=i.popScheduler(h))!==null&&f!==void 0?f:n.asyncScheduler,u=(d=h[0])!==null&&d!==void 0?d:null,m=h[1]||1/0;return y.operate(function(v,_){var g=[],x=!1,E=function(O){var I=O.window,D=O.subs;I.complete(),D.unsubscribe(),t.arrRemove(g,O),x&&w()},w=function(){if(g){var O=new b.Subscription;_.add(O);var I=new T.Subject,D={window:I,subs:O,seen:0};g.push(D),_.next(I.asObservable()),a.executeSchedule(O,o,function(){return E(D)},c)}};u!==null&&u>=0?a.executeSchedule(_,o,w,u,!0):x=!0,w();var S=function(O){return g.slice().forEach(O)},R=function(O){S(function(I){var D=I.window;return O(D)}),O(_),_.unsubscribe()};return v.subscribe(p.createOperatorSubscriber(_,function(O){S(function(I){I.window.next(O),m<=++I.seen&&E(I)})},function(){return R(function(O){return O.complete()})},function(O){return R(function(I){return I.error(O)})})),function(){g=null}})}return os.windowTime=r,os}var us={},wf;function F2(){if(wf)return us;wf=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(us,"__esModule",{value:!0}),us.windowToggle=void 0;var n=ct(),b=Ot(),y=ie(),p=ye(),t=ue(),i=ut(),a=Zt();function r(c,f){return y.operate(function(d,h){var s=[],o=function(u){for(;0<s.length;)s.shift().error(u);h.error(u)};p.innerFrom(c).subscribe(t.createOperatorSubscriber(h,function(u){var m=new n.Subject;s.push(m);var v=new b.Subscription,_=function(){a.arrRemove(s,m),m.complete(),v.unsubscribe()},g;try{g=p.innerFrom(f(u))}catch(x){o(x);return}h.next(m.asObservable()),v.add(g.subscribe(t.createOperatorSubscriber(h,_,i.noop,o)))},i.noop)),d.subscribe(t.createOperatorSubscriber(h,function(u){var m,v,_=s.slice();try{for(var g=T(_),x=g.next();!x.done;x=g.next()){var E=x.value;E.next(u)}}catch(w){m={error:w}}finally{try{x&&!x.done&&(v=g.return)&&v.call(g)}finally{if(m)throw m.error}}},function(){for(;0<s.length;)s.shift().complete();h.complete()},o,function(){for(;0<s.length;)s.shift().unsubscribe()}))})}return us.windowToggle=r,us}var ls={},Pf;function C2(){if(Pf)return ls;Pf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.windowWhen=void 0;var T=ct(),n=ie(),b=ue(),y=ye();function p(t){return n.operate(function(i,a){var r,c,f=function(h){r.error(h),a.error(h)},d=function(){c==null||c.unsubscribe(),r==null||r.complete(),r=new T.Subject,a.next(r.asObservable());var h;try{h=y.innerFrom(t())}catch(s){f(s);return}h.subscribe(c=b.createOperatorSubscriber(a,d,d,f))};d(),i.subscribe(b.createOperatorSubscriber(a,function(h){return r.next(h)},function(){r.complete(),a.complete()},f,function(){c==null||c.unsubscribe(),r=null}))})}return ls.windowWhen=p,ls}var cs={},Lf;function N2(){if(Lf)return cs;Lf=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,o=[],u;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)o.push(s.value)}catch(m){u={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return o},n=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(cs,"__esModule",{value:!0}),cs.withLatestFrom=void 0;var b=ie(),y=ue(),p=ye(),t=lt(),i=ut(),a=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=a.popResultSelector(c);return b.operate(function(h,s){for(var o=c.length,u=new Array(o),m=c.map(function(){return!1}),v=!1,_=function(x){p.innerFrom(c[x]).subscribe(y.createOperatorSubscriber(s,function(E){u[x]=E,!v&&!m[x]&&(m[x]=!0,(v=m.every(t.identity))&&(m=null))},i.noop))},g=0;g<o;g++)_(g);h.subscribe(y.createOperatorSubscriber(s,function(x){if(v){var E=n([x],T(u));s.next(d?d.apply(void 0,n([],T(E))):E)}}))})}return cs.withLatestFrom=r,cs}var hs={},Mf;function z2(){if(Mf)return hs;Mf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.zipAll=void 0;var T=Pl(),n=S_();function b(y){return n.joinAllInternals(T.zip,y)}return hs.zipAll=b,hs}var ds={},fs={},If;function B2(){if(If)return fs;If=1;var T=H&&H.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return f},n=H&&H.__spreadArray||function(t,i){for(var a=0,r=i.length,c=t.length;a<r;a++,c++)t[c]=i[a];return t};Object.defineProperty(fs,"__esModule",{value:!0}),fs.zip=void 0;var b=Pl(),y=ie();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return y.operate(function(a,r){b.zip.apply(void 0,n([a],T(t))).subscribe(r)})}return fs.zip=p,fs}var Ff;function D2(){if(Ff)return ds;Ff=1;var T=H&&H.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(f)throw f.error}}return c},n=H&&H.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(ds,"__esModule",{value:!0}),ds.zipWith=void 0;var b=B2();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return b.zip.apply(void 0,n([],T(p)))}return ds.zipWith=y,ds}var Cf;function j_(){return Cf||(Cf=1,function(T){var n=H&&H.__createBinding||(Object.create?function(Xt,Yt,Pt,qt){qt===void 0&&(qt=Pt),Object.defineProperty(Xt,qt,{enumerable:!0,get:function(){return Yt[Pt]}})}:function(Xt,Yt,Pt,qt){qt===void 0&&(qt=Pt),Xt[qt]=Yt[Pt]}),b=H&&H.__exportStar||function(Xt,Yt){for(var Pt in Xt)Pt!=="default"&&!Object.prototype.hasOwnProperty.call(Yt,Pt)&&n(Yt,Xt,Pt)};Object.defineProperty(T,"__esModule",{value:!0}),T.interval=T.iif=T.generate=T.fromEventPattern=T.fromEvent=T.from=T.forkJoin=T.empty=T.defer=T.connectable=T.concat=T.combineLatest=T.bindNodeCallback=T.bindCallback=T.UnsubscriptionError=T.TimeoutError=T.SequenceError=T.ObjectUnsubscribedError=T.NotFoundError=T.EmptyError=T.ArgumentOutOfRangeError=T.firstValueFrom=T.lastValueFrom=T.isObservable=T.identity=T.noop=T.pipe=T.NotificationKind=T.Notification=T.Subscriber=T.Subscription=T.Scheduler=T.VirtualAction=T.VirtualTimeScheduler=T.animationFrameScheduler=T.animationFrame=T.queueScheduler=T.queue=T.asyncScheduler=T.async=T.asapScheduler=T.asap=T.AsyncSubject=T.ReplaySubject=T.BehaviorSubject=T.Subject=T.animationFrames=T.observable=T.ConnectableObservable=T.Observable=void 0,T.filter=T.expand=T.exhaustMap=T.exhaustAll=T.exhaust=T.every=T.endWith=T.elementAt=T.distinctUntilKeyChanged=T.distinctUntilChanged=T.distinct=T.dematerialize=T.delayWhen=T.delay=T.defaultIfEmpty=T.debounceTime=T.debounce=T.count=T.connect=T.concatWith=T.concatMapTo=T.concatMap=T.concatAll=T.combineLatestWith=T.combineLatestAll=T.combineAll=T.catchError=T.bufferWhen=T.bufferToggle=T.bufferTime=T.bufferCount=T.buffer=T.auditTime=T.audit=T.config=T.NEVER=T.EMPTY=T.scheduled=T.zip=T.using=T.timer=T.throwError=T.range=T.race=T.partition=T.pairs=T.onErrorResumeNext=T.of=T.never=T.merge=void 0,T.switchMap=T.switchAll=T.subscribeOn=T.startWith=T.skipWhile=T.skipUntil=T.skipLast=T.skip=T.single=T.shareReplay=T.share=T.sequenceEqual=T.scan=T.sampleTime=T.sample=T.refCount=T.retryWhen=T.retry=T.repeatWhen=T.repeat=T.reduce=T.raceWith=T.publishReplay=T.publishLast=T.publishBehavior=T.publish=T.pluck=T.pairwise=T.onErrorResumeNextWith=T.observeOn=T.multicast=T.min=T.mergeWith=T.mergeScan=T.mergeMapTo=T.mergeMap=T.flatMap=T.mergeAll=T.max=T.materialize=T.mapTo=T.map=T.last=T.isEmpty=T.ignoreElements=T.groupBy=T.first=T.findIndex=T.find=T.finalize=void 0,T.zipWith=T.zipAll=T.withLatestFrom=T.windowWhen=T.windowToggle=T.windowTime=T.windowCount=T.window=T.toArray=T.timestamp=T.timeoutWith=T.timeout=T.timeInterval=T.throwIfEmpty=T.throttleTime=T.throttle=T.tap=T.takeWhile=T.takeUntil=T.takeLast=T.take=T.switchScan=T.switchMapTo=void 0;var y=ze();Object.defineProperty(T,"Observable",{enumerable:!0,get:function(){return y.Observable}});var p=ao();Object.defineProperty(T,"ConnectableObservable",{enumerable:!0,get:function(){return p.ConnectableObservable}});var t=io();Object.defineProperty(T,"observable",{enumerable:!0,get:function(){return t.observable}});var i=Pv();Object.defineProperty(T,"animationFrames",{enumerable:!0,get:function(){return i.animationFrames}});var a=ct();Object.defineProperty(T,"Subject",{enumerable:!0,get:function(){return a.Subject}});var r=t_();Object.defineProperty(T,"BehaviorSubject",{enumerable:!0,get:function(){return r.BehaviorSubject}});var c=bl();Object.defineProperty(T,"ReplaySubject",{enumerable:!0,get:function(){return c.ReplaySubject}});var f=yl();Object.defineProperty(T,"AsyncSubject",{enumerable:!0,get:function(){return f.AsyncSubject}});var d=zv();Object.defineProperty(T,"asap",{enumerable:!0,get:function(){return d.asap}}),Object.defineProperty(T,"asapScheduler",{enumerable:!0,get:function(){return d.asapScheduler}});var h=Tt();Object.defineProperty(T,"async",{enumerable:!0,get:function(){return h.async}}),Object.defineProperty(T,"asyncScheduler",{enumerable:!0,get:function(){return h.asyncScheduler}});var s=jv();Object.defineProperty(T,"queue",{enumerable:!0,get:function(){return s.queue}}),Object.defineProperty(T,"queueScheduler",{enumerable:!0,get:function(){return s.queueScheduler}});var o=Gv();Object.defineProperty(T,"animationFrame",{enumerable:!0,get:function(){return o.animationFrame}}),Object.defineProperty(T,"animationFrameScheduler",{enumerable:!0,get:function(){return o.animationFrameScheduler}});var u=qv();Object.defineProperty(T,"VirtualTimeScheduler",{enumerable:!0,get:function(){return u.VirtualTimeScheduler}}),Object.defineProperty(T,"VirtualAction",{enumerable:!0,get:function(){return u.VirtualAction}});var m=r_();Object.defineProperty(T,"Scheduler",{enumerable:!0,get:function(){return m.Scheduler}});var v=Ot();Object.defineProperty(T,"Subscription",{enumerable:!0,get:function(){return v.Subscription}});var _=Es();Object.defineProperty(T,"Subscriber",{enumerable:!0,get:function(){return _.Subscriber}});var g=Al();Object.defineProperty(T,"Notification",{enumerable:!0,get:function(){return g.Notification}}),Object.defineProperty(T,"NotificationKind",{enumerable:!0,get:function(){return g.NotificationKind}});var x=no();Object.defineProperty(T,"pipe",{enumerable:!0,get:function(){return x.pipe}});var E=ut();Object.defineProperty(T,"noop",{enumerable:!0,get:function(){return E.noop}});var w=lt();Object.defineProperty(T,"identity",{enumerable:!0,get:function(){return w.identity}});var S=Xv();Object.defineProperty(T,"isObservable",{enumerable:!0,get:function(){return S.isObservable}});var R=Yv();Object.defineProperty(T,"lastValueFrom",{enumerable:!0,get:function(){return R.lastValueFrom}});var O=Zv();Object.defineProperty(T,"firstValueFrom",{enumerable:!0,get:function(){return O.firstValueFrom}});var I=f_();Object.defineProperty(T,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return I.ArgumentOutOfRangeError}});var D=Er();Object.defineProperty(T,"EmptyError",{enumerable:!0,get:function(){return D.EmptyError}});var j=__();Object.defineProperty(T,"NotFoundError",{enumerable:!0,get:function(){return j.NotFoundError}});var k=e_();Object.defineProperty(T,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return k.ObjectUnsubscribedError}});var G=p_();Object.defineProperty(T,"SequenceError",{enumerable:!0,get:function(){return G.SequenceError}});var Z=_l();Object.defineProperty(T,"TimeoutError",{enumerable:!0,get:function(){return Z.TimeoutError}});var K=Yf();Object.defineProperty(T,"UnsubscriptionError",{enumerable:!0,get:function(){return K.UnsubscriptionError}});var Y=Kv();Object.defineProperty(T,"bindCallback",{enumerable:!0,get:function(){return Y.bindCallback}});var re=Qv();Object.defineProperty(T,"bindNodeCallback",{enumerable:!0,get:function(){return re.bindNodeCallback}});var Q=Ol();Object.defineProperty(T,"combineLatest",{enumerable:!0,get:function(){return Q.combineLatest}});var ae=co();Object.defineProperty(T,"concat",{enumerable:!0,get:function(){return ae.concat}});var se=Jv();Object.defineProperty(T,"connectable",{enumerable:!0,get:function(){return se.connectable}});var ee=ho();Object.defineProperty(T,"defer",{enumerable:!0,get:function(){return ee.defer}});var le=kt();Object.defineProperty(T,"empty",{enumerable:!0,get:function(){return le.empty}});var ge=em();Object.defineProperty(T,"forkJoin",{enumerable:!0,get:function(){return ge.forkJoin}});var ve=Qt();Object.defineProperty(T,"from",{enumerable:!0,get:function(){return ve.from}});var ne=tm();Object.defineProperty(T,"fromEvent",{enumerable:!0,get:function(){return ne.fromEvent}});var be=rm();Object.defineProperty(T,"fromEventPattern",{enumerable:!0,get:function(){return be.fromEventPattern}});var Te=im();Object.defineProperty(T,"generate",{enumerable:!0,get:function(){return Te.generate}});var oe=nm();Object.defineProperty(T,"iif",{enumerable:!0,get:function(){return oe.iif}});var me=b_();Object.defineProperty(T,"interval",{enumerable:!0,get:function(){return me.interval}});var Ee=am();Object.defineProperty(T,"merge",{enumerable:!0,get:function(){return Ee.merge}});var Oe=Ad();Object.defineProperty(T,"never",{enumerable:!0,get:function(){return Oe.never}});var xe=xl();Object.defineProperty(T,"of",{enumerable:!0,get:function(){return xe.of}});var ke=y_();Object.defineProperty(T,"onErrorResumeNext",{enumerable:!0,get:function(){return ke.onErrorResumeNext}});var Le=sm();Object.defineProperty(T,"pairs",{enumerable:!0,get:function(){return Le.pairs}});var Re=um();Object.defineProperty(T,"partition",{enumerable:!0,get:function(){return Re.partition}});var Ye=E_();Object.defineProperty(T,"race",{enumerable:!0,get:function(){return Ye.race}});var qe=lm();Object.defineProperty(T,"range",{enumerable:!0,get:function(){return qe.range}});var rt=d_();Object.defineProperty(T,"throwError",{enumerable:!0,get:function(){return rt.throwError}});var ht=Ar();Object.defineProperty(T,"timer",{enumerable:!0,get:function(){return ht.timer}});var $e=cm();Object.defineProperty(T,"using",{enumerable:!0,get:function(){return $e.using}});var Me=Pl();Object.defineProperty(T,"zip",{enumerable:!0,get:function(){return Me.zip}});var Be=h_();Object.defineProperty(T,"scheduled",{enumerable:!0,get:function(){return Be.scheduled}});var yt=kt();Object.defineProperty(T,"EMPTY",{enumerable:!0,get:function(){return yt.EMPTY}});var we=Ad();Object.defineProperty(T,"NEVER",{enumerable:!0,get:function(){return we.NEVER}}),b(hm(),T);var At=ys();Object.defineProperty(T,"config",{enumerable:!0,get:function(){return At.config}});var dt=T_();Object.defineProperty(T,"audit",{enumerable:!0,get:function(){return dt.audit}});var Et=dm();Object.defineProperty(T,"auditTime",{enumerable:!0,get:function(){return Et.auditTime}});var ft=fm();Object.defineProperty(T,"buffer",{enumerable:!0,get:function(){return ft.buffer}});var mt=_m();Object.defineProperty(T,"bufferCount",{enumerable:!0,get:function(){return mt.bufferCount}});var gt=pm();Object.defineProperty(T,"bufferTime",{enumerable:!0,get:function(){return gt.bufferTime}});var tt=vm();Object.defineProperty(T,"bufferToggle",{enumerable:!0,get:function(){return tt.bufferToggle}});var Bt=mm();Object.defineProperty(T,"bufferWhen",{enumerable:!0,get:function(){return Bt.bufferWhen}});var Qe=gm();Object.defineProperty(T,"catchError",{enumerable:!0,get:function(){return Qe.catchError}});var Rt=bm();Object.defineProperty(T,"combineAll",{enumerable:!0,get:function(){return Rt.combineAll}});var Gt=O_();Object.defineProperty(T,"combineLatestAll",{enumerable:!0,get:function(){return Gt.combineLatestAll}});var Nr=Em();Object.defineProperty(T,"combineLatestWith",{enumerable:!0,get:function(){return Nr.combineLatestWith}});var zr=wl();Object.defineProperty(T,"concatAll",{enumerable:!0,get:function(){return zr.concatAll}});var Ue=R_();Object.defineProperty(T,"concatMap",{enumerable:!0,get:function(){return Ue.concatMap}});var Je=Tm();Object.defineProperty(T,"concatMapTo",{enumerable:!0,get:function(){return Je.concatMapTo}});var it=Am();Object.defineProperty(T,"concatWith",{enumerable:!0,get:function(){return it.concatWith}});var wt=Ll();Object.defineProperty(T,"connect",{enumerable:!0,get:function(){return wt.connect}});var Dt=Om();Object.defineProperty(T,"count",{enumerable:!0,get:function(){return Dt.count}});var mo=Rm();Object.defineProperty(T,"debounce",{enumerable:!0,get:function(){return mo.debounce}});var go=wm();Object.defineProperty(T,"debounceTime",{enumerable:!0,get:function(){return go.debounceTime}});var bo=fo();Object.defineProperty(T,"defaultIfEmpty",{enumerable:!0,get:function(){return bo.defaultIfEmpty}});var yo=Pm();Object.defineProperty(T,"delay",{enumerable:!0,get:function(){return yo.delay}});var Eo=L_();Object.defineProperty(T,"delayWhen",{enumerable:!0,get:function(){return Eo.delayWhen}});var To=Lm();Object.defineProperty(T,"dematerialize",{enumerable:!0,get:function(){return To.dematerialize}});var ws=Mm();Object.defineProperty(T,"distinct",{enumerable:!0,get:function(){return ws.distinct}});var xo=M_();Object.defineProperty(T,"distinctUntilChanged",{enumerable:!0,get:function(){return xo.distinctUntilChanged}});var Ao=Im();Object.defineProperty(T,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Ao.distinctUntilKeyChanged}});var So=Fm();Object.defineProperty(T,"elementAt",{enumerable:!0,get:function(){return So.elementAt}});var Oo=Cm();Object.defineProperty(T,"endWith",{enumerable:!0,get:function(){return Oo.endWith}});var Ro=Nm();Object.defineProperty(T,"every",{enumerable:!0,get:function(){return Ro.every}});var wo=zm();Object.defineProperty(T,"exhaust",{enumerable:!0,get:function(){return wo.exhaust}});var Po=F_();Object.defineProperty(T,"exhaustAll",{enumerable:!0,get:function(){return Po.exhaustAll}});var Lo=I_();Object.defineProperty(T,"exhaustMap",{enumerable:!0,get:function(){return Lo.exhaustMap}});var Mo=Bm();Object.defineProperty(T,"expand",{enumerable:!0,get:function(){return Mo.expand}});var Io=Lr();Object.defineProperty(T,"filter",{enumerable:!0,get:function(){return Io.filter}});var Fo=Dm();Object.defineProperty(T,"finalize",{enumerable:!0,get:function(){return Fo.finalize}});var Co=C_();Object.defineProperty(T,"find",{enumerable:!0,get:function(){return Co.find}});var No=jm();Object.defineProperty(T,"findIndex",{enumerable:!0,get:function(){return No.findIndex}});var Ps=km();Object.defineProperty(T,"first",{enumerable:!0,get:function(){return Ps.first}});var zo=Um();Object.defineProperty(T,"groupBy",{enumerable:!0,get:function(){return zo.groupBy}});var Bo=w_();Object.defineProperty(T,"ignoreElements",{enumerable:!0,get:function(){return Bo.ignoreElements}});var Do=Gm();Object.defineProperty(T,"isEmpty",{enumerable:!0,get:function(){return Do.isEmpty}});var jo=qm();Object.defineProperty(T,"last",{enumerable:!0,get:function(){return jo.last}});var ko=Tr();Object.defineProperty(T,"map",{enumerable:!0,get:function(){return ko.map}});var Uo=P_();Object.defineProperty(T,"mapTo",{enumerable:!0,get:function(){return Uo.mapTo}});var Go=Wm();Object.defineProperty(T,"materialize",{enumerable:!0,get:function(){return Go.materialize}});var qo=Vm();Object.defineProperty(T,"max",{enumerable:!0,get:function(){return qo.max}});var Wo=lo();Object.defineProperty(T,"mergeAll",{enumerable:!0,get:function(){return Wo.mergeAll}});var Vo=$m();Object.defineProperty(T,"flatMap",{enumerable:!0,get:function(){return Vo.flatMap}});var $o=Jt();Object.defineProperty(T,"mergeMap",{enumerable:!0,get:function(){return $o.mergeMap}});var Ls=Hm();Object.defineProperty(T,"mergeMapTo",{enumerable:!0,get:function(){return Ls.mergeMapTo}});var Ho=Xm();Object.defineProperty(T,"mergeScan",{enumerable:!0,get:function(){return Ho.mergeScan}});var Xo=Zm();Object.defineProperty(T,"mergeWith",{enumerable:!0,get:function(){return Xo.mergeWith}});var Yo=Km();Object.defineProperty(T,"min",{enumerable:!0,get:function(){return Yo.min}});var Zo=Ml();Object.defineProperty(T,"multicast",{enumerable:!0,get:function(){return Zo.multicast}});var Ms=oo();Object.defineProperty(T,"observeOn",{enumerable:!0,get:function(){return Ms.observeOn}});var Ko=Qm();Object.defineProperty(T,"onErrorResumeNextWith",{enumerable:!0,get:function(){return Ko.onErrorResumeNextWith}});var Qo=Jm();Object.defineProperty(T,"pairwise",{enumerable:!0,get:function(){return Qo.pairwise}});var Jo=e2();Object.defineProperty(T,"pluck",{enumerable:!0,get:function(){return Jo.pluck}});var eu=t2();Object.defineProperty(T,"publish",{enumerable:!0,get:function(){return eu.publish}});var tu=r2();Object.defineProperty(T,"publishBehavior",{enumerable:!0,get:function(){return tu.publishBehavior}});var ru=i2();Object.defineProperty(T,"publishLast",{enumerable:!0,get:function(){return ru.publishLast}});var iu=n2();Object.defineProperty(T,"publishReplay",{enumerable:!0,get:function(){return iu.publishReplay}});var nu=a2();Object.defineProperty(T,"raceWith",{enumerable:!0,get:function(){return nu.raceWith}});var au=As();Object.defineProperty(T,"reduce",{enumerable:!0,get:function(){return au.reduce}});var su=s2();Object.defineProperty(T,"repeat",{enumerable:!0,get:function(){return su.repeat}});var ou=o2();Object.defineProperty(T,"repeatWhen",{enumerable:!0,get:function(){return ou.repeatWhen}});var uu=u2();Object.defineProperty(T,"retry",{enumerable:!0,get:function(){return uu.retry}});var Is=l2();Object.defineProperty(T,"retryWhen",{enumerable:!0,get:function(){return Is.retryWhen}});var lu=Qf();Object.defineProperty(T,"refCount",{enumerable:!0,get:function(){return lu.refCount}});var Fs=z_();Object.defineProperty(T,"sample",{enumerable:!0,get:function(){return Fs.sample}});var Cs=c2();Object.defineProperty(T,"sampleTime",{enumerable:!0,get:function(){return Cs.sampleTime}});var Ns=h2();Object.defineProperty(T,"scan",{enumerable:!0,get:function(){return Ns.scan}});var cu=d2();Object.defineProperty(T,"sequenceEqual",{enumerable:!0,get:function(){return cu.sequenceEqual}});var hu=B_();Object.defineProperty(T,"share",{enumerable:!0,get:function(){return hu.share}});var du=f2();Object.defineProperty(T,"shareReplay",{enumerable:!0,get:function(){return du.shareReplay}});var fu=_2();Object.defineProperty(T,"single",{enumerable:!0,get:function(){return fu.single}});var zs=p2();Object.defineProperty(T,"skip",{enumerable:!0,get:function(){return zs.skip}});var _u=v2();Object.defineProperty(T,"skipLast",{enumerable:!0,get:function(){return _u.skipLast}});var pu=m2();Object.defineProperty(T,"skipUntil",{enumerable:!0,get:function(){return pu.skipUntil}});var vu=g2();Object.defineProperty(T,"skipWhile",{enumerable:!0,get:function(){return vu.skipWhile}});var Bs=b2();Object.defineProperty(T,"startWith",{enumerable:!0,get:function(){return Bs.startWith}});var mu=uo();Object.defineProperty(T,"subscribeOn",{enumerable:!0,get:function(){return mu.subscribeOn}});var gu=y2();Object.defineProperty(T,"switchAll",{enumerable:!0,get:function(){return gu.switchAll}});var bu=vo();Object.defineProperty(T,"switchMap",{enumerable:!0,get:function(){return bu.switchMap}});var yu=E2();Object.defineProperty(T,"switchMapTo",{enumerable:!0,get:function(){return yu.switchMapTo}});var Eu=T2();Object.defineProperty(T,"switchScan",{enumerable:!0,get:function(){return Eu.switchScan}});var Tu=_o();Object.defineProperty(T,"take",{enumerable:!0,get:function(){return Tu.take}});var xu=N_();Object.defineProperty(T,"takeLast",{enumerable:!0,get:function(){return xu.takeLast}});var Ds=x2();Object.defineProperty(T,"takeUntil",{enumerable:!0,get:function(){return Ds.takeUntil}});var Au=A2();Object.defineProperty(T,"takeWhile",{enumerable:!0,get:function(){return Au.takeWhile}});var Su=S2();Object.defineProperty(T,"tap",{enumerable:!0,get:function(){return Su.tap}});var Ou=D_();Object.defineProperty(T,"throttle",{enumerable:!0,get:function(){return Ou.throttle}});var Ru=O2();Object.defineProperty(T,"throttleTime",{enumerable:!0,get:function(){return Ru.throttleTime}});var wu=po();Object.defineProperty(T,"throwIfEmpty",{enumerable:!0,get:function(){return wu.throwIfEmpty}});var Pu=R2();Object.defineProperty(T,"timeInterval",{enumerable:!0,get:function(){return Pu.timeInterval}});var Br=_l();Object.defineProperty(T,"timeout",{enumerable:!0,get:function(){return Br.timeout}});var Lu=w2();Object.defineProperty(T,"timeoutWith",{enumerable:!0,get:function(){return Lu.timeoutWith}});var js=P2();Object.defineProperty(T,"timestamp",{enumerable:!0,get:function(){return js.timestamp}});var Dr=A_();Object.defineProperty(T,"toArray",{enumerable:!0,get:function(){return Dr.toArray}});var Mu=L2();Object.defineProperty(T,"window",{enumerable:!0,get:function(){return Mu.window}});var Iu=M2();Object.defineProperty(T,"windowCount",{enumerable:!0,get:function(){return Iu.windowCount}});var Fu=I2();Object.defineProperty(T,"windowTime",{enumerable:!0,get:function(){return Fu.windowTime}});var ks=F2();Object.defineProperty(T,"windowToggle",{enumerable:!0,get:function(){return ks.windowToggle}});var Us=C2();Object.defineProperty(T,"windowWhen",{enumerable:!0,get:function(){return Us.windowWhen}});var Gs=N2();Object.defineProperty(T,"withLatestFrom",{enumerable:!0,get:function(){return Gs.withLatestFrom}});var Cu=z2();Object.defineProperty(T,"zipAll",{enumerable:!0,get:function(){return Cu.zipAll}});var Nu=D2();Object.defineProperty(T,"zipWith",{enumerable:!0,get:function(){return Nu.zipWith}})}($u)),$u}(()=>{var T={3557:(p,t,i)=>{i.r(t),i.d(t,{glMatrix:()=>a,mat2:()=>r,mat2d:()=>c,mat3:()=>f,mat4:()=>d,quat:()=>o,quat2:()=>u,vec2:()=>m,vec3:()=>h,vec4:()=>s});var a={};i.r(a),i.d(a,{ARRAY_TYPE:()=>_,EPSILON:()=>v,RANDOM:()=>g,equals:()=>S,setMatrixArrayType:()=>x,toRadian:()=>w});var r={};i.r(r),i.d(r,{LDU:()=>ve,add:()=>ne,adjoint:()=>K,clone:()=>O,copy:()=>I,create:()=>R,determinant:()=>Y,equals:()=>oe,exactEquals:()=>Te,frob:()=>ge,fromRotation:()=>se,fromScaling:()=>ee,fromValues:()=>j,identity:()=>D,invert:()=>Z,mul:()=>Oe,multiply:()=>re,multiplyScalar:()=>me,multiplyScalarAndAdd:()=>Ee,rotate:()=>Q,scale:()=>ae,set:()=>k,str:()=>le,sub:()=>xe,subtract:()=>be,transpose:()=>G});var c={};i.r(c),i.d(c,{add:()=>gt,clone:()=>Le,copy:()=>Re,create:()=>ke,determinant:()=>$e,equals:()=>Gt,exactEquals:()=>Rt,frob:()=>mt,fromRotation:()=>At,fromScaling:()=>dt,fromTranslation:()=>Et,fromValues:()=>qe,identity:()=>Ye,invert:()=>ht,mul:()=>Nr,multiply:()=>Me,multiplyScalar:()=>Bt,multiplyScalarAndAdd:()=>Qe,rotate:()=>Be,scale:()=>yt,set:()=>rt,str:()=>ft,sub:()=>zr,subtract:()=>tt,translate:()=>we});var f={};i.r(f),i.d(f,{add:()=>No,adjoint:()=>Eo,clone:()=>it,copy:()=>wt,create:()=>Ue,determinant:()=>To,equals:()=>jo,exactEquals:()=>Do,frob:()=>Co,fromMat2d:()=>Po,fromMat4:()=>Je,fromQuat:()=>Lo,fromRotation:()=>Ro,fromScaling:()=>wo,fromTranslation:()=>Oo,fromValues:()=>Dt,identity:()=>go,invert:()=>yo,mul:()=>ko,multiply:()=>ws,multiplyScalar:()=>zo,multiplyScalarAndAdd:()=>Bo,normalFromMat4:()=>Mo,projection:()=>Io,rotate:()=>Ao,scale:()=>So,set:()=>mo,str:()=>Fo,sub:()=>Uo,subtract:()=>Ps,translate:()=>xo,transpose:()=>bo});var d={};i.r(d),i.d(d,{add:()=>xu,adjoint:()=>Yo,clone:()=>qo,copy:()=>Wo,create:()=>Go,determinant:()=>Zo,equals:()=>Ru,exactEquals:()=>Ou,frob:()=>Tu,fromQuat:()=>du,fromQuat2:()=>lu,fromRotation:()=>au,fromRotationTranslation:()=>Is,fromRotationTranslationScale:()=>cu,fromRotationTranslationScaleOrigin:()=>hu,fromScaling:()=>nu,fromTranslation:()=>iu,fromValues:()=>Vo,fromXRotation:()=>su,fromYRotation:()=>ou,fromZRotation:()=>uu,frustum:()=>fu,getRotation:()=>Ns,getScaling:()=>Cs,getTranslation:()=>Fs,identity:()=>Ls,invert:()=>Xo,lookAt:()=>bu,mul:()=>wu,multiply:()=>Ms,multiplyScalar:()=>Au,multiplyScalarAndAdd:()=>Su,ortho:()=>mu,orthoNO:()=>Bs,orthoZO:()=>gu,perspective:()=>_u,perspectiveFromFieldOfView:()=>vu,perspectiveNO:()=>zs,perspectiveZO:()=>pu,rotate:()=>Jo,rotateX:()=>eu,rotateY:()=>tu,rotateZ:()=>ru,scale:()=>Qo,set:()=>$o,str:()=>Eu,sub:()=>Pu,subtract:()=>Ds,targetTo:()=>yu,translate:()=>Ko,transpose:()=>Ho});var h={};i.r(h),i.d(h,{add:()=>Fu,angle:()=>s1,bezier:()=>Q_,ceil:()=>Cu,clone:()=>Lu,copy:()=>Mu,create:()=>Br,cross:()=>qs,dist:()=>_1,distance:()=>Il,div:()=>f1,divide:()=>Gs,dot:()=>zu,equals:()=>c1,exactEquals:()=>l1,floor:()=>Nu,forEach:()=>m1,fromValues:()=>Dr,hermite:()=>K_,inverse:()=>Y_,len:()=>zl,length:()=>js,lerp:()=>Z_,max:()=>Yt,min:()=>Xt,mul:()=>d1,multiply:()=>Us,negate:()=>X_,normalize:()=>Nl,random:()=>J_,rotateX:()=>i1,rotateY:()=>n1,rotateZ:()=>a1,round:()=>Pt,scale:()=>qt,scaleAndAdd:()=>H_,set:()=>Iu,sqrDist:()=>p1,sqrLen:()=>v1,squaredDistance:()=>Fl,squaredLength:()=>Cl,str:()=>u1,sub:()=>h1,subtract:()=>ks,transformMat3:()=>t1,transformMat4:()=>e1,transformQuat:()=>r1,zero:()=>o1});var s={};i.r(s),i.d(s,{add:()=>Gl,ceil:()=>g1,clone:()=>Dl,copy:()=>kl,create:()=>Bl,cross:()=>O1,dist:()=>N1,distance:()=>Hl,div:()=>C1,divide:()=>Vl,dot:()=>Zl,equals:()=>Jl,exactEquals:()=>Ql,floor:()=>b1,forEach:()=>j1,fromValues:()=>jl,inverse:()=>S1,len:()=>B1,length:()=>Bu,lerp:()=>Kl,max:()=>E1,min:()=>y1,mul:()=>F1,multiply:()=>Wl,negate:()=>A1,normalize:()=>Yl,random:()=>R1,round:()=>T1,scale:()=>$l,scaleAndAdd:()=>x1,set:()=>Ul,sqrDist:()=>z1,sqrLen:()=>D1,squaredDistance:()=>Xl,squaredLength:()=>Du,str:()=>M1,sub:()=>I1,subtract:()=>ql,transformMat4:()=>w1,transformQuat:()=>P1,zero:()=>L1});var o={};i.r(o),i.d(o,{add:()=>J1,calculateW:()=>q1,clone:()=>Z1,conjugate:()=>H1,copy:()=>Uu,create:()=>Ws,dot:()=>Gu,equals:()=>ap,exactEquals:()=>np,exp:()=>ac,fromEuler:()=>X1,fromMat3:()=>oc,fromValues:()=>K1,getAngle:()=>G1,getAxisAngle:()=>U1,identity:()=>k1,invert:()=>$1,len:()=>rp,length:()=>qu,lerp:()=>tp,ln:()=>sc,mul:()=>ep,multiply:()=>tc,normalize:()=>Vu,pow:()=>W1,random:()=>V1,rotateX:()=>rc,rotateY:()=>ic,rotateZ:()=>nc,rotationTo:()=>sp,scale:()=>cc,set:()=>Q1,setAxes:()=>up,setAxisAngle:()=>ec,slerp:()=>Vs,sqlerp:()=>op,sqrLen:()=>ip,squaredLength:()=>Wu,str:()=>Y1});var u={};i.r(u),i.d(u,{add:()=>Lp,clone:()=>cp,conjugate:()=>Np,copy:()=>dc,create:()=>lp,dot:()=>_c,equals:()=>Up,exactEquals:()=>kp,fromMat4:()=>pp,fromRotation:()=>_p,fromRotationTranslation:()=>hc,fromRotationTranslationValues:()=>dp,fromTranslation:()=>fp,fromValues:()=>hp,getDual:()=>bp,getReal:()=>gp,getTranslation:()=>Tp,identity:()=>vp,invert:()=>Cp,len:()=>zp,length:()=>pc,lerp:()=>Fp,mul:()=>Mp,multiply:()=>fc,normalize:()=>Dp,rotateAroundAxis:()=>Pp,rotateByQuatAppend:()=>Rp,rotateByQuatPrepend:()=>wp,rotateX:()=>Ap,rotateY:()=>Sp,rotateZ:()=>Op,scale:()=>Ip,set:()=>mp,setDual:()=>Ep,setReal:()=>yp,sqrLen:()=>Bp,squaredLength:()=>$s,str:()=>jp,translate:()=>xp});var m={};i.r(m),i.d(m,{add:()=>$p,angle:()=>dv,ceil:()=>Hp,clone:()=>Gp,copy:()=>Wp,create:()=>vc,cross:()=>nv,dist:()=>Ev,distance:()=>yc,div:()=>yv,divide:()=>bc,dot:()=>iv,equals:()=>vv,exactEquals:()=>pv,floor:()=>Xp,forEach:()=>Av,fromValues:()=>qp,inverse:()=>tv,len:()=>mv,length:()=>Tc,lerp:()=>av,max:()=>Zp,min:()=>Yp,mul:()=>bv,multiply:()=>gc,negate:()=>ev,normalize:()=>rv,random:()=>sv,rotate:()=>hv,round:()=>Kp,scale:()=>Qp,scaleAndAdd:()=>Jp,set:()=>Vp,sqrDist:()=>Tv,sqrLen:()=>xv,squaredDistance:()=>Ec,squaredLength:()=>xc,str:()=>_v,sub:()=>gv,subtract:()=>mc,transformMat2:()=>ov,transformMat2d:()=>uv,transformMat3:()=>lv,transformMat4:()=>cv,zero:()=>fv});var v=1e-6,_=typeof Float32Array<"u"?Float32Array:Array,g=Math.random;function x(e){_=e}var E=Math.PI/180;function w(e){return e*E}function S(e,l){return Math.abs(e-l)<=v*Math.max(1,Math.abs(e),Math.abs(l))}function R(){var e=new _(4);return _!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function O(e){var l=new _(4);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l}function I(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e}function D(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function j(e,l,A,P){var L=new _(4);return L[0]=e,L[1]=l,L[2]=A,L[3]=P,L}function k(e,l,A,P,L){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e}function G(e,l){if(e===l){var A=l[1];e[1]=l[2],e[2]=A}else e[0]=l[0],e[1]=l[2],e[2]=l[1],e[3]=l[3];return e}function Z(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*M-L*P;return F?(F=1/F,e[0]=M*F,e[1]=-P*F,e[2]=-L*F,e[3]=A*F,e):null}function K(e,l){var A=l[0];return e[0]=l[3],e[1]=-l[1],e[2]=-l[2],e[3]=A,e}function Y(e){return e[0]*e[3]-e[2]*e[1]}function re(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*C+M*z,e[1]=L*C+F*z,e[2]=P*B+M*U,e[3]=L*B+F*U,e}function Q(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+M*C,e[1]=L*z+F*C,e[2]=P*-C+M*z,e[3]=L*-C+F*z,e}function ae(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1];return e[0]=P*C,e[1]=L*C,e[2]=M*z,e[3]=F*z,e}function se(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=-A,e[3]=P,e}function ee(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=l[1],e}function le(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ge(e){return Math.hypot(e[0],e[1],e[2],e[3])}function ve(e,l,A,P){return e[2]=P[2]/P[0],A[0]=P[0],A[1]=P[1],A[3]=P[3]-e[2]*A[1],[e,l,A]}function ne(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e}function be(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e}function Te(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]}function oe(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=l[0],C=l[1],z=l[2],B=l[3];return Math.abs(A-F)<=v*Math.max(1,Math.abs(A),Math.abs(F))&&Math.abs(P-C)<=v*Math.max(1,Math.abs(P),Math.abs(C))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}function me(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e}function Ee(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e}Math.hypot||(Math.hypot=function(){for(var e=0,l=arguments.length;l--;)e+=arguments[l]*arguments[l];return Math.sqrt(e)});var Oe=re,xe=be;function ke(){var e=new _(6);return _!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function Le(e){var l=new _(6);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l}function Re(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e}function Ye(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function qe(e,l,A,P,L,M){var F=new _(6);return F[0]=e,F[1]=l,F[2]=A,F[3]=P,F[4]=L,F[5]=M,F}function rt(e,l,A,P,L,M,F){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e}function ht(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=A*M-P*L;return z?(z=1/z,e[0]=M*z,e[1]=-P*z,e[2]=-L*z,e[3]=A*z,e[4]=(L*C-M*F)*z,e[5]=(P*F-A*C)*z,e):null}function $e(e){return e[0]*e[3]-e[1]*e[2]}function Me(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1],q=A[2],W=A[3],V=A[4],X=A[5];return e[0]=P*B+M*U,e[1]=L*B+F*U,e[2]=P*q+M*W,e[3]=L*q+F*W,e[4]=P*V+M*X+C,e[5]=L*V+F*X+z,e}function Be(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=Math.sin(A),U=Math.cos(A);return e[0]=P*U+M*B,e[1]=L*U+F*B,e[2]=P*-B+M*U,e[3]=L*-B+F*U,e[4]=C,e[5]=z,e}function yt(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1];return e[0]=P*B,e[1]=L*B,e[2]=M*U,e[3]=F*U,e[4]=C,e[5]=z,e}function we(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=P*B+M*U+C,e[5]=L*B+F*U+z,e}function At(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=-A,e[3]=P,e[4]=0,e[5]=0,e}function dt(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=l[1],e[4]=0,e[5]=0,e}function Et(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=l[0],e[5]=l[1],e}function ft(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function mt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function gt(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e}function tt(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e}function Bt(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e}function Qe(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e}function Rt(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]}function Gt(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=l[0],B=l[1],U=l[2],q=l[3],W=l[4],V=l[5];return Math.abs(A-z)<=v*Math.max(1,Math.abs(A),Math.abs(z))&&Math.abs(P-B)<=v*Math.max(1,Math.abs(P),Math.abs(B))&&Math.abs(L-U)<=v*Math.max(1,Math.abs(L),Math.abs(U))&&Math.abs(M-q)<=v*Math.max(1,Math.abs(M),Math.abs(q))&&Math.abs(F-W)<=v*Math.max(1,Math.abs(F),Math.abs(W))&&Math.abs(C-V)<=v*Math.max(1,Math.abs(C),Math.abs(V))}var Nr=Me,zr=tt;function Ue(){var e=new _(9);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Je(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[4],e[4]=l[5],e[5]=l[6],e[6]=l[8],e[7]=l[9],e[8]=l[10],e}function it(e){var l=new _(9);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l[8]=e[8],l}function wt(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e}function Dt(e,l,A,P,L,M,F,C,z){var B=new _(9);return B[0]=e,B[1]=l,B[2]=A,B[3]=P,B[4]=L,B[5]=M,B[6]=F,B[7]=C,B[8]=z,B}function mo(e,l,A,P,L,M,F,C,z,B){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e[8]=B,e}function go(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function bo(e,l){if(e===l){var A=l[1],P=l[2],L=l[5];e[1]=l[3],e[2]=l[6],e[3]=A,e[5]=l[7],e[6]=P,e[7]=L}else e[0]=l[0],e[1]=l[3],e[2]=l[6],e[3]=l[1],e[4]=l[4],e[5]=l[7],e[6]=l[2],e[7]=l[5],e[8]=l[8];return e}function yo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=U*F-C*B,W=-U*M+C*z,V=B*M-F*z,X=A*q+P*W+L*V;return X?(X=1/X,e[0]=q*X,e[1]=(-U*P+L*B)*X,e[2]=(C*P-L*F)*X,e[3]=W*X,e[4]=(U*A-L*z)*X,e[5]=(-C*A+L*M)*X,e[6]=V*X,e[7]=(-B*A+P*z)*X,e[8]=(F*A-P*M)*X,e):null}function Eo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8];return e[0]=F*U-C*B,e[1]=L*B-P*U,e[2]=P*C-L*F,e[3]=C*z-M*U,e[4]=A*U-L*z,e[5]=L*M-A*C,e[6]=M*B-F*z,e[7]=P*z-A*B,e[8]=A*F-P*M,e}function To(e){var l=e[0],A=e[1],P=e[2],L=e[3],M=e[4],F=e[5],C=e[6],z=e[7],B=e[8];return l*(B*M-F*z)+A*(-B*L+F*C)+P*(z*L-M*C)}function ws(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=A[0],V=A[1],X=A[2],J=A[3],$=A[4],te=A[5],de=A[6],ce=A[7],he=A[8];return e[0]=W*P+V*F+X*B,e[1]=W*L+V*C+X*U,e[2]=W*M+V*z+X*q,e[3]=J*P+$*F+te*B,e[4]=J*L+$*C+te*U,e[5]=J*M+$*z+te*q,e[6]=de*P+ce*F+he*B,e[7]=de*L+ce*C+he*U,e[8]=de*M+ce*z+he*q,e}function xo(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=A[0],V=A[1];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=C,e[5]=z,e[6]=W*P+V*F+B,e[7]=W*L+V*C+U,e[8]=W*M+V*z+q,e}function Ao(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=Math.sin(A),V=Math.cos(A);return e[0]=V*P+W*F,e[1]=V*L+W*C,e[2]=V*M+W*z,e[3]=V*F-W*P,e[4]=V*C-W*L,e[5]=V*z-W*M,e[6]=B,e[7]=U,e[8]=q,e}function So(e,l,A){var P=A[0],L=A[1];return e[0]=P*l[0],e[1]=P*l[1],e[2]=P*l[2],e[3]=L*l[3],e[4]=L*l[4],e[5]=L*l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e}function Oo(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=l[0],e[7]=l[1],e[8]=1,e}function Ro(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=0,e[3]=-A,e[4]=P,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function wo(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=0,e[4]=l[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Po(e,l){return e[0]=l[0],e[1]=l[1],e[2]=0,e[3]=l[2],e[4]=l[3],e[5]=0,e[6]=l[4],e[7]=l[5],e[8]=1,e}function Lo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A+A,C=P+P,z=L+L,B=A*F,U=P*F,q=P*C,W=L*F,V=L*C,X=L*z,J=M*F,$=M*C,te=M*z;return e[0]=1-q-X,e[3]=U-te,e[6]=W+$,e[1]=U+te,e[4]=1-B-X,e[7]=V-J,e[2]=W-$,e[5]=V+J,e[8]=1-B-q,e}function Mo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15],de=A*C-P*F,ce=A*z-L*F,he=A*B-M*F,pe=P*z-L*C,fe=P*B-M*C,He=L*B-M*z,We=U*J-q*X,Ve=U*$-W*X,De=U*te-V*X,Ze=q*$-W*J,Ie=q*te-V*J,Fe=W*te-V*$,_e=de*Fe-ce*Ie+he*Ze+pe*De-fe*Ve+He*We;return _e?(_e=1/_e,e[0]=(C*Fe-z*Ie+B*Ze)*_e,e[1]=(z*De-F*Fe-B*Ve)*_e,e[2]=(F*Ie-C*De+B*We)*_e,e[3]=(L*Ie-P*Fe-M*Ze)*_e,e[4]=(A*Fe-L*De+M*Ve)*_e,e[5]=(P*De-A*Ie-M*We)*_e,e[6]=(J*He-$*fe+te*pe)*_e,e[7]=($*he-X*He-te*ce)*_e,e[8]=(X*fe-J*he+te*de)*_e,e):null}function Io(e,l,A){return e[0]=2/l,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/A,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Fo(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Co(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function No(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e[8]=l[8]+A[8],e}function Ps(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e[6]=l[6]-A[6],e[7]=l[7]-A[7],e[8]=l[8]-A[8],e}function zo(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e[8]=l[8]*A,e}function Bo(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e[6]=l[6]+A[6]*P,e[7]=l[7]+A[7]*P,e[8]=l[8]+A[8]*P,e}function Do(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]&&e[8]===l[8]}function jo(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=e[8],q=l[0],W=l[1],V=l[2],X=l[3],J=l[4],$=l[5],te=l[6],de=l[7],ce=l[8];return Math.abs(A-q)<=v*Math.max(1,Math.abs(A),Math.abs(q))&&Math.abs(P-W)<=v*Math.max(1,Math.abs(P),Math.abs(W))&&Math.abs(L-V)<=v*Math.max(1,Math.abs(L),Math.abs(V))&&Math.abs(M-X)<=v*Math.max(1,Math.abs(M),Math.abs(X))&&Math.abs(F-J)<=v*Math.max(1,Math.abs(F),Math.abs(J))&&Math.abs(C-$)<=v*Math.max(1,Math.abs(C),Math.abs($))&&Math.abs(z-te)<=v*Math.max(1,Math.abs(z),Math.abs(te))&&Math.abs(B-de)<=v*Math.max(1,Math.abs(B),Math.abs(de))&&Math.abs(U-ce)<=v*Math.max(1,Math.abs(U),Math.abs(ce))}var ko=ws,Uo=Ps;function Go(){var e=new _(16);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function qo(e){var l=new _(16);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l[8]=e[8],l[9]=e[9],l[10]=e[10],l[11]=e[11],l[12]=e[12],l[13]=e[13],l[14]=e[14],l[15]=e[15],l}function Wo(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e[9]=l[9],e[10]=l[10],e[11]=l[11],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15],e}function Vo(e,l,A,P,L,M,F,C,z,B,U,q,W,V,X,J){var $=new _(16);return $[0]=e,$[1]=l,$[2]=A,$[3]=P,$[4]=L,$[5]=M,$[6]=F,$[7]=C,$[8]=z,$[9]=B,$[10]=U,$[11]=q,$[12]=W,$[13]=V,$[14]=X,$[15]=J,$}function $o(e,l,A,P,L,M,F,C,z,B,U,q,W,V,X,J,$){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e[8]=B,e[9]=U,e[10]=q,e[11]=W,e[12]=V,e[13]=X,e[14]=J,e[15]=$,e}function Ls(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ho(e,l){if(e===l){var A=l[1],P=l[2],L=l[3],M=l[6],F=l[7],C=l[11];e[1]=l[4],e[2]=l[8],e[3]=l[12],e[4]=A,e[6]=l[9],e[7]=l[13],e[8]=P,e[9]=M,e[11]=l[14],e[12]=L,e[13]=F,e[14]=C}else e[0]=l[0],e[1]=l[4],e[2]=l[8],e[3]=l[12],e[4]=l[1],e[5]=l[5],e[6]=l[9],e[7]=l[13],e[8]=l[2],e[9]=l[6],e[10]=l[10],e[11]=l[14],e[12]=l[3],e[13]=l[7],e[14]=l[11],e[15]=l[15];return e}function Xo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15],de=A*C-P*F,ce=A*z-L*F,he=A*B-M*F,pe=P*z-L*C,fe=P*B-M*C,He=L*B-M*z,We=U*J-q*X,Ve=U*$-W*X,De=U*te-V*X,Ze=q*$-W*J,Ie=q*te-V*J,Fe=W*te-V*$,_e=de*Fe-ce*Ie+he*Ze+pe*De-fe*Ve+He*We;return _e?(_e=1/_e,e[0]=(C*Fe-z*Ie+B*Ze)*_e,e[1]=(L*Ie-P*Fe-M*Ze)*_e,e[2]=(J*He-$*fe+te*pe)*_e,e[3]=(W*fe-q*He-V*pe)*_e,e[4]=(z*De-F*Fe-B*Ve)*_e,e[5]=(A*Fe-L*De+M*Ve)*_e,e[6]=($*he-X*He-te*ce)*_e,e[7]=(U*He-W*he+V*ce)*_e,e[8]=(F*Ie-C*De+B*We)*_e,e[9]=(P*De-A*Ie-M*We)*_e,e[10]=(X*fe-J*he+te*de)*_e,e[11]=(q*he-U*fe-V*de)*_e,e[12]=(C*Ve-F*Ze-z*We)*_e,e[13]=(A*Ze-P*Ve+L*We)*_e,e[14]=(J*ce-X*pe-$*de)*_e,e[15]=(U*pe-q*ce+W*de)*_e,e):null}function Yo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15];return e[0]=C*(W*te-V*$)-q*(z*te-B*$)+J*(z*V-B*W),e[1]=-(P*(W*te-V*$)-q*(L*te-M*$)+J*(L*V-M*W)),e[2]=P*(z*te-B*$)-C*(L*te-M*$)+J*(L*B-M*z),e[3]=-(P*(z*V-B*W)-C*(L*V-M*W)+q*(L*B-M*z)),e[4]=-(F*(W*te-V*$)-U*(z*te-B*$)+X*(z*V-B*W)),e[5]=A*(W*te-V*$)-U*(L*te-M*$)+X*(L*V-M*W),e[6]=-(A*(z*te-B*$)-F*(L*te-M*$)+X*(L*B-M*z)),e[7]=A*(z*V-B*W)-F*(L*V-M*W)+U*(L*B-M*z),e[8]=F*(q*te-V*J)-U*(C*te-B*J)+X*(C*V-B*q),e[9]=-(A*(q*te-V*J)-U*(P*te-M*J)+X*(P*V-M*q)),e[10]=A*(C*te-B*J)-F*(P*te-M*J)+X*(P*B-M*C),e[11]=-(A*(C*V-B*q)-F*(P*V-M*q)+U*(P*B-M*C)),e[12]=-(F*(q*$-W*J)-U*(C*$-z*J)+X*(C*W-z*q)),e[13]=A*(q*$-W*J)-U*(P*$-L*J)+X*(P*W-L*q),e[14]=-(A*(C*$-z*J)-F*(P*$-L*J)+X*(P*z-L*C)),e[15]=A*(C*W-z*q)-F*(P*W-L*q)+U*(P*z-L*C),e}function Zo(e){var l=e[0],A=e[1],P=e[2],L=e[3],M=e[4],F=e[5],C=e[6],z=e[7],B=e[8],U=e[9],q=e[10],W=e[11],V=e[12],X=e[13],J=e[14],$=e[15];return(l*F-A*M)*(q*$-W*J)-(l*C-P*M)*(U*$-W*X)+(l*z-L*M)*(U*J-q*X)+(A*C-P*F)*(B*$-W*V)-(A*z-L*F)*(B*J-q*V)+(P*z-L*C)*(B*X-U*V)}function Ms(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=l[9],V=l[10],X=l[11],J=l[12],$=l[13],te=l[14],de=l[15],ce=A[0],he=A[1],pe=A[2],fe=A[3];return e[0]=ce*P+he*C+pe*q+fe*J,e[1]=ce*L+he*z+pe*W+fe*$,e[2]=ce*M+he*B+pe*V+fe*te,e[3]=ce*F+he*U+pe*X+fe*de,ce=A[4],he=A[5],pe=A[6],fe=A[7],e[4]=ce*P+he*C+pe*q+fe*J,e[5]=ce*L+he*z+pe*W+fe*$,e[6]=ce*M+he*B+pe*V+fe*te,e[7]=ce*F+he*U+pe*X+fe*de,ce=A[8],he=A[9],pe=A[10],fe=A[11],e[8]=ce*P+he*C+pe*q+fe*J,e[9]=ce*L+he*z+pe*W+fe*$,e[10]=ce*M+he*B+pe*V+fe*te,e[11]=ce*F+he*U+pe*X+fe*de,ce=A[12],he=A[13],pe=A[14],fe=A[15],e[12]=ce*P+he*C+pe*q+fe*J,e[13]=ce*L+he*z+pe*W+fe*$,e[14]=ce*M+he*B+pe*V+fe*te,e[15]=ce*F+he*U+pe*X+fe*de,e}function Ko(e,l,A){var P,L,M,F,C,z,B,U,q,W,V,X,J=A[0],$=A[1],te=A[2];return l===e?(e[12]=l[0]*J+l[4]*$+l[8]*te+l[12],e[13]=l[1]*J+l[5]*$+l[9]*te+l[13],e[14]=l[2]*J+l[6]*$+l[10]*te+l[14],e[15]=l[3]*J+l[7]*$+l[11]*te+l[15]):(P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=l[9],V=l[10],X=l[11],e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=C,e[5]=z,e[6]=B,e[7]=U,e[8]=q,e[9]=W,e[10]=V,e[11]=X,e[12]=P*J+C*$+q*te+l[12],e[13]=L*J+z*$+W*te+l[13],e[14]=M*J+B*$+V*te+l[14],e[15]=F*J+U*$+X*te+l[15]),e}function Qo(e,l,A){var P=A[0],L=A[1],M=A[2];return e[0]=l[0]*P,e[1]=l[1]*P,e[2]=l[2]*P,e[3]=l[3]*P,e[4]=l[4]*L,e[5]=l[5]*L,e[6]=l[6]*L,e[7]=l[7]*L,e[8]=l[8]*M,e[9]=l[9]*M,e[10]=l[10]*M,e[11]=l[11]*M,e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15],e}function Jo(e,l,A,P){var L,M,F,C,z,B,U,q,W,V,X,J,$,te,de,ce,he,pe,fe,He,We,Ve,De,Ze,Ie=P[0],Fe=P[1],_e=P[2],It=Math.hypot(Ie,Fe,_e);return It<v?null:(Ie*=It=1/It,Fe*=It,_e*=It,L=Math.sin(A),F=1-(M=Math.cos(A)),C=l[0],z=l[1],B=l[2],U=l[3],q=l[4],W=l[5],V=l[6],X=l[7],J=l[8],$=l[9],te=l[10],de=l[11],ce=Ie*Ie*F+M,he=Fe*Ie*F+_e*L,pe=_e*Ie*F-Fe*L,fe=Ie*Fe*F-_e*L,He=Fe*Fe*F+M,We=_e*Fe*F+Ie*L,Ve=Ie*_e*F+Fe*L,De=Fe*_e*F-Ie*L,Ze=_e*_e*F+M,e[0]=C*ce+q*he+J*pe,e[1]=z*ce+W*he+$*pe,e[2]=B*ce+V*he+te*pe,e[3]=U*ce+X*he+de*pe,e[4]=C*fe+q*He+J*We,e[5]=z*fe+W*He+$*We,e[6]=B*fe+V*He+te*We,e[7]=U*fe+X*He+de*We,e[8]=C*Ve+q*De+J*Ze,e[9]=z*Ve+W*De+$*Ze,e[10]=B*Ve+V*De+te*Ze,e[11]=U*Ve+X*De+de*Ze,l!==e&&(e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e)}function eu(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[4],F=l[5],C=l[6],z=l[7],B=l[8],U=l[9],q=l[10],W=l[11];return l!==e&&(e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[4]=M*L+B*P,e[5]=F*L+U*P,e[6]=C*L+q*P,e[7]=z*L+W*P,e[8]=B*L-M*P,e[9]=U*L-F*P,e[10]=q*L-C*P,e[11]=W*L-z*P,e}function tu(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[0],F=l[1],C=l[2],z=l[3],B=l[8],U=l[9],q=l[10],W=l[11];return l!==e&&(e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[0]=M*L-B*P,e[1]=F*L-U*P,e[2]=C*L-q*P,e[3]=z*L-W*P,e[8]=M*P+B*L,e[9]=F*P+U*L,e[10]=C*P+q*L,e[11]=z*P+W*L,e}function ru(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[0],F=l[1],C=l[2],z=l[3],B=l[4],U=l[5],q=l[6],W=l[7];return l!==e&&(e[8]=l[8],e[9]=l[9],e[10]=l[10],e[11]=l[11],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[0]=M*L+B*P,e[1]=F*L+U*P,e[2]=C*L+q*P,e[3]=z*L+W*P,e[4]=B*L-M*P,e[5]=U*L-F*P,e[6]=q*L-C*P,e[7]=W*L-z*P,e}function iu(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=l[0],e[13]=l[1],e[14]=l[2],e[15]=1,e}function nu(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function au(e,l,A){var P,L,M,F=A[0],C=A[1],z=A[2],B=Math.hypot(F,C,z);return B<v?null:(F*=B=1/B,C*=B,z*=B,P=Math.sin(l),M=1-(L=Math.cos(l)),e[0]=F*F*M+L,e[1]=C*F*M+z*P,e[2]=z*F*M-C*P,e[3]=0,e[4]=F*C*M-z*P,e[5]=C*C*M+L,e[6]=z*C*M+F*P,e[7]=0,e[8]=F*z*M+C*P,e[9]=C*z*M-F*P,e[10]=z*z*M+L,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function su(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=P,e[6]=A,e[7]=0,e[8]=0,e[9]=-A,e[10]=P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ou(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=0,e[2]=-A,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=A,e[9]=0,e[10]=P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uu(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=0,e[3]=0,e[4]=-A,e[5]=P,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Is(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=P+P,z=L+L,B=M+M,U=P*C,q=P*z,W=P*B,V=L*z,X=L*B,J=M*B,$=F*C,te=F*z,de=F*B;return e[0]=1-(V+J),e[1]=q+de,e[2]=W-te,e[3]=0,e[4]=q-de,e[5]=1-(U+J),e[6]=X+$,e[7]=0,e[8]=W+te,e[9]=X-$,e[10]=1-(U+V),e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function lu(e,l){var A=new _(3),P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=P*P+L*L+M*M+F*F;return q>0?(A[0]=2*(C*F+U*P+z*M-B*L)/q,A[1]=2*(z*F+U*L+B*P-C*M)/q,A[2]=2*(B*F+U*M+C*L-z*P)/q):(A[0]=2*(C*F+U*P+z*M-B*L),A[1]=2*(z*F+U*L+B*P-C*M),A[2]=2*(B*F+U*M+C*L-z*P)),Is(e,l,A),e}function Fs(e,l){return e[0]=l[12],e[1]=l[13],e[2]=l[14],e}function Cs(e,l){var A=l[0],P=l[1],L=l[2],M=l[4],F=l[5],C=l[6],z=l[8],B=l[9],U=l[10];return e[0]=Math.hypot(A,P,L),e[1]=Math.hypot(M,F,C),e[2]=Math.hypot(z,B,U),e}function Ns(e,l){var A=new _(3);Cs(A,l);var P=1/A[0],L=1/A[1],M=1/A[2],F=l[0]*P,C=l[1]*L,z=l[2]*M,B=l[4]*P,U=l[5]*L,q=l[6]*M,W=l[8]*P,V=l[9]*L,X=l[10]*M,J=F+U+X,$=0;return J>0?($=2*Math.sqrt(J+1),e[3]=.25*$,e[0]=(q-V)/$,e[1]=(W-z)/$,e[2]=(C-B)/$):F>U&&F>X?($=2*Math.sqrt(1+F-U-X),e[3]=(q-V)/$,e[0]=.25*$,e[1]=(C+B)/$,e[2]=(W+z)/$):U>X?($=2*Math.sqrt(1+U-F-X),e[3]=(W-z)/$,e[0]=(C+B)/$,e[1]=.25*$,e[2]=(q+V)/$):($=2*Math.sqrt(1+X-F-U),e[3]=(C-B)/$,e[0]=(W+z)/$,e[1]=(q+V)/$,e[2]=.25*$),e}function cu(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=l[3],z=L+L,B=M+M,U=F+F,q=L*z,W=L*B,V=L*U,X=M*B,J=M*U,$=F*U,te=C*z,de=C*B,ce=C*U,he=P[0],pe=P[1],fe=P[2];return e[0]=(1-(X+$))*he,e[1]=(W+ce)*he,e[2]=(V-de)*he,e[3]=0,e[4]=(W-ce)*pe,e[5]=(1-(q+$))*pe,e[6]=(J+te)*pe,e[7]=0,e[8]=(V+de)*fe,e[9]=(J-te)*fe,e[10]=(1-(q+X))*fe,e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function hu(e,l,A,P,L){var M=l[0],F=l[1],C=l[2],z=l[3],B=M+M,U=F+F,q=C+C,W=M*B,V=M*U,X=M*q,J=F*U,$=F*q,te=C*q,de=z*B,ce=z*U,he=z*q,pe=P[0],fe=P[1],He=P[2],We=L[0],Ve=L[1],De=L[2],Ze=(1-(J+te))*pe,Ie=(V+he)*pe,Fe=(X-ce)*pe,_e=(V-he)*fe,It=(1-(W+te))*fe,jr=($+de)*fe,kr=(X+ce)*He,Ac=($-de)*He,Sc=(1-(W+J))*He;return e[0]=Ze,e[1]=Ie,e[2]=Fe,e[3]=0,e[4]=_e,e[5]=It,e[6]=jr,e[7]=0,e[8]=kr,e[9]=Ac,e[10]=Sc,e[11]=0,e[12]=A[0]+We-(Ze*We+_e*Ve+kr*De),e[13]=A[1]+Ve-(Ie*We+It*Ve+Ac*De),e[14]=A[2]+De-(Fe*We+jr*Ve+Sc*De),e[15]=1,e}function du(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A+A,C=P+P,z=L+L,B=A*F,U=P*F,q=P*C,W=L*F,V=L*C,X=L*z,J=M*F,$=M*C,te=M*z;return e[0]=1-q-X,e[1]=U+te,e[2]=W-$,e[3]=0,e[4]=U-te,e[5]=1-B-X,e[6]=V+J,e[7]=0,e[8]=W+$,e[9]=V-J,e[10]=1-B-q,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fu(e,l,A,P,L,M,F){var C=1/(A-l),z=1/(L-P),B=1/(M-F);return e[0]=2*M*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*M*z,e[6]=0,e[7]=0,e[8]=(A+l)*C,e[9]=(L+P)*z,e[10]=(F+M)*B,e[11]=-1,e[12]=0,e[13]=0,e[14]=F*M*2*B,e[15]=0,e}function zs(e,l,A,P,L){var M,F=1/Math.tan(l/2);return e[0]=F/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=F,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(P-L),e[10]=(L+P)*M,e[14]=2*L*P*M):(e[10]=-1,e[14]=-2*P),e}var _u=zs;function pu(e,l,A,P,L){var M,F=1/Math.tan(l/2);return e[0]=F/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=F,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(P-L),e[10]=L*M,e[14]=L*P*M):(e[10]=-1,e[14]=-P),e}function vu(e,l,A,P){var L=Math.tan(l.upDegrees*Math.PI/180),M=Math.tan(l.downDegrees*Math.PI/180),F=Math.tan(l.leftDegrees*Math.PI/180),C=Math.tan(l.rightDegrees*Math.PI/180),z=2/(F+C),B=2/(L+M);return e[0]=z,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=B,e[6]=0,e[7]=0,e[8]=-(F-C)*z*.5,e[9]=(L-M)*B*.5,e[10]=P/(A-P),e[11]=-1,e[12]=0,e[13]=0,e[14]=P*A/(A-P),e[15]=0,e}function Bs(e,l,A,P,L,M,F){var C=1/(l-A),z=1/(P-L),B=1/(M-F);return e[0]=-2*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*B,e[11]=0,e[12]=(l+A)*C,e[13]=(L+P)*z,e[14]=(F+M)*B,e[15]=1,e}var mu=Bs;function gu(e,l,A,P,L,M,F){var C=1/(l-A),z=1/(P-L),B=1/(M-F);return e[0]=-2*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=B,e[11]=0,e[12]=(l+A)*C,e[13]=(L+P)*z,e[14]=M*B,e[15]=1,e}function bu(e,l,A,P){var L,M,F,C,z,B,U,q,W,V,X=l[0],J=l[1],$=l[2],te=P[0],de=P[1],ce=P[2],he=A[0],pe=A[1],fe=A[2];return Math.abs(X-he)<v&&Math.abs(J-pe)<v&&Math.abs($-fe)<v?Ls(e):(U=X-he,q=J-pe,W=$-fe,L=de*(W*=V=1/Math.hypot(U,q,W))-ce*(q*=V),M=ce*(U*=V)-te*W,F=te*q-de*U,(V=Math.hypot(L,M,F))?(L*=V=1/V,M*=V,F*=V):(L=0,M=0,F=0),C=q*F-W*M,z=W*L-U*F,B=U*M-q*L,(V=Math.hypot(C,z,B))?(C*=V=1/V,z*=V,B*=V):(C=0,z=0,B=0),e[0]=L,e[1]=C,e[2]=U,e[3]=0,e[4]=M,e[5]=z,e[6]=q,e[7]=0,e[8]=F,e[9]=B,e[10]=W,e[11]=0,e[12]=-(L*X+M*J+F*$),e[13]=-(C*X+z*J+B*$),e[14]=-(U*X+q*J+W*$),e[15]=1,e)}function yu(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=P[0],z=P[1],B=P[2],U=L-A[0],q=M-A[1],W=F-A[2],V=U*U+q*q+W*W;V>0&&(U*=V=1/Math.sqrt(V),q*=V,W*=V);var X=z*W-B*q,J=B*U-C*W,$=C*q-z*U;return(V=X*X+J*J+$*$)>0&&(X*=V=1/Math.sqrt(V),J*=V,$*=V),e[0]=X,e[1]=J,e[2]=$,e[3]=0,e[4]=q*$-W*J,e[5]=W*X-U*$,e[6]=U*J-q*X,e[7]=0,e[8]=U,e[9]=q,e[10]=W,e[11]=0,e[12]=L,e[13]=M,e[14]=F,e[15]=1,e}function Eu(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Tu(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xu(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e[8]=l[8]+A[8],e[9]=l[9]+A[9],e[10]=l[10]+A[10],e[11]=l[11]+A[11],e[12]=l[12]+A[12],e[13]=l[13]+A[13],e[14]=l[14]+A[14],e[15]=l[15]+A[15],e}function Ds(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e[6]=l[6]-A[6],e[7]=l[7]-A[7],e[8]=l[8]-A[8],e[9]=l[9]-A[9],e[10]=l[10]-A[10],e[11]=l[11]-A[11],e[12]=l[12]-A[12],e[13]=l[13]-A[13],e[14]=l[14]-A[14],e[15]=l[15]-A[15],e}function Au(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e[8]=l[8]*A,e[9]=l[9]*A,e[10]=l[10]*A,e[11]=l[11]*A,e[12]=l[12]*A,e[13]=l[13]*A,e[14]=l[14]*A,e[15]=l[15]*A,e}function Su(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e[6]=l[6]+A[6]*P,e[7]=l[7]+A[7]*P,e[8]=l[8]+A[8]*P,e[9]=l[9]+A[9]*P,e[10]=l[10]+A[10]*P,e[11]=l[11]+A[11]*P,e[12]=l[12]+A[12]*P,e[13]=l[13]+A[13]*P,e[14]=l[14]+A[14]*P,e[15]=l[15]+A[15]*P,e}function Ou(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]&&e[8]===l[8]&&e[9]===l[9]&&e[10]===l[10]&&e[11]===l[11]&&e[12]===l[12]&&e[13]===l[13]&&e[14]===l[14]&&e[15]===l[15]}function Ru(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=e[8],q=e[9],W=e[10],V=e[11],X=e[12],J=e[13],$=e[14],te=e[15],de=l[0],ce=l[1],he=l[2],pe=l[3],fe=l[4],He=l[5],We=l[6],Ve=l[7],De=l[8],Ze=l[9],Ie=l[10],Fe=l[11],_e=l[12],It=l[13],jr=l[14],kr=l[15];return Math.abs(A-de)<=v*Math.max(1,Math.abs(A),Math.abs(de))&&Math.abs(P-ce)<=v*Math.max(1,Math.abs(P),Math.abs(ce))&&Math.abs(L-he)<=v*Math.max(1,Math.abs(L),Math.abs(he))&&Math.abs(M-pe)<=v*Math.max(1,Math.abs(M),Math.abs(pe))&&Math.abs(F-fe)<=v*Math.max(1,Math.abs(F),Math.abs(fe))&&Math.abs(C-He)<=v*Math.max(1,Math.abs(C),Math.abs(He))&&Math.abs(z-We)<=v*Math.max(1,Math.abs(z),Math.abs(We))&&Math.abs(B-Ve)<=v*Math.max(1,Math.abs(B),Math.abs(Ve))&&Math.abs(U-De)<=v*Math.max(1,Math.abs(U),Math.abs(De))&&Math.abs(q-Ze)<=v*Math.max(1,Math.abs(q),Math.abs(Ze))&&Math.abs(W-Ie)<=v*Math.max(1,Math.abs(W),Math.abs(Ie))&&Math.abs(V-Fe)<=v*Math.max(1,Math.abs(V),Math.abs(Fe))&&Math.abs(X-_e)<=v*Math.max(1,Math.abs(X),Math.abs(_e))&&Math.abs(J-It)<=v*Math.max(1,Math.abs(J),Math.abs(It))&&Math.abs($-jr)<=v*Math.max(1,Math.abs($),Math.abs(jr))&&Math.abs(te-kr)<=v*Math.max(1,Math.abs(te),Math.abs(kr))}var wu=Ms,Pu=Ds;function Br(){var e=new _(3);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Lu(e){var l=new _(3);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l}function js(e){var l=e[0],A=e[1],P=e[2];return Math.hypot(l,A,P)}function Dr(e,l,A){var P=new _(3);return P[0]=e,P[1]=l,P[2]=A,P}function Mu(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e}function Iu(e,l,A,P){return e[0]=l,e[1]=A,e[2]=P,e}function Fu(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e}function ks(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e}function Us(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e[2]=l[2]*A[2],e}function Gs(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e[2]=l[2]/A[2],e}function Cu(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e[2]=Math.ceil(l[2]),e}function Nu(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e[2]=Math.floor(l[2]),e}function Xt(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e[2]=Math.min(l[2],A[2]),e}function Yt(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e[2]=Math.max(l[2],A[2]),e}function Pt(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e[2]=Math.round(l[2]),e}function qt(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e}function H_(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e}function Il(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2];return Math.hypot(A,P,L)}function Fl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2];return A*A+P*P+L*L}function Cl(e){var l=e[0],A=e[1],P=e[2];return l*l+A*A+P*P}function X_(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e}function Y_(e,l){return e[0]=1/l[0],e[1]=1/l[1],e[2]=1/l[2],e}function Nl(e,l){var A=l[0],P=l[1],L=l[2],M=A*A+P*P+L*L;return M>0&&(M=1/Math.sqrt(M)),e[0]=l[0]*M,e[1]=l[1]*M,e[2]=l[2]*M,e}function zu(e,l){return e[0]*l[0]+e[1]*l[1]+e[2]*l[2]}function qs(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[0],C=A[1],z=A[2];return e[0]=L*z-M*C,e[1]=M*F-P*z,e[2]=P*C-L*F,e}function Z_(e,l,A,P){var L=l[0],M=l[1],F=l[2];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e[2]=F+P*(A[2]-F),e}function K_(e,l,A,P,L,M){var F=M*M,C=F*(2*M-3)+1,z=F*(M-2)+M,B=F*(M-1),U=F*(3-2*M);return e[0]=l[0]*C+A[0]*z+P[0]*B+L[0]*U,e[1]=l[1]*C+A[1]*z+P[1]*B+L[1]*U,e[2]=l[2]*C+A[2]*z+P[2]*B+L[2]*U,e}function Q_(e,l,A,P,L,M){var F=1-M,C=F*F,z=M*M,B=C*F,U=3*M*C,q=3*z*F,W=z*M;return e[0]=l[0]*B+A[0]*U+P[0]*q+L[0]*W,e[1]=l[1]*B+A[1]*U+P[1]*q+L[1]*W,e[2]=l[2]*B+A[2]*U+P[2]*q+L[2]*W,e}function J_(e,l){l=l||1;var A=2*g()*Math.PI,P=2*g()-1,L=Math.sqrt(1-P*P)*l;return e[0]=Math.cos(A)*L,e[1]=Math.sin(A)*L,e[2]=P*l,e}function e1(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[3]*P+A[7]*L+A[11]*M+A[15];return F=F||1,e[0]=(A[0]*P+A[4]*L+A[8]*M+A[12])/F,e[1]=(A[1]*P+A[5]*L+A[9]*M+A[13])/F,e[2]=(A[2]*P+A[6]*L+A[10]*M+A[14])/F,e}function t1(e,l,A){var P=l[0],L=l[1],M=l[2];return e[0]=P*A[0]+L*A[3]+M*A[6],e[1]=P*A[1]+L*A[4]+M*A[7],e[2]=P*A[2]+L*A[5]+M*A[8],e}function r1(e,l,A){var P=A[0],L=A[1],M=A[2],F=A[3],C=l[0],z=l[1],B=l[2],U=L*B-M*z,q=M*C-P*B,W=P*z-L*C,V=L*W-M*q,X=M*U-P*W,J=P*q-L*U,$=2*F;return U*=$,q*=$,W*=$,V*=2,X*=2,J*=2,e[0]=C+U+V,e[1]=z+q+X,e[2]=B+W+J,e}function i1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[0],M[1]=L[1]*Math.cos(P)-L[2]*Math.sin(P),M[2]=L[1]*Math.sin(P)+L[2]*Math.cos(P),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function n1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[2]*Math.sin(P)+L[0]*Math.cos(P),M[1]=L[1],M[2]=L[2]*Math.cos(P)-L[0]*Math.sin(P),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function a1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[0]*Math.cos(P)-L[1]*Math.sin(P),M[1]=L[0]*Math.sin(P)+L[1]*Math.cos(P),M[2]=L[2],e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function s1(e,l){var A=e[0],P=e[1],L=e[2],M=l[0],F=l[1],C=l[2],z=Math.sqrt(A*A+P*P+L*L)*Math.sqrt(M*M+F*F+C*C),B=z&&zu(e,l)/z;return Math.acos(Math.min(Math.max(B,-1),1))}function o1(e){return e[0]=0,e[1]=0,e[2]=0,e}function u1(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function l1(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]}function c1(e,l){var A=e[0],P=e[1],L=e[2],M=l[0],F=l[1],C=l[2];return Math.abs(A-M)<=v*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(P-F)<=v*Math.max(1,Math.abs(P),Math.abs(F))&&Math.abs(L-C)<=v*Math.max(1,Math.abs(L),Math.abs(C))}var Wt,h1=ks,d1=Us,f1=Gs,_1=Il,p1=Fl,zl=js,v1=Cl,m1=(Wt=Br(),function(e,l,A,P,L,M){var F,C;for(l||(l=3),A||(A=0),C=P?Math.min(P*l+A,e.length):e.length,F=A;F<C;F+=l)Wt[0]=e[F],Wt[1]=e[F+1],Wt[2]=e[F+2],L(Wt,Wt,M),e[F]=Wt[0],e[F+1]=Wt[1],e[F+2]=Wt[2];return e});function Bl(){var e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Dl(e){var l=new _(4);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l}function jl(e,l,A,P){var L=new _(4);return L[0]=e,L[1]=l,L[2]=A,L[3]=P,L}function kl(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e}function Ul(e,l,A,P,L){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e}function Gl(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e}function ql(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e}function Wl(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e[2]=l[2]*A[2],e[3]=l[3]*A[3],e}function Vl(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e[2]=l[2]/A[2],e[3]=l[3]/A[3],e}function g1(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e[2]=Math.ceil(l[2]),e[3]=Math.ceil(l[3]),e}function b1(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e[2]=Math.floor(l[2]),e[3]=Math.floor(l[3]),e}function y1(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e[2]=Math.min(l[2],A[2]),e[3]=Math.min(l[3],A[3]),e}function E1(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e[2]=Math.max(l[2],A[2]),e[3]=Math.max(l[3],A[3]),e}function T1(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e[2]=Math.round(l[2]),e[3]=Math.round(l[3]),e}function $l(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e}function x1(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e}function Hl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2],M=l[3]-e[3];return Math.hypot(A,P,L,M)}function Xl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2],M=l[3]-e[3];return A*A+P*P+L*L+M*M}function Bu(e){var l=e[0],A=e[1],P=e[2],L=e[3];return Math.hypot(l,A,P,L)}function Du(e){var l=e[0],A=e[1],P=e[2],L=e[3];return l*l+A*A+P*P+L*L}function A1(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=-l[3],e}function S1(e,l){return e[0]=1/l[0],e[1]=1/l[1],e[2]=1/l[2],e[3]=1/l[3],e}function Yl(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*A+P*P+L*L+M*M;return F>0&&(F=1/Math.sqrt(F)),e[0]=A*F,e[1]=P*F,e[2]=L*F,e[3]=M*F,e}function Zl(e,l){return e[0]*l[0]+e[1]*l[1]+e[2]*l[2]+e[3]*l[3]}function O1(e,l,A,P){var L=A[0]*P[1]-A[1]*P[0],M=A[0]*P[2]-A[2]*P[0],F=A[0]*P[3]-A[3]*P[0],C=A[1]*P[2]-A[2]*P[1],z=A[1]*P[3]-A[3]*P[1],B=A[2]*P[3]-A[3]*P[2],U=l[0],q=l[1],W=l[2],V=l[3];return e[0]=q*B-W*z+V*C,e[1]=-U*B+W*F-V*M,e[2]=U*z-q*F+V*L,e[3]=-U*C+q*M-W*L,e}function Kl(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=l[3];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e[2]=F+P*(A[2]-F),e[3]=C+P*(A[3]-C),e}function R1(e,l){var A,P,L,M,F,C;l=l||1;do F=(A=2*g()-1)*A+(P=2*g()-1)*P;while(F>=1);do C=(L=2*g()-1)*L+(M=2*g()-1)*M;while(C>=1);var z=Math.sqrt((1-F)/C);return e[0]=l*A,e[1]=l*P,e[2]=l*L*z,e[3]=l*M*z,e}function w1(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3];return e[0]=A[0]*P+A[4]*L+A[8]*M+A[12]*F,e[1]=A[1]*P+A[5]*L+A[9]*M+A[13]*F,e[2]=A[2]*P+A[6]*L+A[10]*M+A[14]*F,e[3]=A[3]*P+A[7]*L+A[11]*M+A[15]*F,e}function P1(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[0],C=A[1],z=A[2],B=A[3],U=B*P+C*M-z*L,q=B*L+z*P-F*M,W=B*M+F*L-C*P,V=-F*P-C*L-z*M;return e[0]=U*B+V*-F+q*-z-W*-C,e[1]=q*B+V*-C+W*-F-U*-z,e[2]=W*B+V*-z+U*-C-q*-F,e[3]=l[3],e}function L1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function M1(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ql(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]}function Jl(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=l[0],C=l[1],z=l[2],B=l[3];return Math.abs(A-F)<=v*Math.max(1,Math.abs(A),Math.abs(F))&&Math.abs(P-C)<=v*Math.max(1,Math.abs(P),Math.abs(C))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}var I1=ql,F1=Wl,C1=Vl,N1=Hl,z1=Xl,B1=Bu,D1=Du,j1=function(){var e=Bl();return function(l,A,P,L,M,F){var C,z;for(A||(A=4),P||(P=0),z=L?Math.min(L*A+P,l.length):l.length,C=P;C<z;C+=A)e[0]=l[C],e[1]=l[C+1],e[2]=l[C+2],e[3]=l[C+3],M(e,e,F),l[C]=e[0],l[C+1]=e[1],l[C+2]=e[2],l[C+3]=e[3];return l}}();function Ws(){var e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function k1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ec(e,l,A){A*=.5;var P=Math.sin(A);return e[0]=P*l[0],e[1]=P*l[1],e[2]=P*l[2],e[3]=Math.cos(A),e}function U1(e,l){var A=2*Math.acos(l[3]),P=Math.sin(A/2);return P>v?(e[0]=l[0]/P,e[1]=l[1]/P,e[2]=l[2]/P):(e[0]=1,e[1]=0,e[2]=0),A}function G1(e,l){var A=Gu(e,l);return Math.acos(2*A*A-1)}function tc(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*U+F*C+L*B-M*z,e[1]=L*U+F*z+M*C-P*B,e[2]=M*U+F*B+P*z-L*C,e[3]=F*U-P*C-L*z-M*B,e}function rc(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+F*C,e[1]=L*z+M*C,e[2]=M*z-L*C,e[3]=F*z-P*C,e}function ic(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z-M*C,e[1]=L*z+F*C,e[2]=M*z+P*C,e[3]=F*z-L*C,e}function nc(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+L*C,e[1]=L*z-P*C,e[2]=M*z+F*C,e[3]=F*z-M*C,e}function q1(e,l){var A=l[0],P=l[1],L=l[2];return e[0]=A,e[1]=P,e[2]=L,e[3]=Math.sqrt(Math.abs(1-A*A-P*P-L*L)),e}function ac(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=Math.sqrt(A*A+P*P+L*L),C=Math.exp(M),z=F>0?C*Math.sin(F)/F:0;return e[0]=A*z,e[1]=P*z,e[2]=L*z,e[3]=C*Math.cos(F),e}function sc(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=Math.sqrt(A*A+P*P+L*L),C=F>0?Math.atan2(F,M)/F:0;return e[0]=A*C,e[1]=P*C,e[2]=L*C,e[3]=.5*Math.log(A*A+P*P+L*L+M*M),e}function W1(e,l,A){return sc(e,l),cc(e,e,A),ac(e,e),e}function Vs(e,l,A,P){var L,M,F,C,z,B=l[0],U=l[1],q=l[2],W=l[3],V=A[0],X=A[1],J=A[2],$=A[3];return(M=B*V+U*X+q*J+W*$)<0&&(M=-M,V=-V,X=-X,J=-J,$=-$),1-M>v?(L=Math.acos(M),F=Math.sin(L),C=Math.sin((1-P)*L)/F,z=Math.sin(P*L)/F):(C=1-P,z=P),e[0]=C*B+z*V,e[1]=C*U+z*X,e[2]=C*q+z*J,e[3]=C*W+z*$,e}function V1(e){var l=g(),A=g(),P=g(),L=Math.sqrt(1-l),M=Math.sqrt(l);return e[0]=L*Math.sin(2*Math.PI*A),e[1]=L*Math.cos(2*Math.PI*A),e[2]=M*Math.sin(2*Math.PI*P),e[3]=M*Math.cos(2*Math.PI*P),e}function $1(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*A+P*P+L*L+M*M,C=F?1/F:0;return e[0]=-A*C,e[1]=-P*C,e[2]=-L*C,e[3]=M*C,e}function H1(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=l[3],e}function oc(e,l){var A,P=l[0]+l[4]+l[8];if(P>0)A=Math.sqrt(P+1),e[3]=.5*A,A=.5/A,e[0]=(l[5]-l[7])*A,e[1]=(l[6]-l[2])*A,e[2]=(l[1]-l[3])*A;else{var L=0;l[4]>l[0]&&(L=1),l[8]>l[3*L+L]&&(L=2);var M=(L+1)%3,F=(L+2)%3;A=Math.sqrt(l[3*L+L]-l[3*M+M]-l[3*F+F]+1),e[L]=.5*A,A=.5/A,e[3]=(l[3*M+F]-l[3*F+M])*A,e[M]=(l[3*M+L]+l[3*L+M])*A,e[F]=(l[3*F+L]+l[3*L+F])*A}return e}function X1(e,l,A,P){var L=.5*Math.PI/180;l*=L,A*=L,P*=L;var M=Math.sin(l),F=Math.cos(l),C=Math.sin(A),z=Math.cos(A),B=Math.sin(P),U=Math.cos(P);return e[0]=M*z*U-F*C*B,e[1]=F*C*U+M*z*B,e[2]=F*z*B-M*C*U,e[3]=F*z*U+M*C*B,e}function Y1(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Lt,uc,lc,ju,ku,Mt,Z1=Dl,K1=jl,Uu=kl,Q1=Ul,J1=Gl,ep=tc,cc=$l,Gu=Zl,tp=Kl,qu=Bu,rp=qu,Wu=Du,ip=Wu,Vu=Yl,np=Ql,ap=Jl,sp=(Lt=Br(),uc=Dr(1,0,0),lc=Dr(0,1,0),function(e,l,A){var P=zu(l,A);return P<-.999999?(qs(Lt,uc,l),zl(Lt)<1e-6&&qs(Lt,lc,l),Nl(Lt,Lt),ec(e,Lt,Math.PI),e):P>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(qs(Lt,l,A),e[0]=Lt[0],e[1]=Lt[1],e[2]=Lt[2],e[3]=1+P,Vu(e,e))}),op=(ju=Ws(),ku=Ws(),function(e,l,A,P,L,M){return Vs(ju,l,L,M),Vs(ku,A,P,M),Vs(e,ju,ku,2*M*(1-M)),e}),up=(Mt=Ue(),function(e,l,A,P){return Mt[0]=A[0],Mt[3]=A[1],Mt[6]=A[2],Mt[1]=P[0],Mt[4]=P[1],Mt[7]=P[2],Mt[2]=-l[0],Mt[5]=-l[1],Mt[8]=-l[2],Vu(e,oc(e,Mt))});function lp(){var e=new _(8);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function cp(e){var l=new _(8);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l}function hp(e,l,A,P,L,M,F,C){var z=new _(8);return z[0]=e,z[1]=l,z[2]=A,z[3]=P,z[4]=L,z[5]=M,z[6]=F,z[7]=C,z}function dp(e,l,A,P,L,M,F){var C=new _(8);C[0]=e,C[1]=l,C[2]=A,C[3]=P;var z=.5*L,B=.5*M,U=.5*F;return C[4]=z*P+B*A-U*l,C[5]=B*P+U*e-z*A,C[6]=U*P+z*l-B*e,C[7]=-z*e-B*l-U*A,C}function hc(e,l,A){var P=.5*A[0],L=.5*A[1],M=.5*A[2],F=l[0],C=l[1],z=l[2],B=l[3];return e[0]=F,e[1]=C,e[2]=z,e[3]=B,e[4]=P*B+L*z-M*C,e[5]=L*B+M*F-P*z,e[6]=M*B+P*C-L*F,e[7]=-P*F-L*C-M*z,e}function fp(e,l){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*l[0],e[5]=.5*l[1],e[6]=.5*l[2],e[7]=0,e}function _p(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function pp(e,l){var A=Ws();Ns(A,l);var P=new _(3);return Fs(P,l),hc(e,A,P),e}function dc(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e}function vp(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function mp(e,l,A,P,L,M,F,C,z){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e}var gp=Uu;function bp(e,l){return e[0]=l[4],e[1]=l[5],e[2]=l[6],e[3]=l[7],e}var yp=Uu;function Ep(e,l){return e[4]=l[0],e[5]=l[1],e[6]=l[2],e[7]=l[3],e}function Tp(e,l){var A=l[4],P=l[5],L=l[6],M=l[7],F=-l[0],C=-l[1],z=-l[2],B=l[3];return e[0]=2*(A*B+M*F+P*z-L*C),e[1]=2*(P*B+M*C+L*F-A*z),e[2]=2*(L*B+M*z+A*C-P*F),e}function xp(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=.5*A[0],z=.5*A[1],B=.5*A[2],U=l[4],q=l[5],W=l[6],V=l[7];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=F*C+L*B-M*z+U,e[5]=F*z+M*C-P*B+q,e[6]=F*B+P*z-L*C+W,e[7]=-P*C-L*z-M*B+V,e}function Ap(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return rc(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Sp(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return ic(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Op(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return nc(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Rp(e,l,A){var P=A[0],L=A[1],M=A[2],F=A[3],C=l[0],z=l[1],B=l[2],U=l[3];return e[0]=C*F+U*P+z*M-B*L,e[1]=z*F+U*L+B*P-C*M,e[2]=B*F+U*M+C*L-z*P,e[3]=U*F-C*P-z*L-B*M,C=l[4],z=l[5],B=l[6],U=l[7],e[4]=C*F+U*P+z*M-B*L,e[5]=z*F+U*L+B*P-C*M,e[6]=B*F+U*M+C*L-z*P,e[7]=U*F-C*P-z*L-B*M,e}function wp(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*U+F*C+L*B-M*z,e[1]=L*U+F*z+M*C-P*B,e[2]=M*U+F*B+P*z-L*C,e[3]=F*U-P*C-L*z-M*B,C=A[4],z=A[5],B=A[6],U=A[7],e[4]=P*U+F*C+L*B-M*z,e[5]=L*U+F*z+M*C-P*B,e[6]=M*U+F*B+P*z-L*C,e[7]=F*U-P*C-L*z-M*B,e}function Pp(e,l,A,P){if(Math.abs(P)<v)return dc(e,l);var L=Math.hypot(A[0],A[1],A[2]);P*=.5;var M=Math.sin(P),F=M*A[0]/L,C=M*A[1]/L,z=M*A[2]/L,B=Math.cos(P),U=l[0],q=l[1],W=l[2],V=l[3];e[0]=U*B+V*F+q*z-W*C,e[1]=q*B+V*C+W*F-U*z,e[2]=W*B+V*z+U*C-q*F,e[3]=V*B-U*F-q*C-W*z;var X=l[4],J=l[5],$=l[6],te=l[7];return e[4]=X*B+te*F+J*z-$*C,e[5]=J*B+te*C+$*F-X*z,e[6]=$*B+te*z+X*C-J*F,e[7]=te*B-X*F-J*C-$*z,e}function Lp(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e}function fc(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[4],z=A[5],B=A[6],U=A[7],q=l[4],W=l[5],V=l[6],X=l[7],J=A[0],$=A[1],te=A[2],de=A[3];return e[0]=P*de+F*J+L*te-M*$,e[1]=L*de+F*$+M*J-P*te,e[2]=M*de+F*te+P*$-L*J,e[3]=F*de-P*J-L*$-M*te,e[4]=P*U+F*C+L*B-M*z+q*de+X*J+W*te-V*$,e[5]=L*U+F*z+M*C-P*B+W*de+X*$+V*J-q*te,e[6]=M*U+F*B+P*z-L*C+V*de+X*te+q*$-W*J,e[7]=F*U-P*C-L*z-M*B+X*de-q*J-W*$-V*te,e}var Mp=fc;function Ip(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e}var _c=Gu;function Fp(e,l,A,P){var L=1-P;return _c(l,A)<0&&(P=-P),e[0]=l[0]*L+A[0]*P,e[1]=l[1]*L+A[1]*P,e[2]=l[2]*L+A[2]*P,e[3]=l[3]*L+A[3]*P,e[4]=l[4]*L+A[4]*P,e[5]=l[5]*L+A[5]*P,e[6]=l[6]*L+A[6]*P,e[7]=l[7]*L+A[7]*P,e}function Cp(e,l){var A=$s(l);return e[0]=-l[0]/A,e[1]=-l[1]/A,e[2]=-l[2]/A,e[3]=l[3]/A,e[4]=-l[4]/A,e[5]=-l[5]/A,e[6]=-l[6]/A,e[7]=l[7]/A,e}function Np(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=l[3],e[4]=-l[4],e[5]=-l[5],e[6]=-l[6],e[7]=l[7],e}var pc=qu,zp=pc,$s=Wu,Bp=$s;function Dp(e,l){var A=$s(l);if(A>0){A=Math.sqrt(A);var P=l[0]/A,L=l[1]/A,M=l[2]/A,F=l[3]/A,C=l[4],z=l[5],B=l[6],U=l[7],q=P*C+L*z+M*B+F*U;e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=(C-P*q)/A,e[5]=(z-L*q)/A,e[6]=(B-M*q)/A,e[7]=(U-F*q)/A}return e}function jp(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function kp(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]}function Up(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=l[0],q=l[1],W=l[2],V=l[3],X=l[4],J=l[5],$=l[6],te=l[7];return Math.abs(A-U)<=v*Math.max(1,Math.abs(A),Math.abs(U))&&Math.abs(P-q)<=v*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(L-W)<=v*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(M-V)<=v*Math.max(1,Math.abs(M),Math.abs(V))&&Math.abs(F-X)<=v*Math.max(1,Math.abs(F),Math.abs(X))&&Math.abs(C-J)<=v*Math.max(1,Math.abs(C),Math.abs(J))&&Math.abs(z-$)<=v*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(B-te)<=v*Math.max(1,Math.abs(B),Math.abs(te))}function vc(){var e=new _(2);return _!=Float32Array&&(e[0]=0,e[1]=0),e}function Gp(e){var l=new _(2);return l[0]=e[0],l[1]=e[1],l}function qp(e,l){var A=new _(2);return A[0]=e,A[1]=l,A}function Wp(e,l){return e[0]=l[0],e[1]=l[1],e}function Vp(e,l,A){return e[0]=l,e[1]=A,e}function $p(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e}function mc(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e}function gc(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e}function bc(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e}function Hp(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e}function Xp(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e}function Yp(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e}function Zp(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e}function Kp(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e}function Qp(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e}function Jp(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e}function yc(e,l){var A=l[0]-e[0],P=l[1]-e[1];return Math.hypot(A,P)}function Ec(e,l){var A=l[0]-e[0],P=l[1]-e[1];return A*A+P*P}function Tc(e){var l=e[0],A=e[1];return Math.hypot(l,A)}function xc(e){var l=e[0],A=e[1];return l*l+A*A}function ev(e,l){return e[0]=-l[0],e[1]=-l[1],e}function tv(e,l){return e[0]=1/l[0],e[1]=1/l[1],e}function rv(e,l){var A=l[0],P=l[1],L=A*A+P*P;return L>0&&(L=1/Math.sqrt(L)),e[0]=l[0]*L,e[1]=l[1]*L,e}function iv(e,l){return e[0]*l[0]+e[1]*l[1]}function nv(e,l,A){var P=l[0]*A[1]-l[1]*A[0];return e[0]=e[1]=0,e[2]=P,e}function av(e,l,A,P){var L=l[0],M=l[1];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e}function sv(e,l){l=l||1;var A=2*g()*Math.PI;return e[0]=Math.cos(A)*l,e[1]=Math.sin(A)*l,e}function ov(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[2]*L,e[1]=A[1]*P+A[3]*L,e}function uv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[2]*L+A[4],e[1]=A[1]*P+A[3]*L+A[5],e}function lv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[3]*L+A[6],e[1]=A[1]*P+A[4]*L+A[7],e}function cv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[4]*L+A[12],e[1]=A[1]*P+A[5]*L+A[13],e}function hv(e,l,A,P){var L=l[0]-A[0],M=l[1]-A[1],F=Math.sin(P),C=Math.cos(P);return e[0]=L*C-M*F+A[0],e[1]=L*F+M*C+A[1],e}function dv(e,l){var A=e[0],P=e[1],L=l[0],M=l[1],F=Math.sqrt(A*A+P*P)*Math.sqrt(L*L+M*M),C=F&&(A*L+P*M)/F;return Math.acos(Math.min(Math.max(C,-1),1))}function fv(e){return e[0]=0,e[1]=0,e}function _v(e){return"vec2("+e[0]+", "+e[1]+")"}function pv(e,l){return e[0]===l[0]&&e[1]===l[1]}function vv(e,l){var A=e[0],P=e[1],L=l[0],M=l[1];return Math.abs(A-L)<=v*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(P-M)<=v*Math.max(1,Math.abs(P),Math.abs(M))}var mv=Tc,gv=mc,bv=gc,yv=bc,Ev=yc,Tv=Ec,xv=xc,Av=function(){var e=vc();return function(l,A,P,L,M,F){var C,z;for(A||(A=2),P||(P=0),z=L?Math.min(L*A+P,l.length):l.length,C=P;C<z;C+=A)e[0]=l[C],e[1]=l[C+1],M(e,e,F),l[C]=e[0],l[C+1]=e[1];return l}}()},4613:p=>{p.exports=function(t){var i={};function a(r){if(i[r])return i[r].exports;var c=i[r]={i:r,l:!1,exports:{}};return t[r].call(c.exports,c,c.exports,a),c.l=!0,c.exports}return a.m=t,a.c=i,a.d=function(r,c,f){a.o(r,c)||Object.defineProperty(r,c,{enumerable:!0,get:f})},a.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},a.t=function(r,c){if(1&c&&(r=a(r)),8&c||4&c&&typeof r=="object"&&r&&r.__esModule)return r;var f=Object.create(null);if(a.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:r}),2&c&&typeof r!="string")for(var d in r)a.d(f,d,(function(h){return r[h]}).bind(null,d));return f},a.n=function(r){var c=r&&r.__esModule?function(){return r.default}:function(){return r};return a.d(c,"a",c),c},a.o=function(r,c){return Object.prototype.hasOwnProperty.call(r,c)},a.p="",a(a.s=7)}([function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(r){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(r,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(r){this.itemsLoaded++,this.onProgress&&this.onProgress(r,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(r){this.onError&&this.onError(r)}resolveURL(r){return this.urlModifier?this.urlModifier(r):r}}},function(t,i,a){var r=this&&this.__awaiter||function(o,u,m,v){return new(m||(m=Promise))(function(_,g){function x(S){try{w(v.next(S))}catch(R){g(R)}}function E(S){try{w(v.throw(S))}catch(R){g(R)}}function w(S){S.done?_(S.value):new m(function(R){R(S.value)}).then(x,E)}w((v=v.apply(o,u||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const c=a(3),f=a(0);i.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},i.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i.GltfAsset=class{constructor(o,u,m,v=new f.LoadingManager){this.gltf=o,this.glbData=m,this.bufferData=new d(this,u,v),this.imageData=new h(this,u,v)}bufferViewData(o){return r(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const u=this.gltf.bufferViews[o],m=yield this.bufferData.get(u.buffer),v=u.byteLength||0,_=u.byteOffset||0,g=m.buffer,x=m.byteOffset;return new Uint8Array(g,x+_,v)})}accessorData(o){return r(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const u=this.gltf.accessors[o],m=i.GLTF_ELEMENTS_PER_TYPE[u.type];let v;if(u.bufferView!==void 0)v=yield this.bufferViewData(u.bufferView);else{const _=i.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType].BYTES_PER_ELEMENT*m*u.count;v=new Uint8Array(_)}if(u.sparse){const{count:_,indices:g,values:x}=u.sparse;let E=i.GLTF_COMPONENT_TYPE_ARRAYS[g.componentType],w=yield this.bufferViewData(g.bufferView);const S=new E(w.buffer,w.byteOffset+(g.byteOffset||0),_);E=i.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType],w=yield this.bufferViewData(x.bufferView);const R=new E((yield this.bufferViewData(x.bufferView)).buffer,w.byteOffset+(x.byteOffset||0),_*m);u.bufferView&&(v=new Uint8Array(v));const O=new i.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType](v.buffer);for(let I=0;I<_;I++)for(let D=0;D<m;D++)O[m*S[I]+D]=R[m*I+D]}return v})}preFetchAll(){return r(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class d{constructor(u,m,v){this.bufferCache=[],this.asset=u,this.baseUri=m,this.manager=v,this.loader=new c.FileLoader(v),this.loader.responseType="arraybuffer"}get(u){return r(this,void 0,void 0,function*(){if(this.bufferCache[u]!==void 0)return this.bufferCache[u];const m=this.asset.gltf;if(!m.buffers)throw new Error("No buffers found.");const v=m.buffers[u];if(v.uri===void 0){if(u!==0)throw new Error("GLB container is required to be the first buffer");if(this.asset.glbData===void 0)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const _=s(v.uri,this.baseUri),g=yield this.loader.load(_),x=new Uint8Array(g);return this.bufferCache[u]=x,x})}preFetchAll(){return r(this,void 0,void 0,function*(){const u=this.asset.gltf.buffers;return u?Promise.all(u.map((m,v)=>this.get(v))):[]})}}i.BufferData=d;class h{constructor(u,m,v){this.crossOrigin="anonymous",this.imageCache=[],this.asset=u,this.baseUri=m,this.manager=v}get(u){return r(this,void 0,void 0,function*(){if(this.imageCache[u]!==void 0)return this.imageCache[u];const m=this.asset.gltf;if(!m.images)throw new Error("No images found.");const v=m.images[u];let _,g=!1;if(v.bufferView!==void 0){const E=yield this.asset.bufferViewData(v.bufferView);g=!0;const w=new Blob([E],{type:v.mimeType});_=URL.createObjectURL(w)}else{if(v.uri===void 0)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");_=this.manager.resolveURL(s(v.uri,this.baseUri))}const x=new Image;return x.crossOrigin=this.crossOrigin,new Promise((E,w)=>{x.onerror=()=>{w(`Failed to load ${_}`),this.manager.itemEnd(_),this.manager.itemError(_)},x.onload=()=>{g&&URL.revokeObjectURL(_),this.imageCache[u]=x,E(x),this.manager.itemEnd(_)},x.src=_,this.manager.itemStart(_)})})}preFetchAll(){return r(this,void 0,void 0,function*(){const u=this.asset.gltf.images;return u?Promise.all(u.map((m,v)=>this.get(v))):[]})}}function s(o,u){return typeof o!="string"||o===""?"":/^(https?:)?\/\//i.test(o)||/^data:.*,.*$/i.test(o)||/^blob:.*$/i.test(o)?o:u+o}i.ImageData=h,i.resolveURL=s},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.LoaderUtils=class{static decodeText(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let c="";for(const f of r)c+=String.fromCharCode(f);return decodeURIComponent(escape(c))}static extractUrlBase(r){const c=r.split("/");return c.length===1?"./":(c.pop(),c.join("/")+"/")}}},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.FileLoader=class{constructor(r){this.runningRequests={},this.manager=r}load(r,c){if(this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r),this.runningRequests[r])return this.runningRequests[r];const f=new Promise((d,h)=>{const s=new XMLHttpRequest;s.open("GET",r,!0);const o=this;s.onload=function(u){const m=this.response;this.status===0?(console.warn("FileLoader: HTTP Status 0 received."),d(m),o.manager.itemEnd(r)):this.status===200?(d(m),o.manager.itemEnd(r)):(h({url:r,status:this.status,statusText:s.statusText}),o.manager.itemEnd(r),o.manager.itemError(r)),delete o.runningRequests[r]},s.onprogress=u=>{c&&c(u)},s.onerror=function(u){h({url:r,status:this.status,statusText:s.statusText}),o.manager.itemEnd(r),o.manager.itemError(r),delete o.runningRequests[r]},this.responseType&&(s.responseType=this.responseType),this.withCredentials&&(s.withCredentials=this.withCredentials),this.mimeType&&s.overrideMimeType&&s.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const u in this.requestHeaders)s.setRequestHeader(u,this.requestHeaders[u]);s.send(null),this.manager.itemStart(r)});return this.runningRequests[r]=f,f}setRequestHeader(r,c){return this.requestHeaders[r]=c,this}}},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0})},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0});const r=a(2);i.BINARY_HEADER_MAGIC="glTF",i.GLTFBinaryData=class{constructor(c){const f=new DataView(c,0,12),d=r.LoaderUtils.decodeText(new Uint8Array(c,0,4)),h=f.getUint32(4,!0);if(f.getUint32(8,!0),d!==i.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(h<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(c,12);let o=0;for(;o<s.byteLength;){const u=s.getUint32(o,!0);o+=4;const m=s.getUint32(o,!0);if(o+=4,m===1313821514){const v=new Uint8Array(c,12+o,u);this.json=r.LoaderUtils.decodeText(v)}else if(m===5130562){const v=12+o;this.binaryChunk=new Uint8Array(c,v,u)}o+=u}if(this.json===null)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,i,a){var r=this&&this.__awaiter||function(m,v,_,g){return new(_||(_=Promise))(function(x,E){function w(O){try{R(g.next(O))}catch(I){E(I)}}function S(O){try{R(g.throw(O))}catch(I){E(I)}}function R(O){O.done?x(O.value):new _(function(I){I(O.value)}).then(w,S)}R((g=g.apply(m,v||[])).next())})};function c(m){for(var v in m)i.hasOwnProperty(v)||(i[v]=m[v])}Object.defineProperty(i,"__esModule",{value:!0});const f=a(3),d=a(5),h=a(1),s=a(2),o=a(0),u=a(4);i.gltf=u,c(a(1)),c(a(0)),i.GltfLoader=class{constructor(m){this.manager=m||new o.LoadingManager}load(m,v){return r(this,void 0,void 0,function*(){const _=s.LoaderUtils.extractUrlBase(m),g=new f.FileLoader(this.manager);g.responseType="arraybuffer";const x=yield g.load(m,v);return yield this.parse(x,_)})}loadFromFiles(m){return r(this,void 0,void 0,function*(){let v,_;for(const[S,R]of m)R.name.match(/\.(gltf|glb)$/)&&(v=R,_=S.replace(R.name,""));if(!v)throw new Error("No .gltf or .glb asset found.");const g=typeof v=="string"?v:URL.createObjectURL(v),x=s.LoaderUtils.extractUrlBase(g),E=[];this.manager.urlModifier=S=>{const R=_+S.replace(x,"").replace(/^(\.?\/)/,"");if(m.has(R)){const O=m.get(R),I=URL.createObjectURL(O);return E.push(I),I}return S};const w=yield this.load(g);return yield w.preFetchAll(),URL.revokeObjectURL(g),E.forEach(URL.revokeObjectURL),w})}parse(m,v){return r(this,void 0,void 0,function*(){let _,g;_=typeof m=="string"?m:s.LoaderUtils.decodeText(new Uint8Array(m,0,4))===d.BINARY_HEADER_MAGIC?(g=new d.GLTFBinaryData(m)).json:s.LoaderUtils.decodeText(new Uint8Array(m));const x=JSON.parse(_);if(x.asset===void 0||x.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new h.GltfAsset(x,v,g,this.manager)})}}},function(t,i,a){t.exports=a(6)}])},7648:(p,t,i)=>{var a=i(6433),r=a.ValidatorResult,c=a.SchemaError,f={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},d=f.validators={};function h(v,_,g,x,E){var w=_.throwError,S=_.throwAll;_.throwError=!1,_.throwAll=!1;var R=this.validateSchema(v,E,_,g);return _.throwError=w,_.throwAll=S,!R.valid&&x instanceof Function&&x(R),R.valid}function s(v,_){if(Object.hasOwnProperty.call(v,_))return v[_];if(_ in v){for(;v=Object.getPrototypeOf(v);)if(Object.propertyIsEnumerable.call(v,_))return v[_]}}function o(v,_,g,x,E,w){if(this.types.object(v)&&(!_.properties||_.properties[E]===void 0))if(_.additionalProperties===!1)w.addError({name:"additionalProperties",argument:E,message:"is not allowed to have the additional property "+JSON.stringify(E)});else{var S=_.additionalProperties||{};typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,E,S,g,x);var R=this.validateSchema(v[E],S,g,x.makeChild(S,E));R.instance!==w.instance[E]&&(w.instance[E]=R.instance),w.importErrors(R)}}d.type=function(v,_,g,x){if(v===void 0)return null;var E=new r(v,_,g,x),w=Array.isArray(_.type)?_.type:[_.type];if(!w.some(this.testType.bind(this,v,_,g,x))){var S=w.map(function(R){if(R){var O=R.$id||R.id;return O?"<"+O+">":R+""}});E.addError({name:"type",argument:S,message:"is not of a type(s) "+S})}return E},d.anyOf=function(v,_,g,x){if(v===void 0)return null;var E=new r(v,_,g,x),w=new r(v,_,g,x);if(!Array.isArray(_.anyOf))throw new c("anyOf must be an array");if(!_.anyOf.some(h.bind(this,v,g,x,function(R){w.importErrors(R)}))){var S=_.anyOf.map(function(R,O){var I=R.$id||R.id;return I?"<"+I+">":R.title&&JSON.stringify(R.title)||R.$ref&&"<"+R.$ref+">"||"[subschema "+O+"]"});g.nestedErrors&&E.importErrors(w),E.addError({name:"anyOf",argument:S,message:"is not any of "+S.join(",")})}return E},d.allOf=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.allOf))throw new c("allOf must be an array");var E=new r(v,_,g,x),w=this;return _.allOf.forEach(function(S,R){var O=w.validateSchema(v,S,g,x);if(!O.valid){var I=S.$id||S.id||S.title&&JSON.stringify(S.title)||S.$ref&&"<"+S.$ref+">"||"[subschema "+R+"]";E.addError({name:"allOf",argument:{id:I,length:O.errors.length,valid:O},message:"does not match allOf schema "+I+" with "+O.errors.length+" error[s]:"}),E.importErrors(O)}}),E},d.oneOf=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.oneOf))throw new c("oneOf must be an array");var E=new r(v,_,g,x),w=new r(v,_,g,x),S=_.oneOf.filter(h.bind(this,v,g,x,function(O){w.importErrors(O)})).length,R=_.oneOf.map(function(O,I){return O.$id||O.id||O.title&&JSON.stringify(O.title)||O.$ref&&"<"+O.$ref+">"||"[subschema "+I+"]"});return S!==1&&(g.nestedErrors&&E.importErrors(w),E.addError({name:"oneOf",argument:R,message:"is not exactly one from "+R.join(",")})),E},d.if=function(v,_,g,x){if(v===void 0)return null;if(!a.isSchema(_.if))throw new Error('Expected "if" keyword to be a schema');var E,w=h.call(this,v,g,x,null,_.if),S=new r(v,_,g,x);if(w){if(_.then===void 0)return;if(!a.isSchema(_.then))throw new Error('Expected "then" keyword to be a schema');E=this.validateSchema(v,_.then,g,x.makeChild(_.then)),S.importErrors(E)}else{if(_.else===void 0)return;if(!a.isSchema(_.else))throw new Error('Expected "else" keyword to be a schema');E=this.validateSchema(v,_.else,g,x.makeChild(_.else)),S.importErrors(E)}return S},d.propertyNames=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x),w=_.propertyNames!==void 0?_.propertyNames:{};if(!a.isSchema(w))throw new c('Expected "propertyNames" to be a schema (object or boolean)');for(var S in v)if(s(v,S)!==void 0){var R=this.validateSchema(S,w,g,x.makeChild(w));E.importErrors(R)}return E}},d.properties=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x),w=_.properties||{};for(var S in w){var R=w[S];if(R!==void 0){if(R===null)throw new c('Unexpected null, expected schema in "properties"');typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,S,R,g,x);var O=s(v,S),I=this.validateSchema(O,R,g,x.makeChild(R,S));I.instance!==E.instance[S]&&(E.instance[S]=I.instance),E.importErrors(I)}}return E}},d.patternProperties=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x),w=_.patternProperties||{};for(var S in v){var R=!0;for(var O in w){var I=w[O];if(I!==void 0){if(I===null)throw new c('Unexpected null, expected schema in "patternProperties"');try{var D=new RegExp(O,"u")}catch{D=new RegExp(O)}if(D.test(S)){R=!1,typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,S,I,g,x);var j=this.validateSchema(v[S],I,g,x.makeChild(I,S));j.instance!==E.instance[S]&&(E.instance[S]=j.instance),E.importErrors(j)}}}R&&o.call(this,v,_,g,x,S,E)}return E}},d.additionalProperties=function(v,_,g,x){if(this.types.object(v)){if(_.patternProperties)return null;var E=new r(v,_,g,x);for(var w in v)o.call(this,v,_,g,x,w,E);return E}},d.minProperties=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x);return Object.keys(v).length>=_.minProperties||E.addError({name:"minProperties",argument:_.minProperties,message:"does not meet minimum property length of "+_.minProperties}),E}},d.maxProperties=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x);return Object.keys(v).length<=_.maxProperties||E.addError({name:"maxProperties",argument:_.maxProperties,message:"does not meet maximum property length of "+_.maxProperties}),E}},d.items=function(v,_,g,x){var E=this;if(this.types.array(v)&&_.items!==void 0){var w=new r(v,_,g,x);return v.every(function(S,R){if(Array.isArray(_.items))var O=_.items[R]===void 0?_.additionalItems:_.items[R];else O=_.items;if(O===void 0)return!0;if(O===!1)return w.addError({name:"items",message:"additionalItems not permitted"}),!1;var I=E.validateSchema(S,O,g,x.makeChild(O,R));return I.instance!==w.instance[R]&&(w.instance[R]=I.instance),w.importErrors(I),!0}),w}},d.contains=function(v,_,g,x){var E=this;if(this.types.array(v)&&_.contains!==void 0){if(!a.isSchema(_.contains))throw new Error('Expected "contains" keyword to be a schema');var w=new r(v,_,g,x);return v.some(function(S,R){return E.validateSchema(S,_.contains,g,x.makeChild(_.contains,R)).errors.length===0})===!1&&w.addError({name:"contains",argument:_.contains,message:"must contain an item matching given schema"}),w}},d.minimum=function(v,_,g,x){if(this.types.number(v)){var E=new r(v,_,g,x);return _.exclusiveMinimum&&_.exclusiveMinimum===!0?v>_.minimum||E.addError({name:"minimum",argument:_.minimum,message:"must be greater than "+_.minimum}):v>=_.minimum||E.addError({name:"minimum",argument:_.minimum,message:"must be greater than or equal to "+_.minimum}),E}},d.maximum=function(v,_,g,x){if(this.types.number(v)){var E=new r(v,_,g,x);return _.exclusiveMaximum&&_.exclusiveMaximum===!0?v<_.maximum||E.addError({name:"maximum",argument:_.maximum,message:"must be less than "+_.maximum}):v<=_.maximum||E.addError({name:"maximum",argument:_.maximum,message:"must be less than or equal to "+_.maximum}),E}},d.exclusiveMinimum=function(v,_,g,x){if(typeof _.exclusiveMinimum!="boolean"&&this.types.number(v)){var E=new r(v,_,g,x);return v>_.exclusiveMinimum||E.addError({name:"exclusiveMinimum",argument:_.exclusiveMinimum,message:"must be strictly greater than "+_.exclusiveMinimum}),E}},d.exclusiveMaximum=function(v,_,g,x){if(typeof _.exclusiveMaximum!="boolean"&&this.types.number(v)){var E=new r(v,_,g,x);return v<_.exclusiveMaximum||E.addError({name:"exclusiveMaximum",argument:_.exclusiveMaximum,message:"must be strictly less than "+_.exclusiveMaximum}),E}};var u=function(v,_,g,x,E,w){if(this.types.number(v)){var S=_[E];if(S==0)throw new c(E+" cannot be zero");var R=new r(v,_,g,x),O=a.getDecimalPlaces(v),I=a.getDecimalPlaces(S),D=Math.max(O,I),j=Math.pow(10,D);return Math.round(v*j)%Math.round(S*j)!=0&&R.addError({name:E,argument:S,message:w+JSON.stringify(S)}),R}};function m(v,_,g){var x,E=g.length;for(x=_+1;x<E;x++)if(a.deepCompareStrict(v,g[x]))return!1;return!0}d.multipleOf=function(v,_,g,x){return u.call(this,v,_,g,x,"multipleOf","is not a multiple of (divisible by) ")},d.divisibleBy=function(v,_,g,x){return u.call(this,v,_,g,x,"divisibleBy","is not divisible by (multiple of) ")},d.required=function(v,_,g,x){var E=new r(v,_,g,x);return v===void 0&&_.required===!0?E.addError({name:"required",message:"is required"}):this.types.object(v)&&Array.isArray(_.required)&&_.required.forEach(function(w){s(v,w)===void 0&&E.addError({name:"required",argument:w,message:"requires property "+JSON.stringify(w)})}),E},d.pattern=function(v,_,g,x){if(this.types.string(v)){var E=new r(v,_,g,x),w=_.pattern;try{var S=new RegExp(w,"u")}catch{S=new RegExp(w)}return v.match(S)||E.addError({name:"pattern",argument:_.pattern,message:"does not match pattern "+JSON.stringify(_.pattern.toString())}),E}},d.format=function(v,_,g,x){if(v!==void 0){var E=new r(v,_,g,x);return E.disableFormat||a.isFormat(v,_.format,this)||E.addError({name:"format",argument:_.format,message:"does not conform to the "+JSON.stringify(_.format)+" format"}),E}},d.minLength=function(v,_,g,x){if(this.types.string(v)){var E=new r(v,_,g,x),w=v.match(/[\uDC00-\uDFFF]/g);return v.length-(w?w.length:0)>=_.minLength||E.addError({name:"minLength",argument:_.minLength,message:"does not meet minimum length of "+_.minLength}),E}},d.maxLength=function(v,_,g,x){if(this.types.string(v)){var E=new r(v,_,g,x),w=v.match(/[\uDC00-\uDFFF]/g);return v.length-(w?w.length:0)<=_.maxLength||E.addError({name:"maxLength",argument:_.maxLength,message:"does not meet maximum length of "+_.maxLength}),E}},d.minItems=function(v,_,g,x){if(this.types.array(v)){var E=new r(v,_,g,x);return v.length>=_.minItems||E.addError({name:"minItems",argument:_.minItems,message:"does not meet minimum length of "+_.minItems}),E}},d.maxItems=function(v,_,g,x){if(this.types.array(v)){var E=new r(v,_,g,x);return v.length<=_.maxItems||E.addError({name:"maxItems",argument:_.maxItems,message:"does not meet maximum length of "+_.maxItems}),E}},d.uniqueItems=function(v,_,g,x){if(_.uniqueItems===!0&&this.types.array(v)){var E=new r(v,_,g,x);return v.every(m)||E.addError({name:"uniqueItems",message:"contains duplicate item"}),E}},d.dependencies=function(v,_,g,x){if(this.types.object(v)){var E=new r(v,_,g,x);for(var w in _.dependencies)if(v[w]!==void 0){var S=_.dependencies[w],R=x.makeChild(S,w);if(typeof S=="string"&&(S=[S]),Array.isArray(S))S.forEach(function(I){v[I]===void 0&&E.addError({name:"dependencies",argument:R.propertyPath,message:"property "+I+" not found, required by "+R.propertyPath})});else{var O=this.validateSchema(v,S,g,R);E.instance!==O.instance&&(E.instance=O.instance),O&&O.errors.length&&(E.addError({name:"dependencies",argument:R.propertyPath,message:"does not meet dependency required by "+R.propertyPath}),E.importErrors(O))}}return E}},d.enum=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.enum))throw new c("enum expects an array",_);var E=new r(v,_,g,x);return _.enum.some(a.deepCompareStrict.bind(null,v))||E.addError({name:"enum",argument:_.enum,message:"is not one of enum values: "+_.enum.map(String).join(",")}),E},d.const=function(v,_,g,x){if(v===void 0)return null;var E=new r(v,_,g,x);return a.deepCompareStrict(_.const,v)||E.addError({name:"const",argument:_.const,message:"does not exactly match expected constant: "+_.const}),E},d.not=d.disallow=function(v,_,g,x){var E=this;if(v===void 0)return null;var w=new r(v,_,g,x),S=_.not||_.disallow;return S?(Array.isArray(S)||(S=[S]),S.forEach(function(R){if(E.testType(v,_,g,x,R)){var O=R&&(R.$id||R.id)||R;w.addError({name:"not",argument:O,message:"is of prohibited type "+O})}}),w):null},p.exports=f},6433:(p,t,i)=>{var a=i(9983),r=t.ValidationError=function(E,w,S,R,O,I){if(Array.isArray(R)?(this.path=R,this.property=R.reduce(function(j,k){return j+u(k)},"instance")):R!==void 0&&(this.property=R),E&&(this.message=E),S){var D=S.$id||S.id;this.schema=D||S}w!==void 0&&(this.instance=w),this.name=O,this.argument=I,this.stack=this.toString()};r.prototype.toString=function(){return this.property+" "+this.message};var c=t.ValidatorResult=function(E,w,S,R){this.instance=E,this.schema=w,this.options=S,this.path=R.path,this.propertyPath=R.propertyPath,this.errors=[],this.throwError=S&&S.throwError,this.throwFirst=S&&S.throwFirst,this.throwAll=S&&S.throwAll,this.disableFormat=S&&S.disableFormat===!0};function f(E,w){return w+": "+E.toString()+`
`}function d(E){Error.captureStackTrace&&Error.captureStackTrace(this,d),this.instance=E.instance,this.schema=E.schema,this.options=E.options,this.errors=E.errors}c.prototype.addError=function(E){var w;if(typeof E=="string")w=new r(E,this.instance,this.schema,this.path);else{if(!E)throw new Error("Missing error detail");if(!E.message)throw new Error("Missing error message");if(!E.name)throw new Error("Missing validator type");w=new r(E.message,this.instance,this.schema,this.path,E.name,E.argument)}if(this.errors.push(w),this.throwFirst)throw new d(this);if(this.throwError)throw w;return w},c.prototype.importErrors=function(E){typeof E=="string"||E&&E.validatorType?this.addError(E):E&&E.errors&&(this.errors=this.errors.concat(E.errors))},c.prototype.toString=function(E){return this.errors.map(f).join("")},Object.defineProperty(c.prototype,"valid",{get:function(){return!this.errors.length}}),p.exports.ValidatorResultError=d,d.prototype=new Error,d.prototype.constructor=d,d.prototype.name="Validation Error";var h=t.SchemaError=function E(w,S){this.message=w,this.schema=S,Error.call(this,w),Error.captureStackTrace(this,E)};h.prototype=Object.create(Error.prototype,{constructor:{value:h,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var s=t.SchemaContext=function(E,w,S,R,O){this.schema=E,this.options=w,Array.isArray(S)?(this.path=S,this.propertyPath=S.reduce(function(I,D){return I+u(D)},"instance")):this.propertyPath=S,this.base=R,this.schemas=O};s.prototype.resolve=function(E){return a.resolve(this.base,E)},s.prototype.makeChild=function(E,w){var S=w===void 0?this.path:this.path.concat([w]),R=E.$id||E.id,O=a.resolve(this.base,R||""),I=new s(E,this.options,S,O,Object.create(this.schemas));return R&&!I.schemas[O]&&(I.schemas[O]=E),I};var o=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(E){return typeof E=="string"&&parseFloat(E)===parseInt(E,10)&&!isNaN(E)},regex:function(E){var w=!0;try{new RegExp(E)}catch{w=!1}return w},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};o.regexp=o.regex,o.pattern=o.regex,o.ipv4=o["ip-address"],t.isFormat=function(E,w,S){if(typeof E=="string"&&o[w]!==void 0){if(o[w]instanceof RegExp)return o[w].test(E);if(typeof o[w]=="function")return o[w](E)}else if(S&&S.customFormats&&typeof S.customFormats[w]=="function")return S.customFormats[w](E);return!0};var u=t.makeSuffix=function(E){return(E=E.toString()).match(/[.\s\[\]]/)||E.match(/^[\d]/)?E.match(/^\d+$/)?"["+E+"]":"["+JSON.stringify(E)+"]":"."+E};function m(E,w,S,R){typeof S=="object"?w[R]=g(E[R],S):E.indexOf(S)===-1&&w.push(S)}function v(E,w,S){w[S]=E[S]}function _(E,w,S,R){typeof w[R]=="object"&&w[R]&&E[R]?S[R]=g(E[R],w[R]):S[R]=w[R]}function g(E,w){var S=Array.isArray(w),R=S&&[]||{};return S?(E=E||[],R=R.concat(E),w.forEach(m.bind(null,E,R))):(E&&typeof E=="object"&&Object.keys(E).forEach(v.bind(null,E,R)),Object.keys(w).forEach(_.bind(null,E,w,R))),R}function x(E){return"/"+encodeURIComponent(E).replace(/~/g,"%7E")}t.deepCompareStrict=function E(w,S){if(typeof w!=typeof S)return!1;if(Array.isArray(w))return!!Array.isArray(S)&&w.length===S.length&&w.every(function(I,D){return E(w[D],S[D])});if(typeof w=="object"){if(!w||!S)return w===S;var R=Object.keys(w),O=Object.keys(S);return R.length===O.length&&R.every(function(I){return E(w[I],S[I])})}return w===S},p.exports.deepMerge=g,t.objectGetPath=function(E,w){for(var S,R=w.split("/").slice(1);typeof(S=R.shift())=="string";){var O=decodeURIComponent(S.replace(/~0/,"~").replace(/~1/g,"/"));if(!(O in E))return;E=E[O]}return E},t.encodePath=function(E){return E.map(x).join("")},t.getDecimalPlaces=function(E){var w=0;if(isNaN(E))return w;typeof E!="number"&&(E=Number(E));var S=E.toString().split("e");if(S.length===2){if(S[1][0]!=="-")return w;w=Number(S[1].slice(1))}var R=S[0].split(".");return R.length===2&&(w+=R[1].length),w},t.isSchema=function(E){return typeof E=="object"&&E||typeof E=="boolean"}},3780:(p,t,i)=>{var a=p.exports.Validator=i(4622);p.exports.ValidatorResult=i(6433).ValidatorResult,p.exports.ValidatorResultError=i(6433).ValidatorResultError,p.exports.ValidationError=i(6433).ValidationError,p.exports.SchemaError=i(6433).SchemaError,p.exports.SchemaScanResult=i(8075).SchemaScanResult,p.exports.scan=i(8075).scan,p.exports.validate=function(r,c,f){return new a().validate(r,c,f)}},8075:(p,t,i)=>{var a=i(9983),r=i(6433);function c(f,d){this.id=f,this.ref=d}p.exports.SchemaScanResult=c,p.exports.scan=function(f,d){function h(v,_){if(_&&typeof _=="object")if(_.$ref){var g=a.resolve(v,_.$ref);m[g]=m[g]?m[g]+1:0}else{var x=_.$id||_.id,E=x?a.resolve(v,x):v;if(E){if(E.indexOf("#")<0&&(E+="#"),u[E]){if(!r.deepCompareStrict(u[E],_))throw new Error("Schema <"+E+"> already exists with different definition");return u[E]}u[E]=_,E[E.length-1]=="#"&&(u[E.substring(0,E.length-1)]=_)}s(E+"/items",Array.isArray(_.items)?_.items:[_.items]),s(E+"/extends",Array.isArray(_.extends)?_.extends:[_.extends]),h(E+"/additionalItems",_.additionalItems),o(E+"/properties",_.properties),h(E+"/additionalProperties",_.additionalProperties),o(E+"/definitions",_.definitions),o(E+"/patternProperties",_.patternProperties),o(E+"/dependencies",_.dependencies),s(E+"/disallow",_.disallow),s(E+"/allOf",_.allOf),s(E+"/anyOf",_.anyOf),s(E+"/oneOf",_.oneOf),h(E+"/not",_.not)}}function s(v,_){if(Array.isArray(_))for(var g=0;g<_.length;g++)h(v+"/"+g,_[g])}function o(v,_){if(_&&typeof _=="object")for(var g in _)h(v+"/"+g,_[g])}var u={},m={};return h(f,d),new c(u,m)}},4622:(p,t,i)=>{var a=i(9983),r=i(7648),c=i(6433),f=i(8075).scan,d=c.ValidatorResult,h=c.ValidatorResultError,s=c.SchemaError,o=c.SchemaContext,u=function _(){this.customFormats=Object.create(_.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(v),this.attributes=Object.create(r.validators)};function m(_){var g=typeof _=="string"?_:_.$ref;return typeof g=="string"&&g}u.prototype.customFormats={},u.prototype.schemas=null,u.prototype.types=null,u.prototype.attributes=null,u.prototype.unresolvedRefs=null,u.prototype.addSchema=function(_,g){var x=this;if(!_)return null;var E=f(g||"/",_),w=g||_.$id||_.id;for(var S in E.id)this.schemas[S]=E.id[S];for(var S in E.ref)this.unresolvedRefs.push(S);return this.unresolvedRefs=this.unresolvedRefs.filter(function(R){return x.schemas[R]===void 0}),this.schemas[w]},u.prototype.addSubSchemaArray=function(_,g){if(Array.isArray(g))for(var x=0;x<g.length;x++)this.addSubSchema(_,g[x])},u.prototype.addSubSchemaObject=function(_,g){if(g&&typeof g=="object")for(var x in g)this.addSubSchema(_,g[x])},u.prototype.setSchemas=function(_){this.schemas=_},u.prototype.getSchema=function(_){return this.schemas[_]},u.prototype.validate=function(_,g,x,E){if(typeof g!="boolean"&&typeof g!="object"||g===null)throw new s("Expected `schema` to be an object or boolean");x||(x={});var w,S=g.$id||g.id,R=a.resolve(x.base||"/",S||"");if(!E){(E=new o(g,x,[],R,Object.create(this.schemas))).schemas[R]||(E.schemas[R]=g);var O=f(R,g);for(var I in O.id){var D=O.id[I];E.schemas[I]=D}}if(x.required&&_===void 0)return(w=new d(_,g,x,E)).addError("is required, but is undefined"),w;if(!(w=this.validateSchema(_,g,x,E)))throw new Error("Result undefined");if(x.throwAll&&w.errors.length)throw new h(w);return w},u.prototype.validateSchema=function(_,g,x,E){var w=new d(_,g,x,E);if(typeof g=="boolean")g===!0?g={}:g===!1&&(g={type:[]});else if(!g)throw new Error("schema is undefined");if(g.extends)if(Array.isArray(g.extends)){var S={schema:g,ctx:E};g.extends.forEach(this.schemaTraverser.bind(this,S)),g=S.schema,S.schema=null,S.ctx=null,S=null}else g=c.deepMerge(g,this.superResolve(g.extends,E));var R=m(g);if(R){var O=this.resolve(g,R,E),I=new o(O.subschema,x,E.path,O.switchSchema,E.schemas);return this.validateSchema(_,O.subschema,x,I)}var D=x&&x.skipAttributes||[];for(var j in g)if(!r.ignoreProperties[j]&&D.indexOf(j)<0){var k=null,G=this.attributes[j];if(G)k=G.call(this,_,g,x,E);else if(x.allowUnknownAttributes===!1)throw new s("Unsupported attribute: "+j,g);k&&w.importErrors(k)}if(typeof x.rewrite=="function"){var Z=x.rewrite.call(this,_,g,x,E);w.instance=Z}return w},u.prototype.schemaTraverser=function(_,g){_.schema=c.deepMerge(_.schema,this.superResolve(g,_.ctx))},u.prototype.superResolve=function(_,g){var x=m(_);return x?this.resolve(_,x,g).subschema:_},u.prototype.resolve=function(_,g,x){if(g=x.resolve(g),x.schemas[g])return{subschema:x.schemas[g],switchSchema:g};var E=a.parse(g),w=E&&E.hash,S=w&&w.length&&g.substr(0,g.length-w.length);if(!S||!x.schemas[S])throw new s("no such schema <"+g+">",_);var R=c.objectGetPath(x.schemas[S],w.substr(1));if(R===void 0)throw new s("no such schema "+w+" located in <"+S+">",_);return{subschema:R,switchSchema:g}},u.prototype.testType=function(_,g,x,E,w){if(w!==void 0){if(w===null)throw new s('Unexpected null in "type" keyword');if(typeof this.types[w]=="function")return this.types[w].call(this,_);if(w&&typeof w=="object"){var S=this.validateSchema(_,w,x,E);return S===void 0||!(S&&S.errors.length)}return!0}};var v=u.prototype.types={};v.string=function(_){return typeof _=="string"},v.number=function(_){return typeof _=="number"&&isFinite(_)},v.integer=function(_){return typeof _=="number"&&_%1==0},v.boolean=function(_){return typeof _=="boolean"},v.array=function(_){return Array.isArray(_)},v.null=function(_){return _===null},v.date=function(_){return _ instanceof Date},v.any=function(_){return!0},v.object=function(_){return _&&typeof _=="object"&&!Array.isArray(_)&&!(_ instanceof Date)},p.exports=u},6751:(p,t,i)=>{i.r(t),i.d(t,{decode:()=>E,default:()=>O,encode:()=>w,toASCII:()=>R,toUnicode:()=>S,ucs2decode:()=>v,ucs2encode:()=>_});const a=2147483647,r=36,c=/^xn--/,f=/[^\0-\x7F]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},s=Math.floor,o=String.fromCharCode;function u(I){throw new RangeError(h[I])}function m(I,D){const j=I.split("@");let k="";j.length>1&&(k=j[0]+"@",I=j[1]);const G=function(Z,K){const Y=[];let re=Z.length;for(;re--;)Y[re]=K(Z[re]);return Y}((I=I.replace(d,".")).split("."),D).join(".");return k+G}function v(I){const D=[];let j=0;const k=I.length;for(;j<k;){const G=I.charCodeAt(j++);if(G>=55296&&G<=56319&&j<k){const Z=I.charCodeAt(j++);(64512&Z)==56320?D.push(((1023&G)<<10)+(1023&Z)+65536):(D.push(G),j--)}else D.push(G)}return D}const _=I=>String.fromCodePoint(...I),g=function(I,D){return I+22+75*(I<26)-((D!=0)<<5)},x=function(I,D,j){let k=0;for(I=j?s(I/700):I>>1,I+=s(I/D);I>455;k+=r)I=s(I/35);return s(k+36*I/(I+38))},E=function(I){const D=[],j=I.length;let k=0,G=128,Z=72,K=I.lastIndexOf("-");K<0&&(K=0);for(let re=0;re<K;++re)I.charCodeAt(re)>=128&&u("not-basic"),D.push(I.charCodeAt(re));for(let re=K>0?K+1:0;re<j;){const Q=k;for(let se=1,ee=r;;ee+=r){re>=j&&u("invalid-input");const le=(Y=I.charCodeAt(re++))>=48&&Y<58?Y-48+26:Y>=65&&Y<91?Y-65:Y>=97&&Y<123?Y-97:r;le>=r&&u("invalid-input"),le>s((a-k)/se)&&u("overflow"),k+=le*se;const ge=ee<=Z?1:ee>=Z+26?26:ee-Z;if(le<ge)break;const ve=r-ge;se>s(a/ve)&&u("overflow"),se*=ve}const ae=D.length+1;Z=x(k-Q,ae,Q==0),s(k/ae)>a-G&&u("overflow"),G+=s(k/ae),k%=ae,D.splice(k++,0,G)}var Y;return String.fromCodePoint(...D)},w=function(I){const D=[],j=(I=v(I)).length;let k=128,G=0,Z=72;for(const re of I)re<128&&D.push(o(re));const K=D.length;let Y=K;for(K&&D.push("-");Y<j;){let re=a;for(const ae of I)ae>=k&&ae<re&&(re=ae);const Q=Y+1;re-k>s((a-G)/Q)&&u("overflow"),G+=(re-k)*Q,k=re;for(const ae of I)if(ae<k&&++G>a&&u("overflow"),ae===k){let se=G;for(let ee=r;;ee+=r){const le=ee<=Z?1:ee>=Z+26?26:ee-Z;if(se<le)break;const ge=se-le,ve=r-le;D.push(o(g(le+ge%ve,0))),se=s(ge/ve)}D.push(o(g(se,0))),Z=x(G,Q,Y===K),G=0,++Y}++G,++k}return D.join("")},S=function(I){return m(I,function(D){return c.test(D)?E(D.slice(4).toLowerCase()):D})},R=function(I){return m(I,function(D){return f.test(D)?"xn--"+w(D):D})},O={version:"2.3.1",ucs2:{decode:v,encode:_},decode:E,encode:w,toASCII:R,toUnicode:S}},769:p=>{var t=String.prototype.replace,i=/%20/g;p.exports={default:"RFC3986",formatters:{RFC1738:function(a){return t.call(a,i,"+")},RFC3986:function(a){return String(a)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},8985:(p,t,i)=>{var a=i(1088),r=i(2286),c=i(769);p.exports={formats:c,parse:r,stringify:a}},2286:(p,t,i)=>{var a=i(5364),r=Object.prototype.hasOwnProperty,c={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:a.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},f=function(d,h,s){if(d){var o=s.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,u=/(\[[^[\]]*])/g,m=/(\[[^[\]]*])/.exec(o),v=m?o.slice(0,m.index):o,_=[];if(v){if(!s.plainObjects&&r.call(Object.prototype,v)&&!s.allowPrototypes)return;_.push(v)}for(var g=0;(m=u.exec(o))!==null&&g<s.depth;){if(g+=1,!s.plainObjects&&r.call(Object.prototype,m[1].slice(1,-1))&&!s.allowPrototypes)return;_.push(m[1])}return m&&_.push("["+o.slice(m.index)+"]"),function(x,E,w){for(var S=E,R=x.length-1;R>=0;--R){var O,I=x[R];if(I==="[]"&&w.parseArrays)O=[].concat(S);else{O=w.plainObjects?Object.create(null):{};var D=I.charAt(0)==="["&&I.charAt(I.length-1)==="]"?I.slice(1,-1):I,j=parseInt(D,10);w.parseArrays||D!==""?!isNaN(j)&&I!==D&&String(j)===D&&j>=0&&w.parseArrays&&j<=w.arrayLimit?(O=[])[j]=S:D!=="__proto__"&&(O[D]=S):O={0:S}}S=O}return S}(_,h,s)}};p.exports=function(d,h){var s=h?a.assign({},h):{};if(s.decoder!==null&&s.decoder!==void 0&&typeof s.decoder!="function")throw new TypeError("Decoder has to be a function.");if(s.ignoreQueryPrefix=s.ignoreQueryPrefix===!0,s.delimiter=typeof s.delimiter=="string"||a.isRegExp(s.delimiter)?s.delimiter:c.delimiter,s.depth=typeof s.depth=="number"?s.depth:c.depth,s.arrayLimit=typeof s.arrayLimit=="number"?s.arrayLimit:c.arrayLimit,s.parseArrays=s.parseArrays!==!1,s.decoder=typeof s.decoder=="function"?s.decoder:c.decoder,s.allowDots=typeof s.allowDots=="boolean"?s.allowDots:c.allowDots,s.plainObjects=typeof s.plainObjects=="boolean"?s.plainObjects:c.plainObjects,s.allowPrototypes=typeof s.allowPrototypes=="boolean"?s.allowPrototypes:c.allowPrototypes,s.parameterLimit=typeof s.parameterLimit=="number"?s.parameterLimit:c.parameterLimit,s.strictNullHandling=typeof s.strictNullHandling=="boolean"?s.strictNullHandling:c.strictNullHandling,d===""||d==null)return s.plainObjects?Object.create(null):{};for(var o=typeof d=="string"?function(x,E){for(var w={},S=E.ignoreQueryPrefix?x.replace(/^\?/,""):x,R=E.parameterLimit===1/0?void 0:E.parameterLimit,O=S.split(E.delimiter,R),I=0;I<O.length;++I){var D,j,k=O[I],G=k.indexOf("]="),Z=G===-1?k.indexOf("="):G+1;Z===-1?(D=E.decoder(k,c.decoder),j=E.strictNullHandling?null:""):(D=E.decoder(k.slice(0,Z),c.decoder),j=E.decoder(k.slice(Z+1),c.decoder)),r.call(w,D)?w[D]=[].concat(w[D]).concat(j):w[D]=j}return w}(d,s):d,u=s.plainObjects?Object.create(null):{},m=Object.keys(o),v=0;v<m.length;++v){var _=m[v],g=f(_,o[_],s);u=a.merge(u,g,s)}return a.compact(u)}},1088:(p,t,i)=>{var a=i(5364),r=i(769),c={brackets:function(m){return m+"[]"},indices:function(m,v){return m+"["+v+"]"},repeat:function(m){return m}},f=Array.isArray,d=Array.prototype.push,h=function(m,v){d.apply(m,f(v)?v:[v])},s=Date.prototype.toISOString,o={delimiter:"&",encode:!0,encoder:a.encode,encodeValuesOnly:!1,serializeDate:function(m){return s.call(m)},skipNulls:!1,strictNullHandling:!1},u=function m(v,_,g,x,E,w,S,R,O,I,D,j){var k=v;if(typeof S=="function"?k=S(_,k):k instanceof Date&&(k=I(k)),k===null){if(x)return w&&!j?w(_,o.encoder):_;k=""}if(typeof k=="string"||typeof k=="number"||typeof k=="boolean"||a.isBuffer(k))return w?[D(j?_:w(_,o.encoder))+"="+D(w(k,o.encoder))]:[D(_)+"="+D(String(k))];var G,Z=[];if(k===void 0)return Z;if(f(S))G=S;else{var K=Object.keys(k);G=R?K.sort(R):K}for(var Y=0;Y<G.length;++Y){var re=G[Y];E&&k[re]===null||(f(k)?h(Z,m(k[re],g(_,re),g,x,E,w,S,R,O,I,D,j)):h(Z,m(k[re],_+(O?"."+re:"["+re+"]"),g,x,E,w,S,R,O,I,D,j)))}return Z};p.exports=function(m,v){var _=m,g=v?a.assign({},v):{};if(g.encoder!==null&&g.encoder!==void 0&&typeof g.encoder!="function")throw new TypeError("Encoder has to be a function.");var x=g.delimiter===void 0?o.delimiter:g.delimiter,E=typeof g.strictNullHandling=="boolean"?g.strictNullHandling:o.strictNullHandling,w=typeof g.skipNulls=="boolean"?g.skipNulls:o.skipNulls,S=typeof g.encode=="boolean"?g.encode:o.encode,R=typeof g.encoder=="function"?g.encoder:o.encoder,O=typeof g.sort=="function"?g.sort:null,I=g.allowDots!==void 0&&g.allowDots,D=typeof g.serializeDate=="function"?g.serializeDate:o.serializeDate,j=typeof g.encodeValuesOnly=="boolean"?g.encodeValuesOnly:o.encodeValuesOnly;if(g.format===void 0)g.format=r.default;else if(!Object.prototype.hasOwnProperty.call(r.formatters,g.format))throw new TypeError("Unknown format option provided.");var k,G,Z=r.formatters[g.format];typeof g.filter=="function"?_=(G=g.filter)("",_):f(g.filter)&&(k=G=g.filter);var K,Y=[];if(typeof _!="object"||_===null)return"";K=g.arrayFormat in c?g.arrayFormat:"indices"in g?g.indices?"indices":"repeat":"indices";var re=c[K];k||(k=Object.keys(_)),O&&k.sort(O);for(var Q=0;Q<k.length;++Q){var ae=k[Q];w&&_[ae]===null||h(Y,u(_[ae],ae,re,E,w,S?R:null,G,O,I,D,Z,j))}var se=Y.join(x),ee=g.addQueryPrefix===!0?"?":"";return se.length>0?ee+se:""}},5364:p=>{var t=Object.prototype.hasOwnProperty,i=function(){for(var r=[],c=0;c<256;++c)r.push("%"+((c<16?"0":"")+c.toString(16)).toUpperCase());return r}(),a=function(r,c){for(var f=c&&c.plainObjects?Object.create(null):{},d=0;d<r.length;++d)r[d]!==void 0&&(f[d]=r[d]);return f};p.exports={arrayToObject:a,assign:function(r,c){return Object.keys(c).reduce(function(f,d){return f[d]=c[d],f},r)},compact:function(r){for(var c=[{obj:{o:r},prop:"o"}],f=[],d=0;d<c.length;++d)for(var h=c[d],s=h.obj[h.prop],o=Object.keys(s),u=0;u<o.length;++u){var m=o[u],v=s[m];typeof v=="object"&&v!==null&&f.indexOf(v)===-1&&(c.push({obj:s,prop:m}),f.push(v))}return function(_){for(var g;_.length;){var x=_.pop();if(g=x.obj[x.prop],Array.isArray(g)){for(var E=[],w=0;w<g.length;++w)g[w]!==void 0&&E.push(g[w]);x.obj[x.prop]=E}}return g}(c)},decode:function(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch{return r}},encode:function(r){if(r.length===0)return r;for(var c=typeof r=="string"?r:String(r),f="",d=0;d<c.length;++d){var h=c.charCodeAt(d);h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122?f+=c.charAt(d):h<128?f+=i[h]:h<2048?f+=i[192|h>>6]+i[128|63&h]:h<55296||h>=57344?f+=i[224|h>>12]+i[128|h>>6&63]+i[128|63&h]:(d+=1,h=65536+((1023&h)<<10|1023&c.charCodeAt(d)),f+=i[240|h>>18]+i[128|h>>12&63]+i[128|h>>6&63]+i[128|63&h])}return f},isBuffer:function(r){return r!=null&&!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))},isRegExp:function(r){return Object.prototype.toString.call(r)==="[object RegExp]"},merge:function r(c,f,d){if(!f)return c;if(typeof f!="object"){if(Array.isArray(c))c.push(f);else{if(!c||typeof c!="object")return[c,f];(d&&(d.plainObjects||d.allowPrototypes)||!t.call(Object.prototype,f))&&(c[f]=!0)}return c}if(!c||typeof c!="object")return[c].concat(f);var h=c;return Array.isArray(c)&&!Array.isArray(f)&&(h=a(c,d)),Array.isArray(c)&&Array.isArray(f)?(f.forEach(function(s,o){if(t.call(c,o)){var u=c[o];u&&typeof u=="object"&&s&&typeof s=="object"?c[o]=r(u,s,d):c.push(s)}else c[o]=s}),c):Object.keys(f).reduce(function(s,o){var u=f[o];return t.call(s,o)?s[o]=r(s[o],u,d):s[o]=u,s},h)}}},9017:function(p,t,i){var a=this&&this.__decorate||function(_,g,x,E){var w,S=arguments.length,R=S<3?g:E===null?E=Object.getOwnPropertyDescriptor(g,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,E);else for(var O=_.length-1;O>=0;O--)(w=_[O])&&(R=(S<3?w(R):S>3?w(g,x,R):w(g,x))||R);return S>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.AccumulatePass=void 0;const r=i(9504),c=i(7564),f=i(8215),d=i(4127),h=i(1896),s=i(4168),o=i(771),u=i(8593),m=i(9217);class v extends d.Initializable{constructor(g){super(),this._altered=Object.assign(new c.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=m.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=g}initialize(g){const x=this._context.gl;this._accumulationFBOs=[new f.Framebuffer(this._context,"AccumPingFBO"),new f.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new u.Texture2D(this._context,"AccumPingTexture"),new u.Texture2D(this._context,"AccumPongTexture")],g===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=g,this._ndcTriangleShared=!0);const E=new o.Shader(this._context,x.VERTEX_SHADER,"ndcvertices.vert (accumulate)");E.initialize(i(9657));const w=new o.Shader(this._context,x.FRAGMENT_SHADER,"accumulate.frag");return w.initialize(i(8058)),this._program=new s.Program(this._context,"AccumulateProgram"),this._program.initialize([E,w],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),x.uniform1f(this._uWeight,0),x.uniform1i(this._program.uniform("u_accumulationTexture"),0),x.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void(0,r.log)(r.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const g=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!g)return void(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const x=this._context.gl,E=this._context.gl2facade,w=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||g)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].reformat(S[0],x.RGBA,S[1]),this._accumulationTextures[1].reformat(S[0],x.RGBA,S[1])}}else{const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].initialize(w[0],w[1],S[0],x.RGBA,S[1]),this._accumulationTextures[1].initialize(w[0],w[1],S[0],x.RGBA,S[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(g,x){if((0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||this._texture===void 0)return;(0,r.logIf)(!this._texture||!this._texture.valid,r.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const E=this._context.gl;x!==void 0&&E.viewport(0,0,x[0],x[1]);const w=g%2,S=this._write=1-w,R=this._accumulationTextures[w],O=this._texture;R.bind(E.TEXTURE0),O.bind(E.TEXTURE1),this._program.bind(),E.uniform1f(this._uWeight,1/(g+1)),this._accumulationFBOs[S].bind(E.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[S].unbind(E.DRAW_FRAMEBUFFER),R.unbind(E.TEXTURE0),O.unbind(E.TEXTURE1)}set texture(g){this.assertInitialized(),this._texture!==g&&(this._texture=g,this._altered.alter("texture"))}set precision(g){this.assertInitialized(),this._precision!==g&&(this._precision=g,this._altered.alter("precision"))}set passThrough(g){this.assertInitialized(),this._passThrough!==g&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=g,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}t.AccumulatePass=v,a([d.Initializable.initialize()],v.prototype,"initialize",null),a([d.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],v.prototype,"update",null),a([d.Initializable.assert_initialized()],v.prototype,"frame",null)},7501:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AllocationRegister=void 0;const a=i(7032),r=i(9504);t.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new a.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(c){(0,r.assert)(this._bytesByIdentifier.has(c),"allocation identifier unknown")}createUniqueIdentifier(c){let f=c,d=2;for(;this._bytesByIdentifier.has(f);)f=`${c}-${d}`,++d;return this._bytesByIdentifier.set(f,0),f}deleteUniqueIdentifier(c){(0,r.assert)(this._bytesByIdentifier.has(c),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(c)}allocate(c,f){if(this.assertIdentifier(c),(0,r.assert)(f>=0,`positive number of bytes expected for allocation, given ${f}`),f===0)return;const d=this._bytesByIdentifier.get(c)+f;this._bytesByIdentifier.set(c,d),this._bytes=this._bytes+f,this.bytesNext()}deallocate(c,f){this.assertIdentifier(c);const d=this._bytesByIdentifier.get(c);(0,r.assert)(f>=0,`positive number of bytes expected for deallocation, given ${f}`),(0,r.assert)(f<=d,`deallocation cannot exceed previous allocations of ${d}, given ${f}`),f!==0&&(this._bytesByIdentifier.set(c,d-f),this._bytes=this._bytes-f,this.bytesNext())}reallocate(c,f){this.assertIdentifier(c),(0,r.assert)(f>=0,`positive number of bytes expected for reallocation, given ${f}`);const d=this._bytesByIdentifier.get(c);d!==f&&(this._bytes=this._bytes-d,this._bytesByIdentifier.set(c,f),this._bytes=this._bytes+f,this.bytesNext())}allocated(c){return c===void 0?this._bytes:(this.assertIdentifier(c),this._bytesByIdentifier.get(c))}toString(){const c=new Array;return this._bytesByIdentifier.forEach((f,d)=>{c.push(`${d}: ${(0,r.prettyPrintBytes)(f)}`)}),c.join(", ")}bytesToString(c){return(0,r.prettyPrintBytes)(this.allocated(c))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},2419:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiAliasingKernel=void 0;const a=i(3039);class r extends a.RandomSquareKernel{constructor(f){super(f)}generate(){switch(this._width){case 8:this.fromJSON(i(3058));break;case 64:this.fromJSON(i(9148));break;case 128:this.fromJSON(i(6399));break;default:super.generate()}}}t.AntiAliasingKernel=r},9504:(p,t,i)=>{const a=i(5150);var r;(function(c){let f,d=2;c.logVerbosity=function(E){return E!==void 0&&(d=Math.max(-1,E)),d},function(E){E[E.Debug=3]="Debug",E[E.Info=2]="Info",E[E.Warning=1]="Warning",E[E.Error=0]="Error"}(f=c.LogLevel||(c.LogLevel={}));const h=(E,w)=>{if(!E)throw new EvalError(w)},s=(E,w)=>{};function o(E,...w){E>d||console.log(`[${E}]`,...w)}function u(E){const w=`${E}-start`;c.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),c.assert(performance.getEntriesByName(w).length===0,`expected mark identifier to not already exists, given ${w}`),performance.mark(w)}function m(E,w,S=0){const R=`${E}-start`,O=`${E}-end`;c.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),c.assert(performance.getEntriesByName(O).length===0,`expected mark identifier to not already exists, given ${O}`),performance.mark(O),performance.measure(E,R,O);const I=performance.getEntriesByName(E)[0];performance.clearMarks(R),performance.clearMarks(O),performance.clearMeasures(E);const D=w===void 0||w.length===0?0:2,j=Math.max(D,S-E.length-(w?w.length:0)-1),k=x(I.duration);o(f.Debug,`${E}${" ".repeat(j)}${w||""} | ${k}`)}c.assert=h,c.assertions=function(E){return E!==void 0&&(c.assert=E?h:s),c.assert!==s},c.log=o,c.logIf=function(E,w,...S){E&&o(w,...S)},c.logPerformanceStart=u,c.logPerformanceStartIf=function(E,w){E&&u(w)},c.logPerformanceStop=m,c.logPerformanceStopIf=function(E,w,S,R=0){E&&m(w,S,R)},c.rand=function(E=0,w=1){return Math.random()*(w-E)+E},c.isPowerOfTwo=function(E){return Number.isInteger(E)&&Number.isInteger(Math.log2(E))},c.upperPowerOfTwo=function(E){return--E,E|=E>>1,E|=E>>2,E|=E>>4,E|=E>>8,E|=E>>16,++E};const v=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];c.prettyPrintBytes=function(E){const w=E>0?Math.floor(Math.log(E)/Math.log(1024)):0,S=E/Math.pow(1024,w);return`${w>0?S.toFixed(3):S}${v[w]}B`};const _=["ms","ns","μs","ms","s"],g=[0,1e6,1e3,1,.001];function x(E){let w=E>0?Math.max(1,Math.floor(Math.log(10*E)/Math.log(1e3))+3):0;return w=(0,a.clamp)(w,0,4),`${(E*g[w]).toFixed(3)}${_[w]}`}c.prettyPrintMilliseconds=x,c.bitInBitfield=function(E,w){return w!==void 0&&(E&w)===w},c.RAD2DEG=57.29577951308232,c.DEG2RAD=.017453292519943295,c.GETsearch=function(){var w,S;let E=window.location.search;return E||(E=((S=(w=window.top)==null?void 0:w.location)==null?void 0:S.search)||""),E},c.GETparameter=function(E){var R,O;const w=new RegExp(`${E}=([^&]+)`);let S=window.location.search.match(w);if(S||(S=((O=(R=window.top)==null?void 0:R.location)==null?void 0:O.search.match(w))||null),S)return S[1]},c.PATH_SEPARATOR="/",c.dirname=function(E){return E.includes(c.PATH_SEPARATOR)===!1?"":E.substr(0,E.lastIndexOf(c.PATH_SEPARATOR)).trimLeft()},c.basename=function(E){return E.includes(c.PATH_SEPARATOR)===!1?E:E.substr(E.lastIndexOf(c.PATH_SEPARATOR)+1).trimRight()}})(r||(r={})),p.exports=r},8263:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Benchmark=void 0,t.Benchmark=class{constructor(){this._running=!1,this._results=new Array,this._framePrepare=void 0,this._runsFinished=void 0}initialize(i,a,r,c,f){this._running?console.log("benchmark already in progress"):(this._framePrepare=c,this._runsFinished=f,this._running=!0,this._frames=0,this._runs=Math.max(0,i),this._framesForWarmup=Math.max(0,a),this._framesPerCycle=Math.max(1,r),this._results.length=this._runs,this._results.fill(0))}frame(){if(this._running===!1)return;++this._frames;const i=this._frames-this._framesForWarmup,a=i<0?i:i%this._framesPerCycle,r=i>=0?Math.floor(i/this._framesPerCycle):-1;i===1-this._framesForWarmup&&console.log("---- benchmark warmup ------"),i===0&&console.log("---- benchmark started -----"),i%this._framesPerCycle==0&&r>0&&(this._results[r-1]=(performance.now()-this._results[r-1])/this._framesPerCycle,console.log(" --  cycle: "+r.toString().padStart(2,"0")+", tpf: "+this._results[r-1].toFixed(4).padStart(9,"0")+", fps: "+(1e3/this._results[r-1]).toFixed(4).padStart(9,"0"))),i%this._framesPerCycle==0&&r>=0&&r<this._runs&&(this._results[r]=performance.now()),r>=this._runs?(this._running=!1,console.log("---- benchmark stopped -----"),this._framePrepare=void 0,this._runsFinished(this._runs,this._framesForWarmup,this._framesPerCycle,this._results),this._runsFinished=void 0):this._framePrepare(a,this._framesForWarmup,this._framesPerCycle,r)}get running(){return this._running}}},8196:function(p,t,i){var a=this&&this.__decorate||function(m,v,_,g){var x,E=arguments.length,w=E<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,v,_,g);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(v,_,w):x(v,_))||w);return E>3&&w&&Object.defineProperty(v,_,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.BlitPass=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(4127),h=i(1896),s=i(4168),o=i(771);class u extends d.Initializable{constructor(v){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=v}functionBlit(){const v=this._context.gl;if(this._target.bind(v.DRAW_FRAMEBUFFER),this._framebuffer.bind(v.READ_FRAMEBUFFER),v.readBuffer(this._readBuffer),this._drawBuffer>=v.COLOR_ATTACHMENT1&&this._drawBuffer<=v.COLOR_ATTACHMENT15){const x=this._drawBuffer-v.COLOR_ATTACHMENT0,E=new Array(x+1).fill(v.NONE);E[x]=this._drawBuffer,v.drawBuffers(E)}else v.drawBuffers([this._drawBuffer]);v.enable(v.SCISSOR_TEST),v.scissor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),v.disable(v.SCISSOR_TEST);const _=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],g=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];v.blitFramebuffer(_[0],_[1],_[2],_[3],g[0],g[1],g[2],g[3],v.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(v.READ_FRAMEBUFFER),this._target.unbind(v.DRAW_FRAMEBUFFER)}programBlit(){this._program===void 0&&this.createProgram(),(0,c.assert)(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const v=this._context.gl,_=this._srcBounds?this._srcBounds:r.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),g=this._dstBounds?this._dstBounds:r.vec4.fromValues(0,0,this._target.width,this._target.height),x=r.vec4.div((0,f.v4)(),_,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),E=r.vec4.div((0,f.v4)(),g,[this._target.width,this._target.height,this._target.width,this._target.height]);v.viewport(g[0],g[1],g[2]-g[0],g[3]-g[1]),v.disable(v.DEPTH_TEST),v.depthMask(!1),this._program.bind(),v.uniform4fv(this._uSrcBounds,x),v.uniform4fv(this._uDstBounds,E),v.uniform1i(this._uNearest,this.filter===v.nearest);const w=this._framebuffer.texture(this._readBuffer);w.bind(v.TEXTURE0);const S=this._context.isWebGL2?v.DRAW_FRAMEBUFFER:v.FRAMEBUFFER;this._target.bind(S),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(S),w.unbind(),v.enable(v.DEPTH_TEST),v.depthMask(!0)}createProgram(){(0,c.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const v=this._context.gl,_=new o.Shader(this._context,v.VERTEX_SHADER,"blit.vert (blit)");_.initialize(i(3354));const g=new o.Shader(this._context,v.FRAGMENT_SHADER,"blit.frag (blit)");return g.initialize(i(6523)),this._program=new s.Program(this._context,"BlitProgram"),this._program.initialize([_,g],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),v.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(v){const _=this._context.gl;return v===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._filter=_.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){(0,c.logIf)(!this._target||!this._target.valid,c.LogLevel.Warning,`valid target expected, given ${this._target}`),(0,c.logIf)(!this._framebuffer||!this._framebuffer.valid,c.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const v=this._context.gl;switch(this._readBuffer){case v.DEPTH_ATTACHMENT:case v.STENCIL_ATTACHMENT:case v.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&this._enforceProgramBlit===!1)return this.functionBlit();this.programBlit()}set framebuffer(v){this.assertInitialized(),this._framebuffer=v}set readBuffer(v){this.assertInitialized(),this._readBuffer=v}set drawBuffer(v){this.assertInitialized(),this._drawBuffer=v}set target(v){this.assertInitialized(),this._target=v}set filter(v){this._filter=v}set srcBounds(v){this._srcBounds=v?r.vec4.clone(v):void 0}set dstBounds(v){this._dstBounds=v?r.vec4.clone(v):void 0}set enforceProgramBlit(v){this._enforceProgramBlit=v}}t.BlitPass=u,a([d.Initializable.initialize()],u.prototype,"initialize",null),a([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],u.prototype,"frame",null)},7340:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._target=d.DEFAULT_BUFFER}create(s){const o=this._context.gl;return this._object=o.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&((0,r.assert)(s===o.ARRAY_BUFFER||s===o.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=s),this._object}delete(){(0,r.assert)(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=d.DEFAULT_BUFFER}bind(){(0,r.assert)(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,d.DEFAULT_BUFFER)}data(s,o,u=!0,m=!0){const v=this.context.gl;u&&this.bind(),v.bufferData(this._target,s,o),m&&this.unbind(),this._valid=v.isBuffer(this._object)&&v.getError()===v.NO_ERROR;const _=typeof s=="number"?s:s.byteLength,g=this._valid?_:0;this.context.allocationRegister.reallocate(this._identifier,g)}subData(s,o,u=0,m=0,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),this.context.gl2facade.bufferSubData(this._target,s,o,u,m),_&&this.unbind(),this._valid=g.getError()===g.NO_ERROR}attribEnable(s,o,u,m=!1,v=0,_=0,g=!0,x=!0){const E=this.context.gl;g&&this.bind(),E.vertexAttribPointer(s,o,u,m,v,_),E.enableVertexAttribArray(s),x&&this.unbind()}attribEnableInt(s,o,u,m=0,v=0,_=!0,g=!0){const x=this.context.gl;_&&this.bind(),x.vertexAttribIPointer(s,o,u,m,v),x.enableVertexAttribArray(s),g&&this.unbind()}attribDisable(s,o=!0,u=!0){const m=this.context.gl;o&&this.bind(),m.disableVertexAttribArray(s),u&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}t.Buffer=d,d.DEFAULT_BUFFER=void 0,a([c.Initializable.assert_initialized()],d.prototype,"bind",null),a([c.Initializable.assert_initialized()],d.prototype,"unbind",null),a([c.Initializable.assert_initialized()],d.prototype,"data",null),a([c.Initializable.assert_initialized()],d.prototype,"attribEnable",null),a([c.Initializable.assert_initialized()],d.prototype,"attribEnableInt",null),a([c.Initializable.assert_initialized()],d.prototype,"attribDisable",null)},3025:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const a=i(3557),r=i(5150),c=i(9504),f=i(2813);class d{static calculateFovY(s,o){return 2*Math.atan(.5*s/o)}constructor(s,o,u){this._fovy=d.DEFAULT_FOVY,this._near=d.DEFAULT_NEAR,this._far=d.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=s?a.vec3.clone(s):a.vec3.clone(d.DEFAULT_EYE),this._center=o?a.vec3.clone(o):a.vec3.clone(d.DEFAULT_CENTER),this._up=u?a.vec3.clone(u):a.vec3.clone(d.DEFAULT_UP)}invalidate(s,o,u=!1){s&&(this._view=void 0,this._viewInverse=void 0),o&&(this._projection=void 0,this._projectionInverse=void 0),(s||o||u)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(s){a.vec3.equals(this._eye,s)||(this._eye=a.vec3.clone(s),this.invalidate(!0,!1))}get center(){return this._center}set center(s){a.vec3.equals(this._center,s)||(this._center=a.vec3.clone(s),this.invalidate(!0,!1))}get up(){return this._up}set up(s){a.vec3.equals(this._up,s)||(this._up=a.vec3.clone(s),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(s){this._fovy!==s&&(this._fovy=s,this.invalidate(!1,!0))}set fovx(s){const o=s*c.DEG2RAD,u=2*Math.atan(Math.tan(o/2)*(1/this.aspect))*c.RAD2DEG;this._fovy!==u&&(this._fovy=u,this.invalidate(!1,!0))}fovFromLens(s,o){const u=2*Math.atan(s/(2*o));this.fovx=u*c.RAD2DEG}get near(){return this._near}set near(s){this._near!==s&&(s>=this._far&&(0,c.log)(c.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${s}`),this._near=s,this.invalidate(!1,!0))}get far(){return this._far}set far(s){this._far!==s&&(this._near>=s&&(0,c.log)(c.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${s}`),this._far=s,this.invalidate(!1,!0))}set viewport(s){this._viewport[0]===s[0]&&this._viewport[1]===s[1]||(this._viewport=(0,f.duplicate2)(s),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(s){this._aspect!==s&&(this._aspect=s)}get aspect(){return this._aspect}get view(){return this._view||(this._view=a.mat4.lookAt((0,r.m4)(),this._eye,this._center,this._up)),this._view}get viewInverse(){return this._viewInverse!==void 0||(this._viewInverse=a.mat4.invert((0,r.m4)(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=a.mat4.perspective((0,r.m4)(),this.fovy*c.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return this._projectionInverse!==void 0||(this._projectionInverse=a.mat4.invert((0,r.m4)(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=a.mat4.multiply((0,r.m4)(),this.projection,this.view),this._viewProjection=a.mat4.multiply((0,r.m4)(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return this._viewProjectionInverse!==void 0||(this._viewProjectionInverse=a.mat4.invert((0,r.m4)(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:a.mat4.identity((0,r.m4)())}set postViewProjection(s){this._postViewProjection=s,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(s){this._altered=s}}t.Camera=d,d.DEFAULT_EYE=a.vec3.fromValues(0,0,1),d.DEFAULT_CENTER=a.vec3.fromValues(0,0,0),d.DEFAULT_UP=a.vec3.fromValues(0,1,0),d.DEFAULT_FOVY=45,d.DEFAULT_NEAR=2,d.DEFAULT_FAR=8},7344:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CameraModifier=void 0;const a=i(3025);t.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new a.Camera}set camera(r){this._camera!==r&&(this._camera=r,r!==void 0&&(Object.assign(this._reference,r),this.update()))}}},7858:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;const a=i(7032),r=i(3557),c=i(5150),f=i(9504),d=i(2813),h=i(3847),s=i(2527),o=i(8234),u=i(3975),m=i(4602),v=i(8216),_=i(9137),g=i(8870),x=i(5678),E=i(9217);class w extends _.Resizable{constructor(R,O){super(),this._framePrecisionSubject=new a.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new a.ReplaySubject(1),this._frameScaleSubject=new a.ReplaySubject(1),this._frameSizeSubject=new a.ReplaySubject(1),this._element=R instanceof HTMLCanvasElement?R:document.getElementById(R),this._element.addEventListener("webglcontextcreationerror",k=>{console.log(k.statusMessage||"Unknown error")},!1),this.observe(this._element),this._mouseEventProvider=new m.MouseEventProvider(this._element,200),this._touchEventProvider=new g.TouchEventProvider(this._element,200),this._pointerEventProvider=new v.PointerEventProvider(this._element,200),this._keyboardEventProvider=new x.KeyboardEventProvider(this._element,200),this._element.style.touchAction="none";const I=this._element.dataset;let D;this._context=s.Context.request(this._element,O),this.configureController(I),this.configureSizeAndScale(I),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),I.clearColor&&(D=(0,c.parseVec4)(I.clearColor),(0,f.logIf)(D===void 0,f.LogLevel.Warning,`data-clear-color could not be parsed, given '${I.clearColor}'`)),this._clearColor=D?new h.Color((0,d.tuple4)(D)):w.DEFAULT_CLEAR_COLOR;let j=I.accumulationFormat?I.accumulationFormat:w.DEFAULT_FRAME_PRECISION;j in E.Wizard.Precision||(j=w.DEFAULT_FRAME_PRECISION,(0,f.log)(f.LogLevel.Warning,`unknown frame precision '${I.accumulationFormat}' changed to '${j}'`)),this._framePrecision=j,this.framePrecisionNext()}configureController(R){let O,I;this._controller=new o.Controller,this._controller.block(),R.multiFrameNumber&&(O=parseInt(R.multiFrameNumber,10),(0,f.logIf)(isNaN(O),f.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${R.multiFrameNumber}'`)),R.debugFrameNumber&&(I=parseInt(R.debugFrameNumber,10),(0,f.logIf)(isNaN(I),f.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${R.debugFrameNumber}'`)),this._controller.multiFrameNumber=O||w.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=I||0;const D=!!O&&O!==this._controller.multiFrameNumber;(0,f.logIf)(D,f.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${R.multiFrameNumber}'`);const j=!!I&&I!==this._controller.debugFrameNumber;(0,f.logIf)(j,f.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${R.debugFrameNumber}'`)}configureSizeAndScale(R){let O,I;R.frameScale&&(O=(0,c.parseVec2)(R.frameScale),(0,f.logIf)(R.frameScale!==void 0&&O===void 0,f.LogLevel.Warning,`data-frame-scale could not be parsed, given '${R.frameScale}'`)),this._frameScale=O?(0,d.tuple2)(O):[1,1],R.frameSize&&(I=(0,c.parseVec2)(R.frameSize),(0,f.logIf)(R.frameSize!==void 0&&I===void 0,f.LogLevel.Warning,`data-frame-size could not be parsed, given '${R.frameSize}'`)),this._favorSizeOverScale=I!==void 0,this._frameSize=I?(0,d.tuple2)(I):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",R=>{R.preventDefault(),this.onContextLost()},!1),this._element.addEventListener("webglcontextrestored",()=>{this.onContextRestore()},!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){(0,f.log)(f.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){(0,f.log)(f.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const R=this._renderer;this.unbind(),this.bind(R),this._controller.unblock();const O=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=O}retrieveSize(){const R=_.Resizable.elementSize(this._element);R!==void 0?(this._size=[R[0],R[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),this._size[0]===0||this._size[1]===0)return(0,f.log)(f.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(R){this._renderer!==R&&(this.unbind(),R!==void 0&&((0,f.assert)(this._controller.blocked,"expected controller to be blocked"),this._renderer=R,this._renderer.initialize(this.context,O=>this._controller.update(O),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider,keyboardEventProvider:this._keyboardEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){this._renderer!==void 0&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(R){this.bind(R)}get frameScale(){return this._frameScale}set frameScale(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,f.log)(f.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,f.logIf)(R[0]<0||R[0]>8,f.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${R[0]}`),(0,f.logIf)(R[1]<0||R[1]>8,f.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${R[0]}`);const O=r.vec2.create();(0,c.clamp2)(O,R,[0,0],[8,8]);const I=r.vec2.create();r.vec2.mul(I,this._size,O),r.vec2.max(I,[1,1],I),r.vec2.round(I,I),r.vec2.div(O,I,this._size),(0,f.logIf)(!r.vec2.exactEquals(O,R),2,`frame scale was adjusted to ${O.toString()}, given ${R.toString()}`),this._frameScale=(0,d.tuple2)(O),this._frameSize=(0,d.tuple2)(I),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,f.log)(f.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,f.logIf)(R[0]<1||R[0]>8*this._size[0],f.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${R[0]}`),(0,f.logIf)(R[1]<1||R[1]>8*this._size[1],f.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${R[1]}`);const O=r.vec2.create();(0,c.clamp2)(O,R,[1,1],[8*this._size[0],8*this._size[1]]),r.vec2.round(O,O),(0,f.logIf)(!r.vec2.exactEquals(O,R),f.LogLevel.Warning,`frame size was adjusted to ${O.toString()}, given ${R.toString()}`);const I=r.vec2.create();r.vec2.div(I,O,this._size),this._frameScale=(0,d.tuple2)(I),this._frameSize=(0,d.tuple2)(O),this._favorSizeOverScale=!r.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(R){this._clearColor=R,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(R){this._framePrecision=R,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}get keyboardEventProvider(){return this._keyboardEventProvider}testLoseContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.loseContext()}testRestoreContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(R,O){this._eyeGazeEventProvider=new u.EyeGazeEventProvider(R,O)}}t.Canvas=w,w.DEFAULT_CLEAR_COLOR=new h.Color([.203,.227,.25,1]),w.DEFAULT_FRAME_PRECISION=E.Wizard.Precision.auto,w.DEFAULT_MULTI_FRAME_NUMBER=0},8596:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRecorder=void 0;const a=i(9504);class r{static isSupported(){return window.MediaRecorder!==void 0}static isMIMETypeSupported(f){return MediaRecorder.isTypeSupported(f)}constructor(f){(0,a.assert)(r.isSupported(),"Recording the canvas is not supported."),this._canvas=f,this._state=r.State.INACTIVE,this._images=new Array}start(f,d="video/webm",h=4194304){(0,a.assert)(f>=0,"FPS has to be positive"),(0,a.assert)(this._state===r.State.INACTIVE,"Recorder has to be inactive."),(0,a.assert)(r.isMIMETypeSupported(d),`MIME type: ${d} is not supported.`),this._stream=this._canvas.element.captureStream(f),this._recorder=new MediaRecorder(this._stream,{mimeType:d,bitsPerSecond:h}),this._images.length=0,this._mimeType=d,this._recorder.ondataavailable=s=>this._images.push(s.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=r.State.RECORDING}stop(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive.");const f=this._stream.getTracks();(0,a.assert)(f.length===1,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),f[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=r.State.INACTIVE}pause(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=r.State.PAUSED}resume(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=r.State.RECORDING}frame(){(0,a.assert)(this._state===r.State.RECORDING,"Recorder has to be recording.");const f=this._stream.getTracks();(0,a.assert)(f.length===1,"CanvasRecorder uses unknown implementation of MediaStream API."),(0,a.assert)(this._stream.requestFrame||f[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():f[0].requestFrame()}download(f){const d=URL.createObjectURL(this.blob),h=document.createElement("a");h.style.display="none",h.setAttribute("href",d),h.setAttribute("download",f),document.body.appendChild(h),h.click(),setTimeout(()=>{document.body.removeChild(h),window.URL.revokeObjectURL(d)},256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(f){this._onImagesAvailable=f}}t.CanvasRecorder=r,function(c){(function(f){f[f.INACTIVE=0]="INACTIVE",f[f.RECORDING=1]="RECORDING",f[f.PAUSED=2]="PAUSED"})(c.State||(c.State={}))}(r||(t.CanvasRecorder=r={}))},7564:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeLookup=void 0;const a=i(9504);class r{static alter(f,d){(0,a.assert)(d.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),d.any=!0;const h=f.split("."),s=h.shift();if((0,a.assert)(s===""||d.hasOwnProperty(s),`expected object to have key '${s}' in order to capture alterations`),s!==""&&typeof d[s]!="object")return void(d[s]=!0);if(s!==""&&h.length>0)return void r.alter(h.join("."),d[s]);const o=s!==""?d[s]:d;for(const u of Object.getOwnPropertyNames(o))u!=="any"&&r.alter(u,o)}static reset(f){for(const d of Object.getOwnPropertyNames(f))typeof f[d]!="object"?f[d]=!1:r.reset(f[d])}alter(f){return r.alter(f,this)}reset(){return r.reset(this)}}t.ChangeLookup=r},3847:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const a=i(3557),r=i(5150),c=i(9504),f=i(2813);class d{static hue2rgb(s,o,u){return(0,c.assert)(u>=-1&&u<=2,"t is expected to be between -1 and 2"),u<0?u+=1:u>1&&(u-=1),6*u<1?s+6*(o-s)*u:2*u<1?o:3*u<2?s+6*(o-s)*(.6666666666666666-u):s}static to2CharHexCode(s){return(s<.060784313725490195?"0":"")+Math.round(255*s).toString(16)}static hsl2rgb(s){const o=(0,f.clampf3)(s,"HSL input");if(o[1]===0)return[o[2],o[2],o[2]];const u=o[2]<.5?o[2]*(1+o[1]):o[2]+o[1]-o[1]*o[2],m=2*o[2]-u;return[d.hue2rgb(m,u,o[0]+.3333333333333333),d.hue2rgb(m,u,o[0]),d.hue2rgb(m,u,o[0]-.3333333333333333)]}static rgb2hsl(s){const o=(0,f.clampf3)(s,"RGB input"),u=[0,0,0],m=Math.min(o[0],o[1],o[2]),v=Math.max(o[0],o[1],o[2]),_=v-m;if(u[2]=.5*(v+m),_===0)return u;u[1]=u[2]<.5?_/(v+m):_/(2-v-m);const g=((v-o[0])/6+_/2)/_,x=((v-o[1])/6+_/2)/_,E=((v-o[2])/6+_/2)/_;return o[0]===v?u[0]=E-x:o[1]===v?u[0]=g-E+.3333333333333333:u[0]=x-g+.6666666666666666,u}static lab2xyz(s){const o=(0,f.clampf3)(s,"LAB input"),u=(100*o[0]+16)/116,m=(256*o[1]-128)/500+u,v=u-(256*o[2]-128)/200,_=Math.pow(m,3),g=Math.pow(u,3),x=Math.pow(v,3);return[.95047*(_>.008856?_:(m-.13793103448275862)/7.787),1*(g>.008856?g:(u-.13793103448275862)/7.787),1.08883*(x>.008856?x:(v-.13793103448275862)/7.787)]}static xyz2lab(s){const o=[s[0]/.95047,s[1]/1,s[2]/1.08883],u=o[0]>.008856?Math.cbrt(o[0]):7.787*o[0]+16/116,m=o[1]>.008856?Math.cbrt(o[1]):7.787*o[1]+16/116,v=o[2]>.008856?Math.cbrt(o[2]):7.787*o[2]+16/116;return(0,f.clampf3)([(116*m-16)/100,(500*(u-m)+128)/256,(200*(m-v)+128)/256])}static xyz2rgb(s){const o=2.04137*s[0]+-.56495*s[1]+-.34469*s[2],u=-.96927*s[0]+1.87601*s[1]+.04156*s[2],m=.01345*s[0]+-.11839*s[1]+1.01541*s[2];return(0,f.clampf3)([o>0?Math.pow(o,.4547069271758437):0,u>0?Math.pow(u,.4547069271758437):0,m>0?Math.pow(m,.4547069271758437):0])}static rgb2xyz(s){const o=(0,f.clampf3)(s,"RGB input"),u=Math.pow(o[0],2.19921875),m=Math.pow(o[1],2.19921875),v=Math.pow(o[2],2.19921875);return[.57667*u+.18555*m+.18819*v,.29738*u+.62735*m+.07527*v,.02703*u+.07069*m+.9911*v]}static lab2rgb(s){return d.xyz2rgb(d.lab2xyz(s))}static rgb2lab(s){return d.xyz2lab(d.rgb2xyz(s))}static cmyk2rgb(s){const o=(0,f.clampf4)(s,"CMYK input"),u=1-o[3];return[(1-o[0])*u,(1-o[1])*u,(1-o[2])*u]}static rgb2cmyk(s){const o=(0,f.clampf3)(s,"RGB input"),u=1-Math.max(o[0],o[1],o[2]),m=1-u,v=m===0?0:1/m;return[(m-o[0])*v,(m-o[1])*v,(m-o[2])*v,u]}static hex2rgba(s){const o=[0,0,0,d.DEFAULT_ALPHA];if(!d.HEX_FORMAT_REGEX.test(s))return(0,c.log)(c.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${s}'`),o;const u=s.startsWith("0x")?2:s.startsWith("#")?1:0,m=Math.floor((s.length-u)/3),v=m-1;return o[0]=parseInt(s[u+0*m]+s[u+0*m+v],16)/255,o[1]=parseInt(s[u+1*m]+s[u+1*m+v],16)/255,o[2]=parseInt(s[u+2*m]+s[u+2*m+v],16)/255,s.length-u!=4&&s.length-u!=8||(o[3]=parseInt(s[u+3*m]+s[u+3*m+v],16)/255),(0,c.assert)(!(isNaN(o[0])||isNaN(o[1])||isNaN(o[2])||isNaN(o[3])),`expected well formated hexadecimal RGBA string, given '${s}'`),o}static rgb2hex(s){const o=(0,f.clampf3)(s,"RGB input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])}static rgba2hex(s){const o=(0,f.clampf4)(s,"RGBA input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])+d.to2CharHexCode(o[3])}static lerp(s,o,u,m=d.Space.LAB){if(u<=0)return new d(s.rgba);if(u>=1)return new d(o.rgba);const v=a.vec4.create();switch(m){case d.Space.CMYK:a.vec4.lerp(v,s.cmyk,o.cmyk,u);const _=(0,r.mix)(s.a,o.a,u);return new d().fromCMYK(v[0],v[1],v[2],v[3],_);case d.Space.LAB:return a.vec4.lerp(v,s.laba,o.laba,u),new d().fromLAB(v[0],v[1],v[2],v[3]);case d.Space.HSL:return a.vec4.lerp(v,s.hsla,o.hsla,u),new d().fromHSL(v[0],v[1],v[2],v[3]);case d.Space.RGB:return a.vec4.lerp(v,s.rgba,o.rgba,u),new d().fromRGB(v[0],v[1],v[2],v[3])}}constructor(s,o){this._rgba=[0,0,0,d.DEFAULT_ALPHA],this._altered=!1,s!==void 0&&(s.length===3&&o!==void 0?this.fromF32(s[0],s[1],s[2],o):s.length===4?(this.fromF32(s[0],s[1],s[2],s[3]),(0,c.assert)(o===void 0,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(s[0],s[1],s[2]))}equals(s){return(0,f.equals4)(this._rgba,s._rgba)}fromF32(s,o,u,m=d.DEFAULT_ALPHA){const v=(0,f.duplicate4)(this._rgba);return this._rgba[0]=(0,f.clampf)(s,"red value"),this._rgba[1]=(0,f.clampf)(o,"green value"),this._rgba[2]=(0,f.clampf)(u,"blue value"),this._rgba[3]=(0,f.clampf)(m,"alpha value"),this._altered=!(0,f.equals4)(this._rgba,v),this}fromUI8(s,o,u,m=Math.floor(255*d.DEFAULT_ALPHA)){const v=(0,f.duplicate4)(this._rgba);return this._rgba[0]=(0,r.clamp)(s,0,255)/255,this._rgba[1]=(0,r.clamp)(o,0,255)/255,this._rgba[2]=(0,r.clamp)(u,0,255)/255,this._rgba[3]=(0,r.clamp)(m,0,255)/255,this._altered=!(0,f.equals4)(this._rgba,v),this}fromRGB(s,o,u,m=d.DEFAULT_ALPHA){const v=(0,f.duplicate4)(this._rgba);return this._rgba=(0,f.clampf4)([s,o,u,m],"RGBA input"),this._altered=!(0,f.equals4)(this._rgba,v),this}fromHSL(s,o,u,m=d.DEFAULT_ALPHA){const v=(0,f.duplicate4)(this._rgba),_=d.hsl2rgb([s,o,u]),g=(0,f.clampf)(m,"ALPHA input");return this._rgba=[_[0],_[1],_[2],g],this._altered=!(0,f.equals4)(this._rgba,v),this}fromLAB(s,o,u,m=d.DEFAULT_ALPHA){const v=(0,f.duplicate4)(this._rgba),_=d.lab2rgb([s,o,u]),g=(0,f.clampf)(m,"ALPHA input");return this._rgba=[_[0],_[1],_[2],g],this._altered=!(0,f.equals4)(this._rgba,v),this}fromCMYK(s,o,u,m,v=d.DEFAULT_ALPHA){const _=(0,f.duplicate4)(this._rgba),g=d.cmyk2rgb([s,o,u,m]),x=(0,f.clampf)(v,"ALPHA input");return this._rgba=[g[0],g[1],g[2],x],this._altered=!(0,f.equals4)(this._rgba,_),this}fromHex(s){const o=(0,f.duplicate4)(this._rgba);return this._rgba=d.hex2rgba(s),this._altered=!(0,f.equals4)(this._rgba,o),this}gray(s=d.GrayscaleAlgorithm.LinearLuminance){switch(s){case d.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case d.GrayscaleAlgorithm.LeastSaturatedVariant:return .5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case d.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.LinearLuminance:return .2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(s,o=!0){switch(s){case d.Space.RGB:return o?this.rgba:this.rgb;case d.Space.LAB:return o?this.laba:this.lab;case d.Space.CMYK:return o?this.cmyka:this.cmyk;case d.Space.HSL:return o?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const s=new Uint8Array(3);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s}get rgbF32(){const s=new Float32Array(3);return s[0]=this._rgba[0],s[1]=this._rgba[1],s[2]=this._rgba[2],s}get rgba(){return this._rgba}get rgbaUI8(){const s=new Uint8Array(4);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s[3]=Math.round(255*this._rgba[3]),s}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return d.rgb2hex(this.rgb)}get hexRGBA(){return d.rgba2hex(this._rgba)}get hsl(){return d.rgb2hsl(this.rgb)}get hsla(){const s=d.rgb2hsl(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get lab(){return d.rgb2lab(this.rgb)}get laba(){const s=d.rgb2lab(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get cmyk(){return d.rgb2cmyk(this.rgb)}get cmyka(){const s=d.rgb2cmyk(this.rgb);return[s[0],s[1],s[2],s[3],this._rgba[3]]}get altered(){return this._altered}set altered(s){this._altered=s}}t.Color=d,d.DEFAULT_ALPHA=1,d.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(h){(function(s){s.Average="average",s.LinearLuminance="linear-luminance",s.LeastSaturatedVariant="least-saturated-variant",s.MinimumDecomposition="minimum-decomposition",s.MaximumDecomposition="maximum-decomposition"})(h.GrayscaleAlgorithm||(h.GrayscaleAlgorithm={})),function(s){s.RGB="rgb",s.HSL="hsl",s.LAB="lab",s.CMYK="cmyk"}(h.Space||(h.Space={}))}(d||(t.Color=d={}))},5837:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScale=void 0;const a=i(5150),r=i(9504),c=i(3847),f=i(64);class d{constructor(){this._hint=d.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(s){switch(s){case d.ArrayType.RGBA:case d.ArrayType.RGBAf:return 4;case d.ArrayType.RGB:case d.ArrayType.RGBf:default:return 3}}static fromPreset(s,o,u){return(0,f.fetchJsonAsync)(s,m=>{let v;for(const O of m)if(O.identifier===o){v=O;break}if(v===void 0)return;const _=v.format,g=d.stride(_),x=v.colors;let E=x.length-1;for(let O=0;O<x.length;++O)if(x[O].length===u*g){E=O;break}const w=x[E],S=v.positions;if(S===void 0)return d.fromArray(w,_,u,void 0);let R;for(let O=0;O<S.length;++O)S[O].length===w.length&&(R=S[O]);return d.fromArray(w,_,u,R)},d.SCHEMA.properties)}static fromArray(s,o,u,m){if(u===0||s.length===0)return new d;const v=s,_=d.stride(o),g=v.length/_,x=new Array(g);for(let O=0;O<v.length;O+=_){const I=new c.Color;switch(o){case d.ArrayType.RGB:I.fromUI8(v[O+0],v[O+1],v[O+2]);break;case d.ArrayType.RGBA:I.fromUI8(v[O+0],v[O+1],v[O+2],v[O+3]);break;case d.ArrayType.RGBf:I.fromF32(v[O+0],v[O+1],v[O+2]);break;case d.ArrayType.RGBAf:I.fromF32(v[O+0],v[O+1],v[O+2],v[O+3])}x[O/_]=I}const E=new d;if(m===void 0&&u===g)return E._colors=x,E;if(u===1&&E._colors.push(x[0]),m===void 0){(m=new Array(g))[0]=0;for(let O=1;O<g;++O)m[O]=O/(g-1)}(0,r.assert)(m.length===x.length,`expected number of positions (${m.length}) to match number of colors (${x.length})`);let w=0,S=w+1;const R=g-1;for(let O=0;O<u;++O){const I=O===0?0:O/(u-1);if(I<=m[w]){E._colors.push(x[w]);continue}if(m[R]<=I){E._colors.push(x[R]);continue}for(let j=w+1;j<g;++j)if(!(m[j]<I)){S=j,w=j-1;break}const D=(I-m[w])/(m[S]-m[w]);E._colors.push(c.Color.lerp(x[w],x[S],D,c.Color.Space.LAB))}return E}lerp(s,o=c.Color.Space.LAB){if(this._colors.length===0)return;if(this._colors.length===1)return this._colors[0];const u=(0,a.clamp)(s,0,1);if(u<=0)return this._colors[0];if(u>=1)return this._colors[this._colors.length-1];const m=s*this._colors.length,v=Math.floor(m),_=v+1;return _>=this._colors.length?this._colors[this._colors.length-1]:((0,r.assert)(_<this._colors.length,`expected upper not exceed maximum color index: ${_} < ${this._colors.length}`),this._hint===d.InterpolationHint.Nearest?this._colors[m-v<=_-m?v:_]:c.Color.lerp(this._colors[v],this._colors[_],m-v,o))}color(s){if(!(s<0||s>=this._colors.length))return this._colors[s]}get colors(){return this._colors}set colors(s){this._colors=s}set hint(s){this._hint=s}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(s=c.Color.Space.RGB,o=!0){const u=this._colors.length,m=o?4:3,v=new Uint8Array(u*m);for(let _=0;_<u;++_){const g=this._colors[_].tuple(s,o);v[_*m+0]=255*g[0],v[_*m+1]=255*g[1],v[_*m+2]=255*g[2],o&&g.length===4&&(v[_*m+3]=255*g[3])}return v}bitsF32(s=c.Color.Space.RGB,o=!0){const u=this._colors.length,m=o?4:3,v=new Float32Array(u*m);for(let _=0;_<u;++_){const g=this._colors[_].tuple(s,o);v[_*m+0]=g[0],v[_*m+1]=g[1],v[_*m+2]=g[2],o&&g.length===4&&(v[_*m+3]=g[3])}return v}}t.ColorScale=d,d.SCHEMA=i(421),function(h){(function(s){s.Linear="linear",s.Nearest="nearest"})(h.InterpolationHint||(h.InterpolationHint={})),function(s){s.sequential="sequential",s.diverging="diverging",s.qualitative="qualitative"}(h.ScaleType||(h.ScaleType={})),function(s){s.RGB="rgb",s.RGBf="rgbf",s.RGBA="rgba",s.RGBAf="rgbaf"}(h.ArrayType||(h.ArrayType={}))}(d||(t.ColorScale=d={}))},2527:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const a=i(9504),r=i(3513),c=i(7501),f=i(5557),d=i(5304),h=i(5060),s=i(829);class o{static createMasqueradeFromGETorDataAttribute(m){return f.ContextMasquerade.fromGET()||(m.msqrdH?f.ContextMasquerade.fromHash(m.msqrdH):m.msqrdP?f.ContextMasquerade.fromPreset(m.msqrdP):void 0)}static request(m,v=o.DEFAULT_ATTRIBUTES){const _=m.dataset,g=o.createMasqueradeFromGETorDataAttribute(_);let x,E=g?g.backend:_.backend?_.backend.toLowerCase():"auto";switch(E in o.BackendRequestType||((0,a.log)(a.LogLevel.Warning,`unknown backend '${_.backend}' changed to '${o.BackendRequestType.auto}'`),E="auto"),E){case o.BackendRequestType.webgl:break;case o.BackendRequestType.experimental:case o.BackendRequestType.webgl1:case o.BackendRequestType.experimental1:E=o.BackendRequestType.webgl;break;case o.BackendRequestType.webgl2:case o.BackendRequestType.experimental2:E=o.BackendRequestType.webgl2;break;default:E=o.BackendRequestType.auto}return E!==o.BackendRequestType.webgl&&(x=this.requestWebGL2(m,v)),x||(x=this.requestWebGL1(m,v),(0,a.logIf)(x!==void 0&&E===o.BackendRequestType.webgl2,a.LogLevel.Info,`backend changed to '${o.BackendRequestType.webgl}', given '${E}'`)),(0,a.assert)(!!x,"creating a context failed"),new o(x,g)}static requestWebGL1(m,v=o.DEFAULT_ATTRIBUTES){let _=m.getContext(o.BackendRequestType.webgl,v);return _||(_=m.getContext(o.BackendRequestType.experimental,v),_===null?void 0:_)}static requestWebGL2(m,v=o.DEFAULT_ATTRIBUTES){let _=m.getContext(o.BackendRequestType.webgl2,v);return _||(_=m.getContext(o.BackendRequestType.experimental2,v),_===null?void 0:_)}queryAttributes(){const m=this._context.getContextAttributes();m!==null?this._attributes=m:(0,a.log)(a.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(m){if(this._mask&&this._mask.extensionsConceal.indexOf(m)>-1)return!1;switch(this._backend){case o.BackendType.WebGL1:(0,a.assert)(d.WEBGL1_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL1`);break;case o.BackendType.WebGL2:(0,a.assert)(d.WEBGL2_DEFAULT_EXTENSIONS.indexOf(m)===-1,`extension ${m} supported by default in WebGL2`),(0,a.assert)(d.WEBGL2_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL2`)}return this._extensions.indexOf(m)>-1}enable(m){for(const v of m)this.isWebGL1&&d.WEBGL1_EXTENSIONS.indexOf(v)===-1||this.isWebGL2&&d.WEBGL2_EXTENSIONS.indexOf(v)===-1||this.supports(v)!==!1&&this.extension(void 0,v)}queryExtensionSupport(){const m=this._context.getSupportedExtensions();if(m!==null){for(const v of m)this._mask&&this._mask.extensionsConceal.indexOf(v)>-1||this._extensions.push(v);this._backend===o.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===o.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else(0,a.log)(a.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(m,v){return m===void 0&&((0,a.assert)(this.supports(v),`extension ${v} expected to be supported`),m=this._context.getExtension(v)),m}constructor(m,v){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new c.AllocationRegister,this._context=m,this._mask=v;const _=m.toString();{const g=/WebGLRenderingContext/.test(_)||/CaptureContext/.test(_),x=/WebGL2RenderingContext/.test(_);this._backend=g?o.BackendType.WebGL1:x?o.BackendType.WebGL2:void 0}if((0,a.assert)(this._backend!==void 0&&this._backend.valueOf()!==o.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${_}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const g in this._mask.functionsUndefine)this._context[g]=void 0;this._gl2=new s.GL2Facade(this)}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case o.BackendType.WebGL1:return"WebGL";case o.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===o.BackendType.WebGL1}get isWebGL2(){return this._backend===o.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case o.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case o.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return this._context.blitFramebuffer!==void 0}get supportsReadBuffer(){return this._context.readBuffer!==void 0}get supportsTexImage3D(){return this._context.texImage3D!==void 0}param(m){return(0,a.assert)(!!this._context,"expected context to be valid"),this._context.getParameter(m)}hash(){return h.ExtensionsHash.encode(this._backend,this._extensions)}about(){const m="ok",v="na";if(this._backend===o.BackendType.Invalid)return new Array;(0,a.assert)(!!this._context,"expected context to be valid");const _=this._context,g=new Array;g.push(["BACKEND (GLOPERATE)",this.backend]),g.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),g.push(["RENDERER",this.param(_.RENDERER)]),g.push(["VENDOR",this.param(_.VENDOR)]),g.push(["VERSION",this.param(_.VERSION)]),g.push(["SHADING_LANGUAGE_VERSION",this.param(_.SHADING_LANGUAGE_VERSION)]),g.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):v]),g.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):v]),g.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),g.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),g.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),g.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),g.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),g.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),g.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),g.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),g.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),g.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),g.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),g.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),g.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),g.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),g.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),g.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(_.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(_.MAX_CUBE_MAP_TEXTURE_SIZE)]),g.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(_.MAX_FRAGMENT_UNIFORM_VECTORS)]),g.push(["MAX_RENDERBUFFER_SIZE",this.param(_.MAX_RENDERBUFFER_SIZE)]),g.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(_.MAX_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_TEXTURE_SIZE",this.param(_.MAX_TEXTURE_SIZE)]),g.push(["MAX_VARYING_VECTORS",this.param(_.MAX_VARYING_VECTORS)]),g.push(["MAX_VERTEX_ATTRIBS",this.param(_.MAX_VERTEX_ATTRIBS)]),g.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(_.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(_.MAX_VERTEX_UNIFORM_VECTORS)]);const x=this.param(_.MAX_VIEWPORT_DIMS);if(g.push(["MAX_VIEWPORT_DIMS (WIDTH)",x?x[0]:null]),g.push(["MAX_VIEWPORT_DIMS (HEIGHT)",x?x[1]:null]),this.isWebGL2){const E=this._context;g.push(["MAX_3D_TEXTURE_SIZE",this.param(E.MAX_3D_TEXTURE_SIZE)]),g.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(E.MAX_ARRAY_TEXTURE_LAYERS)]),g.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(E.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),g.push(["MAX_COLOR_ATTACHMENTS",this.param(E.MAX_COLOR_ATTACHMENTS)]),g.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),g.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(E.MAX_COMBINED_UNIFORM_BLOCKS)]),g.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),g.push(["MAX_DRAW_BUFFERS",this.param(E.MAX_DRAW_BUFFERS)]),g.push(["MAX_ELEMENT_INDEX",this.param(E.MAX_ELEMENT_INDEX)]),g.push(["MAX_ELEMENTS_INDICES",this.param(E.MAX_ELEMENTS_INDICES)]),g.push(["MAX_ELEMENTS_VERTICES",this.param(E.MAX_ELEMENTS_VERTICES)]),g.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(E.MAX_FRAGMENT_INPUT_COMPONENTS)]),g.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(E.MAX_FRAGMENT_UNIFORM_BLOCKS)]),g.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),g.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(E.MAX_PROGRAM_TEXEL_OFFSET)]),g.push(["MAX_SAMPLES",this.param(E.MAX_SAMPLES)]),g.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(E.MAX_SERVER_WAIT_TIMEOUT)]),g.push(["MAX_TEXTURE_LOD_BIAS",this.param(E.MAX_TEXTURE_LOD_BIAS)]),g.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),g.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),g.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),g.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(E.MAX_UNIFORM_BLOCK_SIZE)]),g.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(E.MAX_UNIFORM_BUFFER_BINDINGS)]),g.push(["MAX_VARYING_COMPONENTS",this.param(E.MAX_VARYING_COMPONENTS)]),g.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(E.MAX_VERTEX_OUTPUT_COMPONENTS)]),g.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(E.MAX_VERTEX_UNIFORM_BLOCKS)]),g.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_VERTEX_UNIFORM_COMPONENTS)]),g.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(E.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const E of d.WEBGL1_EXTENSIONS)g.push([E,this.supports(E)?m:v]);else if(this.isWebGL2){for(const E of d.WEBGL2_DEFAULT_EXTENSIONS)g.push([`${E} (default)`,m]);for(const E of d.WEBGL2_EXTENSIONS)g.push([E,this.supports(E)?m:v])}return g}aboutString(){const m=this.about();let v=0;for(const E of m)v=Math.max(E[0].length,v);let _=0,g="";const x=this.isWebGL2?63+d.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const E of m){switch(_){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case x:g+=`
`}g+=`  ${E[0]} ${"-".repeat(v-E[0].length)}-- ${E[1]}
`,++_}return g+=`
`,g}logAbout(m=a.LogLevel.Info){(0,a.log)(m,`context.about

`+this.aboutString())}logAboutIf(m,v=a.LogLevel.Info){(0,a.logIf)(m,v,`context.about

`+this.aboutString())}byteSizeOfFormat(m){return(0,r.byteSizeOfFormat)(this,m)}}t.Context=o,o.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(u){(function(m){m.Invalid="invalid",m.WebGL1="webgl1",m.WebGL2="webgl2"})(u.BackendType||(u.BackendType={})),function(m){m.auto="auto",m.webgl="webgl",m.experimental="experimental-webgl",m.webgl1="webgl1",m.experimental1="experimental-webgl1",m.webgl2="webgl2",m.experimental2="experimental-webgl2"}(u.BackendRequestType||(u.BackendRequestType={}))}(o||(t.Context=o={}))},5557:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMasquerade=void 0;const a=i(9504),r=i(5060);class c{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(d){const h=new c,s=r.ExtensionsHash.decode(d);return h._backend=s[0],h._extensionsStrive=s[1],h._extensionsConceal=r.ExtensionsHash.complement(h._backend,h._extensionsStrive),h}static fromPreset(d){const h=new c,s=new Array;let o;for(const u of c.presets())if(s.push(u.identifier),u.identifier===d){o=u;break}if(o===void 0&&(0,a.assert)(!1,`expected valid identifier, available ['${s.join("', '")}'], given '${d}'`),o.extensions_hash!==void 0){const u=r.ExtensionsHash.decode(o.extensions_hash);h._backend=u[0],h._extensionsStrive=u[1]}else h._backend=o.backend;return(0,a.assert)(h._backend!==void 0,"expected backend to be included in preset"),o.extensions_strive===void 0?(h._extensionsStrive=[],h._extensionsConceal=o.extensions_conceal?o.extensions_conceal:[]):(h._extensionsStrive=o.extensions_strive,h._extensionsConceal=r.ExtensionsHash.complement(h._backend,o.extensions_strive)),h._functionsUndefine=o.functions_undefine?o.functions_undefine:[],h}static fromGET(){const d=(0,a.GETparameter)("msqrd_h");if(d!==void 0)return c.fromHash(d);const h=(0,a.GETparameter)("msqrd_p");return h!==void 0?c.fromPreset(h):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}t.ContextMasquerade=c,c.MASQUERADE_JSON=i(7857)},8234:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;const a=i(7032),r=i(9504),c=i(5150);class f{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new a.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new a.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new a.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new a.Subject,this._postSwapEventSubject=new a.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(h){h&&(0,r.logVerbosity)()<r.LogLevel.Debug&&((0,r.logVerbosity)(r.LogLevel.Debug),(0,r.log)(r.LogLevel.Debug,`changed log verbosity to ${r.LogLevel.Debug} (debug)`)),f._debug=h}set batch(h){(0,r.log)(r.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,h)}request(h=f.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame(()=>this.invoke(h))}invoke(h){if(this._animationFrameID!==0){if((0,r.assert)(this._controllable!==void 0,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),h===f.RequestType.Frame&&this._frameNumber===1)return this._timeoutID===void 0&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return(0,r.logIf)(f._debug,r.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){(0,r.logIf)(f._debug,r.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const h=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=h,this._updateFrameTime=h}invokeFrameAndSwap(){(0,r.logIf)(f._debug,r.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const h=this._debugFrameNumber>0;(0,r.assert)(!h||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const s=performance.now();let o=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(o=Math.min(o,this._debugFrameNumber));this._frameNumber<o;++this._frameNumber)(0,r.logIf)(f._debug,r.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;(0,r.logIf)(f._debug,r.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const u=this._multiTime[1]-s;this._multiFrameTime+=u,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],u),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],u),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout(()=>{this.request(f.RequestType.MultiFrame),this._timeoutID=void 0},this._multiFrameDelay)}cancelWaitMultiFrame(){this._timeoutID!==void 0&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(h=!1){this._invalidated=!0,this._force=this._force||h,this._animationFrameID===0&&this.request()}block(){(0,r.logIf)(f._debug,r.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){(0,r.logIf)(f._debug,r.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){this._animationFrameID!==0&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(h){h!==this._controllable&&(this._controllable=h,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(h){const s=Math.max(1,isNaN(h)?1:h);s!==this._multiFrameNumber&&(this._multiFrameNumber=s,this.multiFrameNumberNext(),(0,r.logIf)(s!==h,r.LogLevel.Debug,`multi-frame number adjusted to ${s}, given ${h}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(h){const s=(0,c.clamp)(isNaN(h)?0:h,0,this.multiFrameNumber);s!==this._debugFrameNumber&&(this._debugFrameNumber=s,this.debugFrameNumberNext(),(0,r.logIf)(s!==h,r.LogLevel.Debug,`debug-frame number adjusted to ${s}, given ${h}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(h){const s=Math.max(0,h);s!==this._multiFrameDelay&&(this._multiFrameDelay=s)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return this._frameNumber===0?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return this._frameNumber===0?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return this._frameNumber===0?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}t.Controller=f,f._debug=!1,function(d){(function(h){h[h.Frame=0]="Frame",h[h.MultiFrame=1]="MultiFrame"})(d.RequestType||(d.RequestType={}))}(f||(t.Controller=f={}))},6710:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CuboidGeometry=void 0;const a=i(3557),r=i(7340),c=i(638);class f extends c.Geometry{constructor(h,s,o=!1,u=[1,1,1]){super(h,s),this._vertexLocation=0,this._extent=a.vec3.fromValues(1,1,1),this._uvCoordinates=!1,s=s!==void 0&&s!==""?s:this.constructor.name;const m=new r.Buffer(h,s+"VBO");this._buffers.push(m);const v=new r.Buffer(h,`${s}IndicesVBO`);this._buffers.push(v),this._extent=a.vec3.clone(u),this._uvCoordinates=o}bindBuffers(){this._uvCoordinates===!1?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(h=0,s=1){this._vertexLocation=h,this._uvCoordLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[h,s]),m=this._uvCoordinates;let v=m?f.VERTICES_UV:f.VERTICES;return v=v.map((_,g)=>_*(m===!1?.5*this._extent[g%3]:g%5<3?.5*this._extent[g%5]:1)),this._buffers[0].data(v,o.STATIC_DRAW),this._buffers[1].data(m?f.INDICES_UV:f.INDICES,o.STATIC_DRAW),this._count=m?f.INDICES_UV.length:f.INDICES.length,u}draw(){const h=this.context.gl;h.drawElements(h.TRIANGLE_STRIP,this._count,h.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}get count(){return this._count}}t.CuboidGeometry=f,f.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),f.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),f.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),f.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},4890:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeosphereGeometry=void 0;const a=i(9504),r=i(7340),c=i(638),f=i(5431);class d extends c.Geometry{constructor(s,o,u=1,m=!0){super(s,o),this._diameter=1,this._textured=!1,this._size=0,o=o!==void 0&&o!==""?o:this.constructor.name,this._diameter=u,this._textured=m;const v=new r.Buffer(s,o+"IndexBuffer");this._buffers.push(v);const _=new r.Buffer(s,o+"VBO");if(this._buffers.push(_),this._textured){const g=new r.Buffer(s,o+"UV");this._buffers.push(g)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(s=0,o=1){const u=this.context.gl;this._vertexLocation=s,this._texCoordLocation=o;const m=super.initialize([u.ELEMENT_ARRAY_BUFFER,u.ARRAY_BUFFER,u.ARRAY_BUFFER],[8,s,o]);(0,a.assert)(this._buffers[0]!==void 0&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),(0,a.assert)(this._buffers[1]!==void 0&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&(0,a.assert)(this._buffers[2]!==void 0&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const v=new f.Icosahedron;v.generateGeometry(3),this._textured&&v.generateTextureCoordinates();const _=v.faces,g=new Uint16Array(3*_.length);let x=0;for(const S of _)g[x+0]=S[0],g[x+1]=S[1],g[x+2]=S[2],x+=3;this._buffers[0].data(g,u.STATIC_DRAW),this._size=3*_.length;const E=v.vertices,w=new Float32Array(3*E.length);x=0;for(const S of E)w[x+0]=S[0]*this._diameter,w[x+1]=S[1]*this._diameter,w[x+2]=S[2]*this._diameter,x+=3;if(this._buffers[1].data(w,u.STATIC_DRAW),this._textured){const S=v.texcoords,R=new Float32Array(2*S.length);if(S&&S.length>0){x=0;for(const O of S)R[x+0]=O[0],R[x+1]=O[1],x+=2}this._buffers[2].data(R,u.STATIC_DRAW)}return m}draw(){const s=this.context.gl;s.drawElements(s.TRIANGLES,this._size,s.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.GeosphereGeometry=d},5431:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Icosahedron=void 0;const a=i(3557),r=i(5150);t.Icosahedron=class{constructor(){}baseVertices(){const c=.5*(1+Math.sqrt(5)),f=1/Math.sqrt(c*c+1),d=c*f;return[a.vec3.fromValues(-f,+d,0),a.vec3.fromValues(+f,+d,0),a.vec3.fromValues(-f,-d,0),a.vec3.fromValues(+f,-d,0),a.vec3.fromValues(0,-f,+d),a.vec3.fromValues(0,+f,+d),a.vec3.fromValues(0,-f,-d),a.vec3.fromValues(0,+f,-d),a.vec3.fromValues(+d,0,-f),a.vec3.fromValues(+d,0,+f),a.vec3.fromValues(-d,0,-f),a.vec3.fromValues(-d,0,+f)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(c,f,d){const h=new Map;for(let s=0;s<d;s++){const o=f.length;for(let u=0;u<o;u++){const m=f[u],v=m[0],_=m[1],g=m[2],x=this.split(v,_,c,h),E=this.split(_,g,c,h),w=this.split(g,v,c,h);f[u]=[x,E,w],f.push([v,x,w]),f.push([_,E,x]),f.push([g,w,E])}}}split(c,f,d,h){const s=c<f,o=((s?c:f)<<16)+(s?f:c);if(h.has(o))return h.get(o);const u=a.vec3.add((0,r.v3)(),d[c],d[f]);a.vec3.normalize(u,u),d.push(u);const m=d.length-1;return h.set(o,m),m}generateGeometry(c){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),c>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(c,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const c of this._vertices){const f=a.vec3.normalize((0,r.v3)(),c),d=a.vec2.fromValues(.5-Math.atan2(f[2],f[0])/(2*Math.PI),Math.asin(f[1])/Math.PI+.5);this._texcoords.push(d)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},1854:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=t.PlaneGeometry=t.GeosphereGeometry=t.Icosahedron=t.CuboidGeometry=void 0;var a=i(6710);Object.defineProperty(t,"CuboidGeometry",{enumerable:!0,get:function(){return a.CuboidGeometry}});var r=i(5431);Object.defineProperty(t,"Icosahedron",{enumerable:!0,get:function(){return r.Icosahedron}});var c=i(4890);Object.defineProperty(t,"GeosphereGeometry",{enumerable:!0,get:function(){return c.GeosphereGeometry}});var f=i(8500);Object.defineProperty(t,"PlaneGeometry",{enumerable:!0,get:function(){return f.PlaneGeometry}});var d=i(6449);Object.defineProperty(t,"ResourceManager",{enumerable:!0,get:function(){return d.ResourceManager}})},8500:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneGeometry=void 0;const a=i(3557),r=i(7340),c=i(638);class f extends c.Geometry{constructor(h,s){super(h,s),this._vertexLocation=0,this._texCoordLocation=1,this._translation=a.vec3.fromValues(0,0,0),this._scale=a.vec3.fromValues(1,1,1),this._rotation=a.quat.create(),s=s!==void 0&&s!==""?s:this.constructor.name;const o=new r.Buffer(h,s+"VertexVBO"),u=new r.Buffer(h,s+"TexCoordVBO"),m=new r.Buffer(h,s+"IndexBuffer");this._buffers.push(o),this._buffers.push(u),this._buffers.push(m)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(h=0,s=1){const o=this.context.gl;this._vertexLocation=h,this._texCoordLocation=s;const u=super.initialize([o.ARRAY_BUFFER,o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[h,s,8]);return this._buffers[0].data(f.VERTICES,o.STATIC_DRAW),this._buffers[1].data(f.UV,o.STATIC_DRAW),this._buffers[2].data(f.INDICES,o.STATIC_DRAW),u}draw(){const h=this.context.gl;h.drawElements(h.TRIANGLE_STRIP,f.INDICES.length,h.UNSIGNED_BYTE,0)}set translation(h){this._translation=h}set scale(h){this._scale=a.vec3.fromValues(h[0],1,h[1])}set rotation(h){this._rotation=h}get transformation(){const h=a.mat4.create();return a.mat4.fromRotationTranslationScale(h,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.PlaneGeometry=f,f.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),f.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),f.INDICES=new Uint8Array([0,1,2,3])},6449:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=void 0;const a=i(9504),r=i(7340),c=i(638),f=i(5315),d=i(8593);t.ResourceManager=class{constructor(h){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=h}fetchTexture2D(h,s,o=!1){if(this._texture2Ds.has(h))return;const u=new d.Texture2D(this._context,h);return(0,a.assert)(u.identifier===h,"expected object identifier to be unchanged"),this._texture2Ds.set(h,u),u.fetch(s,o)}add(h,s){const o=new Array;if(h instanceof d.Texture2D){const u=h;for(const m of s)this._texture2Ds.has(m)||(this._texture2Ds.set(m,u),o.push(m))}if(h instanceof f.Material){const u=h;for(const m of s)this._materials.has(m)||(this._materials.set(m,u),o.push(m))}if(h instanceof c.Geometry){const u=h;for(const m of s)this._geometries.has(m)||(this._geometries.set(m,u),o.push(m))}if(h instanceof r.Buffer){const u=h;for(const m of s)this._buffers.has(m)||(this._buffers.set(m,u),o.push(m))}return o}get(h){return this._texture2Ds.has(h)?this._texture2Ds.get(h):this._materials.has(h)?this._materials.get(h):this._geometries.has(h)?this._geometries.get(h):this._buffers.has(h)?this._buffers.get(h):void 0}uninitialize(){for(const h of Array.from(this._geometries.values()))h.initialized&&h.uninitialize();this._geometries.clear();for(const h of Array.from(this._texture2Ds.values()))h.initialized&&h.uninitialize();this._texture2Ds.clear();for(const h of Array.from(this._buffers.values()))h.initialized&&h.uninitialize();this._buffers.clear(),this._materials.clear()}}},2016:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(s,o,u,m){m===void 0&&(m=u);var v=Object.getOwnPropertyDescriptor(o,u);v&&!("get"in v?!o.__esModule:v.writable||v.configurable)||(v={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(s,m,v)}:function(s,o,u,m){m===void 0&&(m=u),s[m]=o[u]}),r=this&&this.__setModuleDefault||(Object.create?function(s,o){Object.defineProperty(s,"default",{enumerable:!0,value:o})}:function(s,o){s.default=o}),c=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var o={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&a(o,s,u);return r(o,s),o};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const f=c(i(1728)),d=c(i(5657));var h;(function(s){s.TestRenderer=d.TestRenderer,s.TestNavigation=f.TestNavigation})(h||(t.debug=h={}))},1728:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TestNavigation=void 0;const a=i(2);t.TestNavigation=class{constructor(r,c){this._altered=!1,this._eventHandler=new a.EventHandler(r,c),this._eventHandler.pushMouseEnterHandler((f,d)=>this.onMouseEnter(f,d)),this._eventHandler.pushMouseLeaveHandler((f,d)=>this.onMouseLeave(f,d))}onMouseEnter(r,c){this._altered=!1}onMouseLeave(r,c){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},5657:(p,t,i)=>{const a=i(9504),r=i(9017),c=i(2419),f=i(8196),d=i(8386),h=i(8215),s=i(1896),o=i(4168),u=i(8400),m=i(3105),v=i(771),_=i(8593),g=i(1728);var x;(function(E){class w extends m.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(R,O,I){const D=this._context.gl,j=this._context.gl2facade;this._extensions===!1&&this._context.isWebGL1&&((0,a.assert)(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const k=new v.Shader(this._context,D.VERTEX_SHADER,"testrenderer.vert");k.initialize(i(5077));const G=new v.Shader(this._context,D.FRAGMENT_SHADER,"testrenderer.frag");G.initialize(i(6296)),this._program=new o.Program(this._context),this._program.initialize([k,G]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new s.NdcFillingTriangle(this._context);const Z=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(Z),this._ndcOffsetKernel=new c.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new d.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new _.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new u.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new h.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new r.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new f.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=j.COLOR_ATTACHMENT0,this._blit.drawBuffer=D.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new g.TestNavigation(()=>this.invalidate(),I),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const R=this._testNavigation.altered;return this._testNavigation.reset(),!(!R&&!this._altered.any)&&R}onPrepare(){const R=this._context.gl,O=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?R.RGBA8:R.RGBA,R.RGBA,R.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],R.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[O.COLOR_ATTACHMENT0,this._colorRenderTexture],[R.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(R){const O=this._context.gl;O.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const I=this._ndcOffsetKernel.get(R);I[0]=2*I[0]/this._frameSize[0],I[1]=2*I[1]/this._frameSize[1],O.uniform2fv(this._uNdcOffset,I),O.uniform1i(this._uFrameNumber,R),this._intermediateFBO.clear(O.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(R)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}E.TestRenderer=w})(x||(x={})),p.exports=x},3334:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPass=void 0;const a=i(9504),r=i(4168),c=i(771),f=i(8196);class d extends f.BlitPass{constructor(){super(...arguments),this._debug=d.Mode.Depth,this._near=0,this._far=0}createProgram(){(0,a.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const s=this._context.gl,o=new c.Shader(this._context,s.VERTEX_SHADER,"blit.vert (debug)");o.initialize(i(3354));const u=new c.Shader(this._context,s.FRAGMENT_SHADER,"blit_debug.frag (debug)");return u.initialize(i(8359)),this._program=new r.Program(this._context,"DebugProgram"),this._program.initialize([o,u]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),s.uniform1i(this._program.uniform("u_source"),0),s.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(s){const o=super.initialize(s);return this.enforceProgramBlit=!0,o&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(s){this.assertInitialized(),this._debug!==s&&(this._debug=s,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(s){this._near=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(s){this._far=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}t.DebugPass=d,function(h){(function(s){s[s.None=0]="None",s[s.Depth=1]="Depth",s[s.DepthLinear=2]="DepthLinear",s[s.DepthPacked=3]="DepthPacked",s[s.DepthLinearPacked=4]="DepthLinearPacked"})(h.Mode||(h.Mode={}))}(d||(t.DebugPass=d={}))},8386:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFramebuffer=void 0;const r=i(9504),c=i(8215),f=i(4127);class d extends c.Framebuffer{create(){return this._object=c.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(s){return!1}bind(s=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(s,this._object)}clearColor(s){super.clearColor(s)}resize(){(0,r.assert)(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}t.DefaultFramebuffer=d,a([f.Initializable.assert_initialized()],d.prototype,"bind",null)},6464:function(p,t,i){var a=this&&this.__decorate||function(v,_,g,x){var E,w=arguments.length,S=w<3?_:x===null?x=Object.getOwnPropertyDescriptor(_,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(v,_,g,x);else for(var R=v.length-1;R>=0;R--)(E=v[R])&&(S=(w<3?E(S):w>3?E(_,g,S):E(_,g))||S);return w>3&&S&&Object.defineProperty(_,g,S),S};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentTextureType=t.EnvironmentRenderingPass=void 0;const r=i(9504),c=i(4127),f=i(1896),d=i(4168),h=i(771),s=i(8593),o=i(5186);class u extends c.Initializable{constructor(_){super(),this._skipCubeLod=!1,this._altered=!0,this._context=_,this._cubeMapProgram=new d.Program(_,"CubemapEnvironmentProgram"),this._equiMapProgram=new d.Program(_,"EquimapEnvironmentProgram"),this._polarMapProgram=new d.Program(_,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new d.Program(_,"SpheremapEnvironmentProgram"),this._ndcTriangle=new f.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const _=this._context.gl;this._ndcTriangle.initialize();const g=new h.Shader(this._context,_.VERTEX_SHADER,"env-projections.vert");g.initialize(i(3761));const x=new h.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");x.initialize(i(9196),!1),x.replace("PROJECTION_TYPE","CUBE_MAP"),x.compile(),this._cubeMapProgram.initialize([g,x],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),_.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const E=new h.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");E.initialize(i(9196),!1),E.replace("PROJECTION_TYPE","EQUI_MAP"),E.compile(),this._equiMapProgram.initialize([g,E],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),_.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const w=new h.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");w.initialize(i(9196),!1),w.replace("PROJECTION_TYPE","SPHERE_MAP"),w.compile(),this._sphereMapProgram.initialize([g,w],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),_.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const S=new h.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");return S.initialize(i(9196),!1),S.replace("PROJECTION_TYPE","POLAR_MAP"),S.compile(),this._polarMapProgram.initialize([g,S],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),_.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(this._altered===!1)return;const _=this._context.gl;this._cubeMapProgram.bind(),_.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const _=this._context.gl;(0,r.assert)(this._camera!==void 0,"Camera is undefined in environment rendering pass."),(0,r.assert)(this._environmentTexture!==void 0,"Environment texture is undefined in environment rendering pass.");let g=this._cubeMapProgram;this._envTextureType===m.EquirectangularMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._equiMapProgram):this._envTextureType===m.SphereMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._sphereMapProgram):this._envTextureType===m.CubeMap?((0,r.assert)(this._environmentTexture instanceof o.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._cubeMapProgram):this._envTextureType===m.PolarMap&&((0,r.assert)(this._environmentTexture2!==void 0,"Two input textures expected for polar mapping."),(0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),(0,r.assert)(this._environmentTexture2 instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(_.TEXTURE0),this._environmentTexture2.bind(_.TEXTURE1),g=this._polarMapProgram),g.bind(),_.uniformMatrix4fv(g.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),g.unbind()}set environmentTextureType(_){this._envTextureType=_}set environmentTexture(_){this._environmentTexture=_}set environmentTexture2(_){this._environmentTexture2=_}set camera(_){this._camera=_}set skipCubeLod(_){this._skipCubeLod!==_&&(this._skipCubeLod=_,this._altered=!0)}}var m;t.EnvironmentRenderingPass=u,a([c.Initializable.initialize()],u.prototype,"initialize",null),a([c.Initializable.uninitialize()],u.prototype,"uninitialize",null),function(v){v[v.CubeMap=0]="CubeMap",v[v.EquirectangularMap=1]="EquirectangularMap",v[v.SphereMap=2]="SphereMap",v[v.PolarMap=3]="PolarMap"}(m||(t.EnvironmentTextureType=m={}))},2:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventHandler=void 0;const a=i(3557),r=i(9504),c=i(3975),f=i(4602),d=i(8216),h=i(8870),s=i(5678);t.EventHandler=class{constructor(o,u){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._latestKeyboardEventsByType=new Map,this._previousKeyboardEventsByType=new Map,this._keyboardEventHandlerByType=new Map,this._invalidate=o,this._mouseEventProvider=u.mouseEventProvider,this._mouseEventProvider.preventDefault(f.MouseEventProvider.Type.Wheel),this._pointerEventProvider=u.pointerEventProvider,this._eyeGazeEventProvider=u.eyeGazeEventProvider,this._keyboardEventProvider=u.keyboardEventProvider}invalidate(o=!1){this._invalidate&&this._invalidate(o)}pushMouseEventHandler(o,u){if(this._mouseEventHandlerByType.has(o))return void this._mouseEventHandlerByType.get(o).push(u);this._mouseEventHandlerByType.set(o,new Array),this._previousMouseEventsByType.set(o,new Array);const m=new Array;this._latestMouseEventsByType.set(o,m),(0,r.assert)(this._mouseEventProvider!==void 0,"expected valid mouse event provider");const v=this._mouseEventProvider.observable(o);f.MouseEventProvider.Type.Wheel,this._subscriptions.push(v.subscribe(_=>{m.push(_),this.invalidate()})),this._mouseEventHandlerByType.get(o).push(u)}invokeMouseEventHandler(o){const u=this._mouseEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const m=this._latestMouseEventsByType.get(o);if(m.length===0)return;const v=this._previousMouseEventsByType.get(o);u.forEach(_=>_(m,v)),Object.assign(v,m),m.length=0}pushTouchEventHandler(o,u){if(this._touchEventHandlerByType.has(o))return void this._touchEventHandlerByType.get(o).push(u);this._touchEventHandlerByType.set(o,new Array),this._previousTouchEventsByType.set(o,new Array);const m=new Array;this._latestTouchEventsByType.set(o,m),(0,r.assert)(this._touchEventProvider!==void 0,"expected valid touch event provider");const v=this._touchEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{m.push(_),this.invalidate()})),this._touchEventHandlerByType.get(o).push(u)}invokeTouchEventHandler(o){const u=this._touchEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const m=this._latestTouchEventsByType.get(o);if(m.length===0)return;const v=this._previousTouchEventsByType.get(o);u.forEach(_=>_(m,v)),Object.assign(v,m),m.length=0}pushPointerEventHandler(o,u){if(this._pointerEventHandlerByType.has(o))return void this._pointerEventHandlerByType.get(o).push(u);this._pointerEventHandlerByType.set(o,new Array),this._previousPointerEventsByType.set(o,new Array);const m=new Array;this._latestPointerEventsByType.set(o,m),(0,r.assert)(this._pointerEventProvider!==void 0,"expected valid pointer event provider");const v=this._pointerEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{m.push(_),this.invalidate()})),this._pointerEventHandlerByType.get(o).push(u)}invokePointerEventHandler(o){const u=this._pointerEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const m=this._latestPointerEventsByType.get(o);if(m.length===0)return;const v=this._previousPointerEventsByType.get(o);u.forEach(_=>_(m,v)),Object.assign(v,m),m.length=0}pushEyeGazeEventHandler(o,u){if(this._eyeGazeEventHandlerByType.has(o))return void this._eyeGazeEventHandlerByType.get(o).push(u);this._eyeGazeEventHandlerByType.set(o,new Array),this._previousEyeGazeEventsByType.set(o,new Array);const m=new Array;this._latestEyeGazeEventsByType.set(o,m),(0,r.assert)(this._eyeGazeEventProvider!==void 0,"expected valid eye gaze event provider");const v=this._eyeGazeEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{m.push(_),this.invalidate()})),this._eyeGazeEventHandlerByType.get(o).push(u)}invokeEyeGazeEventHandler(o){const u=this._eyeGazeEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const m=this._latestEyeGazeEventsByType.get(o);if(m.length===0)return;const v=this._previousEyeGazeEventsByType.get(o);u.forEach(_=>_(m,v)),Object.assign(v,m),m.length=0}pushKeyboardEventHandler(o,u){if(this._keyboardEventHandlerByType.has(o))return void this._keyboardEventHandlerByType.get(o).push(u);this._keyboardEventHandlerByType.set(o,new Array),this._previousKeyboardEventsByType.set(o,new Array);const m=new Array;this._latestKeyboardEventsByType.set(o,m),(0,r.assert)(this._keyboardEventProvider!==void 0,"expected valid keyboard event provider");const v=this._keyboardEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{m.push(_),this.invalidate()})),this._keyboardEventHandlerByType.get(o).push(u)}invokeKeyboardEventHandler(o){const u=this._keyboardEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const m=this._latestKeyboardEventsByType.get(o);if(m.length===0)return;const v=this._previousKeyboardEventsByType.get(o);u.forEach(_=>_(m,v)),Object.assign(v,m),m.length=0}dispose(){this._latestMouseEventsByType.forEach(o=>o.length=0),this._previousMouseEventsByType.forEach(o=>o.length=0),this._latestTouchEventsByType.forEach(o=>o.length=0),this._previousTouchEventsByType.forEach(o=>o.length=0),this._latestPointerEventsByType.forEach(o=>o.length=0),this._previousPointerEventsByType.forEach(o=>o.length=0),this._previousEyeGazeEventsByType.forEach(o=>o.length=0),this._latestEyeGazeEventsByType.forEach(o=>o.length=0),this._latestKeyboardEventsByType.forEach(o=>o.length=0),this._previousKeyboardEventsByType.forEach(o=>o.length=0);for(const o of this._subscriptions)o.unsubscribe()}update(){this.invokeMouseEventHandler(f.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(h.TouchEventProvider.Type.End),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(d.PointerEventProvider.Type.Move),this.invokePointerEventHandler(d.PointerEventProvider.Type.Down),this.invokePointerEventHandler(d.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(d.PointerEventProvider.Type.Up),this.invokePointerEventHandler(d.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(d.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.BinaryMessageParsingError),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyDown),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyPress),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyUp)}offsets(o,u=!0){const m=new Array;let v=!1;if(o instanceof MouseEvent){const g=o;v=g.offsetX!==0&&g.offsetY!==0,m.push(v?a.vec2.fromValues(g.offsetX,g.offsetY):a.vec2.fromValues(g.clientX,g.clientY))}else if(o instanceof WheelEvent){const g=o;v=g.offsetX!==0&&g.offsetY!==0,m.push(v?a.vec2.fromValues(g.offsetX,g.offsetY):a.vec2.fromValues(g.clientX,g.clientY))}else if(o instanceof TouchEvent){const g=o;for(let x=0;x<g.touches.length;++x){const E=g.touches.item(x);m.push(a.vec2.fromValues(E.clientX,E.clientY))}}if(v){if(u)for(const g of m)a.vec2.scale(g,g,window.devicePixelRatio);return m}const _=(o.target||o.currentTarget||o.srcElement).getBoundingClientRect();for(const g of m)g[0]=Math.floor(g[0]-_.left),g[1]=Math.floor(g[1]-_.top),u&&a.vec2.scale(g,g,window.devicePixelRatio);return m}pushClickHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Click,o)}pushMouseEnterHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Enter,o)}pushMouseLeaveHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Leave,o)}pushMouseDownHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Down,o)}pushMouseUpHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Up,o)}pushMouseMoveHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Move,o)}pushMouseWheelHandler(o){this.pushMouseEventHandler(f.MouseEventProvider.Type.Wheel,o)}pushTouchStartHandler(o){this.pushTouchEventHandler(h.TouchEventProvider.Type.Start,o)}pushTouchEndHandler(o){this.pushTouchEventHandler(h.TouchEventProvider.Type.End,o)}pushTouchMoveHandler(o){this.pushTouchEventHandler(h.TouchEventProvider.Type.Move,o)}pushTouchCancelHandler(o){this.pushTouchEventHandler(h.TouchEventProvider.Type.Cancel,o)}pushPointerUpHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Up,o)}pushPointerDownHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Down,o)}pushPointerEnterHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Enter,o)}pushPointerLeaveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Leave,o)}pushPointerMoveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Move,o)}pushPointerCancelHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Cancel,o)}pushEyeGazeDataHandler(o){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.EyeGazeData,o)}pushEyeGazeServerMessageHandler(o){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.NewServerMessage,o)}pushEyeGazeConnectionStatusHandler(o){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.ConnectionStatus,o)}pushEyeGazeBinaryMessageParsingErrorHandler(o){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.BinaryMessageParsingError,o)}pushKeyDownHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyDown,o)}pushKeyPressHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyPress,o)}pushKeyUpHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyUp,o)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},5304:p=>{var t;(function(i){i.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],i.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],i.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]})(t||(t={})),p.exports=t},5060:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsHash=void 0;const a=i(9504),r=i(5304);class c{static encode64(d){return(0,a.assert)(d>=0&&d<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${d}`),c.BASE64_ALPHABET[d]}static decode64(d){(0,a.assert)(d.length===1,`expected single base64 character, given '${d}'`);const h=c.BASE64_ALPHABET.indexOf(d);return(0,a.assert)(h>-1,`unknown base64 character, given '${d}'`),h}static encode(d,h){const s=c.LATEST_VERSION,o=c.EXTENSIONS_BY_VERSION.get(s),u=c.WEBGL_BACKENDS.indexOf(d);(0,a.assert)(u>-1,`expected valid backend ${c.WEBGL_BACKENDS}, given ${d} `);let m=c.encode64(s<<3|u+1);if(h.length===0)return m;let v=0;for(let _=0;_<o.length;++_)v|=h.indexOf(o[_])>-1?32>>_%6:0,_%6<5&&_<o.length-1||(m+=c.encode64(v),v=0);return m}static decode(d){const h=c.decode64(d[0]),s=h>>3,o=(7&h)-1;(0,a.assert)(o<c.WEBGL_BACKENDS.length,`expected valid backend index, given ${o}`);const u=c.WEBGL_BACKENDS[o];(0,a.assert)(c.EXTENSIONS_BY_VERSION.has(s),`expected valid hash version, given ${s}`);const m=c.EXTENSIONS_BY_VERSION.get(s),v=Math.ceil(m.length/6)+1;(0,a.assert)(d.length===v,`expected hash of version ${s} to have a length of ${v}, given ${d}`);const _=new Array;for(let g=1;g<d.length;++g){const x=c.decode64(d[g]),E=6*(g-1);32&x&&_.push(m[E+0]),16&x&&_.push(m[E+1]),8&x&&_.push(m[E+2]),4&x&&_.push(m[E+3]),2&x&&_.push(m[E+4]),1&x&&_.push(m[E+5])}return[u,_]}static complement(d,h){const s=c.WEBGL_BACKENDS.indexOf(d);return(0,a.assert)(s>-1,`expected valid backend ${c.WEBGL_BACKENDS}, given ${d} `),c.WEBGL_EXTENSIONS_BY_BACKEND.get(s).filter(o=>h.indexOf(o)<0)}}t.ExtensionsHash=c,c.WEBGL_BACKENDS=["webgl1","webgl2"],c.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,r.WEBGL1_EXTENSIONS],[1,r.WEBGL2_EXTENSIONS]]),c.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),c.LATEST_VERSION=0,c.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},3404:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeDataStreams=t.EyeGazeDataStream=t.EyeGazeEventTarget=void 0;const a=i(6662);class r extends EventTarget{}t.EyeGazeEventTarget=r;class c{constructor(){this._eyeGazeDataStreams=new f,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const h=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(h[0]=1|h[0]),this._eyeGazeDataStreams.gazeOrigin&&(h[0]=2|h[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(h[0]=4|h[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(h[0]=8|h[0]),this._eyeGazeDataStreams.userPresence&&(h[0]=16|h[0]),h}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const h=this.generateStreamConfigByte();this._webSocket.send(h)}parseEyeTrackingData(h){if(h.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(c.BINARY_MESSAGE_PARSING_ERROR);let s=0;const o=new a.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(o.gazePositionXY[0]=h[s++],o.gazePositionXY[1]=h[s++]),this._eyeGazeDataStreams.gazeOrigin&&(o.gazeOriginRightXYZ[0]=h[s++],o.gazeOriginRightXYZ[1]=h[s++],o.gazeOriginRightXYZ[2]=h[s++],o.gazeOriginLeftXYZ[0]=h[s++],o.gazeOriginLeftXYZ[1]=h[s++],o.gazeOriginLeftXYZ[2]=h[s++]),this._eyeGazeDataStreams.eyePositionNormalized&&(o.eyePositionRightNormalizedXYZ[0]=h[s++],o.eyePositionRightNormalizedXYZ[1]=h[s++],o.eyePositionRightNormalizedXYZ[2]=h[s++],o.eyePositionLeftNormalizedXYZ[0]=h[s++],o.eyePositionLeftNormalizedXYZ[1]=h[s++],o.eyePositionLeftNormalizedXYZ[2]=h[s++]),this._eyeGazeDataStreams.headPositionAndRotation&&(o.headPositionXYZ[0]=h[s++],o.headPositionXYZ[1]=h[s++],o.headPositionXYZ[2]=h[s++],o.headRotationXYZ[0]=h[s++],o.headRotationXYZ[1]=h[s++],o.headRotationXYZ[2]=h[s++]),this._eyeGazeDataStreams.userPresence&&(o.userPresence=h[s]!==0),new CustomEvent(c.EYE_GAZE_DATA,{detail:{eyeGazeData:o}})}onOpen(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.SUCCESSFULLY_CONNECTED_TO_SERVER,event:h}})),this.performHandshake()}onClose(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.DISCONNECTED_TO_SERVER,event:h}}))}onError(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.CONNECTION_ERROR,event:h}}))}async onMessage(h){if(typeof h.data!="string"){const s=await h.data.arrayBuffer(),o=new Float32Array(s);this.dispatchEvent(this.parseEyeTrackingData(o))}else this.dispatchEvent(new CustomEvent(c.NEW_SERVER_MESSAGE,{detail:{message:h.data}}))}connect(h){this._webSocket=new WebSocket(h),this._webSocket.onopen=s=>{this.onOpen(s)},this._webSocket.onclose=s=>{this.onClose(s)},this._webSocket.onerror=s=>{this.onError(s)},this._webSocket.onmessage=s=>{this.onMessage(s)}}addEventListener(h,s,o){this._eyeGazeEventTarget.addEventListener(h,s||null,o)}dispatchEvent(h){return this._eyeGazeEventTarget.dispatchEvent(h)}removeEventListener(h,s,o){this._eyeGazeEventTarget.removeEventListener(h,s||null,o)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(h){this._eyeGazeDataStreams!==h&&(this._eyeGazeDataStreams=h)}}t.EyeGazeDataStream=c,c.EYE_GAZE_DATA="eyegazedata",c.NEW_SERVER_MESSAGE="newservermessage",c.CONNECTION_STATUS="connectionstatus",c.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",c.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",c.DISCONNECTED_TO_SERVER="disconnected to server",c.CONNECTION_ERROR="connection error with server";class f{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let h=0;this.gazePosition&&(h+=2),this.gazeOrigin&&(h+=6),this.eyePositionNormalized&&(h+=6),this.headPositionAndRotation&&(h+=6),this.userPresence&&(h+=1),this.expectedNumberOfFloats=h}}t.EyeGazeDataStreams=f},6662:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeData=void 0,t.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let i="";return i+=`Gaze Position: ${this.gazePositionXY}
`,i+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}
`,i+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}
`,i+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}
`,i+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}
`,i+=`Head Position: ${this.headPositionXYZ}
`,i+=`Head Rotation: ${this.headRotationXYZ}
`,i+=`User Presence: ${this.userPresence}
`,i}}},3975:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeEventProvider=void 0;const a=i(7032),r=i(9504),c=i(3404);class f{constructor(h,s){(0,r.assert)(h!==void 0,`expected a valid eye gaze data streams object on initialization, given ${h}.`),this._eyeGazeDataStream=new c.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=h,this._eyeGazeDataStream.connect(s)}preventDefaultOnEvent(h,s){(0,r.bitInBitfield)(this._preventDefaultMask,h)&&s.preventDefault()}allowDefault(...h){for(const s of h)(0,r.bitInBitfield)(this._preventDefaultMask,s)&&(this._preventDefaultMask&=~s)}preventDefault(...h){for(const s of h)(0,r.bitInBitfield)(this._preventDefaultMask,s)||(this._preventDefaultMask|=s)}observable(h){switch(h){case f.Type.EyeGazeData:return this.EyeGazeData$;case f.Type.NewServerMessage:return this.NewServerMessage$;case f.Type.ConnectionStatus:return this.ConnectionStatus$;case f.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return this._eyeGazeDataSubject===void 0&&(this._eyeGazeDataSubject=new a.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=h=>{this.preventDefaultOnEvent(f.Type.EyeGazeData,h),this._eyeGazeDataSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return this._newServerMessageSubject===void 0&&(this._newServerMessageSubject=new a.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=h=>{this.preventDefaultOnEvent(f.Type.NewServerMessage,h),this._newServerMessageSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return this._connectionStatusSubject===void 0&&(this._connectionStatusSubject=new a.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=h=>{this.preventDefaultOnEvent(f.Type.ConnectionStatus,h),this._connectionStatusSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return this._binaryMessageParsingErrorSubject===void 0&&(this._binaryMessageParsingErrorSubject=new a.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=h=>{this.preventDefaultOnEvent(f.Type.BinaryMessageParsingError,h),this._binaryMessageParsingErrorSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}t.EyeGazeEventProvider=f,function(d){(function(h){h[h.EyeGazeData=1]="EyeGazeData",h[h.NewServerMessage=2]="NewServerMessage",h[h.ConnectionStatus=4]="ConnectionStatus",h[h.BinaryMessageParsingError=8]="BinaryMessageParsingError"})(d.Type||(d.Type={}))}(f||(t.EyeGazeEventProvider=f={}))},64:(p,t,i)=>{const a=i(1407);var r;(function(c){const f=(d,h)=>`fetching '${d}' failed (${h.status}): ${h.statusText}`;c.fetchAsync=function(d,h){return new Promise((s,o)=>{const u=new XMLHttpRequest;u.open("GET",d,!0),u.responseType=h,u.onload=()=>{u.status<200||u.status>=300?o(f(d,u)):s(u.response)},u.onerror=()=>o(f(d,u)),u.ontimeout=()=>o(f(d,u)),u.send()})},c.fetchJsonAsync=function(d,h,s){return new Promise((o,u)=>{const m=new XMLHttpRequest;m.open("GET",d,!0),m.onload=()=>{if(m.status<200||m.status>=300)return void u(f(d,m));const v=m.responseText;if(s!==void 0&&!(0,a.validate)(v,s))return;let _;try{_=JSON.parse(v)}catch(x){return void u(`fetching '${d}' failed (${x.name}): ${x.message}`)}const g=h(_);g!==void 0?o(g):u(`fetching '${d}' failed (TransformError): transforming the object failed.`)},m.onerror=()=>u(f(d,m)),m.ontimeout=()=>u(f(d,m)),m.send()})}})(r||(r={})),p.exports=r},4850:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPersonModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=a.mat4.create(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h}process(h,s){this._currentPoint=h;const o=a.vec2.create();s===void 0?a.vec2.subtract(o,this._initialPoint,this._currentPoint):a.vec2.copy(o,s),a.vec2.scale(o,o,window.devicePixelRatio*this._sensitivity),a.vec2.copy(this._initialPoint,this._currentPoint);const u=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(u,u);const m=a.vec3.cross((0,r.v3)(),u,this._reference.up),v=a.mat4.fromRotation((0,r.m4)(),-o[0],this._reference.up),_=a.mat4.fromRotation((0,r.m4)(),o[1],m);a.mat4.mul(this._rotation,_,v),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._reference.eye);a.mat4.multiply(h,h,this._rotation),a.mat4.translate(h,h,a.vec3.negate((0,r.v3)(),this._reference.eye));const s=a.vec3.transformMat4((0,r.v3)(),this._reference.center,h);this._camera.center=s,Object.assign(this._reference,this._camera)}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.FirstPersonModifier=f,f.DEFAULT_SENSITIVITY=8e-4},3513:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.byteSizeOfFormat=function(f,d){const h=f.gl;if(d===void 0)return(0,a.assert)(!1,"expected given format to be defined"),0;if(function(o,u){const m=o.gl,v=o.gl2facade;if(u===void 0)return!1;if(r===void 0){const _=o.supportsDepthTexture?o.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;r=new Array(m.UNSIGNED_BYTE,m.UNSIGNED_SHORT_5_6_5,m.UNSIGNED_SHORT_4_4_4_4,m.UNSIGNED_SHORT_5_5_5_1,m.UNSIGNED_SHORT,m.UNSIGNED_INT,_,m.FLOAT,v.HALF_FLOAT,m.BYTE,m.SHORT,m.INT,m.HALF_FLOAT,m.UNSIGNED_INT_2_10_10_10_REV,m.UNSIGNED_INT_10F_11F_11F_REV,m.UNSIGNED_INT_5_9_9_9_REV,m.UNSIGNED_INT_24_8,m.FLOAT_32_UNSIGNED_INT_24_8_REV)}return r.indexOf(u)>-1}(f,d))return(0,a.assert)(!1,`expected format instead of type ${d}`),0;if(d===h.DEPTH_COMPONENT||d===h.DEPTH_STENCIL)return(0,a.assert)(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const s=function(o){if(c.has(o))return c.get(o);const u=o.gl,m=new Map([[u.ALPHA,1],[u.LUMINANCE,1],[u.R8,1],[u.R8I,1],[u.R8UI,1],[u.STENCIL_INDEX8,1],[u.DEPTH_COMPONENT16,2],[u.LUMINANCE_ALPHA,2],[u.R16F,2],[u.R16I,2],[u.R16UI,2],[u.RG8,2],[u.RG8I,2],[u.RG8UI,2],[u.RGB565,2],[u.RGB5_A1,2],[u.RGBA4,2],[u.DEPTH_COMPONENT24,3],[u.RGB,3],[u.RGB8,3],[u.RGB8UI,3],[u.SRGB,3],[u.SRGB8,3],[u.DEPTH24_STENCIL8,4],[u.DEPTH_COMPONENT32F,4],[u.R11F_G11F_B10F,4],[u.R32F,4],[u.R32I,4],[u.R32UI,4],[u.RG16F,4],[u.RG16I,4],[u.RG16UI,4],[u.RGB10_A2,4],[u.RGB10_A2UI,4],[u.RGB9_E5,4],[u.RGBA,4],[u.RGBA8,4],[u.RGBA8I,4],[u.RGBA8UI,4],[u.SRGB8_ALPHA8,4],[u.SRGB_ALPHA,4],[u.SRGB_ALPHA8,4],[u.SRGB_APLHA8,4],[u.DEPTH32F_STENCIL8,5],[u.RGB16F,6],[u.RG32F,8],[u.RG32I,8],[u.RG32UI,8],[u.RGBA16F,8],[u.RGBA16I,8],[u.RGBA16UI,8],[u.RGB32F,12],[u.RGBA32F,16],[u.RGBA32I,16],[u.RGBA32UI,16]]);return o.isWebGL1&&o.supportsSRGB&&(m.set(o.sRGB.SRGB_EXT,3),m.set(o.sRGB.SRGB_ALPHA_EXT,4),m.set(o.sRGB.SRGB8_ALPHA8_EXT,4)),o.supportsColorBufferFloat&&(m.set(o.colorBufferFloat.RGB32F_EXT,12),m.set(o.colorBufferFloat.RGBA32F_EXT,16)),c.set(o,m),m}(f).get(d);return(0,a.assert)(s!==void 0,`size of format ${d} is unknown`),s||0};const a=i(9504);let r;const c=new Map},8215:function(p,t,i){var a=this&&this.__decorate||function(o,u,m,v){var _,g=arguments.length,x=g<3?u:v===null?v=Object.getOwnPropertyDescriptor(u,m):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,u,m,v);else for(var E=o.length-1;E>=0;E--)(_=o[E])&&(x=(g<3?_(x):g>3?_(u,m,x):_(u,m))||x);return g>3&&x&&Object.defineProperty(u,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.Framebuffer=void 0;const r=i(9504),c=i(4127),f=i(9965),d=i(8400),h=i(8593);class s extends f.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(u,m){const v=u.gl;switch(m){case v.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case v.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case v.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return(0,r.assert)(!1,`expected known framebuffer status, given ${m}`),""}}create(u){const m=this._context.gl,v=this.context.gl2facade;this._object=m.createFramebuffer(),this._clearColors=new Array(v.COLOR_ATTACHMENT_MAX-v.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const g of u){const x=g[0],E=g[1];if(E instanceof d.Renderbuffer?this._buffersByAttachment.set(x,E):E instanceof h.Texture2D&&this._texturesByAttachment.set(x,E),x<v.COLOR_ATTACHMENT_MIN||x>v.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(x);const w=x-m.COLOR_ATTACHMENT0;this._colorClearQueue.push(w),this._clearColors[w]=[0,0,0,0]}this._drawBuffersChanged=!0,m.bindFramebuffer(m.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach((g,x)=>{m.framebufferRenderbuffer(m.FRAMEBUFFER,x,m.RENDERBUFFER,g.object)}),this._texturesByAttachment.forEach((g,x)=>{m.framebufferTexture2D(m.FRAMEBUFFER,x,m.TEXTURE_2D,g.object,0)});const _=m.checkFramebufferStatus(m.FRAMEBUFFER);return this._valid=m.isFramebuffer(this._object)&&_===m.FRAMEBUFFER_COMPLETE,(0,r.logIf)(!this._valid,r.LogLevel.Warning,s.statusString(this.context,_)),v.drawBuffers&&v.drawBuffers(this._drawBuffers),m.bindFramebuffer(m.FRAMEBUFFER,s.DEFAULT_FRAMEBUFFER),this._object}delete(){(0,r.assert)(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(u,m=!0,v=!0){const _=this.context.gl,g=(0,r.bitInBitfield)(u,_.DEPTH_BUFFER_BIT),x=(0,r.bitInBitfield)(u,_.STENCIL_BUFFER_BIT),E=(0,r.bitInBitfield)(u,_.COLOR_BUFFER_BIT);if(E||g||x){if(m&&this.bind(),E&&this._clearColors[0]!==void 0){const w=this._clearColors[0];_.clearColor(w[0],w[1],w[2],w[3])}g&&this._clearDepth!==void 0&&_.clearDepth(this._clearDepth),x&&this._clearStencil!==void 0&&_.clearStencil(this._clearStencil),_.clear(u),v&&this.unbind()}}es3Clear(u,m=!0,v=!0,_){const g=this.context.gl,x=(0,r.bitInBitfield)(u,g.DEPTH_BUFFER_BIT),E=(0,r.bitInBitfield)(u,g.STENCIL_BUFFER_BIT),w=(0,r.bitInBitfield)(u,g.COLOR_BUFFER_BIT);if(w||x||E){if(m&&this.bind(),w){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const S=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];g.clearColor(S[0],S[1],S[2],S[3]),g.clear(g.COLOR_BUFFER_BIT)}for(const S of _||this._colorClearQueue)g.clearBufferfv(g.COLOR,S,this._clearColors[S])}x&&E?(g.clearStencil(this._clearStencil),g.clearDepth(this._clearDepth),g.clear(g.STENCIL_BUFFER_BIT|g.DEPTH_BUFFER_BIT)):x?g.clearBufferfv(g.DEPTH,0,[this._clearDepth]):E&&(g.clearStencil(this._clearStencil),g.clear(g.STENCIL_BUFFER_BIT)),v&&this.unbind()}}hasAttachment(u){return this._texturesByAttachment.has(u)||this._buffersByAttachment.has(u)}bind(u=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(u,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(u=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(u,s.DEFAULT_FRAMEBUFFER)}clearColor(u,m){(0,r.assert)(m===void 0||m===0||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const v=u[3]<1&&!this.context.alpha;(0,r.logIf)(v,r.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const _=[u[0],u[1],u[2],v?1:u[3]];if(this.context.premultipliedAlpha&&!v&&(_[0]*=_[3],_[1]*=_[3],_[2]*=_[3]),m!==void 0)this._clearColors[m]=_;else for(let g=0;g<this._clearColors.length;++g)this._clearColors[g]=_}clearDepth(u){this._clearDepth=u}clearStencil(u){this._clearStencil=u}texture(u){return this._texturesByAttachment.get(u)}resize(u,m,v=!0,_=!0){this._buffersByAttachment.forEach(g=>{g.resize(u,m,v,_)}),this._texturesByAttachment.forEach(g=>{g.resize(u,m,v,_)})}get width(){this.assertInitialized();let u=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(u)||m.width<u)&&(u=m.width)}),this._texturesByAttachment.forEach(m=>{(isNaN(u)||m.width<u)&&(u=m.width)}),u}get height(){this.assertInitialized();let u=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(u)||m.height<u)&&(u=m.height)}),this._texturesByAttachment.forEach(m=>{(isNaN(u)||m.height<u)&&(u=m.height)}),u}get size(){return[this.width,this.height]}set drawBuffers(u){this.assertInitialized();const m=this.context.gl2facade;for(const v of u)(0,r.assert)(this.hasAttachment(v),`valid attachment expected for draw buffer, given ${v}`),(0,r.assert)(v>=m.COLOR_ATTACHMENT_MIN&&v<=m.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${v}`),this._drawBuffersChanged=this._drawBuffersChanged||this._drawBuffers.indexOf(v)===-1;this._drawBuffersChanged=this._drawBuffersChanged||u.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=u)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}t.Framebuffer=s,s.DEFAULT_FRAMEBUFFER=void 0,a([c.Initializable.assert_initialized()],s.prototype,"es2Clear",null),a([c.Initializable.assert_initialized()],s.prototype,"es3Clear",null),a([c.Initializable.assert_initialized()],s.prototype,"bind",null),a([c.Initializable.assert_initialized()],s.prototype,"unbind",null),a([c.Initializable.assert_initialized()],s.prototype,"clearColor",null),a([c.Initializable.assert_initialized()],s.prototype,"clearDepth",null),a([c.Initializable.assert_initialized()],s.prototype,"clearStencil",null),a([c.Initializable.assert_initialized()],s.prototype,"texture",null),a([c.Initializable.assert_initialized()],s.prototype,"resize",null)},1215:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FrameCapture=void 0;const a=i(9504),r=i(8215),c=i(8386);class f{static createDataURL(h,s,o){const u=document.createElement("canvas"),m=u.getContext("2d");return u.width=h.width,u.height=h.height,m.putImageData(h,0,0),u.toDataURL(s,o)}static captureDefaultFramebuffer(h,s,o){const u=h.context.gl;h.bind(),u.readPixels(s.x,s.y,s.width,s.height,u.RGBA,u.UNSIGNED_BYTE,o),h.unbind()}static captureFramebuffer(h,s,o,u){const m=h.context.gl,v=h.texture(s);if((0,a.assert)(v!==void 0,`Framebuffer does not have given attachment ${s}.`),(0,a.assert)(v.format===m.RGBA,`Unsupported texture format ${v.format}.`),(0,a.assert)(v.type===m.UNSIGNED_BYTE||v.type===m.FLOAT||v.type===m.HALF_FLOAT,`Unsupported texture type ${v.type}.`),m.readBuffer(s),v.type===m.FLOAT||v.type===m.HALF_FLOAT){const _=new Float32Array(o.width*o.height*4);m.readPixels(o.x,o.y,o.width,o.height,m.RGBA,m.FLOAT,_),_.forEach((g,x)=>{u[x]=255*g})}else v.type===m.UNSIGNED_BYTE&&m.readPixels(o.x,o.y,o.width,o.height,m.RGBA,m.UNSIGNED_BYTE,u)}static flipImageDataVertically(h){const s=h.height,o=h.data.length/s,u=Math.floor(s/2);for(let m=0;m<u;++m){const v=h.data.slice(m*o,(m+1)*o);h.data.copyWithin(m*o,(s-m-1)*o,(s-m)*o),h.data.set(v,(s-m-1)*o)}}static capture(h,s,o){const u=h.context.gl,m=h.size;o===void 0&&(o={x:0,y:0,width:m[0],height:m[1]}),s===void 0&&(s=u.COLOR_ATTACHMENT0);const v=new ImageData(o.width,o.height),_=new Uint8Array(v.data.buffer);return h.bind(u.READ_FRAMEBUFFER),h instanceof c.DefaultFramebuffer?f.captureDefaultFramebuffer(h,o,_):h instanceof r.Framebuffer&&f.captureFramebuffer(h,s,o,_),h.unbind(u.READ_FRAMEBUFFER),f.flipImageDataVertically(v),v}}t.FrameCapture=f},3395:function(p,t,i){var a=this&&this.__decorate||function(m,v,_,g){var x,E=arguments.length,w=E<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,v,_,g);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(v,_,w):x(v,_))||w);return E>3&&w&&Object.defineProperty(v,_,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.GaussFilter=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(4127),h=i(1896),s=i(4168),o=i(771);class u extends d.Initializable{constructor(v){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=v}recalculateWeights(){if(this._weights)return!1;const v=1/Math.sqrt(2*Math.PI)*this._standardDeviation,_=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let g=0;for(let x=0;x<=Math.floor(this._kernelSize/2);x++)this._weights[x]=v*Math.pow(Math.E,-Math.pow(x,2)/_),g+=x>0?2*this._weights[x]:this._weights[x];if(this._redistribute){const x=1-g;for(let E=0;E<=Math.floor(this._kernelSize/2);E++)this._weights[E]+=this._weights[E]/g*x}return!0}get kernelSize(){return this._kernelSize}set kernelSize(v){(0,c.assert)(v>0,"Kernel size has to be positive."),(0,c.assert)(v<=2*(u._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(u._MAXKERNELSIZEHALF-1)+2)+"."),(0,c.assert)(Number.isInteger(v),"Kernel size has to be an integer."),(0,c.assert)(v%2==1,"Kernel size has to be odd."),this._kernelSize=v,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(v){(0,c.assert)(v>0,"Standard deviation has to be positive."),this._standardDeviation=v,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(v){this._redistribute=v,this._weights=void 0}initialize(v){const _=this._context.gl,g=new o.Shader(this._context,_.VERTEX_SHADER,"gauss.vert");g.initialize(i(9214)),this._fragmentShader=new o.Shader(this._context,_.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(i(1687)),this._program=new s.Program(this._context),this._program.initialize([g,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const x=this._program.attribute("a_vertex",0);return v===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(x),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(v,_){const g=this._context.gl,x=[r.vec2.fromValues(1,0),r.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),g.uniform1fv(this._uWeights,this._weights)),this._program.bind(),v.bind(g.TEXTURE0),g.uniform2fv(this._uDelta,r.vec2.divide((0,f.v2)(),x[_],v.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),v.unbind(g.TEXTURE0),this._program.unbind()}}t.GaussFilter=u,u._MAXKERNELSIZEHALF=32,a([d.Initializable.initialize()],u.prototype,"initialize",null),a([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],u.prototype,"filter",null),function(m){(function(v){v[v.Horizontal=0]="Horizontal",v[v.Vertical=1]="Vertical"})(m.Direction||(m.Direction={}))}(u||(t.GaussFilter=u={}))},638:function(p,t,i){var a=this&&this.__decorate||function(d,h,s,o){var u,m=arguments.length,v=m<3?h:o===null?o=Object.getOwnPropertyDescriptor(h,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,h,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(m<3?u(v):m>3?u(h,s,v):u(h,s))||v);return m>3&&v&&Object.defineProperty(h,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.Geometry=void 0;const r=i(4127),c=i(5507);class f extends r.Initializable{constructor(h,s){super(),this._buffers=new Array,s=s!==void 0&&s!==""?s:this.constructor.name,this._vertexArray=new c.VertexArray(h,`${s}VAO`)}initialize(...h){const s=h[0],o=h[1];let u=!0;for(let m=0;m<this._buffers.length;++m)u=this._buffers[m].initialize(s[m])&&u;return this._vertexArray.initialize(()=>this.bindBuffers(o),()=>this.unbindBuffers(o)),this._vertexArray.valid&&u}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach(h=>h.uninitialize())}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}t.Geometry=f,a([r.Initializable.initialize()],f.prototype,"initialize",null),a([r.Initializable.uninitialize()],f.prototype,"uninitialize",null),a([r.Initializable.assert_initialized()],f.prototype,"bind",null),a([r.Initializable.assert_initialized()],f.prototype,"unbind",null)},5150:(p,t,i)=>{const a=i(3557);var r;(function(c){function f(h){return h>0?h-Math.floor(h):h-Math.ceil(h)}c.sign=function(h){return h>0?1:h<0?-1:0},c.clamp=function(h,s,o){return Math.max(s,Math.min(o,h))},c.fract=f,c.v2=function(){return a.vec2.create()},c.clamp2=function(h,s,o,u){return h[0]=Math.max(o[0],Math.min(u[0],s[0])),h[1]=Math.max(o[1],Math.min(u[1],s[1])),h},c.abs2=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h},c.v3=function(){return a.vec3.create()},c.clamp3=function(h,s,o,u){return h[0]=Math.max(o[0],Math.min(u[0],s[0])),h[1]=Math.max(o[1],Math.min(u[1],s[1])),h[2]=Math.max(o[2],Math.min(u[2],s[2])),h},c.abs3=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h[2]=Math.abs(s[2]),h};const d=1/256;c.encode_float24x1_to_uint8x3=function(h,s){return h[0]=Math.floor(256*s),h[1]=Math.floor(256*f(256*s)),h[2]=Math.floor(256*f(65536*s)),h},c.decode_float24x1_from_uint8x3=function(h){return(h[0]+(h[1]+h[2]*d)*d)*d},c.encode_uint24_to_rgb8=function(h,s){return h[0]=s>>>0&255,h[1]=s>>>8&255,h[2]=s>>>16&255,h},c.encode_uint32_to_rgba8=function(h,s){return h[0]=s>>>0&255,h[1]=s>>>8&255,h[2]=s>>>16&255,h[3]=s>>>24&255,h},c.decode_uint24_from_rgb8=function(h){return h[0]+(h[1]<<8)+(h[2]<<16)},c.decode_uint32_from_rgba8=function(h){return h[0]+(h[1]<<8)+(h[2]<<16)+(h[3]<<24)>>>0},c.fromVec4=function(h){return h[3]===0?a.vec3.fromValues(h[0],h[1],h[2]):a.vec3.fromValues(h[0]/h[3],h[1]/h[3],h[2]/h[3])},c.v4=function(){return a.vec4.create()},c.clamp4=function(h,s,o,u){return h[0]=Math.max(o[0],Math.min(u[0],s[0])),h[1]=Math.max(o[1],Math.min(u[1],s[1])),h[2]=Math.max(o[2],Math.min(u[2],s[2])),h[3]=Math.max(o[3],Math.min(u[3],s[3])),h},c.abs4=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h[2]=Math.abs(s[2]),h[3]=Math.abs(s[3]),h},c.fromVec3=function(h){return a.vec4.fromValues(h[0],h[1],h[2],1)},c.parseVec2=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==2||isNaN(s[0])||isNaN(s[1])?void 0:a.vec2.clone(s)},c.parseVec3=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==3||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?void 0:a.vec3.clone(s)},c.parseVec4=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==4||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?void 0:a.vec4.clone(s)},c.mix=function(h,s,o){return h*(1-o)+s*o},c.m2=function(){return a.mat2.create()},c.m3=function(){return a.mat3.create()},c.m4=function(){return a.mat4.create()}})(r||(r={})),p.exports=r},829:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GL2Facade=void 0;const a=i(9504),r=i(2527);t.GL2Facade=class{constructor(c){this.drawBuffers=void 0,(0,a.assert)(c!==void 0,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(c),this.queryColorAttachments(c),this.queryInstancedArraySupport(c),this.queryDrawBuffersSupport(c),this.queryVertexArrayObjectSupport(c),this.queryMaxUniformVec3Components(c),this.queryBufferSubDataInterface(c),this.queryTexImageInterface(c)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(c){switch(c.backend){case r.Context.BackendType.WebGL1:this._halfFloat=c.supportsTextureHalfFloat&&c.textureHalfFloat?c.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case r.Context.BackendType.WebGL2:default:this._halfFloat=c.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(c){const f=c.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=f.COLOR_ATTACHMENT0,c.backend){case r.Context.BackendType.WebGL1:const d=c.supportsDrawBuffers?c.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(d?f.getParameter(d.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=d?d.COLOR_ATTACHMENT0_WEBGL:f.COLOR_ATTACHMENT0,!d)break;for(let h=1;h<16;++h)this._colorAttachments[h]=d.COLOR_ATTACHMENT0_WEBGL+h;break;case r.Context.BackendType.WebGL2:default:this._colorAttachmentMin=c.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=c.gl.COLOR_ATTACHMENT0+f.getParameter(f.MAX_COLOR_ATTACHMENTS);for(let h=0;h<16;++h)this._colorAttachments[h]=f.COLOR_ATTACHMENT0+h}}queryInstancedArraySupport(c){(c.isWebGL2||c.supportsInstancedArrays)&&(this.drawArraysInstanced=c.isWebGL2?(f,d,h,s)=>c.gl.drawArraysInstanced(f,d,h,s):(f,d,h,s)=>c.instancedArrays.drawArraysInstancedANGLE(f,d,h,s),this.drawElementsInstanced=c.isWebGL2?(f,d,h,s,o)=>c.gl.drawElementsInstanced(f,d,h,s,o):(f,d,h,s,o)=>c.instancedArrays.drawElementsInstancedANGLE(f,d,h,s,o),this.vertexAttribDivisor=c.isWebGL2?(f,d)=>c.gl.vertexAttribDivisor(f,d):(f,d)=>c.instancedArrays.vertexAttribDivisorANGLE(f,d))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(c){(c.isWebGL2||c.supportsDrawBuffers)&&(this.drawBuffers=c.isWebGL2?f=>c.gl.drawBuffers(f):f=>c.drawBuffers.drawBuffersWEBGL(f),this._maxDrawBuffers=c.isWebGL2?c.gl.MAX_DRAW_BUFFERS:c.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(c){(c.isWebGL2||c.supportsVertexArrayObject)&&(this.createVertexArray=c.isWebGL2?()=>c.gl.createVertexArray():()=>c.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=c.isWebGL2?f=>c.gl.deleteVertexArray(f):f=>c.vertexArrayObject.deleteVertexArrayOES(f),this.isVertexArray=c.isWebGL2?f=>c.gl.isVertexArray(f):f=>c.vertexArrayObject.isVertexArrayOES(f),this.bindVertexArray=c.isWebGL2?f=>c.gl.bindVertexArray(f):f=>c.vertexArrayObject.bindVertexArrayOES(f))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(c){const f=c.gl;this._maxUniformVec3Components=c.isWebGL2?f.getParameter(f.MAX_VERTEX_UNIFORM_COMPONENTS):3*f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(c){const f=c.gl;c.isWebGL2?this.bufferSubData=(d,h,s,o,u=0)=>f.bufferSubData(d,h,s,o,u):this.bufferSubData=(d,h,s,o=0,u=0)=>((0,a.logIf)(o!==0,a.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),(0,a.logIf)(u!==0,a.LogLevel.Warning,"length ignored (not supported in WebGL)"),f.bufferSubData(d,h,s))}queryTexImageInterface(c){const f=c.gl;c.isWebGL2?this.texImage2D=(d,h,s,o,u,m,v,_,g,x)=>g instanceof ArrayBuffer?f.texImage2D(d,h,s,o,u,m,v,_,g===void 0?null:g,x):((0,a.assert)(x===void 0,"offset expected to be undefined for non ArrayBuffer source"),f.texImage2D(d,h,s,o,u,m,v,_,g===void 0?null:g)):this.texImage2D=(d,h,s,o,u,m,v,_,g,x)=>g===void 0?f.texImage2D(d,h,s,o,u,m,v,_,null):g instanceof Int8Array||g instanceof Uint8Array||g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array||g instanceof DataView?f.texImage2D(d,h,s,o,u,m,v,_,g):f.texImage2D(d,h,s,v,_,g),c.supportsTexImage3D?this.texImage3D=(d,h,s,o,u,m,v,_,g,x,E)=>x instanceof ArrayBuffer?f.texImage3D(d,h,s,o,u,m,v,_,g,x===void 0?null:x,E):((0,a.assert)(E===void 0,"offset expected to be undefined for non ArrayBuffer source"),f.texImage3D(d,h,s,o,u,m,v,_,g,x===void 0?null:x)):this.texImage3D=(d,h,s,o,u,m,v,_,g,x,E)=>(0,a.assert)(!1,"texImage3D not supported on this context")}}},6119:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFHelper=void 0;const a=i(9504);t.GLTFHelper=class{static modeToEnum(r,c){return(c<0||c>6)&&(0,a.log)(a.LogLevel.Error,`Specified draw mode is ${c} but is required to be between 0 and 6`),c===0?r.POINTS:c===1?r.LINES:c===2?r.LINE_LOOP:c===3?r.LINE_STRIP:c===4?r.TRIANGLES:c===5?r.TRIANGLE_STRIP:c===6?r.TRIANGLE_FAN:r.TRIANGLES}static nameToAttributeIndex(r){return r==="POSITION"?0:r==="NORMAL"?1:r==="TANGENT"?2:r==="TEXCOORD_0"?3:r==="TEXCOORD_1"?4:r==="TEXCOORD_2"?5:r==="JOINTS_0"?6:r==="WEIGHTS_0"?7:r==="COLOR_0"?8:((0,a.log)(a.LogLevel.Warning,`Unknown attribute name '${r}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},2604:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFLoader=void 0;const a=i(3557),r=i(9504),c=i(4613),f=i(6119),d=i(122),h=i(9806),s=i(2078),o=i(7340),u=i(1854),m=i(4168),v=i(5315),_=i(651),g=i(771),x=i(8593);t.GLTFLoader=class{constructor(E){this._context=E;const w=this._context.gl;this._resourceManager=new u.ResourceManager(this._context),this._scenes=new Array;const S=new g.Shader(this._context,w.VERTEX_SHADER,"gltf_default.vert");S.initialize(i(6626));const R=new g.Shader(this._context,w.FRAGMENT_SHADER,"gltf_default.frag");R.initialize(i(5347)),this._pbrProgram=new m.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([S,R])}async loadTextures(E){const w=this._context.gl;this._uriTextureMap=new Map;const S=E.gltf.textures,R=E.gltf.images,O=E.gltf.samplers;if(!S||!R)return;let I=0;for(const D of S){if(D.source===void 0){(0,r.log)(r.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),I++;continue}const j=D.source,k=R[j],G=this._sceneName+"_texture_"+I,Z=k.name===void 0?k.uri:k.name;let K=await E.imageData.get(j);if(!(0,r.isPowerOfTwo)(K.width)||!(0,r.isPowerOfTwo)(K.height)){const Q=document.createElement("canvas");Q.width=(0,r.upperPowerOfTwo)(K.width),Q.height=(0,r.upperPowerOfTwo)(K.height);const ae=Q.getContext("2d");ae===void 0&&(0,r.log)(r.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),ae.drawImage(K,0,0,Q.width,Q.height),K=Q}const Y=new x.Texture2D(this._context,Z);if(Y.initialize(K.width,K.height,w.RGBA8,w.RGBA,w.UNSIGNED_BYTE),Y.data(K),O===void 0||D.sampler===void 0)Y.wrap(w.REPEAT,w.REPEAT),Y.filter(w.LINEAR,w.LINEAR);else{const Q=O[D.sampler];Y.wrap(Q.wrapS||w.REPEAT,Q.wrapT||w.REPEAT),Y.filter(Q.magFilter||w.LINEAR,Q.minFilter||w.LINEAR),Q.minFilter!==w.NEAREST_MIPMAP_NEAREST&&Q.minFilter!==w.LINEAR_MIPMAP_NEAREST&&Q.minFilter!==w.NEAREST_MIPMAP_LINEAR&&Q.minFilter!==w.LINEAR_MIPMAP_LINEAR||Y.generateMipMap()}this._resourceManager.add(Y,[Z,G]);const re=k.uri?k.uri:G;this._uriTextureMap.set(re,Y),I++}}getTexture(E){const w=this._sceneName+"_texture_"+E,S=this._resourceManager.get(w);if(S!==void 0)return S;(0,r.log)(r.LogLevel.Warning,`Texture with index ${E} could not be located.`)}async loadMaterials(E){this._pbrDefaultMaterial=new h.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const w=E.gltf.materials;if(!w)return;let S=0;for(const R of w){const O=this._sceneName+"_material_"+S,I=new h.GLTFPbrMaterial(this._context,R.name),D=R.normalTexture;D!==void 0&&(I.normalTexture=this.getTexture(D.index),I.normalTexCoord=D.texCoord||0,I.normalScale=D.scale||1);const j=R.occlusionTexture;j!==void 0&&(I.occlusionTexture=this.getTexture(j.index),I.occlusionTexCoord=j.texCoord||0);const k=R.emissiveTexture;k!==void 0&&(I.emissiveTexture=this.getTexture(k.index),I.emissiveTexCoord=k.texCoord||0),I.emissiveFactor=a.vec3.fromValues(0,0,0),R.emissiveFactor!==void 0&&(I.emissiveFactor=a.vec3.fromValues.apply(void 0,R.emissiveFactor)),I.alphaMode=h.GLTFAlphaMode.OPAQUE,R.alphaMode==="MASK"?(I.alphaMode=h.GLTFAlphaMode.MASK,R.alphaCutoff===void 0?I.alphaCutoff=.5:I.alphaCutoff=R.alphaCutoff):R.alphaMode==="BLEND"&&(I.alphaMode=h.GLTFAlphaMode.BLEND,I.isTransparent=!0),I.isDoubleSided=R.doubleSided||!1;const G=R.pbrMetallicRoughness;G===void 0&&(0,r.log)(r.LogLevel.Warning,"Model contains a material without PBR information");const Z=G.baseColorTexture;Z!==void 0&&(I.baseColorTexture=this.getTexture(Z.index),I.baseColorTexCoord=Z.texCoord||0);const K=G.metallicRoughnessTexture;K!==void 0&&(I.metallicRoughnessTexture=this.getTexture(K.index),I.metallicRoughnessTexCoord=K.texCoord||0),I.baseColorFactor=a.vec4.fromValues(1,1,1,1),G.baseColorFactor!==void 0&&(I.baseColorFactor=a.vec4.fromValues.apply(void 0,G.baseColorFactor)),I.metallicFactor=1,G.metallicFactor!==void 0&&(I.metallicFactor=G.metallicFactor),I.roughnessFactor=1,G.roughnessFactor!==void 0&&(I.roughnessFactor=G.roughnessFactor),this._resourceManager.add(I,[R.name,O]),S++}}inferBufferUsage(E,w){const S=this._context.gl,R=E.gltf.meshes,O=E.gltf.accessors;if(R===void 0||O===void 0)return(0,r.log)(r.LogLevel.Error,"Asset does not include any meshes or accessors"),S.ARRAY_BUFFER;for(const I of R)for(const D of I.primitives){const j=D.indices;if(j===void 0)continue;const k=O[j].bufferView;if(k!==void 0&&k===w)return S.ELEMENT_ARRAY_BUFFER}return S.ARRAY_BUFFER}async loadBuffers(E){const w=this._context.gl,S=E.gltf.bufferViews,R=E.gltf.accessors;if(!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any buffer view information.");if(!R)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any accessor information.");let O=0;for(const D of S){const j=this._sceneName+"_bufferView_"+O,k=await E.bufferViewData(O);let G=D.target;G===void 0&&(G=this.inferBufferUsage(E,O));const Z=new o.Buffer(this._context,j);Z.initialize(G),Z.data(k,w.STATIC_DRAW),this._resourceManager.add(Z,[j]),O++}let I=0;for(const D of R){const j=D.bufferView,k=D.sparse;if(j===void 0||k!==void 0){const G=this._sceneName+"_accessor_"+I,Z=new o.Buffer(this._context,G),K=await E.accessorData(I);Z.initialize(w.ARRAY_BUFFER),Z.data(K,w.STATIC_DRAW),this._resourceManager.add(Z,[G])}I++}}async loadMeshes(E){this._meshes=new Array,this._nameMeshMap=new Map;const w=E.gltf.meshes;if(w===void 0)return(0,r.log)(r.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let S=0;for(const R of w){const O=new d.GLTFMesh(R.name);for(const I of R.primitives){const D=await this.loadPrimitive(E,I,S);D!==void 0&&O.addPrimitive(D),S++}R.name&&this._nameMeshMap.set(R.name,O),this._meshes.push(O)}return this._meshes}async loadPrimitive(E,w,S){const R=this._context.gl,O=E.gltf.accessors,I=E.gltf.bufferViews;if(O===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any accessors.");if(I===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any buffer views.");let D=w.mode;const j=this._sceneName+"_primitive_"+S;D||(D=4);const k=f.GLTFHelper.modeToEnum(R,D),G=new Array;let Z=this._pbrDefaultMaterial;if(w.material!==void 0){const Q=this._sceneName+"_material_"+w.material,ae=this._resourceManager.get(Q);ae!==void 0?Z=ae:(0,r.log)(r.LogLevel.Warning,`Material ${Q} could not be found.`)}let K,Y=0;for(const Q in w.attributes){const ae=f.GLTFHelper.nameToAttributeIndex(Q);Q==="NORMAL"&&(Y|=h.GLTFShaderFlags.HAS_NORMALS),Q==="TANGENT"&&(Y|=h.GLTFShaderFlags.HAS_TANGENTS),Q==="COLOR_0"&&(Y|=h.GLTFShaderFlags.HAS_COLORS),Q!=="TEXCOORD_0"&&Q!=="TEXCOORD_1"&&Q!=="TEXCOORD_2"||(Y|=h.GLTFShaderFlags.HAS_UV);const se=w.attributes[Q],ee=O[se],le=ee.bufferView,ge=ee.sparse;let ve,ne=0;if(le===void 0||ge!==void 0){const Te=this._sceneName+"_accessor_"+se;ve=this._resourceManager.get(Te)}else{const Te=I[le],oe=this._sceneName+"_bufferView_"+le;ve=this._resourceManager.get(oe),ne=Te.byteStride||0}const be=new s.VertexBinding;be.buffer=ve,be.attributeIndex=ae,be.numVertices=ee.count,be.normalized=ee.normalized||!1,be.size=c.GLTF_ELEMENTS_PER_TYPE[ee.type],be.offset=ee.byteOffset||0,be.stride=ne,be.type=ee.componentType,G.push(be)}if(w.indices!==void 0){const Q=O[w.indices],ae=Q.bufferView;!ae===void 0&&(0,r.log)(r.LogLevel.Error,"Accessor does not reference a BufferView.");const se=this._sceneName+"_bufferView_"+ae,ee=this._resourceManager.get(se);K=new s.IndexBinding,K.buffer=ee,K.numIndices=Q.count,K.offset=Q.byteOffset||0,K.type=Q.componentType}const re=new s.GLTFPrimitive(this._context,G,K,k,Z,Y);return re.initialize(),this._resourceManager.add(re,[j]),re}async generateScenes(E){const w=E.gltf.nodes,S=E.gltf.scenes;if(!w||!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const R=new Map;let O=0;for(const j of w){const k=j.name||"node_"+O,G=new _.SceneNode(k);if(R.set(O,G),j.matrix){const Z=a.mat4.fromValues.apply(void 0,j.matrix),K=new v.TransformComponent(Z);G.addComponent(K)}else if(j.translation||j.rotation||j.scale){let Z=a.quat.create();j.rotation&&(Z=a.quat.fromValues.apply(void 0,j.rotation));let K=a.vec3.create();j.translation&&(K=a.vec3.fromValues.apply(void 0,j.translation));let Y=a.vec3.fromValues(1,1,1);j.scale&&(Y=a.vec3.fromValues.apply(void 0,j.scale));const re=a.mat4.fromRotationTranslationScale(a.mat4.create(),Z,K,Y),Q=new v.TransformComponent(re);G.addComponent(Q)}if(j.mesh!==void 0){const Z=this._meshes[j.mesh];for(const K of Z.primitives){const Y=new v.GeometryComponent;Y.material=K.material,Y.geometry=K,G.addComponent(Y)}}(j.skin||j.weights)&&(0,r.log)(r.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),O++}O=0;for(const j of w){const k=R.get(O);if((0,r.assert)(k!==void 0,"Scene node could not be found."),j.children)for(const G of j.children){const Z=R.get(G);Z||(0,r.log)(r.LogLevel.Error,"Model references a node that does not exist."),k.addNode(Z)}O++}let I=0;for(const j of S){const k=j.name||"scene_"+I,G=new _.SceneNode(k);if(j.nodes)for(const Z of j.nodes){const K=R.get(Z);K||(0,r.log)(r.LogLevel.Error,"Scene references a node that does not exist."),G.addNode(K)}else(0,r.log)(r.LogLevel.Warning,`Scene ${k} does not contain any nodes.`);this._scenes.push(G),I++}const D=E.gltf.scene;D!==void 0&&(this._defaultScene=this._scenes[D])}async loadAsset(E){const w=new c.GltfLoader,S=await w.load(E),R=S.gltf;this._sceneName="scene",R.scenes&&R.scene&&R.scenes[R.scene].name&&(this._sceneName=R.scenes[R.scene].name),await this.loadTextures(S).then(()=>this.loadMaterials(S)).then(()=>this.loadBuffers(S)).then(()=>this.loadMeshes(S)).then(()=>this.generateScenes(S))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(E){return this._nameMeshMap.get(E)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return this._defaultScene!==void 0?this._defaultScene:this._scenes!==void 0&&this._scenes.length>0?this._scenes[0]:((0,r.log)(r.LogLevel.Warning,"Default scene was requested, but none is available."),new _.SceneNode("EmptyScene"))}}},122:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=void 0,t.GLTFMesh=class{constructor(i){this._name=i,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(i){this._primitives.push(i)}}},9806:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFShaderFlags=void 0;const a=i(3557),r=i(5315);var c,f;(function(h){h[h.HAS_NORMALS=1]="HAS_NORMALS",h[h.HAS_TANGENTS=2]="HAS_TANGENTS",h[h.HAS_UV=4]="HAS_UV",h[h.HAS_COLORS=8]="HAS_COLORS",h[h.USE_IBL=16]="USE_IBL",h[h.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",h[h.HAS_NORMALMAP=64]="HAS_NORMALMAP",h[h.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",h[h.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",h[h.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",h[h.USE_TEX_LOD=1024]="USE_TEX_LOD"})(c||(t.GLTFShaderFlags=c={})),function(h){h[h.OPAQUE=0]="OPAQUE",h[h.MASK=1]="MASK",h[h.BLEND=2]="BLEND"}(f||(t.GLTFAlphaMode=f={}));class d extends r.Material{constructor(s,o){super(s,o),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=f.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=a.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=a.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(s){this._baseColorTexture=s}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(s){this._metallicRoughnessTexture=s}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(s){this._normalTexture=s}get normalTexture(){return this._normalTexture}set occlusionTexture(s){this._occlusionTexture=s}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(s){this._emissiveTexture=s}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(s){this._emissiveFactor=s}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(s){this._baseColorFactor=s}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(s){this._metallicFactor=s}get metallicFactor(){return this._metallicFactor}set roughnessFactor(s){this._roughnessFactor=s}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(s){this._normalScale=s}set isDoubleSided(s){this._isDoubleSided=s}get isDoubleSided(){return this._isDoubleSided}set alphaMode(s){this._alphaMode=s}get alphaMode(){return this._alphaMode}set alphaCutoff(s){this._alphaCutoff=s}get alphaCutoff(){return this._alphaCutoff}get flags(){let s=0;return this.baseColorTexture!==void 0&&(s|=c.HAS_BASECOLORMAP),this.metallicRoughnessTexture!==void 0&&(s|=c.HAS_METALROUGHNESSMAP),this.normalTexture!==void 0&&(s|=c.HAS_NORMALMAP),this.occlusionTexture!==void 0&&(s|=c.HAS_OCCLUSIONMAP),this.emissiveTexture!==void 0&&(s|=c.HAS_EMISSIVEMAP),s}}t.GLTFPbrMaterial=d},2078:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPrimitive=t.VertexBinding=t.IndexBinding=void 0;const a=i(638),r=i(6119);t.IndexBinding=class{},t.VertexBinding=class{};class c extends a.Geometry{constructor(d,h,s,o,u,m,v){super(d,v),this._bindings=h,this._indexBinding=s,this._material=u,this._geometryFlags=m,this._drawMode=o}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const d of this._bindings)d.buffer.attribEnable(d.attributeIndex,d.size,d.type,d.normalized,d.stride,d.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const d of this._bindings)d.buffer.attribDisable(d.attributeIndex,!0,!0)}draw(){const d=this.context.gl;this._indexBinding?d.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):d.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(d){const h=r.GLTFHelper.nameToAttributeIndex(d);for(const s of this._bindings)if(s.attributeIndex===h)return s}}t.GLTFPrimitive=c},8892:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=t.GLTFPrimitive=t.GLTFShaderFlags=t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFLoader=void 0;var a=i(2604);Object.defineProperty(t,"GLTFLoader",{enumerable:!0,get:function(){return a.GLTFLoader}});var r=i(9806);Object.defineProperty(t,"GLTFAlphaMode",{enumerable:!0,get:function(){return r.GLTFAlphaMode}}),Object.defineProperty(t,"GLTFPbrMaterial",{enumerable:!0,get:function(){return r.GLTFPbrMaterial}}),Object.defineProperty(t,"GLTFShaderFlags",{enumerable:!0,get:function(){return r.GLTFShaderFlags}});var c=i(2078);Object.defineProperty(t,"GLTFPrimitive",{enumerable:!0,get:function(){return c.GLTFPrimitive}});var f=i(122);Object.defineProperty(t,"GLTFMesh",{enumerable:!0,get:function(){return f.GLTFMesh}})},4127:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Initializable=void 0;const a=i(9504);class r{constructor(){this._initialized=!1,this.assertInitialized=()=>r.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(f,d,h)=>{const s=h.value;return h.value=function(){return(0,a.assert)(this._initialized===!1,"re-initialization of initialized object not anticipated"),this._initialized=s.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>r.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)),this._initialized},h}}static uninitialize(){return(f,d,h)=>{const s=h.value;return h.value=function(){(0,a.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},h}}static discard(){return(f,d,h)=>{const s=h.value;return h.value=function(){(0,a.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},h}}static assert_initialized(){return(f,d,h)=>{const s=h.value;return h.value=function(){return this.assertInitialized(),s.apply(this,arguments)},h}}static assert_uninitialized(){return(f,d,h)=>{const s=h.value;return h.value=function(){this.assertUninitialized(),s.apply(this,arguments)},h}}get initialized(){return this._initialized}}t.Initializable=r,r.assertInitializedFalse=c=>(0,a.assert)(!1,`instance of ${c.constructor.name} expected to be initialized`),r.assertUninitializedFalse=c=>(0,a.assert)(!1,`instance of ${c.constructor.name} not expected to be initialized`)},4287:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KernelI8=t.KernelUI8=t.KernelI32=t.KernelUI32=t.KernelF32=t.AbstractKernel=void 0;const a=i(9504);class r{constructor(f,d,h=1,s=1){this._components=f,this._width=isNaN(d)?1:Math.max(1,d),this._height=Math.max(1,h),this._depth=Math.max(1,s),this.resize()}get(f,d,h){let s;switch(s=d===void 0&&h===void 0?this._components*f:this.index(f,d,h||0),(0,a.assert)(s<this.length,`index expected to be in range [0, ${this.length-1}], given ${s}`),this._components){case 1:return[this._samples[s]];case 2:return[this._samples[s],this._samples[s+1]];case 3:return[this._samples[s],this._samples[s+1],this._samples[s+2]];case 4:return[this._samples[s],this._samples[s+1],this._samples[s+2],this._samples[s+3]]}}set(f,d,h,s){let o;switch((0,a.assert)(f.length===this._components,`number of components expected to be ${this._components}, given ${f.length}`),o=h===void 0&&s===void 0?this._components*Math.min(this.elements,Math.max(0,d)):this._components*this.index(d,h,s||0),(0,a.assert)(o<this.length,`index expected to be in range [0, ${this.length-1}], given ${o}`),this._components){case 4:this._samples[o+3]=f[3];case 3:this._samples[o+2]=f[2];case 2:this._samples[o+1]=f[1];case 1:this._samples[o+0]=f[0]}}fromJSON(f){(0,a.assert)(f.size&&f.size.width!==void 0&&f.size.height!==void 0&&f.size.depth!==void 0,`expected kernel width, height, and depth to be set, given '${f.size}'`);const d=s=>s.reduce((o,u)=>o.concat(Array.isArray(u)?d(u):u),[]);this._width=Math.max(1,f.size.width),this._height=Math.max(1,f.size.height),this._depth=Math.max(1,f.size.depth);const h=d(f.kernel);this._components=Math.floor(h.length/this.elements),this.resize(),this.fromArray(h)}index(f,d=0,h=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,h))+Math.min(this._height,Math.max(0,d)))+Math.min(this._width,Math.max(0,f))}position(f){let d=Math.min(this.elements,Math.max(0,f));const h=Math.floor(d/(this._width*this._height));d-=h*this._width*this._height;const s=Math.floor(d/this._width);return d-=s*this._width,[d,s,h]}sort(f){if(this.elements<2)return;const d=Array(this.elements);for(let s=0;s<this.elements;++s){let o=0;r.SortApproach.BySquaredLength;for(let u=0;u<this._components;++u){const m=this._samples[s*this._components+u];o+=m*m}d[s]=[s,o]}r.SortApproach.BySquaredLength,d.sort((s,o)=>s[1]-o[1]);const h=this._samples.slice();for(let s=0;s<d.length;++s)for(let o=0;o<this._components;++o){const u=d[s][0]*this._components+o,m=s*this._components+o;this._samples[m]=h[u]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const f=this._width*this._height*this._depth;return isNaN(f)?0:f}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}t.AbstractKernel=r,function(c){(function(f){f[f.BySquaredLength=0]="BySquaredLength"})(c.SortApproach||(c.SortApproach={}))}(r||(t.AbstractKernel=r={})),t.KernelF32=class extends r{resize(){this._samples=new Float32Array(this.length)}fromArray(c){(0,a.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(c))}get bytesPerComponent(){return 4}},t.KernelUI32=class extends r{resize(){this._samples=new Uint32Array(this.length)}fromArray(c){(0,a.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(c))}get bytesPerComponent(){return 4}},t.KernelI32=class extends r{resize(){this._samples=new Int32Array(this.length)}fromArray(c){(0,a.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(c))}get bytesPerComponent(){return 4}},t.KernelUI8=class extends r{resize(){this._samples=new Uint8Array(this.length)}fromArray(c){(0,a.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(c))}get bytesPerComponent(){return 4}},t.KernelI8=class extends r{resize(){this._samples=new Int8Array(this.length)}fromArray(c){(0,a.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(c))}get bytesPerComponent(){return 4}}},5678:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardEventType=t.KeyboardEventProvider=void 0;const a=i(7032),r=i(9504);var c;t.KeyboardEventProvider=class{constructor(f,d){(0,r.assert)(f!==void 0,`expected valid canvas element on initialization, given ${f}`),this._element=f,this._timeframe=d}preventDefaultOnEvent(f,d){(0,r.bitInBitfield)(this._preventDefaultMask,f)&&d.preventDefault()}preventDefault(...f){for(const d of f)(0,r.bitInBitfield)(this._preventDefaultMask,d)||(this._preventDefaultMask|=d)}allowDefault(...f){for(const d of f)(0,r.bitInBitfield)(this._preventDefaultMask,d)&&(this._preventDefaultMask&=~d)}observable(f){switch(f){case c.KeyDown:return this.keyDown$;case c.KeyPress:return this.keyPress$;case c.KeyUp:return this.keyUp$;default:return}}get keyDown$(){return this._keyDownSubject===void 0&&(this._keyDownSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyDownListener=f=>{this.preventDefaultOnEvent(c.KeyDown,f),this._keyDownSubject.next(f)},this._element.addEventListener("keydown",this._keyDownListener)),this._keyDownSubject.asObservable()}get keyPress$(){return this._keyPressSubject===void 0&&(this._keyPressSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyPressListener=f=>{this.preventDefaultOnEvent(c.KeyPress,f),this._keyPressSubject.next(f)},this._element.addEventListener("keypress",this._keyPressListener)),this._keyPressSubject.asObservable()}get keyUp$(){return this._keyUpSubject===void 0&&(this._keyUpSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyUpListener=f=>{this.preventDefaultOnEvent(c.KeyUp,f),this._keyUpSubject.next(f)},this._element.addEventListener("keyup",this._keyUpListener)),this._keyUpSubject.asObservable()}},function(f){f[f.KeyDown=1]="KeyDown",f[f.KeyPress=2]="KeyPress",f[f.KeyUp=4]="KeyUp"}(c||(t.KeyboardEventType=c={}))},4602:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MouseEventProvider=void 0;const a=i(7032),r=i(9504),c=i(8853),f=i(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(c.IS_EDGE||c.IS_IE11)&&this._element.addEventListener("dragstart",u=>u.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&f.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Click:return this.click$;case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Wheel:return this.wheel$;case d.Type.Drag:return this.drag$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,f.PointerLock.exit())}get pointerLock(){return f.PointerLock.active(this._element)}get click$(){return this._clickSubject===void 0&&(this._clickSubject=new a.ReplaySubject(void 0,this._timeframe),this._clickListener=s=>{this.preventDefaultOnEvent(d.Type.Click,s),this._clickSubject.next(s)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new a.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new a.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new a.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new a.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return this._wheelSubject===void 0&&(this._wheelSubject=new a.ReplaySubject(void 0,this._timeframe),this._wheelListener=s=>{this.preventDefaultOnEvent(d.Type.Wheel,s),this._wheelSubject.next(s)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return this._dragSubject===void 0&&(this._dragSubject=new a.ReplaySubject(void 0,this._timeframe),this._dragListener=s=>{this.preventDefaultOnEvent(d.Type.Drag,s),this._dragSubject.next(s)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}t.MouseEventProvider=d,function(h){(function(s){s[s.Click=1]="Click",s[s.Wheel=2]="Wheel",s[s.Enter=4]="Enter",s[s.Leave=8]="Leave",s[s.Move=16]="Move",s[s.Down=32]="Down",s[s.Up=64]="Up",s[s.Drag=128]="Drag"})(h.Type||(h.Type={}))}(d||(t.MouseEventProvider=d={}))},8853:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IS_EDGE=t.IS_IE11=void 0,t.IS_IE11=typeof navigator>"u"?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),t.IS_EDGE=typeof navigator>"u"?void 0:/Edge\/\d./i.test(navigator.userAgent)},4264:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Navigation=void 0;const a=i(3557),r=i(2),c=i(2010),f=i(9504),d=i(4850),h=i(506),s=i(5222),o=i(3151),u=i(9184),m=i(7137);class v{constructor(g,x){this._alwaysRotateOnMove=!1,this._invalidate=g,this._eventHandler=new r.EventHandler(g,x),this._eventHandler.pushPointerDownHandler((E,w)=>this.onPointerDown(E,w)),this._eventHandler.pushPointerUpHandler((E,w)=>this.onPointerUp(E,w)),this._eventHandler.pushPointerEnterHandler((E,w)=>this.onPointerEnter(E,w)),this._eventHandler.pushPointerLeaveHandler((E,w)=>this.onPointerLeave(E,w)),this._eventHandler.pushPointerMoveHandler((E,w)=>this.onPointerMove(E,w)),this._eventHandler.pushPointerCancelHandler((E,w)=>this.onPointerCancel(E,w)),this._eventHandler.pushMouseWheelHandler((E,w)=>this.onWheel(E,w)),this.rotationMetaphor=v.RotationMetaphor.Turntable,this._pan=new h.PanModifier,this._pinch=new s.PinchZoomModifier,this._wheelZoom=new m.WheelZoomModifier,this._activeEvents=new Map}mode(){const g=Array.from(this._activeEvents.values()),x=this.getPrimaryEvent(g);if(x===void 0)return void(0,f.log)(f.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const E=x.pointerType==="mouse",w=x.pointerType==="touch"||x.pointerType==="pen",S=1&x.buttons,R=x.shiftKey,O=c.PointerLock.active()&&this._alwaysRotateOnMove,I=this._activeEvents.size;return O?v.Modes.Rotate:E&&S&&R&&I===1?v.Modes.Pan:w&&I===2?v.Modes.MultiTouch:E&&S&&I===1||w&&I===1?v.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void(0,f.log)(f.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const g=Array.from(this._activeEvents.values()),x=a.vec2.fromValues(g[0].movementX,g[0].movementY),E=a.vec2.fromValues(g[1].movementX,g[1].movementY);return a.vec2.length(x)===0||a.vec2.length(E)===0?v.Modes.Zoom:(a.vec2.normalize(x,x),a.vec2.normalize(E,E),a.vec2.dot(x,E)>.2?v.Modes.Pan:v.Modes.Zoom)}rotate(g){if(this._activeEvents.size!==1)return void(0,f.log)(f.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0];switch(this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:const w=this._firstPerson;let S;c.PointerLock.active()&&event instanceof MouseEvent&&(S=a.vec2.fromValues(event.movementX,event.movementY)),g?w.initiate(E):w.process(E,S);break;case v.RotationMetaphor.Trackball:const R=this._trackball;g?R.initiate(E):R.process(E);break;case v.RotationMetaphor.Turntable:const O=this._turntable;g?O.initiate(E):O.process(E)}}pan(g){const x=Array.from(this._activeEvents.values()),E=this.getPrimaryEvent(x);if(E===void 0)return void(0,f.log)(f.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const w=this._eventHandler.offsets(E)[0],S=this._pan;g?S.initiate(w):S.process(w)}pinch(g){if(this._activeEvents.size!==2)return void(0,f.log)(f.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0],w=this._eventHandler.offsets(x[1])[0],S=this._pinch;g?S.initiate(E,w):S.process(E,w)}getPrimaryEvent(g){for(const x of g)if(x.isPrimary)return x}onPointerDown(g,x){for(const E of g)this._activeEvents.set(E.pointerId,E);switch(this._mode=this.mode(),this._mode){case v.Modes.Rotate:this.rotate(!0);break;case v.Modes.Pan:this.pan(!0);break;case v.Modes.Zoom:this.pinch(!0)}}onPointerUp(g,x){for(const E of g)this._activeEvents.delete(E.pointerId)}onPointerEnter(g,x){}onPointerLeave(g,x){for(const E of g)this._activeEvents.delete(E.pointerId)}onPointerCancel(g,x){for(const E of g)this._activeEvents.delete(E.pointerId)}onPointerMove(g,x){for(const R of g)this._activeEvents.set(R.pointerId,R);if(this._mode===void 0)return;const E=Array.from(this._activeEvents.values()),w=this.getPrimaryEvent(E);w&&w.pointerType==="mouse"&&(this._mode=this.mode());let S=!1;switch(this._mode===v.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),S=!0),this._mode){case v.Modes.Rotate:this.rotate(S);break;case v.Modes.Pan:this.pan(S);break;case v.Modes.Zoom:this.pinch(S)}this._lastInteractionTime=performance.now()}onWheel(g,x){const E=g[0];this._wheelZoom.process(E.deltaY)}update(){this._eventHandler.update()}set camera(g){this._camera=g,this._firstPerson&&(this._firstPerson.camera=g),this._trackball&&(this._trackball.camera=g),this._turntable&&(this._turntable.camera=g),this._pan&&(this._pan.camera=g),this._pinch&&(this._pinch.camera=g),this._wheelZoom&&(this._wheelZoom.camera=g)}set rotationMetaphor(g){if(this._rotationMetaphor!==g){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=g,this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new d.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case v.RotationMetaphor.Trackball:this._trackball=new o.TrackballModifier,this._trackball.camera=this._camera;break;case v.RotationMetaphor.Turntable:this._turntable=new u.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}t.Navigation=v,function(_){(function(g){g[g.Move=0]="Move",g[g.Pan=1]="Pan",g[g.MultiTouch=2]="MultiTouch",g[g.Rotate=3]="Rotate",g[g.Zoom=4]="Zoom",g[g.ZoomStep=5]="ZoomStep"})(_.Modes||(_.Modes={})),function(g){g.FirstPerson="firstperson",g.Flight="flight",g.Trackball="trackball",g.Turntable="turntable"}(_.RotationMetaphor||(_.RotationMetaphor={}))}(v||(t.Navigation=v={}))},5491:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingRectangle=void 0;const r=i(7340),c=i(638),f=i(4127);class d extends c.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const u=new r.Buffer(s,`${o}VBO`);this._buffers.push(u)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),u}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingRectangle=d,d.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),a([f.Initializable.assert_initialized()],d.prototype,"draw",null)},1896:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingTriangle=void 0;const r=i(7340),c=i(638),f=i(4127);class d extends c.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const u=new r.Buffer(s,`${o}VBO`);this._buffers.push(u)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),u}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingTriangle=d,d.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),a([f.Initializable.assert_initialized()],d.prototype,"draw",null)},9965:function(p,t,i){var a=this&&this.__decorate||function(d,h,s,o){var u,m=arguments.length,v=m<3?h:o===null?o=Object.getOwnPropertyDescriptor(h,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,h,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(m<3?u(v):m>3?u(h,s,v):u(h,s))||v);return m>3&&v&&Object.defineProperty(h,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractObject=void 0;const r=i(9504),c=i(4127);class f extends c.Initializable{constructor(h,s){super(),this._valid=!1,this._referenceCount=0,this._context=h,this._identifier=s!==void 0&&s!==""?s:"Object"}initialize(...h){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...h),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),(0,r.log)(r.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),(0,r.assert)(this._object===void 0,`expected object '${this._identifier}' to be undefined after delete`),(0,r.assert)(this._valid===!1,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return(0,r.assert)(this._object!==void 0,"access to undefined object"),this._object}get valid(){return this._valid}ref(){(0,r.assert)(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){(0,r.assert)(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}t.AbstractObject=f,a([c.Initializable.initialize()],f.prototype,"initialize",null),a([c.Initializable.uninitialize()],f.prototype,"uninitialize",null)},506:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PanModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h}process(h){this._currentPoint=h;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity);const o=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(o,o);const u=this._reference.up;a.vec3.normalize(u,u);const m=a.vec3.cross((0,r.v3)(),u,o),v=a.vec3.scale((0,r.v3)(),m,s[0]),_=a.vec3.scale((0,r.v3)(),u,s[1]);a.vec3.negate(_,_),this._translation=a.vec3.add((0,r.v3)(),_,v),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,h),o=a.vec3.transformMat4((0,r.v3)(),this._reference.center,h);this._camera.eye=s,this._camera.center=o}}t.PanModifier=f,f.DEFAULT_SENSITIVITY=.002},5222:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PinchZoomModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(h,s){Object.assign(this._reference,this._camera);const o=a.vec2.subtract((0,r.v2)(),h,s);this._initialDistance=a.vec2.length(o)}process(h,s){const o=a.vec2.subtract((0,r.v2)(),h,s);this._currentDistance=a.vec2.length(o);const u=(this._currentDistance/this._initialDistance-1)*f.DEFAULT_SENSITIVITY,m=a.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);a.vec3.normalize(m,m),this._translation=a.vec3.scale((0,r.v3)(),m,u),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.eye=s}}t.PinchZoomModifier=f,f.DEFAULT_SENSITIVITY=2},8216:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerEventProvider=void 0;const a=i(7032),r=i(9504),c=i(8853),f=i(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(c.IS_EDGE||c.IS_IE11)&&this._element.addEventListener("dragstart",u=>u.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&f.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Cancel:return this.cancel$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,f.PointerLock.exit())}get pointerLock(){return f.PointerLock.active(this._element)}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new a.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new a.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new a.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new a.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new a.ReplaySubject(void 0,this._timeframe),this._cancelListener=s=>{this.preventDefaultOnEvent(d.Type.Cancel,s),this._cancelSubject.next(s)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.PointerEventProvider=d,function(h){(function(s){s[s.Enter=1]="Enter",s[s.Leave=2]="Leave",s[s.Move=4]="Move",s[s.Down=8]="Down",s[s.Up=16]="Up",s[s.Cancel=32]="Cancel"})(h.Type||(h.Type={}))}(d||(t.PointerEventProvider=d={}))},2010:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerLock=void 0;const a=i(9504);class r{static queryAndCacheAPI(){if(r._exit!==void 0)return;const f=window.document,d=[f.exitPointerLock,f.mozExitPointerLock,f.webkitExitPointerLock,void 0];let h=0;for(;h<d.length&&d[h]===void 0;++h);switch(h){case 0:r._exit=()=>f.exitPointerLock(),r._request=s=>s.requestPointerLock(),r._element=()=>f.pointerLockElement;break;case 1:r._exit=()=>f.mozCancelPointerLock(),r._request=s=>s.mozRequestPointerLock(),r._element=()=>f.mozPointerLockElement;break;case 2:r._exit=()=>f.webkitExitPointerLock(),r._request=s=>s.webkitRequestPointerLock(),r._element=()=>f.webkitPointerLockElement;break;default:(0,a.assert)(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(f){return this._element!==void 0&&(f!==void 0&&r._element()===f||f===void 0&&r._element()!==void 0&&r._element()!==null)}static request(f,d){f!==void 0&&(r.queryAndCacheAPI(),r.active()&&r._element()!==f&&r._exit(),r.active()||r._request(f))}static exit(){r._exit&&r._exit()}}t.PointerLock=r},4985:function(){String.prototype.repeat===void 0&&(String.prototype.repeat=function(p){if(this===null)throw new TypeError("can't convert "+this+" to object");const t=""+this;if((p=+p)!=p&&(p=0),p<0)throw new RangeError("repeat count must be non-negative");if(p===1/0)throw new RangeError("repeat count must be less than infinity");if(p=Math.floor(p),t.length===0||p===0)return"";if(t.length*p>=268435456)throw new RangeError("repeat count must not overflow maximum string size");let i="";for(let a=0;a<p;a++)i+=t;return i}),String.prototype.startsWith===void 0&&(String.prototype.startsWith=function(p,t){return t=t||0,this.indexOf(p,t)===t}),String.prototype.endsWith===void 0&&(String.prototype.endsWith=function(p,t){return(t===void 0||t>this.length)&&(t=this.length),this.substring(t-p.length,t)===p}),String.prototype.includes===void 0&&(String.prototype.includes=function(p,t){return typeof t!="number"&&(t=0),!(t+p.length>this.length)&&this.indexOf(p,t)!==-1}),String.prototype.trimLeft===void 0&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight===void 0&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Array.prototype.forEach===void 0&&(Array.prototype.forEach=(p,t)=>{const i=this.length;for(let a=0;a<i;a++)a in this&&p.call(t,this[a],a,this)}),Array.prototype.fill===void 0&&(Array.prototype.fill=(p,t,i)=>{if(this===null)throw new TypeError("this is null or not defined");const a=Object(this),r=a.length>>>0,c=0|t;let f=c<0?Math.max(r+c,0):Math.min(c,r);const d=i===void 0?r:0|i,h=d<0?Math.max(r+d,0):Math.min(d,r);for(;f<h;)a[f]=p,++f;return a}),Math.log10===void 0&&(Math.log10=p=>Math.log(p)*Math.LOG10E),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach(p=>{p.prototype.slice||Object.defineProperty(p.prototype,"slice",{value:Array.prototype.slice}),p.prototype.reduce||Object.defineProperty(p.prototype,"reduce",{value:Array.prototype.reduce}),p.prototype.filter||Object.defineProperty(p.prototype,"filter",{value:Array.prototype.filter}),p.prototype.map||Object.defineProperty(p.prototype,"map",{value:Array.prototype.map}),p.prototype.indexOf||Object.defineProperty(p.prototype,"indexOf",{value:Array.prototype.indexOf})}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{value(p,t){if(p===void 0&&p===null)throw new TypeError("Cannot convert undefined or null to object");const i=Object(p);for(let a=1;a<arguments.length;a++){const r=arguments[a];if(r!=null)for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&(i[c]=r[c])}return i},configurable:!0,writable:!0})},4168:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(s=new Array,o=!0){const u=this._context.gl;let m=0,v=0;for(const _ of s)switch(_.type){case u.VERTEX_SHADER:++m;break;case u.FRAGMENT_SHADER:++v;break;default:(0,r.assert)(!1,"Unknown shader type detected.")}if((0,r.logIf)(m<1,r.LogLevel.Error,"at least one vertex shader is expected"),(0,r.logIf)(v<1,r.LogLevel.Error,"at least one fragment shader is expected"),!(m<1||v<1))return this._object=u.createProgram(),this._valid=u.isProgram(this._object),(0,r.assert)(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),s.length>0&&this.attach(s,o),this._object}delete(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(s,o=!1){(0,r.assert)(this._object!==void 0,"expected a WebGLProgram object");const u=this._context.gl;for(const m of s instanceof Array?s:[s])this._shaders.indexOf(m)>-1||(this._shaders.push(m),m.initialized?(u.attachShader(this._object,m.object),m.ref()):(0,r.log)(r.LogLevel.Error,`shader '${m.identifier}' not initialized.`));return o&&this.link(),!0}detach(s){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const o=this._context.gl;for(const u of s instanceof Array?s:[s]){const m=this._shaders.indexOf(u);m>-1&&this._shaders.splice(m),(0,r.assert)(u.initialized,`expected shader '${u.identifier}' to be initialized`),o.detachShader(this._object,u.object),u.unref()}}link(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const s=this._context.gl;if(s.linkProgram(this._object),s.getProgramParameter(this._object,s.LINK_STATUS))this._linked=!0;else{const o=s.getProgramInfoLog(this._object);(0,r.log)(r.LogLevel.Error,`linking of program '${this._identifier}' failed: '${o}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(d.DEFAULT_PROGRAM)}uniform(s){return this._context.gl.getUniformLocation(this._object,s)}attribute(s,o){return o!==void 0?((0,r.logIf)(this._linked,r.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${s} -> ${o} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,o,s),o):this._context.gl.getAttribLocation(this._object,s)}get shaders(){return this._shaders}get linked(){return this._linked}}t.Program=d,d.DEFAULT_PROGRAM=void 0,a([c.Initializable.assert_initialized()],d.prototype,"bind",null),a([c.Initializable.assert_initialized()],d.prototype,"unbind",null),a([c.Initializable.assert_initialized()],d.prototype,"uniform",null),a([c.Initializable.assert_initialized()],d.prototype,"attribute",null)},1407:(p,t,i)=>{const a=i(3780),r=i(9504);function c(h,s){const o=s.properties,u=Object.getOwnPropertyNames(o);for(const m of u){const v=o[m],_=v.type==="object",g=h.hasOwnProperty(m),x=v.hasOwnProperty("properties"),E=v.hasOwnProperty("default");(0,r.assert)(x&&_||!x&&!_,`expected property '${m}' to be of type 'object', given '${v.type}'`),g&&x?d.complement(h[m],v):!g&&E&&Object.defineProperty(h,m,{value:v.default,writable:!0})}}function f(h,s){const o=s.items;if(o.type==="object")for(const u of Object.getOwnPropertyNames(h))u!=="length"&&d.complement(h[u],o)}var d;(function(h){h.validate=function(s,o,u){const m=new a.Validator;if(u!==void 0)for(const _ of u)m.addSchema(_[0],_[1]);const v=m.validate(s,o);return(0,r.logIf)(!v.valid,r.LogLevel.Warning,`schema expected to be valid:
${v.toString()}`),v.valid},h.complement=function(s,o){if(s!==void 0)switch((0,r.assert)(o.hasOwnProperty("properties")&&o.type==="object"||o.hasOwnProperty("items")&&o.type==="array",`expected schema to have 'properties' or 'items', given ${o}`),o.type){case"object":c(s,o);break;case"array":f(s,o)}},h.compare=function s(o,u,m,v=""){const _=m!==void 0;if((0,r.assert)(!_||m.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),o===void 0&&u!==void 0||o!==void 0&&u===void 0)return _&&m.alter(v),!0;let g=!0,x=[typeof o,typeof u];const E=[o instanceof Array,u instanceof Array];if(!(E[0]&&E[1]||x[0]==="object"&&x[1]==="object"))return g=o===u,!g&&_&&m.alter(`${v}`),!g;const w=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(o),Object.getOwnPropertyNames(u))).values());for(const S of w){if(S==="length")continue;const R=[o[S],u[S]];x=[typeof R[0],typeof R[1]];const O=`${v}${v.length>0&&!E[0]?".":""}${E[0]?"":S}`;if(R[0]instanceof Array&&R[1]instanceof Array||x[0]==="object"&&x[1]==="object")g=g&&!s(R[0],R[1],m,O);else{if(x[0]===x[1]&&R[0]===R[1])continue;g=!1,_&&m.alter(O)}}return!g}})(d||(d={})),p.exports=d},3039:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSquareKernel=void 0;const a=i(9504),r=i(4287);class c extends r.KernelF32{constructor(d){super(2,d),this.generate()}generate(){(0,a.assert)(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let d=1;d<this.width;++d)this.set([(0,a.rand)(-.5,.5),(0,a.rand)(-.5,.5)],d)}get width(){return this._width}set width(d){this._width!==d&&(this._width=d,this.resize(),this.generate())}}t.RandomSquareKernel=c},8962:(p,t,i)=>{const a=i(3557),r=i(5150),c=i(9504);var f;(function(d){function h(m,v,_=1){const g=a.vec2.subtract((0,r.v2)(),v,m);if(a.vec2.equals(g,a.vec2.fromValues(0,0)))return;const x=a.vec2.squaredLength(g),E=2*a.vec2.dot(g,m),w=E*E-4*x*(a.vec2.squaredLength(m)-_*_);if(w<0)return;const S=Math.sqrt(w),R=Math.min((-E+S)/(2*x),(-E-S)/(2*x)),O=a.vec2.scale((0,r.v2)(),g,R);return a.vec2.add(O,O,m)}function s(m,v,_,g){const x=m,E=a.vec2.sub((0,r.v2)(),v,m),w=_,S=a.vec2.sub((0,r.v2)(),g,_),R=a.vec2.cross((0,r.v3)(),E,S)[2];if(R===0)return;const O=a.vec2.sub((0,r.v2)(),w,x),I=a.vec2.cross((0,r.v3)(),O,a.vec2.scale((0,r.v2)(),E,1/R))[2],D=a.vec2.cross((0,r.v3)(),O,a.vec2.scale((0,r.v2)(),S,1/R))[2];return I<0||I>1||D<0?void 0:[a.vec2.add((0,r.v2)(),w,a.vec2.scale((0,r.v2)(),S,I)),D]}function o(m,v,_=a.vec3.fromValues(0,0,0),g=a.vec3.fromValues(0,1,0)){const x=a.vec3.normalize((0,r.v3)(),a.vec3.subtract((0,r.v3)(),v,m)),E=a.vec3.dot(x,g);if(a.vec3.equals(x,[0,0,0])||E>=0)return;const w=a.vec3.dot(a.vec3.subtract((0,r.v3)(),_,m),g)/E;return a.vec3.add((0,r.v3)(),a.vec3.scale((0,r.v3)(),x,w),m)}function u(m,v,_){const g=a.vec3.subtract((0,r.v3)(),v,m),x=a.vec3.squaredLength(g);if(x===0)return 0;const E=a.vec3.subtract((0,r.v3)(),_,m);return a.vec3.dot(E,g)/x}d.rayCircleIntersection=h,d.pointSquareIntersection=function(m,v=1){const _=(0,r.abs2)((0,r.v2)(),m);return _[0]>=_[1]?a.vec2.fromValues((0,r.sign)(m[0])*v,m[1]/_[0]*v):a.vec2.fromValues(m[0]/_[1]*v,(0,r.sign)(m[1])*v)},d.raySquareIntersection=function(m,v,_=1){const g=[a.vec2.fromValues(-_,+_),a.vec2.fromValues(-_,-_),a.vec2.fromValues(+_,-_),a.vec2.fromValues(+_,+_)],x=new Array;for(let E=0;E<4;++E){const w=s(m,v,g[E],g[(E+1)%4]);w&&x.push(w[1])}return x},d.rayLineIntersection=s,d.rayPlaneIntersection=o,d.raySphereIntersection=function(m,v,_=a.vec3.fromValues(0,0,0),g=1){const x=a.vec3.subtract((0,r.v3)(),m,_),E=a.vec3.normalize((0,r.v3)(),a.vec3.subtract((0,r.v3)(),v,m)),w=a.vec3.dot(E,x),S=w*w-a.vec3.squaredLength(x)+g*g;if(!(S<=0))return a.vec3.add((0,r.v3)(),m,a.vec3.scale((0,r.v3)(),E,-w-Math.sqrt(S)))},d.rayPlaneIntersection_tube=function(m,v,_=1){const g=o(m,v);if(g!==void 0&&a.vec3.length(g)<_)return g;const x=h(a.vec2.fromValues(m[0],m[2]),a.vec2.fromValues(v[0],v[2]),_);return x?a.vec3.fromValues(x[0],0,x[1]):void 0},d.isPointWithinSquare=function(m,v=1){const _=(0,r.abs2)((0,r.v2)(),m);return _[0]<=v&&_[1]<=v},d.isPointWithinNDC=function(m,v){const _=a.vec3.transformMat4((0,r.v3)(),v,m),g=(0,r.abs3)((0,r.v3)(),_);return g[0]<=1&&g[1]<=1&&_[2]>=0&&_[2]<=1},d.distancePointToRay=u,d.eyeWithPointInView=function(m,v){const _=a.vec3.subtract((0,r.v3)(),m.center,m.eye),g=a.vec3.normalize((0,r.v3)(),_),x=a.vec3.normalize((0,r.v3)(),a.vec3.cross((0,r.v3)(),g,m.up)),E=a.vec3.normalize((0,r.v3)(),a.vec3.cross((0,r.v3)(),x,g)),w=u(m.eye,m.center,v),S=a.vec3.add((0,r.v3)(),m.eye,a.vec3.scale((0,r.v3)(),_,w)),R=a.vec3.subtract((0,r.v3)(),v,S),O=Math.abs(a.vec3.dot(R,x))/m.aspect,I=Math.abs(a.vec3.dot(R,E)),D=Math.max(O,I)/Math.tan(m.fovy*c.DEG2RAD*.5);return a.vec3.subtract((0,r.v3)(),S,a.vec3.scale((0,r.v3)(),g,D))}})(f||(f={})),p.exports=f},1900:function(p,t,i){var a=this&&this.__decorate||function(_,g,x,E){var w,S=arguments.length,R=S<3?g:E===null?E=Object.getOwnPropertyDescriptor(g,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,E);else for(var O=_.length-1;O>=0;O--)(w=_[O])&&(R=(S<3?w(R):S>3?w(g,x,R):w(g,x))||R);return S>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.ReadbackPass=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(8215),h=i(4127),s=i(1896),o=i(4168),u=i(771),m=i(8593);class v extends h.Initializable{static maxClearDepth(){return(0,f.decode_float24x1_from_uint8x3)(r.vec3.fromValues(255,255,255))}constructor(g){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=g}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(g,x){return 65535*x+g}directReadDepthAt(g,x){(0,c.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),w=this._context.gl,S=E.size;this._depthFBO.bind();const R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&w.readBuffer(this._depthAttachment),w.readPixels(g*R[0],S[1]-x*R[1],1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(g,x){(0,c.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),w=this._context.gl,S=E.size,R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return w.viewport(0,0,1,1),this._program.bind(),w.uniform2f(this._uOffset,g*R[0]/S[0],(S[1]-x*R[1])/S[1]),w.uniform2f(this._uScale,1/S[0],1/S[1]),E.bind(w.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),E.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&w.readBuffer&&w.readBuffer(w.COLOR_ATTACHMENT0),w.readPixels(0,0,1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(g,x){const E=this._context.gl,w=this._context.gl2facade;if(x)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const S=new u.Shader(this._context,E.VERTEX_SHADER,"ndcvertices.vert (readback)");S.initialize(i(9657));const R=new u.Shader(this._context,E.FRAGMENT_SHADER,"readbackdepth.frag");return R.initialize(i(688)),this._program=new o.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([S,R],!1),g===void 0?this._ndcTriangle=new s.NdcFillingTriangle(this._context):(this._ndcTriangle=g,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),E.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new m.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,E.RGBA,E.RGBA,E.UNSIGNED_BYTE),this._framebuffer=new d.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[w.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(g,x){const E=this.hash(g,x);if(this._cache&&this._cachedDepths.has(E))return this._cachedDepths.get(E);const w=this.readDepthAt(g,x),S=w[0]===255&&w[1]===255&&w[2]===255?void 0:(0,f.decode_float24x1_from_uint8x3)(r.vec3.fromValues(w[0],w[1],w[2]));return this._cache&&this._cachedDepths.set(E,S),S}coordsAt(g,x,E,w){const S=this._depthFBO.texture(this._depthAttachment).size,R=E===void 0?this.depthAt(g,x):E;if(R===void 0)return;const O=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]],I=r.vec3.fromValues(g*O[0]*2/S[0]-1,1-x*O[1]*2/S[1],2*R-1);return r.vec3.transformMat4(r.vec3.create(),I,w)}idAt(g,x){const E=this.hash(g,x);if(this._cache&&this._cachedIDs.has(E))return this._cachedIDs.get(E);const w=this._context.gl,S=this._idFBO.texture(this._idAttachment).size,R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&w.readBuffer(this._idAttachment),w.readPixels(g*R[0],S[1]-x*R[1],1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer);const O=(0,f.decode_uint32_from_rgba8)(r.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(E,O),O}frame(){this.onFrame()}set cache(g){this._cache=g}set depthFBO(g){this._depthFBO=g}set depthAttachment(g){this._depthAttachment=g}set idFBO(g){this._idFBO=g}set idAttachment(g){this._idAttachment=g}set coordinateReferenceSize(g){this._referenceSize=g}}t.ReadbackPass=v,a([h.Initializable.assert_initialized()],v.prototype,"directReadDepthAt",null),a([h.Initializable.assert_initialized()],v.prototype,"renderThenReadDepthAt",null),a([h.Initializable.initialize()],v.prototype,"initialize",null),a([h.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([h.Initializable.assert_initialized()],v.prototype,"depthAt",null),a([h.Initializable.assert_initialized()],v.prototype,"coordsAt",null),a([h.Initializable.assert_initialized()],v.prototype,"idAt",null)},8400:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderbuffer=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(o,u,m,v=1){(0,r.assert)(o>0&&u>0,"renderbuffer object requires valid width and height greater than zero");const _=this.context.gl;this._object=_.createRenderbuffer(),this._width=o,this._height=u,this._internalFormat=m,this._samples=v,_.bindRenderbuffer(_.RENDERBUFFER,this._object),this._samples>1?_.renderbufferStorageMultisample(_.RENDERBUFFER,this._samples,m,o,u):_.renderbufferStorage(_.RENDERBUFFER,m,o,u),this._valid=_.isRenderbuffer(this._object),_.bindRenderbuffer(_.RENDERBUFFER,h.DEFAULT_RENDER_BUFFER);const g=o*u*(0,c.byteSizeOfFormat)(this.context,m);return this.context.allocationRegister.reallocate(this._identifier,g),this._object}delete(){(0,r.assert)(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,h.DEFAULT_RENDER_BUFFER)}resize(o,u,m=!1,v=!1){if(o===this._width&&u===this._height)return;this._width=o,this._height=u;const _=this.context.gl;m&&this.bind(),this._samples>1?_.renderbufferStorageMultisample(_.RENDERBUFFER,this._samples,this._internalFormat,o,u):_.renderbufferStorage(_.RENDERBUFFER,this._internalFormat,o,u),v&&this.unbind();const g=o*u*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,g)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}t.Renderbuffer=h,h.DEFAULT_RENDER_BUFFER=void 0,a([f.Initializable.assert_initialized()],h.prototype,"bind",null),a([f.Initializable.assert_initialized()],h.prototype,"unbind",null),a([f.Initializable.assert_initialized()],h.prototype,"resize",null)},3105:function(p,t,i){var a=this&&this.__decorate||function(_,g,x,E){var w,S=arguments.length,R=S<3?g:E===null?E=Object.getOwnPropertyDescriptor(g,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,E);else for(var O=_.length-1;O>=0;O--)(w=_[O])&&(R=(S<3?w(R):S>3?w(g,x,R):w(g,x))||R);return S>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.LoadingStatus=void 0;const r=i(7032),c=i(3557),f=i(9504),d=i(5150),h=i(7564),s=i(4127),o=i(2813),u=i(9217);var m;(function(_){_[_.Started=0]="Started",_[_.Finished=1]="Finished"})(m||(t.LoadingStatus=m={}));class v extends s.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new h.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=u.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new r.ReplaySubject(1)}invalidate(g=!1){this._invalidate(g)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(m.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(m.Finished)}initialize(g,x,E){return(0,f.assert)(g!==void 0,"valid webgl context required"),this._context=g,(0,f.assert)(x!==void 0,"valid multi-frame update callback required"),this._invalidate=x,this._isLoading=!0,this._loadingStatusSubscription=new r.ReplaySubject,this.onInitialize(g,x,E)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(g){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==g&&(this._multiFrameNumber=g,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(g){this.onFrame(g)}swap(){this.onSwap()}frameCoords(g,x){const E=c.vec2.divide((0,d.v2)(),this._frameSize,this.canvasSize);return c.vec2.floor(E,c.vec2.multiply(E,[g+.5,x+.5],E)),c.vec2.add(E,E,[.5,.5]),(0,o.tuple2)(E)}set frameSize(g){this.assertInitialized(),c.vec2.equals(this._frameSize,g)||(Object.assign(this._frameSize,g),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(g){this.assertInitialized(),this._framePrecision!==g&&(this._framePrecision=g,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(g){this.assertInitialized(),c.vec4.equals(this._clearColor,g)||(Object.assign(this._clearColor,g),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(g){this.assertInitialized(),this._debugTexture!==g&&((0,f.logIf)(g>=this._debugTextures.length,f.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${g} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=g<this._debugTextures.length?(0,d.clamp)(g,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}t.Renderer=v,a([s.Initializable.assert_initialized()],v.prototype,"invalidate",null),a([s.Initializable.initialize()],v.prototype,"initialize",null),a([s.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([s.Initializable.discard()],v.prototype,"discard",null),a([s.Initializable.assert_initialized()],v.prototype,"update",null),a([s.Initializable.assert_initialized()],v.prototype,"prepare",null),a([s.Initializable.assert_initialized()],v.prototype,"frame",null),a([s.Initializable.assert_initialized()],v.prototype,"swap",null)},9137:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resizable=void 0;const a=i(9504);class r{static resize(){(0,a.assert)(r.instances.length>0,"resize event received without a single resizable registered"),r.instances.forEach(f=>f.onResize())}static elementSize(f){if(f===void 0||window===void 0||typeof window.devicePixelRatio!="number")return[0,0];const d=window.devicePixelRatio,h=getComputedStyle(f);if(h.width===null||!h.width.endsWith("px")||h.height===null||!h.height.endsWith("px"))return void(0,a.log)(a.LogLevel.Debug,`computed element size expected in 'px', given ${h.width} ${h.height}`);const s=[parseFloat(h.width),parseFloat(h.height)];return[Math.round(s[0]*d),Math.round(s[1]*d)]}constructor(){if(this._resizeEventListener=()=>r.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),r.resize()},r.instances.length===0){const f=`on${r.EVENT_IDENTIFIER}`;r.eventSupported=document&&(f in document.documentElement||f in document.body),(0,a.logIf)(!r.eventSupported,a.LogLevel.Warning,"resize event not supported")}r.instances.length===0&&r.eventSupported&&window.addEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),r.instances.push(this)}observe(f){f!==void 0&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(f,r.MUTATION_OBSERVER_CONFIG)}dispose(){const f=r.instances.indexOf(this);(0,a.assert)(f!==-1,"invalid reference counting of resizable instances"),r.instances.splice(f,1),r.instances.length===0&&r.eventSupported&&window.removeEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}t.Resizable=r,r.EVENT_IDENTIFIER="resize",r.instances=[],r.eventSupported=!1,r.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},6197:function(p,t,i){var a=this&&this.__decorate||function(o,u,m,v){var _,g=arguments.length,x=g<3?u:v===null?v=Object.getOwnPropertyDescriptor(u,m):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,u,m,v);else for(var E=o.length-1;E>=0;E--)(_=o[E])&&(x=(g<3?_(x):g>3?_(u,m,x):_(u,m))||x);return g>3&&x&&Object.defineProperty(u,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardSceneRenderPass=void 0;const r=i(3557),c=i(9504),f=i(7564),d=i(4127),h=i(5138);class s extends h.SceneRenderPass{constructor(u){super(),this._altered=Object.assign(new f.ChangeLookup,{any:!1,camera:!1}),this._context=u,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){(0,c.assert)(this._scene!==void 0,"Scene was undefined during preprocessing."),this._scene!==void 0&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,r.mat4.create()))}preprocessNode(u,m){const v=r.mat4.clone(m),_=u.componentsOfType("TransformComponent");if((0,c.assert)(_.length<=1,"SceneNode can not have more than one transform component"),_.length===1){const x=_[0];r.mat4.mul(v,v,x.transform)}const g=u.componentsOfType("GeometryComponent");for(const x of g){const E=x,w=E.material,S=E.geometry;if(w.isTransparent){let R=this._transparentGeometryMap.get(w);R===void 0&&(R=[]),R.push([S,v]),this._transparentGeometryMap.set(w,R)}else{let R=this._opaqueGeometryMap.get(w);R===void 0&&(R=[]),R.push([S,v]),this._opaqueGeometryMap.set(w,R)}}if(u.nodes!==void 0)for(const x of u.nodes)this.preprocessNode(x,v)}renderGeometryMap(u){for(const m of Array.from(u.keys())){this.bindMaterial(m);const v=u.get(m);for(const[_,g]of v)_.bind(),this.bindGeometry!==void 0&&this.bindGeometry(_),this.updateModelTransform(g),_.draw(),_.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(u=!1){}frame(){if((0,c.assert)(this._target&&this._target.valid,"valid target expected"),(0,c.assert)(this._program&&this._program.valid,"valid program expected"),(0,c.assert)(this.updateModelTransform!==void 0,"Model transform function needs to be initialized."),(0,c.assert)(this.updateViewProjectionTransform!==void 0,"View Projection transform function needs to be initialized."),(0,c.assert)(this.bindMaterial!==void 0,"Material binding function needs to be initialized."),this._scene===void 0)return;const u=this._context.gl;u.enable(u.DEPTH_TEST);const m=this._target.size;u.viewport(0,0,m[0],m[1]),this._program.bind(),this.bindUniforms!==void 0&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),u.disable(u.BLEND)}drawCalls(u=!0){this._scene!==void 0&&(this.renderGeometryMap(this._opaqueGeometryMap),u&&this.renderGeometryMap(this._transparentGeometryMap))}set target(u){this.assertInitialized(),this._target=u}set ndcOffset(u){this.assertInitialized(),this._ndcOffset=u}set camera(u){this.assertInitialized(),this._camera!==u&&(this._camera=u,this._altered.alter("camera"))}set clearColor(u){this._clearColor=u}set program(u){this._program=u}}t.ForwardSceneRenderPass=s,a([d.Initializable.initialize()],s.prototype,"initialize",null),a([d.Initializable.uninitialize()],s.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],s.prototype,"update",null),a([d.Initializable.assert_initialized()],s.prototype,"frame",null),a([d.Initializable.assert_initialized()],s.prototype,"drawCalls",null)},2384:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryComponent=void 0;const a=i(6344);class r extends a.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(f){this._geometry=f}get geometry(){return this._geometry}set material(f){this._material=f}get material(){return this._material}}t.GeometryComponent=r},5315:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=t.Material=t.GeometryComponent=t.TransformComponent=t.SceneNodeComponent=t.SceneNode=t.ForwardSceneRenderPass=void 0;var a=i(6197);Object.defineProperty(t,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return a.ForwardSceneRenderPass}});var r=i(651);Object.defineProperty(t,"SceneNode",{enumerable:!0,get:function(){return r.SceneNode}});var c=i(6344);Object.defineProperty(t,"SceneNodeComponent",{enumerable:!0,get:function(){return c.SceneNodeComponent}});var f=i(6244);Object.defineProperty(t,"TransformComponent",{enumerable:!0,get:function(){return f.TransformComponent}});var d=i(2384);Object.defineProperty(t,"GeometryComponent",{enumerable:!0,get:function(){return d.GeometryComponent}});var h=i(7874);Object.defineProperty(t,"Material",{enumerable:!0,get:function(){return h.Material}});var s=i(5138);Object.defineProperty(t,"SceneRenderPass",{enumerable:!0,get:function(){return s.SceneRenderPass}})},7874:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0,t.Material=class{constructor(i,a){this._context=i,this._name=a,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(i){this._isTransparent=i}}},651:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=void 0,t.SceneNode=class{constructor(i){this._nodes=new Array,this._components=new Array,this._name=i,this._parent=void 0}traverse(i){i(this);for(const a of this._nodes)a.traverse(i)}addNode(i){return i._parent=this,this._nodes.push(i),i}addComponent(i){return this._components.push(i),i}componentsOfType(i){return this._components.filter(a=>i===a.type)}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return this._nodes.length===0}get isRoot(){return this._parent===void 0}}},6344:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNodeComponent=void 0,t.SceneNodeComponent=class{constructor(i){this._type=i}get type(){return this._type}}},5138:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=void 0;const a=i(4127);class r extends a.Initializable{set scene(f){this._scene=f,this._scene!==void 0&&this.preprocessScene()}get scene(){return this._scene}}t.SceneRenderPass=r},6244:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformComponent=void 0;const a=i(6344);class r extends a.SceneNodeComponent{constructor(f){super("TransformComponent"),this._transform=f}get transform(){return this._transform}}t.TransformComponent=r},771:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;const a=i(9504),r=i(9965);class c extends r.AbstractObject{constructor(d,h,s){super(d,s),this._compiled=!1;const o=d.gl;if(s===void 0)switch(h){case d.gl.FRAGMENT_SHADER:s="FragmentShader";break;case d.gl.VERTEX_SHADER:s="VertexShader";break;default:(0,a.assert)(!1,`expected either a FRAGMENT_SHADER (${o.FRAGMENT_SHADER}) or a VERTEX_SHADER (${o.VERTEX_SHADER}), given ${h}`)}this._type=h}create(d,h=!0){const s=this._context.gl;return this._object=s.createShader(this._type),this._valid=s.isShader(this._object),this._compiled=!1,(0,a.assert)(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),d&&(this.source=d),d&&h&&this.compile(),this._object}delete(){(0,a.assert)(this._object!==void 0,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const d=this._context.gl;let h=this.sourceWithReplacements;if(this._context.isWebGL2&&(h=`#version 300 es
${h}`),d.shaderSource(this._object,h),d.compileShader(this._object),this._compiled=d.getShaderParameter(this._object,d.COMPILE_STATUS),!this._compiled){const s=d.getShaderInfoLog(this._object);(0,a.log)(a.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${s}`)}}replace(d,h){this._replacements===void 0&&(this._replacements=new Map),this._replacements.set(d,h)}get type(){return this.assertInitialized(),this._type}set source(d){this._source!==d&&(this._source=d)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(this._replacements===void 0)return this._source;let d=this._source;return this._replacements.forEach((h,s)=>{const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");d=d.replace(new RegExp(o,"g"),h)}),d}get compiled(){return this.assertInitialized(),this._compiled}}t.Shader=c},9011:function(p,t,i){var a=this&&this.__decorate||function(m,v,_,g){var x,E=arguments.length,w=E<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,v,_,g);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(v,_,w):x(v,_))||w);return E>3&&w&&Object.defineProperty(v,_,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowPass=void 0;const r=i(9504),c=i(8215),f=i(3395),d=i(4127),h=i(8400),s=i(8593),o=i(9217);class u extends d.Initializable{constructor(v){super(),this._gaussFilterKernelSize=21,this._context=v}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==u.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(v){v!==this._gaussFilterKernelSize&&(this._gaussFilter!==void 0&&(this._gaussFilter.kernelSize=v,this._gaussFilter.standardDeviation=v/6),this._gaussFilterKernelSize=v)}resize(v,_=!0,g=!0){(0,r.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._shadowMapSize=v,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],_,g)}resizeBlurTexture(v,_=!0,g=!0){(0,r.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=v,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,g),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,g)}initialize(v,_,g){(0,r.assert)(_[0]>0&&_[1]>0,"Size has to be > 0."),this._shadowType=v,this._shadowMapSize=_,this._blurredShadowMapSize=g!==void 0?g:this._shadowMapSize;const x=this._context.gl,E=this._context.gl2facade;let w=x.RGBA;if(this._context.isWebGL2){const I=this._context.gl;switch(this._shadowType){case u.ShadowMappingType.HardLinear:case u.ShadowMappingType.HardExponential:w=I.RED;break;case u.ShadowMappingType.SoftLinear:w=I.RG;break;case u.ShadowMappingType.SoftExponential:w=I.RGBA;break;default:(0,r.assert)(!1,"Unexpected value for shadowType")}}const[S,R]=o.Wizard.queryInternalTextureFormat(this._context,w,o.Wizard.Precision.float);this._shadowType!==u.ShadowMappingType.HardLinear&&R!==x.FLOAT&&((0,r.log)(r.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=u.ShadowMappingType.HardLinear);let O=x.LINEAR;return R!==x.FLOAT||this._context.supportsTextureFloatLinear||(O=x.NEAREST),R!==E.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(O=x.NEAREST),this._shadowMapTexture=new s.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],S,w,x.FLOAT),this._shadowMapTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._shadowMapTexture.filter(O,O),this._shadowMapRenderbuffer=new h.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],x.DEPTH_COMPONENT16),this._shadowMapFBO=new c.Framebuffer(this._context),this._shadowMapFBO.initialize([[E.COLOR_ATTACHMENT0,this._shadowMapTexture],[x.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new f.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new s.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,w,x.FLOAT),this._intermediateBlurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(O,O),this._intermediateBlurFBO=new c.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[E.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new s.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,w,x.FLOAT),this._blurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._blurTexture.filter(O,O),this._blurFBO=new c.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[E.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(v){const _=this._context.gl;_.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL),this._shadowMapFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),v(),_.disable(_.DEPTH_TEST),_.depthFunc(_.LESS),this.hasBlur&&(_.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,f.GaussFilter.Direction.Horizontal),_.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,f.GaussFilter.Direction.Vertical))}}t.ShadowPass=u,a([d.Initializable.assert_initialized()],u.prototype,"resize",null),a([d.Initializable.assert_initialized()],u.prototype,"resizeBlurTexture",null),a([d.Initializable.initialize()],u.prototype,"initialize",null),a([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],u.prototype,"frame",null),function(m){(function(v){v[v.HardLinear=0]="HardLinear",v[v.SoftLinear=1]="SoftLinear",v[v.HardExponential=2]="HardExponential",v[v.SoftExponential=3]="SoftExponential"})(m.ShadowMappingType||(m.ShadowMappingType={}))}(u||(t.ShadowPass=u={}))},8296:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFace=void 0;const a=i(9504),r=i(8593),c=i(9217),f=i(64),d=i(1575),h=i(2668);class s{static fromFile(u,m,v=!1,_){return(0,f.fetchAsync)(u,"text").then(g=>{const x=new s(m,_);return d.FontFaceLoader.process(x,g,u,void 0,v).then(E=>E).catch(E=>Promise.reject(`processing font face data failed: ${E}`))})}static fromFiles(u,m,v,_=!1,g){return(0,f.fetchAsync)(u,"text").then(x=>{const E=new s(v,g);return d.FontFaceLoader.process(E,x,u,m,_).then(w=>w).catch(w=>Promise.reject(`processing font face data failed: ${w}`))})}constructor(u,m){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=u;const v=u.gl;m=m!==void 0&&m!==""?m:this.constructor.name,this._glyphTexture=new r.Texture2D(u,`${m}GlyphAtlas`);const _=c.Wizard.queryInternalTextureFormat(u,v.RGBA,c.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,_[0],v.RGBA,_[1]),this._glyphTexture.filter(v.LINEAR,v.LINEAR)}hasGlyph(u){return!!this._glyphs.get(u)}glyph(u){const m=this._glyphs.get(u);if(m)return m;const v=new h.Glyph;return v.index=u,v}addGlyph(u){(0,a.assert)(!this._glyphs.get(u.index),"expected glyph to not already exist"),this._glyphs.set(u.index,u)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(u){return this.glyph(u).depictable()}kerning(u,m){const v=this._glyphs.get(u);return v?v.kerning(m):0}setKerning(u,m,v){const _=this._glyphs.get(u);_&&this.hasGlyph(m)?_.setKerning(m,v):(0,a.assert)(!1,`expected glyph or glyph of subsequent index to exist,                 given ${u} and ${m} respectively`)}set size(u){(0,a.assert)(u>0,`expected size to be greater than 0.0, given ${u}`),this._size=u}get size(){return this._size}set base(u){(0,a.assert)(u>0,`expected base to be greater than 0.0, given ${u}`),this._base=u}get base(){return this._base}set ascent(u){(0,a.assert)(u>0,`expected ascent to be greater than 0.0, given ${u}`),this._ascent=u}get ascent(){return this._ascent}set descent(u){this._descent=u}get descent(){return this._descent}set lineGap(u){this._lineGap=u}get lineGap(){return this._lineGap}set lineHeight(u){(0,a.assert)(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=u-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(u){this._lineGap=this.size*(u-1)}get lineSpace(){return this.lineHeight===0?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(u){(0,a.assert)(u[0]>0,`expected extent.x to be greater than 0.0, given ${u[0]}`),(0,a.assert)(u[1]>0,`expected extent.y to be greater than 0.0, given ${u[1]}`),this._glyphTextureExtent=u}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(u){(0,a.assert)(u[0]>=0,`expected padding[0] to be greater than 0.0, given ${u[0]}`),(0,a.assert)(u[1]>=0,`expected padding[1] to be greater than 0.0, given ${u[1]}`),(0,a.assert)(u[2]>=0,`expected padding[2] to be greater than 0.0, given ${u[2]}`),(0,a.assert)(u[3]>=0,`expected padding[3] to be greater than 0.0, given ${u[3]}`),this._glyphTexturePadding=u}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(u){this._glyphTexture=u}get glyphTexture(){return this._glyphTexture}}t.FontFace=s},1575:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFaceLoader=void 0;const a=i(9504),r=i(2668);class c{static processInfo(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["size","padding"],s))return!1;h.size=parseFloat(s.get("size"));const o=s.get("padding").split(",");if(o.length!==4)return(0,a.log)(a.LogLevel.Warning,`expected 4 values for padding, given ${o} (${o.length})`),!1;const u=[parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])];return h.glyphTexturePadding=u,!0}static processCommon(d,h){const s=new Map;return!!this.readKeyValuePairs(d,["lineHeight","base","scaleW","scaleH"],s)&&(h.base=parseFloat(s.get("base")),s.has("ascent")&&(h.ascent=parseFloat(s.get("ascent"))),s.has("descent")&&(h.descent=parseFloat(s.get("descent"))),h.lineHeight=parseFloat(s.get("lineHeight")),h.glyphTextureExtent=[parseFloat(s.get("scaleW")),parseFloat(s.get("scaleH"))],!0)}static processPage(d,h,s){const o=new Map;if(!this.readKeyValuePairs(d,["file"],o))return;const u=(0,a.dirname)(s);let m=o.get("file");return m=m.replace(/['"]+/g,""),h.glyphTexture.fetch(`${u}/${m}`,!0,!0).catch(()=>Promise.reject(`page '${m}' referenced in font file '${s}' was not found`))}static processPages(d,h){(0,a.logIf)(h.size!==1,a.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),(0,a.assert)(h.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const s=h.get(0);if(s)return d.glyphTexture.fetch(`${s}`,!0,!0).catch(()=>Promise.reject(`fetching page '0' from '${s}' failed`))}static processChar(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["id","x","y","width","height","xoffset","yoffset","xadvance"],s))return!1;const o=parseInt(s.get("id"),10);(0,a.logIf)(o<=0,a.LogLevel.Warning,`expected glyph index to be greater than 0, given ${o}`);const u=new r.Glyph;u.index=o;const m=[1/h.glyphTextureExtent[0],1/h.glyphTextureExtent[1]],v=[parseFloat(s.get("width")),parseFloat(s.get("height"))];return u.subTextureOrigin=[parseFloat(s.get("x"))*m[0],1-(parseFloat(s.get("y"))+v[1])*m[1]],u.extent=v,u.subTextureExtent[0]=v[0]*m[0],u.subTextureExtent[1]=v[1]*m[1],u.bearingFromFontBaseAndOffset(h.base,parseFloat(s.get("xoffset")),parseFloat(s.get("yoffset"))),u.advance=parseFloat(s.get("xadvance")),h.addGlyph(u),!0}static processKerning(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["first","second","amount"],s))return!1;const o=parseInt(s.get("first"),10);if(o<=0)return(0,a.log)(a.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${o}`),!1;const u=parseInt(s.get("second"),10);if(u<=0)return(0,a.log)(a.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${u}`),!1;const m=parseFloat(s.get("amount"));return h.setKerning(o,u,m),!0}static readKeyValuePairs(d,h,s){let o,u;for(const v of d){const _=v.split("=");o=_[0],u=_[1],s.set(o,u)}let m=!0;return h.forEach(v=>m=m&&s.has(v)),m||(0,a.log)(a.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${h}`),m}static findAscentAndDescentIfNoneProvided(d,h){if(d.ascent>0&&d.descent<0)return;d.ascent>0&&(d.descent=d.ascent-h),d.descent<0&&(d.ascent=d.descent-h);let s=Number.MIN_VALUE;for(const o of d.arrayOfGlyphIndices())d.glyph(o).extent[1]!==0&&(s=Math.max(d.glyph(o).bearing[1],s));d.ascent=s,d.descent=d.ascent-h,(0,a.log)(a.LogLevel.Debug,`ascent not specified, derived ${d.ascent} from maximum y-offset`)}static process(d,h,s,o,u=!1){const m=h.split(`
`),v=new Array;let _=!0;if(!u&&o){const g=this.processPages(d,o);g!==void 0&&v.push(g)}for(const g of m){let x=g.split(" ");const E=x[0];switch(x=x.slice(1),E){case"info":_=this.processInfo(x,d);break;case"common":_=this.processCommon(x,d);break;case"page":if(u||o)break;const w=this.processPage(x,d,s);w!==void 0&&v.push(w);break;case"char":_=this.processChar(x,d);break;case"kerning":this.processKerning(x,d)}if(_===!1)break}return c.findAscentAndDescentIfNoneProvided(d,d.size),d.size<=0&&(0,a.log)(a.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${d.size}`),Promise.all(v).then(()=>d)}}t.FontFaceLoader=c},2668:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Glyph=void 0;const a=i(2813);t.Glyph=class{constructor(r=0,c=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=r,this._advance=c}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(r){const c=this._kernings.get(r);return c!==void 0?c:0}setKerning(r,c){this._kernings.set(r,c)}set index(r){this._index=r}get index(){return this._index}set subTextureOrigin(r){this._subTextureOrigin=(0,a.clampf2)(r,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(r){this._subTextureExtent=(0,a.clampf2)(r,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(r){this._bearing=r}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(r,c,f){this._bearing[0]=c,this._bearing[1]=r-f}set extent(r){this._extent=r}get extent(){return this._extent}set advance(r){this._advance=r}get advance(){return this._advance}}},9495:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphVertices=void 0;class i{static concat(r){let c=0;r.forEach(h=>c+=h?h.length:0);const f=new i(c);let d=0;for(let h=0;h<r.length;++h){const s=r[h];s!==void 0&&s.length!==0&&(f._texCoords.set(s._texCoords,d*i.FLOATS_PER_TEXCOORD),f._origins.set(s._origins,d*i.FLOATS_PER_ORIGIN),f._tangents.set(s._tangents,d*i.FLOATS_PER_TANGENT),f._ups.set(s._ups,d*i.FLOATS_PER_UP),d+=s.length)}return f}constructor(r){const c=Math.max(0,r);this._texCoords=new Float32Array(c*i.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(c*i.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(c*i.FLOATS_PER_TANGENT),this._ups=new Float32Array(c*i.FLOATS_PER_UP)}shrink(r){const c=Math.max(0,r);if(this.length===c)return;const f=(d,h,s)=>new Float32Array(d.buffer.slice(0,h*d.BYTES_PER_ELEMENT*s),0,h*s);f(this._texCoords,c,i.FLOATS_PER_TEXCOORD),f(this._origins,c,i.FLOATS_PER_ORIGIN),f(this._ups,c,i.FLOATS_PER_TANGENT),f(this._tangents,c,i.FLOATS_PER_UP)}uvLowerLeft(r){const c=r*i.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(c,c+2)}uvUpperRight(r){const c=r*i.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(c,c+2)}origin(r){const c=r*i.FLOATS_PER_ORIGIN;return this._origins.subarray(c,c+i.FLOATS_PER_ORIGIN)}tangent(r){const c=r*i.FLOATS_PER_TANGENT;return this._tangents.subarray(c,c+i.FLOATS_PER_TANGENT)}up(r){const c=r*i.FLOATS_PER_UP;return this._ups.subarray(c,c+i.FLOATS_PER_UP)}get length(){return this._origins.length/i.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}t.GlyphVertices=i,i.FLOATS_PER_TEXCOORD=4,i.FLOATS_PER_ORIGIN=3,i.FLOATS_PER_TANGENT=3,i.FLOATS_PER_UP=3},1058:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=t.Text=t.Projected3DLabel=t.Position3DLabel=t.Position2DLabel=t.LabelRenderPass=t.LabelGeometry=t.Label=t.GlyphVertices=t.FontFace=void 0;var a=i(8296);Object.defineProperty(t,"FontFace",{enumerable:!0,get:function(){return a.FontFace}});var r=i(9495);Object.defineProperty(t,"GlyphVertices",{enumerable:!0,get:function(){return r.GlyphVertices}});var c=i(7188);Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return c.Label}});var f=i(4128);Object.defineProperty(t,"LabelGeometry",{enumerable:!0,get:function(){return f.LabelGeometry}});var d=i(265);Object.defineProperty(t,"LabelRenderPass",{enumerable:!0,get:function(){return d.LabelRenderPass}});var h=i(5035);Object.defineProperty(t,"Position2DLabel",{enumerable:!0,get:function(){return h.Position2DLabel}});var s=i(5036);Object.defineProperty(t,"Position3DLabel",{enumerable:!0,get:function(){return s.Position3DLabel}});var o=i(135);Object.defineProperty(t,"Projected3DLabel",{enumerable:!0,get:function(){return o.Projected3DLabel}});var u=i(7623);Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return u.Text}});var m=i(967);Object.defineProperty(t,"Typesetter",{enumerable:!0,get:function(){return m.Typesetter}})},7188:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;const a=i(3557),r=i(7564),c=i(3847),f=i(9495),d=i(7623);class h{static devicePixelRatio(){return window===void 0||typeof window.devicePixelRatio!="number"?1:window.devicePixelRatio}constructor(o,u,m){this._alignment=h.Alignment.Left,this._lineAnchor=h.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=h.Unit.World,this._color=new c.Color(h.DEFAULT_COLOR),this._altered=Object.assign(new r.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=h.Elide.None,this._ellipsis=h.DEFAULT_ELLIPSIS,this._text=o,this._type=u,this._staticTransform=a.mat4.create(),this._dynamicTransform=a.mat4.create(),this._extent=[0,0],m&&(this._fontFace=m)}vertices(){return new f.GlyphVertices(this.length+this.ellipsis.length)}charAt(o){return this._text.charAt(o)}charCodeAt(o){return this._text.charCodeAt(o)}lineFeedAt(o){return this.charAt(o)===this.lineFeed}kerningBefore(o){return o<1||o>this.length?NaN:this._fontFace.kerning(this.charCodeAt(o-1),this.charCodeAt(o))}kerningAfter(o){return o<0||o>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(o),this.charCodeAt(o+1))}advance(o){return o<0||o>this.length?NaN:this._fontFace.glyph(this.charCodeAt(o)).advance}toString(){return this._text instanceof d.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(o){this._altered.alter("text"),this._text=o}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof d.Text?this._text.lineFeed:d.Text.DEFAULT_LINE_FEED}set wrap(o){this._wrap=o}get wrap(){return this._wrap}set elide(o){this._elide=o}get elide(){return this._elide}set ellipsis(o){this._ellipsis!==o&&(this._ellipsis=o,this._elide!==h.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(o){this._lineWidth!==o&&(this._lineWidth=o,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(o){this._alignment!==o&&(this._alignment=o,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(o){this._lineAnchor!==o&&(this._lineAnchor=o,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(o){this._fontSize!==o&&(this._fontSize=o,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(o){this._fontSizeUnit!==o&&(this._fontSizeUnit=o,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(o){this._fontFace!==o&&(this._fontFace=o,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(o){this._color.equals(o)||(this._color=o,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(o){this._backgroundColor.equals(o)||(this._backgroundColor=o,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(o){a.mat4.equals(this._staticTransform,o)||(this._staticTransform=o,this._altered.alter("static"))}get staticTransform(){const o=this.fontSize/this._fontFace.size,u=a.mat4.create();return a.mat4.scale(u,this._staticTransform,a.vec3.fromValues(o,o,o)),u}set dynamicTransform(o){this._altered.alter("dynamic"),this._dynamicTransform=o}get dynamicTransform(){return this._dynamicTransform}set extent(o){this._extent=o}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return this._fontFace!==void 0&&this._fontFace.glyphTexture.valid&&this._text.length>0}}t.Label=h,h.DEFAULT_COLOR=[.1098,.4588,.7373,1],h.DEFAULT_ELLIPSIS="...",function(s){(function(o){o.Static="static",o.Dynamic="dynamic"})(s.Type||(s.Type={})),function(o){o.None="none",o.Left="left",o.Middle="middle",o.Right="right"}(s.Elide||(s.Elide={})),function(o){o.Left="left",o.Center="center",o.Right="right"}(s.Alignment||(s.Alignment={})),function(o){o.Top="top",o.Ascent="ascent",o.Center="center",o.Baseline="baseline",o.Descent="descent",o.Bottom="bottom"}(s.LineAnchor||(s.LineAnchor={})),function(o){o.World="world",o.Pixel="pixel",o.Mixed="mixed"}(s.Unit||(s.Unit={}))}(h||(t.Label=h={}))},4128:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelGeometry=void 0;const r=i(9504),c=i(7340),f=i(638),d=i(4127);class h extends f.Geometry{constructor(o,u){super(o,u),this._numberOfGlyphs=0,(0,r.assert)(o.isWebGL2||o.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),u=u!==void 0&&u!==""?u:this.constructor.name,this._vertices=new c.Buffer(o,`${u}VBO`),this._buffers.push(this._vertices),this._texCoords=new c.Buffer(o,`${u}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new c.Buffer(o,`${u}OriginVBO`),this._buffers.push(this._origins),this._tangents=new c.Buffer(o,`${u}TangentVBO`),this._buffers.push(this._tangents),this._ups=new c.Buffer(o,`${u}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const o=this.context.gl,u=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,o.FLOAT,!1,8,0,!0,!1),u.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,o.FLOAT,!1,16,0,!0,!1),u.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(o=0,u=1,m=2,v=3,_=4){this._vertexLocation=o,this._texCoordLocation=u,this._originLocation=m,this._tangentLocation=v,this._upLocation=_;const g=this.context.gl,x=super.initialize([g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER]);return this._vertices.data(h.VERTICES,g.STATIC_DRAW),x}update(o,u,m,v){this._numberOfGlyphs=o.length/3;const _=this.context.gl;this._texCoords.data(v,_.STATIC_DRAW),this._origins.data(o,_.STATIC_DRAW),this._tangents.data(u,_.STATIC_DRAW),this._ups.data(m,_.STATIC_DRAW)}draw(o=0,u=0){const m=this.context.gl,v=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,m.FLOAT,!1,16,16*o,!0,!1),this._origins.attribEnable(this._originLocation,3,m.FLOAT,!1,12,12*o,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,m.FLOAT,!1,12,12*o,!0,!1),this._ups.attribEnable(this._upLocation,3,m.FLOAT,!1,12,12*o,!0,!1),v.drawArraysInstanced(m.TRIANGLE_STRIP,0,4,u)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const o=this._vertices&&this._vertices.valid,u=this._texCoords&&this._texCoords.valid,m=this._origins&&this._origins.valid,v=this._tangents&&this._tangents.valid,_=this._ups&&this._ups.valid;return this.initialized&&o&&u&&m&&v&&_}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}t.LabelGeometry=h,h.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),a([d.Initializable.assert_initialized()],h.prototype,"draw",null)},265:function(p,t,i){var a=this&&this.__decorate||function(w,S,R,O){var I,D=arguments.length,j=D<3?S:O===null?O=Object.getOwnPropertyDescriptor(S,R):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(w,S,R,O);else for(var k=w.length-1;k>=0;k--)(I=w[k])&&(j=(D<3?I(j):D>3?I(S,R,j):I(S,R))||j);return D>3&&j&&Object.defineProperty(S,R,j),j};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelRenderPass=void 0;const r=i(3557),c=i(9504),f=i(7564),d=i(4127),h=i(4168),s=i(771),o=i(8593),u=i(9495),m=i(7188),v=i(4128),_=i(5035),g=i(5036),x=i(135);class E extends d.Initializable{constructor(S){super(),this._altered=Object.assign(new f.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=E.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=S,this._depthFunc=S.gl.LESS,this._program=new h.Program(S,"LabelRenderProgram"),this._geometry=new v.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=E.DEFAULT_AA_STEP_SCALE}prepare(){const S=this._camera.viewport;for(let O=0;O<this._labels.length;++O){const I=this._labels[O];let D;const j=this._altered.labels&&this._verticesPerLabel[O]===void 0;I instanceof _.Position2DLabel?(I.frameSize=S,D=I.typeset(j)):I instanceof x.Projected3DLabel?(I.camera=this._camera,D=I.typeset(j)):I instanceof g.Position3DLabel&&(D=I.typeset(j)),D===void 0?D=this._verticesPerLabel[O]:this._verticesPerLabel[O]=D;const k=O>0?this._ranges[O-1][1]:0,G=k+(D===void 0?0:D.length);this._ranges[O]=[k,G]}const R=u.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(R.origins,R.tangents,R.ups,R.texCoords)}draw(){const S=this._context.gl,R=[0,0];let O,I;const D=r.mat4.create();for(let j=0;j<this._labels.length;++j){const k=this._labels[j];if(R[1]=this._ranges[j][1],R[0]===R[1]||j<this._labels.length-1&&!k.valid)continue;const G=j<this._labels.length-1?this._labels[j+1]:void 0,Z=G&&k.type===m.Label.Type.Static&&G.type===m.Label.Type.Static,K=G&&k.color.equals(G.color),Y=G&&k.fontFace===G.fontFace,re=G&&k.fontSizeUnit===G.fontSizeUnit;if(G&&(this._ranges[j+1][0]===this._ranges[j+1][1]||Z&&K&&Y&&re))continue;const Q=k.type===m.Label.Type.Dynamic;switch(S.uniform1i(this._uDynamic,Q),Q&&S.uniformMatrix4fv(this._uTransform,!1,k.dynamicTransform),O!==void 0&&O.equals(k.color)||(S.uniform4fv(this._uColor,k.color.rgbaF32),O=k.color),I!==k.fontFace&&(k.fontFace.glyphTexture.bind(S.TEXTURE0),I=k.fontFace),k.fontSizeUnit){case m.Label.Unit.Pixel:S.uniformMatrix4fv(this._uViewProjection,!1,D);break;case m.Label.Unit.World:case m.Label.Unit.Mixed:default:S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(R[0],R[1]-R[0]),R[0]=R[1]}}initialize(){const S=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const R=new s.Shader(this._context,S.VERTEX_SHADER,"glyph.vert");R.initialize(i(1616));const O=new s.Shader(this._context,S.FRAGMENT_SHADER,"glyph.frag");return O.initialize(i(5389)),this._program.initialize([R,O],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),S.uniform1i(this._program.uniform("u_glyphs"),0),S.uniform1f(this._uAAStepScale,this._aaStepScale),S.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(S=!1){const R=this._context.gl;this._program.bind(),(S||this._altered.camera||this._camera.altered)&&R.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(S||this._altered.aaStepScale)&&R.uniform1f(this._uAAStepScale,this._aaStepScale),(S||this._altered.aaSampling)&&R.uniform1i(this._uAASampling,this._aaSampling);let O=S||this._altered.labels||this._altered.camera||this._camera.altered,I=0;for(;O===!1&&I<this._labels.length;)O=this._labels[I].altered,++I;O&&this.prepare(),this._altered.reset()}frame(){if(this._geometry.numGlyphs===0||this._labels.length===0)return;(0,c.assert)(this._target&&this._target.valid,"valid target expected");const S=this._context.gl,R=this._target.size;S.viewport(0,0,R[0],R[1]),S.enable(S.DEPTH_TEST),S.depthFunc(this._depthFunc),this._depthMask===!1&&S.depthMask(this._depthMask),S.enable(S.BLEND),S.blendFuncSeparate(S.SRC_ALPHA,S.ONE_MINUS_SRC_ALPHA,S.ONE,S.ONE_MINUS_SRC_ALPHA),this._program.bind(),S.uniform2fv(this._uNdcOffset,this._ndcOffset),S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),S.bindTexture(S.TEXTURE_2D,o.Texture2D.DEFAULT_TEXTURE),this._depthMask===!1&&S.depthMask(!0),S.depthFunc(S.LESS),S.disable(S.DEPTH_TEST),S.disable(S.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(S){this.assertInitialized(),this._target=S}set ndcOffset(S){this.assertInitialized(),this._ndcOffset=S}set camera(S){this.assertInitialized(),this._camera!==S&&(this._camera=S,this._altered.alter("camera"))}set depthMask(S){this._depthMask=S}get depthMask(){return this._depthMask}set depthFunc(S){this._depthFunc=S}get depthFunc(){return this._depthFunc}set labels(S){this._labels=S,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(S){this._aaStepScale!==S&&(this._aaStepScale=S,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(S){this._aaSampling!==S&&(this._aaSampling=S,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}t.LabelRenderPass=E,E.DEFAULT_AA_STEP_SCALE=.6666,a([d.Initializable.initialize()],E.prototype,"initialize",null),a([d.Initializable.uninitialize()],E.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],E.prototype,"update",null),a([d.Initializable.assert_initialized()],E.prototype,"frame",null),a([d.Initializable.assert_initialized()],E.prototype,"unbind",null),function(w){(function(S){S[S.None=0]="None",S[S.Smooth1=1]="Smooth1",S[S.Horizontal3=2]="Horizontal3",S[S.Vertical3=3]="Vertical3",S[S.Grid3x3=4]="Grid3x3",S[S.Grid4x4=5]="Grid4x4"})(w.Sampling||(w.Sampling={}))}(E||(t.LabelRenderPass=E={}))},5035:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position2DLabel=void 0;const a=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(u,m,v){super(u,m,v),this._position=a.vec2.fromValues(0,0),this._direction=a.vec2.fromValues(1,0),this._frameSize=a.vec2.create(),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Pixel}typeset(u=!1){const m=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!u)return;if(!this.valid)return new f.GlyphVertices(0);const v=a.vec4.create(),_=a.mat4.create();a.mat4.translate(_,(0,c.m4)(),a.vec3.fromValues(-1,-1,0)),a.mat4.scale(_,_,a.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const g=a.vec2.sub((0,c.v2)(),a.vec2.fromValues(this._frameSize[0],this._frameSize[1]),a.vec2.fromValues(v[3]+v[1],v[2]+v[0])),x=a.vec3.fromValues(.5*g[0],.5*g[1],0);a.vec3.add(x,x,a.vec3.fromValues(v[3],v[2],0)),a.mat4.translate(_,_,x),a.mat4.translate(_,_,a.vec3.fromValues(this._position[0],this._position[1],0));const E=a.vec2.fromValues(1,0);let w=a.vec2.angle(E,this._direction);switch(E[0]*this._direction[1]-E[1]*this._direction[0]<0&&(w=-w),a.mat4.rotateZ(_,_,w),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(_),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=a.mat4.clone(_)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const S=this.vertices();return h.Typesetter.typeset(this,S),S}set frameSize(u){a.vec2.equals(this._frameSize,u)||(a.vec2.max(this._frameSize,u,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(u){a.vec2.equals(this._position,u)||(this._position=a.vec2.clone(u),this._altered.alter(this._type))}get position(){return this._position}set direction(u){a.vec2.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(u){(0,r.logIf)(u!==d.Label.Unit.Pixel,r.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position2DLabel=s,s.DEFAULT_FONTSIZE_PX=20},5036:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position3DLabel=void 0;const a=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(u,m,v){super(u,m,v),this._position=a.vec3.fromValues(0,0,0),this._direction=a.vec3.fromValues(1,0,0),this._up=a.vec3.fromValues(0,1,0),this._fontSize=s.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=d.Label.Unit.World}typeset(u=!1){const m=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!u)return;if(!this.valid)return new f.GlyphVertices(0);const v=a.mat4.create();a.mat4.translate(v,(0,c.m4)(),this._position);const _=a.vec3.cross((0,c.v3)(),this._direction,this._up),g=a.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,_[0],_[1],_[2],0,0,0,0,1);switch(a.mat4.mul(v,v,g),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(v),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=a.mat4.clone(v)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const x=this.vertices();return h.Typesetter.typeset(this,x),x}set position(u){this._position=a.vec3.clone(u),this._altered.alter(this._type)}get position(){return this._position}set direction(u){a.vec3.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set up(u){this._up=a.vec3.normalize(this._up,u),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(u){(0,r.logIf)(u!==d.Label.Unit.World,r.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position3DLabel=s,s.DEFAULT_FONTSIZE_WORLD=.05},135:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Projected3DLabel=void 0;const a=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(u,m,v){super(u,m,v),this._position=a.vec3.fromValues(0,0,0),this._direction=a.vec2.fromValues(1,0),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Mixed}typeset(u=!1){const m=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!u)return;if(!this.valid||this._camera===void 0)return new f.GlyphVertices(0);const v=a.vec4.create(),_=a.mat4.create();a.mat4.translate(_,_,a.vec3.fromValues(-1,-1,0)),a.mat4.scale(_,_,a.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),a.mat4.scale(_,_,a.vec3.fromValues(1,1,1));const g=a.vec2.create();a.vec2.sub(g,a.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),a.vec2.fromValues(v[3]+v[1],v[2]+v[0]));const x=a.vec3.fromValues(.5*g[0],.5*g[1],0);a.vec3.add(x,x,a.vec3.fromValues(v[3],v[2],0)),a.mat4.translate(_,_,x);const E=a.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);a.vec4.transformMat4(E,E,this._camera.viewProjection);const w=a.mat4.create(),S=E[3];a.mat4.translate(w,w,a.vec3.fromValues(E[0]/S,E[1]/S,E[2]/S)),a.mat4.mul(_,w,_);const R=a.vec2.fromValues(1,0);let O=a.vec2.angle(R,this._direction);switch(R[0]*this._direction[1]-R[1]*this._direction[0]<0&&(O=-O),a.mat4.rotateZ(_,_,O),this._camera.viewProjectionInverse?a.mat4.mul(_,this._camera.viewProjectionInverse,_):(0,r.log)(r.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(_),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=a.mat4.clone(_)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const I=this.vertices();return h.Typesetter.typeset(this,I),I}set camera(u){this._camera=u,this._altered.alter(this._type)}get camera(){return this._camera}set position(u){this._position=a.vec3.clone(u),this._altered.alter(this._type)}get position(){return this._position}set direction(u){a.vec2.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(u){(0,r.logIf)(u!==d.Label.Unit.Mixed,r.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Projected3DLabel=s,s.DEFAULT_FONTSIZE_PX=20},7623:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;class i{constructor(r,c){this._lineFeed=i.DEFAULT_LINE_FEED,this._altered=!1,this._text=r||"",this._lineFeed=c!==void 0?c:this._lineFeed}get length(){return this._text.length}charAt(r){return this._text.charAt(r)}charCodeAt(r){return this._text.charCodeAt(r)}set text(r){this._text!==r&&(this._altered=!0,this._text=r)}get text(){return this._text}set lineFeed(r){this._lineFeed!==r&&(this._altered=!0,this._lineFeed=r)}get lineFeed(){return this._lineFeed}set altered(r){this._altered=r}get altered(){return this._altered}}t.Text=i,i.DEFAULT_LINE_FEED=`
`},967:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=void 0;const a=i(3557),r=i(9504),c=i(5150),f=i(7188);class d{static writeVertex(s,o,u,m,v){if(m===void 0||u.depictable()===!1)return;const _=s.glyphTexturePadding,g=m.origin(v);a.vec3.set(g,o[0],o[1],0),g[0]+=u.bearing[0]-_[3],g[1]+=u.bearing[1]-u.extent[1],a.vec3.set(m.tangent(v),u.extent[0],0,0),a.vec3.set(m.up(v),0,u.extent[1],0);const x=m.uvLowerLeft(v);a.vec2.copy(x,u.subTextureOrigin);const E=m.uvUpperRight(v);a.vec2.add(E,u.subTextureOrigin,u.subTextureExtent)}static lineAnchorOffset(s){let o=0;const u=s.fontFace.glyphTexturePadding,m=s.fontFace;switch(s.lineAnchor){case f.Label.LineAnchor.Ascent:o=m.ascent-u[0];break;case f.Label.LineAnchor.Descent:o=m.descent*(1+u[0]/m.ascent);break;case f.Label.LineAnchor.Center:o=m.ascent-u[0]-.5*m.size;break;case f.Label.LineAnchor.Top:o=m.ascent-u[0]+.5*m.lineGap;break;case f.Label.LineAnchor.Bottom:o=m.ascent-u[0]+.5*m.lineGap-m.lineHeight;break;case f.Label.LineAnchor.Baseline:default:o=-u[0]}return o}static advances(s,o){(0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve advances"),o===void 0&&(o=s.text.text);const u=new Float32Array(o.length);for(let m=0;m<o.length;++m){const v=o.charCodeAt(m);u[m]=s.fontFace.glyph(v).advance}return u}static kernings(s,o){if((0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve kernings"),o===void 0){const v=new Float32Array(s.length);for(let _=0;_<s.length;++_){const g=s.kerningAfter(_);v[_]=isNaN(g)?0:g}return v}const u=new Float32Array(o.length);for(let v=0;v<o.length;++v){const _=(m=v)<0||m>o.length-1?NaN:s.fontFace.kerning(o.charCodeAt(m),o.charCodeAt(m+1));u[v]=isNaN(_)?0:_}var m;return u}static fragments(s){const o=new Array;let u,m=0;for(let v=0;v<s.length;++v){if(u=d.DELIMITERS.indexOf(s.charAt(v))>-1,!u)continue;m<v&&o.push([m,v,d.FragmentType.Word]);const _=s.lineFeedAt(v)?d.FragmentType.LineFeed:d.FragmentType.Delimiter;o.push([v,v+1,_]),m=v+1}return u||o.push([m,s.length,d.FragmentType.Word]),o}static fragmentWidths(s,o,u){const m=new Float32Array(s.length);for(let v=0;v<s.length;++v){const _=s[v];m[v]=o.subarray(_[0],_[1]).reduce((g,x,E)=>g+x+(E<_[1]?u[E+_[0]]:0),0)}return m}static elideThresholds(s,o){switch(s.elide){case f.Label.Elide.Right:return[s.lineWidth-o,0];case f.Label.Elide.Middle:const u=s.lineWidth/2-o/2;return[u,u];case f.Label.Elide.Left:return[0,s.lineWidth-o];default:return[0,0]}}static elideFragments(s,o,u,m,v,_){const g=new Array,x=new Array;let E=0,w=0;for(let S=_?o.length-1:0;_?S>-1:S<o.length;_?--S:++S){const R=o[S];if(R[2]!==d.FragmentType.LineFeed){if(!(E+u[S]<s)){if(R[2]===d.FragmentType.Delimiter||E+m[_?R[1]-1:R[0]]>s)break;for(let O=_?R[1]-1:R[0];_?O>=R[0]:O<R[1];_?--O:++O){if(!(E+w+m[O]+v[O]<s)){g.push([_?O+1:R[0],_?R[1]:O,R[2]]),x.push(w);break}w+=m[O]+v[O]}break}E+=u[S],g.push(R),x.push(u[S])}}return[g,x,E+w]}static transformVertices(s,o,u,m){if(o!==void 0&&!a.mat4.equals(s,a.mat4.create()))for(let v=u;v<m;++v){const _=o.origin(v),g=(0,c.v3)();a.vec3.transformMat4(g,_,s);const x=(0,c.v3)();a.vec3.transformMat4(x,a.vec3.add(x,_,o.tangent(v)),s);const E=(0,c.v3)();a.vec3.transformMat4(E,a.vec3.add(E,_,o.up(v)),s),a.vec3.copy(o.origin(v),g),a.vec3.sub(o.tangent(v),x,g),a.vec3.sub(o.up(v),E,g)}}static updateRectangleMinMax(s,o){(0,r.assert)(s.length===6&&o.length===6,"expected the rectangles to have 6 values!");let u=0;for(;u<3;u++)s[u]=Math.min(s[u],o[u]);for(;u<6;u++)s[u]=Math.max(s[u],o[u])}static minMax(s,o,u){const m=Math.min(s,...u),v=Math.max(o,...u);return a.vec2.fromValues(m,v)}static getMinMaxVertices(s,o,u){let m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,_=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(let w=o;w<u;++w){const S=d.minMax(m,v,[s.origin(w)[0],s.origin(w)[0]+s.up(w)[0],s.origin(w)[0]+s.tangent(w)[0]]);m=S[0],v=S[1];const R=d.minMax(_,g,[s.origin(w)[1],s.origin(w)[1]+s.up(w)[1],s.origin(w)[1]+s.tangent(w)[1]]);_=R[0],g=R[1];const O=d.minMax(x,E,[s.origin(w)[2],s.origin(w)[2]+s.up(w)[2],s.origin(w)[2]+s.tangent(w)[2]]);x=O[0],E=O[1]}return[m,_,x,v,g,E]}static transformAlignment(s,o,u,m,v){if(u===void 0||o===f.Label.Alignment.Left)return;let _=-s;o===f.Label.Alignment.Center&&(_*=.5);for(let g=m;g<v;++g)u.origin(g)[0]+=_}static transform(s,o,u){const m=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const S of u)d.transformAlignment(S[2],s.alignment,o,S[0],S[1]),d.updateRectangleMinMax(m,d.getMinMaxVertices(o,S[0],S[1])),d.transformVertices(s.staticTransform,o,S[0],S[1]);const v=m[3]-m[0],_=m[4]-m[1],g=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(0,0,0,1),s.staticTransform),x=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(v,0,0,1),s.staticTransform),E=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(0,_,0,1),s.staticTransform),w=a.vec2.fromValues(a.vec4.distance(x,g),a.vec4.distance(E,g));s.extent=[w[0],w[1]]}static typeset(s,o){if(s.length===0)return 0;(0,r.assert)(s.fontFace!==void 0,"expected a font face for label before typesetting");const u=s.fontFace,m=D=>D<s.length?u.glyph(s.charCodeAt(D)):u.glyph(s.ellipsis.charCodeAt(D-s.length)),v=d.advances(s),_=d.kernings(s),g=d.fragments(s),x=d.fragmentWidths(g,v,_),E=a.vec2.fromValues(0,-d.lineAnchorOffset(s)),w=new Array;let S=0;const R=s.elide!==f.Label.Elide.None,O=(D,j,k=NaN,G=v,Z=_,K=0)=>{let Y=S;for(let re=0;re<D.length;++re){const Q=D[re];if(Q[0]>=Q[1])continue;const ae=!R&&Q[2]===d.FragmentType.LineFeed;let se=!1;if(!R&&!ae&&s.wrap){const ee=Q[2]!==d.FragmentType.Delimiter||m(Q[0]).depictable(),le=Q[2]===d.FragmentType.Word&&re<D.length-1&&D[re+1][2]===d.FragmentType.Delimiter&&m(D[re+1][0]).depictable();se=E[0]+(ee?j[re]:0)+(le?j[re+1]:0)>s.lineWidth}if(!ae&&!se||(w.push([Y,S,E[0]]),Y=S,E[0]=0,E[1]-=u.lineHeight,!ae))for(let ee=Q[0];ee<Q[1];++ee)m(ee).depictable()&&(d.writeVertex(u,E,m(ee),o,S),++S),E[0]+=G[ee-K]+Z[ee-K]}Y<S&&w.push([Y,S,E[0]])},I=x.reduce((D,j)=>D+j,0);if(R&&I>s.lineWidth){const D=[[s.length,s.length+s.ellipsis.length,d.FragmentType.Word]],j=d.advances(s,s.ellipsis),k=d.kernings(s,s.ellipsis),G=d.fragmentWidths([[0,s.ellipsis.length,d.FragmentType.Word]],j,k),Z=G[0];if(s.lineWidth<Z)return 0;const K=d.elideThresholds(s,Z),[Y,re,Q]=d.elideFragments(K[0],g,x,v,_,!1);s.elide===f.Label.Elide.Middle&&(K[1]+=K[0]-Q);const[ae,se]=d.elideFragments(K[1],g,x,v,_,!0);O(Y,new Float32Array(re)),O(D,G,NaN,j,k,s.length),O(ae.reverse(),new Float32Array(se.reverse())),(0,r.assert)(w.length<4,`expected at most 3-line-yield from advance, given ${w}`),w[0][1]=w[w.length-1][1],w[0][2]=E[0],w.length=1}else O(g,x,s.lineWidth);return d.transform(s,o,w),o.shrink(S),S}}t.Typesetter=d,d.DELIMITERS=`
 ,.-/()[]<>`,function(h){(function(s){s[s.Word=0]="Word",s[s.Delimiter=1]="Delimiter",s[s.LineFeed=2]="LineFeed"})(h.FragmentType||(h.FragmentType={}))}(d||(t.Typesetter=d={}))},8593:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2D=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(o,u,m,v,_){(0,r.assert)(o>0&&u>0,"texture requires valid width and height of greater than zero");const g=this._context.gl,x=this._context.gl2facade;if(this._object=g.createTexture(),this._width=o,this._height=u,this._internalFormat=m,this._format=v,this._type=_,g.bindTexture(g.TEXTURE_2D,this._object),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),h.MAX_ANISOTROPY===void 0)if(this._context.supportsTextureFilterAnisotropic){const E=this._context.textureFilterAnisotropic;h.MAX_ANISOTROPY=g.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else h.MAX_ANISOTROPY=0;return x.texImage2D(g.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),g.bindTexture(g.TEXTURE_2D,h.DEFAULT_TEXTURE),this._valid=g.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let m=this._width*this._height*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D,h.DEFAULT_TEXTURE)}fetch(o,u=!1,m=!1){const v=this.context.gl;return new Promise((_,g)=>{const x=new Image;x.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${x.src}' failed`),g()},x.onload=()=>{this.resize(x.width,x.height),m||v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data(x),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),_()},u&&(x.crossOrigin="anonymous"),x.src=o})}data(o,u=!0,m=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage2D(v.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,o),this._anisotropy!==void 0&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),m&&this.unbind(),this.reallocate()}filter(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),(0,r.logIf)(o===_.LINEAR_MIPMAP_LINEAR||o===_.LINEAR_MIPMAP_NEAREST,r.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u),this._mipmap=u===_.LINEAR_MIPMAP_LINEAR||u===_.LINEAR_MIPMAP_NEAREST,this._mipmap&&_.generateMipmap(_.TEXTURE_2D),v&&this.unbind()}wrap(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,u),v&&this.unbind()}reformat(o,u,m,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),m&&(this._type=m),this.data(void 0,v,_))}resize(o,u,m=!0,v=!0){o===this._width&&u===this._height||(this._width=o,this._height=u,this.data(void 0,m,v))}generateMipMap(o=!0,u=!0){const m=this.context.gl;o&&this.bind(),m.generateMipmap(m.TEXTURE_2D),u&&this.unbind(),this._mipmap=!0}maxAnisotropy(o,u=!0,m=!0){if(this._context.supportsTextureFilterAnisotropic===!1)return void(0,r.log)(r.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const v=this.context.gl,_=this._context.textureFilterAnisotropic;return this._anisotropy=o===void 0?void 0:Math.max(0,Math.min(h.MAX_ANISOTROPY,o)),(0,r.logIf)(o!==this._anisotropy,r.LogLevel.Debug,`value clamped to max supported anisotropy of ${h.MAX_ANISOTROPY}, given ${o}`),u&&this.bind(),v.texParameterf(v.TEXTURE_2D,_.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy===void 0?0:this._anisotropy),this.generateMipMap(!1,m),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}t.Texture2D=h,h.DEFAULT_TEXTURE=void 0,h.MAX_ANISOTROPY=void 0,a([f.Initializable.assert_initialized()],h.prototype,"bind",null),a([f.Initializable.assert_initialized()],h.prototype,"unbind",null),a([f.Initializable.assert_initialized()],h.prototype,"fetch",null),a([f.Initializable.assert_initialized()],h.prototype,"data",null),a([f.Initializable.assert_initialized()],h.prototype,"filter",null),a([f.Initializable.assert_initialized()],h.prototype,"wrap",null),a([f.Initializable.assert_initialized()],h.prototype,"reformat",null),a([f.Initializable.assert_initialized()],h.prototype,"resize",null)},7380:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2DArray=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,u,m,v,_,g){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(o>0&&u>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=u,this._depth=m,this._internalFormat=v,this._format=_,this._type=g,x.bindTexture(x.TEXTURE_2D_ARRAY,this._object),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_2D_ARRAY,h.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D_ARRAY,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D_ARRAY,h.DEFAULT_TEXTURE)}fetch(o,u,m=!1){return new Promise((v,_)=>{const g=new Image;g.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${g.src}' failed`),_()},g.onload=()=>{this.resize(g.width,g.height/u,u),this.data(g),v()},m&&(g.crossOrigin="anonymous"),g.src=o})}data(o,u=!0,m=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage3D(v.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),m&&this.unbind(),this.reallocate()}filter(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_2D_ARRAY,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D_ARRAY,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,m,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_T,u),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_R,m),_&&this.unbind()}reformat(o,u,m,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),m&&(this._type=m),this.data(void 0,v,_))}resize(o,u,m,v=!0,_=!0){o===this._width&&u===this._height&&m===this._depth||(this._width=o,this._height=u,this._depth=m,this.data(void 0,v,_))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture2DArray=h,h.DEFAULT_TEXTURE=void 0,a([f.Initializable.assert_initialized()],h.prototype,"bind",null),a([f.Initializable.assert_initialized()],h.prototype,"unbind",null),a([f.Initializable.assert_initialized()],h.prototype,"fetch",null),a([f.Initializable.assert_initialized()],h.prototype,"data",null),a([f.Initializable.assert_initialized()],h.prototype,"filter",null),a([f.Initializable.assert_initialized()],h.prototype,"wrap",null),a([f.Initializable.assert_initialized()],h.prototype,"reformat",null),a([f.Initializable.assert_initialized()],h.prototype,"resize",null)},9584:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture3D=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,u,m,v,_,g){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(o>0&&u>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=u,this._depth=m,this._internalFormat=v,this._format=_,this._type=g,x.bindTexture(x.TEXTURE_3D,this._object),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_3D,h.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_3D,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_3D,h.DEFAULT_TEXTURE)}load(o,u,m=!1,v=!1){return new Promise((_,g)=>{const x=new Image;x.onerror=()=>g(),x.onload=()=>{const E=document.createElement("canvas"),w=E.getContext("2d");let S,R,O,I;if((0,r.assert)(w!==void 0,"expected auxiliary 2D context for temporary slicing"),v===!1){(0,r.assert)(x.height%u==0&&x.height/u>=1,"expected height to be a multitude of number of slices"),S=x.width,R=Math.floor(x.height/u),O=u,E.width=S,E.height=R,I=new Uint8Array(S*R*O);const D=S*R;for(let j=0;j<u;++j){w.drawImage(x,0,R*j,S,R,0,0,S,R);const k=w.getImageData(0,0,S,R).data;for(let G=0;G<D;++G)I[D*j+G]=k[4*G]}}else{(0,r.assert)(x.width%u==0&&x.width/u>=1,"expected width to be a multitude of number of slices"),S=Math.floor(x.width/u),R=x.height,O=u,E.width=S,E.height=R,I=new Uint8Array(S*R*O);const D=S*R;for(let j=0;j<u;++j){w.drawImage(x,S*j,0,S,R,0,0,S,R);const k=w.getImageData(0,0,S,R).data;for(let G=0;G<D;++G)I[D*j+G]=k[4*G]}}this.resize(S,R,O),this.data(I),_()},m&&(x.crossOrigin="anonymous"),x.src=o})}loadFromSingleImages(o,u,m=!1,v=!1){return new Promise((_,g)=>{const x=document.createElement("canvas"),E=x.getContext("2d"),w=[];let S,R;for(let O=0;O<o.length;O++){const I=new Image;I.onerror=()=>g();const D=new Promise((j,k)=>{try{I.onload=()=>{const G=I.width,Z=I.height;v===!1?(S===void 0?(S=G*o.length,x.width=S):(0,r.assert)(G*o.length===S,"The single images do not have the same width"),R===void 0?(R=Z,x.height=R):(0,r.assert)(Z===R,"The single images do not have the same height"),E.drawImage(I,G*O,0)):(S===void 0?(S=G,x.width=S):(0,r.assert)(G===S,"The single images do not have the same width"),R===void 0?(R=Z*o.length,x.height=R):(0,r.assert)(Z*o.length===R,"The single images do not have the same height"),E.drawImage(I,0,Z*O)),j()}}catch(G){k(G)}});w.push(D),m&&(I.crossOrigin="anonymous"),I.src=o[O]}Promise.all(w).then(()=>{const O=x.toDataURL("image/png",1);return this.load(O,u,m,v).then(()=>{_()})})})}data(o,u=!0,m=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage3D(v.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),m&&this.unbind(),this.reallocate()}filter(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,m,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_T,u),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_R,m),_&&this.unbind()}reformat(o,u,m,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),m&&(this._type=m),this.data(void 0,v,_))}resize(o,u,m,v=!0,_=!0){o===this._width&&u===this._height&&m===this._depth||(this._width=o,this._height=u,this._depth=m,this.data(void 0,v,_))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture3D=h,h.DEFAULT_TEXTURE=void 0,a([f.Initializable.assert_initialized()],h.prototype,"bind",null),a([f.Initializable.assert_initialized()],h.prototype,"unbind",null),a([f.Initializable.assert_initialized()],h.prototype,"load",null),a([f.Initializable.assert_initialized()],h.prototype,"loadFromSingleImages",null),a([f.Initializable.assert_initialized()],h.prototype,"data",null),a([f.Initializable.assert_initialized()],h.prototype,"filter",null),a([f.Initializable.assert_initialized()],h.prototype,"wrap",null),a([f.Initializable.assert_initialized()],h.prototype,"reformat",null),a([f.Initializable.assert_initialized()],h.prototype,"resize",null)},5186:function(p,t,i){var a=this&&this.__decorate||function(s,o,u,m){var v,_=arguments.length,g=_<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureCube=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(o){const u=this._context.gl;switch(o){case u.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case u.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case u.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case u.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case u.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case u.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return(0,r.assert)(!1,`expected texture cube map identifier (${u.TEXTURE_CUBE_MAP_POSITIVE_X}, ${u.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${u.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${u.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${u.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${u.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${o}`),-1}}create(o,u,m,v){(0,r.assert)(o>0,"texture cube requires valid size (width/height) of greater than zero");const _=this._context.gl,g=this._context.gl2facade;return this._object=_.createTexture(),this._size=o,this._internalFormat=u,this._format=m,this._type=v,_.bindTexture(_.TEXTURE_CUBE_MAP,this._object),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),_.bindTexture(_.TEXTURE_CUBE_MAP,h.DEFAULT_TEXTURE),this._valid=_.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(o,u,m,v,_){const g=document.createElement("canvas");g.width=v,g.height=_;const x=g.getContext("2d");return x?(x.drawImage(o,u,m,v,_,0,0,v,_),x.getImageData(0,0,v,_)):(console.log(r.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(o,u){const m=this.context.gl,v=o.height/2*Math.pow(.5,u),_=[0,0],g=[o.width,o.height];for(let I=0;I<u;++I)g[0]/=2,g[1]/=2,_[0]+=g[0],_[1]+=g[1];m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!0);const x=this.cropImage(o,_[0],_[1],v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_X,x],u);const E=this.cropImage(o,_[0]+v,_[1],v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Z,E],u);const w=this.cropImage(o,_[0]+2*v,_[1],v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_X,w],u);const S=this.cropImage(o,_[0]+3*v,_[1],v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Z,S],u);const R=this.cropImage(o,_[0],_[1]+v,v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Y,R],u);const O=this.cropImage(o,_[0]+v,_[1]+v,v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Y,O],u),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_CUBE_MAP,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_CUBE_MAP,h.DEFAULT_TEXTURE)}fetch(o,u=!1,m=0){const v=this.context.gl;return new Promise((_,g)=>{const x=new Array;o.positiveX&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_X,o.positiveX]),o.negativeX&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_X,o.negativeX]),o.positiveY&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Y,o.positiveY]),o.negativeY&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Y,o.negativeY]),o.positiveZ&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Z,o.positiveZ]),o.negativeZ&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Z,o.negativeZ]);let E=x.length;for(const w of x){const S=new Image;S.crossOrigin="anonymous",S.onerror=()=>g(),S.onload=()=>{const R=this.calculateMipLevelSize(m);S.width===S.height?S.width===R?(v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data([w[0],S],m),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),E-=1,E===0&&_()):(0,r.log)(r.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${R}, given ${S.width}`):(0,r.log)(r.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},u&&(S.crossOrigin="anonymous"),S.src=w[1]}})}fetchMipmapAtlas(o,u=!1){return new Promise((m,v)=>{const _=new Image;_.onerror=()=>v(),_.onload=()=>{if(_.width!==2*_.height)return void(0,r.log)(r.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const g=_.height/2,x=Math.log2(g);for(let E=0;E<x;++E)this.extractMipLevelFromAtlas(_,E);m()},u&&(_.crossOrigin="anonymous"),_.src=o})}calculateMipLevelSize(o){return this._size*Math.pow(.5,o)}data(o,u=0,m=!0,v=!0){const _=this.context.gl,g=this.context.gl2facade,x=this.calculateMipLevelSize(u);let E=x*x*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?E*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(E*=4),m&&this.bind(),o instanceof Array&&o.length===2){g.texImage2D(o[0],u,this._internalFormat,x,x,0,this._format,this._type,o[1]);const w=this.faceID(o[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[w]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[w]=E}else{const w=o;w.positiveX!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X,u,this._internalFormat,x,x,0,this._format,this._type,w.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[0]=E),w.negativeX!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_X,u,this._internalFormat,x,x,0,this._format,this._type,w.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[1]=E),w.positiveY!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Y,u,this._internalFormat,x,x,0,this._format,this._type,w.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[2]=E),w.negativeY!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,u,this._internalFormat,x,x,0,this._format,this._type,w.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[3]=E),w.positiveZ!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Z,u,this._internalFormat,x,x,0,this._format,this._type,w.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[4]=E),w.negativeZ!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,u,this._internalFormat,x,x,0,this._format,this._type,w.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[5]=E)}v&&this.unbind()}filter(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_T,u),v&&this.unbind()}levels(o,u,m=!0,v=!0){const _=this.context.gl;m&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_BASE_LEVEL,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAX_LEVEL,u),v&&this.unbind()}reformat(o,u,m,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),m&&(this._type=m),this.data({clearOnUndefined:!0},0,v,_))}resize(o,u=!0,m=!0){o!==this._size&&(this._size=o,this.data({clearOnUndefined:!0},0,u,m))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}t.TextureCube=h,h.DEFAULT_TEXTURE=void 0,a([f.Initializable.assert_initialized()],h.prototype,"bind",null),a([f.Initializable.assert_initialized()],h.prototype,"unbind",null),a([f.Initializable.assert_initialized()],h.prototype,"fetch",null),a([f.Initializable.assert_initialized()],h.prototype,"fetchMipmapAtlas",null),a([f.Initializable.assert_initialized()],h.prototype,"data",null),a([f.Initializable.assert_initialized()],h.prototype,"filter",null),a([f.Initializable.assert_initialized()],h.prototype,"wrap",null),a([f.Initializable.assert_initialized()],h.prototype,"levels",null),a([f.Initializable.assert_initialized()],h.prototype,"reformat",null),a([f.Initializable.assert_initialized()],h.prototype,"resize",null)},5608:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TileCameraGenerator=void 0;const a=i(3557),r=i(5150),c=i(9504);class f{constructor(){this._tileSize=[0,0],this._padding=a.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=f.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(h,s,o,u,m,v,_,g,x,E,w){if(E>0)return w=this.hilbertIndices(h,s,o,u,m,g/2,x/2,v/2,_/2,E-1,w),w=this.hilbertIndices(h,s,o,u+v/2,m+_/2,v/2,_/2,g/2,x/2,E-1,w),w=this.hilbertIndices(h,s,o,u+v/2+g/2,m+_/2+x/2,v/2,_/2,g/2,x/2,E-1,w),this.hilbertIndices(h,s,o,u+v/2+g,m+_/2+x,-g/2,-x/2,-v/2,-_/2,E-1,w);if(m+=(_+x-1)/2,(u+=(v+g-1)/2)<s&&m<o){const S=2*w;h[S+0]=u,h[S+1]=m,++w}return w}static generateHilbertIndices(h,s,o){(0,c.assert)(h.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${h.length}`);const u=Math.max(s,o),m=Math.ceil(Math.log2(u)),v=(0,c.upperPowerOfTwo)(u);this.hilbertIndices(h,s,o,0,0,v,0,0,v,m,0)}static generateScanLineIndices(h,s,o){(0,c.assert)(h.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${h.length}`);for(let u=0;u<o;++u)for(let m=0;m<s;++m){const v=2*(m+u*s);h[v+0]=m,h[v+1]=u}}static generateZCurveIndices(h,s,o){(0,c.assert)(h.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${h.length}`);const u=Math.max(s,o),m=2*Math.floor(Math.log2(u));let v=0;for(let _=0;_<s*o;++v){let g=0,x=0;for(let E=0;E<m;++E)g+=(v>>2*E&1)<<E,x+=(v>>2*E+1&1)<<E;if(g<s&&x<o){const E=2*_;h[E+0]=g,h[E+1]=x,++_}}}invalidate(h){h&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case f.Algorithm.ScanLine:f.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case f.Algorithm.HilbertCurve:f.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case f.Algorithm.ZCurve:f.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:f.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const h=2*this.tile;return[this._indices[h+0],this._indices[h+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){(0,c.assert)(this._sourceCamera!==void 0,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return(0,c.log)(c.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;(0,c.assert)(this._sourceViewport!==void 0&&this._sourceCamera!==void 0,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const h=this.tableIndices(),s=this.sourceViewport,o=this.getPaddedTileSize(),u=[0,0];u[0]=h[0]*this.tileSize[0]+o[0]/2,u[1]=h[1]*this.tileSize[1]+o[1]/2;const m=[0,0];m[0]=h[0]*this.tileSize[0],m[1]=h[1]*this.tileSize[1];const v=[2*u[0]/s[0]-1,2*u[1]/s[1]-1],_=a.vec3.fromValues(s[0]/o[0],s[1]/o[1],1),g=a.vec3.fromValues(-v[0],-v[1],0),x=a.mat4.scale((0,r.m4)(),a.mat4.identity((0,r.m4)()),_),E=a.mat4.translate((0,r.m4)(),x,g);return this._camera.postViewProjection=E,this._offset=m,m}get valid(){return this._camera!==void 0&&this._sourceCamera!==void 0&&this._valid}get numXTiles(){return(0,c.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return(0,c.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(h){h!==void 0?(this._sourceCamera=h,this._camera=Object.create(h),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(h){this._tile!==h&&(this._tile=h,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(h){this._sourceViewport!==void 0&&h!==void 0&&this._sourceViewport[0]===h[0]&&this._sourceViewport[1]===h[1]||(this._sourceViewport=h,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(h){this._tileSize[0]===h[0]&&this._tileSize[1]===h[1]||(this._tileSize=h,this.invalidate(!0))}get padding(){return this._padding}set padding(h){a.vec4.equals(this._padding,h)||(this._padding=a.vec4.clone(h),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(h){this._algorithm!==h&&(this._algorithm=h,this.invalidate(!0))}}t.TileCameraGenerator=f,function(d){(function(h){h.ScanLine="scanline",h.HilbertCurve="hilbertcurve",h.ZCurve="zcurve"})(d.Algorithm||(d.Algorithm={}))}(f||(t.TileCameraGenerator=f={}))},8870:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TouchEventProvider=void 0;const a=i(7032),r=i(9504);class c{constructor(d,h){(0,r.assert)(d!==void 0,`expected valid canvas element on initialization, given ${d}`),this._element=d,this._timeframe=h}preventDefaultOnEvent(d,h){(0,r.bitInBitfield)(this._preventDefaultMask,d)&&h.preventDefault()}preventDefault(...d){for(const h of d)(0,r.bitInBitfield)(this._preventDefaultMask,h)||(this._preventDefaultMask|=h)}allowDefault(...d){for(const h of d)(0,r.bitInBitfield)(this._preventDefaultMask,h)&&(this._preventDefaultMask&=~h)}observable(d){switch(d){case c.Type.Start:return this.start$;case c.Type.End:return this.end$;case c.Type.Move:return this.move$;case c.Type.Cancel:return this.cancel$}return(0,r.assert)(!1,"Encountered unknown touch event."),new a.Observable}get start$(){return this._startSubject===void 0&&(this._startSubject=new a.ReplaySubject(void 0,this._timeframe),this._startListener=d=>{this.preventDefaultOnEvent(c.Type.Start,d),this._startSubject.next(d)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return this._endSubject===void 0&&(this._endSubject=new a.ReplaySubject(void 0,this._timeframe),this._endListener=d=>{this.preventDefaultOnEvent(c.Type.End,d),this._endSubject.next(d)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=d=>{this.preventDefaultOnEvent(c.Type.Move,d),this._moveSubject.next(d)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new a.ReplaySubject(void 0,this._timeframe),this._cancelListener=d=>{this.preventDefaultOnEvent(c.Type.Cancel,d),this._cancelSubject.next(d)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.TouchEventProvider=c,function(f){(function(d){d[d.Start=1]="Start",d[d.End=2]="End",d[d.Move=4]="Move",d[d.Cancel=8]="Cancel"})(f.Type||(f.Type={}))}(c||(t.TouchEventProvider=c={}))},3151:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrackballModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=a.mat4.create(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){this._initialPoint=h}process(h){this._currentPoint=h;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),a.vec2.copy(this._initialPoint,this._currentPoint);const o=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(o,o);const u=a.vec3.normalize((0,r.v3)(),this._reference.up),m=a.vec3.cross((0,r.v3)(),o,u);a.vec3.scale(u,u,s[1]),a.vec3.scale(m,m,s[0]);const v=a.vec3.cross((0,r.v3)(),a.vec3.add((0,r.v3)(),u,m),o);a.vec3.normalize(v,v);const _=a.quat.setAxisAngle(a.quat.create(),v,a.vec2.len(s));a.mat4.multiply(this._rotation,this._rotation,a.mat4.fromQuat((0,r.m4)(),_)),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._reference.center);a.mat4.multiply(h,h,this._rotation),a.mat4.translate(h,h,a.vec3.negate((0,r.v3)(),this._reference.center));const s=a.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),o=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.up=s,this._camera.eye=o}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.TrackballModifier=f,f.DEFAULT_SENSITIVITY=.002},2813:(p,t,i)=>{const a=i(3557),r=i(5150),c=i(9504);var f;(function(d){function h(u){return(0,c.assert)(u.length===2,`expected length of buffer to be 2, given ${u.length}`),[u[0],u[1]]}function s(u){return(0,c.assert)(u.length===3,`expected length of buffer to be 3, given ${u.length}`),[u[0],u[1],u[2]]}function o(u){return(0,c.assert)(u.length===4,`expected length of buffer to be 4, given ${u.length}`),[u[0],u[1],u[2],u[3]]}d.tuple2=h,d.tuple3=s,d.tuple4=o,d.clampf=function(u,m){const v=(0,r.clamp)(u,0,1);return(0,c.logIf)(m!==void 0&&u<0||u>1,c.LogLevel.Info,`${m} clamped to [${v}], given [${u}]`),v},d.clampf2=function(u,m){const v=a.vec2.fromValues(u[0],u[1]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1)&&((0,r.clamp2)(v,v,a.vec2.fromValues(0,0),a.vec2.fromValues(1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${v}], given [${u}]`)),h(v)},d.clampf3=function(u,m){const v=a.vec3.fromValues(u[0],u[1],u[2]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1||u[2]<0||u[2]>1)&&((0,r.clamp3)(v,v,a.vec3.fromValues(0,0,0),a.vec3.fromValues(1,1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${v}], given [${u}]`)),s(v)},d.clampf4=function(u,m){const v=a.vec4.fromValues(u[0],u[1],u[2],u[3]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1||u[2]<0||u[2]>1||u[3]<0||u[3]>1)&&((0,r.clamp4)(v,v,a.vec4.fromValues(0,0,0,0),a.vec4.fromValues(1,1,1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${v}], given [${u}]`)),o(v)},d.duplicate2=function(u){return[u[0],u[1]]},d.duplicate3=function(u){return[u[0],u[1],u[2]]},d.duplicate4=function(u){return[u[0],u[1],u[2],u[3]]},d.equals2=function(u,m){return u[0]===m[0]&&u[1]===m[1]},d.equals3=function(u,m){return u[0]===m[0]&&u[1]===m[1]&&u[2]===m[2]},d.equals4=function(u,m){return u[0]===m[0]&&u[1]===m[1]&&u[2]===m[2]&&u[3]===m[3]}})(f||(f={})),p.exports=f},9184:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TurntableModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=(0,r.m4)(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=(0,r.v3)(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h;const s=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(s,s),this._xAxisScreenSpace=a.vec3.cross((0,r.v3)(),[0,1,0],s),this._azimuth=Math.acos(a.vec3.dot(s,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(h){this._currentPoint=h;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),Number.isFinite(this._minAzimuth)&&(s[1]=Math.min(this._azimuth-this._minAzimuth,s[1])),Number.isFinite(this._maxAzimuth)&&(s[1]=Math.max(this._azimuth-this._maxAzimuth,s[1])),a.mat4.rotateY(this._rotation,(0,r.m4)(),s[0]),a.mat4.rotate(this._rotation,this._rotation,s[1],this._xAxisScreenSpace),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._reference.center);a.mat4.multiply(h,h,this._rotation),a.mat4.translate(h,h,a.vec3.negate((0,r.v3)(),this._reference.center));const s=a.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),o=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.up=s,this._camera.eye=o}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.TurntableModifier=f,f.DEFAULT_SENSITIVITY=.002},216:function(p,t,i){var a=this&&this.__decorate||function(d,h,s,o){var u,m=arguments.length,v=m<3?h:o===null?o=Object.getOwnPropertyDescriptor(h,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,h,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(m<3?u(v):m>3?u(h,s,v):u(h,s))||v);return m>3&&v&&Object.defineProperty(h,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedBuffer=void 0;const r=i(7340),c=i(4127);class f extends c.Initializable{static updatesNeedMerge(h,s,o){return s.begin-h.end<o||o===-1}constructor(h,s,o,u=0,m){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(s),this._gpuBuffer=new r.Buffer(h,m),this._usage=o,this._mergeThreshold=u}mergeUpdatesLeft(h){let s=0;const o=this._updates[h];for(let u=h-1;u>=0;u--){const m=this._updates[u];if(!f.updatesNeedMerge(m,o,this._mergeThreshold))break;o.begin=Math.min(o.begin,m.begin),o.end=Math.max(o.end,m.end),s++}return this._updates.splice(h-s,s),s+1}mergeUpdatesRight(h){let s=0;const o=this._updates[h];for(let u=h+1;u<this._updates.length;u++){const m=this._updates[u];if(!f.updatesNeedMerge(o,m,this._mergeThreshold))break;o.begin=Math.min(o.begin,m.begin),o.end=Math.max(o.end,m.end),s++}return this._updates.splice(h+1,s),s+1}addUpdate(h){const s=this._updates.findIndex(o=>h.begin<o.begin);s===-1?(this._updates.push(h),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(s,0,h),this.mergeUpdatesRight(s),this.mergeUpdatesLeft(s))}initialize(h){return this._gpuBuffer.initialize(h)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(h,s,o,u=!1,m=0,v=0,_=!0,g=!0){this._gpuBuffer.attribEnable(h,s,o,u,m,v,_,g)}attribDisable(h,s=!0,o=!0){this._gpuBuffer.attribDisable(h,s,o)}mergeSubDataRanges(){let h=0;for(;h<this._updates.length;)h+=this.mergeUpdatesRight(h)}subData(h,s){let o;o=s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),new Uint8Array(this._cpuBuffer).set(o,h),this.addUpdate({begin:h,end:h+o.byteLength})}update(h=!1,s=!1){if(h&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const o=new Uint8Array(this._cpuBuffer);for(const u of this._updates){const m=o.subarray(u.begin,u.end);this._gpuBuffer.subData(u.begin,m)}}s&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(h){const s=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(h);const o=new Uint8Array(s).slice(0,h);new Uint8Array(this._cpuBuffer).set(o)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(h){this._usage=h}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(h){this._mergeThreshold=h}}t.UnifiedBuffer=f,a([c.Initializable.initialize()],f.prototype,"initialize",null),a([c.Initializable.uninitialize()],f.prototype,"uninitialize",null),a([c.Initializable.assert_initialized()],f.prototype,"bind",null),a([c.Initializable.assert_initialized()],f.prototype,"unbind",null),a([c.Initializable.assert_initialized()],f.prototype,"attribEnable",null),a([c.Initializable.assert_initialized()],f.prototype,"attribDisable",null),a([c.Initializable.assert_initialized()],f.prototype,"update",null)},4536:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.commit=t.branch=void 0,t.branch="master",t.commit="08005ba3cdde715e0e81bf865bd6014b95d74922",t.version="v0.9.0"},5507:function(p,t,i){var a=this&&this.__decorate||function(h,s,o,u){var m,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,s,o,u);else for(var g=h.length-1;g>=0;g--)(m=h[g])&&(_=(v<3?m(_):v>3?m(s,o,_):m(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.VertexArray=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(s,o){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const u=this.context.gl2facade;this._object=u.createVertexArray(),this._valid=this._object!==void 0,this._bind=()=>{u.bindVertexArray(this.object),this._buffersBound||(s(),this._buffersBound=!0)},this._unbind=()=>u.bindVertexArray(d.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>s(),this._unbind=()=>o(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?((0,r.assert)(this._object!==void 0,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}t.VertexArray=d,d.DEFAULT_VERTEX_ARRAY=void 0,a([c.Initializable.assert_initialized()],d.prototype,"bind",null),a([c.Initializable.assert_initialized()],d.prototype,"unbind",null)},7645:p=>{var t;(function(i){i.EventBlocker=class{constructor(a,r){if(this._blockListenerByEvent=new Map,this._element=a,r!==void 0)for(const c of r)this.block(c)}block(a){this._blockListenerByEvent.has(a)||(this._blockListenerByEvent.set(a,r=>(r.preventDefault(),r.stopPropagation(),!1)),this._element.addEventListener(a,this._blockListenerByEvent.get(a)))}unblock(a){this._blockListenerByEvent.has(a)&&(this._element.removeEventListener(a,this._blockListenerByEvent.get(a)),this._blockListenerByEvent.delete(a))}}})(t||(t={})),p.exports=t},6378:(p,t,i)=>{const a=i(9504);var r;(function(c){class f{static queryAndCacheAPI(){if(f._exit!==void 0)return;const h=window.document,s=[h.exitFullScreen,h.msExitFullscreen,h.mozCancelFullScreen,h.webkitExitFullscreen,void 0];let o=0;for(;o<s.length&&s[o]===void 0;++o);switch(o){case 0:f._exit=()=>h.exitFullScreen(),f._request=u=>u.requestFullscreen(),f._element=()=>h.fullscreenElement,f._event="fullscreenchange";break;case 1:f._exit=()=>h.msExitFullscreen(),f._request=u=>u.msRequestFullscreen(),f._element=()=>h.msFullscreenElement,f._event="msfullscreenchange";break;case 2:f._exit=()=>h.mozCancelFullScreen(),f._request=u=>u.mozRequestFullScreen(),f._element=()=>h.mozFullScreenElement,f._event="mozfullscreenchange";break;case 3:f._exit=()=>h.webkitExitFullscreen(),f._request=u=>u.webkitRequestFullscreen(),f._element=()=>h.webkitFullscreenElement,f._event="webkitfullscreenchange";break;default:(0,a.assert)(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return f._element()!==void 0&&f._element()!==null}static toggle(h,s){if(h===void 0)return;f.queryAndCacheAPI();const o=f.active();if(!o){const u=getComputedStyle(h);f._size[0]=u.width,f._size[1]=u.height}s&&s(),o?(f._callback=void 0,window.removeEventListener(f._event,f.removeEventListener),h.style.width=f._size[0],h.style.height=f._size[1]):(f._callback=s,window.addEventListener(f._event,f.addEventListener)),o?f._exit():f._request(h)}}f._size=["0","0"],f.addEventListener=()=>{window.removeEventListener(f._event,f.addEventListener),window.addEventListener(f._event,f.removeEventListener)},f.removeEventListener=()=>{f._callback&&(f._callback(),f._callback=void 0),window.removeEventListener(f._event,f.removeEventListener)},c.Fullscreen=f})(r||(r={})),p.exports=r},5109:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(Ue,Je,it,wt){wt===void 0&&(wt=it);var Dt=Object.getOwnPropertyDescriptor(Je,it);Dt&&!("get"in Dt?!Je.__esModule:Dt.writable||Dt.configurable)||(Dt={enumerable:!0,get:function(){return Je[it]}}),Object.defineProperty(Ue,wt,Dt)}:function(Ue,Je,it,wt){wt===void 0&&(wt=it),Ue[wt]=Je[it]}),r=this&&this.__setModuleDefault||(Object.create?function(Ue,Je){Object.defineProperty(Ue,"default",{enumerable:!0,value:Je})}:function(Ue,Je){Ue.default=Je}),c=this&&this.__exportStar||function(Ue,Je){for(var it in Ue)it==="default"||Object.prototype.hasOwnProperty.call(Je,it)||a(Je,Ue,it)},f=this&&this.__importStar||function(Ue){if(Ue&&Ue.__esModule)return Ue;var Je={};if(Ue!=null)for(var it in Ue)it!=="default"&&Object.prototype.hasOwnProperty.call(Ue,it)&&a(Je,Ue,it);return r(Je,Ue),Je};Object.defineProperty(t,"__esModule",{value:!0}),t.KernelF32=t.RandomSquareKernel=t.AntiAliasingKernel=t.AbstractKernel=t.NdcFillingTriangle=t.NdcFillingRectangle=t.CanvasRecorder=t.WheelZoomModifier=t.PinchZoomModifier=t.TurntableModifier=t.TrackballModifier=t.PointerLock=t.PanModifier=t.FirstPersonModifier=t.Navigation=t.CameraModifier=t.TileCameraGenerator=t.Camera=t.Wizard=t.VertexArray=t.UnifiedBuffer=t.TextureCube=t.Texture2DArray=t.Texture3D=t.Texture2D=t.Shader=t.LoadingStatus=t.Renderer=t.Renderbuffer=t.Program=t.Geometry=t.Framebuffer=t.DefaultFramebuffer=t.ColorScale=t.Color=t.Buffer=t.EventHandler=t.PointerEventProvider=t.TouchEventProvider=t.MouseEventProvider=t.ChangeLookup=t.ExtensionsHash=t.ContextMasquerade=t.Initializable=t.Controller=t.Canvas=t.Context=t.version=t.commit=t.branch=void 0,t.tuples=t.gl_matrix_extensions=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.vec4=t.vec3=t.vec2=t.auxiliaries=t.FrameCapture=t.EyeGazeData=t.EyeGazeEventProvider=t.EyeGazeDataStreams=t.EyeGazeDataStream=t.ShadowPass=t.GaussFilter=t.ReadbackPass=t.EnvironmentTextureType=t.EnvironmentRenderingPass=t.DebugPass=t.BlitPass=t.AccumulatePass=t.KernelUI8=t.KernelUI32=t.KernelI8=t.KernelI32=void 0;var d=i(4536);Object.defineProperty(t,"branch",{enumerable:!0,get:function(){return d.branch}}),Object.defineProperty(t,"commit",{enumerable:!0,get:function(){return d.commit}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return d.version}});var h=i(2527);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return h.Context}});var s=i(7858);Object.defineProperty(t,"Canvas",{enumerable:!0,get:function(){return s.Canvas}});var o=i(8234);Object.defineProperty(t,"Controller",{enumerable:!0,get:function(){return o.Controller}});var u=i(4127);Object.defineProperty(t,"Initializable",{enumerable:!0,get:function(){return u.Initializable}});var m=i(5557);Object.defineProperty(t,"ContextMasquerade",{enumerable:!0,get:function(){return m.ContextMasquerade}});var v=i(5060);Object.defineProperty(t,"ExtensionsHash",{enumerable:!0,get:function(){return v.ExtensionsHash}});var _=i(7564);Object.defineProperty(t,"ChangeLookup",{enumerable:!0,get:function(){return _.ChangeLookup}});var g=i(4602);Object.defineProperty(t,"MouseEventProvider",{enumerable:!0,get:function(){return g.MouseEventProvider}});var x=i(8870);Object.defineProperty(t,"TouchEventProvider",{enumerable:!0,get:function(){return x.TouchEventProvider}});var E=i(8216);Object.defineProperty(t,"PointerEventProvider",{enumerable:!0,get:function(){return E.PointerEventProvider}});var w=i(2);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return w.EventHandler}});var S=i(7340);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return S.Buffer}});var R=i(3847);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return R.Color}});var O=i(5837);Object.defineProperty(t,"ColorScale",{enumerable:!0,get:function(){return O.ColorScale}});var I=i(8386);Object.defineProperty(t,"DefaultFramebuffer",{enumerable:!0,get:function(){return I.DefaultFramebuffer}});var D=i(8215);Object.defineProperty(t,"Framebuffer",{enumerable:!0,get:function(){return D.Framebuffer}});var j=i(638);Object.defineProperty(t,"Geometry",{enumerable:!0,get:function(){return j.Geometry}});var k=i(4168);Object.defineProperty(t,"Program",{enumerable:!0,get:function(){return k.Program}});var G=i(8400);Object.defineProperty(t,"Renderbuffer",{enumerable:!0,get:function(){return G.Renderbuffer}});var Z=i(3105);Object.defineProperty(t,"Renderer",{enumerable:!0,get:function(){return Z.Renderer}}),Object.defineProperty(t,"LoadingStatus",{enumerable:!0,get:function(){return Z.LoadingStatus}});var K=i(771);Object.defineProperty(t,"Shader",{enumerable:!0,get:function(){return K.Shader}});var Y=i(8593);Object.defineProperty(t,"Texture2D",{enumerable:!0,get:function(){return Y.Texture2D}});var re=i(9584);Object.defineProperty(t,"Texture3D",{enumerable:!0,get:function(){return re.Texture3D}});var Q=i(7380);Object.defineProperty(t,"Texture2DArray",{enumerable:!0,get:function(){return Q.Texture2DArray}});var ae=i(5186);Object.defineProperty(t,"TextureCube",{enumerable:!0,get:function(){return ae.TextureCube}});var se=i(216);Object.defineProperty(t,"UnifiedBuffer",{enumerable:!0,get:function(){return se.UnifiedBuffer}});var ee=i(5507);Object.defineProperty(t,"VertexArray",{enumerable:!0,get:function(){return ee.VertexArray}});var le=i(9217);Object.defineProperty(t,"Wizard",{enumerable:!0,get:function(){return le.Wizard}});var ge=i(3025);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return ge.Camera}});var ve=i(5608);Object.defineProperty(t,"TileCameraGenerator",{enumerable:!0,get:function(){return ve.TileCameraGenerator}});var ne=i(7344);Object.defineProperty(t,"CameraModifier",{enumerable:!0,get:function(){return ne.CameraModifier}});var be=i(4264);Object.defineProperty(t,"Navigation",{enumerable:!0,get:function(){return be.Navigation}});var Te=i(4850);Object.defineProperty(t,"FirstPersonModifier",{enumerable:!0,get:function(){return Te.FirstPersonModifier}});var oe=i(506);Object.defineProperty(t,"PanModifier",{enumerable:!0,get:function(){return oe.PanModifier}});var me=i(2010);Object.defineProperty(t,"PointerLock",{enumerable:!0,get:function(){return me.PointerLock}});var Ee=i(3151);Object.defineProperty(t,"TrackballModifier",{enumerable:!0,get:function(){return Ee.TrackballModifier}});var Oe=i(9184);Object.defineProperty(t,"TurntableModifier",{enumerable:!0,get:function(){return Oe.TurntableModifier}});var xe=i(5222);Object.defineProperty(t,"PinchZoomModifier",{enumerable:!0,get:function(){return xe.PinchZoomModifier}});var ke=i(7137);Object.defineProperty(t,"WheelZoomModifier",{enumerable:!0,get:function(){return ke.WheelZoomModifier}});var Le=i(8596);Object.defineProperty(t,"CanvasRecorder",{enumerable:!0,get:function(){return Le.CanvasRecorder}});var Re=i(5491);Object.defineProperty(t,"NdcFillingRectangle",{enumerable:!0,get:function(){return Re.NdcFillingRectangle}});var Ye=i(1896);Object.defineProperty(t,"NdcFillingTriangle",{enumerable:!0,get:function(){return Ye.NdcFillingTriangle}});var qe=i(4287);Object.defineProperty(t,"AbstractKernel",{enumerable:!0,get:function(){return qe.AbstractKernel}});var rt=i(2419);Object.defineProperty(t,"AntiAliasingKernel",{enumerable:!0,get:function(){return rt.AntiAliasingKernel}});var ht=i(3039);Object.defineProperty(t,"RandomSquareKernel",{enumerable:!0,get:function(){return ht.RandomSquareKernel}});var $e=i(4287);Object.defineProperty(t,"KernelF32",{enumerable:!0,get:function(){return $e.KernelF32}}),Object.defineProperty(t,"KernelI32",{enumerable:!0,get:function(){return $e.KernelI32}}),Object.defineProperty(t,"KernelI8",{enumerable:!0,get:function(){return $e.KernelI8}}),Object.defineProperty(t,"KernelUI32",{enumerable:!0,get:function(){return $e.KernelUI32}}),Object.defineProperty(t,"KernelUI8",{enumerable:!0,get:function(){return $e.KernelUI8}});var Me=i(9017);Object.defineProperty(t,"AccumulatePass",{enumerable:!0,get:function(){return Me.AccumulatePass}});var Be=i(8196);Object.defineProperty(t,"BlitPass",{enumerable:!0,get:function(){return Be.BlitPass}});var yt=i(3334);Object.defineProperty(t,"DebugPass",{enumerable:!0,get:function(){return yt.DebugPass}});var we=i(6464);Object.defineProperty(t,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return we.EnvironmentRenderingPass}}),Object.defineProperty(t,"EnvironmentTextureType",{enumerable:!0,get:function(){return we.EnvironmentTextureType}});var At=i(1900);Object.defineProperty(t,"ReadbackPass",{enumerable:!0,get:function(){return At.ReadbackPass}});var dt=i(3395);Object.defineProperty(t,"GaussFilter",{enumerable:!0,get:function(){return dt.GaussFilter}});var Et=i(9011);Object.defineProperty(t,"ShadowPass",{enumerable:!0,get:function(){return Et.ShadowPass}});var ft=i(3404);Object.defineProperty(t,"EyeGazeDataStream",{enumerable:!0,get:function(){return ft.EyeGazeDataStream}}),Object.defineProperty(t,"EyeGazeDataStreams",{enumerable:!0,get:function(){return ft.EyeGazeDataStreams}});var mt=i(3975);Object.defineProperty(t,"EyeGazeEventProvider",{enumerable:!0,get:function(){return mt.EyeGazeEventProvider}});var gt=i(6662);Object.defineProperty(t,"EyeGazeData",{enumerable:!0,get:function(){return gt.EyeGazeData}});var tt=i(1215);Object.defineProperty(t,"FrameCapture",{enumerable:!0,get:function(){return tt.FrameCapture}}),c(i(1854),t),c(i(5315),t),c(i(1058),t);const Bt=f(i(9504));t.auxiliaries=Bt;var Qe=i(3557);Object.defineProperty(t,"vec2",{enumerable:!0,get:function(){return Qe.vec2}}),Object.defineProperty(t,"vec3",{enumerable:!0,get:function(){return Qe.vec3}}),Object.defineProperty(t,"vec4",{enumerable:!0,get:function(){return Qe.vec4}});var Rt=i(3557);Object.defineProperty(t,"mat2",{enumerable:!0,get:function(){return Rt.mat2}}),Object.defineProperty(t,"mat2d",{enumerable:!0,get:function(){return Rt.mat2d}}),Object.defineProperty(t,"mat3",{enumerable:!0,get:function(){return Rt.mat3}}),Object.defineProperty(t,"mat4",{enumerable:!0,get:function(){return Rt.mat4}});var Gt=i(3557);Object.defineProperty(t,"quat",{enumerable:!0,get:function(){return Gt.quat}});const Nr=f(i(5150));t.gl_matrix_extensions=Nr;const zr=f(i(2813));t.tuples=zr},8184:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(_,g,x,E){E===void 0&&(E=x);var w=Object.getOwnPropertyDescriptor(g,x);w&&!("get"in w?!g.__esModule:w.writable||w.configurable)||(w={enumerable:!0,get:function(){return g[x]}}),Object.defineProperty(_,E,w)}:function(_,g,x,E){E===void 0&&(E=x),_[E]=g[x]}),r=this&&this.__setModuleDefault||(Object.create?function(_,g){Object.defineProperty(_,"default",{enumerable:!0,value:g})}:function(_,g){_.default=g}),c=this&&this.__exportStar||function(_,g){for(var x in _)x==="default"||Object.prototype.hasOwnProperty.call(g,x)||a(g,_,x)},f=this&&this.__importStar||function(_){if(_&&_.__esModule)return _;var g={};if(_!=null)for(var x in _)x!=="default"&&Object.prototype.hasOwnProperty.call(_,x)&&a(g,_,x);return r(g,_),g};Object.defineProperty(t,"__esModule",{value:!0}),t.viewer=t.Benchmark=t.ray_math=t.fetch=t.properties=void 0,c(i(5109),t),c(i(8892),t);const d=f(i(1407));t.properties=d;const h=f(i(64));t.fetch=h;const s=f(i(8962));t.ray_math=s;var o=i(8263);Object.defineProperty(t,"Benchmark",{enumerable:!0,get:function(){return o.Benchmark}}),c(i(2016),t);const u=f(i(7645)),m=f(i(6378));var v;(function(_){_.EventBlocker=u.EventBlocker,_.Fullscreen=m.Fullscreen})(v||(t.viewer=v={}))},7137:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WheelZoomModifier=void 0;const a=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}process(h){Object.assign(this._reference,this._camera);const s=h*this._sensitivity,o=a.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);a.vec3.normalize(o,o),this._translation=a.vec3.scale((0,r.v3)(),o,s),this.update()}update(){if(this._camera===void 0)return;const h=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.eye=s}}t.WheelZoomModifier=f,f.DEFAULT_SENSITIVITY=.002},9217:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wizard=void 0;const a=i(9504);class r{static queryPrecisionSupport(f,d){const h=f.gl,s=f.gl2facade,o=f.isWebGL1&&f.supportsTextureFloat||f.isWebGL2&&f.supportsColorBufferFloat,u=f.isWebGL1&&f.supportsTextureHalfFloat||f.isWebGL2&&f.supportsColorBufferFloat;let m=d;return d in r.Precision||((0,a.log)(a.LogLevel.Warning,`unknown precision '${m}' changed to '${r.Precision.auto}'`),d=r.Precision.auto),d===r.Precision.auto&&(m=o?r.Precision.float:u?r.Precision.half:r.Precision.byte),m===r.Precision.half&&u?(f.isWebGL2?f.colorBufferFloat:f.textureHalfFloat,[m,s.HALF_FLOAT,1]):m!==r.Precision.float&&m!==r.Precision.half||!o?[m,h.UNSIGNED_BYTE,2]:(f.isWebGL2?f.colorBufferFloat:f.textureFloat,[m,h.FLOAT,0])}static queryInternalTextureFormat(f,d,h=r.Precision.auto){const[s,o,u]=this.queryPrecisionSupport(f,h),m=f.gl;if(f.isWebGL1)return(0,a.assert)([m.RGB,m.RGBA].includes(d),"target must be gl.RGB or gl.RGBA in WebGL 1"),[d,o,s];switch(d){case m.RGBA:return[[m.RGBA32F,m.RGBA16F,m.RGBA8][u],o,s];case m.RGB:return[[m.RGB32F,m.RGB16F,m.RGB8][u],o,s];case m.RG:return[[m.RG32F,m.RG16F,m.RG8][u],o,s];case m.RED:return[[m.R32F,m.R16F,m.R8][u],o,s];default:(0,a.assert)(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[m.NONE,m.NONE,s]}}t.Wizard=r,function(c){(function(f){f.float="float",f.half="half",f.byte="byte",f.auto="auto"})(c.Precision||(c.Precision={}))}(r||(t.Wizard=r={}))},9983:(p,t,i)=>{var a=i(6751);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var c=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),s=["'"].concat(h),o=["%","/","?",";","#"].concat(s),u=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,v=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=i(8985);function w(S,R,O){if(S&&typeof S=="object"&&S instanceof r)return S;var I=new r;return I.parse(S,R,O),I}r.prototype.parse=function(S,R,O){if(typeof S!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof S);var I=S.indexOf("?"),D=I!==-1&&I<S.indexOf("#")?"?":"#",j=S.split(D);j[0]=j[0].replace(/\\/g,"/");var k=S=j.join(D);if(k=k.trim(),!O&&S.split("#").length===1){var G=d.exec(k);if(G)return this.path=k,this.href=k,this.pathname=G[1],G[2]?(this.search=G[2],this.query=R?E.parse(this.search.substr(1)):this.search.substr(1)):R&&(this.search="",this.query={}),this}var Z=c.exec(k);if(Z){var K=(Z=Z[0]).toLowerCase();this.protocol=K,k=k.substr(Z.length)}if(O||Z||k.match(/^\/\/[^@/]+@[^@/]+/)){var Y=k.substr(0,2)==="//";!Y||Z&&g[Z]||(k=k.substr(2),this.slashes=!0)}if(!g[Z]&&(Y||Z&&!x[Z])){for(var re,Q,ae=-1,se=0;se<u.length;se++)(ee=k.indexOf(u[se]))!==-1&&(ae===-1||ee<ae)&&(ae=ee);for((Q=ae===-1?k.lastIndexOf("@"):k.lastIndexOf("@",ae))!==-1&&(re=k.slice(0,Q),k=k.slice(Q+1),this.auth=decodeURIComponent(re)),ae=-1,se=0;se<o.length;se++){var ee;(ee=k.indexOf(o[se]))!==-1&&(ae===-1||ee<ae)&&(ae=ee)}ae===-1&&(ae=k.length),this.host=k.slice(0,ae),k=k.slice(ae),this.parseHost(),this.hostname=this.hostname||"";var le=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!le)for(var ge=this.hostname.split(/\./),ve=(se=0,ge.length);se<ve;se++){var ne=ge[se];if(ne&&!ne.match(m)){for(var be="",Te=0,oe=ne.length;Te<oe;Te++)ne.charCodeAt(Te)>127?be+="x":be+=ne[Te];if(!be.match(m)){var me=ge.slice(0,se),Ee=ge.slice(se+1),Oe=ne.match(v);Oe&&(me.push(Oe[1]),Ee.unshift(Oe[2])),Ee.length&&(k="/"+Ee.join(".")+k),this.hostname=me.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),le||(this.hostname=a.toASCII(this.hostname));var xe=this.port?":"+this.port:"",ke=this.hostname||"";this.host=ke+xe,this.href+=this.host,le&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),k[0]!=="/"&&(k="/"+k))}if(!_[K])for(se=0,ve=s.length;se<ve;se++){var Le=s[se];if(k.indexOf(Le)!==-1){var Re=encodeURIComponent(Le);Re===Le&&(Re=escape(Le)),k=k.split(Le).join(Re)}}var Ye=k.indexOf("#");Ye!==-1&&(this.hash=k.substr(Ye),k=k.slice(0,Ye));var qe=k.indexOf("?");if(qe!==-1?(this.search=k.substr(qe),this.query=k.substr(qe+1),R&&(this.query=E.parse(this.query)),k=k.slice(0,qe)):R&&(this.search="",this.query={}),k&&(this.pathname=k),x[K]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){xe=this.pathname||"";var rt=this.search||"";this.path=xe+rt}return this.href=this.format(),this},r.prototype.format=function(){var S=this.auth||"";S&&(S=(S=encodeURIComponent(S)).replace(/%3A/i,":"),S+="@");var R=this.protocol||"",O=this.pathname||"",I=this.hash||"",D=!1,j="";this.host?D=S+this.host:this.hostname&&(D=S+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(D+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(j=E.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var k=this.search||j&&"?"+j||"";return R&&R.substr(-1)!==":"&&(R+=":"),this.slashes||(!R||x[R])&&D!==!1?(D="//"+(D||""),O&&O.charAt(0)!=="/"&&(O="/"+O)):D||(D=""),I&&I.charAt(0)!=="#"&&(I="#"+I),k&&k.charAt(0)!=="?"&&(k="?"+k),R+D+(O=O.replace(/[?#]/g,function(G){return encodeURIComponent(G)}))+(k=k.replace("#","%23"))+I},r.prototype.resolve=function(S){return this.resolveObject(w(S,!1,!0)).format()},r.prototype.resolveObject=function(S){if(typeof S=="string"){var R=new r;R.parse(S,!1,!0),S=R}for(var O=new r,I=Object.keys(this),D=0;D<I.length;D++){var j=I[D];O[j]=this[j]}if(O.hash=S.hash,S.href==="")return O.href=O.format(),O;if(S.slashes&&!S.protocol){for(var k=Object.keys(S),G=0;G<k.length;G++){var Z=k[G];Z!=="protocol"&&(O[Z]=S[Z])}return x[O.protocol]&&O.hostname&&!O.pathname&&(O.pathname="/",O.path=O.pathname),O.href=O.format(),O}if(S.protocol&&S.protocol!==O.protocol){if(!x[S.protocol]){for(var K=Object.keys(S),Y=0;Y<K.length;Y++){var re=K[Y];O[re]=S[re]}return O.href=O.format(),O}if(O.protocol=S.protocol,S.host||g[S.protocol])O.pathname=S.pathname;else{for(var Q=(S.pathname||"").split("/");Q.length&&!(S.host=Q.shift()););S.host||(S.host=""),S.hostname||(S.hostname=""),Q[0]!==""&&Q.unshift(""),Q.length<2&&Q.unshift(""),O.pathname=Q.join("/")}if(O.search=S.search,O.query=S.query,O.host=S.host||"",O.auth=S.auth,O.hostname=S.hostname||S.host,O.port=S.port,O.pathname||O.search){var ae=O.pathname||"",se=O.search||"";O.path=ae+se}return O.slashes=O.slashes||S.slashes,O.href=O.format(),O}var ee=O.pathname&&O.pathname.charAt(0)==="/",le=S.host||S.pathname&&S.pathname.charAt(0)==="/",ge=le||ee||O.host&&S.pathname,ve=ge,ne=O.pathname&&O.pathname.split("/")||[],be=(Q=S.pathname&&S.pathname.split("/")||[],O.protocol&&!x[O.protocol]);if(be&&(O.hostname="",O.port=null,O.host&&(ne[0]===""?ne[0]=O.host:ne.unshift(O.host)),O.host="",S.protocol&&(S.hostname=null,S.port=null,S.host&&(Q[0]===""?Q[0]=S.host:Q.unshift(S.host)),S.host=null),ge=ge&&(Q[0]===""||ne[0]==="")),le)O.host=S.host||S.host===""?S.host:O.host,O.hostname=S.hostname||S.hostname===""?S.hostname:O.hostname,O.search=S.search,O.query=S.query,ne=Q;else if(Q.length)ne||(ne=[]),ne.pop(),ne=ne.concat(Q),O.search=S.search,O.query=S.query;else if(S.search!=null)return be&&(O.host=ne.shift(),O.hostname=O.host,(Oe=!!(O.host&&O.host.indexOf("@")>0)&&O.host.split("@"))&&(O.auth=Oe.shift(),O.hostname=Oe.shift(),O.host=O.hostname)),O.search=S.search,O.query=S.query,O.pathname===null&&O.search===null||(O.path=(O.pathname?O.pathname:"")+(O.search?O.search:"")),O.href=O.format(),O;if(!ne.length)return O.pathname=null,O.search?O.path="/"+O.search:O.path=null,O.href=O.format(),O;for(var Te=ne.slice(-1)[0],oe=(O.host||S.host||ne.length>1)&&(Te==="."||Te==="..")||Te==="",me=0,Ee=ne.length;Ee>=0;Ee--)(Te=ne[Ee])==="."?ne.splice(Ee,1):Te===".."?(ne.splice(Ee,1),me++):me&&(ne.splice(Ee,1),me--);if(!ge&&!ve)for(;me--;me)ne.unshift("..");!ge||ne[0]===""||ne[0]&&ne[0].charAt(0)==="/"||ne.unshift(""),oe&&ne.join("/").substr(-1)!=="/"&&ne.push("");var Oe,xe=ne[0]===""||ne[0]&&ne[0].charAt(0)==="/";return be&&(O.hostname=xe?"":ne.length?ne.shift():"",O.host=O.hostname,(Oe=!!(O.host&&O.host.indexOf("@")>0)&&O.host.split("@"))&&(O.auth=Oe.shift(),O.hostname=Oe.shift(),O.host=O.hostname)),(ge=ge||O.host&&ne.length)&&!xe&&ne.unshift(""),ne.length>0?O.pathname=ne.join("/"):(O.pathname=null,O.path=null),O.pathname===null&&O.search===null||(O.path=(O.pathname?O.pathname:"")+(O.search?O.search:"")),O.auth=S.auth||O.auth,O.slashes=O.slashes||S.slashes,O.href=O.format(),O},r.prototype.parseHost=function(){var S=this.host,R=f.exec(S);R&&((R=R[0])!==":"&&(this.port=R.substr(1)),S=S.substr(0,S.length-R.length)),S&&(this.hostname=S)},t.parse=w,t.resolve=function(S,R){return w(S,!1,!0).resolve(R)},t.resolveObject=function(S,R){return S?w(S,!1,!0).resolveObject(R):R},t.format=function(S){return typeof S=="string"&&(S=w(S)),S instanceof r?S.format():r.prototype.format.call(S)},t.Url=r},6296:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
    #extension GL_OES_standard_derivatives : enable\r
#else \r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
uniform int u_frameNumber;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r
    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r
\r
    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r
    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r
    if(!any(bvec2(cstep))) {\r
        discard;\r
    }\r
    fragColor = vec4(color, 1.0); \r
}\r
`},5077:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else \r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec2 u_ndcOffset;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex.xy * 0.5 + 0.5;\r
\r
    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r
    ndcOffset(vertex, u_ndcOffset);\r
\r
    gl_Position = vertex;\r
}\r
`},5347:p=>{p.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
// References:\r
// [1] Real Shading in Unreal Engine 4\r
//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r
// [2] Physically Based Shading at Disney\r
//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r
// [3] README.md - Environment Maps\r
//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r
// [4] "An Inexpensive BRDF Model for Physically based Rendering" by Christophe Schlick\r
//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
const int USE_IBL               = 1 << 4;\r
const int HAS_BASECOLORMAP      = 1 << 5;\r
const int HAS_NORMALMAP         = 1 << 6;\r
const int HAS_EMISSIVEMAP       = 1 << 7;\r
const int HAS_METALROUGHNESSMAP = 1 << 8;\r
const int HAS_OCCLUSIONMAP      = 1 << 9;\r
const int USE_TEX_LOD           = 1 << 10;\r
\r
const vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\r
const vec3 u_LightColor = vec3(1, 1, 1);\r
\r
const float M_PI = 3.141592653589793;\r
const float c_MinRoughness = 0.04;\r
\r
uniform sampler2D u_baseColor;\r
uniform sampler2D u_metallicRoughness;\r
uniform sampler2D u_normal;\r
uniform sampler2D u_emissive;\r
uniform sampler2D u_occlusion;\r
\r
uniform samplerCube u_specularEnvironment;\r
uniform sampler2D u_brdfLUT;\r
\r
uniform int u_baseColorTexCoord;\r
uniform int u_normalTexCoord;\r
uniform int u_metallicRoughnessTexCoord;\r
uniform int u_occlusionTexCoord;\r
uniform int u_emissiveTexCoord;\r
\r
uniform vec4 u_baseColorFactor;\r
uniform float u_metallicFactor;\r
uniform float u_roughnessFactor;\r
uniform vec3 u_emissiveFactor;\r
uniform float u_normalScale;\r
uniform int u_blendMode;\r
uniform float u_blendCutoff;\r
\r
uniform mediump int u_geometryFlags;\r
uniform mediump int u_pbrFlags;\r
uniform vec3 u_eye;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
// Encapsulate the various inputs used by the various functions in the shading equation\r
// We store values in this struct to simplify the integration of alternative implementations\r
// of the shading terms, outlined in the Readme.MD Appendix.\r
struct PBRInfo\r
{\r
    float NdotL;                  // cos angle between normal and light direction\r
    float NdotV;                  // cos angle between normal and view direction\r
    float NdotH;                  // cos angle between normal and half vector\r
    float LdotH;                  // cos angle between light direction and half vector\r
    float VdotH;                  // cos angle between view direction and half vector\r
    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r
    float metalness;              // metallic value at the surface\r
    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r
    vec3 reflectance90;           // reflectance color at grazing angle\r
    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r
    vec3 diffuseColor;            // color contribution from diffuse lighting\r
    vec3 specularColor;           // color contribution from specular lighting\r
};\r
\r
bool checkGeometryFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
bool checkFlag(int flag) {\r
    return (u_pbrFlags & flag) == flag;\r
}\r
\r
vec4 SRGBtoLINEAR(vec4 srgbIn)\r
{\r
    #ifdef MANUAL_SRGB\r
    #ifdef SRGB_FAST_APPROXIMATION\r
    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r
    #else //SRGB_FAST_APPROXIMATION\r
    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r
    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r
    #endif //SRGB_FAST_APPROXIMATION\r
    return vec4(linOut,srgbIn.w);;\r
    #else //MANUAL_SRGB\r
    return srgbIn;\r
    #endif //MANUAL_SRGB\r
}\r
\r
// Find the normal for this fragment, pulling either from a predefined normal map\r
// or from the interpolated mesh normal and tangent attributes.\r
vec3 getNormal()\r
{\r
    // Retrieve the tangent space matrix\r
    mat3 tbn;\r
    if (!checkGeometryFlag(HAS_TANGENTS)) {\r
        vec3 pos_dx = dFdx(v_position);\r
        vec3 pos_dy = dFdy(v_position);\r
        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\r
        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\r
        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r
\r
        vec3 ng;\r
        if (checkGeometryFlag(HAS_NORMALS))\r
            ng = normalize(v_normal);\r
        else\r
            ng = cross(pos_dx, pos_dy);\r
\r
            t = normalize(t - ng * dot(ng, t));\r
            vec3 b = normalize(cross(ng, t));\r
            tbn = mat3(t, b, ng);\r
        }\r
    else { // HAS_TANGENTS\r
        tbn = v_TBN;\r
    }\r
\r
    vec3 n;\r
    if (checkFlag(HAS_NORMALMAP)) {\r
        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\r
        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\r
    } else {\r
        // The tbn matrix is linearly interpolated, so we need to re-normalize\r
        n = normalize(tbn[2].xyz);\r
    }\r
\r
    // reverse backface normals\r
    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r
\r
    return n;\r
}\r
\r
// Basic Lambertian diffuse\r
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r
// See also [1], Equation 1\r
vec3 diffuse(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.diffuseColor / M_PI;\r
}\r
\r
 // The following equation models the Fresnel reflectance term of the spec equation (aka F())\r
// Implementation of fresnel from [4], Equation 15\r
vec3 specularReflection(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r
}\r
\r
 // This calculates the specular geometric attenuation (aka G()),\r
// where rougher material will reflect less light back to the viewer.\r
// This implementation is based on [1] Equation 4, and we adopt their modifications to\r
// alphaRoughness as input as originally proposed in [2].\r
float geometricOcclusion(PBRInfo pbrInputs)\r
{\r
    float NdotL = pbrInputs.NdotL;\r
    float NdotV = pbrInputs.NdotV;\r
    float r = pbrInputs.alphaRoughness;\r
\r
    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r
    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r
    return attenuationL * attenuationV;\r
}\r
\r
 // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r
// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\r
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r
float microfacetDistribution(PBRInfo pbrInputs)\r
{\r
    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r
    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r
    return roughnessSq / (M_PI * f * f);\r
}\r
\r
vec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\r
{\r
    float NdotV = clamp(dot(n, v), 0.0, 1.0);\r
\r
    // TODO: pass uniform for mip count\r
    const float MIP_COUNT = 8.0;\r
    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\r
    vec3 reflection = normalize(reflect(-v, n));\r
\r
    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\r
    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\r
\r
    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\r
    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\r
\r
    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\r
    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\r
\r
    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\r
    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\r
\r
    return specular;\r
    // return diffuse + specular;\r
}\r
\r
void main(void)\r
{\r
    float perceptualRoughness = u_roughnessFactor;\r
    float metallic = u_metallicFactor;\r
    if (checkFlag(HAS_METALROUGHNESSMAP)) {\r
        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r
        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r
        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\r
        perceptualRoughness = mrSample.g * perceptualRoughness;\r
        metallic = mrSample.b * metallic;\r
    }\r
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r
    metallic = clamp(metallic, 0.0, 1.0);\r
    // Roughness is authored as perceptual roughness; as is convention,\r
    // convert to material roughness by squaring the perceptual roughness [2].\r
    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r
\r
     // The albedo may be defined from a base texture or a flat color\r
    vec4 baseColor;\r
    if (checkFlag(HAS_BASECOLORMAP)) {\r
        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\r
    } else {\r
        baseColor = u_baseColorFactor;\r
    }\r
\r
    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r
    // TODO!: distinguish vec3/vec4 colors...\r
    baseColor *= vec4(v_color.rgb, 1.0);\r
\r
    vec3 f0 = vec3(0.04);\r
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r
    diffuseColor *= 1.0 - metallic;\r
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r
\r
    // Compute reflectance.\r
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r
\r
    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r
    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r
    vec3 specularEnvironmentR0 = specularColor.rgb;\r
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r
\r
    vec3 n = getNormal();                         // normal at surface point\r
    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\r
    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\r
    vec3 h = normalize(l+v);                       // Half vector between both l and v\r
    vec3 reflection = -normalize(reflect(v, n));\r
\r
    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r
    float NdotV = abs(dot(n, v)) + 0.001;\r
    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r
    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r
    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r
\r
    PBRInfo pbrInputs = PBRInfo(\r
        NdotL,\r
        NdotV,\r
        NdotH,\r
        LdotH,\r
        VdotH,\r
        perceptualRoughness,\r
        metallic,\r
        specularEnvironmentR0,\r
        specularEnvironmentR90,\r
        alphaRoughness,\r
        diffuseColor,\r
        specularColor\r
    );\r
\r
     // Calculate the shading terms for the microfacet specular shading model\r
    vec3 F = specularReflection(pbrInputs);\r
    float G = geometricOcclusion(pbrInputs);\r
    float D = microfacetDistribution(pbrInputs);\r
\r
     // Calculation of analytical lighting contribution\r
    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r
    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r
    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r
    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r
\r
    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\r
    color += environmentLight;\r
\r
    if (checkFlag(HAS_EMISSIVEMAP)) {\r
        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\r
        color += emissive;\r
    }\r
\r
    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r
    float alpha = 1.0;\r
    if (u_blendMode == 1) {\r
        if (baseColor.a < u_blendCutoff) {\r
            discard;\r
        }\r
    }\r
    else if (u_blendMode == 2) {\r
        alpha = baseColor.a;\r
    }\r
\r
    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\r
}\r
`},6626:p=>{p.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
\r
#if __VERSION__ == 100\r
    attribute vec4 a_position;\r
    attribute vec4 a_normal;\r
    attribute vec4 a_tangent;\r
    attribute vec2 a_texcoord_0;\r
    attribute vec2 a_texcoord_1;\r
    attribute vec2 a_texcoord_2;\r
    attribute vec4 a_joints;\r
    attribute vec4 a_weights;\r
    attribute vec4 a_color;\r
#else\r
    layout (location = 0) in vec4 a_position;\r
    layout (location = 1) in vec3 a_normal;\r
    layout (location = 2) in vec4 a_tangent;\r
    layout (location = 3) in vec2 a_texcoord_0;\r
    layout (location = 4) in vec2 a_texcoord_1;\r
    layout (location = 5) in vec2 a_texcoord_2;\r
    layout (location = 6) in vec4 a_joints;\r
    layout (location = 7) in vec4 a_weights;\r
    layout (location = 8) in vec4 a_color;\r
#endif\r
\r
uniform mat4 u_model;\r
uniform mat4 u_viewProjection;\r
uniform mat3 u_normalMatrix;\r
\r
uniform mediump int u_geometryFlags;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
bool checkFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
void main(void)\r
{\r
    vec4 pos = u_model * a_position;\r
    v_position = vec3(pos.xyz) / pos.w;\r
\r
    if (checkFlag(HAS_NORMALS)) {\r
        if (checkFlag(HAS_TANGENTS)) {\r
            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\r
            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\r
            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r
            v_TBN = mat3(tangentW, bitangentW, normalW);\r
        } else { // HAS_TANGENTS != 1\r
            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\r
        }\r
    }\r
\r
    if (checkFlag(HAS_UV)) {\r
        v_uv[0] = a_texcoord_0;\r
        v_uv[1] = a_texcoord_1;\r
        v_uv[2] = a_texcoord_2;\r
    } else {\r
        v_uv[0] = vec2(0., 0.);\r
        v_uv[1] = vec2(0., 0.);\r
        v_uv[2] = vec2(0., 0.);\r
    }\r
\r
    if (checkFlag(HAS_COLORS)) {\r
        v_color = a_color;\r
    } else {\r
        v_color = vec4(1.0);\r
    }\r
\r
    gl_Position = u_viewProjection * u_model * a_position;\r
}\r
`},8058:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weight;\r
uniform sampler2D u_accumulationTexture;\r
uniform sampler2D u_currentFrameTexture;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r
    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r
    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r
}\r
`},6523:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    fragColor = texture(u_source, v_uv);\r
}\r
`},3354:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec4 u_srcBounds; // normalized\r
uniform vec4 u_dstBounds; // normalized\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = a_vertex * 0.5 + 0.5;\r
\r
    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\r
    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\r
}\r
`},8359:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
float linearizeDepth(float zInNDC, float near, float far) {\r
    float zLinear = 2.0 * near;\r
    zLinear /= far + near - zInNDC * (far - near);\r
    return zLinear;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
uniform int u_mode; /* Debug mode. */\r
uniform vec2 u_linearize; /* [ zNear, zFar ] */\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 source = texture(u_source, v_uv);\r
\r
    /* u_mode == 0                 None */\r
\r
    if(u_mode == 1) {           /* Depth */\r
        source.rgb = vec3(source[0]);\r
\r
    } else if (u_mode == 2) {   /* DepthLinear */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = vec3(zLinear);\r
\r
    } else if(u_mode == 3) {    /* DepthPacked */\r
        source.rgb = float24x1_to_uint8x3(source[0]);\r
\r
    } else if (u_mode == 4) {   /* DepthLinearPacked */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = float24x1_to_uint8x3(zLinear);\r
    }\r
\r
    fragColor = source;\r
}\r
`},9196:p=>{p.exports=`precision highp float;\r
precision highp int;\r
\r
/**\r
  To be replaced via Shader.replace();\r
 */\r
#define PROJECTION_TYPE\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform int u_mode;\r
uniform bool u_skipLod;\r
\r
#if defined(CUBE_MAP)\r
    uniform samplerCube u_cubemap;\r
#elif defined(EQUI_MAP)\r
    uniform sampler2D u_equirectmap;\r
#elif defined(SPHERE_MAP)\r
    uniform sampler2D u_spheremap;\r
#elif defined(POLAR_MAP)\r
    uniform sampler2D u_polarmap[2];\r
#endif\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
const float PI = 3.141592653589793;\r
const float OneOver2PI = 0.1591549430918953357688837633725;\r
const float OneOverPI  = 0.3183098861837906715377675267450;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = v_uv;\r
    vec3 ray = normalize(v_ray.xyz);\r
\r
    #if defined(CUBE_MAP)\r
        #if __VERSION__ == 100\r
            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\r
        #else\r
            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\r
        #endif\r
    #endif\r
\r
    #if defined(EQUI_MAP)\r
        float v = acos(-ray.y) * OneOverPI;\r
        float m = atan(-ray.x, ray.z);\r
        uv = vec2(m * OneOver2PI + 0.5, v);\r
\r
        fragColor = texture(u_equirectmap, uv);\r
    #endif\r
\r
    #if defined(SPHERE_MAP)\r
        ray = -ray.xzy;\r
        ray.y *= -1.0;\r
        ray.z += +1.0;\r
        uv = 0.5 + 0.5 * ray.xy / length(ray);\r
\r
        fragColor = texture(u_spheremap, uv);\r
    #endif\r
\r
    #if defined(POLAR_MAP)\r
        ray.xz /= abs(ray.y) + 1.0;\r
        ray.xz = ray.xz * 0.5 + 0.5;\r
        ray.x *= -1.0;\r
\r
        fragColor = mix(texture(u_polarmap[1], ray.xz),\r
                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\r
                        step(0.0, ray.y));\r
    #endif\r
}\r
`},3761:p=>{p.exports=`precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    in vec2 a_vertex;\r
#endif\r
\r
\r
uniform mat4 u_viewProjectionInverse;\r
\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\r
\r
    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\r
}\r
`},1687:p=>{p.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  #define fragColor gl_FragColor\r
#else\r
  layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weights[32];\r
uniform vec2 u_delta;\r
\r
uniform sampler2D u_texture;\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\r
    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\r
    {\r
        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\r
        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\r
    }\r
\r
    fragColor = result;\r
}\r
`},9214:p=>{p.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  attribute vec2 a_vertex;\r
#else\r
  layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    v_texCoords = a_vertex * 0.5 + 0.5;\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},9657:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},688:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragDepth gl_FragColor\r
#else \r
    layout(location = 0) out vec4 fragDepth;\r
#endif\r
\r
\r
uniform sampler2D u_texture;\r
uniform vec2 u_offset;\r
uniform vec2 u_scale;\r
\r
varying vec2 v_uv;\r
\r
\r
\r
void main(void)\r
{\r
    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r
    float depth = texture(u_texture, uv).r;\r
\r
    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r
}\r
`},5389:p=>{p.exports=`precision mediump float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
\r
    #ifdef GL_OES_standard_derivatives\r
        #extension GL_OES_standard_derivatives : enable\r
        #define AASTEP\r
    #endif\r
\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
\r
    #define AASTEP\r
\r
#endif\r
\r
\r
uniform sampler2D u_glyphs;\r
uniform vec4 u_color;\r
uniform float u_aaStepScale;\r
uniform int u_aaSampling;\r
\r
varying vec2 v_uv;\r
\r
const int channel = 0;\r
\r
\r
float aastep(float t, float value)\r
{\r
#ifdef AASTEP\r
    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\r
    float afwidth = fwidth(value) * u_aaStepScale;\r
    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\r
     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\r
     */\r
\r
    return smoothstep(t - afwidth, t + afwidth, value);\r
#else\r
    return step(t, value);\r
#endif\r
}\r
\r
float texStep(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return step(t, distanceValue);\r
}\r
\r
float texSmooth(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return aastep(t, distanceValue);\r
}\r
\r
#ifdef AASTEP\r
\r
float aastep3h(float t, vec2 uv)\r
{\r
    float x = dFdy(uv.x) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( -x, 0.0))\r
            + texSmooth(t, uv + vec2(0.0, 0.0))\r
            + texSmooth(t, uv + vec2( +x, 0.0));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3v(float t, vec2 uv)\r
{\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( 0.0,  -y))\r
            + texSmooth(t, uv + vec2( 0.0, 0.0))\r
            + texSmooth(t, uv + vec2( 0.0,  +y));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3x3(float t, vec2 uv)\r
{\r
    float x = dFdx(uv.x) * 1.0 / 3.0;\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\r
            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\r
            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\r
\r
    return v / 9.0;\r
}\r
\r
float aastep4x4(float t, vec2 uv)\r
{\r
    float x0 = dFdx(uv.x);\r
    float y0 = dFdx(uv.y);\r
    float x1 = x0 * 1.0 / 8.0;\r
    float y1 = y0 * 1.0 / 8.0;\r
    float x2 = x0 * 3.0 / 8.0;\r
    float y2 = y0 * 3.0 / 8.0;\r
\r
    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\r
            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\r
\r
            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\r
            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\r
            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\r
            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\r
\r
    return v / 16.0;\r
}\r
\r
// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\r
// {\r
//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\r
// }\r
\r
#endif\r
\r
void main(void)\r
{\r
    /** @todo mipmap access? */\r
\r
    float a = 0.0;\r
    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\r
#ifdef AASTEP\r
    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\r
#endif\r
\r
        a = texStep(0.5, v_uv);\r
\r
#ifdef AASTEP\r
    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\r
        a = texSmooth(0.5, v_uv);\r
    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\r
        a = aastep3h(0.5, v_uv);\r
    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\r
        a = aastep3v(0.5, v_uv);\r
    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\r
        a = aastep3x3(0.5, v_uv);\r
    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\r
        a = aastep4x4(0.5, v_uv);\r
    }\r
#endif\r
\r
    /**\r
     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\r
     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\r
     * it's bad for IMR, TBR, TBDR and early-Z optimization\r
     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\r
     */\r
    if(a <= 0.0) {\r
        discard;\r
    }\r
    fragColor = vec4(u_color.rgb, u_color.a * a);\r
\r
    /* use when pre-multiplied color is required. */\r
    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\r
}\r
`},1616:p=>{p.exports=`precision mediump float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
\r
#extension GL_EXT_draw_buffers : enable\r
attribute vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ] */\r
attribute vec4 a_texCoord;\r
attribute vec3 a_origin;\r
attribute vec3 a_tangent;\r
attribute vec3 a_up;\r
\r
#else\r
\r
in vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ]*/\r
in vec4 a_texCoord;\r
in vec3 a_origin;\r
in vec3 a_tangent;\r
in vec3 a_up;\r
\r
#endif\r
\r
\r
uniform mat4 u_viewProjection;\r
uniform vec2 u_ndcOffset;\r
uniform mat4 u_transform;\r
uniform bool u_dynamic;\r
\r
varying vec2 v_uv;\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
void main(void)\r
{\r
    /* TEXTURE COORDS */\r
\r
    /* flip y-coordinates */\r
    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\r
\r
    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\r
\r
    /* POSITIONING */\r
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\r
     * 2-------4\r
     * |  \\    |\r
     * |    \\  |\r
     * 1-------3\r
     * The current vertex is calculated based on the current quad corners and the tangent attributes.\r
     * The following lines are optimized for MAD optimization.\r
     */\r
    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\r
    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\r
\r
    if(u_dynamic) {\r
        vertex = u_transform * vertex;\r
    }\r
    vertex = u_viewProjection * vertex;\r
\r
    ndcOffset(vertex, u_ndcOffset);\r
    gl_Position = vertex;\r
}\r
`},7032:p=>{p.exports=j_()},421:p=>{p.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},3058:p=>{p.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},6399:p=>{p.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},9148:p=>{p.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},7857:p=>{p.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')}},n={};function b(p){var t=n[p];if(t!==void 0)return t.exports;var i=n[p]={exports:{}};return T[p].call(i.exports,i,i.exports,b),i.exports}b.d=(p,t)=>{for(var i in t)b.o(t,i)&&!b.o(p,i)&&Object.defineProperty(p,i,{enumerable:!0,get:t[i]})},b.o=(p,t)=>Object.prototype.hasOwnProperty.call(p,t),b.r=p=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},b(4985);var y=b(8184);Xf.exports=y})();var N=Xf.exports;const j2=Ov(N),fb=Sv({__proto__:null,default:j2},[N]),nt=class nt{constructor(n,b,y){this._lastChild=nt.INVALID_INDEX,this.index=nt.INVALID_INDEX,this.id=nt.INVALID_ID,this.depth=nt.INVALID_DEPTH,this.parent=nt.INVALID_INDEX,this.firstChild=nt.INVALID_INDEX,this.initialFirstChild=nt.INVALID_INDEX,this.nextSibling=nt.INVALID_INDEX,this.initialNextSibling=nt.INVALID_INDEX,this.id=n,this.index=b,y!==void 0?(this.depth=y.depth+1,this.parent=y.index,y.initialFirstChild===nt.INVALID_INDEX&&(y.initialFirstChild=b,y.firstChild=b),y._lastChild=b):this.depth=0}get lastChild(){return this._lastChild}get isLeaf(){return this.firstChild===nt.INVALID_INDEX}get isRoot(){return this.parent===nt.INVALID_INDEX}};nt.INVALID_ID=-1,nt.INVALID_INDEX=-1,nt.INVALID_DEPTH=-1,nt.INVALID_HEIGHT=-1;let Xe=nt;class k2{constructor(){this._slices=[]}clear(){this._slices=[]}slice(n){if(!(n<0||n>=this._slices.length))return this._slices[n]}startSlice(n){this._slices.push([n,n])}endSlice(n){this._slices[this._slices.length-1][1]=n}nextSlice(n){this.endSlice(n-1),this.startSlice(n)}addSliceByRange(n,b){this._slices.push([n,b])}addSliceByLength(n){if(this.length===0){this._slices.push([0,n-1]);return}const b=this._slices[this._slices.length-1][1];this._slices.push([b+1,b+n])}sliceDo(n,b){if(n<0||n>=this._slices.length)return;const y=this._slices[n];b(y[0],y[1])}slicesDo(n){for(const b of this._slices)n(b[0],b[1])}get slices(){return this._slices}get numberOfInnerNodes(){return this._slices[this._slices.length-1][0]}get numberOfLeafNodes(){return this.numberOfNodes-this.numberOfInnerNodes}get numberOfNodes(){return this._slices[this._slices.length-1][1]+1}get length(){return this._slices.length}}const Ht=N.auxiliaries.assert;class bt{constructor(){this._linearization=new k2,this._nodes=new Array,this._innerNodeIndicesById=new Map,this._leafNodeIndicesById=new Map,this._edgeIndexToTopologyIndexMap=new Array,this._topologyIndexToEdgeIndexMap=new Array}fromInterleavedEdgesIdById(n){Ht(n.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const b=new Array,y=new Map,p=new Array;b.push(new Xe(n[0],0)),y.set(b[0].id,b[0]),p.push(new Array),p[0].push(b[0]);let t=b[0];for(let i=0;i<n.length;i+=2){const a=[n[i+0],n[i+1]],r=i+2<n.length?[n[i+2],n[i+3]]:[Xe.INVALID_ID,Xe.INVALID_ID];if(t.lastChild!==Xe.INVALID_INDEX){const f=b[t.lastChild];Ht(f.nextSibling===Xe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),f.initialNextSibling=b.length,f.nextSibling=b.length}const c=new Xe(a[1],b.length,t);for(b.push(c);p.length<=c.depth;)p.push(new Array);p[c.depth].push(c),y.set(c.id,c),!(r[0]===Xe.INVALID_ID&&r[1]===Xe.INVALID_ID)&&(r[0]===a[1]?t=c:r[0]!==a[0]&&(Ht(y.has(r[0]),`expected next parent to be already created, given ${r[0]}`),t=y.get(r[0])))}this.fromNodes(b,p)}fromInterleavedEdgesIndexById(n){Ht(n.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const b=new Array,y=new Array;let p=0;for(b.push(new Xe(0,0)),y.push(new Array),y[0].push(b[0]),n[0]===-1&&(p+=2);p<n.length;p+=2){const t=[n[p+0],n[p+1]];let i;if(t[0]<b.length&&n[0]===-1?i=b[t[0]]:(Ht(t[0]<b.length,"expected parent to be processed before child"),i=b[t[0]<0?0:t[0]+1]),i.lastChild!==Xe.INVALID_INDEX){const r=b[i.lastChild];Ht(r.nextSibling===Xe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),r.initialNextSibling=b.length,r.nextSibling=b.length}const a=new Xe(t[1],b.length,i);b.push(a),y.length===a.depth&&y.push(new Array),y[a.depth].push(a)}this.fromNodes(b,y)}fromNodes(n,b){this._linearization.clear(),this._innerNodeIndicesById.clear(),this._leafNodeIndicesById.clear(),this._edgeIndexToTopologyIndexMap.length=n.length,this._topologyIndexToEdgeIndexMap.length=n.length,this._edgeIndexToTopologyIndexMap.fill(-1),this._topologyIndexToEdgeIndexMap.fill(-1);const y=new Array,p=new Array;for(const a of b){const r=a.filter(f=>f.isLeaf);for(const f of r)y.push(f);const c=a.filter(f=>!f.isLeaf);c.length>0&&p.push(c)}p.push(y);for(const a of p)this._linearization.addSliceByLength(a.length);const t=new Map;this._nodes.length=n.length,t.set(-1,-1);let i=0;for(const a of p)for(const r of a)this._nodes[i]=r,(r.isLeaf?this._leafNodeIndicesById:this._innerNodeIndicesById).set(r.id,i),t.set(r.index,i),this._edgeIndexToTopologyIndexMap[r.index]=i,this._topologyIndexToEdgeIndexMap[i]=r.index,++i;for(const a of this._nodes)a.index=t.get(a.index),a.parent=t.get(a.parent),a.initialNextSibling=t.get(a.initialNextSibling),a.initialFirstChild=t.get(a.initialFirstChild),a.nextSibling=a.initialNextSibling,a.firstChild=a.initialFirstChild}sliceDo(n,b){const y=(p,t)=>{for(let i=p;i<=t;++i)b(this._nodes[i])};this.sliceRangeDo(n,y)}sliceRangeDo(n,b){this._linearization.sliceDo(n,b)}initialize(n,b,y){switch(b){case bt.InputSemantics.ParentIdId:switch(n){case bt.InputFormat.Tupled:this.fromInterleavedEdgesIdById([].concat(...y));break;case bt.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIdById(y);break}break;case bt.InputSemantics.ParentIndexId:switch(n){case bt.InputFormat.Tupled:this.fromInterleavedEdgesIndexById([].concat(...y));break;case bt.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIndexById(y);break}break}return!0}node(n){if(!(this._nodes.length<=n))return this._nodes[n]}innerNodeIndexById(n){return this._innerNodeIndicesById.get(n)}leafNodeIndexById(n){return this._leafNodeIndicesById.get(n)}innerNodeById(n){const b=this.innerNodeIndexById(n);if(b!==void 0)return this.node(b)}leafNodeById(n){const b=this.leafNodeIndexById(n);if(b!==void 0)return this.node(b)}forEachInnerNode(n){for(let b=0;b<this.depth-1;++b)this.sliceDo(b,n)}parentsDoUntilDepth(n,b){const y=Math.min(Math.max(n,0),this.depth-1);for(let p=0;p<y;++p)this.sliceDo(p,b)}forEachLeafNode(n){this.sliceDo(this.depth-1,n)}nodesDo(n){this.forEachInnerNode(n),this.forEachLeafNode(n)}reverseNodesDo(n){this.forEachLeafNode(n),this.reverseParentsDo(n)}depthFirstDo(n){n(this.root)}childrenDo(n,b){Ht(n!==void 0,"Parent is expected to be valid."),n.firstChild!==Xe.INVALID_INDEX&&this.siblingsDo(this.node(n.firstChild),b)}siblingsDo(n,b){let y=n;for(b(y);y.nextSibling!==Xe.INVALID_INDEX;)y=this.node(y.nextSibling),b(y)}siblingsRangeDo(n,b,y){if(b===void 0)return this.siblingsDo(n,y);for(let p=n;p!==void 0&&p!==b;p=this.node(p.nextSibling))y(p)}reverseParentsDo(n){for(let b=this.depth-2;b>=0;--b)this.sliceDo(b,n)}get linearization(){return this._linearization}get numberOfNodes(){return this._linearization.numberOfNodes}get numberOfInnerNodes(){return this._linearization.numberOfInnerNodes}get numberOfLeafNodes(){return this._linearization.numberOfLeafNodes}get depth(){return this._linearization.length}get root(){return this._nodes[0]}get nodes(){return this._nodes}get edgeIndexToTopologyIndexMap(){return this._edgeIndexToTopologyIndexMap}get topologyIndexToEdgeIndexMap(){return this._topologyIndexToEdgeIndexMap}}(T=>{(n=>{n.Interleaved="interleaved",n.Tupled="tupled"})(T.InputFormat||(T.InputFormat={})),(n=>{n.ParentIdId="parent-id-id",n.ParentIndexId="parent-index-id"})(T.InputSemantics||(T.InputSemantics={})),(n=>{n.TopDown="top-down",n.BottomUp="bottom-up",n.DepthFirst="depth-first"})(T.IterationDirection||(T.IterationDirection={}))})(bt||(bt={}));const jt=N.auxiliaries.assert,U2=N.auxiliaries.log,ll=N.auxiliaries.logIf,Hs=N.auxiliaries.LogLevel;var vs;(T=>{function n(m,v){const _=new Array(m.numberOfNodes);let g;if(v.topology.format===bt.InputFormat.Interleaved){const x=v.topology.edges,E=2*(m.numberOfNodes-1);ll(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),g=w=>{const S=2*(w-1);return jt(S<x.length,`expected an index within the ranges of edges but got ${w}`),S<x.length?[x[S+0],x[S+1]]:[Xe.INVALID_INDEX,Xe.INVALID_INDEX]}}else{const x=v.topology.edges,E=m.numberOfNodes-1;ll(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),g=w=>(jt(w-1<x.length,`expected an index within the ranges of edges but got${w}`),w-1<x.length?x[w-1]:[Xe.INVALID_INDEX,Xe.INVALID_INDEX])}_[0]=0;for(let x=1;x<m.numberOfNodes;x++){let E;const w=g(x);x+1<m.numberOfNodes&&g(x+1)[0]===w[1]?E=m.innerNodeIndexById(w[1]):E=m.leafNodeIndexById(w[1]),jt(E!==void 0,`expected a valid index, given ${E} for ${w[1]}`),_[x]=E}return _}T.normalization_backup=n;function b(m,v){const _=new Float32Array(v.length);ll(v.length!==m.length,Hs.Warning,`expected value buffer to be sized with the number of nodes but got ${m.length} instead of ${v.length}`);for(let g=0;g<_.length;++g)_[v[g]]=m[g];return _}T.renormalize=b;function y(m,v,_){const g=new Float32Array(_.length);switch(g.fill(NaN),v.type){case St.LinearizationMapping.IdMapping:jt(!1,"Id-Mapping not yet implemented");break;case St.LinearizationMapping.IndexMapping:for(let x=0;x<m.length;++x){let E=v.mapping[x];E!==void 0&&(g[_[E]]=m[x])}break}return g}T.renormalize_using_intermediate_linearization=y;function p(m,v,_,g,x){for(const E of g)switch(E.type){case"normalize":T.applyNormalization(m,_,E);break;case"range-transform":T.applyRangeTransform(m,_,E);break;case"propagate-up":T.applyPropagation(m,_,E);break;case"fill-invalid":T.applyFill(m,_,E);break;case"mask":T.applyMask(m,_,E);break;case"clamp":T.applyClamp(m,_,E);break;case"threshold":T.applyThreshold(m,_,E);break;case"compare":T.applyCompare(m,_,E);break;case"transform":T.applyTransform(m,v,_,E,x);break;case"discretize":T.applyDiscretization(m,_,E);break;case"callback":T.applyCallback(m,_,E);break}return _}T.applyTransformations=p;function t(m,v,_){if(m.numberOfLeafNodes===0)return;let g=0,x=1;switch(_.operation){case"zero-to-max":{let E;m.forEachLeafNode(w=>{const S=v[w.index];E=E===void 0?S:Math.max(E,S)}),jt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),g=0,x=1/E}break;case"min-to-max":{let E,w;m.forEachLeafNode(S=>{const R=v[S.index];E=E===void 0?R:Math.max(E,R),w=w===void 0?R:Math.min(w,R)}),jt(E!==void 0,"Valid max expected"),jt(w!==void 0,"Valid min expected"),w===void 0&&(w=0),E===void 0&&(E=1),g=-w,x=1/(E-w)}break;case"sign-agnostic-max":{let E;m.forEachLeafNode(w=>{const S=Math.abs(v[w.index]);E=E===void 0?S:Math.max(E,S)}),jt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),g=0,x=1/E}break}v.forEach((E,w)=>{v[w]=(v[w]+g)*x})}T.applyNormalization=t;function i(m,v,_){if(m.numberOfLeafNodes===0||_.sourceRange===void 0||_.targetRange===void 0)return;const g=_.sourceRange,x=_.targetRange,E=-g[0],w=x[0],S=g[1]===g[0]?0:(x[1]-x[0])/(g[1]-g[0]);for(let R=0;R<v.length;R++)v[R]<g[0]?v[R]=-1:v[R]=w+(v[R]+E)*S}T.applyRangeTransform=i;function a(m,v,_){if(m.numberOfLeafNodes!==0)switch(_.operation){case"average":m.reverseParentsDo(g=>{let x=0,E=0;m.childrenDo(g,w=>{const S=v[w.index];x+=S,++E}),v[g.index]=E===0?0:x/E});break;case"sum":m.reverseParentsDo(g=>{let x=0;m.childrenDo(g,E=>{const w=v[E.index];x+=w}),v[g.index]=x});break;case"min":m.reverseParentsDo(g=>{let x;m.childrenDo(g,E=>{const w=v[E.index];x=x===void 0?w:Math.min(w,x)}),x===void 0&&(x=0),v[g.index]=x});break;case"max":m.reverseParentsDo(g=>{let x;m.childrenDo(g,E=>{const w=v[E.index];x=x===void 0?w:Math.max(w,x)}),x===void 0&&(x=0),v[g.index]=x});break;case"median":m.reverseParentsDo(g=>{const x=new Array;m.childrenDo(g,E=>{const w=v[E.index];x.push(w)}),x.sort(),x.length%2===0?v[g.index]=(x[x.length/2]+x[x.length/2])/2:v[g.index]=x[x.length/2]});break;case"closest-to-zero":m.reverseParentsDo(g=>{let x;m.childrenDo(g,E=>{const w=v[E.index];(x===void 0||Math.abs(w)<Math.abs(x))&&(x=w)}),x===void 0&&(x=0),v[g.index]=x});break;case"closest-to-infinity":m.reverseParentsDo(g=>{let x;m.childrenDo(g,E=>{const w=v[E.index];(x===void 0||Math.abs(w)>Math.abs(x))&&(x=w)}),x===void 0&&(x=0),v[g.index]=x});break;default:U2(Hs.Warning,"Transformation type not recognized.");break}}T.applyPropagation=a;function r(m,v,_){const g=_.value,x="invalidValue"in _?_.invalidValue:void 0;m.nodesDo(E=>{v[E.index]===x&&(v[E.index]=g)})}T.applyFill=r;function c(m,v,_){let g,x;"range"in _?(g=_.range[0],x=_.range[0]):(g=_.min,x=_.max),jt(g<=x,"Require valid min-max range."),m.nodesDo(E=>{const w=v[E.index];w!==void 0&&(v[E.index]=Math.min(x,Math.max(g,w)))})}T.applyClamp=c;function f(m,v,_){const g=_.value;m.nodesDo(x=>{v[x.index]=v[x.index]===g?1:0})}T.applyMask=f;function d(m,v,_){const g=_.value;m.nodesDo(x=>{v[x.index]=v[x.index]>=g?1:0})}T.applyThreshold=d;function h(m,v,_){const g=_.value;m.nodesDo(x=>{v[x.index]=v[x.index]>g?1:v[x.index]<g?-1:0})}T.applyCompare=h;function s(m,v,_,g,x){const E=g.operation,w=g.parameter,S=g.buffer;let R=O=>w;if(S!==void 0){const O=St.create(m,v,S,x);O!==void 0&&(R=I=>O[I.index])}switch(E){case"min":m.nodesDo(O=>{_[O.index]=Math.min(_[O.index],R(O))});break;case"max":m.nodesDo(O=>{_[O.index]=Math.max(_[O.index],R(O))});break;case"add":m.nodesDo(O=>{_[O.index]=_[O.index]+R(O)});break;case"subtract":m.nodesDo(O=>{_[O.index]=_[O.index]-R(O)});break;case"multiply":m.nodesDo(O=>{_[O.index]=_[O.index]*R(O)});break;case"divide":m.nodesDo(O=>{_[O.index]=_[O.index]/R(O)});break;case"inverse":m.nodesDo(O=>{_[O.index]=1/_[O.index]});break;case"pow":m.nodesDo(O=>{_[O.index]=Math.pow(_[O.index],R(O))});break;case"nth-root":m.nodesDo(O=>{const I=1/R(O);_[O.index]=Math.pow(_[O.index],I)});break;case"log":w!==void 0&&w!==0?m.nodesDo(O=>{const I=Math.log(R(O));_[O.index]=Math.log(_[O.index])/I}):m.nodesDo(O=>{_[O.index]=Math.log(_[O.index])});break;case"square":m.nodesDo(O=>{_[O.index]=Math.pow(_[O.index],2)});break;case"square-root":m.nodesDo(O=>{_[O.index]=Math.sqrt(_[O.index])});break;case"as-multiplier":m.nodesDo(O=>{_[O.index]=Math.abs(_[O.index])});break;case"as-remainder":m.nodesDo(O=>{_[O.index]=1-Math.abs(_[O.index])});break;case"abs":m.nodesDo(O=>{_[O.index]=Math.abs(_[O.index])});break;case"compare":m.nodesDo(O=>{const I=_[O.index],D=R(O);I<D?_[O.index]=-1:I>D?_[O.index]=1:_[O.index]=0});break;default:return}}T.applyTransform=s;function o(m,v,_){jt(!1,"Implementation missing")}T.applyDiscretization=o;function u(m,v,_){const g=_.operation;switch(_.iteration){case bt.IterationDirection.TopDown:m.nodesDo(E=>{v[E.index]=g(v[E.index],E,v,m)});break;case bt.IterationDirection.DepthFirst:m.reverseNodesDo(E=>{v[E.index]=g(v[E.index],E,v,m)});break;case bt.IterationDirection.BottomUp:default:m.depthFirstDo(E=>{v[E.index]=g(v[E.index],E,v,m)});break}}T.applyCallback=u})(vs||(vs={}));const Nf=N.auxiliaries.assert,zf=N.auxiliaries.log,Bf=N.auxiliaries.LogLevel;var St;(T=>{(i=>{i.String="string",i.Numbers="numbers",i.Uint8="uint8",i.Int8="int8",i.Uint16="uint16",i.Int16="int16",i.Uint32="uint32",i.Int32="int32",i.Float32="float32",i.Float64="float64"})(T.DataType||(T.DataType={})),(i=>{i.Native="native"})(T.Encoding||(T.Encoding={})),(i=>{i.Topology="topology",i.Identity="identity"})(T.Linearization||(T.Linearization={})),(i=>{i.IdMapping="id-mapping",i.IndexMapping="index-mapping"})(T.LinearizationMapping||(T.LinearizationMapping={}));function n(i,a){return i.edgeIndexToTopologyIndexMap}T.createNormalization=n;function b(i,a,r,c){const f=r.indexOf(":");if(f===void 0||f<0){zf(Bf.Error,"Buffer type not recognized.");return}switch(r.substr(0,f)){case"buffer":return T.createSourceBuffer(a,r.substr(f+1),c);case"bufferView":return T.createView(i,a,r.substr(f+1),c);default:zf(Bf.Error,"Buffer type not recognized.");break}}T.create=b;function y(i){if(i.length!==0)return Array.prototype.reduce.apply(i,[(a,r)=>[Math.min(r,a[0]),Math.max(r,a[1])],[1/0,-1/0]])}T.range=y;function p(i,a,r){const c=r.buffers.find(f=>f.identifier===a);if(!(!c||c.encoding!=="native"))return Nf(c.linearization!=="identity","Expect linearization to be of type topology or mapping. Identity is currently unsupported"),br.isLinearizationMapping(c.linearization)?vs.renormalize_using_intermediate_linearization(c.data,c.linearization,i):(Nf(c.linearization==="topology","Expect linearization to be of type topology or identity."),vs.renormalize(c.data,i))}T.createSourceBuffer=p;function t(i,a,r,c){const f=c.bufferViews.find(h=>h.identifier===r);if(f===void 0)return;const d=T.create(i,a,f.source,c);if(d!==void 0)return f.transformations===void 0||f.transformations.length===0?d:vs.applyTransformations(i,a,d,f.transformations,c)}T.createView=t})(St||(St={}));const G2="http://json-schema.org/draft-06/schema#",q2="Treemap Configuration Schema",W2="JSON schema for a treemap configuration object, targeting the treemap renderer module.",V2="object",$2={topology:{type:"object",properties:{format:{type:"string",enum:["interleaved","tupled"],default:"interleaved"},semantics:{type:"string",enum:["parent-id-id","parent-index-id"],default:"parent-id-id"},edges:{type:"array",items:{anyOf:[{type:"integer",minimum:-1},{type:"array",items:{type:"integer",minimum:-1},minItems:2,maxItems:2,uniqueItems:!0}],minItems:0}}},required:["edges"],additionalProperties:!1},buffers:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},type:{type:"string",enum:["numbers","uint8","uint16","int16","uint32","int32","float32","float64"]},encoding:{type:"string",enum:["base64","native"],default:"native"},data:{anyOf:[{type:"array",items:{type:"number"}},{type:"Uint8Array"},{type:"Uint16Array"},{type:"Int16Array"},{type:"Uint32Array"},{type:"Int32Array"},{type:"Float32Array"},{type:"Float64Array"}]},linearization:{anyOf:[{type:"string",enum:["topology","identity"]},{type:"object",properties:{type:{type:"string",enum:["id-mapping","index-mapping"]},mapping:{type:"array",items:{type:"integer"}}},required:["type","mapping"],additionalProperties:!1}],default:"topology"}},required:["identifier","type","data"],additionalProperties:!1}},bufferViews:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},source:{$ref:"/BufferReference"},transformations:{type:"array",items:{anyOf:[{type:"object",properties:{type:{type:"string",enum:["propagate-up"]},operation:{type:"string",enum:["average","sum","min","max","median","closest-to-zero","closest-to-infinity"]},weight:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["fill-invalid"]},value:{type:"number"},invalidValue:{anyOf:[{type:"number"},{type:"null"}]}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["mask"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},min:{type:"number"},max:{type:"number"}},required:["type","min","max"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},range:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","range"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["range-transform"]},sourceRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2},targetRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","sourceRange","targetRange"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["normalize"]},operation:{type:"string",enum:["zero-to-max","min-to-max","sign-agnostic-max"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["threshold"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["compare"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["transform"]},operation:{type:"string",enum:["add","subtract","multiply","divide","inverse","pow","nth-root","log","square","square-root","as-multiplier","as-remainder","abs"]},parameter:{type:"number",default:0},buffer:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},operation:{type:"string",enum:["quantiles","quartiles"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},percentiles:{type:"array",items:{type:"number"}}},required:["type","percentiles"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["callback"]}},required:["type","operation"],additionalProperties:!0}]}}},required:["identifier","source"],additionalProperties:!1}},colors:{type:"array",items:{oneOf:[{type:"object",properties:{identifier:{type:"string"},colorspace:{type:"string",enum:["rgb","hsl","lab","cmyk","hex"],description:"The color space is based on supported webgl-operate color spaces.",default:"hex"},value:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]},values:{type:"array",minItems:2,items:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]}}},required:["identifier","colorspace"],oneOf:[{type:"object",required:["value"]},{type:"object",required:["values"]}],additionalProperties:!1},{type:"object",properties:{identifier:{type:"string"},preset:{type:"string",description:"The preset from a webgl-operate Color Scheme Preset file."},steps:{type:"number",minimum:3,maximum:12,default:5}},required:["identifier","preset"],additionalProperties:!1}]}},layout:{type:"object",properties:{algorithm:{type:"string",enum:["strip","snake","codecity"]},weight:{$ref:"/BufferReference"},aspectRatio:{type:"number",exclusiveMinimum:0,default:1},sort:{type:"object",properties:{algorithm:{type:"string",enum:["ascending","descending","keep"],default:"keep"},key:{anyOf:[{type:"string",enum:["identity","weight"]},{$ref:"/BufferReference"}],default:"identity"}},required:["algorithm"],additionalProperties:!1},siblingMargin:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0}],default:0}},required:["type","value"],additionalProperties:!1},parentPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute","mixed"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0}},required:["type","value"],additionalProperties:!1},accessoryPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"absolute"},direction:{type:"string",enum:["top","left","bottom","right"],default:"bottom"},value:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}]},relativeAreaThreshold:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0},targetAspectRatio:{anyOf:[{type:"number",minimum:0},{type:"null"}],default:null}},required:["value"],additionalProperties:!1}},required:["algorithm","weight"],additionalProperties:!1},geometry:{type:"object",properties:{parentLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:inner"},showRoot:{type:"boolean",default:!1}},additionalProperties:!1},leafLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:leaf"},height:{$ref:"/BufferReference"},colors:{$ref:"/BufferReference"}},additionalProperties:!1},auxiliary:{$ref:"/ColorReference",default:"color:auxiliary"},emphasis:{type:"object",properties:{outline:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},highlight:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},color:{$ref:"/ColorReference",default:"color:emphasis"},outlineWidth:{type:"number",minimum:0,description:"unit: device-independent pixel",default:1.6}},additionalProperties:!1},heightScale:{anyOf:[{type:"string",enum:["SomethingInverseSqrt"]},{type:"number"}],default:.125},outlineWidth:{type:"number",minimum:0,description:"unit: native pixel",default:.8}},required:[],additionalProperties:!1},labels:{type:"object",properties:{names:{anyOf:[{$ref:"/BufferReference"},{type:"object",additionalProperties:{type:"number"}}]},additionallyLabelSet:{type:"array",items:{type:"number",minimum:0}},innerNodeLayerRange:{type:"array",items:{type:"number",minimum:0},minItems:2,maxItems:2,default:[1,2]},numTopInnerNodes:{type:"number",minimum:0,default:0},numTopWeightNodes:{type:"number",minimum:0,default:0},numTopHeightNodes:{type:"number",minimum:0,default:0},numTopColorNodes:{type:"number",minimum:0,default:0}},required:[]}},H2=["topology","layout"],X2=!1,Y2={$schema:G2,title:q2,description:W2,type:V2,properties:$2,required:H2,additionalProperties:X2},Z2="/BufferReference",K2="string",Q2="^(buffer|bufferView):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",J2="Named identifier used to reference a buffer or buffer view throughout the treemap configuration.",eg={id:Z2,type:K2,pattern:Q2,description:J2},tg="/ColorReference",rg="string",ig="^(color):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",ng="Named identifier used to reference a color throughout the treemap configuration.",ag={id:tg,type:rg,pattern:ig,description:ng},sg="/ColorScheme",og="object",ug={inverted:{type:"boolean",default:!1},classBounds:{type:"array",items:{type:"number"}}},lg={id:sg,type:og,properties:ug},et=class et{constructor(){this._altered=Object.assign(new N.ChangeLookup,{any:!1,topology:!1,buffers:!1,bufferViews:!1,colors:!1,layout:{any:!1,weight:!1,sort:!1,algorithm:!1,siblingMargin:!1,parentPadding:!1,accessoryPadding:!1},geometry:{any:!1,aggregation:!1,outlineWidth:!1,emphasis:{any:!1,outline:!1,highlight:!1,outlineWidth:!1},areaScale:!1,heights:!1,heightScale:!1,colors:!1,parentLayer:!1},labels:!1}),this._buffers=[],this._bufferViews=[],this._colors=[]}get altered(){return this._altered}set topology(n){const b=et.TREEMAP_SCHEMA.properties.topology;N.properties.validate(n,b,[])&&(N.properties.complement(n,b),N.properties.compare(n,this._topology,this._altered,"topology"),this._topology=n)}get topology(){return this._topology}set buffers(n){const b=et.TREEMAP_SCHEMA.properties.buffers;N.properties.validate(n,b,[])&&(N.properties.complement(n,b),N.properties.compare(n,this._buffers,this._altered,"buffers"),this._buffers=n)}get buffers(){return this._buffers}set bufferViews(n){const b=et.TREEMAP_SCHEMA.properties.bufferViews;N.properties.validate(n,b,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(n,b),N.properties.compare(n,this._bufferViews,this._altered,"bufferViews"),this._bufferViews=n)}get bufferViews(){return this._bufferViews}set colors(n){const b=et.TREEMAP_SCHEMA.properties.colors;N.properties.validate(n,b,[[et.COLOR_REFERENCE_SCHEMA,"/ColorReference"]])&&(N.properties.complement(n,b),N.properties.compare(n,this._colors,this._altered,"colors"),this._colors=n)}get colors(){return this._colors}set layout(n){const b=et.TREEMAP_SCHEMA.properties.layout;N.properties.validate(n,b,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(n,b),N.properties.compare(n,this._layout,this._altered,"layout"),this._layout=n)}get layout(){return this._layout}set geometry(n){const b=et.TREEMAP_SCHEMA.properties.geometry;N.properties.validate(n,b,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"],[et.COLOR_REFERENCE_SCHEMA,"/ColorReference"],[et.COLOR_SCHEMA_SCHEMA,"/ColorScheme"]])&&(N.properties.complement(n,b),N.properties.compare(n,this._geometry,this._altered,"geometry"),this._geometry=n)}get geometry(){return this._geometry}set labels(n){const b=et.TREEMAP_SCHEMA.properties.labels;N.properties.validate(n,b,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(n,b),N.properties.compare(n,this._labels,this._altered,"labels"),this._labels=n)}get labels(){return this._labels}labelsToJSON(){const n=Object.assign({},this._labels);return n.names&&typeof n.names!="string"&&(n.names=Object.fromEntries(this._labels.names)),n}toJSON(){return{topology:this.topology,buffers:this.buffers,bufferViews:this.bufferViews,colors:this.colors,layout:this.layout,geometry:this.geometry,labels:this.labelsToJSON()}}};et.TREEMAP_SCHEMA=Y2,et.BUFFER_REFERENCE_SCHEMA=eg,et.COLOR_REFERENCE_SCHEMA=ag,et.COLOR_SCHEMA_SCHEMA=lg;let br=et;(T=>{function n(p){return typeof p=="string"||p instanceof String||p in St.Linearization?!1:"type"in p&&p.type in St.LinearizationMapping&&"mapping"in p}T.isLinearizationMapping=n;function b(p){return typeof p!="object"?!1:"identifier"in p&&"colorspace"in p}T.isColorArray=b;function y(p){return typeof p!="object"?!1:"identifier"in p&&"preset"in p}T.isColorPreset=y})(br||(br={}));var wr;(T=>{function n(p,t="SomethingInverseSqrt"){switch(t){default:case"SomethingInverseSqrt":return N.gl_matrix_extensions.clamp(100/Math.sqrt(p.numberOfNodes)+.0125,.0625,.3333)}}T.heightScale=n,(p=>{p.SomethingInverseSqrt="SomethingInverseSqrt"})(T.HeightScaleApproach||(T.HeightScaleApproach={}));function b(p,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .04+(1-Math.log10(p.numberOfNodes+1)/6)*.12}}T.parentMargin=b;function y(p,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .01+(1-Math.log10(p.numberOfNodes+1)/6)*.12}}T.siblingMargin=y,(p=>{p.SomethingLog10="SomethingLog10"})(T.MarginApproach||(T.MarginApproach={}))})(wr||(wr={}));var cg=Object.defineProperty,hg=Object.getOwnPropertyDescriptor,dg=(T,n,b,y)=>{for(var p=hg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&cg(n,b,p),p},je;const k_=(je=class extends N.Geometry{static referenceVerticesVBO(n){let b;je.VERTICES_BY_CONTEXT.has(n)?b=je.VERTICES_BY_CONTEXT.get(n):(b=new N.Buffer(n,"CuboidVertexVBO"),je.VERTICES_BY_CONTEXT.set(n,b),je.REFCOUNT_BY_TEMPLATE.set(b,0));const y=je.REFCOUNT_BY_TEMPLATE.get(b)+1;return je.REFCOUNT_BY_TEMPLATE.set(b,y),b}static unreferenceTemplateVBO(n){if(!je.VERTICES_BY_CONTEXT.has(n))return;const b=je.VERTICES_BY_CONTEXT.get(n),y=je.REFCOUNT_BY_TEMPLATE.get(b)-1;je.REFCOUNT_BY_TEMPLATE.set(b,y),!(y>0)&&(b.uninitialize(),je.VERTICES_BY_CONTEXT.delete(n),je.REFCOUNT_BY_TEMPLATE.delete(b))}constructor(n,b){super(n,b),b=b!==void 0&&b!==""?b:"CuboidGeometry",this._vertices=je.referenceVerticesVBO(n),this._buffers.push(this._vertices),this._layout=new N.Buffer(n,`${b}LayoutVBO`),this._buffers.push(this._layout),this._ids=new N.Buffer(n,`${b}IdVBO`),this._buffers.push(this._ids),this._emphases=new N.Buffer(n,`${b}EmphasisVBO`),this._buffers.push(this._emphases),this._areaScales=new N.Buffer(n,`${b}AreaScaleVBO`),this._buffers.push(this._areaScales),this._colors=new N.Buffer(n,`${b}ColorVBO`),this._buffers.push(this._colors),this._heights=new N.Buffer(n,`${b}HeightVBO`),this._buffers.push(this._heights)}bindBuffers(n){const b=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,b.FLOAT,!1,20,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._vertices.attribEnable(this._texCoordLocation,2,b.FLOAT,!1,20,12,!0,!1),y.vertexAttribDivisor(this._texCoordLocation,0),this._layout.attribEnable(this._layoutLocation,4,b.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._areaScales.attribEnable(this._areaScaleLocation,1,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._areaScaleLocation,1),this._colors.attribEnable(this._colorLocation,1,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1),this._heights.attribEnable(this._heightLocation,2,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._heightLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._vertices.attribDisable(this._texCoordLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._areaScales.attribDisable(this._areaScaleLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1),this._heights.attribDisable(this._heightLocation,!1,!1)}initialize(n=0,b=1,y=2,p=3,t=4,i=5,a=6,r=7){this._vertexLocation=n,this._texCoordLocation=b,this._idLocation=p,this._layoutLocation=y,this._emphasisLocation=t,this._areaScaleLocation=i,this._colorLocation=a,this._heightLocation=r;const c=this.context.gl,f=super.initialize([c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER]);return this._vertices.data(je.DATA,c.STATIC_DRAW),f&&this._vertices.valid}uninitialize(){je.unreferenceTemplateVBO(this.context),this._layout.uninitialize(),this._ids.uninitialize(),this._emphases.uninitialize(),this._areaScales.uninitialize(),this._colors.uninitialize(),this._heights.uninitialize(),super.uninitialize()}update(){this.bind()}draw(n=0,b=0,y=0){const p=this.context.gl,t=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,p.FLOAT,!1,20,b,!0,!1),this._vertices.attribEnable(this._texCoordLocation,2,p.FLOAT,!1,20,12+b,!0,!1),this._ids.attribEnable(this._idLocation,4,p.UNSIGNED_BYTE,!1,4,n*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,p.FLOAT,!1,16,n*16,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._areaScales.attribEnable(this._areaScaleLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._colors.attribEnable(this._colorLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._heights.attribEnable(this._heightLocation,2,p.UNSIGNED_BYTE,!1,2,n*2,!0,!1),t.drawArraysInstanced(p.TRIANGLE_STRIP,0,4,y)}set layout(n){const b=this.context.gl;this._layout.data(n,b.STATIC_DRAW)}set ids(n){const b=this.context.gl;this._ids.data(n,b.STATIC_DRAW)}set areaScales(n){const b=this.context.gl;this._areaScales.data(n,b.STATIC_DRAW)}set colors(n){const b=this.context.gl;this._colors.data(n,b.STATIC_DRAW)}set emphases(n){const b=this.context.gl;this._emphases.data(n,b.STATIC_DRAW)}set heights(n){const b=this.context.gl;this._heights.data(n,b.STATIC_DRAW)}get valid(){const n=this._layout&&this._layout.valid,b=this._ids&&this._ids.valid,y=this._areaScales&&this._areaScales.valid,p=this._colors&&this._colors.valid,t=this._emphases&&this._emphases.valid,i=this._heights&&this._heights.valid;return this.initialized&&this._vertices.valid&&n&&b&&y&&p&&t&&i}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get areaScaleLocation(){return this._areaScaleLocation}get colorLocation(){return this._colorLocation}get heightLocation(){return this._heightLocation}},je.VERTICES_BY_CONTEXT=new Map,je.REFCOUNT_BY_TEMPLATE=new Map,je.DATA=new Float32Array([0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,0,0,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,1,1,1,1]),je.BYTES_PER_VERTEX=je.DATA.length/6,je);dg([N.Initializable.assert_initialized()],k_.prototype,"draw");let Df=k_;var fg=Object.defineProperty,_g=Object.getOwnPropertyDescriptor,U_=(T,n,b,y)=>{for(var p=_g(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&fg(n,b,p),p};const _r=N.auxiliaries.assert;class Ut extends N.Initializable{constructor(n){super(),this._context=n}initializeES2_basic(n,b){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!0,this._colorRenderTexture.initialize(n,b,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,b,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,b,y.RGB,y.RGB,y.UNSIGNED_BYTE),this._depthStencilRenderbuffer.initialize(n,b,y.DEPTH_STENCIL),this._depthFBO=new N.Framebuffer(this._context,"DepthFBO"),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.initialize([[p.COLOR_ATTACHMENT0,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.clearColor([1,1,1,1],0),this._depthFBO.initialize([[p.COLOR_ATTACHMENT0,this._depthStencilRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._depthFBO.clearColor([1,1,1,1],0)}initializeES2_extensions(n,b){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!1,this._context.isWebGL1&&(_r(this._context.supportsDrawBuffers,"expected WEBGL_draw_buffers to be supported"),_r(this._context.supportsDepthTexture,"expected WEBGL_depth_texture to be supported")),this._colorRenderTexture.initialize(n,b,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,b,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,b,y.DEPTH_STENCIL,y.DEPTH_STENCIL,this._context.depthTexture.UNSIGNED_INT_24_8_WEBGL),this._depthStencilRenderbuffer.initialize(n,b,y.DEPTH_STENCIL),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[p.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._idFBO.initialize([[p.COLOR_ATTACHMENT0,this._idRenderTexture]])}initializeES3(n,b){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!1,_r(this._context.isWebGL2,"expected a webgl2 context"),this._colorRenderTexture.initialize(n,b,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,b,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,b,y.DEPTH24_STENCIL8,y.DEPTH_STENCIL,y.UNSIGNED_INT_24_8),this._depthStencilRenderbuffer.initialize(n,b,y.DEPTH24_STENCIL8),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[p.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]])}initialize(){this._defaultFBO=new N.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new N.Texture2D(this._context,"ColorRenderTexture"),this._idRenderTexture=new N.Texture2D(this._context,"IdRenderTexture"),this._depthStencilRenderTexture=new N.Texture2D(this._context,"DepthStencilRenderTexture"),this._depthStencilRenderbuffer=new N.Renderbuffer(this._context,"DepthStencilRenderbuffer"),this._primaryFBO=new N.Framebuffer(this._context,"PrimaryFBO"),this._secondaryFBO=new N.Framebuffer(this._context,"SecondaryFBO");const n=this._defaultFBO.width,b=this._defaultFBO.height;return this._context.isWebGL2?this.initializeES3(n,b):this._context.supportsDepthTexture&&this._context.supportsDrawBuffers&&this._context.gl.getParameter(this._context.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)>=2?this.initializeES2_extensions(n,b):this.initializeES2_basic(n,b),this._primaryFBO.clearColor([0,0,0,1],0),this._secondaryFBO.clearColor([0,0,0,1],0),this._primaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._primaryFBO.clearStencil(0),this._secondaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._secondaryFBO.clearStencil(0),_r(this._primaryFBO.valid,`${this._primaryFBO.identifier} expected to be valid for rendering`),_r(this._secondaryFBO.valid,`${this._secondaryFBO.identifier} expected to be valid for rendering`),_r(this._idFBO===void 0||this._idFBO.valid,`${this._idFBO?this._idFBO.identifier:""} expected to be valid for rendering`),_r(this._depthFBO===void 0||this._depthFBO.valid,`${this._depthFBO?this._depthFBO.identifier:""} expected to be valid for rendering`),!0}uninitialize(){this._defaultFBO.uninitialize(),this._primaryFBO.uninitialize(),this._idFBO&&this._idFBO.uninitialize(),this._depthFBO&&this._depthFBO.uninitialize(),this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.uninitialize(),this._colorRenderTexture.uninitialize(),this._idRenderTexture.uninitialize(),this._depthStencilRenderTexture.uninitialize()}setClearColor(n){this._primaryFBO.clearColor(n,0),this._secondaryFBO.clearColor(n,0)}resize(n,b){this._primaryFBO.resize(n,b),this._secondaryFBO.resize(n,b),this._idFBO&&this._idFBO.resize(n,b),this._depthFBO&&this._depthFBO.resize(n,b)}get drawRestricted(){return this._drawRestricted}get primaryFBO(){return this._primaryFBO}get secondaryFBO(){return this._secondaryFBO}get defaultFBO(){return this._defaultFBO}get depthFBO(){return this._drawRestricted?this._depthFBO:void 0}get idFBO(){return this._drawRestricted?this._idFBO:void 0}get readBackIdFBO(){return this._idFBO}get colorRenderTexture(){return this._colorRenderTexture}get idRenderTexture(){return this._idRenderTexture}}U_([N.Initializable.initialize()],Ut.prototype,"initialize");U_([N.Initializable.uninitialize()],Ut.prototype,"uninitialize");(T=>{(n=>{n[n.Undefined=-1]="Undefined",n[n.Color=0]="Color",n[n.Id=1]="Id",n[n.Depth=2]="Depth"})(T.Attachment||(T.Attachment={}))})(Ut||(Ut={}));var pg=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec3  a_vertex;
attribute vec4  a_layout; 
attribute vec4  a_id; /* encoded uint32 id in byte4 */
attribute float a_areaScale;
attribute float a_color;
attribute float a_emphasis;
attribute vec2  a_heights; /* [ bottom: float, top: float ] */
attribute vec2  a_texCoord;

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec3  a_vertex;
in vec4  a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4  a_id; /* encoded uint32 id in byte4 */
in float a_areaScale;
in float a_color;
in float a_emphasis;
in vec2  a_heights; /* [ bottom: float, top: float ] */
in vec2  a_texCoord;

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform int u_face;
uniform vec4 u_normalAndLambert;

uniform float u_heightScale;
uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec4 v_uv;

const float ONE_OVER_255 = 1.0 / 255.0;
const int FACE_INDEX_TOP = 1; /* see CuboidRenderPass.FaceIndex.Top */

const vec3 AMBIENT = vec3(0.0, 0.0, 0.0); /* @todo expose to API */
const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

/**
 * Transforms the cuboid vertices based on the associated face and height mapping. An earlier implementation of this
 * used the same geometry template and transformed it to either orientation. The current implementation uses a pre-set
 * vertex sequence/orientation and has to adjust the height only.
 * Appart from that, each cuboid face is moved to its position and adjusted to the provided height values. ID, color,
 * and extent along the y-axis are encoded per vertex (or even per face/cuboid) to reduce per-fragment processing.
 */
void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    float height = (a_heights[1] - a_heights[0]) * u_heightScale;

    /* Compute the position and extend of the cuboid based on the face. */
    vec4 pos = vec4(a_layout[0], u_face == FACE_INDEX_TOP ?
        a_heights[1] * u_heightScale : a_heights[0] * u_heightScale, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], height, a_layout[3], 1.0);

    /* Area scaling */
    float shrinkage = 1.0 - a_areaScale * ONE_OVER_255;
    pos.x += ext.x * shrinkage * 0.5;
    pos.z += ext.z * shrinkage * 0.5;
    ext.x -= ext.x * shrinkage;
    ext.z -= ext.z * shrinkage;

    /* Compute the final vertex position and pass through texture coordinates and layout data. */
    vec4 vertex = vec4(a_vertex, 1.0) * ext + pos;

    v_uv.st = a_texCoord.st;
    v_id = a_id * ONE_OVER_255;

    /* The y-extent provides world-space height of the cuboid that can be used for fragment-processing. */
    v_uv[2] = 1.0; 
    v_uv[3] = height / mix(a_layout[2], a_layout[3], step(5.0, float(u_face)));

    /* REVIEW AND SIMPLIFY THE FOLLOWING COLOR COMPUTATION (probably to many states) */

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    int colorIndex = int(abs(a_color - 32.0));
    v_baseColor = mix(u_colorTable[colorIndex], emphasisColor, step(2.0, a_emphasis));

    vertex = u_viewProjection * vertex;

    v_uv[2] *= (a_texCoord.x - 0.5);
    v_uv[3] *= 1.0 - a_texCoord.y;

    v_baseColor = u_colorTable[colorIndex];
    v_baseColor = mix(v_baseColor, emphasisColor, step(2.0, a_emphasis));

    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline should be darkened based on the face orientation. */
    v_outlineColor.rgb = mix(AMBIENT, v_outlineColor.rgb, u_normalAndLambert[3]);
    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    v_baseColor = mix(vec4(AMBIENT, 1.0), v_baseColor, u_normalAndLambert[3]);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,vg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

uniform int u_face;

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;

varying vec4 v_id;
varying vec4 v_uv;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];
    vec2 awidth2 = fwidth(v_uv.zw);

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step(v_uv.st - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(1.0), v_uv.st + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,mg=Object.defineProperty,gg=Object.getOwnPropertyDescriptor,Mr=(T,n,b,y)=>{for(var p=gg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&mg(n,b,p),p};const bg=N.auxiliaries.log,yg=N.auxiliaries.LogLevel;var Ae;const Sr=(Ae=class extends N.Initializable{constructor(n){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!0,camera:!0,geometry:!0,colorTable:!0,colorTableLength:!0,emphases:!0,heightScale:!0,outlineWidth:!0,emphasisOutlineWidth:!0}),this._outlineWidth=Ae.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Ut.Attachment.Undefined,this._faceSequence=new Array,this._faceData=new Map,this._context=n,this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._program=new N.Program(n,"CuboidRenderProgram"),this._geometry=Ae.referenceGeometry(n)}static referenceGeometry(n){let b;Ae.GEOMETRY_BY_CONTEXT.has(n)?b=Ae.GEOMETRY_BY_CONTEXT.get(n):(b=new Df(n,"CuboidGeometry"),b.initialize(),Ae.GEOMETRY_BY_CONTEXT.set(n,b),Ae.REFCOUNT_BY_GEOMETRY.set(b,0));const y=Ae.REFCOUNT_BY_GEOMETRY.get(b)+1;return Ae.REFCOUNT_BY_GEOMETRY.set(b,y),b}static unreferenceGeometry(n){if(!Ae.GEOMETRY_BY_CONTEXT.has(n))return;const b=Ae.GEOMETRY_BY_CONTEXT.get(n),y=Ae.REFCOUNT_BY_GEOMETRY.get(b)-1;Ae.REFCOUNT_BY_GEOMETRY.set(b,y),!(y>0)&&(b.uninitialize(),Ae.GEOMETRY_BY_CONTEXT.delete(n),Ae.REFCOUNT_BY_GEOMETRY.delete(b))}relink(){if(this._colorTable===void 0){bg(yg.Warning,"Color table is not defined. Could not compile shaders.");return}for(const n of this._program.shaders)n.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_areaScale",this._geometry.areaScaleLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation),this._program.attribute("a_heights",this._geometry.heightLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation);for(const n of this._program.shaders)n.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uFace=this._program.uniform("u_face"),this._uNormalAndLambert=this._program.uniform("u_normalAndLambert"),this._uHeightScale=this._program.uniform("u_heightScale"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}optimizeFaceSequence(){const n=this._camera.eye,b=this._camera.center;let y=new Array;const p=N.vec3.create();N.vec3.sub(p,n,b),N.vec3.normalize(p,p),n[1]>0&&y.push([Ae.Face.Top,Math.abs(N.vec3.dot(N.vec3.fromValues(0,1,0),p))]),n[2]>-1&&y.push([Ae.Face.Front,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,1),p))]),n[2]<1&&y.push([Ae.Face.Back,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,-1),p))]),n[0]>-1&&y.push([Ae.Face.Left,Math.abs(N.vec3.dot(N.vec3.fromValues(1,0,0),p))]),n[0]<1&&y.push([Ae.Face.Right,Math.abs(N.vec3.dot(N.vec3.fromValues(-1,0,0),p))]),y=y.sort((t,i)=>i[1]-t[1]),this._faceSequence=y.map(t=>t[0])}initialize(){const n=this._context.gl;this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const b=new N.Shader(this._context,n.VERTEX_SHADER,"cuboid.vert");b.initialize(pg,!1);const y=new N.Shader(this._context,n.FRAGMENT_SHADER,"cuboid.frag");return y.initialize(vg,!1),this._program.initialize([b,y],!1),this._faceData.set(Ae.Face.Top,[0,1,0,1]),this._faceData.set(Ae.Face.Bottom,[0,-1,0,.68]),this._faceData.set(Ae.Face.Front,[0,0,1,.88]),this._faceData.set(Ae.Face.Back,[0,0,-1,.88]),this._faceData.set(Ae.Face.Left,[1,0,0,.84]),this._faceData.set(Ae.Face.Right,[-1,0,0,.84]),!0}uninitialize(){Ae.unreferenceGeometry(this._context),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uFace=void 0,this._uNormalAndLambert=void 0,this._uHeightScale=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const n=this._context.gl;let b=!1;if(!this._program.initialized||!this._program.linked||this._altered.colorTableLength){if(this.relink(),!this._program.linked)return;b=!0}if(this._program.bind(),(b||this._altered.camera||this._camera.altered)&&(n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this.optimizeFaceSequence()),(b||this._colorTable)&&n.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),(b||this._altered.heightScale)&&n.uniform1f(this._uHeightScale,this._heightScale/255),(b||this._altered.outlineWidth)&&n.uniform1f(this._uOutlineWidth,this._outlineWidth),b||this._altered.emphasisOutlineWidth){const y=window.devicePixelRatio;n.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*y)}this._altered.reset()}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0||this._geometry.valid===void 0)return;const n=this._context.gl,b=this._target.size;n.viewport(0,0,b[0],b[1]),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,2,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),this._drawRestricted&&n.uniform1i(this._uAttachment,this._attachment),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind();for(const y of this._faceSequence){n.uniform1i(this._uFace,y),n.uniform4fv(this._uNormalAndLambert,this._faceData.get(y));const p=(y-1)*Df.BYTES_PER_VERTEX*4;this._topology.sliceRangeDo(this._topology.depth-1,(t,i)=>{const a=t-this._topology.numberOfInnerNodes,r=i-t+1;this._geometry.draw(a,p,r)})}this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.STENCIL_TEST),n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE)}colorTableLengthAltered(){this._altered.alter("colorTableLength")}set target(n){this.assertInitialized(),this._target=n}set topology(n){this._topology=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set layoutData(n){this.assertInitialized(),this._geometry.layout=n,this._altered.alter("geometry")}set ids(n){this.assertInitialized(),this._geometry.ids=n,this._altered.alter("geometry")}set areaScales(n){this.assertInitialized(),this._geometry.areaScales=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set emphases(n){this.assertInitialized(),this._geometry.emphases=n,this._altered.alter("emphases")}set heights(n){this.assertInitialized(),this._geometry.heights=n,this._altered.alter("geometry")}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}set outlineWidth(n){this.assertInitialized(),this._outlineWidth!==n&&(this._outlineWidth=n===void 0?Ae.OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth!==n&&(this._emphasisOutlineWidth=n===void 0?Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("emphasisOutlineWidth"))}set heightScale(n){this.assertInitialized(),this._heightScale!==n&&(this._heightScale=n===void 0?0:N.gl_matrix_extensions.clamp(n,0,1),this._altered.alter("heightScale"))}set attachment(n){N.auxiliaries.logIf(n!==Ut.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=n}set depthMask(n){this._depthMask=n}},Ae.GEOMETRY_BY_CONTEXT=new Map,Ae.REFCOUNT_BY_GEOMETRY=new Map,Ae.OUTLINE_WIDTH_DEFAULT=.8,Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT=1.6,Ae);Mr([N.Initializable.assert_initialized()],Sr.prototype,"relink");Mr([N.Initializable.assert_initialized()],Sr.prototype,"optimizeFaceSequence");Mr([N.Initializable.initialize()],Sr.prototype,"initialize");Mr([N.Initializable.uninitialize()],Sr.prototype,"uninitialize");Mr([N.Initializable.assert_initialized()],Sr.prototype,"update");Mr([N.Initializable.assert_initialized()],Sr.prototype,"frame");let vr=Sr;(T=>{(n=>{n[n.Top=1]="Top",n[n.Bottom=2]="Bottom",n[n.Front=3]="Front",n[n.Back=4]="Back",n[n.Left=5]="Left",n[n.Right=6]="Right"})(T.Face||(T.Face={}))})(vr||(vr={}));var _s=j_();const ps=N.gl_matrix_extensions.v2,Ke=N.gl_matrix_extensions.v3,jf=N.gl_matrix_extensions.sign,kf=N.gl_matrix_extensions.clamp,cl=N.gl_matrix_extensions.clamp3,Or=N.auxiliaries.DEG2RAD,hl=N.auxiliaries.assert;class Xs{constructor(){this.screen=N.vec2.create(),this.world=N.vec3.create()}}const pt=class pt extends N.CameraModifier{constructor(){super(...arguments),this.initialPoints=[new Xs,new Xs],this.currentPoints=[new Xs,new Xs],this.initialEye=N.vec3.create(),this.initialCenter=N.vec3.create(),this.initialViewProjectionInverse=N.mat4.create(),this._xAxisScreenSpace=N.vec3.create(),this._maxAngles=[+Math.PI*.6666-Math.PI,60*Or-Math.PI],this._minAngles=[-Math.PI*.6666-Math.PI,-Math.PI+1*Or],this.referencePlane=[N.vec3.create(),N.vec3.create(),0]}get valid(){return this.initialPoints[0].world!==void 0}set camera(n){this._camera=n}needStart(){return this._maxAngles===void 0||this._minAngles===void 0}set coordsAccess(n){this._coordsAccess=n}static rayY0SquareIntersection(n,b){const y=N.ray_math.rayPlaneIntersection(n,b);if(y===void 0)return;const p=N.vec2.fromValues(y[0],y[2]);return N.ray_math.isPointWithinSquare(p,pt.HALF_SQUARE_LENGTH)?y:void 0}assert_valid(){}invalidate(){this.initialPoints[0].world=void 0,this.currentPoints[0].world=void 0,this.initialPoints[1].world=void 0,this.currentPoints[1].world=void 0}initiateTranslateConstraints(n){if(n){this._maxNegativeTranslate=void 0,this._maxPositiveTranslate=void 0;return}const b=N.vec3.fromValues(-1,0,-1),y=N.vec3.fromValues(1,0,1);this._maxNegativeTranslate=N.vec3.sub(Ke(),b,this.initialCenter),this._maxPositiveTranslate=N.vec3.sub(Ke(),y,this.initialCenter)}initiateScaleConstraints(n){const b=N.vec3.sub(Ke(),this.initialEye,this.initialCenter),y=1/N.vec3.length(b);if(n){this._minScale=this._camera.near*y-1,this._maxScale=this._camera.far*y-1;return}N.ray_math.rayPlaneIntersection(this.initialEye,this.initialCenter,[0,0,0],[0,1,0])&&(this._minScale=this._camera.near*pt.MIN_NEAR_PLANE_FACTOR*y-1,this._maxScale=pt.MAX_DISTANCE_TO_SQUARE*y-1)}initiateRotateConstraints(n){const b=N.vec3.normalize(Ke(),N.vec3.sub(Ke(),this.initialEye,this.initialCenter));this._xAxisScreenSpace=N.vec3.cross(Ke(),[0,1,0],b);const y=Math.acos(N.vec3.dot(b,[0,1,0]));if(this._maxAngles=[void 0,(90-.01)*Or-y],this._minAngles=[void 0,-y+.01*Or],n)return;const p=N.vec2.normalize(ps(),[b[0],b[2]]);let t=Math.asin(N.vec2.dot(p,[1,0]));p[1]<0&&(t=jf(t)*Math.PI-t),this._maxAngles=[+Math.PI*.6666-t,60*Or-y],this._minAngles=[-Math.PI*.6666-t,-y+1*Or]}initiate(n,b,y=[!1,!1,!1],p=!1){this._override=p;const t=this._camera.viewProjectionInverse;return t?(N.mat4.copy(this.initialViewProjectionInverse,t),N.vec3.copy(this.initialEye,this._camera.eye),N.vec3.copy(this.initialCenter,this._camera.center),N.vec2.copy(this.initialPoints[0].screen,n),this.initialPoints[0].world=this.coordsAt(n,!1),this.initialPoints[0].world===void 0?(this.invalidate(),!1):(this.initialPoints[1].screen=b===void 0?void 0:N.vec2.copy(ps(),b),this.initialPoints[1].world=this.coordsAt(b,!1),this.referencePlane[0]=this.initialPoints[0].world,this.referencePlane[1]=N.vec3.fromValues(0,1,0),this.referencePlane[2]=N.vec3.length(this.initialPoints[0].world),hl(this.initialCenter[1]===0,"camera center is expected to be on y = 0 (ground plane)"),y[0]&&this.initiateTranslateConstraints(p),y[1]&&this.initiateScaleConstraints(p),y[2]&&this.initiateRotateConstraints(p),!0)):!1}update_positions(n,b){return this.assert_valid(),this.currentPoints[0].world=this.coordsAt(n),this._override&&this.currentPoints[0].world===void 0?(this.invalidate(),!1):(N.vec2.copy(this.currentPoints[0].screen,n),b===void 0?!0:(this.currentPoints[1].world=this.coordsAt(b),this._override&&this.currentPoints[1].world===void 0?(this.invalidate(),!1):(this.currentPoints[1].screen=b===void 0?void 0:N.vec2.copy(ps(),b),!0)))}translate(){this.assert_valid();const n=this.initialPoints[0].world,b=this.currentPoints[0].world;if(!n||!b)return;const y=N.vec3.subtract(Ke(),n,b);this._maxNegativeTranslate&&this._maxPositiveTranslate&&cl(y,y,this._maxNegativeTranslate,this._maxPositiveTranslate),this._camera.eye=N.vec3.add(Ke(),this.initialEye,y);const p=N.vec3.add(Ke(),this.initialCenter,y),t=N.ray_math.rayPlaneIntersection(this._camera.eye,p);t&&(this._camera.center=t)}scale(n){this.assert_valid(),hl(this._minScale!==void 0&&this._maxScale!==void 0,"valid scale constraints expected");let b;if(n===void 0){const c=this.currentPoints[0].screen,f=this.initialPoints[0].screen;if(!f||!c)return;b=N.vec2.subtract(ps(),f,c)[1]/window.devicePixelRatio}else b=-jf(n)*pt.SCALE_STEP_FACTOR;b=kf(b*pt.SCALE_FACTOR,this._minScale,this._maxScale);const y=this.initialPoints[0].world;if(!y)return;const p=N.vec3.sub(Ke(),this.initialEye,y),t=N.vec3.sub(Ke(),this.initialCenter,y),i=N.vec3.add(Ke(),this.initialEye,N.vec3.scale(Ke(),p,b)),a=N.vec3.add(Ke(),this.initialCenter,N.vec3.scale(Ke(),t,b)),r=N.ray_math.rayPlaneIntersection(this._camera.eye,a);r&&(this._camera.center=this._override?r:cl(Ke(),r,[-1,0,-1],[1,0,1]),this._camera.eye=N.vec3.add(Ke(),i,N.vec3.sub(Ke(),this._camera.center,r)))}rotate(){this.assert_valid();const n=this.currentPoints[0].screen,b=this.initialPoints[0].screen;if(!b||!n)return;const y=N.vec2.subtract(ps(),b,n);N.vec2.scale(y,y,window.devicePixelRatio*pt.ROTATE_FACTOR),this._minAngles[1]&&this._maxAngles[1]&&(y[1]=kf(y[1],this._minAngles[1],this._maxAngles[1]));const p=this._override?this.initialCenter:cl(Ke(),this.initialCenter,[-1,0,-1],[1,0,1]),t=N.mat4.translate(N.mat4.create(),N.mat4.create(),p);N.mat4.rotateY(t,t,y[0]),N.mat4.rotate(t,t,y[1],this._xAxisScreenSpace),N.mat4.translate(t,t,N.vec3.negate(Ke(),p)),this._camera.center=p;const i=N.vec3.transformMat4(Ke(),this.initialEye,t);i&&(this._camera.eye=i)}coordsAt(n,b=!0){if(n===void 0)return;const y=b?this.initialViewProjectionInverse:this._camera.viewProjectionInverse;if(b){hl(this.referencePlane[0]!==void 0&&this.referencePlane[1]!==void 0,"valid reference plane expected for reference coordinate retrieval");const a=this._coordsAccess(n[0],n[1],0,y),r=this._coordsAccess(n[0],n[1],1,y);return N.ray_math.rayPlaneIntersection(a,r,this.referencePlane[0],this.referencePlane[1])}const p=this._coordsAccess(n[0],n[1],void 0,y);if(p!==void 0)return p;const t=this._coordsAccess(n[0],n[1],0,y),i=this._coordsAccess(n[0],n[1],1,y);return pt.rayY0SquareIntersection(t,i)}update(){}};pt.HALF_SQUARE_LENGTH=2,pt.SCALE_FACTOR=.004,pt.SCALE_STEP_FACTOR=16,pt.ROTATE_FACTOR=.002,pt.MAX_DISTANCE_TO_SQUARE=4,pt.MIN_NEAR_PLANE_FACTOR=4;let pl=pt;const Uf=N.auxiliaries.assert,Gf=N.gl_matrix_extensions.v2;class at{constructor(n,b){this._mouseMovedSinceDown=!1,this._cameraModifier=new pl,this._nodeEnterSubject=new _s.ReplaySubject(1),this._nodeMoveSubject=new _s.ReplaySubject(1),this._nodeLeaveSubject=new _s.ReplaySubject(1),this._nodeSelectSubject=new _s.ReplaySubject(1),this._navigationStartSubject=new _s.ReplaySubject(1),this._invalidate=n;const y="ontouchstart";this._touchSupported=document.documentElement&&y in document.documentElement||y in document.body,b.mouseEventProvider.preventDefault(N.MouseEventProvider.Type.Wheel,N.MouseEventProvider.Type.Click),b.pointerEventProvider.preventDefault(N.PointerEventProvider.Type.Down,N.PointerEventProvider.Type.Move,N.PointerEventProvider.Type.Up),this._eventHandler=new N.EventHandler(n,b),this._eventHandler.pushMouseDownHandler((p,t)=>this.onMouseDown(p,t)),this._eventHandler.pushMouseUpHandler((p,t)=>this.onMouseUp(p,t)),this._eventHandler.pushMouseMoveHandler((p,t)=>this.onMouseMove(p,t)),this._eventHandler.pushMouseWheelHandler((p,t)=>this.onMouseWheel(p,t)),this._eventHandler.pushClickHandler((p,t)=>this.onClick(p,t)),this._touchSupported&&(this._eventHandler.pushTouchStartHandler((p,t)=>this.onTouchStart(p,t)),this._eventHandler.pushTouchEndHandler((p,t)=>this.onTouchEnd(p,t)),this._eventHandler.pushTouchMoveHandler((p,t)=>this.onTouchMove(p,t)),this._eventHandler.pushTouchCancelHandler((p,t)=>this.onTouchCancel(p,t)))}mode(n){const b=n.type==="mousedown"||n.type==="mousemove",y=n.type==="wheel";if(b&&this.isPrimaryButtonDown(n))return at.Mode.Rotate;if(b&&this.isSecondaryButtonDown(n))return at.Mode.Pan;if(b&&this.isAuxiliaryButtonDown(n))return at.Mode.Zoom;if(y)return at.Mode.ZoomStep;if(this._touchSupported&&n instanceof TouchEvent&&n.touches.length===1)return at.Mode.Pan}rotate(n,b){const y=N.vec2.fromValues(n.clientX,n.clientY);b||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!1,!0],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.rotate())}pan(n,b){const y=this._eventHandler.offsets(n)[0];b||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!0,!1,!1],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.translate())}zoom(n,b){const y=this._eventHandler.offsets(n)[0];b||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!0,!1],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.scale())}emitNodeMovementEvents(n){if(this._idAccess===void 0)return;const b=this._eventHandler.offsets(n,!1)[0],y=N.vec2.scale(Gf(),b,window.devicePixelRatio),p=this._idAccess.idAt(y[0],y[1]);this._lastNode===p&&p!==void 0&&this._nodeMoveSubject.next({node:p,point:b}),this._lastNode!==p&&this._lastNode!==void 0&&this._nodeLeaveSubject.next({node:this._lastNode,point:b}),this._lastNode!==p&&p!==void 0&&this._nodeEnterSubject.next({node:p,point:b}),this._lastNode=p}emitNodeClick(n){if(this._idAccess===void 0)return;const b=this._eventHandler.offsets(n,!1)[0],y=N.vec2.scale(Gf(),b,window.devicePixelRatio),p=this._idAccess.idAt(y[0],y[1]);p!==void 0&&this._nodeSelectSubject.next({node:p,point:b})}applyZoomStep(n){const b=this._eventHandler.offsets(n)[0];this._cameraModifier.initiate(b,void 0,[!1,!0,!1],n.shiftKey),n.preventDefault(),this._cameraModifier.scale(n.deltaY)}onMouseDown(n,b){this._mouseMovedSinceDown=!1}onMouseUp(n,b){}onMouseMove(n,b){const y=n[n.length-1];this._mouseMovedSinceDown=!0;const p=this._mode===void 0;switch(this._mode=this.mode(y),this._mode){case at.Mode.Rotate:this.rotate(y,p),p&&this._navigationStartSubject.next();return;case at.Mode.Pan:this.pan(y,p),p&&this._navigationStartSubject.next();return;case at.Mode.Zoom:this.zoom(y,p),p&&this._navigationStartSubject.next();return;default:this.emitNodeMovementEvents(y);break}}onClick(n,b){const y=n[n.length-1];switch(this._mode){case at.Mode.Rotate:case at.Mode.Pan:case at.Mode.Zoom:return;default:this.emitNodeClick(y);break}}onMouseWheel(n,b){const y=n[n.length-1];switch(this._mode=this.mode(y),this._mode){case at.Mode.ZoomStep:this.applyZoomStep(y),this._navigationStartSubject.next();break}}onTouchStart(n,b){const y=n[n.length-1];if(this._mode=this.mode(y),this._mode===at.Mode.Pan){this.pan(y,!0);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchMove(n,b){const y=n[n.length-1],p=this._mode===void 0;if(this._mode=this.mode(y),this._mode===at.Mode.Pan){this.pan(y,p);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchEnd(n,b){}onTouchCancel(n,b){}isPrimaryButtonDown(n){return(n.buttons===void 0?n.which:n.buttons)===1}isSecondaryButtonDown(n){return n.buttons===void 0?n.which===3:n.buttons===2}isAuxiliaryButtonDown(n){return n.buttons===void 0?n.which===2:n.buttons===4}update(){this._eventHandler.update()}set camera(n){this._camera=n,this._cameraModifier.camera=n}set coordsAccess(n){this._coordsAccess=n,this._cameraModifier.coordsAccess=this._coordsAccess.coordsAt}set idAccess(n){this._idAccess=n}get nodeEnter$(){return this._nodeEnterSubject.asObservable()}get nodeMove$(){return this._nodeMoveSubject.asObservable()}get nodeLeave$(){return this._nodeLeaveSubject.asObservable()}get nodeSelect$(){return this._nodeSelectSubject.asObservable()}get navigationStart$(){return this._navigationStartSubject.asObservable()}}(T=>{(n=>{n[n.Move=0]="Move",n[n.Pan=1]="Pan",n[n.Rotate=2]="Rotate",n[n.Zoom=3]="Zoom",n[n.ZoomStep=4]="ZoomStep"})(T.Mode||(T.Mode={}))})(at||(at={}));var Eg=Object.defineProperty,Tg=Object.getOwnPropertyDescriptor,xg=(T,n,b,y)=>{for(var p=Tg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&Eg(n,b,p),p};class G_ extends N.Geometry{constructor(n,b){super(n,b),b=b!==void 0&&b!==""?b:"PointGeometry",this._vertices=new N.Buffer(n,`${b}VertexVBO`),this._buffers.push(this._vertices),this._colors=new N.Buffer(n,`${b}ColorVBO`),this._buffers.push(this._colors)}bindBuffers(n){const b=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,b.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._colors.attribEnable(this._colorLocation,4,b.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,0)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(n=0,b=1){this._vertexLocation=n,this._colorLocation=b;const y=this.context.gl;return super.initialize([y.ARRAY_BUFFER,y.ARRAY_BUFFER])&&this._vertices.valid}update(){this.bind()}draw(n=0){if(!this._count)return;const b=this.context.gl;this._vertices.attribEnable(this._vertexLocation,3,b.FLOAT,!1,0,n*4,!0,!1),this._colors.attribEnable(this._colorLocation,4,b.FLOAT,!1,0,n*4,!0,!1),b.drawArrays(b.POINTS,0,this._count)}set vertices(n){this._count=n.length/3,this._vertices.data(n,this.context.gl.STATIC_DRAW)}set colors(n){this._colors.data(n,this.context.gl.STATIC_DRAW)}get valid(){return this.initialized&&this._vertices.valid&&this._colors&&this._colors.valid}get vertexLocation(){return this._vertexLocation}get colorLocation(){return this._colorLocation}}xg([N.Initializable.assert_initialized()],G_.prototype,"draw");var Ag=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100
attribute vec3 a_vertex;
attribute vec4 a_color;
#else

in vec3 a_vertex;
in vec4 a_color;
#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;
uniform float u_pointSize;

varying vec4 v_color;

void main(void)
{
    vec4 vertex = u_viewProjection * vec4(a_vertex, 1.0);

    v_color = a_color;

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
    gl_PointSize = u_pointSize;
}`,Sg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
    #endif
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying vec4 v_color;

void main(void)
{
    
    
    

    float dist = distance(gl_PointCoord, vec2(0.5, 0.5));
    float alpha = v_color.a - step(0.5, dist);

    fragColor = vec4(v_color.xyz, alpha);
}`,Og=Object.defineProperty,Rg=Object.getOwnPropertyDescriptor,Ss=(T,n,b,y)=>{for(var p=Rg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&Og(n,b,p),p};class Ir extends N.Initializable{constructor(n){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=n,this._program=new N.Program(n,"PointRenderProgram"),this._geometry=new G_(this._context,"Point")}relink(){for(const n of this._program.shaders)n.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uPointSize=this._program.uniform("u_pointSize"))}initialize(){const n=this._context.gl,b=new N.Shader(this._context,n.VERTEX_SHADER,"point.vert");b.initialize(Ag,!1);const y=new N.Shader(this._context,n.FRAGMENT_SHADER,"point.frag");return y.initialize(Sg,!1),this._program.initialize([y,b],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uPointSize=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const n=this._context.gl,b=this._target.size;n.viewport(0,0,b[0],b[1]),n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),n.uniform2fv(this._uNdcOffset,this._ndcOffset),n.uniform1f(this._uPointSize,this._pointSize*window.devicePixelRatio),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.BLEND)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set pointSize(n){this._pointSize=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set positions(n){this._geometry.vertices=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set depthMask(n){this._depthMask=n}}Ss([N.Initializable.assert_initialized()],Ir.prototype,"relink");Ss([N.Initializable.initialize()],Ir.prototype,"initialize");Ss([N.Initializable.uninitialize()],Ir.prototype,"uninitialize");Ss([N.Initializable.assert_initialized()],Ir.prototype,"update");Ss([N.Initializable.assert_initialized()],Ir.prototype,"frame");var wg=Object.defineProperty,Pg=Object.getOwnPropertyDescriptor,Lg=(T,n,b,y)=>{for(var p=Pg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&wg(n,b,p),p},mr;const q_=(mr=class extends N.Geometry{constructor(n,b){super(n,b),b=b!==void 0&&b!==""?b:"QuadGeometry",this._vertices=new N.Buffer(n,b+"VertexVBO"),this._buffers.push(this._vertices),this._layout=new N.Buffer(n,b+"LayoutVBO"),this._buffers.push(this._layout),this._ids=new N.Buffer(n,b+"IdVBO"),this._buffers.push(this._ids),this._emphases=new N.Buffer(n,b+"EmphasisVBO"),this._buffers.push(this._emphases),this._colors=new N.Buffer(n,b+"ColorVBO"),this._buffers.push(this._colors)}bindBuffers(n){const b=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,b.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._layout.attribEnable(this._layoutLocation,4,b.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._colors.attribEnable(this._colorLocation,1,b.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this.vertexLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(n=0,b=2,y=3,p=4,t=5){this._vertexLocation=n,this._idLocation=y,this._layoutLocation=b,this._colorLocation=t,this._emphasisLocation=p;const i=this.context.gl,a=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(mr.DATA,i.STATIC_DRAW),a&&this._vertices.valid}update(){this.bind()}draw(n=0,b=0){const y=this.context.gl,p=this.context.gl2facade;this._ids.attribEnable(this._idLocation,4,y.UNSIGNED_BYTE,!1,4,n*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,y.FLOAT,!1,16,n*16,!0,!1),this._colors.attribEnable(this._colorLocation,1,y.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,y.UNSIGNED_BYTE,!1,1,n*1,!0,!1),p.drawArraysInstanced(y.TRIANGLE_STRIP,0,4,b)}set layout(n){this._layout.data(n,this.context.gl.STATIC_DRAW)}set ids(n){this._ids.data(n,this.context.gl.STATIC_DRAW)}set colors(n){this._colors.data(n,this.context.gl.STATIC_DRAW)}set emphases(n){this._emphases.data(n,this.context.gl.STATIC_DRAW)}get valid(){const n=this._layout&&this._layout.valid,b=this._ids&&this._ids.valid,y=this._colors&&this._colors.valid,p=this._emphases&&this._emphases.valid;return this.initialized&&this._vertices.valid&&n&&b&&y&&p}get vertexLocation(){return this._vertexLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get colorLocation(){return this._colorLocation}},mr.DATA=new Float32Array([0,0,0,1,1,0,1,1]),mr);Lg([N.Initializable.assert_initialized()],q_.prototype,"draw");let Mg=q_;var Ig=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec2 a_vertex;
attribute vec4 a_layout; 
attribute vec4 a_id; /* encoded uint32 id in byte4 */
attribute float a_color; /* color index as unsigned byte */
attribute float a_emphasis; /* emphasis mode as unsigned byte */

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec2 a_vertex;
in vec4 a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4 a_id; /* encoded uint32 id in byte4 */
in float a_color; /* color index as unsigned byte */
in float a_emphasis; /* emphasis mode as unsigned byte */

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec2 v_uv;
varying vec4 v_layout;

const float ONE_OVER_255 = 1.0 / 255.0;

const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    vec4 pos = vec4(a_layout[0], 0.0, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], 0.0, a_layout[3], 1.0);

    vec4 vertex = vec4(a_vertex.x, 0.0, a_vertex.y, 1.0) * ext + pos;

    v_uv = vertex.xz;
    v_layout = a_layout;
    v_id = a_id * ONE_OVER_255;

    vertex = u_viewProjection * vertex;

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    v_baseColor = mix(u_colorTable[int(a_color)], emphasisColor, step(2.0, a_emphasis));
    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,Fg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying mediump vec2 v_uv;
varying mediump vec4 v_layout;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step((v_uv.st - v_layout.xy) - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(0.0), (v_uv.st - v_layout.xy) - v_layout.zw + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,Cg=Object.defineProperty,Ng=Object.getOwnPropertyDescriptor,Os=(T,n,b,y)=>{for(var p=Ng(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&Cg(n,b,p),p};class Fr extends N.Initializable{constructor(n){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1,colorTable:!1,emphases:!1,outlineWidth:!0,emphasisOutlineWidth:!0}),this._showRoot=!1,this._outlineWidth=vr.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=vr.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Ut.Attachment.Undefined,this._context=n,this._program=new N.Program(n,"QuadRenderProgram"),this._geometry=new Mg(this._context,"Quad")}relink(){if(this._colorTable!==void 0){for(const n of this._program.shaders)n.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation);for(const n of this._program.shaders)n.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}}initialize(){const n=this._context.gl;this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const b=new N.Shader(this._context,n.VERTEX_SHADER,"quad.vert");b.initialize(Ig,!1);const y=new N.Shader(this._context,n.FRAGMENT_SHADER,"quad.frag");return y.initialize(Fg,!1),this._program.initialize([y,b],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._colorTable&&n.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.outlineWidth&&n.uniform1f(this._uOutlineWidth,this._outlineWidth),this._target&&this._target.valid&&n.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*window.devicePixelRatio),this._altered.reset())}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0)return;const n=this._context.gl,b=this._target.size;if(n.viewport(0,0,b[0],b[1]),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilFunc(n.GREATER,1,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),this._drawRestricted&&n.uniform1i(this._uAttachment,this._attachment),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid){const y=this._topology.linearization.slices,p=this._showRoot===!1?1:0;for(let t=y.length-2;t>=p;--t){const i=y[t][0],a=y[t][1]-y[t][0]+1;this._geometry.draw(i,a)}}this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.STENCIL_TEST),n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set layout(n){this.assertInitialized(),this._geometry.layout=n,this._altered.alter("geometry")}set ids(n){this.assertInitialized(),this._geometry.ids=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set emphases(n){this.assertInitialized(),this._geometry.emphases=n,this._altered.alter("emphases")}set showRoot(n){this._showRoot=!!n}set topology(n){this._topology=n}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}set outlineWidth(n){this.assertInitialized(),this._outlineWidth!==n&&(this._outlineWidth=n===void 0?vr.OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth!==n&&(this._emphasisOutlineWidth=n===void 0?vr.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("emphasisOutlineWidth"))}set attachment(n){N.auxiliaries.logIf(n!==Ut.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=n}set depthMask(n){this._depthMask=n}}Os([N.Initializable.assert_initialized()],Fr.prototype,"relink");Os([N.Initializable.initialize()],Fr.prototype,"initialize");Os([N.Initializable.uninitialize()],Fr.prototype,"uninitialize");Os([N.Initializable.assert_initialized()],Fr.prototype,"update");Os([N.Initializable.assert_initialized()],Fr.prototype,"frame");var zg=Object.defineProperty,Bg=Object.getOwnPropertyDescriptor,Dg=(T,n,b,y)=>{for(var p=Bg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&zg(n,b,p),p};const jg=N.auxiliaries.assert;var gr;const W_=(gr=class extends N.Geometry{constructor(n,b){super(n,b),jg(n.isWebGL2||n.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),b=b!==void 0&&b!==""?b:"ScreenAlignedQuadGeometry",this._vertices=new N.Buffer(n,`${b}VertexVBO`),this._buffers.push(this._vertices),this._origins=new N.Buffer(n,`${b}OriginVBO`),this._buffers.push(this._origins),this._extents=new N.Buffer(n,`${b}ExtentVBO`),this._buffers.push(this._extents),this._offsets=new N.Buffer(n,`${b}OffsetVBO`),this._buffers.push(this._offsets),this._pointyCorners=new N.Buffer(n,`${b}PointyCornerVBO`),this._buffers.push(this._pointyCorners)}bindBuffers(n){const b=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,b.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._origins.attribEnable(this._originLocation,3,b.FLOAT,!1,12,0,!0,!1),y.vertexAttribDivisor(this._originLocation,1),this._extents.attribEnable(this._extentLocation,2,b.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._extentLocation,1),this._offsets.attribEnable(this._offsetLocation,2,b.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._offsetLocation,1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,b.UNSIGNED_BYTE,!1,1,0,!0,!1),y.vertexAttribDivisor(this._pointyCornerLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._extents.attribDisable(this._extentLocation,!1,!1),this._offsets.attribDisable(this._offsetLocation,!1,!1),this._pointyCorners.attribDisable(this._pointyCornerLocation,!1,!1)}initialize(n=0,b=1,y=2,p=3,t=4){this._vertexLocation=n,this._originLocation=b,this._extentLocation=y,this._offsetLocation=p,this._pointyCornerLocation=t;const i=this.context.gl,a=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(gr.VERTICES,i.STATIC_DRAW),a&&this._vertices.valid}updateData(n,b,y,p){this.bind(),this._count=n.length/3,this._origins.data(n,this.context.gl.STATIC_DRAW),this._extents.data(b,this.context.gl.STATIC_DRAW),this._offsets.data(y,this.context.gl.STATIC_DRAW),this._pointyCorners.data(p,this.context.gl.STATIC_DRAW)}update(){this.bind()}draw(n=0){if(!this._count)return;const b=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,b.FLOAT,!1,8,0,!0,!1),this._origins.attribEnable(this._originLocation,3,b.FLOAT,!1,12,n*12,!0,!1),this._extents.attribEnable(this._extentLocation,2,b.FLOAT,!1,8,n*8,!0,!1),this._offsets.attribEnable(this._offsetLocation,2,b.FLOAT,!1,8,n*8,!0,!1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,b.UNSIGNED_BYTE,!1,1,n*1,!0,!1),y.drawArraysInstanced(b.TRIANGLE_STRIP,0,4,this._count)}get valid(){return this.initialized&&this._vertices.valid&&this._origins&&this._origins.valid&&this._offsets&&this._offsets.valid&&this._extents&&this._extents.valid&&this._pointyCorners&&this._pointyCorners.valid}get vertexLocation(){return this._vertexLocation}get originLocation(){return this._originLocation}get extentLocation(){return this._extentLocation}get offsetLocation(){return this._offsetLocation}get pointyCornerLocation(){return this._pointyCornerLocation}},gr.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),gr);Dg([N.Initializable.assert_initialized()],W_.prototype,"draw");let kg=W_;var Ug=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

#extension GL_EXT_draw_buffers : enable
attribute vec2 a_vertex;
attribute vec3 a_origin;
attribute vec2 a_extent;
attribute vec2 a_offset;
attribute float a_pointyCorner;

#else

in vec2 a_vertex;
in vec3 a_origin;
in vec2 a_extent;
in vec2 a_offset;
in float a_pointyCorner; 

#endif

uniform vec2 u_ndcOffset;
uniform mat4 u_viewProjection;
uniform float u_aspectRatio;

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

float modI(float a, float b) {
    float m = a - floor((a + 0.5) / b) * b;
    return floor(m + 0.5);
}

void main(void)
{
    v_pointyCornerLeft = step(a_pointyCorner, 2.0);
    v_pointyCornerBottom = modI(a_pointyCorner, 2.0);

    /* POSITIONING */
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.
     * 2-------4
     * |  \\    |
     * |    \\  |
     * 1-------3
     * The current vertex is calculated based on the current quad corners and the extent attributes.
     */

    vec2 extent = a_extent;
    vec2 offset = a_offset;

    
    float radius = extent.y * u_aspectRatio * 0.5;
    extent.x += radius;
    offset.x -= mix(radius, 0.0, step(a_pointyCorner, 2.0));

    v_extent = vec2(extent.x, extent.y * u_aspectRatio);
    v_uv = a_vertex * vec2(extent.x, extent.y * u_aspectRatio);
    v_radius = radius;

    vec4 origin = u_viewProjection * vec4(a_origin, 1.0);
    vec2 originNDC = vec2(origin.x / origin.w, origin.y / origin.w);
    vec4 vertex = vec4(originNDC + a_vertex * extent + offset, origin.z/origin.w, 1.0);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,Gg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
    #define fragColor gl_FragColor
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

const float ALPHA = 0.8;
const vec3 COLOR = vec3(1.0);

void main(void)
{
    

    
    vec2 mLeft =  vec2(v_radius);
    vec2 mRight = vec2(v_extent.x - v_radius, v_radius);

    
    float borderLeft =   step(v_uv.x, mLeft.x);
    float borderBottom = step(v_uv.y, mLeft.y);
    float borderRight =  step(mRight.x, v_uv.x);
    float borderTop =    step(mRight.y, v_uv.y);

    float alphaLeft =  step(v_radius, distance(v_uv, mLeft))  * borderLeft;
    float alphaRight = step(v_radius, distance(v_uv, mRight)) * borderRight;

    
    
    float alphaLeftBottom =  alphaLeft  * borderBottom;
    float alphaLeftTop =     alphaLeft  * borderTop;
    float alphaRightBottom = alphaRight * borderBottom;
    float alphaRightTop =    alphaRight * borderTop;

    
    float pointyLeftBottom =         v_pointyCornerLeft  *        v_pointyCornerBottom;
    float pointyLeftTop =            v_pointyCornerLeft  * (1.0 - v_pointyCornerBottom);
    float pointyRightBottom = (1.0 - v_pointyCornerLeft) *        v_pointyCornerBottom;
    float pointyRightTop =    (1.0 - v_pointyCornerLeft) * (1.0 - v_pointyCornerBottom);

    
    float shouldBeCutAway = sign(
          alphaLeftBottom  * (1.0 - pointyLeftBottom)
        + alphaLeftTop     * (1.0 - pointyLeftTop)
        + alphaRightBottom * (1.0 - pointyRightBottom)
        + alphaRightTop    * (1.0 - pointyRightTop));

    float alpha = mix(ALPHA, 0.0, shouldBeCutAway);
    fragColor = vec4(COLOR, alpha);
}`,qg=Object.defineProperty,Wg=Object.getOwnPropertyDescriptor,Rs=(T,n,b,y)=>{for(var p=Wg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&qg(n,b,p),p};class Cr extends N.Initializable{constructor(n){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=n,this._program=new N.Program(n,"ScreenAlignedQuadRenderProgram"),this._geometry=new kg(this._context,"ScreenAlignedQuad")}relink(){for(const n of this._program.shaders)n.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_extent",this._geometry.extentLocation),this._program.attribute("a_offset",this._geometry.offsetLocation),this._program.attribute("a_pointyCorner",this._geometry.pointyCornerLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uAspectRatio=this._program.uniform("u_aspectRatio"))}initialize(){const n=this._context.gl,b=new N.Shader(this._context,n.VERTEX_SHADER,"screenalignedquad.vert");b.initialize(Ug,!1);const y=new N.Shader(this._context,n.FRAGMENT_SHADER,"screenalignedquad.frag");return y.initialize(Gg,!1),this._program.initialize([y,b],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uAspectRatio=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&(n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),n.uniform1f(this._uAspectRatio,1/this._camera.aspect)),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const n=this._context.gl,b=this._target.size;n.viewport(0,0,b[0],b[1]),n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.BLEND)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}updateData(n,b,y,p){this._geometry.updateData(n,b,y,p),this._altered.alter("geometry")}set depthMask(n){this._depthMask=n}}Rs([N.Initializable.assert_initialized()],Cr.prototype,"relink");Rs([N.Initializable.initialize()],Cr.prototype,"initialize");Rs([N.Initializable.uninitialize()],Cr.prototype,"uninitialize");Rs([N.Initializable.assert_initialized()],Cr.prototype,"update");Rs([N.Initializable.assert_initialized()],Cr.prototype,"frame");const Vg="/treemap-renderer/assets/roboto-C39txIsk.fnt",$g="/treemap-renderer/assets/roboto-Cij1YBZt.png",Hg=N.auxiliaries.log,Xg=N.auxiliaries.LogLevel,Rr=N.auxiliaries.assert,dl=3.5,pr=class pr extends N.Renderer{constructor(n){super(),this._ndcOffsetScale=1,this.coordsAt=(b,y,p,t)=>this._readbackPass.coordsAt(b,y,p,t===void 0?this._camera.viewProjectionInverse:t),this.idAt=(b,y)=>{if(!this._geometry.initialized)return;const p=this._readbackPass.idAt(b,y);if(p===void 0||p===0)return;const t=this._geometry.topology.node(p);return t===void 0?void 0:t.id},this._visualization=n}get geometry(){return this._geometry}set geometry(n){this._geometry=n}get navigation(){return this._navigation}get camera(){return this._camera}set ndcOffsetScale(n){this._ndcOffsetScale!==n&&(this._ndcOffsetScale=n,this.invalidate())}get ndcOffsetScale(){return this._ndcOffsetScale}static verifyMinimumContextRequirements(n){return n.enable(["ANGLE_instanced_arrays","OES_standard_derivatives"]),!0}renderInnerNodes(n,b,y){this._geometry.valid&&(this._innerPass.target=n,this._innerPass.attachment=b,this._innerPass.depthMask=y,this._innerPass.frame())}renderLeafNodes(n,b,y){this._geometry.valid&&this._geometry.leafNodeHeights&&(this._leafPass.target=n,this._leafPass.attachment=b,this._leafPass.depthMask=y,this._leafPass.frame())}renderLeafLabelBackgrounds(n,b){this._labelBackgroundPass.target=n,this._labelBackgroundPass.depthMask=b,this._labelBackgroundPass.frame()}renderPoints(n,b){this._pointPass.target=n,this._pointPass.depthMask=b,this._pointPass.frame()}renderInnerLabels(n,b,y){if(!this._geometry.valid)return;this._innerLabelPass.target=n,this._innerLabelPass.depthMask=y;const p=this._context.gl;p.enable(p.STENCIL_TEST),p.enable(p.DEPTH_TEST),p.stencilFunc(p.EQUAL,1,255),p.stencilOp(p.KEEP,p.KEEP,p.KEEP),this._innerLabelPass.frame(),p.disable(p.STENCIL_TEST)}renderLeafLabels(n,b,y){this._geometry.valid&&(this._leafLabelPass.target=n,this._leafLabelPass.depthMask=y,this._leafLabelPass.frame())}initializeMultiRenderTarget(n){this.assertUninitialized(),this._multiRenderTarget=new Ut(n),this._multiRenderTarget.initialize(),this._multiRenderTarget.primaryFBO.clearStencil(0),this._multiRenderTarget.secondaryFBO.clearStencil(0)}initializeLeafPasses(n){this._leafPass=new vr(n),this._leafPass.initialize(),this._leafPass.camera=this._camera}initializeInnerPass(n){this.assertUninitialized(),this._innerPass=new Fr(n),this._innerPass.initialize(),this._innerPass.camera=this._camera}initializePointPass(n){this._pointPass=new Ir(n),this._pointPass.initialize(),this._pointPass.camera=this.camera,this._pointPass.pointSize=dl}initializeLeafLabelBackgroundPass(n){this._labelBackgroundPass=new Cr(n),this._labelBackgroundPass.initialize(),this._labelBackgroundPass.camera=this.camera}initializeLabelPasses(n){this.assertUninitialized(),this._innerLabelPass=new N.LabelRenderPass(n),this._innerLabelPass.initialize(),this._innerLabelPass.camera=this.camera,this._innerLabelPass.target=this._multiRenderTarget.defaultFBO,this._innerLabelPass.depthFunc=n.gl.ALWAYS,this._innerLabelPass.aaStepScale=.3,this._innerLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass=new N.LabelRenderPass(n),this._leafLabelPass.initialize(),this._leafLabelPass.camera=this.camera,this._leafLabelPass.target=this._multiRenderTarget.defaultFBO,this._leafLabelPass.aaStepScale=.3,this._leafLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass.depthFunc=n.gl.ALWAYS,N.FontFace.fromFiles(Vg,new Map([[0,$g]]),n).then(b=>{for(const y of this._innerLabelPass.labels)y.fontFace=b;for(const y of this._leafLabelPass.labels)y.fontFace=b;this._fontFace=b,this._innerLabelPass.update(!0),this._leafLabelPass.update(!0),this._visualization.configuration&&(this._visualization.configuration.altered.alter("geometry"),this._visualization.configuration.altered.alter("labels")),this.invalidate()}).catch(b=>N.auxiliaries.log(N.auxiliaries.LogLevel.Error,b))}initializeAccumulationPass(n){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._accumulationPass=new N.AccumulatePass(n),this._accumulationPass.initialize(this._ndcTriangle),this._accumulationPass.precision=this._framePrecision,this._accumulationPass.texture=this._multiRenderTarget.colorRenderTexture}initializeBlitPass(n){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined");const b=this._context.gl,y=this._context.gl2facade;this._blitPass=new N.BlitPass(n),this._blitPass.initialize(this._ndcTriangle),this._blitPass.readBuffer=y.COLOR_ATTACHMENT0,this._blitPass.drawBuffer=b.BACK,this._blitPass.target=this._multiRenderTarget.defaultFBO}initializeReadbackPass(n){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._readbackPass=new N.ReadbackPass(n),this._readbackPass.initialize(this._ndcTriangle,this._multiRenderTarget.depthFBO!==void 0),this._readbackPass.cache=!0;const b=this._context.gl,y=this._context.gl2facade;this._multiRenderTarget.depthFBO?(this._readbackPass.depthFBO=this._multiRenderTarget.depthFBO,this._readbackPass.depthAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.depthFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.depthAttachment=b.DEPTH_STENCIL_ATTACHMENT),this._multiRenderTarget.readBackIdFBO?(this._readbackPass.idFBO=this._multiRenderTarget.readBackIdFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.idFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT1)}initializeCamera(){this.assertUninitialized(),this._camera=new N.Camera,this._camera.near=pr.CAMERA_NEAR_DEFAULT,this._camera.far=pr.CAMERA_FAR_DEFAULT,this._camera.eye=N.vec3.fromValues(0,1.5,2.2),this._camera.center=N.vec3.fromValues(0,0,.2),this._camera.up=N.vec3.fromValues(0,1,0),this._camera.fovy=2*N.Camera.calculateFovY(20,60)*N.auxiliaries.RAD2DEG}initializeNavigation(n,b){this.assertUninitialized(),this._navigation=new at(n,b),this._navigation.camera=this._camera,this._navigation.idAccess=this,this._navigation.coordsAccess=this}onInitialize(n,b,y){return pr.verifyMinimumContextRequirements(n)?(this._ndcOffsetKernel=new N.AntiAliasingKernel(this._multiFrameNumber),this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength),this._ndcTriangle=new N.NdcFillingTriangle(n,"NdcTriangle"),this._ndcTriangle.initialize(0),this.initializeMultiRenderTarget(n),this.initializeAccumulationPass(n),this.initializeBlitPass(n),this.initializeReadbackPass(n),this.initializeCamera(),this.initializeNavigation(b,y),this.initializeInnerPass(n),this.initializeLeafPasses(n),this.initializePointPass(n),this.initializeLeafLabelBackgroundPass(n),this.initializeLabelPasses(n),!0):!1}onUninitialize(){this._ndcTriangle.uninitialize(),this._multiRenderTarget.uninitialize(),this._accumulationPass.uninitialize(),this._blitPass.uninitialize(),this._readbackPass.uninitialize(),this._innerPass.uninitialize(),this._pointPass.uninitialize(),this._innerLabelPass.uninitialize(),this._leafLabelPass.uninitialize(),this._labelBackgroundPass.uninitialize()}onDiscarded(){}onUpdate(){this._navigation.update();let n=!1;try{n=this._visualization.update()}catch(y){Hg(Xg.Error,y)}let b=!1;for(const y of this._innerLabelPass.labels)if(y.altered||y.color.altered){b=!0;break}for(const y of this._leafLabelPass.labels)if(y.altered||y.color.altered){b=!0;break}return n||b||this._altered.any||this._camera.altered}onPrepare(){this._geometry.altered.any&&this._geometry.valid&&(this._innerPass.ids=this._geometry.innerNodeIndices,this._innerPass.layout=this._geometry.innerNodeLayouts,this._innerPass.colors=this._geometry.innerNodeColors,this._innerPass.emphases=this._geometry.innerNodeEmphases,this._innerPass.colorTable=this._geometry.colorTable,this._innerPass.topology=this._geometry.topology,this._innerPass.showRoot=this._geometry.showRoot,this._leafPass.ids=this._geometry.leafNodeIndices,this._leafPass.layoutData=this._geometry.leafNodeLayouts,this._leafPass.areaScales=this._geometry.leafNodeAreaScales,this._leafPass.colors=this._geometry.leafNodeColors,this._leafPass.emphases=this._geometry.leafNodeEmphases,this._leafPass.heights=this._geometry.leafNodeHeights,this._leafPass.colorTable=this._geometry.colorTable,this._leafPass.topology=this._geometry.topology),this._geometry.altered.colorTableLength&&this._leafPass.colorTableLengthAltered(),this._geometry.altered.outlineWidth&&(this._innerPass.outlineWidth=this._geometry.outlineWidth,this._leafPass.outlineWidth=this._geometry.outlineWidth),this._geometry.altered.emphasisOutlineWidth&&(this._innerPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth,this._leafPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth),this._geometry.altered.heightScale&&(this._leafPass.heightScale=this._geometry.heightScale),this._altered.frameSize&&(this._multiRenderTarget.resize(this._frameSize[0],this._frameSize[1]),this._camera.viewport=[this._frameSize[0],this._frameSize[1]],this.invalidate()),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1],this._readbackPass.coordinateReferenceSize=this._canvasSize),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber,this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength)),this._altered.framePrecision&&(this._accumulationPass.precision=this._framePrecision),this._altered.clearColor&&this._multiRenderTarget.setClearColor(this._clearColor),this._innerPass.update(),this._leafPass.update(),this._pointPass.update(),this._labelBackgroundPass.update(),this._innerLabelPass.update(),this._leafLabelPass.update(),this._accumulationPass.update(),this._readbackPass.frame(),this._visualization.prepare(),this._camera.altered=!1,this._geometry.altered.reset(),this._altered.reset()}onFrame(n){const b=this._context.gl,y=this._context.gl2facade,p=this._ndcOffsetKernel.get(n);p[0]=this._ndcOffsetScale*2*p[0]/this._frameSize[0],p[1]=this._ndcOffsetScale*2*p[1]/this._frameSize[1],this._leafPass.ndcOffset=p,this._innerPass.ndcOffset=p,this._innerLabelPass.ndcOffset=p,this._leafLabelPass.ndcOffset=p,this._pointPass.ndcOffset=p,this._labelBackgroundPass.ndcOffset=p;const t=n===0,i=this._multiRenderTarget,a=t?i.primaryFBO:i.secondaryFBO;a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT|b.STENCIL_BUFFER_BIT,!0,!1),b.viewport(0,0,this._camera.viewport[0],this._camera.viewport[1]),b.depthFunc(b.LESS);const r=Ut.Attachment;i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),this.renderLeafNodes(a,i.drawRestricted?r.Color:r.Undefined,!0),this.renderInnerNodes(a,i.drawRestricted?r.Color:r.Undefined,!0),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,b.NONE]),this.renderInnerLabels(a,i.drawRestricted?r.Color:r.Undefined,!1),this.renderLeafLabelBackgrounds(a,!1),this.renderLeafLabels(a,i.drawRestricted?r.Color:r.Undefined,!1),this.renderPoints(a,!1),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),t&&i.idFBO&&(i.idFBO.clear(b.COLOR_BUFFER_BIT|b.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.idFBO,r.Id,!1),this.renderInnerNodes(i.idFBO,r.Id,!1)),t&&i.depthFBO&&(i.depthFBO.clear(b.COLOR_BUFFER_BIT|b.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.depthFBO,r.Depth,!1),this.renderInnerNodes(i.depthFBO,r.Depth,!1)),this._accumulationPass.frame(n)}onSwap(){var b;if(!this._accumulationPass.initialized||!((b=this._accumulationPass.framebuffer)!=null&&b.initialized)||!this._blitPass.initialized)return;const n=this._blitPass;n.framebuffer=this._accumulationPass.framebuffer,n.readBuffer=this._context.gl2facade.COLOR_ATTACHMENT0,n.frame()}updateLabelsForPass(n,b){const y=[];for(const p of n)p!==void 0&&(p.fontFace=this._fontFace,y.push(p));b.labels=y,b.update()}updateLabels(n,b){this.updateLabelsForPass(n,this._innerLabelPass),this.updateLabelsForPass(b,this._leafLabelPass)}updateLeafLabelPass(){this._leafLabelPass.update()}updateLeafLabelBackgrounds(n){const b=[],y=[],p=[],t=[];let i=0;for(const a of n){if(!a||a.color.a===0)continue;const r=2*a.extent[1]/this._frameSize[1];i=Math.max(i,r)}for(const a of n){if(!a||a.color.a===0)continue;b.push(a.position[0],a.position[1],a.position[2]);const r=dl*.5,c=dl*.5,f=(2*a.extent[0]+r)/this._frameSize[0];y.push(f,i);const d=r/this._frameSize[1],h=a.alignment===N.Label.Alignment.Right?-d-f:d,s=c/this._frameSize[1],o=a.lineAnchor===N.Label.LineAnchor.Top?s-i:-s;p.push(h,o);let u=0;a.alignment===N.Label.Alignment.Left?a.lineAnchor===N.Label.LineAnchor.Bottom?u=1:a.lineAnchor===N.Label.LineAnchor.Top&&(u=2):a.alignment===N.Label.Alignment.Right&&(a.lineAnchor===N.Label.LineAnchor.Bottom?u=3:a.lineAnchor===N.Label.LineAnchor.Top&&(u=4)),t.push(u)}this._labelBackgroundPass.updateData(new Float32Array(b),new Float32Array(y),new Float32Array(p),new Uint8Array(t))}updatePoints(n){const b=[],y=[];for(const p of n)p&&(b.push(p.position[0],p.position[1],p.position[2]),y.push(p.color.r,p.color.g,p.color.b,p.color.a));this._pointPass.positions=new Float32Array(b),this._pointPass.colors=new Float32Array(y)}frameSizeAltered(){return this._altered.frameSize}setCameraEye(n,b,y){this._camera.eye=N.vec3.fromValues(n,b,y)}invalidate(){this.initialized&&super.invalidate(!0)}};pr.CAMERA_NEAR_DEFAULT=.01,pr.CAMERA_FAR_DEFAULT=10;let vl=pr;class Yg{static innerNodes(n,b,y){const p=new Uint8Array(n.numberOfInnerNodes);return n.forEachInnerNode(t=>{p[t.index]=b+t.depth%y}),p}}var Zg=Object.defineProperty,Kg=Object.getOwnPropertyDescriptor,V_=(T,n,b,y)=>{for(var p=Kg(n,b),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,b,p)||p);return p&&Zg(n,b,p),p};class zt extends N.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new N.ChangeLookup,{any:!1,colorTableLength:!1,colorTable:!1,innerNodeIndices:!1,innerNodeLayouts:!1,innerNodeEmphases:!1,innerNodeColors:!1,leafNodeIndices:!1,leafNodeLayouts:!1,leafNodeEmphases:!1,leafNodeAreaScales:!1,leafNodeColors:!1,leafNodeHeights:!1,outlineWidth:!1,emphasisOutlineWidth:!1,heightScale:!1,labels:!1})}initialize(n){return this._topology=n,this._altered.alter("any"),this._topology.numberOfInnerNodes>0||this._topology.numberOfLeafNodes>0}uninitialize(){this._topology=void 0,this._colorTable=void 0,this._leafNodeAreaScales=void 0,this._leafNodeColors=void 0,this._leafNodeHeights=void 0,this._innerNodeIndices=void 0,this._innerNodeLayouts=void 0,this._innerNodeEmphases=void 0,this._innerNodeColors=void 0,this._leafNodeIndices=void 0,this._leafNodeLayouts=void 0,this._leafNodeEmphases=void 0,this._showRoot=!0}get altered(){return this._altered}get topology(){return this.assertInitialized(),this._topology}set innerNodeIndices(n){this.assertInitialized(),this._innerNodeIndices=n,this._altered.alter("innerNodeIndices")}get innerNodeIndices(){return this._innerNodeIndices}set innerNodeLayouts(n){this.assertInitialized(),this._innerNodeLayouts=n,this._altered.alter("innerNodeLayouts")}get innerNodeLayouts(){return this._innerNodeLayouts}set innerNodeEmphases(n){this.assertInitialized(),this._innerNodeEmphases=n,this._altered.alter("innerNodeEmphases")}get innerNodeEmphases(){return this._innerNodeEmphases}set innerNodeColors(n){this.assertInitialized(),this._innerNodeColors=n,this._altered.alter("innerNodeColors")}get innerNodeColors(){return this._innerNodeColors}set leafNodeIndices(n){this.assertInitialized(),this._leafNodeIndices=n,this._altered.alter("leafNodeIndices")}get leafNodeIndices(){return this._leafNodeIndices}set leafNodeLayouts(n){this.assertInitialized(),this._leafNodeLayouts=n,this._altered.alter("leafNodeLayouts")}get leafNodeLayouts(){return this._leafNodeLayouts}set leafNodeEmphases(n){this.assertInitialized(),this._leafNodeEmphases=n,this._altered.alter("leafNodeEmphases")}get leafNodeEmphases(){return this._leafNodeEmphases}get leafNodeAreaScales(){return this._leafNodeAreaScales}set leafNodeAreaScales(n){this.assertInitialized(),this._leafNodeAreaScales=n,this._altered.alter("leafNodeAreaScales")}get leafNodeColors(){return this._leafNodeColors}set leafNodeColors(n){this.assertInitialized(),this._leafNodeColors=n,this._altered.alter("leafNodeColors")}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}get colorTable(){return this._colorTable}get leafNodeHeights(){return this._leafNodeHeights}set leafNodeHeights(n){this.assertInitialized(),this._leafNodeHeights=n,this._altered.alter("leafNodeHeights")}get innerNodeCount(){return this.assertInitialized(),this._topology.numberOfInnerNodes}get leafNodeCount(){return this.assertInitialized(),this._topology.numberOfLeafNodes}set heightScale(n){this.assertInitialized(),this._heightScale=n,this._altered.alter("heightScale")}get heightScale(){return this._heightScale}set outlineWidth(n){this.assertInitialized(),this._outlineWidth=n,this._altered.alter("outlineWidth")}get outlineWidth(){return this._outlineWidth}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth=n,this._altered.alter("emphasisOutlineWidth")}get emphasisOutlineWidth(){return this._emphasisOutlineWidth}set showRoot(n){this.assertInitialized(),this._showRoot=!!n,this._altered.alter("any")}get showRoot(){return this._showRoot}get valid(){return this.initialized}}V_([N.Initializable.initialize()],zt.prototype,"initialize");V_([N.Initializable.uninitialize()],zt.prototype,"uninitialize");(T=>{(n=>{n[n.None=0]="None",n[n.Outline=1]="Outline",n[n.Highlight=2]="Highlight"})(T.Emphasis||(T.Emphasis={}))})(zt||(zt={}));class qf{static innerNodes(n,b,y){const p=new Uint8Array(n.numberOfInnerNodes);return n.forEachInnerNode(t=>{y&&y.has(t.id)?p[t.index]=zt.Emphasis.Highlight:b&&b.has(t.id)?p[t.index]=zt.Emphasis.Outline:p[t.index]=zt.Emphasis.None}),p}static leafNodes(n,b,y){const p=new Uint8Array(n.numberOfLeafNodes);return n.forEachLeafNode(t=>{const i=t.index-n.numberOfInnerNodes;y&&y.has(t.id)?p[i]=zt.Emphasis.Highlight:b&&b.has(t.id)?p[i]=zt.Emphasis.Outline:p[i]=zt.Emphasis.None}),p}}class Wf{static innerNodes(n){const b=new Uint8Array(4*n.numberOfInnerNodes);return n.forEachInnerNode(y=>{const p=y.index,t=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(t,y.index),b[4*p+0]=t[0],b[4*p+1]=t[1],b[4*p+2]=t[2],b[4*p+3]=t[3]}),b}static leafNodes(n){const b=new Uint8Array(4*n.numberOfLeafNodes),y=n.numberOfInnerNodes;return n.forEachLeafNode(p=>{const t=p.index-y,i=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(i,p.index),b[4*t+0]=i[0],b[4*t+1]=i[1],b[4*t+2]=i[2],b[4*t+3]=i[3]}),b}}class Vf{constructor(){this.outer=0,this.inner=0}next(n){++this.inner,this.inner===n[this.outer].length&&(++this.outer,this.inner=0)}end(n){return this.outer===n.length}element(n){return n[this.outer][this.inner]}}const $f=N.auxiliaries.assert,Ys=N.gl_matrix_extensions.v2;var Ne;(T=>{(p=>{p.UpperRight="upper-right",p.UpperLeft="upper-left",p.LowerRight="lower-right",p.LowerLeft="lower-left",p.Hidden="hidden"})(T.Type||(T.Type={}));function n(p,t,i){switch(p){case"upper-right":return t;case"upper-left":return N.vec2.sub(Ys(),t,[i[0],0]);case"lower-left":return N.vec2.sub(Ys(),t,i);case"lower-right":return N.vec2.sub(Ys(),t,[0,i[1]]);case"hidden":return t;default:$f(!1,"No valid type for relative label position, given"+p)}return N.vec2.create()}T.labelOrigin=n;function b(p){return p!=="hidden"}T.isVisible=b;function y(p,t){const i=N.vec2.add(Ys(),p,[t[0]/2,t[1]/2]);return i[0]>0&&i[1]>0?"upper-right":i[0]<0&&i[1]>0?"upper-left":i[0]<0&&i[1]<0?"lower-left":i[0]>0&&i[1]<0?"lower-right":($f(!1,`midpointOffset is ${i}, given offset ${p} and extent ${t}`),"hidden")}T.relativeLabelPosition=y})(Ne||(Ne={}));const Ge=N.gl_matrix_extensions.v2;class fl{constructor(n,b,y){this.origin=n,this.extent=b,this.position=y}areBothPositionsHidden(n){return this.position===Ne.Type.Hidden||n===Ne.Type.Hidden}overlaps(n){if(this.areBothPositionsHidden(n.position))return!1;const b=N.vec2.add(Ge(),this.origin,this.extent),y=N.vec2.add(Ge(),n.origin,n.extent);return this.origin[0]<y[0]&&b[0]>n.origin[0]&&this.origin[1]<y[1]&&b[1]>n.origin[1]}paddedOverlaps(n,b){if(this.areBothPositionsHidden(n.position))return!1;const y=N.vec2.fromValues(b[0]+1,b[1]+1),p=N.vec2.sub(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,b)),t=N.vec2.sub(Ge(),n.origin,N.vec2.mul(Ge(),n.extent,b)),i=N.vec2.add(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,y)),a=N.vec2.add(Ge(),n.origin,N.vec2.mul(Ge(),n.extent,y));return p[0]<a[0]&&i[0]>t[0]&&p[1]<a[1]&&i[1]>t[1]}overlapArea(n){if(this.areBothPositionsHidden(n.position))return 0;const b=N.vec2.max(Ge(),this.origin,n.origin),y=N.vec2.min(Ge(),N.vec2.add(Ge(),this.origin,this.extent),N.vec2.add(Ge(),n.origin,n.extent));return Math.max(0,y[0]-b[0])*Math.max(0,y[1]-b[1])}paddedOverlapArea(n,b){if(this.areBothPositionsHidden(n.position))return 0;const y=N.vec2.max(Ge(),N.vec2.sub(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,b)),N.vec2.sub(Ge(),n.origin,N.vec2.mul(Ge(),n.extent,b))),p=N.vec2.fromValues(b[0]+1,b[1]+1),t=N.vec2.min(Ge(),N.vec2.add(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,p)),N.vec2.add(Ge(),n.origin,N.vec2.mul(Ge(),n.extent,p)));return Math.max(0,t[0]-y[0])*Math.max(0,t[1]-y[1])}area(){return this.extent[0]*this.extent[1]}}const Qg=N.auxiliaries.assert,Jg=N.auxiliaries.log,eb=N.auxiliaries.LogLevel,tb=20;function Zs(T,n,b){T.length>0&&T[T.length-1].value<n&&(T[T.length-1]={nodeId:b,value:n},T.sort((y,p)=>p.value-y.value))}function Ks(T,n){n.filter(b=>b.nodeId!==void 0&&b.nodeId!=Xe.INVALID_INDEX).map(b=>{T.add(b.nodeId)})}class vt{static createLeafLabel(n,b){const y=new N.Projected3DLabel(new N.Text("  "+n+"  "),N.Label.Type.Dynamic);return y.color.fromF32(...vt.leafLabelColor),y.lineAnchor=N.Label.LineAnchor.Bottom,y.fontSize=tb*window.devicePixelRatio,Qg(b.length===3,`Expected a 3D position for leaf label anchor, got ${b}`),y.position=b,y}static createInnerNodeLabel(n,b,y){const p=new N.Position3DLabel(new N.Text(n),N.Label.Type.Static);p.color.fromF32(...vt.innerLabelColor),p.alignment=N.Label.Alignment.Center,p.lineAnchor=N.Label.LineAnchor.Bottom;const t=0;let i=0;const a=0;let r=0;switch(p.fontSize=y*2,p.elide=N.Label.Elide.Middle,t){case 0:i=b.left+b.right-1,r=(b.bottom-y)*2-1,p.lineWidth=b.width*2,p.direction=[1,0,0],p.up=[0,0,-1];break;case 1:i=b.left+b.right-1,r=(b.top+y)*2-1,p.lineWidth=b.width*2,p.direction=[-1,0,0],p.up=[0,0,1];break;case 2:i=(b.left-y)*2-1,r=b.top+b.bottom-1,p.lineWidth=b.height*2,p.direction=[0,0,1],p.up=[1,0,0];break;case 3:i=(b.right+y)*2-1,r=b.top+b.bottom-1,p.lineWidth=b.height*2,p.direction=[0,0,-1],p.up=[-1,0,0];break;default:p.fontSize=0,Jg(eb.Warning,`${t} is not a valid value of LabelPaddingSide, skip label '${n}'`)}return p.position=[i,a,-r],p}static createInnerNodeLabelOnAccessory(n,b){const y=new N.Position3DLabel(new N.Text(n),N.Label.Type.Static);y.color.fromF32(...vt.innerLabelColor),y.alignment=N.Label.Alignment.Center,y.lineAnchor=N.Label.LineAnchor.Bottom;const p=b.left+b.right-1,t=0,i=b.bottom*2-1;return y.fontSize=b.height*2,y.elide=N.Label.Elide.Middle,y.lineWidth=b.width*2,y.position=[p,t,-i],y.direction=[1,0,0],y.up=[0,0,-1],y}static fillLeafLabelArray(n,b,y,p,t,i){const a=new Array(n.numberOfInnerNodes);return y.forEach(r=>{const c=n.leafNodeById(r),f=b.get(r);if(c===void 0||f===void 0||f.length===0)return;const d=c.index-n.numberOfInnerNodes,h=d*4,s=t[h+0],o=t[h+1],u=t[h+2],m=t[h+3],v=d*2,_=i[v+1];if(u>0&&m>0){const g=s+u*.5,x=_*p/255,E=o+m*.5;a[c.index]=vt.createLeafLabel(f,[g,x,E])}}),a}static fillInnerNodeLabelArrayOnAccessory(n,b,y,p){const t=new Array(n.numberOfInnerNodes);return y.forEach(i=>{const a=n.innerNodeById(i);if(a!==void 0&&p[a.index]!==void 0&&p[a.index].area>0){const r=b.get(i);if(r===void 0||r.length===0)return;t[a.index]=vt.createInnerNodeLabelOnAccessory(r,p[a.index])}}),t}static fillInnerNodeLabelArray(n,b,y,p,t){const i=new Array(n.numberOfInnerNodes);return y.forEach(a=>{const r=n.innerNodeById(a);if(r!==void 0&&p[r.index]!==void 0){const c=b.get(a);if(c===void 0||c.length===0)return;!r.isLeaf&&p[r.index].area>0&&(i[r.index]=vt.createInnerNodeLabel(c,p[r.index],t[r.index]))}}),i}static createLabelSelection(n,b,y,p,t,i,a,r,c,f){const d=new Set(t),h=new Array(a),s=new Array(r),o=new Array(c),u=new Array(f);return h.fill({nodeId:void 0,value:-1}),s.fill({nodeId:void 0,value:-1}),o.fill({nodeId:void 0,value:-1}),u.fill({nodeId:void 0,value:-1}),n.parentsDoUntilDepth(i[1],m=>{m.depth<i[0]||Zs(h,b[m.index],m.id)}),n.forEachLeafNode(m=>{m.id!==void 0&&(Zs(s,b[m.index],m.id),Zs(o,y[m.index],m.id),Zs(u,p[m.index],m.id))}),Ks(d,h),Ks(d,s),Ks(d,o),Ks(d,u),d}static fillLeafLabelArrayByExplicitNames(n,b,y,p,t){const i=new Set;return b.forEach((a,r)=>{i.add(r)}),vt.fillLeafLabelArray(n,b,i,y,p,t)}static fillInnerNodeLabelArrayOnAccessoryByExplicitNames(n,b,y){const p=new Set;return b.forEach((t,i)=>{p.add(i)}),vt.fillInnerNodeLabelArrayOnAccessory(n,b,p,y)}}(T=>{T.leafLabelColor=[0,0,0,.8],T.innerLabelColor=[0,0,0,.54]})(vt||(vt={}));const to=N.auxiliaries.assert,rb=N.gl_matrix_extensions.v2;var ro;(T=>{T.leafLabelsTreemap=(n,b,y,p)=>{let t=0;switch(y){case Ne.Type.UpperRight:t=0*p;break;case Ne.Type.LowerRight:t=1*p;break;case Ne.Type.UpperLeft:t=1*p;break;case Ne.Type.LowerLeft:t=3*p;break;case Ne.Type.Hidden:t=60*p;break;default:to(!1,`No valid relative position type, given ${y}`)}return 15*b+.3*t}})(ro||(ro={}));class ib{static getNDCExtentForLeafLabel(n,b){to(b.width!==0&&b.height!==0,`camera viewport is invalid: ${b.width} ${b.height}`);const y=n.label.extent[0]/b.width,p=n.label.extent[1]/b.height;return N.vec2.fromValues(y,p)}static placementFor(n,b){const y=N.vec2.sub(rb(),n.origin,b);let p=!0,t=N.Label.Alignment.Left,i=N.Label.LineAnchor.Bottom;switch(n.position){case Ne.Type.UpperRight:break;case Ne.Type.LowerRight:i=N.Label.LineAnchor.Top;break;case Ne.Type.UpperLeft:t=N.Label.Alignment.Right;break;case Ne.Type.LowerLeft:i=N.Label.LineAnchor.Top,t=N.Label.Alignment.Right;break;case Ne.Type.Hidden:p=!1;break;default:to(!1,"No valid type for relative label position, given"+y)}return{offset:y,alignment:t,lineAnchor:i,display:p}}static createCollisionGraph(n,b){b||(b=N.vec2.fromValues(1,1));const y=[];for(let t=0;t<n.length;t++){y.push([]);for(const i of n[t])y[t].push([])}const p=new Vf;for(;!p.end(n);p.next(n)){const t=p.element(y),i=p.element(n),a=new Vf;for(;!a.end(n);a.next(n)){if(p.outer===a.outer)continue;const r=a.element(n);if(i.paddedOverlaps(r,b)){const c=i.paddedOverlapArea(r,b);t.push({index:a.outer,position:a.inner,overlapArea:c});const f=p.element(y).length;to(f>0,`Size expected to be greater than zero, given ${f.length}`)}}}return y}static computeLabelAreas(n,b,y){const p=[];for(const t of n){p.push([]);const i=this.getNDCExtentForLeafLabel(t,y);for(const a of b){const r=Ne.labelOrigin(a,t.pointLocation,i);p[p.length-1].push(new fl(r,i,a))}}return p}static getRandomInt(n){return Math.floor(Math.random()*Math.floor(n))}static randomIndexExcept(n,b){const y=this.getRandomInt(b-1);return y===n?b-1:y}static randomStartLabelAreas(n){const b=[];for(const y of n)b.push(this.getRandomInt(y.length));return b}static computePenalty(n,b,y,p,t){if(n.extent[0]===0||n.extent[1]===0)return 0;let i=0,a=0;for(const r of b)t[r.index]===r.position&&(i+=r.overlapArea,++a);return i/=n.area(),p(a,i,n.position,y)}static simulatedAnnealing(n,b,y,p){const t=[Ne.Type.UpperRight,Ne.Type.UpperLeft,Ne.Type.LowerLeft,Ne.Type.LowerRight,Ne.Type.Hidden],i=this.computeLabelAreas(n,t,p),a=this.randomStartLabelAreas(i),r=this.createCollisionGraph(i,y),c=.91023922662,f=50,d=.9,h=5*n.length,s=20*n.length;let o=c,u=0,m=0,v=0;for(;;){const _=this.getRandomInt(n.length),g=a[_],x=this.randomIndexExcept(g,i[_].length),E=this.computePenalty(i[_][g],r[_][g],n[_].priority,b,a),w=this.computePenalty(i[_][x],r[_][x],n[_].priority,b,a),S=E-w,R=Math.exp(S/o),O=Math.max(0,Math.min(R,1)),I=Math.random()<O;if((S>0||I)&&(a[_]=x,++m),++v,m>h||v>s){if(m===0||u===f)break;o*=d,m=0,v=0,++u}}for(let _=0;_<n.length;++_)n[_].placement=this.placementFor(i[_][a[_]],n[_].pointLocation)}static greedy(n,b,y,p){const t=[],i=[Ne.Type.UpperRight,Ne.Type.UpperLeft,Ne.Type.LowerLeft,Ne.Type.LowerRight,Ne.Type.Hidden];for(const a of n){const r=this.getNDCExtentForLeafLabel(a,p);let c=Number.POSITIVE_INFINITY,f=new fl(N.vec2.create(),N.vec2.create(),Ne.Type.LowerLeft);for(const d of i){const h=Ne.labelOrigin(d,a.pointLocation,r),s=new fl(h,r,d);let o=0,u=0;for(const v of t)o+=s.paddedOverlapArea(v,y),u+=s.paddedOverlaps(v,y)?1:0;o/=s.area();const m=b(u,o,d,a.priority);m<c&&(c=m,f=s)}a.placement=this.placementFor(f,a.pointLocation),t.push(f)}}static prepareLeafLabels(n,b){const y=[];for(const p of n)if(p){const t=N.vec4.fromValues(p.position[0],p.position[1],p.position[2],1);N.vec4.transformMat4(t,t,b.viewProjection);const i=t[3],a=N.vec2.fromValues(t[0]/i,t[1]/i);y.push({label:p,pointLocation:a,priority:p.position[1]*9+1,placement:{offset:N.vec2.create(),alignment:p.alignment,lineAnchor:p.lineAnchor,display:!0}})}return y}static applyNewPlacements(n){let b=!1,y=!1;for(const p of n){const t=p.label.alignment!==p.placement.alignment,i=p.label.lineAnchor!==p.placement.lineAnchor;p.label.alignment=p.placement.alignment,p.label.lineAnchor=p.placement.lineAnchor;const a=p.placement.display?vt.leafLabelColor[3]:0;p.label.color.fromRGB(p.label.color.r,p.label.color.g,p.label.color.b,a),b=b?!0:p.label.color.altered,y=y?!0:t||i}return{visibility:b,positioning:y}}static adaptPositionToPreventOverlapGreedy(n,b){const y=this.prepareLeafLabels(n,b);y.sort((t,i)=>i.priority-t.priority);const p=N.vec2.fromValues(1,1);return this.greedy(y,ro.leafLabelsTreemap,p,b),this.applyNewPlacements(y)}static adaptPositionToPreventOverlapSimulatedAnnealing(n,b){const y=this.prepareLeafLabels(n,b),p=N.vec2.fromValues(1,1);return this.simulatedAnnealing(y,ro.leafLabelsTreemap,p,b),this.applyNewPlacements(y)}}class nb{constructor(n){this._topology=n}resolve(n,b,y,p){if(p&&(n===void 0||n===""))return p();const t=St.create(this._topology,y,n,b);return p&&t===void 0?p():t}constBufferCallback(n=0){return()=>{const b=new Float32Array(this._topology.numberOfNodes);return b.fill(n),b}}}class ab{constructor(n,b,y,p){this._emphasis=n.rgbaF32,this._auxiliary=new Float32Array(b.length*4);for(let t=0;t<b.length;++t)this._auxiliary.set(b[t].rgbaF32,t*4);this._inner=new Float32Array(y.length*4);for(let t=0;t<y.length;++t)this._inner.set(y[t].rgbaF32,t*4);this._leaf=new Float32Array(p.length*4);for(let t=0;t<p.length;++t)this._leaf.set(p[t].rgbaF32,t*4)}get innerNodeColorOffset(){return this.auxiliaryColorCount}get innerNodeColorCount(){return this._inner.length/4}get leafColorOffset(){return this.innerNodeColorOffset+this.innerNodeColorCount}get leafColorCount(){return this._leaf.length/4}get auxiliaryColorOffset(){return 0}get auxiliaryColorCount(){return this._auxiliary.length/4+1}get selectionColorIndex(){return 0}get bits(){const n=new Float32Array((this.auxiliaryColorCount+this.innerNodeColorCount+this.leafColorCount)*4);return n.set(this._emphasis,0),n.set(this._auxiliary,4),n.set(this._inner,this.innerNodeColorOffset*4),n.set(this._leaf,this.leafColorOffset*4),n}get length(){return this.auxiliaryColorCount+this.leafColorCount+this.innerNodeColorCount}}class Ct{static getColorIndex(n,b,y){const t=(n-y[0])/(y[1]-y[0]);return Math.min(b-1,Math.floor(Math.max(0,b*t-1e-4)))}static getColorIndexInverted(n,b,y){return b-1-this.getColorIndex(n,b,y)}static getColorIndexComputation(n,b){return y=>this.getColorIndex(y,n,b)}static insertLayoutIntoBuffer(n,b,y){const p=4*b;n[p+0]=-1+2*y.left,n[p+1]=1-2*y.bottom-2*y.height,n[p+2]=2*y.width,n[p+3]=2*y.height}static createLeafLayoutBuffer(n,b,y){const p=new Float32Array(4*n.numberOfLeafNodes),t=n.numberOfInnerNodes;return n.forEachLeafNode(i=>{const a=i.index-t,r=b[i.index];Ct.insertLayoutIntoBuffer(p,a,r)}),p}static createLayerHeightBuffer(n,b,y,p){const t=new Uint8Array(2*n.numberOfLeafNodes),i=n.numberOfInnerNodes;let a=!1;return n.forEachLeafNode(r=>{const c=r.index-i,f=y!==void 0?Math.max(y[2*c+1],0):0,d=Math.max(b[r.index],0);let h=f+d*255;f>0&&d>0&&(h=Math.ceil(h)),h>255&&(a=!0,h=255),t[2*c+0]=f,t[2*c+1]=h}),a&&console.error("Height value overflow"),t}static createEmptyLayerHeightBuffer(n){return new Uint8Array(2*n.numberOfLeafNodes)}static createLeafAreaScalesBuffer(n,b){const y=new Uint8Array(n.numberOfLeafNodes),p=n.numberOfInnerNodes;return n.forEachLeafNode(t=>{const i=t.index-p,a=Math.min(b[t.index]*255,255);y[i]=a}),y}static createDefaultLeafAreaScalesBuffer(n,b=1){const y=new Uint8Array(n.numberOfLeafNodes);return y.fill(b*255),y}static createParentLayoutBuffer(n,b,y){const p=new Float32Array(4*n.numberOfInnerNodes);return n.forEachInnerNode(t=>{const i=t.index,a=b[t.index];Ct.insertLayoutIntoBuffer(p,i,a)}),p}static defaultLeafNodeColors(n,b){const y=new Uint8Array(n.numberOfLeafNodes);return y.fill(b),y}static createLeafNodeColors(n,b,y,p,t){const i=new Uint8Array(n.numberOfLeafNodes),a=n.numberOfInnerNodes,r=this.getColorIndexComputation(p,t);return n.forEachLeafNode(c=>{const f=c.index-a,d=b[c.index];i[f]=y+r(d)+32}),i}static createLeafNodeHeights(){return new Uint8Array(0)}static createLeafNodeAreaScales(){return new Uint8Array(0)}}class sb{constructor(){this.topology=new bt}}const _t=N.auxiliaries.assert;class Se{static clone(n){return new Se(n.left,n.bottom,n.right,n.top)}constructor(n,b,y,p,t){this._left=n,this._right=y,this._top=p,this._bottom=b,this.orientation=t}get area(){return this.width*this.height}get center(){return[(this._left+this._right)/2,(this._bottom+this._top)/2]}get shorterSide(){return Math.min(this.width,this.height)}get longerSide(){return Math.max(this.width,this.height)}get isReversed(){return this.orientation===void 0?!1:this.orientation>=Se.Orientation.DC}get top(){return this._top}set top(n){_t(n>=this.bottom,"Non-negative height expected"),this._top=n}get left(){return this._left}set left(n){_t(n<=this.right,"Non-negative width expected"),this._left=n}get right(){return this._right}set right(n){_t(n>=this.left,"Non-negative width expected"),this._right=n}get bottom(){return this._bottom}set bottom(n){_t(n<=this.top,"Non-negative height expected"),this._bottom=n}get width(){return this._right-this._left}get height(){return this._top-this._bottom}get isHorizontal(){return this.width>this.height}get isVertical(){return this.width<=this.height}relativeTop(n){return this.relativeRect(0,1-n,1,n)}truncateTop(n){return _t(n<=this._top&&n>=this._bottom,"Expect new top to be within rectangle"),new Se(this._left,this._bottom,this._right,n)}relativeLeft(n){return this.relativeRect(0,0,n,1)}truncateLeft(n){return _t(n<=this._right&&n>=this._left,"Expect new top to be within rectangle"),new Se(n,this._bottom,this._right,this._top)}relativeRight(n){return this.relativeRect(1-n,0,n,1)}truncateRight(n){return _t(n<=this._right&&n>=this._left,"Expect new top to be within rectangle"),new Se(this._left,this._bottom,n,this._top)}relativeBottom(n){return this.relativeRect(0,0,1,n)}truncateBottom(n){return _t(n<=this._top&&n>=this._bottom,"Expect new top to be within rectangle"),new Se(this._left,n,this._right,this._top)}applyOffset(n,b){this._left+=n,this._right+=n,this._top+=b,this._bottom+=b}relativeRect(n,b,y,p,t){_t(n>=0&&n<=1,"Expect posX to be in [0, 1]"),_t(b>=0&&b<=1,"Expect posY to be in [0, 1]"),_t(y>=0&&y<=1,"Expect extX to be in [0, 1]"),_t(p>=0&&p<=1,"Expect extY to be in [0, 1]"),_t(n+y<=1,"Final width must not exceed given width"),_t(b+p<=1,"Final height must not exceed given height");const i=this._left+n*this.width,a=this._bottom+b*this.height,r=Math.min(i+y*this.width,this._right),c=Math.min(a+p*this.height,this._top);return new Se(i,a,r,c,t)}equalizedMargin(n,b,y){if(this.area<=0)return 0;let p=n;const t=2*this.width*n+2*this.height*n-4*n*n;if(t<0||t/this.area>=b||this.shorterSide<2*n){let i;const a=this.area*b*.99,r=.25*(this.width+this.height),c=.25*a,f=r*r-c;if(f<=0)i=r;else{const d=Math.sqrt(f),h=r+d,s=r-d;i=Math.min(h,s),i=i<0?0:i}_t(i<p,`expected ${i} to be smaller than ${p}`),p=i}return p}equalizedRelativeMargin(n){if(this.area<=0)return 0;const b=this.area*(1-n),y=this.width/this.height,p=Math.sqrt(b*y),t=Math.sqrt(b/y),i=this.area-b,a=-(p+t)*.5,r=i*.25,c=a*a*.25-r,f=c<0?0:Math.sqrt(c),d=-a*.5+f,h=-a*.5-f;return d<0||h<0?Math.max(d,h):Math.min(d,h)}padded(n){return this.width<2*n||this.height<2*n?new Se(this.left,this.bottom,this.left,this.bottom):new Se(this.left+n,this.bottom+n,this.right-n,this.top-n)}paddedWithMinArea(n,b){return n<=0?this.padded(n):1-(2*this.width*n+2*this.height*n-4*n*n)/this.area>=b&&this.shorterSide>4*n?this.padded(n):this.padded(this.shorterSide/4).relativePadded(Math.max(0,1-n/(4*this.shorterSide)))}relativePadded(n){const b=n/2;return this.relativeRect(b,b,1-n,1-n)}map(n,b){const y=(this.left-n.left)/n.width*b.width+b.left,p=b.right-(n.right-this.right)/n.width*b.width,t=b.top-(n.top-this.top)/n.height*b.height,i=(this.bottom-n.bottom)/n.height*b.height+b.bottom;return new Se(y,i,p,t)}enclose(n){const b=Math.min(this.left,n.left),y=Math.max(this.top,n.top),p=Math.max(this.right,n.right),t=Math.min(this.bottom,n.bottom);this._left=b,this._right=p,this._top=y,this._bottom=t}intersects(n){return!(n.left+Number.EPSILON>=this.right||n.right<=this.left+Number.EPSILON||n.top<=this.bottom+Number.EPSILON||n.bottom+Number.EPSILON>=this.top)}comprises(n){return this.left-Number.EPSILON<=n.left+Number.EPSILON&&this.right+Number.EPSILON>=n.right-Number.EPSILON&&this.bottom-Number.EPSILON<=n.bottom+Number.EPSILON&&this.top+Number.EPSILON>=n.top-Number.EPSILON}get aspectRatio(){return this.width/this.height}centerAround(n){const b=this.center,y=[n[0]-b[0],n[1]-b[1]];this.applyOffset(y[0],y[1])}}(T=>{(n=>{n[n.CD=0]="CD",n[n.AC=1]="AC",n[n.BA=2]="BA",n[n.DB=3]="DB",n[n.DC=4]="DC",n[n.CA=5]="CA",n[n.AB=6]="AB",n[n.BD=7]="BD"})(T.Orientation||(T.Orientation={}))})(Se||(Se={}));class Nt{static compute(n,b,y,p,t,i,a,r){const c=b[n.root.index];n.nodesDo(s=>{const o=b[s.index],u=Math.sqrt(o/c);p[s.index]=new Se(0,0,u*y,u)});const f=new Array;f[n.root.index]=[0,0],n.reverseParentsDo(s=>{let o=0,u=0,m=o,v=u,_=Nt.Direction.Y;n.childrenDo(s,x=>{const E=p[x.index]=t.siblingMarginAfterCallback(p[x.index],p[s.index],p[s.index],x);switch(_){case Nt.Direction.X:o+E.width>=m&&(o=m,u=0,_=Nt.Direction.Y);break;default:case Nt.Direction.Y:u+E.height>=v&&(o=0,u=v,_=Nt.Direction.X);break}switch(f[x.index]=[o,u],_){case Nt.Direction.X:o+=E.width,m=Math.max(m,o),v=Math.max(v,Math.max(u+E.height,E.top));break;default:case Nt.Direction.Y:u+=E.height,m=Math.max(m,Math.max(o+E.width,E.right)),v=Math.max(v,u);break}});const g=t.parentPaddingCallback(new Se(0,0,m,v),s,n,p,a,r);p[s.index]=t.accessoryPaddingCallback(g,s,n,p,i)}),n.nodesDo(s=>{const o=p[s.index],u=f[s.index];o.applyOffset(u[0],u[1]),n.childrenDo(s,m=>{const v=f[m.index];v[0]+=u[0],v[1]+=u[1]})});const d=p[n.root.index],h=new Se(0,0,d.aspectRatio,1);h.centerAround([.5,.5]),n.reverseNodesDo(s=>{p[s.index]=p[s.index].map(d,h)})}}(T=>{(n=>{n[n.X=0]="X",n[n.Y=1]="Y"})(T.Direction||(T.Direction={}))})(Nt||(Nt={}));const Qs=N.auxiliaries.assert;class ms{static aspectRatio(n,b,y){const p=n*b,t=y;return p>t?p/t:t/p}constructor(n,b,y,p,t){this._tree=n,this._weights=b,this._availableSpace=y,this._availableWeight=p,this._horizontal=t,this._insertedChildrenCount=0,this._overallChildrenCount=0,this._parentWeight=p,this._childrenWeight=0,this._overallChildrenWeight=0}optimizedAverageAspectRatio(n){if(n){const b=Math.min(this._childrenWeight+n,this._availableWeight),y=Math.min(b/this._availableWeight,1),p=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/(this._insertedChildrenCount+1),p,t)}else{const b=this._childrenWeight,y=Math.min(b/this._availableWeight,1),p=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/this._insertedChildrenCount,p,t)}}insert(n,b){this._firstChild||(this._firstChild=n),Qs(this._lastChild===void 0||this._lastChild===n,"Next node invariant not held."),this._lastChild=this._tree.node(n.nextSibling),b>Number.EPSILON&&(this._childrenWeight=Math.min(this._childrenWeight+b,this._availableWeight),this._overallChildrenWeight=Math.min(this._overallChildrenWeight+b,this._parentWeight),this._insertedChildrenCount+=1)}layoutNodes(n){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,y=>{n[y.index]=new Se(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const b=this.currentSpace;if(this._horizontal){let y=b.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{const t=this._weights[p.index],i=b.width*t/this._childrenWeight,a=Math.min(y+i,b.right);n[p.index]=new Se(y,b.bottom,a,b.top),Qs(this._availableSpace.comprises(n[p.index]),"Expect that child rect is within parent rect"),y=a})}else{let y=b.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{const t=this._weights[p.index],i=b.height*t/this._childrenWeight,a=Math.min(y+i,b.top);n[p.index]=new Se(b.left,y,b.right,a),Qs(this._availableSpace.comprises(n[p.index]),"Expect that child rect is within parent rect"),y=a})}}get isDisabled(){return this._availableWeight<=0||this._availableSpace.width<=0||this._availableSpace.height<=0}get availableWeight(){return this._availableWeight}get remainingWeight(){return this.isDisabled?0:Math.max(this._parentWeight-this._overallChildrenWeight,0)}get availableSpace(){return this._availableSpace}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return Se.clone(this.availableSpace);const n=this._childrenWeight/this._availableWeight;if(this._horizontal){const b=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateTop(b)}else{const b=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateRight(b)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const n=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal){const b=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateBottom(b)}else{const b=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateLeft(b)}}get isHorizontal(){return this._horizontal}increasesAverageAspectRatio(n){return this.isDisabled||this._firstChild===void 0||n<=Number.EPSILON?!1:this.optimizedAverageAspectRatio(n)>this.optimizedAverageAspectRatio()+Number.EPSILON}next(n){const b=this.remainingSpace;Qs(this._availableSpace.comprises(b),"Remaining Space should not exceed available space"),this._availableSpace=b,this._availableWeight=this.remainingWeight,this._horizontal=n,this._firstChild=void 0,this._lastChild=void 0,this._insertedChildrenCount=0,this._childrenWeight=0}}const Js=N.auxiliaries.assert;class ob extends ms{constructor(n,b,y,p,t,i,a){super(n,b,y,p,t),this._reverse=i,this._parentReverse=a}get reverse(){return this._reverse}set reverse(n){this._reverse=n}get parentReverse(){return this._parentReverse}set parentReverse(n){this._parentReverse=n}layoutNodes(n){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{n[p.index]=new Se(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const b=this.currentSpace,y=this._reverse?Se.Orientation.DC:Se.Orientation.CD;if(this._horizontal)if(this._parentReverse){let p=b.right;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=b.width*i/this._childrenWeight,r=Math.max(p-a,b.left);n[t.index]=new Se(r,b.bottom,p,b.top,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else{let p=b.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=b.width*i/this._childrenWeight,r=Math.min(p+a,b.right);n[t.index]=new Se(p,b.bottom,r,b.top,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else if(this._parentReverse){let p=b.top;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=b.height*i/this._childrenWeight,r=Math.max(p-a,b.bottom);n[t.index]=new Se(b.left,r,b.right,p,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else{let p=b.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=b.height*i/this._childrenWeight,r=Math.min(p+a,b.top);n[t.index]=new Se(b.left,p,b.right,r,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return Se.clone(this.availableSpace);const n=this._childrenWeight/this._availableWeight;if(this._horizontal)if(this._parentReverse){const b=this._availableSpace.top-n*this._availableSpace.height;return this._availableSpace.truncateBottom(b)}else{const b=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateTop(b)}else if(this._parentReverse){const b=this._availableSpace.right-n*this._availableSpace.width;return this._availableSpace.truncateLeft(b)}else{const b=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateRight(b)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const n=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal)if(this._parentReverse){const b=this._availableSpace.top-n*this._availableSpace.height;return this._availableSpace.truncateTop(b)}else{const b=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateBottom(b)}else if(this._parentReverse){const b=this._availableSpace.right-n*this._availableSpace.width;return this._availableSpace.truncateRight(b)}else{const b=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateLeft(b)}}next(n){super.next(n),this._reverse=!this._reverse}}class ub{static compute(n,b,y,p,t,i,a,r){p[n.root.index]=new Se(0,0,y,1),p[n.root.index].centerAround([.5,.5]),n.forEachInnerNode(c=>{let f=t.accessoryPaddingCallback(p[c.index],c,n,p,i);f=t.parentPaddingCallback(f,c,n,p,a,r);const d=t.siblingMarginBeforeCallback(f,c,n,p,a,r),h=d.isReversed,s=h,o=new ob(n,b,d,b[c.index],d.isVertical,s,h);n.childrenDo(c,u=>{const m=b[u.index];o.increasesAverageAspectRatio(m)&&(o.layoutNodes(p),o.next(d.isVertical)),o.insert(u,m)}),o.layoutNodes(p),n.childrenDo(c,u=>{p[u.index]=t.siblingMarginAfterCallback(p[u.index],d,f,u)})})}}class lb{static compute(n,b,y,p,t,i,a,r){p[n.root.index]=new Se(0,0,y,1),p[n.root.index].centerAround([.5,.5]),n.forEachInnerNode(c=>{let f=t.accessoryPaddingCallback(p[c.index],c,n,p,i);f=t.parentPaddingCallback(f,c,n,p,a,r);const d=t.siblingMarginBeforeCallback(f,c,n,p,a,r),h=new ms(n,b,d,b[c.index],f.isVertical);n.childrenDo(c,s=>{const o=b[s.index];h.increasesAverageAspectRatio(o)&&(h.layoutNodes(p),h.next(d.isVertical)),h.insert(s,o)}),h.layoutNodes(p),n.childrenDo(c,s=>{p[s.index]=t.siblingMarginAfterCallback(p[s.index],d,f,s)})})}}const Hf=N.auxiliaries.assert,Pe=class Pe{static createLayout(n,b,y,p,t,i){const a=new Array(n.numberOfNodes);if(Hf(b!==void 0,"Valid weights expected"),b===void 0)return a;const r=b[0];if(N.auxiliaries.assertions()&&n.numberOfNodes>1){let f=0;n.forEachLeafNode(d=>{f+=b[d.index]}),Hf(r!==void 0&&(f===0||r>0),"Accumulated leaf weights as root weight expected")}const c=y.aspectRatio;switch(y.algorithm){case Pe.LayoutAlgorithm.Strip:lb.compute(n,b,c,a,Pe.splittingLayoutPostprocessing(y),p,t,i);break;case Pe.LayoutAlgorithm.Snake:ub.compute(n,b,c,a,Pe.splittingLayoutPostprocessing(y),p,t,i);break;case Pe.LayoutAlgorithm.CodeCity:Nt.compute(n,b,c,a,Pe.packingLayoutPostprocessing(y),p,t,i);break}return a}static splittingLayoutPostprocessing(n){const b={parentPaddingCallback:Pe.emptyParentCallback,siblingMarginBeforeCallback:Pe.emptyParentCallback,siblingMarginAfterCallback:Pe.emptySiblingCallback,accessoryPaddingCallback:Pe.emptyAccessoryParentCallback};let y=[0],p=0;if(n.siblingMargin!==void 0&&(p=n.siblingMargin.value,p>=0))switch(n.siblingMargin.type){case Pe.SiblingMarginType.Absolute:b.siblingMarginAfterCallback=(t,i,a,r)=>{if(r.isRoot)return t;const c=p;return t.map(i,a).paddedWithMinArea(c*.5,0)};break;case Pe.SiblingMarginType.Relative:b.siblingMarginAfterCallback=(t,i,a,r)=>{if(r.isRoot)return t;const c=t.equalizedRelativeMargin(p);return t.map(i,a).paddedWithMinArea(c*.5,0)};break}if(n.parentPadding!==void 0&&(n.parentPadding.value instanceof Array?y=n.parentPadding.value:y=[n.parentPadding.value],y[0]>=0))switch(n.parentPadding.type){case Pe.ParentPaddingType.Mixed:b.parentPaddingCallback=(t,i,a,r,c,f)=>{let d,h;if(y.length-1>i.depth){const s=y[i.depth];d=t.equalizedMargin(s,.5,.9),h=t.padded(d),c!==void 0&&f!==void 0&&(c[i.index]=h,f[i.index]=d)}else d=t.equalizedRelativeMargin(y[y.length-1]),h=t.padded(d);return h},b.siblingMarginBeforeCallback=(t,i,a,r)=>{let c;return y.length>i.depth?c=p:c=t.equalizedRelativeMargin(p),t.padded(-c*.5)};break;case Pe.ParentPaddingType.Absolute:b.parentPaddingCallback=(t,i,a,r)=>{const c=t.equalizedMargin(y[0],.5,.6);return t.padded(c)},b.siblingMarginBeforeCallback=(t,i,a,r)=>{const c=p;return t.padded(-c*.5)};break;case Pe.ParentPaddingType.Relative:b.parentPaddingCallback=(t,i,a,r)=>{const c=t.equalizedRelativeMargin(y[0]);return t.padded(c)},b.siblingMarginBeforeCallback=(t,i,a,r)=>{const c=t.equalizedRelativeMargin(p);return t.padded(-c*.5)};break}if(n.accessoryPadding!==void 0){const t=n.accessoryPadding.type,i=n.accessoryPadding.value,a=n.accessoryPadding.direction,r=n.accessoryPadding.relativeAreaThreshold!==void 0?n.accessoryPadding.relativeAreaThreshold:0,c=n.accessoryPadding.targetAspectRatio!==void 0?n.accessoryPadding.targetAspectRatio:Number.NaN;if(i!==void 0)switch(t){case Pe.AccessoryPaddingType.Absolute:{switch(a){case Pe.AccessoryPaddingDirection.Bottom:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;if(i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i,u>f.height)return o[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.truncateBottom(f.bottom+u),_=f.truncateTop(v.bottom);return v.area/f.area<=m||_.aspectRatio<c?(o[d.index]=new Se(0,0,0,0),f):(o[d.index]=_,v)};break}case Pe.AccessoryPaddingDirection.Top:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;if(i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i,u>f.height)return o[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.truncateTop(f.top-u),_=f.truncateBottom(v.top);return v.area/f.area<=m||_.aspectRatio<c?(o[d.index]=new Se(0,0,0,0),f):(o[d.index]=_,v)};break}case Pe.AccessoryPaddingDirection.Left:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;if(i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i,u>f.width)return o[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.truncateLeft(f.left+u),_=f.truncateRight(v.left);return v.area/f.area<=m||_.aspectRatio<c?(o[d.index]=new Se(0,0,0,0),f):(o[d.index]=_,v)};break}case Pe.AccessoryPaddingDirection.Right:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;if(i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i,u>f.width)return o[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.truncateRight(f.right+u),_=f.truncateLeft(v.right);return v.area/f.area<=m||_.aspectRatio<c?(o[d.index]=new Se(0,0,0,0),f):(o[d.index]=_,v)};break}}break}case Pe.AccessoryPaddingType.Relative:{switch(a){case Pe.AccessoryPaddingDirection.Bottom:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.relativeTop(1-u);return v.area/f.area>m?v:f};break}case Pe.AccessoryPaddingDirection.Top:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.relativeBottom(1-u);return v.area/f.area>m?v:f};break}case Pe.AccessoryPaddingDirection.Left:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.relativeRight(1-u);return v.area/f.area>m?v:f};break}case Pe.AccessoryPaddingDirection.Right:{b.accessoryPaddingCallback=(f,d,h,s,o)=>{let u;i instanceof Array?u=i.length>d.depth?i[d.depth]:0:u=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=f.relativeLeft(1-u);return v.area/f.area>m?v:f};break}}break}}}return b}static packingLayoutPostprocessing(n){return{parentPaddingCallback:Pe.emptyParentCallback,siblingMarginBeforeCallback:Pe.emptyParentCallback,siblingMarginAfterCallback:Pe.emptySiblingCallback,accessoryPaddingCallback:Pe.emptyAccessoryParentCallback}}};Pe.emptyParentCallback=(n,b,y,p)=>n,Pe.emptyAccessoryParentCallback=(n,b,y,p,t)=>n,Pe.emptySiblingCallback=(n,b,y,p)=>n;let gs=Pe;(T=>{(n=>{n.Strip="strip",n.Snake="snake",n.CodeCity="codecity"})(T.LayoutAlgorithm||(T.LayoutAlgorithm={})),(n=>{n.Relative="relative",n.Absolute="absolute"})(T.SiblingMarginType||(T.SiblingMarginType={})),(n=>{n.Relative="relative",n.Absolute="absolute",n.Mixed="mixed"})(T.ParentPaddingType||(T.ParentPaddingType={})),(n=>{n.Relative="relative",n.Absolute="absolute"})(T.AccessoryPaddingType||(T.AccessoryPaddingType={})),(n=>{n.Top="top",n.Bottom="bottom",n.Left="left",n.Right="right"})(T.AccessoryPaddingDirection||(T.AccessoryPaddingDirection={}))})(gs||(gs={}));const ot=class ot{static byValue(n,b,y){if(!(b.length<2)){b.sort(y);for(let p=0;p<b.length-1;++p)b[p][0].nextSibling=b[p+1][0].index;b[b.length-1][0].nextSibling=Xe.INVALID_INDEX,n.firstChild=b[0][0].index}}static byValues(n,b,y,p){const t=new Array;let i=n.node(b.firstChild);do t.push([i,y[i.index]]),i=n.node(i.nextSibling);while(i!==void 0);ot.byValue(b,t,p)}static byIdentifier(n,b,y){const p=new Array;let t=n.node(b.firstChild);for(;t!==void 0;)p.push([t,t.id]),t=n.node(t.nextSibling);ot.byValue(b,p,y)}static restoreOriginalSortOrder(n,b){b.firstChild=b.initialFirstChild;for(let y=n.node(b.initialFirstChild);y!==void 0;y=n.node(y.initialNextSibling))y.nextSibling=y.initialNextSibling}static sortNodes(n,b,y,p){const t=p.layout.sort;if(t===void 0||t.algorithm===ot.Algorithm.Keep)return n.forEachInnerNode(a=>ot.restoreOriginalSortOrder(n,a)),!0;let i;switch(t.algorithm){case ot.Algorithm.Ascending:i=ot.ASCENDING_COMPARATOR;break;case ot.Algorithm.Descending:default:i=ot.DESCENDING_COMPARATOR;break}switch(t.key){case ot.Key.Weight:const a=St.create(n,b,p.layout.weight,p);a&&n.forEachInnerNode(r=>ot.byValues(n,r,a,i));break;case ot.Key.Identity:n.forEachInnerNode(r=>ot.byIdentifier(n,r,i));break;default:y!==void 0&&n.forEachInnerNode(r=>ot.byValues(n,r,y,i))}return!0}};ot.ASCENDING_COMPARATOR=(n,b)=>n[1]-b[1],ot.DESCENDING_COMPARATOR=(n,b)=>b[1]-n[1];let bs=ot;(T=>{(n=>{n.Keep="keep",n.Ascending="ascending",n.Descending="descending"})(T.Algorithm||(T.Algorithm={})),(n=>{n.Identity="identity",n.Weight="weight"})(T.Key||(T.Key={}))})(bs||(bs={}));const cb=[{identifier:"Spectral",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,153,213,148],[215,25,28,253,174,97,171,221,164,43,131,186],[215,25,28,253,174,97,255,255,191,171,221,164,43,131,186],[213,62,79,252,141,89,254,224,139,230,245,152,153,213,148,50,136,189],[213,62,79,252,141,89,254,224,139,255,255,191,230,245,152,153,213,148,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162]]},{identifier:"RdYlGn",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,207,96],[215,25,28,253,174,97,166,217,106,26,150,65],[215,25,28,253,174,97,255,255,191,166,217,106,26,150,65],[215,48,39,252,141,89,254,224,139,217,239,139,145,207,96,26,152,80],[215,48,39,252,141,89,254,224,139,255,255,191,217,239,139,145,207,96,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55]]},{identifier:"RdBu",type:"diverging",format:"rgb",colors:[[239,138,98,247,247,247,103,169,207],[202,0,32,244,165,130,146,197,222,5,113,176],[202,0,32,244,165,130,247,247,247,146,197,222,5,113,176],[178,24,43,239,138,98,253,219,199,209,229,240,103,169,207,33,102,172],[178,24,43,239,138,98,253,219,199,247,247,247,209,229,240,103,169,207,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97]]},{identifier:"PiYG",type:"diverging",format:"rgb",colors:[[233,163,201,247,247,247,161,215,106],[208,28,139,241,182,218,184,225,134,77,172,38],[208,28,139,241,182,218,247,247,247,184,225,134,77,172,38],[197,27,125,233,163,201,253,224,239,230,245,208,161,215,106,77,146,33],[197,27,125,233,163,201,253,224,239,247,247,247,230,245,208,161,215,106,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25]]},{identifier:"PRGn",type:"diverging",format:"rgb",colors:[[175,141,195,247,247,247,127,191,123],[123,50,148,194,165,207,166,219,160,0,136,55],[123,50,148,194,165,207,247,247,247,166,219,160,0,136,55],[118,42,131,175,141,195,231,212,232,217,240,211,127,191,123,27,120,55],[118,42,131,175,141,195,231,212,232,247,247,247,217,240,211,127,191,123,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27]]},{identifier:"RdYlBu",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,191,219],[215,25,28,253,174,97,171,217,233,44,123,182],[215,25,28,253,174,97,255,255,191,171,217,233,44,123,182],[215,48,39,252,141,89,254,224,144,224,243,248,145,191,219,69,117,180],[215,48,39,252,141,89,254,224,144,255,255,191,224,243,248,145,191,219,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149]]},{identifier:"BrBG",type:"diverging",format:"rgb",colors:[[216,179,101,245,245,245,90,180,172],[166,97,26,223,194,125,128,205,193,1,133,113],[166,97,26,223,194,125,245,245,245,128,205,193,1,133,113],[140,81,10,216,179,101,246,232,195,199,234,229,90,180,172,1,102,94],[140,81,10,216,179,101,246,232,195,245,245,245,199,234,229,90,180,172,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48]]},{identifier:"RdGy",type:"diverging",format:"rgb",colors:[[239,138,98,255,255,255,153,153,153],[202,0,32,244,165,130,186,186,186,64,64,64],[202,0,32,244,165,130,255,255,255,186,186,186,64,64,64],[178,24,43,239,138,98,253,219,199,224,224,224,153,153,153,77,77,77],[178,24,43,239,138,98,253,219,199,255,255,255,224,224,224,153,153,153,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26]]},{identifier:"PuOr",type:"diverging",format:"rgb",colors:[[241,163,64,247,247,247,153,142,195],[230,97,1,253,184,99,178,171,210,94,60,153],[230,97,1,253,184,99,247,247,247,178,171,210,94,60,153],[179,88,6,241,163,64,254,224,182,216,218,235,153,142,195,84,39,136],[179,88,6,241,163,64,254,224,182,247,247,247,216,218,235,153,142,195,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75]]},{identifier:"Set2",type:"qualitative",format:"rgb",colors:[[102,194,165,252,141,98,141,160,203],[102,194,165,252,141,98,141,160,203,231,138,195],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148,179,179,179]]},{identifier:"Accent",type:"qualitative",format:"rgb",colors:[[127,201,127,190,174,212,253,192,134],[127,201,127,190,174,212,253,192,134,255,255,153],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23,102,102,102]]},{identifier:"Set1",type:"qualitative",format:"rgb",colors:[[228,26,28,55,126,184,77,175,74],[228,26,28,55,126,184,77,175,74,152,78,163],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191,153,153,153]]},{identifier:"Set3",type:"qualitative",format:"rgb",colors:[[141,211,199,255,255,179,190,186,218],[141,211,199,255,255,179,190,186,218,251,128,114],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197,255,237,111]]},{identifier:"Dark2",type:"qualitative",format:"rgb",colors:[[27,158,119,217,95,2,117,112,179],[27,158,119,217,95,2,117,112,179,231,41,138],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29,102,102,102]]},{identifier:"Paired",type:"qualitative",format:"rgb",colors:[[166,206,227,31,120,180,178,223,138],[166,206,227,31,120,180,178,223,138,51,160,44],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153,177,89,40]]},{identifier:"Pastel2",type:"qualitative",format:"rgb",colors:[[179,226,205,253,205,172,203,213,232],[179,226,205,253,205,172,203,213,232,244,202,228],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204,204,204,204]]},{identifier:"Pastel1",type:"qualitative",format:"rgb",colors:[[251,180,174,179,205,227,204,235,197],[251,180,174,179,205,227,204,235,197,222,203,228],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236,242,242,242]]},{identifier:"OrRd",type:"sequential",format:"rgb",colors:[[254,232,200,253,187,132,227,74,51],[254,240,217,253,204,138,252,141,89,215,48,31],[254,240,217,253,204,138,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,179,0,0,127,0,0]]},{identifier:"PuBu",type:"sequential",format:"rgb",colors:[[236,231,242,166,189,219,43,140,190],[241,238,246,189,201,225,116,169,207,5,112,176],[241,238,246,189,201,225,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,4,90,141,2,56,88]]},{identifier:"BuPu",type:"sequential",format:"rgb",colors:[[224,236,244,158,188,218,136,86,167],[237,248,251,179,205,227,140,150,198,136,65,157],[237,248,251,179,205,227,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,129,15,124,77,0,75]]},{identifier:"Oranges",type:"sequential",format:"rgb",colors:[[254,230,206,253,174,107,230,85,13],[254,237,222,253,190,133,253,141,60,217,71,1],[254,237,222,253,190,133,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,166,54,3,127,39,4]]},{identifier:"BuGn",type:"sequential",format:"rgb",colors:[[229,245,249,153,216,201,44,162,95],[237,248,251,178,226,226,102,194,164,35,139,69],[237,248,251,178,226,226,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,109,44,0,68,27]]},{identifier:"YlOrBr",type:"sequential",format:"rgb",colors:[[255,247,188,254,196,79,217,95,14],[255,255,212,254,217,142,254,153,41,204,76,2],[255,255,212,254,217,142,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,153,52,4,102,37,6]]},{identifier:"YlGn",type:"sequential",format:"rgb",colors:[[247,252,185,173,221,142,49,163,84],[255,255,204,194,230,153,120,198,121,35,132,67],[255,255,204,194,230,153,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,104,55,0,69,41]]},{identifier:"Reds",type:"sequential",format:"rgb",colors:[[254,224,210,252,146,114,222,45,38],[254,229,217,252,174,145,251,106,74,203,24,29],[254,229,217,252,174,145,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,165,15,21,103,0,13]]},{identifier:"RdPu",type:"sequential",format:"rgb",colors:[[253,224,221,250,159,181,197,27,138],[254,235,226,251,180,185,247,104,161,174,1,126],[254,235,226,251,180,185,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119,73,0,106]]},{identifier:"Greens",type:"sequential",format:"rgb",colors:[[229,245,224,161,217,155,49,163,84],[237,248,233,186,228,179,116,196,118,35,139,69],[237,248,233,186,228,179,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,109,44,0,68,27]]},{identifier:"YlGnBu",type:"sequential",format:"rgb",colors:[[237,248,177,127,205,187,44,127,184],[255,255,204,161,218,180,65,182,196,34,94,168],[255,255,204,161,218,180,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,37,52,148,8,29,88]]},{identifier:"Purples",type:"sequential",format:"rgb",colors:[[239,237,245,188,189,220,117,107,177],[242,240,247,203,201,226,158,154,200,106,81,163],[242,240,247,203,201,226,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,84,39,143,63,0,125]]},{identifier:"GnBu",type:"sequential",format:"rgb",colors:[[224,243,219,168,221,181,67,162,202],[240,249,232,186,228,188,123,204,196,43,140,190],[240,249,232,186,228,188,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,104,172,8,64,129]]},{identifier:"Greys",type:"sequential",format:"rgb",colors:[[240,240,240,189,189,189,99,99,99],[247,247,247,204,204,204,150,150,150,82,82,82],[247,247,247,204,204,204,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37,0,0,0]]},{identifier:"YlOrRd",type:"sequential",format:"rgb",colors:[[255,237,160,254,178,76,240,59,32],[255,255,178,254,204,92,253,141,60,227,26,28],[255,255,178,254,204,92,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,189,0,38,128,0,38]]},{identifier:"PuRd",type:"sequential",format:"rgb",colors:[[231,225,239,201,148,199,221,28,119],[241,238,246,215,181,216,223,101,176,206,18,86],[241,238,246,215,181,216,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,152,0,67,103,0,31]]},{identifier:"Blues",type:"sequential",format:"rgb",colors:[[222,235,247,158,202,225,49,130,189],[239,243,255,189,215,231,107,174,214,33,113,181],[239,243,255,189,215,231,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,81,156,8,48,107]]},{identifier:"PuBuGn",type:"sequential",format:"rgb",colors:[[236,226,240,166,189,219,28,144,153],[246,239,247,189,201,225,103,169,207,2,129,138],[246,239,247,189,201,225,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,108,89,1,70,54]]}],hb=[{identifier:"magma",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002258,.001295,.018331,.003279,.002305,.023708,.004512,.00349,.029965,.00595,.004843,.03713,.007588,.006356,.044973,.009426,.008022,.052844,.011465,.009828,.06075,.013708,.011771,.068667,.016156,.01384,.076603,.018815,.016026,.084584,.021692,.01832,.09261,.024792,.020715,.100676,.028123,.023201,.108787,.031696,.025765,.116965,.03552,.028397,.125209,.039608,.03109,.133515,.04383,.03383,.141886,.048062,.036607,.150327,.05232,.039407,.158841,.056615,.04216,.167446,.060949,.044794,.176129,.06533,.047318,.184892,.069764,.049726,.193735,.074257,.052017,.20266,.078815,.054184,.211667,.083446,.056225,.220755,.088155,.058133,.229922,.092949,.059904,.239164,.097833,.061531,.248477,.102815,.06301,.257854,.107899,.064335,.267289,.113094,.065492,.276784,.118405,.066479,.286321,.123833,.067295,.295879,.12938,.067935,.305443,.135053,.068391,.315,.140858,.068654,.324538,.146785,.068738,.334011,.152839,.068637,.343404,.159018,.068354,.352688,.165308,.067911,.361816,.171713,.067305,.370771,.178212,.066576,.379497,.184801,.065732,.387973,.19146,.064818,.396152,.198177,.063862,.404009,.204935,.062907,.411514,.211718,.061992,.418647,.218512,.061158,.425392,.225302,.060445,.431742,.232077,.059889,.437695,.238826,.059517,.443256,.245543,.059352,.448436,.25222,.059415,.453248,.258857,.059706,.45771,.265447,.060237,.46184,.271994,.060994,.46566,.278493,.061978,.46919,.284951,.063168,.472451,.291366,.064553,.475462,.29774,.066117,.478243,.304081,.067835,.480812,.310382,.069702,.483186,.316654,.07169,.48538,.322899,.073782,.487408,.329114,.075972,.489287,.335308,.078236,.491024,.341482,.080564,.492631,.347636,.082946,.494121,.353773,.085373,.495501,.359898,.087831,.496778,.366012,.090314,.49796,.372116,.092816,.499053,.378211,.095332,.500067,.384299,.097855,.501002,.390384,.100379,.501864,.396467,.102902,.502658,.402548,.10542,.503386,.408629,.10793,.504052,.414709,.110431,.504662,.420791,.11292,.505215,.426877,.115395,.505714,.432967,.117855,.50616,.439062,.120298,.506555,.445163,.122724,.506901,.451271,.125132,.507198,.457386,.127522,.507448,.463508,.129893,.507652,.46964,.132245,.507809,.47578,.134577,.507921,.481929,.136891,.507989,.488088,.139186,.508011,.494258,.141462,.507988,.500438,.143719,.50792,.506629,.145958,.507806,.512831,.148179,.507648,.519045,.150383,.507443,.52527,.152569,.507192,.531507,.154739,.506895,.537755,.156894,.506551,.544015,.159033,.506159,.550287,.161158,.505719,.556571,.163269,.50523,.562866,.165368,.504692,.569172,.167454,.504105,.57549,.16953,.503466,.581819,.171596,.502777,.588158,.173652,.502035,.594508,.175701,.501241,.600868,.177743,.500394,.607238,.179779,.499492,.613617,.181811,.498536,.620005,.18384,.497524,.626401,.185867,.496456,.632805,.187893,.495332,.639216,.189921,.49415,.645633,.191952,.49291,.652056,.193986,.491611,.658483,.196027,.490253,.664915,.198075,.488836,.671349,.200133,.487358,.677786,.202203,.485819,.684224,.204286,.484219,.690661,.206384,.482558,.697098,.208501,.480835,.703532,.210638,.479049,.709962,.212797,.477201,.716387,.214982,.47529,.722805,.217194,.473316,.729216,.219437,.471279,.735616,.221713,.46918,.742004,.224025,.467018,.748378,.226377,.464794,.754737,.228772,.462509,.761077,.231214,.460162,.767398,.233705,.457755,.773695,.236249,.455289,.779968,.238851,.452765,.786212,.241514,.450184,.792427,.244242,.447543,.798608,.24704,.444848,.804752,.249911,.442102,.810855,.252861,.439305,.816914,.255895,.436461,.822926,.259016,.433573,.828886,.262229,.430644,.834791,.26554,.427671,.840636,.268953,.424666,.846416,.272473,.421631,.852126,.276106,.418573,.857763,.279857,.415496,.86332,.283729,.412403,.868793,.287728,.409303,.874176,.291859,.406205,.879464,.296125,.403118,.884651,.30053,.400047,.889731,.305079,.397002,.8947,.309773,.393995,.899552,.314616,.391037,.904281,.31961,.388137,.908884,.324755,.385308,.913354,.330052,.382563,.917689,.3355,.379915,.921884,.341098,.377376,.925937,.346844,.374959,.929845,.352734,.372677,.933606,.358764,.370541,.937221,.364929,.368567,.940687,.371224,.366762,.944006,.377643,.365136,.94718,.384178,.363701,.95021,.39082,.362468,.953099,.397563,.361438,.955849,.4044,.360619,.958464,.411324,.360014,.960949,.418323,.35963,.96331,.42539,.359469,.965549,.432519,.359529,.967671,.439703,.35981,.96968,.446936,.360311,.971582,.45421,.36103,.973381,.46152,.361965,.975082,.468861,.363111,.97669,.476226,.364466,.97821,.483612,.366025,.979645,.491014,.367783,.981,.498428,.369734,.982279,.505851,.371874,.983485,.51328,.374198,.984622,.520713,.376698,.985693,.528148,.379371,.9867,.535582,.38221,.987646,.543015,.38521,.988533,.550446,.388365,.989363,.557873,.391671,.990138,.565296,.395122,.990871,.572706,.398714,.991558,.580107,.402441,.992196,.587502,.406299,.992785,.594891,.410283,.993326,.602275,.41439,.993834,.609644,.418613,.994309,.616999,.42295,.994738,.62435,.427397,.995122,.631696,.431951,.99548,.639027,.436607,.99581,.646344,.441361,.996096,.653659,.446213,.996341,.660969,.45116,.99658,.668256,.456192,.996775,.675541,.461314,.996925,.682828,.466526,.997077,.690088,.471811,.997186,.697349,.477182,.997254,.704611,.482635,.997325,.711848,.488154,.997351,.719089,.493755,.997351,.726324,.499428,.997341,.733545,.505167,.997285,.740772,.510983,.997228,.747981,.516859,.997138,.75519,.522806,.997019,.762398,.528821,.996898,.769591,.534892,.996727,.776795,.541039,.996571,.783977,.547233,.996369,.791167,.553499,.996162,.798348,.55982,.995932,.805527,.566202,.99568,.812706,.572645,.995424,.819875,.57914,.995131,.827052,.585701,.994851,.834213,.592307,.994524,.841387,.598983,.994222,.84854,.605696,.993866,.855711,.612482,.993545,.862859,.619299,.99317,.870024,.626189,.992831,.877168,.633109,.99244,.88433,.640099,.992089,.89147,.647116,.991688,.898627,.654202,.991332,.905763,.661309,.99093,.912915,.668481,.99057,.920049,.675675,.990175,.927196,.682926,.989815,.934329,.690198,.989434,.94147,.697519,.989077,.948604,.704863,.988717,.955742,.712242,.988367,.962878,.719649,.988033,.970012,.727077,.987691,.977154,.734536,.987387,.984288,.742002,.987053,.991438,.7495]]},{identifier:"inferno",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002267,.00127,.01857,.003299,.002249,.024239,.004547,.003392,.030909,.006006,.004692,.038558,.007676,.006136,.046836,.009561,.007713,.055143,.011663,.009417,.06346,.013995,.011225,.071862,.016561,.013136,.080282,.019373,.015133,.088767,.022447,.017199,.097327,.025793,.019331,.10593,.029432,.021503,.114621,.033385,.023702,.123397,.037668,.025921,.132232,.042253,.028139,.141141,.046915,.030324,.150164,.051644,.032474,.159254,.056449,.034569,.168414,.06134,.03659,.177642,.066331,.038504,.186962,.071429,.040294,.196354,.076637,.041905,.205799,.081962,.043328,.215289,.087411,.044556,.224813,.09299,.045583,.234358,.098702,.046402,.243904,.104551,.047008,.25343,.110536,.047399,.262912,.116656,.047574,.272321,.122908,.047536,.281624,.129285,.047293,.290788,.135778,.046856,.299776,.142378,.046242,.308553,.149073,.045468,.317085,.15585,.044559,.325338,.162689,.043554,.333277,.169575,.042489,.340874,.176493,.041402,.348111,.183429,.040329,.354971,.190367,.039309,.361447,.197297,.0384,.367535,.204209,.037632,.373238,.211095,.03703,.378563,.217949,.036615,.383522,.224763,.036405,.388129,.231538,.036405,.3924,.238273,.036621,.396353,.244967,.037055,.400007,.25162,.037705,.403378,.258234,.038571,.406485,.26481,.039647,.409345,.271347,.040922,.411976,.27785,.042353,.414392,.284321,.043933,.416608,.290763,.045644,.418637,.297178,.04747,.420491,.303568,.049396,.422182,.309935,.051407,.423721,.316282,.05349,.425116,.32261,.055634,.426377,.328921,.057827,.427511,.335217,.06006,.428524,.3415,.062325,.429425,.347771,.064616,.430217,.354032,.066925,.430906,.360284,.069247,.431497,.366529,.071579,.431994,.372768,.073915,.4324,.379001,.076253,.432719,.385228,.078591,.432955,.391453,.080927,.433109,.397674,.083257,.433183,.403894,.08558,.433179,.410113,.087896,.433098,.416331,.090203,.432943,.422549,.092501,.432714,.428768,.09479,.432412,.434987,.097069,.432039,.441207,.099338,.431594,.447428,.101597,.43108,.453651,.103848,.430498,.459875,.106089,.429846,.4661,.108322,.429125,.472328,.110547,.428334,.478558,.112764,.427475,.484789,.114974,.426548,.491022,.117179,.425552,.497257,.119379,.424488,.503493,.121575,.423356,.50973,.123769,.422156,.515967,.12596,.420887,.522206,.12815,.419549,.528444,.130341,.418142,.534683,.132534,.416667,.54092,.134729,.415123,.547157,.136929,.413511,.553392,.139134,.411829,.559624,.141346,.410078,.565854,.143567,.408258,.572081,.145797,.406369,.578304,.148039,.404411,.584521,.150294,.402385,.590734,.152563,.40029,.59694,.154848,.398125,.603139,.157151,.395891,.60933,.159474,.393589,.615513,.161817,.391219,.621685,.164184,.388781,.627847,.166575,.386276,.633998,.168992,.383704,.640135,.171438,.381065,.64626,.173914,.378359,.652369,.176421,.375586,.658463,.178962,.372748,.66454,.181539,.369846,.670599,.184153,.366879,.676638,.186807,.363849,.682656,.189501,.360757,.688653,.192239,.357603,.694627,.195021,.354388,.700576,.197851,.351113,.7065,.200728,.347777,.712396,.203656,.344383,.718264,.206636,.340931,.724103,.20967,.337424,.729909,.212759,.333861,.735683,.215906,.330245,.741423,.219112,.326576,.747127,.222378,.322856,.752794,.225706,.319085,.758422,.229097,.315266,.76401,.232554,.311399,.769556,.236077,.307485,.775059,.239667,.303526,.780517,.243327,.299523,.785929,.247056,.295477,.791293,.250856,.29139,.796607,.254728,.287264,.801871,.258674,.283099,.807082,.262692,.278898,.812239,.266786,.274661,.817341,.270954,.27039,.822386,.275197,.266085,.827372,.279517,.26175,.832299,.283913,.257383,.837165,.288385,.252988,.841969,.292933,.248564,.846709,.297559,.244113,.851384,.30226,.239636,.855992,.307038,.235133,.860533,.311892,.230606,.865006,.316822,.226055,.869409,.321827,.221482,.873741,.326906,.216886,.878001,.33206,.212268,.882188,.337287,.207628,.886302,.342586,.202968,.890341,.347957,.198286,.894305,.353399,.193584,.898192,.358911,.18886,.902003,.364492,.184116,.905735,.37014,.17935,.90939,.375856,.174563,.912966,.381636,.169755,.916462,.387481,.164924,.919879,.393389,.16007,.923215,.399359,.155193,.92647,.405389,.150292,.929644,.411479,.145367,.932737,.417627,.140417,.935747,.423831,.13544,.938675,.430091,.130438,.941521,.436405,.125409,.944285,.442772,.120354,.946965,.449191,.115272,.949562,.45566,.110164,.952075,.462178,.105031,.954506,.468744,.099874,.956852,.475356,.094695,.959114,.482014,.089499,.961293,.488716,.084289,.963387,.495462,.079073,.965397,.502249,.073859,.967322,.509078,.068659,.969163,.515946,.063488,.970919,.522853,.058367,.97259,.529798,.053324,.974176,.53678,.048392,.975677,.543798,.043618,.977092,.55085,.03905,.978422,.557937,.034931,.979666,.565057,.031409,.980824,.572209,.028508,.981895,.579392,.02625,.982881,.586606,.024661,.983779,.593849,.02377,.984591,.601122,.023606,.985315,.608422,.024202,.985952,.61575,.025592,.986502,.623105,.027814,.986964,.630485,.030908,.987337,.63789,.034916,.987622,.64532,.039886,.987819,.652773,.045581,.987926,.66025,.05175,.987945,.667748,.058329,.987874,.675267,.065257,.987714,.682807,.072489,.987464,.690366,.07999,.987124,.697944,.087731,.986694,.70554,.095694,.986175,.713153,.103863,.985566,.720782,.112229,.984865,.728427,.120785,.984075,.736087,.129527,.983196,.743758,.138453,.982228,.751442,.147565,.981173,.759135,.156863,.980032,.766837,.166353,.978806,.774545,.176037,.977497,.782258,.185923,.976108,.789974,.196018,.974638,.797692,.206332,.973088,.805409,.216877,.971468,.813122,.227658,.969783,.820825,.238686,.968041,.828515,.249972,.966243,.836191,.261534,.964394,.843848,.273391,.962517,.851476,.285546,.960626,.859069,.29801,.95872,.866624,.31082,.956834,.874129,.323974,.954997,.881569,.337475,.953215,.888942,.351369,.951546,.896226,.365627,.950018,.903409,.380271,.948683,.910473,.395289,.947594,.917399,.410665,.946809,.924168,.426373,.946392,.930761,.442367,.946403,.937159,.458592,.946903,.943348,.47497,.947937,.949318,.491426,.949545,.955063,.50786,.95174,.960587,.524203,.954529,.965896,.540361,.957896,.971003,.556275,.961812,.975924,.571925,.966249,.980678,.587206,.971162,.985282,.602154,.976511,.989753,.61676,.982257,.994109,.631017,.988362,.998364,.644924]]},{identifier:"plasma",type:"diverging",format:"rgbf",colors:[[.050383,.029803,.527975,.063536,.028426,.533124,.075353,.027206,.538007,.086222,.026125,.542658,.096379,.025165,.547103,.10598,.024309,.551368,.115124,.023556,.555468,.123903,.022878,.559423,.132381,.022258,.56325,.140603,.021687,.566959,.148607,.021154,.570562,.156421,.020651,.574065,.16407,.020171,.577478,.171574,.019706,.580806,.17895,.019252,.584054,.186213,.018803,.587228,.193374,.018354,.59033,.200445,.017902,.593364,.207435,.017442,.596333,.21435,.016973,.599239,.221197,.016497,.602083,.227983,.016007,.604867,.234715,.015502,.607592,.241396,.014979,.610259,.248032,.014439,.612868,.254627,.013882,.615419,.261183,.013308,.617911,.267703,.012716,.620346,.274191,.012109,.622722,.280648,.011488,.625038,.287076,.010855,.627295,.293478,.010213,.62949,.299855,.009561,.631624,.30621,.008902,.633694,.312543,.008239,.6357,.318856,.007576,.63764,.32515,.006915,.639512,.331426,.006261,.641316,.337683,.005618,.643049,.343925,.004991,.64471,.35015,.004382,.646298,.356359,.003798,.64781,.362553,.003243,.649245,.368733,.002724,.650601,.374897,.002245,.651876,.381047,.001814,.653068,.387183,.001434,.654177,.393304,.001114,.655199,.399411,859e-6,.656133,.405503,678e-6,.656977,.41158,577e-6,.65773,.417642,564e-6,.65839,.423689,646e-6,.658956,.429719,831e-6,.659425,.435734,.001127,.659797,.441732,.00154,.660069,.447714,.00208,.66024,.453677,.002755,.66031,.459623,.003574,.660277,.46555,.004545,.660139,.471457,.005678,.659897,.477344,.00698,.659549,.48321,.00846,.659095,.489055,.010127,.658534,.494877,.01199,.657865,.500678,.014055,.657088,.506454,.016333,.656202,.512206,.018833,.655209,.517933,.021563,.654109,.523633,.024532,.652901,.529306,.027747,.651586,.534952,.031217,.650165,.54057,.03495,.64864,.546157,.038954,.64701,.551715,.043136,.645277,.557243,.047331,.643443,.562738,.051545,.641509,.568201,.055778,.639477,.573632,.060028,.637349,.579029,.064296,.635126,.584391,.068579,.632812,.589719,.072878,.630408,.595011,.07719,.627917,.600266,.081516,.625342,.605485,.085854,.622686,.610667,.090204,.619951,.615812,.094564,.61714,.620919,.098934,.614257,.625987,.103312,.611305,.631017,.107699,.608287,.636008,.112092,.605205,.640959,.116492,.602065,.645872,.120898,.598867,.650746,.125309,.595617,.65558,.129725,.592317,.660374,.134144,.588971,.665129,.138566,.585582,.669845,.142992,.582154,.674522,.147419,.578688,.67916,.151848,.575189,.683758,.156278,.57166,.688318,.160709,.568103,.69284,.165141,.564522,.697324,.169573,.560919,.701769,.174005,.557296,.706178,.178437,.553657,.710549,.182868,.550004,.714883,.187299,.546338,.719181,.191729,.542663,.723444,.196158,.538981,.72767,.200586,.535293,.731862,.205013,.531601,.736019,.209439,.527908,.740143,.213864,.524216,.744232,.218288,.520524,.748289,.222711,.516834,.752312,.227133,.513149,.756304,.231555,.509468,.760264,.235976,.505794,.764193,.240396,.502126,.76809,.244817,.498465,.771958,.249237,.494813,.775796,.253658,.491171,.779604,.258078,.487539,.783383,.2625,.483918,.787133,.266922,.480307,.790855,.271345,.476706,.794549,.27577,.473117,.798216,.280197,.469538,.801855,.284626,.465971,.805467,.289057,.462415,.809052,.293491,.45887,.812612,.297928,.455338,.816144,.302368,.451816,.819651,.306812,.448306,.823132,.311261,.444806,.826588,.315714,.441316,.830018,.320172,.437836,.833422,.324635,.434366,.836801,.329105,.430905,.840155,.33358,.427455,.843484,.338062,.424013,.846788,.342551,.420579,.850066,.347048,.417153,.853319,.351553,.413734,.856547,.356066,.410322,.85975,.360588,.406917,.862927,.365119,.403519,.866078,.36966,.400126,.869203,.374212,.396738,.872303,.378774,.393355,.875376,.383347,.389976,.878423,.387932,.3866,.881443,.392529,.383229,.884436,.397139,.37986,.887402,.401762,.376494,.89034,.406398,.37313,.89325,.411048,.369768,.896131,.415712,.366407,.898984,.420392,.363047,.901807,.425087,.359688,.904601,.429797,.356329,.907365,.434524,.35297,.910098,.439268,.34961,.9128,.444029,.346251,.915471,.448807,.34289,.918109,.453603,.339529,.920714,.458417,.336166,.923287,.463251,.332801,.925825,.468103,.329435,.928329,.472975,.326067,.930798,.477867,.322697,.933232,.48278,.319325,.93563,.487712,.315952,.93799,.492667,.312575,.940313,.497642,.309197,.942598,.502639,.305816,.944844,.507658,.302433,.947051,.512699,.299049,.949217,.517763,.295662,.951344,.52285,.292275,.953428,.52796,.288883,.95547,.533093,.28549,.957469,.53825,.282096,.959424,.543431,.278701,.961336,.548636,.275305,.963203,.553865,.271909,.965024,.559118,.268513,.966798,.564396,.265118,.968526,.5697,.261721,.970205,.575028,.258325,.971835,.580382,.254931,.973416,.585761,.25154,.974947,.591165,.248151,.976428,.596595,.244767,.977856,.602051,.241387,.979233,.607532,.238013,.980556,.613039,.234646,.981826,.618572,.231287,.983041,.624131,.227937,.984199,.629718,.224595,.985301,.63533,.221265,.986345,.640969,.217948,.987332,.646633,.214648,.98826,.652325,.211364,.989128,.658043,.2081,.989935,.663787,.204859,.990681,.669558,.201642,.991365,.675355,.198453,.991985,.681179,.195295,.992541,.68703,.19217,.993032,.692907,.189084,.993456,.69881,.186041,.993814,.704741,.183043,.994103,.710698,.180097,.994324,.716681,.177208,.994474,.722691,.174381,.994553,.728728,.171622,.994561,.734791,.168938,.994495,.74088,.166335,.994355,.746995,.163821,.994141,.753137,.161404,.993851,.759304,.159092,.993482,.765499,.156891,.993033,.77172,.154808,.992505,.777967,.152855,.991897,.784239,.151042,.991209,.790537,.149377,.990439,.796859,.14787,.989587,.803205,.146529,.988648,.809579,.145357,.987621,.815978,.144363,.986509,.822401,.143557,.985314,.828846,.142945,.984031,.835315,.142528,.982653,.841812,.142303,.98119,.848329,.142279,.979644,.854866,.142453,.977995,.861432,.142808,.976265,.868016,.143351,.974443,.874622,.144061,.97253,.88125,.144923,.970533,.887896,.145919,.968443,.894564,.147014,.966271,.901249,.14818,.964021,.90795,.14937,.961681,.914672,.15052,.959276,.921407,.151566,.956808,.928152,.152409,.954287,.934908,.152921,.951726,.941671,.152925,.949151,.948435,.152178,.946602,.95519,.150328,.944152,.961916,.146861,.941896,.96859,.140956,.940015,.975158,.131326]]},{identifier:"viridis",type:"diverging",format:"rgbf",colors:[[.267004,.004874,.329415,.26851,.009605,.335427,.269944,.014625,.341379,.271305,.019942,.347269,.272594,.025563,.353093,.273809,.031497,.358853,.274952,.037752,.364543,.276022,.044167,.370164,.277018,.050344,.375715,.277941,.056324,.381191,.278791,.062145,.386592,.279566,.067836,.391917,.280267,.073417,.397163,.280894,.078907,.402329,.281446,.08432,.407414,.281924,.089666,.412415,.282327,.094955,.417331,.282656,.100196,.42216,.28291,.105393,.426902,.283091,.110553,.431554,.283197,.11568,.436115,.283229,.120777,.440584,.283187,.125848,.44496,.283072,.130895,.449241,.282884,.13592,.453427,.282623,.140926,.457517,.28229,.145912,.46151,.281887,.150881,.465405,.281412,.155834,.469201,.280868,.160771,.472899,.280255,.165693,.476498,.279574,.170599,.479997,.278826,.17549,.483397,.278012,.180367,.486697,.277134,.185228,.489898,.276194,.190074,.493001,.275191,.194905,.496005,.274128,.199721,.498911,.273006,.20452,.501721,.271828,.209303,.504434,.270595,.214069,.507052,.269308,.218818,.509577,.267968,.223549,.512008,.26658,.228262,.514349,.265145,.232956,.516599,.263663,.237631,.518762,.262138,.242286,.520837,.260571,.246922,.522828,.258965,.251537,.524736,.257322,.25613,.526563,.255645,.260703,.528312,.253935,.265254,.529983,.252194,.269783,.531579,.250425,.27429,.533103,.248629,.278775,.534556,.246811,.283237,.535941,.244972,.287675,.53726,.243113,.292092,.538516,.241237,.296485,.539709,.239346,.300855,.540844,.237441,.305202,.541921,.235526,.309527,.542944,.233603,.313828,.543914,.231674,.318106,.544834,.229739,.322361,.545706,.227802,.326594,.546532,.225863,.330805,.547314,.223925,.334994,.548053,.221989,.339161,.548752,.220057,.343307,.549413,.21813,.347432,.550038,.21621,.351535,.550627,.214298,.355619,.551184,.212395,.359683,.55171,.210503,.363727,.552206,.208623,.367752,.552675,.206756,.371758,.553117,.204903,.375746,.553533,.203063,.379716,.553925,.201239,.38367,.554294,.19943,.387607,.554642,.197636,.391528,.554969,.19586,.395433,.555276,.1941,.399323,.555565,.192357,.403199,.555836,.190631,.407061,.556089,.188923,.41091,.556326,.187231,.414746,.556547,.185556,.41857,.556753,.183898,.422383,.556944,.182256,.426184,.55712,.180629,.429975,.557282,.179019,.433756,.55743,.177423,.437527,.557565,.175841,.44129,.557685,.174274,.445044,.557792,.172719,.448791,.557885,.171176,.45253,.557965,.169646,.456262,.55803,.168126,.459988,.558082,.166617,.463708,.558119,.165117,.467423,.558141,.163625,.471133,.558148,.162142,.474838,.55814,.160665,.47854,.558115,.159194,.482237,.558073,.157729,.485932,.558013,.15627,.489624,.557936,.154815,.493313,.55784,.153364,.497,.557724,.151918,.500685,.557587,.150476,.504369,.55743,.149039,.508051,.55725,.147607,.511733,.557049,.14618,.515413,.556823,.144759,.519093,.556572,.143343,.522773,.556295,.141935,.526453,.555991,.140536,.530132,.555659,.139147,.533812,.555298,.13777,.537492,.554906,.136408,.541173,.554483,.135066,.544853,.554029,.133743,.548535,.553541,.132444,.552216,.553018,.131172,.555899,.552459,.129933,.559582,.551864,.128729,.563265,.551229,.127568,.566949,.550556,.126453,.570633,.549841,.125394,.574318,.549086,.124395,.578002,.548287,.123463,.581687,.547445,.122606,.585371,.546557,.121831,.589055,.545623,.121148,.592739,.544641,.120565,.596422,.543611,.120092,.600104,.54253,.119738,.603785,.5414,.119512,.607464,.540218,.119423,.611141,.538982,.119483,.614817,.537692,.119699,.61849,.536347,.120081,.622161,.534946,.120638,.625828,.533488,.12138,.629492,.531973,.122312,.633153,.530398,.123444,.636809,.528763,.12478,.640461,.527068,.126326,.644107,.525311,.128087,.647749,.523491,.130067,.651384,.521608,.132268,.655014,.519661,.134692,.658636,.517649,.137339,.662252,.515571,.14021,.665859,.513427,.143303,.669459,.511215,.146616,.67305,.508936,.150148,.676631,.506589,.153894,.680203,.504172,.157851,.683765,.501686,.162016,.687316,.499129,.166383,.690856,.496502,.170948,.694384,.493803,.175707,.6979,.491033,.180653,.701402,.488189,.185783,.704891,.485273,.19109,.708366,.482284,.196571,.711827,.479221,.202219,.715272,.476084,.20803,.718701,.472873,.214,.722114,.469588,.220124,.725509,.466226,.226397,.728888,.462789,.232815,.732247,.459277,.239374,.735588,.455688,.24607,.73891,.452024,.252899,.742211,.448284,.259857,.745492,.444467,.266941,.748751,.440573,.274149,.751988,.436601,.281477,.755203,.432552,.288921,.758394,.428426,.296479,.761561,.424223,.304148,.764704,.419943,.311925,.767822,.415586,.319809,.770914,.411152,.327796,.77398,.40664,.335885,.777018,.402049,.344074,.780029,.397381,.35236,.783011,.392636,.360741,.785964,.387814,.369214,.788888,.382914,.377779,.791781,.377939,.386433,.794644,.372886,.395174,.797475,.367757,.404001,.800275,.362552,.412913,.803041,.357269,.421908,.805774,.35191,.430983,.808473,.346476,.440137,.811138,.340967,.449368,.813768,.335384,.458674,.816363,.329727,.468053,.818921,.323998,.477504,.821444,.318195,.487026,.823929,.312321,.496615,.826376,.306377,.506271,.828786,.300362,.515992,.831158,.294279,.525776,.833491,.288127,.535621,.835785,.281908,.545524,.838039,.275626,.555484,.840254,.269281,.565498,.84243,.262877,.575563,.844566,.256415,.585678,.846661,.249897,.595839,.848717,.243329,.606045,.850733,.236712,.616293,.852709,.230052,.626579,.854645,.223353,.636902,.856542,.21662,.647257,.8584,.209861,.657642,.860219,.203082,.668054,.861999,.196293,.678489,.863742,.189503,.688944,.865448,.182725,.699415,.867117,.175971,.709898,.868751,.169257,.720391,.87035,.162603,.730889,.871916,.156029,.741388,.873449,.149561,.751884,.874951,.143228,.762373,.876424,.137064,.772852,.877868,.131109,.783315,.879285,.125405,.79376,.880678,.120005,.804182,.882046,.114965,.814576,.883393,.110347,.82494,.88472,.106217,.83527,.886029,.102646,.845561,.887322,.099702,.85581,.888601,.097452,.866013,.889868,.095953,.876168,.891125,.09525,.886271,.892374,.095374,.89632,.893616,.096335,.906311,.894855,.098125,.916242,.896091,.100717,.926106,.89733,.104071,.935904,.89857,.108131,.945636,.899815,.112838,.9553,.901065,.118128,.964894,.902323,.123941,.974417,.90359,.130215,.983868,.904867,.136897,.993248,.906157,.143936]]}],eo=N.auxiliaries.assert,db=[...cb,...hb];class _b{constructor(){this._intermediaries=new sb,this._labelsChanged=!1,this._bufferResolver=new nb(this._intermediaries.topology),this._geometry=new zt,this._renderer=new vl(this),this._renderer.geometry=this._geometry}applyInnerNodeColorMapping(n){const b=n.geometry,y=n.altered.geometry;if(eo(this._geometry.innerNodeColors!==void 0||y.any,"expected any alteration when inner-node color mapping is yet to be defined"),!y.any&&!n.altered.topology)return;eo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)");const p=this._intermediaries.topology;(n.altered.topology||y.emphasis.any||this._geometry.innerNodeEmphases===void 0)&&(this._geometry.innerNodeEmphases=qf.innerNodes(p,b.emphasis?new Set(b.emphasis.outline):void 0,b.emphasis?new Set(b.emphasis.highlight):void 0)),(n.altered.topology||this._geometry.innerNodeColors===void 0)&&(this._geometry.innerNodeColors=Yg.innerNodes(p,this._colorLUT.innerNodeColorOffset,this._colorLUT.innerNodeColorCount))}applyLeafNodeColorMapping(n){const b=n.geometry,y=n.altered.geometry;if(!y.any&&!n.altered.topology)return;if(eo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)"),(n.altered.topology||y.emphasis.any||this._geometry.leafNodeEmphases===void 0)&&(this._geometry.leafNodeEmphases=qf.leafNodes(this._intermediaries.topology,b.emphasis?new Set(b.emphasis.outline):void 0,b.emphasis?new Set(b.emphasis.highlight):void 0)),!(b.leafLayer!==void 0)){this._geometry.leafNodeColors=Ct.defaultLeafNodeColors(this._intermediaries.topology,this._colorLUT.leafColorOffset);return}if(!y.colors&&this._geometry.leafNodeColors!==void 0)return;const t=this._bufferResolver.resolve(b.leafLayer.colors,n,this._normalization,this._bufferResolver.constBufferCallback(0));this._intermediaries.aggregatedColors=t;const i=St.range(t),a=this._colorLUT.leafColorCount,r=this._colorLUT.leafColorOffset;this._geometry.leafNodeColors=Ct.createLeafNodeColors(this._intermediaries.topology,t,r,a,i),this._geometry.altered.alter("leafNodeColors")}createLayout(n,b,y,p,t,i){return gs.createLayout(n,b,y.layout,p,t,i)}updateLabels(){const n=this._intermediaries.innerNodeLabels,b=this._intermediaries.leafLabels;if(this._geometry===void 0||!this._geometry.valid||b===void 0||n===void 0)return;let y=!1;if(this._labelsChanged&&(this._renderer.updateLabels(n,b),this._renderer.updatePoints(b),y=!0),this._renderer.camera.altered||this._labelsChanged){const p=ib.adaptPositionToPreventOverlapGreedy(b,this._renderer.camera);p.visibility||p.positioning?(this._renderer.updateLeafLabelBackgrounds(b),this._renderer.updateLeafLabelPass()):this._renderer.frameSizeAltered()?this._renderer.updateLeafLabelBackgrounds(b):y&&this._renderer.updateLeafLabelBackgrounds(b),p.visibility&&this._renderer.updatePoints(b)}this._labelsChanged&&(this._labelsChanged=!1)}update(){var u;if(this._configuration===void 0||this._configuration.topology===void 0)return this._geometry.initialized&&this._geometry.uninitialize(),!0;const n=this._configuration,b=n.altered;if(!b.any)return!1;eo(n.topology!==void 0,"Valid topology expected");let y=b.layout.sort;const p=this._intermediaries.topology;let t;b.topology&&(p.initialize(n.topology.format,n.topology.semantics,n.topology.edges),this._intermediaries.aggregatedWeights=void 0,this._intermediaries.aggregatedHeights=void 0,this._intermediaries.aggregatedColors=void 0,this._intermediaries.accessorySpaces=void 0,this._intermediaries.labelRects=void 0,this._intermediaries.labelPaddingSpaces=void 0,t=void 0,this._geometry.initialized&&this._geometry.uninitialize(),this._geometry.initialize(p),y=!0),this._normalization=St.createNormalization(p,n);let i=this._intermediaries.aggregatedWeights;(i===void 0||b.layout.weight)&&(i=this._intermediaries.aggregatedWeights=this._bufferResolver.resolve(n.layout.weight,n,this._normalization),t=void 0,y=!0),y&&(bs.sortNodes(p,this._normalization,i,n),t=void 0);let a=this._intermediaries.accessorySpaces,r=this._intermediaries.labelRects,c=this._intermediaries.labelPaddingSpaces;if((t===void 0||b.layout.any)&&(a=this._intermediaries.accessorySpaces=new Array(p.numberOfInnerNodes),r=this._intermediaries.labelRects=new Array(p.numberOfInnerNodes),c=this._intermediaries.labelPaddingSpaces=new Array(p.numberOfInnerNodes),t=this.createLayout(p,i,n,a,r,c),this._geometry.innerNodeLayouts=void 0,this._geometry.leafNodeLayouts=void 0),this._geometry.innerNodeIndices===void 0&&(this._geometry.innerNodeIndices=Wf.innerNodes(p)),this._geometry.leafNodeIndices===void 0&&(this._geometry.leafNodeIndices=Wf.leafNodes(p)),this._geometry.innerNodeLayouts===void 0&&(this._geometry.innerNodeLayouts=Ct.createParentLayoutBuffer(p,t,this._configuration.geometry)),this._geometry.leafNodeLayouts===void 0&&(this._geometry.leafNodeLayouts=Ct.createLeafLayoutBuffer(p,t,this._configuration.geometry)),this._geometry.leafNodeAreaScales===void 0){const m=this._bufferResolver.constBufferCallback(1);if(this._configuration.geometry.leafLayer){const v=this._bufferResolver.resolve(this._configuration.geometry.leafLayer.areaScale,n,this._normalization,m);this._geometry.leafNodeAreaScales=Ct.createLeafAreaScalesBuffer(p,v)}else this._geometry.leafNodeAreaScales=Ct.createLeafAreaScalesBuffer(p,m())}const f=(m,v)=>{switch(v){case N.Color.Space.CMYK:{const _=m.fill(1,m.length,5);return new N.Color().fromCMYK(_[0],_[1],_[2],_[3],_[4])}case N.Color.Space.LAB:{const _=m.fill(1,m.length,4);return new N.Color().fromLAB(_[0],_[1],_[2],_[3])}case N.Color.Space.HSL:{const _=m.fill(1,m.length,4);return new N.Color().fromHSL(_[0],_[1],_[2],_[3])}case"hex":return new N.Color().fromHex(m);default:case N.Color.Space.RGB:{const _=m.fill(1,m.length,4);return new N.Color().fromRGB(_[0],_[1],_[2],_[3])}}},d=(m,v)=>{const _=new Array(m.length);for(let g=0;g<_.length;++g)_[g]=f(m[g],v);return _},h=(m,v,_)=>{if(m===void 0||v===void 0)return _;const g=m.find(x=>x.identifier===v.split(":")[1]);if(g===void 0)return _;if(br.isColorArray(g))return g.value!==void 0?f(g.value,g.colorspace):d(g.values,g.colorspace);if(br.isColorPreset(g)){const x=db.find(S=>S.identifier==g.preset);if(!x)return _;const E=g.steps&&x.colors.find(S=>S.length===g.steps*3)||x.colors[0];return N.ColorScale.fromArray(E,x.format,E.length/3,void 0).colors}else return _};if(n.altered.colors||this._colorLUT===void 0){const m=h(n.colors,n.geometry.emphasis?n.geometry.emphasis.color:void 0,new N.Color([0,.27058823529411763,.39215686274509803])),v=h(n.colors,n.geometry.auxiliary,new N.Color([0/255,67/255,37/255])),_=n.geometry.parentLayer?h(n.colors,n.geometry.parentLayer.colorMap,[new N.Color([91/255,92/255,93/255]),new N.Color([93/255,94/255,96/255])]):[new N.Color([91/255,92/255,93/255]),new N.Color([93/255,94/255,96/255])],g=n.geometry.leafLayer?h(n.colors,n.geometry.leafLayer.colorMap,[new N.Color([0/255,0/255,0/255]),new N.Color([44/255,14/255,49/255])]):[new N.Color([0/255,0/255,0/255]),new N.Color([44/255,14/255,49/255])];this._colorLUT=new ab(m,v,_,g),this._geometry.colorTable=void 0}(!this._geometry.colorTable||this._geometry.colorTable.length!==this._colorLUT.bits.length)&&(this._geometry.colorTable=this._colorLUT.bits,this._geometry.altered.alter("colorTableLength"),this._renderer.invalidate()),this.applyInnerNodeColorMapping(n),this.applyLeafNodeColorMapping(n);let s=this._geometry.heightScale;if(s===void 0||b.geometry.heightScale){const m=n.geometry.heightScale;m!==void 0&&m in wr.HeightScaleApproach?s=this._geometry.heightScale=wr.heightScale(p,m):m!==void 0?s=this._geometry.heightScale=m:s=this._geometry.heightScale=wr.heightScale(p,wr.HeightScaleApproach.SomethingInverseSqrt),this._geometry.altered.alter("heightScale")}n.altered.geometry.outlineWidth&&(this._geometry.outlineWidth=n.geometry.outlineWidth,this._geometry.altered.alter("outlineWidth")),n.geometry.emphasis&&n.altered.geometry.emphasis.outlineWidth&&(this._geometry.emphasisOutlineWidth=n.geometry.emphasis.outlineWidth,this._geometry.altered.alter("emphasisOutlineWidth")),this._geometry.showRoot=!!((u=n.geometry.parentLayer)!=null&&u.showRoot);let o;if(n.geometry.leafLayer!==void 0){if(b.geometry.heights||b.buffers||b.bufferViews||o===void 0){const m=n.geometry.leafLayer;o=this._bufferResolver.resolve(m.height!==void 0?m.height:"",n,this._normalization,this._bufferResolver.constBufferCallback()),this._intermediaries.aggregatedHeights=o;const v=Ct.createLayerHeightBuffer(p,o,void 0,this._configuration.geometry);this._geometry.leafNodeHeights=v,this._geometry.altered.alter("leafNodeHeights")}}else o=void 0,this._geometry.leafNodeHeights=Ct.createEmptyLayerHeightBuffer(p);if((this._intermediaries.leafLabels===void 0||this._intermediaries.innerNodeLabels===void 0||n.altered.labels)&&n.labels!==void 0&&n.labels.names!==void 0){let m=new Map;if(typeof n.labels.names=="string"){const v=St.create(p,this._normalization,n.labels.names,n);Object.keys(v).forEach(_=>{const g=parseInt(_,10);m.set(g,v[g])})}else m=n.labels.names;if(m!==void 0&&this._intermediaries.aggregatedHeights&&this._intermediaries.aggregatedWeights&&this._intermediaries.aggregatedColors){const v=vt.createLabelSelection(p,this._intermediaries.aggregatedWeights,this._intermediaries.aggregatedHeights,this._intermediaries.aggregatedColors,new Set,n.labels.innerNodeLayerRange,n.labels.numTopInnerNodes,n.labels.numTopWeightNodes,n.labels.numTopHeightNodes,n.labels.numTopColorNodes);this._intermediaries.leafLabels=vt.fillLeafLabelArray(p,m,v,this._geometry.heightScale,this._geometry.leafNodeLayouts,this._geometry.leafNodeHeights),this._intermediaries.innerNodeLabels=vt.fillInnerNodeLabelArrayOnAccessory(p,m,v,this._intermediaries.accessorySpaces),this._labelsChanged=!0,this._renderer.invalidate()}}return n.altered.reset(),!0}prepare(){this.updateLabels()}get renderer(){return this._renderer}get configuration(){return this._configuration}set configuration(n){this._configuration=n}}function pb(T,n,b=new N.Color().fromHex("fafafa")){const y=T instanceof HTMLCanvasElement?T:document.getElementById(T),p=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);navigator.appVersion.indexOf("Mac")!==-1&&p&&(y.dataset.msqrdP="no-WEBGL_draw_buffers",console.warn("detected Chrome on MacOS, disabling WEBGL_draw_buffers"));const t=new N.Canvas(y,{alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});return new N.viewer.EventBlocker(t.element).block("contextmenu"),t.clearColor=b,t.framePrecision=N.Wizard.Precision.byte,t.controller.multiFrameNumber=64,t.context.gl.clearColor(b.r,b.g,b.b,b.a),t.context.gl.clear(t.context.gl.COLOR_BUFFER_BIT),t}typeof LOG_VERBOSITY_THRESHOLD<"u"&&N.auxiliaries.logVerbosity(LOG_VERBOSITY_THRESHOLD);typeof DISABLE_ASSERTIONS<"u"&&N.auxiliaries.assertions(!DISABLE_ASSERTIONS);var $_={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(T,n){(function(b,y){T.exports=y()})(H,function b(){var y=typeof self<"u"?self:typeof window<"u"?window:y!==void 0?y:{},p=!y.document&&!!y.postMessage,t=y.IS_PAPA_WORKER||!1,i={},a=0,r={parse:function(R,O){var I=(O=O||{}).dynamicTyping||!1;if(S(I)&&(O.dynamicTypingFunction=I,I={}),O.dynamicTyping=I,O.transform=!!S(O.transform)&&O.transform,O.worker&&r.WORKERS_SUPPORTED){var D=function(){if(!r.WORKERS_SUPPORTED)return!1;var k=(Z=y.URL||y.webkitURL||null,K=b.toString(),r.BLOB_URL||(r.BLOB_URL=Z.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",K,")();"],{type:"text/javascript"})))),G=new y.Worker(k),Z,K;return G.onmessage=_,G.id=a++,i[G.id]=G}();return D.userStep=O.step,D.userChunk=O.chunk,D.userComplete=O.complete,D.userError=O.error,O.step=S(O.step),O.chunk=S(O.chunk),O.complete=S(O.complete),O.error=S(O.error),delete O.worker,void D.postMessage({input:R,config:O,workerId:D.id})}var j=null;return r.NODE_STREAM_INPUT,typeof R=="string"?(R=function(k){return k.charCodeAt(0)===65279?k.slice(1):k}(R),j=O.download?new d(O):new s(O)):R.readable===!0&&S(R.read)&&S(R.on)?j=new o(O):(y.File&&R instanceof File||R instanceof Object)&&(j=new h(O)),j.stream(R)},unparse:function(R,O){var I=!1,D=!0,j=",",k=`\r
`,G='"',Z=G+G,K=!1,Y=null,re=!1;(function(){if(typeof O=="object"){if(typeof O.delimiter!="string"||r.BAD_DELIMITERS.filter(function(ee){return O.delimiter.indexOf(ee)!==-1}).length||(j=O.delimiter),(typeof O.quotes=="boolean"||typeof O.quotes=="function"||Array.isArray(O.quotes))&&(I=O.quotes),typeof O.skipEmptyLines!="boolean"&&typeof O.skipEmptyLines!="string"||(K=O.skipEmptyLines),typeof O.newline=="string"&&(k=O.newline),typeof O.quoteChar=="string"&&(G=O.quoteChar),typeof O.header=="boolean"&&(D=O.header),Array.isArray(O.columns)){if(O.columns.length===0)throw new Error("Option columns is empty");Y=O.columns}O.escapeChar!==void 0&&(Z=O.escapeChar+G),(typeof O.escapeFormulae=="boolean"||O.escapeFormulae instanceof RegExp)&&(re=O.escapeFormulae instanceof RegExp?O.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Q=new RegExp(m(G),"g");if(typeof R=="string"&&(R=JSON.parse(R)),Array.isArray(R)){if(!R.length||Array.isArray(R[0]))return ae(null,R,K);if(typeof R[0]=="object")return ae(Y||Object.keys(R[0]),R,K)}else if(typeof R=="object")return typeof R.data=="string"&&(R.data=JSON.parse(R.data)),Array.isArray(R.data)&&(R.fields||(R.fields=R.meta&&R.meta.fields||Y),R.fields||(R.fields=Array.isArray(R.data[0])?R.fields:typeof R.data[0]=="object"?Object.keys(R.data[0]):[]),Array.isArray(R.data[0])||typeof R.data[0]=="object"||(R.data=[R.data])),ae(R.fields||[],R.data||[],K);throw new Error("Unable to serialize unrecognized input");function ae(ee,le,ge){var ve="";typeof ee=="string"&&(ee=JSON.parse(ee)),typeof le=="string"&&(le=JSON.parse(le));var ne=Array.isArray(ee)&&0<ee.length,be=!Array.isArray(le[0]);if(ne&&D){for(var Te=0;Te<ee.length;Te++)0<Te&&(ve+=j),ve+=se(ee[Te],Te);0<le.length&&(ve+=k)}for(var oe=0;oe<le.length;oe++){var me=ne?ee.length:le[oe].length,Ee=!1,Oe=ne?Object.keys(le[oe]).length===0:le[oe].length===0;if(ge&&!ne&&(Ee=ge==="greedy"?le[oe].join("").trim()==="":le[oe].length===1&&le[oe][0].length===0),ge==="greedy"&&ne){for(var xe=[],ke=0;ke<me;ke++){var Le=be?ee[ke]:ke;xe.push(le[oe][Le])}Ee=xe.join("").trim()===""}if(!Ee){for(var Re=0;Re<me;Re++){0<Re&&!Oe&&(ve+=j);var Ye=ne&&be?ee[Re]:Re;ve+=se(le[oe][Ye],Re)}oe<le.length-1&&(!ge||0<me&&!Oe)&&(ve+=k)}}return ve}function se(ee,le){if(ee==null)return"";if(ee.constructor===Date)return JSON.stringify(ee).slice(1,25);var ge=!1;re&&typeof ee=="string"&&re.test(ee)&&(ee="'"+ee,ge=!0);var ve=ee.toString().replace(Q,Z);return(ge=ge||I===!0||typeof I=="function"&&I(ee,le)||Array.isArray(I)&&I[le]||function(ne,be){for(var Te=0;Te<be.length;Te++)if(-1<ne.indexOf(be[Te]))return!0;return!1}(ve,r.BAD_DELIMITERS)||-1<ve.indexOf(j)||ve.charAt(0)===" "||ve.charAt(ve.length-1)===" ")?G+ve+G:ve}}};if(r.RECORD_SEP="",r.UNIT_SEP="",r.BYTE_ORDER_MARK="\uFEFF",r.BAD_DELIMITERS=["\r",`
`,'"',r.BYTE_ORDER_MARK],r.WORKERS_SUPPORTED=!p&&!!y.Worker,r.NODE_STREAM_INPUT=1,r.LocalChunkSize=10485760,r.RemoteChunkSize=5242880,r.DefaultDelimiter=",",r.Parser=v,r.ParserHandle=u,r.NetworkStreamer=d,r.FileStreamer=h,r.StringStreamer=s,r.ReadableStreamStreamer=o,y.jQuery){var c=y.jQuery;c.fn.parse=function(R){var O=R.config||{},I=[];return this.each(function(k){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&y.FileReader)||!this.files||this.files.length===0)return!0;for(var G=0;G<this.files.length;G++)I.push({file:this.files[G],inputElem:this,instanceConfig:c.extend({},O)})}),D(),this;function D(){if(I.length!==0){var k,G,Z,K,Y=I[0];if(S(R.before)){var re=R.before(Y.file,Y.inputElem);if(typeof re=="object"){if(re.action==="abort")return k="AbortError",G=Y.file,Z=Y.inputElem,K=re.reason,void(S(R.error)&&R.error({name:k},G,Z,K));if(re.action==="skip")return void j();typeof re.config=="object"&&(Y.instanceConfig=c.extend(Y.instanceConfig,re.config))}else if(re==="skip")return void j()}var Q=Y.instanceConfig.complete;Y.instanceConfig.complete=function(ae){S(Q)&&Q(ae,Y.file,Y.inputElem),j()},r.parse(Y.file,Y.instanceConfig)}else S(R.complete)&&R.complete()}function j(){I.splice(0,1),D()}}}function f(R){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(O){var I=E(O);I.chunkSize=parseInt(I.chunkSize),O.step||O.chunk||(I.chunkSize=null),this._handle=new u(I),(this._handle.streamer=this)._config=I}).call(this,R),this.parseChunk=function(O,I){if(this.isFirstChunk&&S(this._config.beforeFirstChunk)){var D=this._config.beforeFirstChunk(O);D!==void 0&&(O=D)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+O;this._partialLine="";var k=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var G=k.meta.cursor;this._finished||(this._partialLine=j.substring(G-this._baseIndex),this._baseIndex=G),k&&k.data&&(this._rowCount+=k.data.length);var Z=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(t)y.postMessage({results:k,workerId:r.WORKER_ID,finished:Z});else if(S(this._config.chunk)&&!I){if(this._config.chunk(k,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);k=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(k.data),this._completeResults.errors=this._completeResults.errors.concat(k.errors),this._completeResults.meta=k.meta),this._completed||!Z||!S(this._config.complete)||k&&k.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Z||k&&k.meta.paused||this._nextChunk(),k}this._halted=!0},this._sendError=function(O){S(this._config.error)?this._config.error(O):t&&this._config.error&&y.postMessage({workerId:r.WORKER_ID,error:O,finished:!1})}}function d(R){var O;(R=R||{}).chunkSize||(R.chunkSize=r.RemoteChunkSize),f.call(this,R),this._nextChunk=p?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(O=new XMLHttpRequest,this._config.withCredentials&&(O.withCredentials=this._config.withCredentials),p||(O.onload=w(this._chunkLoaded,this),O.onerror=w(this._chunkError,this)),O.open(this._config.downloadRequestBody?"POST":"GET",this._input,!p),this._config.downloadRequestHeaders){var I=this._config.downloadRequestHeaders;for(var D in I)O.setRequestHeader(D,I[D])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;O.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{O.send(this._config.downloadRequestBody)}catch(k){this._chunkError(k.message)}p&&O.status===0&&this._chunkError()}},this._chunkLoaded=function(){O.readyState===4&&(O.status<200||400<=O.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:O.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(I){var D=I.getResponseHeader("Content-Range");return D===null?-1:parseInt(D.substring(D.lastIndexOf("/")+1))}(O),this.parseChunk(O.responseText)))},this._chunkError=function(I){var D=O.statusText||I;this._sendError(new Error(D))}}function h(R){var O,I;(R=R||{}).chunkSize||(R.chunkSize=r.LocalChunkSize),f.call(this,R);var D=typeof FileReader<"u";this.stream=function(j){this._input=j,I=j.slice||j.webkitSlice||j.mozSlice,D?((O=new FileReader).onload=w(this._chunkLoaded,this),O.onerror=w(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var k=Math.min(this._start+this._config.chunkSize,this._input.size);j=I.call(j,this._start,k)}var G=O.readAsText(j,this._config.encoding);D||this._chunkLoaded({target:{result:G}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(O.error)}}function s(R){var O;f.call(this,R=R||{}),this.stream=function(I){return O=I,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var I,D=this._config.chunkSize;return D?(I=O.substring(0,D),O=O.substring(D)):(I=O,O=""),this._finished=!O,this.parseChunk(I)}}}function o(R){f.call(this,R=R||{});var O=[],I=!0,D=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){D&&O.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):I=!0},this._streamData=w(function(j){try{O.push(typeof j=="string"?j:j.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(k){this._streamError(k)}},this),this._streamError=w(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=w(function(){this._streamCleanUp(),D=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function u(R){var O,I,D,j=Math.pow(2,53),k=-j,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Z=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,Y=0,re=0,Q=!1,ae=!1,se=[],ee={data:[],errors:[],meta:{}};if(S(R.step)){var le=R.step;R.step=function(oe){if(ee=oe,ne())ve();else{if(ve(),ee.data.length===0)return;Y+=oe.data.length,R.preview&&Y>R.preview?I.abort():(ee.data=ee.data[0],le(ee,K))}}}function ge(oe){return R.skipEmptyLines==="greedy"?oe.join("").trim()==="":oe.length===1&&oe[0].length===0}function ve(){return ee&&D&&(Te("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+r.DefaultDelimiter+"'"),D=!1),R.skipEmptyLines&&(ee.data=ee.data.filter(function(oe){return!ge(oe)})),ne()&&function(){if(!ee)return;function oe(Ee,Oe){S(R.transformHeader)&&(Ee=R.transformHeader(Ee,Oe)),se.push(Ee)}if(Array.isArray(ee.data[0])){for(var me=0;ne()&&me<ee.data.length;me++)ee.data[me].forEach(oe);ee.data.splice(0,1)}else ee.data.forEach(oe)}(),function(){if(!ee||!R.header&&!R.dynamicTyping&&!R.transform)return ee;function oe(Ee,Oe){var xe,ke=R.header?{}:[];for(xe=0;xe<Ee.length;xe++){var Le=xe,Re=Ee[xe];R.header&&(Le=xe>=se.length?"__parsed_extra":se[xe]),R.transform&&(Re=R.transform(Re,Le)),Re=be(Le,Re),Le==="__parsed_extra"?(ke[Le]=ke[Le]||[],ke[Le].push(Re)):ke[Le]=Re}return R.header&&(xe>se.length?Te("FieldMismatch","TooManyFields","Too many fields: expected "+se.length+" fields but parsed "+xe,re+Oe):xe<se.length&&Te("FieldMismatch","TooFewFields","Too few fields: expected "+se.length+" fields but parsed "+xe,re+Oe)),ke}var me=1;return!ee.data.length||Array.isArray(ee.data[0])?(ee.data=ee.data.map(oe),me=ee.data.length):ee.data=oe(ee.data,0),R.header&&ee.meta&&(ee.meta.fields=se),re+=me,ee}()}function ne(){return R.header&&se.length===0}function be(oe,me){return Ee=oe,R.dynamicTypingFunction&&R.dynamicTyping[Ee]===void 0&&(R.dynamicTyping[Ee]=R.dynamicTypingFunction(Ee)),(R.dynamicTyping[Ee]||R.dynamicTyping)===!0?me==="true"||me==="TRUE"||me!=="false"&&me!=="FALSE"&&(function(Oe){if(G.test(Oe)){var xe=parseFloat(Oe);if(k<xe&&xe<j)return!0}return!1}(me)?parseFloat(me):Z.test(me)?new Date(me):me===""?null:me):me;var Ee}function Te(oe,me,Ee,Oe){var xe={type:oe,code:me,message:Ee};Oe!==void 0&&(xe.row=Oe),ee.errors.push(xe)}this.parse=function(oe,me,Ee){var Oe=R.quoteChar||'"';if(R.newline||(R.newline=function(Le,Re){Le=Le.substring(0,1048576);var Ye=new RegExp(m(Re)+"([^]*?)"+m(Re),"gm"),qe=(Le=Le.replace(Ye,"")).split("\r"),rt=Le.split(`
`),ht=1<rt.length&&rt[0].length<qe[0].length;if(qe.length===1||ht)return`
`;for(var $e=0,Me=0;Me<qe.length;Me++)qe[Me][0]===`
`&&$e++;return $e>=qe.length/2?`\r
`:"\r"}(oe,Oe)),D=!1,R.delimiter)S(R.delimiter)&&(R.delimiter=R.delimiter(oe),ee.meta.delimiter=R.delimiter);else{var xe=function(Le,Re,Ye,qe,rt){var ht,$e,Me,Be;rt=rt||[",","	","|",";",r.RECORD_SEP,r.UNIT_SEP];for(var yt=0;yt<rt.length;yt++){var we=rt[yt],At=0,dt=0,Et=0;Me=void 0;for(var ft=new v({comments:qe,delimiter:we,newline:Re,preview:10}).parse(Le),mt=0;mt<ft.data.length;mt++)if(Ye&&ge(ft.data[mt]))Et++;else{var gt=ft.data[mt].length;dt+=gt,Me!==void 0?0<gt&&(At+=Math.abs(gt-Me),Me=gt):Me=gt}0<ft.data.length&&(dt/=ft.data.length-Et),($e===void 0||At<=$e)&&(Be===void 0||Be<dt)&&1.99<dt&&($e=At,ht=we,Be=dt)}return{successful:!!(R.delimiter=ht),bestDelimiter:ht}}(oe,R.newline,R.skipEmptyLines,R.comments,R.delimitersToGuess);xe.successful?R.delimiter=xe.bestDelimiter:(D=!0,R.delimiter=r.DefaultDelimiter),ee.meta.delimiter=R.delimiter}var ke=E(R);return R.preview&&R.header&&ke.preview++,O=oe,I=new v(ke),ee=I.parse(O,me,Ee),ve(),Q?{meta:{paused:!0}}:ee||{meta:{paused:!1}}},this.paused=function(){return Q},this.pause=function(){Q=!0,I.abort(),O=S(R.chunk)?"":O.substring(I.getCharIndex())},this.resume=function(){K.streamer._halted?(Q=!1,K.streamer.parseChunk(O,!0)):setTimeout(K.resume,3)},this.aborted=function(){return ae},this.abort=function(){ae=!0,I.abort(),ee.meta.aborted=!0,S(R.complete)&&R.complete(ee),O=""}}function m(R){return R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(R){var O,I=(R=R||{}).delimiter,D=R.newline,j=R.comments,k=R.step,G=R.preview,Z=R.fastMode,K=O=R.quoteChar===void 0||R.quoteChar===null?'"':R.quoteChar;if(R.escapeChar!==void 0&&(K=R.escapeChar),(typeof I!="string"||-1<r.BAD_DELIMITERS.indexOf(I))&&(I=","),j===I)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<r.BAD_DELIMITERS.indexOf(j))&&(j=!1),D!==`
`&&D!=="\r"&&D!==`\r
`&&(D=`
`);var Y=0,re=!1;this.parse=function(Q,ae,se){if(typeof Q!="string")throw new Error("Input must be a string");var ee=Q.length,le=I.length,ge=D.length,ve=j.length,ne=S(k),be=[],Te=[],oe=[],me=Y=0;if(!Q)return tt();if(R.header&&!ae){var Ee=Q.split(D)[0].split(I),Oe=[],xe={},ke=!1;for(var Le in Ee){var Re=Ee[Le];S(R.transformHeader)&&(Re=R.transformHeader(Re,Le));var Ye=Re,qe=xe[Re]||0;for(0<qe&&(ke=!0,Ye=Re+"_"+qe),xe[Re]=qe+1;Oe.includes(Ye);)Ye=Ye+"_"+qe;Oe.push(Ye)}if(ke){var rt=Q.split(D);rt[0]=Oe.join(I),Q=rt.join(D)}}if(Z||Z!==!1&&Q.indexOf(O)===-1){for(var ht=Q.split(D),$e=0;$e<ht.length;$e++){if(oe=ht[$e],Y+=oe.length,$e!==ht.length-1)Y+=D.length;else if(se)return tt();if(!j||oe.substring(0,ve)!==j){if(ne){if(be=[],Et(oe.split(I)),Bt(),re)return tt()}else Et(oe.split(I));if(G&&G<=$e)return be=be.slice(0,G),tt(!0)}}return tt()}for(var Me=Q.indexOf(I,Y),Be=Q.indexOf(D,Y),yt=new RegExp(m(K)+m(O),"g"),we=Q.indexOf(O,Y);;)if(Q[Y]!==O)if(j&&oe.length===0&&Q.substring(Y,Y+ve)===j){if(Be===-1)return tt();Y=Be+ge,Be=Q.indexOf(D,Y),Me=Q.indexOf(I,Y)}else if(Me!==-1&&(Me<Be||Be===-1))oe.push(Q.substring(Y,Me)),Y=Me+le,Me=Q.indexOf(I,Y);else{if(Be===-1)break;if(oe.push(Q.substring(Y,Be)),gt(Be+ge),ne&&(Bt(),re))return tt();if(G&&be.length>=G)return tt(!0)}else for(we=Y,Y++;;){if((we=Q.indexOf(O,we+1))===-1)return se||Te.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:be.length,index:Y}),mt();if(we===ee-1)return mt(Q.substring(Y,we).replace(yt,O));if(O!==K||Q[we+1]!==K){if(O===K||we===0||Q[we-1]!==K){Me!==-1&&Me<we+1&&(Me=Q.indexOf(I,we+1)),Be!==-1&&Be<we+1&&(Be=Q.indexOf(D,we+1));var At=ft(Be===-1?Me:Math.min(Me,Be));if(Q.substr(we+1+At,le)===I){oe.push(Q.substring(Y,we).replace(yt,O)),Q[Y=we+1+At+le]!==O&&(we=Q.indexOf(O,Y)),Me=Q.indexOf(I,Y),Be=Q.indexOf(D,Y);break}var dt=ft(Be);if(Q.substring(we+1+dt,we+1+dt+ge)===D){if(oe.push(Q.substring(Y,we).replace(yt,O)),gt(we+1+dt+ge),Me=Q.indexOf(I,Y),we=Q.indexOf(O,Y),ne&&(Bt(),re))return tt();if(G&&be.length>=G)return tt(!0);break}Te.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:be.length,index:Y}),we++}}else we++}return mt();function Et(Qe){be.push(Qe),me=Y}function ft(Qe){var Rt=0;if(Qe!==-1){var Gt=Q.substring(we+1,Qe);Gt&&Gt.trim()===""&&(Rt=Gt.length)}return Rt}function mt(Qe){return se||(Qe===void 0&&(Qe=Q.substring(Y)),oe.push(Qe),Y=ee,Et(oe),ne&&Bt()),tt()}function gt(Qe){Y=Qe,Et(oe),oe=[],Be=Q.indexOf(D,Y)}function tt(Qe){return{data:be,errors:Te,meta:{delimiter:I,linebreak:D,aborted:re,truncated:!!Qe,cursor:me+(ae||0)}}}function Bt(){k(tt()),be=[],Te=[]}},this.abort=function(){re=!0},this.getCharIndex=function(){return Y}}function _(R){var O=R.data,I=i[O.workerId],D=!1;if(O.error)I.userError(O.error,O.file);else if(O.results&&O.results.data){var j={abort:function(){D=!0,g(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(S(I.userStep)){for(var k=0;k<O.results.data.length&&(I.userStep({data:O.results.data[k],errors:O.results.errors,meta:O.results.meta},j),!D);k++);delete O.results}else S(I.userChunk)&&(I.userChunk(O.results,j,O.file),delete O.results)}O.finished&&!D&&g(O.workerId,O.results)}function g(R,O){var I=i[R];S(I.userComplete)&&I.userComplete(O),I.terminate(),delete i[R]}function x(){throw new Error("Not implemented.")}function E(R){if(typeof R!="object"||R===null)return R;var O=Array.isArray(R)?[]:{};for(var I in R)O[I]=E(R[I]);return O}function w(R,O){return function(){R.apply(O,arguments)}}function S(R){return typeof R=="function"}return t&&(y.onmessage=function(R){var O=R.data;if(r.WORKER_ID===void 0&&O&&(r.WORKER_ID=O.workerId),typeof O.input=="string")y.postMessage({workerId:r.WORKER_ID,results:r.parse(O.input,O.config),finished:!0});else if(y.File&&O.input instanceof File||O.input instanceof Object){var I=r.parse(O.input,O.config);I&&y.postMessage({workerId:r.WORKER_ID,results:I,finished:!0})}}),(d.prototype=Object.create(f.prototype)).constructor=d,(h.prototype=Object.create(f.prototype)).constructor=h,(s.prototype=Object.create(s.prototype)).constructor=s,(o.prototype=Object.create(f.prototype)).constructor=o,r})})($_);var vb=$_.exports;class mb extends N.Initializable{expose(){}}export{br as C,mb as E,bs as N,bt as T,_b as V,fb as g,pb as i,vb as p,N as w};
