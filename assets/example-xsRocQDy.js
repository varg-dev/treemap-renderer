function $v(E,t){for(var m=0;m<t.length;m++){const y=t[m];if(typeof y!="string"&&!Array.isArray(y)){for(const l in y)if(l!=="default"&&!(l in E)){const r=Object.getOwnPropertyDescriptor(y,l);r&&Object.defineProperty(E,l,r.get?r:{enumerable:!0,get:()=>y[l]})}}}return Object.freeze(Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}))}function Hv(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}var rl={exports:{}},sr={},wi={},Pi={},Ri={},Dc;function ye(){if(Dc)return Ri;Dc=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.isFunction=void 0;function E(t){return typeof t=="function"}return Ri.isFunction=E,Ri}var Ye={},Li={},Mi={},jc;function Hr(){if(jc)return Mi;jc=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.createErrorClass=void 0;function E(t){var m=function(l){Error.call(l),l.stack=new Error().stack},y=t(m);return y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y}return Mi.createErrorClass=E,Mi}var Uc;function d_(){if(Uc)return Li;Uc=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.UnsubscriptionError=void 0;var E=Hr();return Li.UnsubscriptionError=E.createErrorClass(function(t){return function(y){t(this),this.message=y?y.length+` errors occurred during unsubscription:
`+y.map(function(l,r){return r+1+") "+l.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=y}}),Li}var Ii={},kc;function Jt(){if(kc)return Ii;kc=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.arrRemove=void 0;function E(t,m){if(t){var y=t.indexOf(m);0<=y&&t.splice(y,1)}}return Ii.arrRemove=E,Ii}var Gc;function st(){if(Gc)return Ye;Gc=1;var E=Ye&&Ye.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,d=p&&h[p],f=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&f>=h.length&&(h=void 0),{value:h&&h[f++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")},t=Ye&&Ye.__read||function(h,p){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var f=d.call(h),s,o=[],u;try{for(;(p===void 0||p-- >0)&&!(s=f.next()).done;)o.push(s.value)}catch(b){u={error:b}}finally{try{s&&!s.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}return o},m=Ye&&Ye.__spreadArray||function(h,p){for(var d=0,f=p.length,s=h.length;d<f;d++,s++)h[s]=p[d];return h};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.isSubscription=Ye.EMPTY_SUBSCRIPTION=Ye.Subscription=void 0;var y=ye(),l=d_(),r=Jt(),a=function(){function h(p){this.initialTeardown=p,this.closed=!1,this._parentage=null,this._finalizers=null}return h.prototype.unsubscribe=function(){var p,d,f,s,o;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var b=E(u),v=b.next();!v.done;v=b.next()){var _=v.value;_.remove(this)}}catch(R){p={error:R}}finally{try{v&&!v.done&&(d=b.return)&&d.call(b)}finally{if(p)throw p.error}}else u.remove(this);var g=this.initialTeardown;if(y.isFunction(g))try{g()}catch(R){o=R instanceof l.UnsubscriptionError?R.errors:[R]}var x=this._finalizers;if(x){this._finalizers=null;try{for(var T=E(x),O=T.next();!O.done;O=T.next()){var A=O.value;try{i(A)}catch(R){o=o??[],R instanceof l.UnsubscriptionError?o=m(m([],t(o)),t(R.errors)):o.push(R)}}}catch(R){f={error:R}}finally{try{O&&!O.done&&(s=T.return)&&s.call(T)}finally{if(f)throw f.error}}}if(o)throw new l.UnsubscriptionError(o)}},h.prototype.add=function(p){var d;if(p&&p!==this)if(this.closed)i(p);else{if(p instanceof h){if(p.closed||p._hasParent(this))return;p._addParent(this)}(this._finalizers=(d=this._finalizers)!==null&&d!==void 0?d:[]).push(p)}},h.prototype._hasParent=function(p){var d=this._parentage;return d===p||Array.isArray(d)&&d.includes(p)},h.prototype._addParent=function(p){var d=this._parentage;this._parentage=Array.isArray(d)?(d.push(p),d):d?[d,p]:p},h.prototype._removeParent=function(p){var d=this._parentage;d===p?this._parentage=null:Array.isArray(d)&&r.arrRemove(d,p)},h.prototype.remove=function(p){var d=this._finalizers;d&&r.arrRemove(d,p),p instanceof h&&p._removeParent(this)},h.EMPTY=function(){var p=new h;return p.closed=!0,p}(),h}();Ye.Subscription=a,Ye.EMPTY_SUBSCRIPTION=a.EMPTY;function n(h){return h instanceof a||h&&"closed"in h&&y.isFunction(h.remove)&&y.isFunction(h.add)&&y.isFunction(h.unsubscribe)}Ye.isSubscription=n;function i(h){y.isFunction(h)?h():h.unsubscribe()}return Ye}var Fi={},qc;function As(){return qc||(qc=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.config=void 0,Fi.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}),Fi}var Ci={},or={},Wc;function f_(){return Wc||(Wc=1,function(E){var t=or&&or.__read||function(y,l){var r=typeof Symbol=="function"&&y[Symbol.iterator];if(!r)return y;var a=r.call(y),n,i=[],h;try{for(;(l===void 0||l-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(p){h={error:p}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(h)throw h.error}}return i},m=or&&or.__spreadArray||function(y,l){for(var r=0,a=l.length,n=y.length;r<a;r++,n++)y[n]=l[r];return y};Object.defineProperty(E,"__esModule",{value:!0}),E.timeoutProvider=void 0,E.timeoutProvider={setTimeout:function(y,l){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var n=E.timeoutProvider.delegate;return n!=null&&n.setTimeout?n.setTimeout.apply(n,m([y,l],t(r))):setTimeout.apply(void 0,m([y,l],t(r)))},clearTimeout:function(y){var l=E.timeoutProvider.delegate;return((l==null?void 0:l.clearTimeout)||clearTimeout)(y)},delegate:void 0}}(or)),or}var Vc;function __(){if(Vc)return Ci;Vc=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.reportUnhandledError=void 0;var E=As(),t=f_();function m(y){t.timeoutProvider.setTimeout(function(){var l=E.config.onUnhandledError;if(l)l(y);else throw y})}return Ci.reportUnhandledError=m,Ci}var Ni={},$c;function $e(){if($c)return Ni;$c=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.noop=void 0;function E(){}return Ni.noop=E,Ni}var _t={},Hc;function Xv(){if(Hc)return _t;Hc=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.createNotification=_t.nextNotification=_t.errorNotification=_t.COMPLETE_NOTIFICATION=void 0,_t.COMPLETE_NOTIFICATION=function(){return m("C",void 0,void 0)}();function E(y){return m("E",void 0,y)}_t.errorNotification=E;function t(y){return m("N",y,void 0)}_t.nextNotification=t;function m(y,l,r){return{kind:y,value:l,error:r}}return _t.createNotification=m,_t}var ur={},Xc;function Rl(){if(Xc)return ur;Xc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.captureError=ur.errorContext=void 0;var E=As(),t=null;function m(l){if(E.config.useDeprecatedSynchronousErrorHandling){var r=!t;if(r&&(t={errorThrown:!1,error:null}),l(),r){var a=t,n=a.errorThrown,i=a.error;if(t=null,n)throw i}}else l()}ur.errorContext=m;function y(l){E.config.useDeprecatedSynchronousErrorHandling&&t&&(t.errorThrown=!0,t.error=l)}return ur.captureError=y,ur}var Yc;function Os(){return Yc||(Yc=1,function(E){var t=Pi&&Pi.__extends||function(){var _=function(g,x){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,O){T.__proto__=O}||function(T,O){for(var A in O)Object.prototype.hasOwnProperty.call(O,A)&&(T[A]=O[A])},_(g,x)};return function(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");_(g,x);function T(){this.constructor=g}g.prototype=x===null?Object.create(x):(T.prototype=x.prototype,new T)}}();Object.defineProperty(E,"__esModule",{value:!0}),E.EMPTY_OBSERVER=E.SafeSubscriber=E.Subscriber=void 0;var m=ye(),y=st(),l=As(),r=__(),a=$e(),n=Xv(),i=f_(),h=Rl(),p=function(_){t(g,_);function g(x){var T=_.call(this)||this;return T.isStopped=!1,x?(T.destination=x,y.isSubscription(x)&&x.add(T)):T.destination=E.EMPTY_OBSERVER,T}return g.create=function(x,T,O){return new o(x,T,O)},g.prototype.next=function(x){this.isStopped?v(n.nextNotification(x),this):this._next(x)},g.prototype.error=function(x){this.isStopped?v(n.errorNotification(x),this):(this.isStopped=!0,this._error(x))},g.prototype.complete=function(){this.isStopped?v(n.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},g.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_.prototype.unsubscribe.call(this),this.destination=null)},g.prototype._next=function(x){this.destination.next(x)},g.prototype._error=function(x){try{this.destination.error(x)}finally{this.unsubscribe()}},g.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},g}(y.Subscription);E.Subscriber=p;var d=Function.prototype.bind;function f(_,g){return d.call(_,g)}var s=function(){function _(g){this.partialObserver=g}return _.prototype.next=function(g){var x=this.partialObserver;if(x.next)try{x.next(g)}catch(T){u(T)}},_.prototype.error=function(g){var x=this.partialObserver;if(x.error)try{x.error(g)}catch(T){u(T)}else u(g)},_.prototype.complete=function(){var g=this.partialObserver;if(g.complete)try{g.complete()}catch(x){u(x)}},_}(),o=function(_){t(g,_);function g(x,T,O){var A=_.call(this)||this,R;if(m.isFunction(x)||!x)R={next:x??void 0,error:T??void 0,complete:O??void 0};else{var P;A&&l.config.useDeprecatedNextContext?(P=Object.create(x),P.unsubscribe=function(){return A.unsubscribe()},R={next:x.next&&f(x.next,P),error:x.error&&f(x.error,P),complete:x.complete&&f(x.complete,P)}):R=x}return A.destination=new s(R),A}return g}(p);E.SafeSubscriber=o;function u(_){l.config.useDeprecatedSynchronousErrorHandling?h.captureError(_):r.reportUnhandledError(_)}function b(_){throw _}function v(_,g){var x=l.config.onStoppedNotification;x&&i.timeoutProvider.setTimeout(function(){return x(_,g)})}E.EMPTY_OBSERVER={closed:!0,next:a.noop,error:b,complete:a.noop}}(Pi)),Pi}var zi={},Zc;function fo(){return Zc||(Zc=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.observable=void 0,zi.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()),zi}var lr={},Bi={},Kc;function He(){if(Kc)return Bi;Kc=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.identity=void 0;function E(t){return t}return Bi.identity=E,Bi}var Qc;function _o(){if(Qc)return lr;Qc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.pipeFromArray=lr.pipe=void 0;var E=He();function t(){for(var y=[],l=0;l<arguments.length;l++)y[l]=arguments[l];return m(y)}lr.pipe=t;function m(y){return y.length===0?E.identity:y.length===1?y[0]:function(r){return y.reduce(function(a,n){return n(a)},r)}}return lr.pipeFromArray=m,lr}var Jc;function Te(){if(Jc)return wi;Jc=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Observable=void 0;var E=Os(),t=st(),m=fo(),y=_o(),l=As(),r=ye(),a=Rl(),n=function(){function d(f){f&&(this._subscribe=f)}return d.prototype.lift=function(f){var s=new d;return s.source=this,s.operator=f,s},d.prototype.subscribe=function(f,s,o){var u=this,b=p(f)?f:new E.SafeSubscriber(f,s,o);return a.errorContext(function(){var v=u,_=v.operator,g=v.source;b.add(_?_.call(b,g):g?u._subscribe(b):u._trySubscribe(b))}),b},d.prototype._trySubscribe=function(f){try{return this._subscribe(f)}catch(s){f.error(s)}},d.prototype.forEach=function(f,s){var o=this;return s=i(s),new s(function(u,b){var v=new E.SafeSubscriber({next:function(_){try{f(_)}catch(g){b(g),v.unsubscribe()}},error:b,complete:u});o.subscribe(v)})},d.prototype._subscribe=function(f){var s;return(s=this.source)===null||s===void 0?void 0:s.subscribe(f)},d.prototype[m.observable]=function(){return this},d.prototype.pipe=function(){for(var f=[],s=0;s<arguments.length;s++)f[s]=arguments[s];return y.pipeFromArray(f)(this)},d.prototype.toPromise=function(f){var s=this;return f=i(f),new f(function(o,u){var b;s.subscribe(function(v){return b=v},function(v){return u(v)},function(){return o(b)})})},d.create=function(f){return new d(f)},d}();wi.Observable=n;function i(d){var f;return(f=d??l.config.Promise)!==null&&f!==void 0?f:Promise}function h(d){return d&&r.isFunction(d.next)&&r.isFunction(d.error)&&r.isFunction(d.complete)}function p(d){return d&&d instanceof E.Subscriber||h(d)&&t.isSubscription(d)}return wi}var cr={},Di={},hr={},eh;function ee(){if(eh)return hr;eh=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.operate=hr.hasLift=void 0;var E=ye();function t(y){return E.isFunction(y==null?void 0:y.lift)}hr.hasLift=t;function m(y){return function(l){if(t(l))return l.lift(function(r){try{return y(r,this)}catch(a){this.error(a)}});throw new TypeError("Unable to lift unknown Observable type")}}return hr.operate=m,hr}var Rt={},th;function re(){if(th)return Rt;th=1;var E=Rt&&Rt.__extends||function(){var l=function(r,a){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h])},l(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");l(r,a);function n(){this.constructor=r}r.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.OperatorSubscriber=Rt.createOperatorSubscriber=void 0;var t=Os();function m(l,r,a,n,i){return new y(l,r,a,n,i)}Rt.createOperatorSubscriber=m;var y=function(l){E(r,l);function r(a,n,i,h,p,d){var f=l.call(this,a)||this;return f.onFinalize=p,f.shouldUnsubscribe=d,f._next=n?function(s){try{n(s)}catch(o){a.error(o)}}:l.prototype._next,f._error=h?function(s){try{h(s)}catch(o){a.error(o)}finally{this.unsubscribe()}}:l.prototype._error,f._complete=i?function(){try{i()}catch(s){a.error(s)}finally{this.unsubscribe()}}:l.prototype._complete,f}return r.prototype.unsubscribe=function(){var a;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;l.prototype.unsubscribe.call(this),!n&&((a=this.onFinalize)===null||a===void 0||a.call(this))}},r}(t.Subscriber);return Rt.OperatorSubscriber=y,Rt}var rh;function p_(){if(rh)return Di;rh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.refCount=void 0;var E=ee(),t=re();function m(){return E.operate(function(y,l){var r=null;y._refCount++;var a=t.createOperatorSubscriber(l,void 0,void 0,void 0,function(){if(!y||y._refCount<=0||0<--y._refCount){r=null;return}var n=y._connection,i=r;r=null,n&&(!i||n===i)&&n.unsubscribe(),l.unsubscribe()});y.subscribe(a),a.closed||(r=y.connect())})}return Di.refCount=m,Di}var ih;function po(){if(ih)return cr;ih=1;var E=cr&&cr.__extends||function(){var n=function(i,h){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(p[f]=d[f])},n(i,h)};return function(i,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");n(i,h);function p(){this.constructor=i}i.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}}();Object.defineProperty(cr,"__esModule",{value:!0}),cr.ConnectableObservable=void 0;var t=Te(),m=st(),y=p_(),l=re(),r=ee(),a=function(n){E(i,n);function i(h,p){var d=n.call(this)||this;return d.source=h,d.subjectFactory=p,d._subject=null,d._refCount=0,d._connection=null,r.hasLift(h)&&(d.lift=h.lift),d}return i.prototype._subscribe=function(h){return this.getSubject().subscribe(h)},i.prototype.getSubject=function(){var h=this._subject;return(!h||h.isStopped)&&(this._subject=this.subjectFactory()),this._subject},i.prototype._teardown=function(){this._refCount=0;var h=this._connection;this._subject=this._connection=null,h==null||h.unsubscribe()},i.prototype.connect=function(){var h=this,p=this._connection;if(!p){p=this._connection=new m.Subscription;var d=this.getSubject();p.add(this.source.subscribe(l.createOperatorSubscriber(d,void 0,function(){h._teardown(),d.complete()},function(f){h._teardown(),d.error(f)},function(){return h._teardown()}))),p.closed&&(this._connection=null,p=m.Subscription.EMPTY)}return p},i.prototype.refCount=function(){return y.refCount()(this)},i}(t.Observable);return cr.ConnectableObservable=a,cr}var ji={},il={},nh;function Yv(){return nh||(nh=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.performanceTimestampProvider=void 0,E.performanceTimestampProvider={now:function(){return(E.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}}(il)),il}var dr={},ah;function v_(){return ah||(ah=1,function(E){var t=dr&&dr.__read||function(l,r){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var n=a.call(l),i,h=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)h.push(i.value)}catch(d){p={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(p)throw p.error}}return h},m=dr&&dr.__spreadArray||function(l,r){for(var a=0,n=r.length,i=l.length;a<n;a++,i++)l[i]=r[a];return l};Object.defineProperty(E,"__esModule",{value:!0}),E.animationFrameProvider=void 0;var y=st();E.animationFrameProvider={schedule:function(l){var r=requestAnimationFrame,a=cancelAnimationFrame,n=E.animationFrameProvider.delegate;n&&(r=n.requestAnimationFrame,a=n.cancelAnimationFrame);var i=r(function(h){a=void 0,l(h)});return new y.Subscription(function(){return a==null?void 0:a(i)})},requestAnimationFrame:function(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];var a=E.animationFrameProvider.delegate;return((a==null?void 0:a.requestAnimationFrame)||requestAnimationFrame).apply(void 0,m([],t(l)))},cancelAnimationFrame:function(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];var a=E.animationFrameProvider.delegate;return((a==null?void 0:a.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,m([],t(l)))},delegate:void 0}}(dr)),dr}var sh;function Zv(){if(sh)return ji;sh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.animationFrames=void 0;var E=Te(),t=Yv(),m=v_();function y(a){return a?l(a):r}ji.animationFrames=y;function l(a){return new E.Observable(function(n){var i=a||t.performanceTimestampProvider,h=i.now(),p=0,d=function(){n.closed||(p=m.animationFrameProvider.requestAnimationFrame(function(f){p=0;var s=i.now();n.next({timestamp:a?s:f,elapsed:s-h}),d()}))};return d(),function(){p&&m.animationFrameProvider.cancelAnimationFrame(p)}})}var r=l();return ji}var pt={},Ui={},oh;function m_(){if(oh)return Ui;oh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.ObjectUnsubscribedError=void 0;var E=Hr();return Ui.ObjectUnsubscribedError=E.createErrorClass(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ui}var uh;function Xe(){if(uh)return pt;uh=1;var E=pt&&pt.__extends||function(){var h=function(p,d){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,s){f.__proto__=s}||function(f,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(f[o]=s[o])},h(p,d)};return function(p,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");h(p,d);function f(){this.constructor=p}p.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}(),t=pt&&pt.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,d=p&&h[p],f=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&f>=h.length&&(h=void 0),{value:h&&h[f++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(pt,"__esModule",{value:!0}),pt.AnonymousSubject=pt.Subject=void 0;var m=Te(),y=st(),l=m_(),r=Jt(),a=Rl(),n=function(h){E(p,h);function p(){var d=h.call(this)||this;return d.closed=!1,d.currentObservers=null,d.observers=[],d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return p.prototype.lift=function(d){var f=new i(this,this);return f.operator=d,f},p.prototype._throwIfClosed=function(){if(this.closed)throw new l.ObjectUnsubscribedError},p.prototype.next=function(d){var f=this;a.errorContext(function(){var s,o;if(f._throwIfClosed(),!f.isStopped){f.currentObservers||(f.currentObservers=Array.from(f.observers));try{for(var u=t(f.currentObservers),b=u.next();!b.done;b=u.next()){var v=b.value;v.next(d)}}catch(_){s={error:_}}finally{try{b&&!b.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}}})},p.prototype.error=function(d){var f=this;a.errorContext(function(){if(f._throwIfClosed(),!f.isStopped){f.hasError=f.isStopped=!0,f.thrownError=d;for(var s=f.observers;s.length;)s.shift().error(d)}})},p.prototype.complete=function(){var d=this;a.errorContext(function(){if(d._throwIfClosed(),!d.isStopped){d.isStopped=!0;for(var f=d.observers;f.length;)f.shift().complete()}})},p.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(p.prototype,"observed",{get:function(){var d;return((d=this.observers)===null||d===void 0?void 0:d.length)>0},enumerable:!1,configurable:!0}),p.prototype._trySubscribe=function(d){return this._throwIfClosed(),h.prototype._trySubscribe.call(this,d)},p.prototype._subscribe=function(d){return this._throwIfClosed(),this._checkFinalizedStatuses(d),this._innerSubscribe(d)},p.prototype._innerSubscribe=function(d){var f=this,s=this,o=s.hasError,u=s.isStopped,b=s.observers;return o||u?y.EMPTY_SUBSCRIPTION:(this.currentObservers=null,b.push(d),new y.Subscription(function(){f.currentObservers=null,r.arrRemove(b,d)}))},p.prototype._checkFinalizedStatuses=function(d){var f=this,s=f.hasError,o=f.thrownError,u=f.isStopped;s?d.error(o):u&&d.complete()},p.prototype.asObservable=function(){var d=new m.Observable;return d.source=this,d},p.create=function(d,f){return new i(d,f)},p}(m.Observable);pt.Subject=n;var i=function(h){E(p,h);function p(d,f){var s=h.call(this)||this;return s.destination=d,s.source=f,s}return p.prototype.next=function(d){var f,s;(s=(f=this.destination)===null||f===void 0?void 0:f.next)===null||s===void 0||s.call(f,d)},p.prototype.error=function(d){var f,s;(s=(f=this.destination)===null||f===void 0?void 0:f.error)===null||s===void 0||s.call(f,d)},p.prototype.complete=function(){var d,f;(f=(d=this.destination)===null||d===void 0?void 0:d.complete)===null||f===void 0||f.call(d)},p.prototype._subscribe=function(d){var f,s;return(s=(f=this.source)===null||f===void 0?void 0:f.subscribe(d))!==null&&s!==void 0?s:y.EMPTY_SUBSCRIPTION},p}(n);return pt.AnonymousSubject=i,pt}var fr={},lh;function b_(){if(lh)return fr;lh=1;var E=fr&&fr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(fr,"__esModule",{value:!0}),fr.BehaviorSubject=void 0;var t=Xe(),m=function(y){E(l,y);function l(r){var a=y.call(this)||this;return a._value=r,a}return Object.defineProperty(l.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),l.prototype._subscribe=function(r){var a=y.prototype._subscribe.call(this,r);return!a.closed&&r.next(this._value),a},l.prototype.getValue=function(){var r=this,a=r.hasError,n=r.thrownError,i=r._value;if(a)throw n;return this._throwIfClosed(),i},l.prototype.next=function(r){y.prototype.next.call(this,this._value=r)},l}(t.Subject);return fr.BehaviorSubject=m,fr}var _r={},nl={},ch;function Ll(){return ch||(ch=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.dateTimestampProvider=void 0,E.dateTimestampProvider={now:function(){return(E.dateTimestampProvider.delegate||Date).now()},delegate:void 0}}(nl)),nl}var hh;function Ml(){if(hh)return _r;hh=1;var E=_r&&_r.__extends||function(){var l=function(r,a){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h])},l(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");l(r,a);function n(){this.constructor=r}r.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(_r,"__esModule",{value:!0}),_r.ReplaySubject=void 0;var t=Xe(),m=Ll(),y=function(l){E(r,l);function r(a,n,i){a===void 0&&(a=1/0),n===void 0&&(n=1/0),i===void 0&&(i=m.dateTimestampProvider);var h=l.call(this)||this;return h._bufferSize=a,h._windowTime=n,h._timestampProvider=i,h._buffer=[],h._infiniteTimeWindow=!0,h._infiniteTimeWindow=n===1/0,h._bufferSize=Math.max(1,a),h._windowTime=Math.max(1,n),h}return r.prototype.next=function(a){var n=this,i=n.isStopped,h=n._buffer,p=n._infiniteTimeWindow,d=n._timestampProvider,f=n._windowTime;i||(h.push(a),!p&&h.push(d.now()+f)),this._trimBuffer(),l.prototype.next.call(this,a)},r.prototype._subscribe=function(a){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(a),i=this,h=i._infiniteTimeWindow,p=i._buffer,d=p.slice(),f=0;f<d.length&&!a.closed;f+=h?1:2)a.next(d[f]);return this._checkFinalizedStatuses(a),n},r.prototype._trimBuffer=function(){var a=this,n=a._bufferSize,i=a._timestampProvider,h=a._buffer,p=a._infiniteTimeWindow,d=(p?1:2)*n;if(n<1/0&&d<h.length&&h.splice(0,h.length-d),!p){for(var f=i.now(),s=0,o=1;o<h.length&&h[o]<=f;o+=2)s=o;s&&h.splice(0,s+1)}},r}(t.Subject);return _r.ReplaySubject=y,_r}var pr={},dh;function Il(){if(dh)return pr;dh=1;var E=pr&&pr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(pr,"__esModule",{value:!0}),pr.AsyncSubject=void 0;var t=Xe(),m=function(y){E(l,y);function l(){var r=y!==null&&y.apply(this,arguments)||this;return r._value=null,r._hasValue=!1,r._isComplete=!1,r}return l.prototype._checkFinalizedStatuses=function(r){var a=this,n=a.hasError,i=a._hasValue,h=a._value,p=a.thrownError,d=a.isStopped,f=a._isComplete;n?r.error(p):(d||f)&&(i&&r.next(h),r.complete())},l.prototype.next=function(r){this.isStopped||(this._value=r,this._hasValue=!0)},l.prototype.complete=function(){var r=this,a=r._hasValue,n=r._value,i=r._isComplete;i||(this._isComplete=!0,a&&y.prototype.next.call(this,n),y.prototype.complete.call(this))},l}(t.Subject);return pr.AsyncSubject=m,pr}var al={},vr={},mr={},br={},fh;function Kv(){if(fh)return br;fh=1;var E=br&&br.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(br,"__esModule",{value:!0}),br.Action=void 0;var t=st(),m=function(y){E(l,y);function l(r,a){return y.call(this)||this}return l.prototype.schedule=function(r,a){return this},l}(t.Subscription);return br.Action=m,br}var gr={},_h;function Qv(){return _h||(_h=1,function(E){var t=gr&&gr.__read||function(y,l){var r=typeof Symbol=="function"&&y[Symbol.iterator];if(!r)return y;var a=r.call(y),n,i=[],h;try{for(;(l===void 0||l-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(p){h={error:p}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(h)throw h.error}}return i},m=gr&&gr.__spreadArray||function(y,l){for(var r=0,a=l.length,n=y.length;r<a;r++,n++)y[n]=l[r];return y};Object.defineProperty(E,"__esModule",{value:!0}),E.intervalProvider=void 0,E.intervalProvider={setInterval:function(y,l){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var n=E.intervalProvider.delegate;return n!=null&&n.setInterval?n.setInterval.apply(n,m([y,l],t(r))):setInterval.apply(void 0,m([y,l],t(r)))},clearInterval:function(y){var l=E.intervalProvider.delegate;return((l==null?void 0:l.clearInterval)||clearInterval)(y)},delegate:void 0}}(gr)),gr}var ph;function ws(){if(ph)return mr;ph=1;var E=mr&&mr.__extends||function(){var r=function(a,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,h){i.__proto__=h}||function(i,h){for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(i[p]=h[p])},r(a,n)};return function(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(a,n);function i(){this.constructor=a}a.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(mr,"__esModule",{value:!0}),mr.AsyncAction=void 0;var t=Kv(),m=Qv(),y=Jt(),l=function(r){E(a,r);function a(n,i){var h=r.call(this,n,i)||this;return h.scheduler=n,h.work=i,h.pending=!1,h}return a.prototype.schedule=function(n,i){var h;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var p=this.id,d=this.scheduler;return p!=null&&(this.id=this.recycleAsyncId(d,p,i)),this.pending=!0,this.delay=i,this.id=(h=this.id)!==null&&h!==void 0?h:this.requestAsyncId(d,this.id,i),this},a.prototype.requestAsyncId=function(n,i,h){return h===void 0&&(h=0),m.intervalProvider.setInterval(n.flush.bind(n,this),h)},a.prototype.recycleAsyncId=function(n,i,h){if(h===void 0&&(h=0),h!=null&&this.delay===h&&this.pending===!1)return i;i!=null&&m.intervalProvider.clearInterval(i)},a.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var h=this._execute(n,i);if(h)return h;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},a.prototype._execute=function(n,i){var h=!1,p;try{this.work(n)}catch(d){h=!0,p=d||new Error("Scheduled action threw falsy error")}if(h)return this.unsubscribe(),p},a.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,h=n.scheduler,p=h.actions;this.work=this.state=this.scheduler=null,this.pending=!1,y.arrRemove(p,this),i!=null&&(this.id=this.recycleAsyncId(h,i,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},a}(t.Action);return mr.AsyncAction=l,mr}var yr={},Er={},vh;function Jv(){if(vh)return Er;vh=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.TestTools=Er.Immediate=void 0;var E=1,t,m={};function y(l){return l in m?(delete m[l],!0):!1}return Er.Immediate={setImmediate:function(l){var r=E++;return m[r]=!0,t||(t=Promise.resolve()),t.then(function(){return y(r)&&l()}),r},clearImmediate:function(l){y(l)}},Er.TestTools={pending:function(){return Object.keys(m).length}},Er}var mh;function em(){return mh||(mh=1,function(E){var t=yr&&yr.__read||function(a,n){var i=typeof Symbol=="function"&&a[Symbol.iterator];if(!i)return a;var h=i.call(a),p,d=[],f;try{for(;(n===void 0||n-- >0)&&!(p=h.next()).done;)d.push(p.value)}catch(s){f={error:s}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(f)throw f.error}}return d},m=yr&&yr.__spreadArray||function(a,n){for(var i=0,h=n.length,p=a.length;i<h;i++,p++)a[p]=n[i];return a};Object.defineProperty(E,"__esModule",{value:!0}),E.immediateProvider=void 0;var y=Jv(),l=y.Immediate.setImmediate,r=y.Immediate.clearImmediate;E.immediateProvider={setImmediate:function(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];var i=E.immediateProvider.delegate;return((i==null?void 0:i.setImmediate)||l).apply(void 0,m([],t(a)))},clearImmediate:function(a){var n=E.immediateProvider.delegate;return((n==null?void 0:n.clearImmediate)||r)(a)},delegate:void 0}}(yr)),yr}var bh;function tm(){if(bh)return vr;bh=1;var E=vr&&vr.__extends||function(){var l=function(r,a){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h])},l(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");l(r,a);function n(){this.constructor=r}r.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(vr,"__esModule",{value:!0}),vr.AsapAction=void 0;var t=ws(),m=em(),y=function(l){E(r,l);function r(a,n){var i=l.call(this,a,n)||this;return i.scheduler=a,i.work=n,i}return r.prototype.requestAsyncId=function(a,n,i){return i===void 0&&(i=0),i!==null&&i>0?l.prototype.requestAsyncId.call(this,a,n,i):(a.actions.push(this),a._scheduled||(a._scheduled=m.immediateProvider.setImmediate(a.flush.bind(a,void 0))))},r.prototype.recycleAsyncId=function(a,n,i){var h;if(i===void 0&&(i=0),i!=null?i>0:this.delay>0)return l.prototype.recycleAsyncId.call(this,a,n,i);var p=a.actions;n!=null&&((h=p[p.length-1])===null||h===void 0?void 0:h.id)!==n&&(m.immediateProvider.clearImmediate(n),a._scheduled===n&&(a._scheduled=void 0))},r}(t.AsyncAction);return vr.AsapAction=y,vr}var Tr={},xr={},ki={},gh;function g_(){if(gh)return ki;gh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Scheduler=void 0;var E=Ll(),t=function(){function m(y,l){l===void 0&&(l=m.now),this.schedulerActionCtor=y,this.now=l}return m.prototype.schedule=function(y,l,r){return l===void 0&&(l=0),new this.schedulerActionCtor(this,y).schedule(r,l)},m.now=E.dateTimestampProvider.now,m}();return ki.Scheduler=t,ki}var yh;function Ps(){if(yh)return xr;yh=1;var E=xr&&xr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(xr,"__esModule",{value:!0}),xr.AsyncScheduler=void 0;var t=g_(),m=function(y){E(l,y);function l(r,a){a===void 0&&(a=t.Scheduler.now);var n=y.call(this,r,a)||this;return n.actions=[],n._active=!1,n}return l.prototype.flush=function(r){var a=this.actions;if(this._active){a.push(r);return}var n;this._active=!0;do if(n=r.execute(r.state,r.delay))break;while(r=a.shift());if(this._active=!1,n){for(;r=a.shift();)r.unsubscribe();throw n}},l}(t.Scheduler);return xr.AsyncScheduler=m,xr}var Eh;function rm(){if(Eh)return Tr;Eh=1;var E=Tr&&Tr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.AsapScheduler=void 0;var t=Ps(),m=function(y){E(l,y);function l(){return y!==null&&y.apply(this,arguments)||this}return l.prototype.flush=function(r){this._active=!0;var a=this._scheduled;this._scheduled=void 0;var n=this.actions,i;r=r||n.shift();do if(i=r.execute(r.state,r.delay))break;while((r=n[0])&&r.id===a&&n.shift());if(this._active=!1,i){for(;(r=n[0])&&r.id===a&&n.shift();)r.unsubscribe();throw i}},l}(t.AsyncScheduler);return Tr.AsapScheduler=m,Tr}var Th;function im(){return Th||(Th=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.asap=E.asapScheduler=void 0;var t=tm(),m=rm();E.asapScheduler=new m.AsapScheduler(t.AsapAction),E.asap=E.asapScheduler}(al)),al}var sl={},xh;function rt(){return xh||(xh=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.async=E.asyncScheduler=void 0;var t=ws(),m=Ps();E.asyncScheduler=new m.AsyncScheduler(t.AsyncAction),E.async=E.asyncScheduler}(sl)),sl}var ol={},Sr={},Sh;function nm(){if(Sh)return Sr;Sh=1;var E=Sr&&Sr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.QueueAction=void 0;var t=ws(),m=function(y){E(l,y);function l(r,a){var n=y.call(this,r,a)||this;return n.scheduler=r,n.work=a,n}return l.prototype.schedule=function(r,a){return a===void 0&&(a=0),a>0?y.prototype.schedule.call(this,r,a):(this.delay=a,this.state=r,this.scheduler.flush(this),this)},l.prototype.execute=function(r,a){return a>0||this.closed?y.prototype.execute.call(this,r,a):this._execute(r,a)},l.prototype.requestAsyncId=function(r,a,n){return n===void 0&&(n=0),n!=null&&n>0||n==null&&this.delay>0?y.prototype.requestAsyncId.call(this,r,a,n):(r.flush(this),0)},l}(t.AsyncAction);return Sr.QueueAction=m,Sr}var Ar={},Ah;function am(){if(Ah)return Ar;Ah=1;var E=Ar&&Ar.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.QueueScheduler=void 0;var t=Ps(),m=function(y){E(l,y);function l(){return y!==null&&y.apply(this,arguments)||this}return l}(t.AsyncScheduler);return Ar.QueueScheduler=m,Ar}var Oh;function sm(){return Oh||(Oh=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.queue=E.queueScheduler=void 0;var t=nm(),m=am();E.queueScheduler=new m.QueueScheduler(t.QueueAction),E.queue=E.queueScheduler}(ol)),ol}var ul={},Or={},wh;function om(){if(wh)return Or;wh=1;var E=Or&&Or.__extends||function(){var l=function(r,a){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h])},l(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");l(r,a);function n(){this.constructor=r}r.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(Or,"__esModule",{value:!0}),Or.AnimationFrameAction=void 0;var t=ws(),m=v_(),y=function(l){E(r,l);function r(a,n){var i=l.call(this,a,n)||this;return i.scheduler=a,i.work=n,i}return r.prototype.requestAsyncId=function(a,n,i){return i===void 0&&(i=0),i!==null&&i>0?l.prototype.requestAsyncId.call(this,a,n,i):(a.actions.push(this),a._scheduled||(a._scheduled=m.animationFrameProvider.requestAnimationFrame(function(){return a.flush(void 0)})))},r.prototype.recycleAsyncId=function(a,n,i){var h;if(i===void 0&&(i=0),i!=null?i>0:this.delay>0)return l.prototype.recycleAsyncId.call(this,a,n,i);var p=a.actions;n!=null&&n===a._scheduled&&((h=p[p.length-1])===null||h===void 0?void 0:h.id)!==n&&(m.animationFrameProvider.cancelAnimationFrame(n),a._scheduled=void 0)},r}(t.AsyncAction);return Or.AnimationFrameAction=y,Or}var wr={},Ph;function um(){if(Ph)return wr;Ph=1;var E=wr&&wr.__extends||function(){var y=function(l,r){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},y(l,r)};return function(l,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");y(l,r);function a(){this.constructor=l}l.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(wr,"__esModule",{value:!0}),wr.AnimationFrameScheduler=void 0;var t=Ps(),m=function(y){E(l,y);function l(){return y!==null&&y.apply(this,arguments)||this}return l.prototype.flush=function(r){this._active=!0;var a;r?a=r.id:(a=this._scheduled,this._scheduled=void 0);var n=this.actions,i;r=r||n.shift();do if(i=r.execute(r.state,r.delay))break;while((r=n[0])&&r.id===a&&n.shift());if(this._active=!1,i){for(;(r=n[0])&&r.id===a&&n.shift();)r.unsubscribe();throw i}},l}(t.AsyncScheduler);return wr.AnimationFrameScheduler=m,wr}var Rh;function lm(){return Rh||(Rh=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.animationFrame=E.animationFrameScheduler=void 0;var t=om(),m=um();E.animationFrameScheduler=new m.AnimationFrameScheduler(t.AnimationFrameAction),E.animationFrame=E.animationFrameScheduler}(ul)),ul}var Lt={},Lh;function cm(){if(Lh)return Lt;Lh=1;var E=Lt&&Lt.__extends||function(){var a=function(n,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)Object.prototype.hasOwnProperty.call(p,d)&&(h[d]=p[d])},a(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");a(n,i);function h(){this.constructor=n}n.prototype=i===null?Object.create(i):(h.prototype=i.prototype,new h)}}();Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.VirtualAction=Lt.VirtualTimeScheduler=void 0;var t=ws(),m=st(),y=Ps(),l=function(a){E(n,a);function n(i,h){i===void 0&&(i=r),h===void 0&&(h=1/0);var p=a.call(this,i,function(){return p.frame})||this;return p.maxFrames=h,p.frame=0,p.index=-1,p}return n.prototype.flush=function(){for(var i=this,h=i.actions,p=i.maxFrames,d,f;(f=h[0])&&f.delay<=p&&(h.shift(),this.frame=f.delay,!(d=f.execute(f.state,f.delay))););if(d){for(;f=h.shift();)f.unsubscribe();throw d}},n.frameTimeFactor=10,n}(y.AsyncScheduler);Lt.VirtualTimeScheduler=l;var r=function(a){E(n,a);function n(i,h,p){p===void 0&&(p=i.index+=1);var d=a.call(this,i,h)||this;return d.scheduler=i,d.work=h,d.index=p,d.active=!0,d.index=i.index=p,d}return n.prototype.schedule=function(i,h){if(h===void 0&&(h=0),Number.isFinite(h)){if(!this.id)return a.prototype.schedule.call(this,i,h);this.active=!1;var p=new n(this.scheduler,this.work);return this.add(p),p.schedule(i,h)}else return m.Subscription.EMPTY},n.prototype.requestAsyncId=function(i,h,p){p===void 0&&(p=0),this.delay=i.frame+p;var d=i.actions;return d.push(this),d.sort(n.sortActions),1},n.prototype.recycleAsyncId=function(i,h,p){},n.prototype._execute=function(i,h){if(this.active===!0)return a.prototype._execute.call(this,i,h)},n.sortActions=function(i,h){return i.delay===h.delay?i.index===h.index?0:i.index>h.index?1:-1:i.delay>h.delay?1:-1},n}(t.AsyncAction);return Lt.VirtualAction=r,Lt}var ll={},cl={},Mh;function Tt(){return Mh||(Mh=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.empty=E.EMPTY=void 0;var t=Te();E.EMPTY=new t.Observable(function(l){return l.complete()});function m(l){return l?y(l):E.EMPTY}E.empty=m;function y(l){return new t.Observable(function(r){return l.schedule(function(){return r.complete()})})}}(cl)),cl}var Gi={},Mt={},qi={},Ih;function vo(){if(Ih)return qi;Ih=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.isScheduler=void 0;var E=ye();function t(m){return m&&E.isFunction(m.schedule)}return qi.isScheduler=t,qi}var Fh;function it(){if(Fh)return Mt;Fh=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.popNumber=Mt.popScheduler=Mt.popResultSelector=void 0;var E=ye(),t=vo();function m(a){return a[a.length-1]}function y(a){return E.isFunction(m(a))?a.pop():void 0}Mt.popResultSelector=y;function l(a){return t.isScheduler(m(a))?a.pop():void 0}Mt.popScheduler=l;function r(a,n){return typeof m(a)=="number"?a.pop():n}return Mt.popNumber=r,Mt}var Wi={},Vi={},$i={},Ae={},Hi={},Ch;function Fl(){return Ch||(Ch=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.isArrayLike=void 0,Hi.isArrayLike=function(E){return E&&typeof E.length=="number"&&typeof E!="function"}),Hi}var Xi={},Nh;function y_(){if(Nh)return Xi;Nh=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.isPromise=void 0;var E=ye();function t(m){return E.isFunction(m==null?void 0:m.then)}return Xi.isPromise=t,Xi}var Yi={},zh;function E_(){if(zh)return Yi;zh=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.isInteropObservable=void 0;var E=fo(),t=ye();function m(y){return t.isFunction(y[E.observable])}return Yi.isInteropObservable=m,Yi}var Zi={},Bh;function T_(){if(Bh)return Zi;Bh=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.isAsyncIterable=void 0;var E=ye();function t(m){return Symbol.asyncIterator&&E.isFunction(m==null?void 0:m[Symbol.asyncIterator])}return Zi.isAsyncIterable=t,Zi}var Ki={},Dh;function x_(){if(Dh)return Ki;Dh=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.createInvalidObservableTypeError=void 0;function E(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}return Ki.createInvalidObservableTypeError=E,Ki}var Qi={},Pr={},jh;function S_(){if(jh)return Pr;jh=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.iterator=Pr.getSymbolIterator=void 0;function E(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}return Pr.getSymbolIterator=E,Pr.iterator=E(),Pr}var Uh;function A_(){if(Uh)return Qi;Uh=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.isIterable=void 0;var E=S_(),t=ye();function m(y){return t.isFunction(y==null?void 0:y[E.iterator])}return Qi.isIterable=m,Qi}var et={},kh;function Cl(){if(kh)return et;kh=1;var E=et&&et.__generator||function(a,n){var i={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,p,d,f;return f={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function s(u){return function(b){return o([u,b])}}function o(u){if(h)throw new TypeError("Generator is already executing.");for(;i;)try{if(h=1,p&&(d=u[0]&2?p.return:u[0]?p.throw||((d=p.return)&&d.call(p),0):p.next)&&!(d=d.call(p,u[1])).done)return d;switch(p=0,d&&(u=[u[0]&2,d.value]),u[0]){case 0:case 1:d=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,p=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(d=i.trys,!(d=d.length>0&&d[d.length-1])&&(u[0]===6||u[0]===2)){i=0;continue}if(u[0]===3&&(!d||u[1]>d[0]&&u[1]<d[3])){i.label=u[1];break}if(u[0]===6&&i.label<d[1]){i.label=d[1],d=u;break}if(d&&i.label<d[2]){i.label=d[2],i.ops.push(u);break}d[2]&&i.ops.pop(),i.trys.pop();continue}u=n.call(a,i)}catch(b){u=[6,b],p=0}finally{h=d=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},t=et&&et.__await||function(a){return this instanceof t?(this.v=a,this):new t(a)},m=et&&et.__asyncGenerator||function(a,n,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=i.apply(a,n||[]),p,d=[];return p={},f("next"),f("throw"),f("return"),p[Symbol.asyncIterator]=function(){return this},p;function f(_){h[_]&&(p[_]=function(g){return new Promise(function(x,T){d.push([_,g,x,T])>1||s(_,g)})})}function s(_,g){try{o(h[_](g))}catch(x){v(d[0][3],x)}}function o(_){_.value instanceof t?Promise.resolve(_.value.v).then(u,b):v(d[0][2],_)}function u(_){s("next",_)}function b(_){s("throw",_)}function v(_,g){_(g),d.shift(),d.length&&s(d[0][0],d[0][1])}};Object.defineProperty(et,"__esModule",{value:!0}),et.isReadableStreamLike=et.readableStreamLikeToAsyncGenerator=void 0;var y=ye();function l(a){return m(this,arguments,function(){var i,h,p,d;return E(this,function(f){switch(f.label){case 0:i=a.getReader(),f.label=1;case 1:f.trys.push([1,,9,10]),f.label=2;case 2:return[4,t(i.read())];case 3:return h=f.sent(),p=h.value,d=h.done,d?[4,t(void 0)]:[3,5];case 4:return[2,f.sent()];case 5:return[4,t(p)];case 6:return[4,f.sent()];case 7:return f.sent(),[3,2];case 8:return[3,10];case 9:return i.releaseLock(),[7];case 10:return[2]}})})}et.readableStreamLikeToAsyncGenerator=l;function r(a){return y.isFunction(a==null?void 0:a.getReader)}return et.isReadableStreamLike=r,et}var Gh;function fe(){if(Gh)return Ae;Gh=1;var E=Ae&&Ae.__awaiter||function(A,R,P,C){function U(j){return j instanceof P?j:new P(function(k){k(j)})}return new(P||(P=Promise))(function(j,k){function $(J){try{Z(C.next(J))}catch(te){k(te)}}function Y(J){try{Z(C.throw(J))}catch(te){k(te)}}function Z(J){J.done?j(J.value):U(J.value).then($,Y)}Z((C=C.apply(A,R||[])).next())})},t=Ae&&Ae.__generator||function(A,R){var P={label:0,sent:function(){if(j[0]&1)throw j[1];return j[1]},trys:[],ops:[]},C,U,j,k;return k={next:$(0),throw:$(1),return:$(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function $(Z){return function(J){return Y([Z,J])}}function Y(Z){if(C)throw new TypeError("Generator is already executing.");for(;P;)try{if(C=1,U&&(j=Z[0]&2?U.return:Z[0]?U.throw||((j=U.return)&&j.call(U),0):U.next)&&!(j=j.call(U,Z[1])).done)return j;switch(U=0,j&&(Z=[Z[0]&2,j.value]),Z[0]){case 0:case 1:j=Z;break;case 4:return P.label++,{value:Z[1],done:!1};case 5:P.label++,U=Z[1],Z=[0];continue;case 7:Z=P.ops.pop(),P.trys.pop();continue;default:if(j=P.trys,!(j=j.length>0&&j[j.length-1])&&(Z[0]===6||Z[0]===2)){P=0;continue}if(Z[0]===3&&(!j||Z[1]>j[0]&&Z[1]<j[3])){P.label=Z[1];break}if(Z[0]===6&&P.label<j[1]){P.label=j[1],j=Z;break}if(j&&P.label<j[2]){P.label=j[2],P.ops.push(Z);break}j[2]&&P.ops.pop(),P.trys.pop();continue}Z=R.call(A,P)}catch(J){Z=[6,J],U=0}finally{C=j=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}},m=Ae&&Ae.__asyncValues||function(A){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=A[Symbol.asyncIterator],P;return R?R.call(A):(A=typeof y=="function"?y(A):A[Symbol.iterator](),P={},C("next"),C("throw"),C("return"),P[Symbol.asyncIterator]=function(){return this},P);function C(j){P[j]=A[j]&&function(k){return new Promise(function($,Y){k=A[j](k),U($,Y,k.done,k.value)})}}function U(j,k,$,Y){Promise.resolve(Y).then(function(Z){j({value:Z,done:$})},k)}},y=Ae&&Ae.__values||function(A){var R=typeof Symbol=="function"&&Symbol.iterator,P=R&&A[R],C=0;if(P)return P.call(A);if(A&&typeof A.length=="number")return{next:function(){return A&&C>=A.length&&(A=void 0),{value:A&&A[C++],done:!A}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.fromReadableStreamLike=Ae.fromAsyncIterable=Ae.fromIterable=Ae.fromPromise=Ae.fromArrayLike=Ae.fromInteropObservable=Ae.innerFrom=void 0;var l=Fl(),r=y_(),a=Te(),n=E_(),i=T_(),h=x_(),p=A_(),d=Cl(),f=ye(),s=__(),o=fo();function u(A){if(A instanceof a.Observable)return A;if(A!=null){if(n.isInteropObservable(A))return b(A);if(l.isArrayLike(A))return v(A);if(r.isPromise(A))return _(A);if(i.isAsyncIterable(A))return x(A);if(p.isIterable(A))return g(A);if(d.isReadableStreamLike(A))return T(A)}throw h.createInvalidObservableTypeError(A)}Ae.innerFrom=u;function b(A){return new a.Observable(function(R){var P=A[o.observable]();if(f.isFunction(P.subscribe))return P.subscribe(R);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}Ae.fromInteropObservable=b;function v(A){return new a.Observable(function(R){for(var P=0;P<A.length&&!R.closed;P++)R.next(A[P]);R.complete()})}Ae.fromArrayLike=v;function _(A){return new a.Observable(function(R){A.then(function(P){R.closed||(R.next(P),R.complete())},function(P){return R.error(P)}).then(null,s.reportUnhandledError)})}Ae.fromPromise=_;function g(A){return new a.Observable(function(R){var P,C;try{for(var U=y(A),j=U.next();!j.done;j=U.next()){var k=j.value;if(R.next(k),R.closed)return}}catch($){P={error:$}}finally{try{j&&!j.done&&(C=U.return)&&C.call(U)}finally{if(P)throw P.error}}R.complete()})}Ae.fromIterable=g;function x(A){return new a.Observable(function(R){O(A,R).catch(function(P){return R.error(P)})})}Ae.fromAsyncIterable=x;function T(A){return x(d.readableStreamLikeToAsyncGenerator(A))}Ae.fromReadableStreamLike=T;function O(A,R){var P,C,U,j;return E(this,void 0,void 0,function(){var k,$;return t(this,function(Y){switch(Y.label){case 0:Y.trys.push([0,5,6,11]),P=m(A),Y.label=1;case 1:return[4,P.next()];case 2:if(C=Y.sent(),!!C.done)return[3,4];if(k=C.value,R.next(k),R.closed)return[2];Y.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return $=Y.sent(),U={error:$},[3,11];case 6:return Y.trys.push([6,,9,10]),C&&!C.done&&(j=P.return)?[4,j.call(P)]:[3,8];case 7:Y.sent(),Y.label=8;case 8:return[3,10];case 9:if(U)throw U.error;return[7];case 10:return[7];case 11:return R.complete(),[2]}})})}return Ae}var Ji={},en={},qh;function er(){if(qh)return en;qh=1,Object.defineProperty(en,"__esModule",{value:!0}),en.executeSchedule=void 0;function E(t,m,y,l,r){l===void 0&&(l=0),r===void 0&&(r=!1);var a=m.schedule(function(){y(),r?t.add(this.schedule(null,l)):this.unsubscribe()},l);if(t.add(a),!r)return a}return en.executeSchedule=E,en}var Wh;function mo(){if(Wh)return Ji;Wh=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.observeOn=void 0;var E=er(),t=ee(),m=re();function y(l,r){return r===void 0&&(r=0),t.operate(function(a,n){a.subscribe(m.createOperatorSubscriber(n,function(i){return E.executeSchedule(n,l,function(){return n.next(i)},r)},function(){return E.executeSchedule(n,l,function(){return n.complete()},r)},function(i){return E.executeSchedule(n,l,function(){return n.error(i)},r)}))})}return Ji.observeOn=y,Ji}var tn={},Vh;function bo(){if(Vh)return tn;Vh=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.subscribeOn=void 0;var E=ee();function t(m,y){return y===void 0&&(y=0),E.operate(function(l,r){r.add(m.schedule(function(){return l.subscribe(r)},y))})}return tn.subscribeOn=t,tn}var $h;function hm(){if($h)return $i;$h=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.scheduleObservable=void 0;var E=fe(),t=mo(),m=bo();function y(l,r){return E.innerFrom(l).pipe(m.subscribeOn(r),t.observeOn(r))}return $i.scheduleObservable=y,$i}var rn={},Hh;function dm(){if(Hh)return rn;Hh=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.schedulePromise=void 0;var E=fe(),t=mo(),m=bo();function y(l,r){return E.innerFrom(l).pipe(m.subscribeOn(r),t.observeOn(r))}return rn.schedulePromise=y,rn}var nn={},Xh;function fm(){if(Xh)return nn;Xh=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.scheduleArray=void 0;var E=Te();function t(m,y){return new E.Observable(function(l){var r=0;return y.schedule(function(){r===m.length?l.complete():(l.next(m[r++]),l.closed||this.schedule())})})}return nn.scheduleArray=t,nn}var an={},Yh;function O_(){if(Yh)return an;Yh=1,Object.defineProperty(an,"__esModule",{value:!0}),an.scheduleIterable=void 0;var E=Te(),t=S_(),m=ye(),y=er();function l(r,a){return new E.Observable(function(n){var i;return y.executeSchedule(n,a,function(){i=r[t.iterator](),y.executeSchedule(n,a,function(){var h,p,d;try{h=i.next(),p=h.value,d=h.done}catch(f){n.error(f);return}d?n.complete():n.next(p)},0,!0)}),function(){return m.isFunction(i==null?void 0:i.return)&&i.return()}})}return an.scheduleIterable=l,an}var sn={},Zh;function w_(){if(Zh)return sn;Zh=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.scheduleAsyncIterable=void 0;var E=Te(),t=er();function m(y,l){if(!y)throw new Error("Iterable cannot be null");return new E.Observable(function(r){t.executeSchedule(r,l,function(){var a=y[Symbol.asyncIterator]();t.executeSchedule(r,l,function(){a.next().then(function(n){n.done?r.complete():r.next(n.value)})},0,!0)})})}return sn.scheduleAsyncIterable=m,sn}var on={},Kh;function _m(){if(Kh)return on;Kh=1,Object.defineProperty(on,"__esModule",{value:!0}),on.scheduleReadableStreamLike=void 0;var E=w_(),t=Cl();function m(y,l){return E.scheduleAsyncIterable(t.readableStreamLikeToAsyncGenerator(y),l)}return on.scheduleReadableStreamLike=m,on}var Qh;function P_(){if(Qh)return Vi;Qh=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.scheduled=void 0;var E=hm(),t=dm(),m=fm(),y=O_(),l=w_(),r=E_(),a=y_(),n=Fl(),i=A_(),h=T_(),p=x_(),d=Cl(),f=_m();function s(o,u){if(o!=null){if(r.isInteropObservable(o))return E.scheduleObservable(o,u);if(n.isArrayLike(o))return m.scheduleArray(o,u);if(a.isPromise(o))return t.schedulePromise(o,u);if(h.isAsyncIterable(o))return l.scheduleAsyncIterable(o,u);if(i.isIterable(o))return y.scheduleIterable(o,u);if(d.isReadableStreamLike(o))return f.scheduleReadableStreamLike(o,u)}throw p.createInvalidObservableTypeError(o)}return Vi.scheduled=s,Vi}var Jh;function tr(){if(Jh)return Wi;Jh=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.from=void 0;var E=P_(),t=fe();function m(y,l){return l?E.scheduled(y,l):t.innerFrom(y)}return Wi.from=m,Wi}var ed;function Nl(){if(ed)return Gi;ed=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.of=void 0;var E=it(),t=tr();function m(){for(var y=[],l=0;l<arguments.length;l++)y[l]=arguments[l];var r=E.popScheduler(y);return t.from(y,r)}return Gi.of=m,Gi}var un={},td;function R_(){if(td)return un;td=1,Object.defineProperty(un,"__esModule",{value:!0}),un.throwError=void 0;var E=Te(),t=ye();function m(y,l){var r=t.isFunction(y)?y:function(){return y},a=function(n){return n.error(r())};return new E.Observable(l?function(n){return l.schedule(a,0,n)}:a)}return un.throwError=m,un}var rd;function zl(){return rd||(rd=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.observeNotification=E.Notification=E.NotificationKind=void 0;var t=Tt(),m=Nl(),y=R_(),l=ye();(function(n){n.NEXT="N",n.ERROR="E",n.COMPLETE="C"})(E.NotificationKind||(E.NotificationKind={}));var r=function(){function n(i,h,p){this.kind=i,this.value=h,this.error=p,this.hasValue=i==="N"}return n.prototype.observe=function(i){return a(this,i)},n.prototype.do=function(i,h,p){var d=this,f=d.kind,s=d.value,o=d.error;return f==="N"?i==null?void 0:i(s):f==="E"?h==null?void 0:h(o):p==null?void 0:p()},n.prototype.accept=function(i,h,p){var d;return l.isFunction((d=i)===null||d===void 0?void 0:d.next)?this.observe(i):this.do(i,h,p)},n.prototype.toObservable=function(){var i=this,h=i.kind,p=i.value,d=i.error,f=h==="N"?m.of(p):h==="E"?y.throwError(function(){return d}):h==="C"?t.EMPTY:0;if(!f)throw new TypeError("Unexpected notification kind "+h);return f},n.createNext=function(i){return new n("N",i)},n.createError=function(i){return new n("E",void 0,i)},n.createComplete=function(){return n.completeNotification},n.completeNotification=new n("C"),n}();E.Notification=r;function a(n,i){var h,p,d,f=n,s=f.kind,o=f.value,u=f.error;if(typeof s!="string")throw new TypeError('Invalid notification, missing "kind"');s==="N"?(h=i.next)===null||h===void 0||h.call(i,o):s==="E"?(p=i.error)===null||p===void 0||p.call(i,u):(d=i.complete)===null||d===void 0||d.call(i)}E.observeNotification=a}(ll)),ll}var ln={},id;function pm(){if(id)return ln;id=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.isObservable=void 0;var E=Te(),t=ye();function m(y){return!!y&&(y instanceof E.Observable||t.isFunction(y.lift)&&t.isFunction(y.subscribe))}return ln.isObservable=m,ln}var cn={},hn={},nd;function Xr(){if(nd)return hn;nd=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.EmptyError=void 0;var E=Hr();return hn.EmptyError=E.createErrorClass(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}}),hn}var ad;function vm(){if(ad)return cn;ad=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.lastValueFrom=void 0;var E=Xr();function t(m,y){var l=typeof y=="object";return new Promise(function(r,a){var n=!1,i;m.subscribe({next:function(h){i=h,n=!0},error:a,complete:function(){n?r(i):l?r(y.defaultValue):a(new E.EmptyError)}})})}return cn.lastValueFrom=t,cn}var dn={},sd;function mm(){if(sd)return dn;sd=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.firstValueFrom=void 0;var E=Xr(),t=Os();function m(y,l){var r=typeof l=="object";return new Promise(function(a,n){var i=new t.SafeSubscriber({next:function(h){a(h),i.unsubscribe()},error:n,complete:function(){r?a(l.defaultValue):n(new E.EmptyError)}});y.subscribe(i)})}return dn.firstValueFrom=m,dn}var fn={},od;function L_(){if(od)return fn;od=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.ArgumentOutOfRangeError=void 0;var E=Hr();return fn.ArgumentOutOfRangeError=E.createErrorClass(function(t){return function(){t(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}),fn}var _n={},ud;function M_(){if(ud)return _n;ud=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.NotFoundError=void 0;var E=Hr();return _n.NotFoundError=E.createErrorClass(function(t){return function(y){t(this),this.name="NotFoundError",this.message=y}}),_n}var pn={},ld;function I_(){if(ld)return pn;ld=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.SequenceError=void 0;var E=Hr();return pn.SequenceError=E.createErrorClass(function(t){return function(y){t(this),this.name="SequenceError",this.message=y}}),pn}var hl={},vn={},cd;function Bl(){if(cd)return vn;cd=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.isValidDate=void 0;function E(t){return t instanceof Date&&!isNaN(t)}return vn.isValidDate=E,vn}var hd;function yl(){return hd||(hd=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.timeout=E.TimeoutError=void 0;var t=rt(),m=Bl(),y=ee(),l=fe(),r=Hr(),a=re(),n=er();E.TimeoutError=r.createErrorClass(function(p){return function(f){f===void 0&&(f=null),p(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=f}});function i(p,d){var f=m.isValidDate(p)?{first:p}:typeof p=="number"?{each:p}:p,s=f.first,o=f.each,u=f.with,b=u===void 0?h:u,v=f.scheduler,_=v===void 0?d??t.asyncScheduler:v,g=f.meta,x=g===void 0?null:g;if(s==null&&o==null)throw new TypeError("No timeout provided.");return y.operate(function(T,O){var A,R,P=null,C=0,U=function(j){R=n.executeSchedule(O,_,function(){try{A.unsubscribe(),l.innerFrom(b({meta:x,lastValue:P,seen:C})).subscribe(O)}catch(k){O.error(k)}},j)};A=T.subscribe(a.createOperatorSubscriber(O,function(j){R==null||R.unsubscribe(),C++,O.next(P=j),o>0&&U(o)},void 0,void 0,function(){R!=null&&R.closed||R==null||R.unsubscribe(),P=null})),!C&&U(s!=null?typeof s=="number"?s:+s-_.now():o)})}E.timeout=i;function h(p){throw new E.TimeoutError(p)}}(hl)),hl}var mn={},It={},Ft={},bn={},dd;function Yr(){if(dd)return bn;dd=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.map=void 0;var E=ee(),t=re();function m(y,l){return E.operate(function(r,a){var n=0;r.subscribe(t.createOperatorSubscriber(a,function(i){a.next(y.call(l,i,n++))}))})}return bn.map=m,bn}var fd;function Zr(){if(fd)return Ft;fd=1;var E=Ft&&Ft.__read||function(a,n){var i=typeof Symbol=="function"&&a[Symbol.iterator];if(!i)return a;var h=i.call(a),p,d=[],f;try{for(;(n===void 0||n-- >0)&&!(p=h.next()).done;)d.push(p.value)}catch(s){f={error:s}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(f)throw f.error}}return d},t=Ft&&Ft.__spreadArray||function(a,n){for(var i=0,h=n.length,p=a.length;i<h;i++,p++)a[p]=n[i];return a};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.mapOneOrManyArgs=void 0;var m=Yr(),y=Array.isArray;function l(a,n){return y(n)?a.apply(void 0,t([],E(n))):a(n)}function r(a){return m.map(function(n){return l(a,n)})}return Ft.mapOneOrManyArgs=r,Ft}var _d;function F_(){if(_d)return It;_d=1;var E=It&&It.__read||function(h,p){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var f=d.call(h),s,o=[],u;try{for(;(p===void 0||p-- >0)&&!(s=f.next()).done;)o.push(s.value)}catch(b){u={error:b}}finally{try{s&&!s.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}return o},t=It&&It.__spreadArray||function(h,p){for(var d=0,f=p.length,s=h.length;d<f;d++,s++)h[s]=p[d];return h};Object.defineProperty(It,"__esModule",{value:!0}),It.bindCallbackInternals=void 0;var m=vo(),y=Te(),l=bo(),r=Zr(),a=mo(),n=Il();function i(h,p,d,f){if(d)if(m.isScheduler(d))f=d;else return function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return i(h,p,f).apply(this,s).pipe(r.mapOneOrManyArgs(d))};return f?function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return i(h,p).apply(this,s).pipe(l.subscribeOn(f),a.observeOn(f))}:function(){for(var s=this,o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var b=new n.AsyncSubject,v=!0;return new y.Observable(function(_){var g=b.subscribe(_);if(v){v=!1;var x=!1,T=!1;p.apply(s,t(t([],E(o)),[function(){for(var O=[],A=0;A<arguments.length;A++)O[A]=arguments[A];if(h){var R=O.shift();if(R!=null){b.error(R);return}}b.next(1<O.length?O:O[0]),T=!0,x&&b.complete()}])),T&&b.complete(),x=!0}return g})}}return It.bindCallbackInternals=i,It}var pd;function bm(){if(pd)return mn;pd=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.bindCallback=void 0;var E=F_();function t(m,y,l){return E.bindCallbackInternals(!1,m,y,l)}return mn.bindCallback=t,mn}var gn={},vd;function gm(){if(vd)return gn;vd=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.bindNodeCallback=void 0;var E=F_();function t(m,y,l){return E.bindCallbackInternals(!0,m,y,l)}return gn.bindNodeCallback=t,gn}var Rr={},yn={},md;function C_(){if(md)return yn;md=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.argsArgArrayOrObject=void 0;var E=Array.isArray,t=Object.getPrototypeOf,m=Object.prototype,y=Object.keys;function l(a){if(a.length===1){var n=a[0];if(E(n))return{args:n,keys:null};if(r(n)){var i=y(n);return{args:i.map(function(h){return n[h]}),keys:i}}}return{args:a,keys:null}}yn.argsArgArrayOrObject=l;function r(a){return a&&typeof a=="object"&&t(a)===m}return yn}var En={},bd;function N_(){if(bd)return En;bd=1,Object.defineProperty(En,"__esModule",{value:!0}),En.createObject=void 0;function E(t,m){return t.reduce(function(y,l,r){return y[l]=m[r],y},{})}return En.createObject=E,En}var gd;function Dl(){if(gd)return Rr;gd=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.combineLatestInit=Rr.combineLatest=void 0;var E=Te(),t=C_(),m=tr(),y=He(),l=Zr(),r=it(),a=N_(),n=re(),i=er();function h(){for(var f=[],s=0;s<arguments.length;s++)f[s]=arguments[s];var o=r.popScheduler(f),u=r.popResultSelector(f),b=t.argsArgArrayOrObject(f),v=b.args,_=b.keys;if(v.length===0)return m.from([],o);var g=new E.Observable(p(v,o,_?function(x){return a.createObject(_,x)}:y.identity));return u?g.pipe(l.mapOneOrManyArgs(u)):g}Rr.combineLatest=h;function p(f,s,o){return o===void 0&&(o=y.identity),function(u){d(s,function(){for(var b=f.length,v=new Array(b),_=b,g=b,x=function(O){d(s,function(){var A=m.from(f[O],s),R=!1;A.subscribe(n.createOperatorSubscriber(u,function(P){v[O]=P,R||(R=!0,g--),g||u.next(o(v.slice()))},function(){--_||u.complete()}))},u)},T=0;T<b;T++)x(T)},u)}}Rr.combineLatestInit=p;function d(f,s,o){f?i.executeSchedule(o,f,s):s()}return Rr}var Tn={},xn={},Sn={},An={},On={},yd;function jl(){if(yd)return On;yd=1,Object.defineProperty(On,"__esModule",{value:!0}),On.mergeInternals=void 0;var E=fe(),t=er(),m=re();function y(l,r,a,n,i,h,p,d){var f=[],s=0,o=0,u=!1,b=function(){u&&!f.length&&!s&&r.complete()},v=function(g){return s<n?_(g):f.push(g)},_=function(g){h&&r.next(g),s++;var x=!1;E.innerFrom(a(g,o++)).subscribe(m.createOperatorSubscriber(r,function(T){i==null||i(T),h?v(T):r.next(T)},function(){x=!0},void 0,function(){if(x)try{s--;for(var T=function(){var O=f.shift();p?t.executeSchedule(r,p,function(){return _(O)}):_(O)};f.length&&s<n;)T();b()}catch(O){r.error(O)}}))};return l.subscribe(m.createOperatorSubscriber(r,v,function(){u=!0,b()})),function(){d==null||d()}}return On.mergeInternals=y,On}var Ed;function rr(){if(Ed)return An;Ed=1,Object.defineProperty(An,"__esModule",{value:!0}),An.mergeMap=void 0;var E=Yr(),t=fe(),m=ee(),y=jl(),l=ye();function r(a,n,i){return i===void 0&&(i=1/0),l.isFunction(n)?r(function(h,p){return E.map(function(d,f){return n(h,d,p,f)})(t.innerFrom(a(h,p)))},i):(typeof n=="number"&&(i=n),m.operate(function(h,p){return y.mergeInternals(h,p,a,i)}))}return An.mergeMap=r,An}var Td;function go(){if(Td)return Sn;Td=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.mergeAll=void 0;var E=rr(),t=He();function m(y){return y===void 0&&(y=1/0),E.mergeMap(t.identity,y)}return Sn.mergeAll=m,Sn}var xd;function Ul(){if(xd)return xn;xd=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.concatAll=void 0;var E=go();function t(){return E.mergeAll(1)}return xn.concatAll=t,xn}var Sd;function yo(){if(Sd)return Tn;Sd=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.concat=void 0;var E=Ul(),t=it(),m=tr();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return E.concatAll()(m.from(l,t.popScheduler(l)))}return Tn.concat=y,Tn}var wn={},Pn={},Ad;function Eo(){if(Ad)return Pn;Ad=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.defer=void 0;var E=Te(),t=fe();function m(y){return new E.Observable(function(l){t.innerFrom(y()).subscribe(l)})}return Pn.defer=m,Pn}var Od;function ym(){if(Od)return wn;Od=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.connectable=void 0;var E=Xe(),t=Te(),m=Eo(),y={connector:function(){return new E.Subject},resetOnDisconnect:!0};function l(r,a){a===void 0&&(a=y);var n=null,i=a.connector,h=a.resetOnDisconnect,p=h===void 0?!0:h,d=i(),f=new t.Observable(function(s){return d.subscribe(s)});return f.connect=function(){return(!n||n.closed)&&(n=m.defer(function(){return r}).subscribe(d),p&&n.add(function(){return d=i()})),n},f}return wn.connectable=l,wn}var Rn={},wd;function Em(){if(wd)return Rn;wd=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.forkJoin=void 0;var E=Te(),t=C_(),m=fe(),y=it(),l=re(),r=Zr(),a=N_();function n(){for(var i=[],h=0;h<arguments.length;h++)i[h]=arguments[h];var p=y.popResultSelector(i),d=t.argsArgArrayOrObject(i),f=d.args,s=d.keys,o=new E.Observable(function(u){var b=f.length;if(!b){u.complete();return}for(var v=new Array(b),_=b,g=b,x=function(O){var A=!1;m.innerFrom(f[O]).subscribe(l.createOperatorSubscriber(u,function(R){A||(A=!0,g--),v[O]=R},function(){return _--},void 0,function(){(!_||!A)&&(g||u.next(s?a.createObject(s,v):v),u.complete())}))},T=0;T<b;T++)x(T)});return p?o.pipe(r.mapOneOrManyArgs(p)):o}return Rn.forkJoin=n,Rn}var Lr={},Pd;function Tm(){if(Pd)return Lr;Pd=1;var E=Lr&&Lr.__read||function(u,b){var v=typeof Symbol=="function"&&u[Symbol.iterator];if(!v)return u;var _=v.call(u),g,x=[],T;try{for(;(b===void 0||b-- >0)&&!(g=_.next()).done;)x.push(g.value)}catch(O){T={error:O}}finally{try{g&&!g.done&&(v=_.return)&&v.call(_)}finally{if(T)throw T.error}}return x};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.fromEvent=void 0;var t=fe(),m=Te(),y=rr(),l=Fl(),r=ye(),a=Zr(),n=["addListener","removeListener"],i=["addEventListener","removeEventListener"],h=["on","off"];function p(u,b,v,_){if(r.isFunction(v)&&(_=v,v=void 0),_)return p(u,b,v).pipe(a.mapOneOrManyArgs(_));var g=E(o(u)?i.map(function(O){return function(A){return u[O](b,A,v)}}):f(u)?n.map(d(u,b)):s(u)?h.map(d(u,b)):[],2),x=g[0],T=g[1];if(!x&&l.isArrayLike(u))return y.mergeMap(function(O){return p(O,b,v)})(t.innerFrom(u));if(!x)throw new TypeError("Invalid event target");return new m.Observable(function(O){var A=function(){for(var R=[],P=0;P<arguments.length;P++)R[P]=arguments[P];return O.next(1<R.length?R:R[0])};return x(A),function(){return T(A)}})}Lr.fromEvent=p;function d(u,b){return function(v){return function(_){return u[v](b,_)}}}function f(u){return r.isFunction(u.addListener)&&r.isFunction(u.removeListener)}function s(u){return r.isFunction(u.on)&&r.isFunction(u.off)}function o(u){return r.isFunction(u.addEventListener)&&r.isFunction(u.removeEventListener)}return Lr}var Ln={},Rd;function xm(){if(Rd)return Ln;Rd=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.fromEventPattern=void 0;var E=Te(),t=ye(),m=Zr();function y(l,r,a){return a?y(l,r).pipe(m.mapOneOrManyArgs(a)):new E.Observable(function(n){var i=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];return n.next(p.length===1?p[0]:p)},h=l(i);return t.isFunction(r)?function(){return r(i,h)}:void 0})}return Ln.fromEventPattern=y,Ln}var Mr={},Ld;function Sm(){if(Ld)return Mr;Ld=1;var E=Mr&&Mr.__generator||function(a,n){var i={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,p,d,f;return f={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function s(u){return function(b){return o([u,b])}}function o(u){if(h)throw new TypeError("Generator is already executing.");for(;i;)try{if(h=1,p&&(d=u[0]&2?p.return:u[0]?p.throw||((d=p.return)&&d.call(p),0):p.next)&&!(d=d.call(p,u[1])).done)return d;switch(p=0,d&&(u=[u[0]&2,d.value]),u[0]){case 0:case 1:d=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,p=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(d=i.trys,!(d=d.length>0&&d[d.length-1])&&(u[0]===6||u[0]===2)){i=0;continue}if(u[0]===3&&(!d||u[1]>d[0]&&u[1]<d[3])){i.label=u[1];break}if(u[0]===6&&i.label<d[1]){i.label=d[1],d=u;break}if(d&&i.label<d[2]){i.label=d[2],i.ops.push(u);break}d[2]&&i.ops.pop(),i.trys.pop();continue}u=n.call(a,i)}catch(b){u=[6,b],p=0}finally{h=d=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.generate=void 0;var t=He(),m=vo(),y=Eo(),l=O_();function r(a,n,i,h,p){var d,f,s,o;arguments.length===1?(d=a,o=d.initialState,n=d.condition,i=d.iterate,f=d.resultSelector,s=f===void 0?t.identity:f,p=d.scheduler):(o=a,!h||m.isScheduler(h)?(s=t.identity,p=h):s=h);function u(){var b;return E(this,function(v){switch(v.label){case 0:b=o,v.label=1;case 1:return!n||n(b)?[4,s(b)]:[3,4];case 2:v.sent(),v.label=3;case 3:return b=i(b),[3,1];case 4:return[2]}})}return y.defer(p?function(){return l.scheduleIterable(u(),p)}:u)}return Mr.generate=r,Mr}var Mn={},Md;function Am(){if(Md)return Mn;Md=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.iif=void 0;var E=Eo();function t(m,y,l){return E.defer(function(){return m()?y:l})}return Mn.iif=t,Mn}var In={},Fn={},Id;function Kr(){if(Id)return Fn;Id=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.timer=void 0;var E=Te(),t=rt(),m=vo(),y=Bl();function l(r,a,n){r===void 0&&(r=0),n===void 0&&(n=t.async);var i=-1;return a!=null&&(m.isScheduler(a)?n=a:i=a),new E.Observable(function(h){var p=y.isValidDate(r)?+r-n.now():r;p<0&&(p=0);var d=0;return n.schedule(function(){h.closed||(h.next(d++),0<=i?this.schedule(void 0,i):h.complete())},p)})}return Fn.timer=l,Fn}var Fd;function z_(){if(Fd)return In;Fd=1,Object.defineProperty(In,"__esModule",{value:!0}),In.interval=void 0;var E=rt(),t=Kr();function m(y,l){return y===void 0&&(y=0),l===void 0&&(l=E.asyncScheduler),y<0&&(y=0),t.timer(y,y,l)}return In.interval=m,In}var Cn={},Cd;function Om(){if(Cd)return Cn;Cd=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.merge=void 0;var E=go(),t=fe(),m=Tt(),y=it(),l=tr();function r(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];var i=y.popScheduler(a),h=y.popNumber(a,1/0),p=a;return p.length?p.length===1?t.innerFrom(p[0]):E.mergeAll(h)(l.from(p,i)):m.EMPTY}return Cn.merge=r,Cn}var dl={},Nd;function zd(){return Nd||(Nd=1,function(E){Object.defineProperty(E,"__esModule",{value:!0}),E.never=E.NEVER=void 0;var t=Te(),m=$e();E.NEVER=new t.Observable(m.noop);function y(){return E.NEVER}E.never=y}(dl)),dl}var Nn={},zn={},Bd;function Rs(){if(Bd)return zn;Bd=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.argsOrArgArray=void 0;var E=Array.isArray;function t(m){return m.length===1&&E(m[0])?m[0]:m}return zn.argsOrArgArray=t,zn}var Dd;function B_(){if(Dd)return Nn;Dd=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.onErrorResumeNext=void 0;var E=Te(),t=Rs(),m=re(),y=$e(),l=fe();function r(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];var i=t.argsOrArgArray(a);return new E.Observable(function(h){var p=0,d=function(){if(p<i.length){var f=void 0;try{f=l.innerFrom(i[p++])}catch{d();return}var s=new m.OperatorSubscriber(h,void 0,y.noop,y.noop);f.subscribe(s),s.add(d)}else h.complete()};d()})}return Nn.onErrorResumeNext=r,Nn}var Bn={},jd;function wm(){if(jd)return Bn;jd=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.pairs=void 0;var E=tr();function t(m,y){return E.from(Object.entries(m),y)}return Bn.pairs=t,Bn}var Dn={},jn={},Ud;function Pm(){if(Ud)return jn;Ud=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.not=void 0;function E(t,m){return function(y,l){return!t.call(m,y,l)}}return jn.not=E,jn}var Un={},kd;function si(){if(kd)return Un;kd=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.filter=void 0;var E=ee(),t=re();function m(y,l){return E.operate(function(r,a){var n=0;r.subscribe(t.createOperatorSubscriber(a,function(i){return y.call(l,i,n++)&&a.next(i)}))})}return Un.filter=m,Un}var Gd;function Rm(){if(Gd)return Dn;Gd=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.partition=void 0;var E=Pm(),t=si(),m=fe();function y(l,r,a){return[t.filter(r,a)(m.innerFrom(l)),t.filter(E.not(r,a))(m.innerFrom(l))]}return Dn.partition=y,Dn}var Ir={},qd;function D_(){if(qd)return Ir;qd=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.raceInit=Ir.race=void 0;var E=Te(),t=fe(),m=Rs(),y=re();function l(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];return a=m.argsOrArgArray(a),a.length===1?t.innerFrom(a[0]):new E.Observable(r(a))}Ir.race=l;function r(a){return function(n){for(var i=[],h=function(d){i.push(t.innerFrom(a[d]).subscribe(y.createOperatorSubscriber(n,function(f){if(i){for(var s=0;s<i.length;s++)s!==d&&i[s].unsubscribe();i=null}n.next(f)})))},p=0;i&&!n.closed&&p<a.length;p++)h(p)}}return Ir.raceInit=r,Ir}var kn={},Wd;function Lm(){if(Wd)return kn;Wd=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.range=void 0;var E=Te(),t=Tt();function m(y,l,r){if(l==null&&(l=y,y=0),l<=0)return t.EMPTY;var a=l+y;return new E.Observable(r?function(n){var i=y;return r.schedule(function(){i<a?(n.next(i++),this.schedule()):n.complete()})}:function(n){for(var i=y;i<a&&!n.closed;)n.next(i++);n.complete()})}return kn.range=m,kn}var Gn={},Vd;function Mm(){if(Vd)return Gn;Vd=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.using=void 0;var E=Te(),t=fe(),m=Tt();function y(l,r){return new E.Observable(function(a){var n=l(),i=r(n),h=i?t.innerFrom(i):m.EMPTY;return h.subscribe(a),function(){n&&n.unsubscribe()}})}return Gn.using=y,Gn}var Ct={},$d;function kl(){if($d)return Ct;$d=1;var E=Ct&&Ct.__read||function(h,p){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var f=d.call(h),s,o=[],u;try{for(;(p===void 0||p-- >0)&&!(s=f.next()).done;)o.push(s.value)}catch(b){u={error:b}}finally{try{s&&!s.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}return o},t=Ct&&Ct.__spreadArray||function(h,p){for(var d=0,f=p.length,s=h.length;d<f;d++,s++)h[s]=p[d];return h};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.zip=void 0;var m=Te(),y=fe(),l=Rs(),r=Tt(),a=re(),n=it();function i(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var d=n.popResultSelector(h),f=l.argsOrArgArray(h);return f.length?new m.Observable(function(s){var o=f.map(function(){return[]}),u=f.map(function(){return!1});s.add(function(){o=u=null});for(var b=function(_){y.innerFrom(f[_]).subscribe(a.createOperatorSubscriber(s,function(g){if(o[_].push(g),o.every(function(T){return T.length})){var x=o.map(function(T){return T.shift()});s.next(d?d.apply(void 0,t([],E(x))):x),o.some(function(T,O){return!T.length&&u[O]})&&s.complete()}},function(){u[_]=!0,!o[_].length&&s.complete()}))},v=0;!s.closed&&v<f.length;v++)b(v);return function(){o=u=null}}):r.EMPTY}return Ct.zip=i,Ct}var fl={},Hd;function Im(){return Hd||(Hd=1,Object.defineProperty(fl,"__esModule",{value:!0})),fl}var qn={},Xd;function j_(){if(Xd)return qn;Xd=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.audit=void 0;var E=ee(),t=fe(),m=re();function y(l){return E.operate(function(r,a){var n=!1,i=null,h=null,p=!1,d=function(){if(h==null||h.unsubscribe(),h=null,n){n=!1;var s=i;i=null,a.next(s)}p&&a.complete()},f=function(){h=null,p&&a.complete()};r.subscribe(m.createOperatorSubscriber(a,function(s){n=!0,i=s,h||t.innerFrom(l(s)).subscribe(h=m.createOperatorSubscriber(a,d,f))},function(){p=!0,(!n||!h||h.closed)&&a.complete()}))})}return qn.audit=y,qn}var Wn={},Yd;function Fm(){if(Yd)return Wn;Yd=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.auditTime=void 0;var E=rt(),t=j_(),m=Kr();function y(l,r){return r===void 0&&(r=E.asyncScheduler),t.audit(function(){return m.timer(l,r)})}return Wn.auditTime=y,Wn}var Vn={},Zd;function Cm(){if(Zd)return Vn;Zd=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.buffer=void 0;var E=ee(),t=$e(),m=re(),y=fe();function l(r){return E.operate(function(a,n){var i=[];return a.subscribe(m.createOperatorSubscriber(n,function(h){return i.push(h)},function(){n.next(i),n.complete()})),y.innerFrom(r).subscribe(m.createOperatorSubscriber(n,function(){var h=i;i=[],n.next(h)},t.noop)),function(){i=null}})}return Vn.buffer=l,Vn}var Fr={},Kd;function Nm(){if(Kd)return Fr;Kd=1;var E=Fr&&Fr.__values||function(r){var a=typeof Symbol=="function"&&Symbol.iterator,n=a&&r[a],i=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.bufferCount=void 0;var t=ee(),m=re(),y=Jt();function l(r,a){return a===void 0&&(a=null),a=a??r,t.operate(function(n,i){var h=[],p=0;n.subscribe(m.createOperatorSubscriber(i,function(d){var f,s,o,u,b=null;p++%a===0&&h.push([]);try{for(var v=E(h),_=v.next();!_.done;_=v.next()){var g=_.value;g.push(d),r<=g.length&&(b=b??[],b.push(g))}}catch(O){f={error:O}}finally{try{_&&!_.done&&(s=v.return)&&s.call(v)}finally{if(f)throw f.error}}if(b)try{for(var x=E(b),T=x.next();!T.done;T=x.next()){var g=T.value;y.arrRemove(h,g),i.next(g)}}catch(O){o={error:O}}finally{try{T&&!T.done&&(u=x.return)&&u.call(x)}finally{if(o)throw o.error}}},function(){var d,f;try{for(var s=E(h),o=s.next();!o.done;o=s.next()){var u=o.value;i.next(u)}}catch(b){d={error:b}}finally{try{o&&!o.done&&(f=s.return)&&f.call(s)}finally{if(d)throw d.error}}i.complete()},void 0,function(){h=null}))})}return Fr.bufferCount=l,Fr}var Cr={},Qd;function zm(){if(Qd)return Cr;Qd=1;var E=Cr&&Cr.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,d=p&&h[p],f=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&f>=h.length&&(h=void 0),{value:h&&h[f++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.bufferTime=void 0;var t=st(),m=ee(),y=re(),l=Jt(),r=rt(),a=it(),n=er();function i(h){for(var p,d,f=[],s=1;s<arguments.length;s++)f[s-1]=arguments[s];var o=(p=a.popScheduler(f))!==null&&p!==void 0?p:r.asyncScheduler,u=(d=f[0])!==null&&d!==void 0?d:null,b=f[1]||1/0;return m.operate(function(v,_){var g=[],x=!1,T=function(R){var P=R.buffer,C=R.subs;C.unsubscribe(),l.arrRemove(g,R),_.next(P),x&&O()},O=function(){if(g){var R=new t.Subscription;_.add(R);var P=[],C={buffer:P,subs:R};g.push(C),n.executeSchedule(R,o,function(){return T(C)},h)}};u!==null&&u>=0?n.executeSchedule(_,o,O,u,!0):x=!0,O();var A=y.createOperatorSubscriber(_,function(R){var P,C,U=g.slice();try{for(var j=E(U),k=j.next();!k.done;k=j.next()){var $=k.value,Y=$.buffer;Y.push(R),b<=Y.length&&T($)}}catch(Z){P={error:Z}}finally{try{k&&!k.done&&(C=j.return)&&C.call(j)}finally{if(P)throw P.error}}},function(){for(;g!=null&&g.length;)_.next(g.shift().buffer);A==null||A.unsubscribe(),_.complete(),_.unsubscribe()},void 0,function(){return g=null});v.subscribe(A)})}return Cr.bufferTime=i,Cr}var Nr={},Jd;function Bm(){if(Jd)return Nr;Jd=1;var E=Nr&&Nr.__values||function(i){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&i[h],d=0;if(p)return p.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&d>=i.length&&(i=void 0),{value:i&&i[d++],done:!i}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.bufferToggle=void 0;var t=st(),m=ee(),y=fe(),l=re(),r=$e(),a=Jt();function n(i,h){return m.operate(function(p,d){var f=[];y.innerFrom(i).subscribe(l.createOperatorSubscriber(d,function(s){var o=[];f.push(o);var u=new t.Subscription,b=function(){a.arrRemove(f,o),d.next(o),u.unsubscribe()};u.add(y.innerFrom(h(s)).subscribe(l.createOperatorSubscriber(d,b,r.noop)))},r.noop)),p.subscribe(l.createOperatorSubscriber(d,function(s){var o,u;try{for(var b=E(f),v=b.next();!v.done;v=b.next()){var _=v.value;_.push(s)}}catch(g){o={error:g}}finally{try{v&&!v.done&&(u=b.return)&&u.call(b)}finally{if(o)throw o.error}}},function(){for(;f.length>0;)d.next(f.shift());d.complete()}))})}return Nr.bufferToggle=n,Nr}var $n={},ef;function Dm(){if(ef)return $n;ef=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.bufferWhen=void 0;var E=ee(),t=$e(),m=re(),y=fe();function l(r){return E.operate(function(a,n){var i=null,h=null,p=function(){h==null||h.unsubscribe();var d=i;i=[],d&&n.next(d),y.innerFrom(r()).subscribe(h=m.createOperatorSubscriber(n,p,t.noop))};p(),a.subscribe(m.createOperatorSubscriber(n,function(d){return i==null?void 0:i.push(d)},function(){i&&n.next(i),n.complete()},void 0,function(){return i=h=null}))})}return $n.bufferWhen=l,$n}var Hn={},tf;function jm(){if(tf)return Hn;tf=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.catchError=void 0;var E=fe(),t=re(),m=ee();function y(l){return m.operate(function(r,a){var n=null,i=!1,h;n=r.subscribe(t.createOperatorSubscriber(a,void 0,void 0,function(p){h=E.innerFrom(l(p,y(l)(r))),n?(n.unsubscribe(),n=null,h.subscribe(a)):i=!0})),i&&(n.unsubscribe(),n=null,h.subscribe(a))})}return Hn.catchError=y,Hn}var Xn={},Yn={},Zn={},Kn={},Qn={},Jn={},rf;function U_(){if(rf)return Jn;rf=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.scanInternals=void 0;var E=re();function t(m,y,l,r,a){return function(n,i){var h=l,p=y,d=0;n.subscribe(E.createOperatorSubscriber(i,function(f){var s=d++;p=h?m(p,f,s):(h=!0,f),r&&i.next(p)},a&&function(){h&&i.next(p),i.complete()}))}}return Jn.scanInternals=t,Jn}var nf;function Ls(){if(nf)return Qn;nf=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.reduce=void 0;var E=U_(),t=ee();function m(y,l){return t.operate(E.scanInternals(y,l,arguments.length>=2,!1,!0))}return Qn.reduce=m,Qn}var af;function k_(){if(af)return Kn;af=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.toArray=void 0;var E=Ls(),t=ee(),m=function(l,r){return l.push(r),l};function y(){return t.operate(function(l,r){E.reduce(m,[])(l).subscribe(r)})}return Kn.toArray=y,Kn}var sf;function G_(){if(sf)return Zn;sf=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.joinAllInternals=void 0;var E=He(),t=Zr(),m=_o(),y=rr(),l=k_();function r(a,n){return m.pipe(l.toArray(),y.mergeMap(function(i){return a(i)}),n?t.mapOneOrManyArgs(n):E.identity)}return Zn.joinAllInternals=r,Zn}var of;function q_(){if(of)return Yn;of=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.combineLatestAll=void 0;var E=Dl(),t=G_();function m(y){return t.joinAllInternals(E.combineLatest,y)}return Yn.combineLatestAll=m,Yn}var uf;function Um(){if(uf)return Xn;uf=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.combineAll=void 0;var E=q_();return Xn.combineAll=E.combineLatestAll,Xn}var Nt={},zt={},lf;function km(){if(lf)return zt;lf=1;var E=zt&&zt.__read||function(h,p){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var f=d.call(h),s,o=[],u;try{for(;(p===void 0||p-- >0)&&!(s=f.next()).done;)o.push(s.value)}catch(b){u={error:b}}finally{try{s&&!s.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}return o},t=zt&&zt.__spreadArray||function(h,p){for(var d=0,f=p.length,s=h.length;d<f;d++,s++)h[s]=p[d];return h};Object.defineProperty(zt,"__esModule",{value:!0}),zt.combineLatest=void 0;var m=Dl(),y=ee(),l=Rs(),r=Zr(),a=_o(),n=it();function i(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var d=n.popResultSelector(h);return d?a.pipe(i.apply(void 0,t([],E(h))),r.mapOneOrManyArgs(d)):y.operate(function(f,s){m.combineLatestInit(t([f],E(l.argsOrArgArray(h))))(s)})}return zt.combineLatest=i,zt}var cf;function Gm(){if(cf)return Nt;cf=1;var E=Nt&&Nt.__read||function(l,r){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var n=a.call(l),i,h=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)h.push(i.value)}catch(d){p={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(p)throw p.error}}return h},t=Nt&&Nt.__spreadArray||function(l,r){for(var a=0,n=r.length,i=l.length;a<n;a++,i++)l[i]=r[a];return l};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.combineLatestWith=void 0;var m=km();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return m.combineLatest.apply(void 0,t([],E(l)))}return Nt.combineLatestWith=y,Nt}var ea={},hf;function W_(){if(hf)return ea;hf=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.concatMap=void 0;var E=rr(),t=ye();function m(y,l){return t.isFunction(l)?E.mergeMap(y,l,1):E.mergeMap(y,1)}return ea.concatMap=m,ea}var ta={},df;function qm(){if(df)return ta;df=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.concatMapTo=void 0;var E=W_(),t=ye();function m(y,l){return t.isFunction(l)?E.concatMap(function(){return y},l):E.concatMap(function(){return y})}return ta.concatMapTo=m,ta}var Bt={},Dt={},ff;function Wm(){if(ff)return Dt;ff=1;var E=Dt&&Dt.__read||function(n,i){var h=typeof Symbol=="function"&&n[Symbol.iterator];if(!h)return n;var p=h.call(n),d,f=[],s;try{for(;(i===void 0||i-- >0)&&!(d=p.next()).done;)f.push(d.value)}catch(o){s={error:o}}finally{try{d&&!d.done&&(h=p.return)&&h.call(p)}finally{if(s)throw s.error}}return f},t=Dt&&Dt.__spreadArray||function(n,i){for(var h=0,p=i.length,d=n.length;h<p;h++,d++)n[d]=i[h];return n};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.concat=void 0;var m=ee(),y=Ul(),l=it(),r=tr();function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var h=l.popScheduler(n);return m.operate(function(p,d){y.concatAll()(r.from(t([p],E(n)),h)).subscribe(d)})}return Dt.concat=a,Dt}var _f;function Vm(){if(_f)return Bt;_f=1;var E=Bt&&Bt.__read||function(l,r){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var n=a.call(l),i,h=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)h.push(i.value)}catch(d){p={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(p)throw p.error}}return h},t=Bt&&Bt.__spreadArray||function(l,r){for(var a=0,n=r.length,i=l.length;a<n;a++,i++)l[i]=r[a];return l};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.concatWith=void 0;var m=Wm();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return m.concat.apply(void 0,t([],E(l)))}return Bt.concatWith=y,Bt}var ra={},ia={},pf;function $m(){if(pf)return ia;pf=1,Object.defineProperty(ia,"__esModule",{value:!0}),ia.fromSubscribable=void 0;var E=Te();function t(m){return new E.Observable(function(y){return m.subscribe(y)})}return ia.fromSubscribable=t,ia}var vf;function Gl(){if(vf)return ra;vf=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.connect=void 0;var E=Xe(),t=fe(),m=ee(),y=$m(),l={connector:function(){return new E.Subject}};function r(a,n){n===void 0&&(n=l);var i=n.connector;return m.operate(function(h,p){var d=i();t.innerFrom(a(y.fromSubscribable(d))).subscribe(p),p.add(h.subscribe(d))})}return ra.connect=r,ra}var na={},mf;function Hm(){if(mf)return na;mf=1,Object.defineProperty(na,"__esModule",{value:!0}),na.count=void 0;var E=Ls();function t(m){return E.reduce(function(y,l,r){return!m||m(l,r)?y+1:y},0)}return na.count=t,na}var aa={},bf;function Xm(){if(bf)return aa;bf=1,Object.defineProperty(aa,"__esModule",{value:!0}),aa.debounce=void 0;var E=ee(),t=$e(),m=re(),y=fe();function l(r){return E.operate(function(a,n){var i=!1,h=null,p=null,d=function(){if(p==null||p.unsubscribe(),p=null,i){i=!1;var f=h;h=null,n.next(f)}};a.subscribe(m.createOperatorSubscriber(n,function(f){p==null||p.unsubscribe(),i=!0,h=f,p=m.createOperatorSubscriber(n,d,t.noop),y.innerFrom(r(f)).subscribe(p)},function(){d(),n.complete()},void 0,function(){h=p=null}))})}return aa.debounce=l,aa}var sa={},gf;function Ym(){if(gf)return sa;gf=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.debounceTime=void 0;var E=rt(),t=ee(),m=re();function y(l,r){return r===void 0&&(r=E.asyncScheduler),t.operate(function(a,n){var i=null,h=null,p=null,d=function(){if(i){i.unsubscribe(),i=null;var s=h;h=null,n.next(s)}};function f(){var s=p+l,o=r.now();if(o<s){i=this.schedule(void 0,s-o),n.add(i);return}d()}a.subscribe(m.createOperatorSubscriber(n,function(s){h=s,p=r.now(),i||(i=r.schedule(f,l),n.add(i))},function(){d(),n.complete()},void 0,function(){h=i=null}))})}return sa.debounceTime=y,sa}var oa={},yf;function To(){if(yf)return oa;yf=1,Object.defineProperty(oa,"__esModule",{value:!0}),oa.defaultIfEmpty=void 0;var E=ee(),t=re();function m(y){return E.operate(function(l,r){var a=!1;l.subscribe(t.createOperatorSubscriber(r,function(n){a=!0,r.next(n)},function(){a||r.next(y),r.complete()}))})}return oa.defaultIfEmpty=m,oa}var ua={},la={},ca={},Ef;function xo(){if(Ef)return ca;Ef=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.take=void 0;var E=Tt(),t=ee(),m=re();function y(l){return l<=0?function(){return E.EMPTY}:t.operate(function(r,a){var n=0;r.subscribe(m.createOperatorSubscriber(a,function(i){++n<=l&&(a.next(i),l<=n&&a.complete())}))})}return ca.take=y,ca}var ha={},Tf;function V_(){if(Tf)return ha;Tf=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.ignoreElements=void 0;var E=ee(),t=re(),m=$e();function y(){return E.operate(function(l,r){l.subscribe(t.createOperatorSubscriber(r,m.noop))})}return ha.ignoreElements=y,ha}var da={},xf;function $_(){if(xf)return da;xf=1,Object.defineProperty(da,"__esModule",{value:!0}),da.mapTo=void 0;var E=Yr();function t(m){return E.map(function(){return m})}return da.mapTo=t,da}var Sf;function H_(){if(Sf)return la;Sf=1,Object.defineProperty(la,"__esModule",{value:!0}),la.delayWhen=void 0;var E=yo(),t=xo(),m=V_(),y=$_(),l=rr(),r=fe();function a(n,i){return i?function(h){return E.concat(i.pipe(t.take(1),m.ignoreElements()),h.pipe(a(n)))}:l.mergeMap(function(h,p){return r.innerFrom(n(h,p)).pipe(t.take(1),y.mapTo(h))})}return la.delayWhen=a,la}var Af;function Zm(){if(Af)return ua;Af=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.delay=void 0;var E=rt(),t=H_(),m=Kr();function y(l,r){r===void 0&&(r=E.asyncScheduler);var a=m.timer(l,r);return t.delayWhen(function(){return a})}return ua.delay=y,ua}var fa={},Of;function Km(){if(Of)return fa;Of=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.dematerialize=void 0;var E=zl(),t=ee(),m=re();function y(){return t.operate(function(l,r){l.subscribe(m.createOperatorSubscriber(r,function(a){return E.observeNotification(a,r)}))})}return fa.dematerialize=y,fa}var _a={},wf;function Qm(){if(wf)return _a;wf=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.distinct=void 0;var E=ee(),t=re(),m=$e(),y=fe();function l(r,a){return E.operate(function(n,i){var h=new Set;n.subscribe(t.createOperatorSubscriber(i,function(p){var d=r?r(p):p;h.has(d)||(h.add(d),i.next(p))})),a&&y.innerFrom(a).subscribe(t.createOperatorSubscriber(i,function(){return h.clear()},m.noop))})}return _a.distinct=l,_a}var pa={},Pf;function X_(){if(Pf)return pa;Pf=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.distinctUntilChanged=void 0;var E=He(),t=ee(),m=re();function y(r,a){return a===void 0&&(a=E.identity),r=r??l,t.operate(function(n,i){var h,p=!0;n.subscribe(m.createOperatorSubscriber(i,function(d){var f=a(d);(p||!r(h,f))&&(p=!1,h=f,i.next(d))}))})}pa.distinctUntilChanged=y;function l(r,a){return r===a}return pa}var va={},Rf;function Jm(){if(Rf)return va;Rf=1,Object.defineProperty(va,"__esModule",{value:!0}),va.distinctUntilKeyChanged=void 0;var E=X_();function t(m,y){return E.distinctUntilChanged(function(l,r){return y?y(l[m],r[m]):l[m]===r[m]})}return va.distinctUntilKeyChanged=t,va}var ma={},ba={},Lf;function So(){if(Lf)return ba;Lf=1,Object.defineProperty(ba,"__esModule",{value:!0}),ba.throwIfEmpty=void 0;var E=Xr(),t=ee(),m=re();function y(r){return r===void 0&&(r=l),t.operate(function(a,n){var i=!1;a.subscribe(m.createOperatorSubscriber(n,function(h){i=!0,n.next(h)},function(){return i?n.complete():n.error(r())}))})}ba.throwIfEmpty=y;function l(){return new E.EmptyError}return ba}var Mf;function e2(){if(Mf)return ma;Mf=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.elementAt=void 0;var E=L_(),t=si(),m=So(),y=To(),l=xo();function r(a,n){if(a<0)throw new E.ArgumentOutOfRangeError;var i=arguments.length>=2;return function(h){return h.pipe(t.filter(function(p,d){return d===a}),l.take(1),i?y.defaultIfEmpty(n):m.throwIfEmpty(function(){return new E.ArgumentOutOfRangeError}))}}return ma.elementAt=r,ma}var jt={},If;function t2(){if(If)return jt;If=1;var E=jt&&jt.__read||function(r,a){var n=typeof Symbol=="function"&&r[Symbol.iterator];if(!n)return r;var i=n.call(r),h,p=[],d;try{for(;(a===void 0||a-- >0)&&!(h=i.next()).done;)p.push(h.value)}catch(f){d={error:f}}finally{try{h&&!h.done&&(n=i.return)&&n.call(i)}finally{if(d)throw d.error}}return p},t=jt&&jt.__spreadArray||function(r,a){for(var n=0,i=a.length,h=r.length;n<i;n++,h++)r[h]=a[n];return r};Object.defineProperty(jt,"__esModule",{value:!0}),jt.endWith=void 0;var m=yo(),y=Nl();function l(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return function(n){return m.concat(n,y.of.apply(void 0,t([],E(r))))}}return jt.endWith=l,jt}var ga={},Ff;function r2(){if(Ff)return ga;Ff=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.every=void 0;var E=ee(),t=re();function m(y,l){return E.operate(function(r,a){var n=0;r.subscribe(t.createOperatorSubscriber(a,function(i){y.call(l,i,n++,r)||(a.next(!1),a.complete())},function(){a.next(!0),a.complete()}))})}return ga.every=m,ga}var ya={},Ea={},Ta={},Cf;function Y_(){if(Cf)return Ta;Cf=1,Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.exhaustMap=void 0;var E=Yr(),t=fe(),m=ee(),y=re();function l(r,a){return a?function(n){return n.pipe(l(function(i,h){return t.innerFrom(r(i,h)).pipe(E.map(function(p,d){return a(i,p,h,d)}))}))}:m.operate(function(n,i){var h=0,p=null,d=!1;n.subscribe(y.createOperatorSubscriber(i,function(f){p||(p=y.createOperatorSubscriber(i,void 0,function(){p=null,d&&i.complete()}),t.innerFrom(r(f,h++)).subscribe(p))},function(){d=!0,!p&&i.complete()}))})}return Ta.exhaustMap=l,Ta}var Nf;function Z_(){if(Nf)return Ea;Nf=1,Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.exhaustAll=void 0;var E=Y_(),t=He();function m(){return E.exhaustMap(t.identity)}return Ea.exhaustAll=m,Ea}var zf;function i2(){if(zf)return ya;zf=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.exhaust=void 0;var E=Z_();return ya.exhaust=E.exhaustAll,ya}var xa={},Bf;function n2(){if(Bf)return xa;Bf=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.expand=void 0;var E=ee(),t=jl();function m(y,l,r){return l===void 0&&(l=1/0),l=(l||0)<1?1/0:l,E.operate(function(a,n){return t.mergeInternals(a,n,y,l,void 0,!0,r)})}return xa.expand=m,xa}var Sa={},Df;function a2(){if(Df)return Sa;Df=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.finalize=void 0;var E=ee();function t(m){return E.operate(function(y,l){try{y.subscribe(l)}finally{l.add(m)}})}return Sa.finalize=t,Sa}var zr={},jf;function K_(){if(jf)return zr;jf=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.createFind=zr.find=void 0;var E=ee(),t=re();function m(l,r){return E.operate(y(l,r,"value"))}zr.find=m;function y(l,r,a){var n=a==="index";return function(i,h){var p=0;i.subscribe(t.createOperatorSubscriber(h,function(d){var f=p++;l.call(r,d,f,i)&&(h.next(n?f:d),h.complete())},function(){h.next(n?-1:void 0),h.complete()}))}}return zr.createFind=y,zr}var Aa={},Uf;function s2(){if(Uf)return Aa;Uf=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.findIndex=void 0;var E=ee(),t=K_();function m(y,l){return E.operate(t.createFind(y,l,"index"))}return Aa.findIndex=m,Aa}var Oa={},kf;function o2(){if(kf)return Oa;kf=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.first=void 0;var E=Xr(),t=si(),m=xo(),y=To(),l=So(),r=He();function a(n,i){var h=arguments.length>=2;return function(p){return p.pipe(n?t.filter(function(d,f){return n(d,f,p)}):r.identity,m.take(1),h?y.defaultIfEmpty(i):l.throwIfEmpty(function(){return new E.EmptyError}))}}return Oa.first=a,Oa}var wa={},Gf;function u2(){if(Gf)return wa;Gf=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.groupBy=void 0;var E=Te(),t=fe(),m=Xe(),y=ee(),l=re();function r(a,n,i,h){return y.operate(function(p,d){var f;!n||typeof n=="function"?f=n:(i=n.duration,f=n.element,h=n.connector);var s=new Map,o=function(x){s.forEach(x),x(d)},u=function(x){return o(function(T){return T.error(x)})},b=0,v=!1,_=new l.OperatorSubscriber(d,function(x){try{var T=a(x),O=s.get(T);if(!O){s.set(T,O=h?h():new m.Subject);var A=g(T,O);if(d.next(A),i){var R=l.createOperatorSubscriber(O,function(){O.complete(),R==null||R.unsubscribe()},void 0,void 0,function(){return s.delete(T)});_.add(t.innerFrom(i(A)).subscribe(R))}}O.next(f?f(x):x)}catch(P){u(P)}},function(){return o(function(x){return x.complete()})},u,function(){return s.clear()},function(){return v=!0,b===0});p.subscribe(_);function g(x,T){var O=new E.Observable(function(A){b++;var R=T.subscribe(A);return function(){R.unsubscribe(),--b===0&&v&&_.unsubscribe()}});return O.key=x,O}})}return wa.groupBy=r,wa}var Pa={},qf;function l2(){if(qf)return Pa;qf=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.isEmpty=void 0;var E=ee(),t=re();function m(){return E.operate(function(y,l){y.subscribe(t.createOperatorSubscriber(l,function(){l.next(!1),l.complete()},function(){l.next(!0),l.complete()}))})}return Pa.isEmpty=m,Pa}var Ra={},Br={},Wf;function Q_(){if(Wf)return Br;Wf=1;var E=Br&&Br.__values||function(r){var a=typeof Symbol=="function"&&Symbol.iterator,n=a&&r[a],i=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Br,"__esModule",{value:!0}),Br.takeLast=void 0;var t=Tt(),m=ee(),y=re();function l(r){return r<=0?function(){return t.EMPTY}:m.operate(function(a,n){var i=[];a.subscribe(y.createOperatorSubscriber(n,function(h){i.push(h),r<i.length&&i.shift()},function(){var h,p;try{for(var d=E(i),f=d.next();!f.done;f=d.next()){var s=f.value;n.next(s)}}catch(o){h={error:o}}finally{try{f&&!f.done&&(p=d.return)&&p.call(d)}finally{if(h)throw h.error}}n.complete()},void 0,function(){i=null}))})}return Br.takeLast=l,Br}var Vf;function c2(){if(Vf)return Ra;Vf=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.last=void 0;var E=Xr(),t=si(),m=Q_(),y=So(),l=To(),r=He();function a(n,i){var h=arguments.length>=2;return function(p){return p.pipe(n?t.filter(function(d,f){return n(d,f,p)}):r.identity,m.takeLast(1),h?l.defaultIfEmpty(i):y.throwIfEmpty(function(){return new E.EmptyError}))}}return Ra.last=a,Ra}var La={},$f;function h2(){if($f)return La;$f=1,Object.defineProperty(La,"__esModule",{value:!0}),La.materialize=void 0;var E=zl(),t=ee(),m=re();function y(){return t.operate(function(l,r){l.subscribe(m.createOperatorSubscriber(r,function(a){r.next(E.Notification.createNext(a))},function(){r.next(E.Notification.createComplete()),r.complete()},function(a){r.next(E.Notification.createError(a)),r.complete()}))})}return La.materialize=y,La}var Ma={},Hf;function d2(){if(Hf)return Ma;Hf=1,Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.max=void 0;var E=Ls(),t=ye();function m(y){return E.reduce(t.isFunction(y)?function(l,r){return y(l,r)>0?l:r}:function(l,r){return l>r?l:r})}return Ma.max=m,Ma}var Ia={},Xf;function f2(){if(Xf)return Ia;Xf=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.flatMap=void 0;var E=rr();return Ia.flatMap=E.mergeMap,Ia}var Fa={},Yf;function _2(){if(Yf)return Fa;Yf=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.mergeMapTo=void 0;var E=rr(),t=ye();function m(y,l,r){return r===void 0&&(r=1/0),t.isFunction(l)?E.mergeMap(function(){return y},l,r):(typeof l=="number"&&(r=l),E.mergeMap(function(){return y},r))}return Fa.mergeMapTo=m,Fa}var Ca={},Zf;function p2(){if(Zf)return Ca;Zf=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.mergeScan=void 0;var E=ee(),t=jl();function m(y,l,r){return r===void 0&&(r=1/0),E.operate(function(a,n){var i=l;return t.mergeInternals(a,n,function(h,p){return y(i,h,p)},r,function(h){i=h},!1,void 0,function(){return i=null})})}return Ca.mergeScan=m,Ca}var Ut={},kt={},Kf;function v2(){if(Kf)return kt;Kf=1;var E=kt&&kt.__read||function(n,i){var h=typeof Symbol=="function"&&n[Symbol.iterator];if(!h)return n;var p=h.call(n),d,f=[],s;try{for(;(i===void 0||i-- >0)&&!(d=p.next()).done;)f.push(d.value)}catch(o){s={error:o}}finally{try{d&&!d.done&&(h=p.return)&&h.call(p)}finally{if(s)throw s.error}}return f},t=kt&&kt.__spreadArray||function(n,i){for(var h=0,p=i.length,d=n.length;h<p;h++,d++)n[d]=i[h];return n};Object.defineProperty(kt,"__esModule",{value:!0}),kt.merge=void 0;var m=ee(),y=go(),l=it(),r=tr();function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var h=l.popScheduler(n),p=l.popNumber(n,1/0);return m.operate(function(d,f){y.mergeAll(p)(r.from(t([d],E(n)),h)).subscribe(f)})}return kt.merge=a,kt}var Qf;function m2(){if(Qf)return Ut;Qf=1;var E=Ut&&Ut.__read||function(l,r){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var n=a.call(l),i,h=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)h.push(i.value)}catch(d){p={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(p)throw p.error}}return h},t=Ut&&Ut.__spreadArray||function(l,r){for(var a=0,n=r.length,i=l.length;a<n;a++,i++)l[i]=r[a];return l};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.mergeWith=void 0;var m=v2();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return m.merge.apply(void 0,t([],E(l)))}return Ut.mergeWith=y,Ut}var Na={},Jf;function b2(){if(Jf)return Na;Jf=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.min=void 0;var E=Ls(),t=ye();function m(y){return E.reduce(t.isFunction(y)?function(l,r){return y(l,r)<0?l:r}:function(l,r){return l<r?l:r})}return Na.min=m,Na}var za={},e0;function ql(){if(e0)return za;e0=1,Object.defineProperty(za,"__esModule",{value:!0}),za.multicast=void 0;var E=po(),t=ye(),m=Gl();function y(l,r){var a=t.isFunction(l)?l:function(){return l};return t.isFunction(r)?m.connect(r,{connector:a}):function(n){return new E.ConnectableObservable(n,a)}}return za.multicast=y,za}var vt={},t0;function g2(){if(t0)return vt;t0=1;var E=vt&&vt.__read||function(r,a){var n=typeof Symbol=="function"&&r[Symbol.iterator];if(!n)return r;var i=n.call(r),h,p=[],d;try{for(;(a===void 0||a-- >0)&&!(h=i.next()).done;)p.push(h.value)}catch(f){d={error:f}}finally{try{h&&!h.done&&(n=i.return)&&n.call(i)}finally{if(d)throw d.error}}return p},t=vt&&vt.__spreadArray||function(r,a){for(var n=0,i=a.length,h=r.length;n<i;n++,h++)r[h]=a[n];return r};Object.defineProperty(vt,"__esModule",{value:!0}),vt.onErrorResumeNext=vt.onErrorResumeNextWith=void 0;var m=Rs(),y=B_();function l(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var n=m.argsOrArgArray(r);return function(i){return y.onErrorResumeNext.apply(void 0,t([i],E(n)))}}return vt.onErrorResumeNextWith=l,vt.onErrorResumeNext=l,vt}var Ba={},r0;function y2(){if(r0)return Ba;r0=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.pairwise=void 0;var E=ee(),t=re();function m(){return E.operate(function(y,l){var r,a=!1;y.subscribe(t.createOperatorSubscriber(l,function(n){var i=r;r=n,a&&l.next([i,n]),a=!0}))})}return Ba.pairwise=m,Ba}var Da={},i0;function E2(){if(i0)return Da;i0=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.pluck=void 0;var E=Yr();function t(){for(var m=[],y=0;y<arguments.length;y++)m[y]=arguments[y];var l=m.length;if(l===0)throw new Error("list of properties cannot be empty.");return E.map(function(r){for(var a=r,n=0;n<l;n++){var i=a==null?void 0:a[m[n]];if(typeof i<"u")a=i;else return}return a})}return Da.pluck=t,Da}var ja={},n0;function T2(){if(n0)return ja;n0=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.publish=void 0;var E=Xe(),t=ql(),m=Gl();function y(l){return l?function(r){return m.connect(l)(r)}:function(r){return t.multicast(new E.Subject)(r)}}return ja.publish=y,ja}var Ua={},a0;function x2(){if(a0)return Ua;a0=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.publishBehavior=void 0;var E=b_(),t=po();function m(y){return function(l){var r=new E.BehaviorSubject(y);return new t.ConnectableObservable(l,function(){return r})}}return Ua.publishBehavior=m,Ua}var ka={},s0;function S2(){if(s0)return ka;s0=1,Object.defineProperty(ka,"__esModule",{value:!0}),ka.publishLast=void 0;var E=Il(),t=po();function m(){return function(y){var l=new E.AsyncSubject;return new t.ConnectableObservable(y,function(){return l})}}return ka.publishLast=m,ka}var Ga={},o0;function A2(){if(o0)return Ga;o0=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.publishReplay=void 0;var E=Ml(),t=ql(),m=ye();function y(l,r,a,n){a&&!m.isFunction(a)&&(n=a);var i=m.isFunction(a)?a:void 0;return function(h){return t.multicast(new E.ReplaySubject(l,r,n),i)(h)}}return Ga.publishReplay=y,Ga}var Gt={},u0;function O2(){if(u0)return Gt;u0=1;var E=Gt&&Gt.__read||function(a,n){var i=typeof Symbol=="function"&&a[Symbol.iterator];if(!i)return a;var h=i.call(a),p,d=[],f;try{for(;(n===void 0||n-- >0)&&!(p=h.next()).done;)d.push(p.value)}catch(s){f={error:s}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(f)throw f.error}}return d},t=Gt&&Gt.__spreadArray||function(a,n){for(var i=0,h=n.length,p=a.length;i<h;i++,p++)a[p]=n[i];return a};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.raceWith=void 0;var m=D_(),y=ee(),l=He();function r(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];return a.length?y.operate(function(i,h){m.raceInit(t([i],E(a)))(h)}):l.identity}return Gt.raceWith=r,Gt}var qa={},l0;function w2(){if(l0)return qa;l0=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.repeat=void 0;var E=Tt(),t=ee(),m=re(),y=fe(),l=Kr();function r(a){var n,i=1/0,h;return a!=null&&(typeof a=="object"?(n=a.count,i=n===void 0?1/0:n,h=a.delay):i=a),i<=0?function(){return E.EMPTY}:t.operate(function(p,d){var f=0,s,o=function(){if(s==null||s.unsubscribe(),s=null,h!=null){var b=typeof h=="number"?l.timer(h):y.innerFrom(h(f)),v=m.createOperatorSubscriber(d,function(){v.unsubscribe(),u()});b.subscribe(v)}else u()},u=function(){var b=!1;s=p.subscribe(m.createOperatorSubscriber(d,void 0,function(){++f<i?s?o():b=!0:d.complete()})),b&&o()};u()})}return qa.repeat=r,qa}var Wa={},c0;function P2(){if(c0)return Wa;c0=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.repeatWhen=void 0;var E=fe(),t=Xe(),m=ee(),y=re();function l(r){return m.operate(function(a,n){var i,h=!1,p,d=!1,f=!1,s=function(){return f&&d&&(n.complete(),!0)},o=function(){return p||(p=new t.Subject,E.innerFrom(r(p)).subscribe(y.createOperatorSubscriber(n,function(){i?u():h=!0},function(){d=!0,s()}))),p},u=function(){f=!1,i=a.subscribe(y.createOperatorSubscriber(n,void 0,function(){f=!0,!s()&&o().next()})),h&&(i.unsubscribe(),i=null,h=!1,u())};u()})}return Wa.repeatWhen=l,Wa}var Va={},h0;function R2(){if(h0)return Va;h0=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.retry=void 0;var E=ee(),t=re(),m=He(),y=Kr(),l=fe();function r(a){a===void 0&&(a=1/0);var n;a&&typeof a=="object"?n=a:n={count:a};var i=n.count,h=i===void 0?1/0:i,p=n.delay,d=n.resetOnSuccess,f=d===void 0?!1:d;return h<=0?m.identity:E.operate(function(s,o){var u=0,b,v=function(){var _=!1;b=s.subscribe(t.createOperatorSubscriber(o,function(g){f&&(u=0),o.next(g)},void 0,function(g){if(u++<h){var x=function(){b?(b.unsubscribe(),b=null,v()):_=!0};if(p!=null){var T=typeof p=="number"?y.timer(p):l.innerFrom(p(g,u)),O=t.createOperatorSubscriber(o,function(){O.unsubscribe(),x()},function(){o.complete()});T.subscribe(O)}else x()}else o.error(g)})),_&&(b.unsubscribe(),b=null,v())};v()})}return Va.retry=r,Va}var $a={},d0;function L2(){if(d0)return $a;d0=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.retryWhen=void 0;var E=fe(),t=Xe(),m=ee(),y=re();function l(r){return m.operate(function(a,n){var i,h=!1,p,d=function(){i=a.subscribe(y.createOperatorSubscriber(n,void 0,void 0,function(f){p||(p=new t.Subject,E.innerFrom(r(p)).subscribe(y.createOperatorSubscriber(n,function(){return i?d():h=!0}))),p&&p.next(f)})),h&&(i.unsubscribe(),i=null,h=!1,d())};d()})}return $a.retryWhen=l,$a}var Ha={},f0;function J_(){if(f0)return Ha;f0=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.sample=void 0;var E=fe(),t=ee(),m=$e(),y=re();function l(r){return t.operate(function(a,n){var i=!1,h=null;a.subscribe(y.createOperatorSubscriber(n,function(p){i=!0,h=p})),E.innerFrom(r).subscribe(y.createOperatorSubscriber(n,function(){if(i){i=!1;var p=h;h=null,n.next(p)}},m.noop))})}return Ha.sample=l,Ha}var Xa={},_0;function M2(){if(_0)return Xa;_0=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.sampleTime=void 0;var E=rt(),t=J_(),m=z_();function y(l,r){return r===void 0&&(r=E.asyncScheduler),t.sample(m.interval(l,r))}return Xa.sampleTime=y,Xa}var Ya={},p0;function I2(){if(p0)return Ya;p0=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.scan=void 0;var E=ee(),t=U_();function m(y,l){return E.operate(t.scanInternals(y,l,arguments.length>=2,!0))}return Ya.scan=m,Ya}var Za={},v0;function F2(){if(v0)return Za;v0=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.sequenceEqual=void 0;var E=ee(),t=re(),m=fe();function y(r,a){return a===void 0&&(a=function(n,i){return n===i}),E.operate(function(n,i){var h=l(),p=l(),d=function(s){i.next(s),i.complete()},f=function(s,o){var u=t.createOperatorSubscriber(i,function(b){var v=o.buffer,_=o.complete;v.length===0?_?d(!1):s.buffer.push(b):!a(b,v.shift())&&d(!1)},function(){s.complete=!0;var b=o.complete,v=o.buffer;b&&d(v.length===0),u==null||u.unsubscribe()});return u};n.subscribe(f(h,p)),m.innerFrom(r).subscribe(f(p,h))})}Za.sequenceEqual=y;function l(){return{buffer:[],complete:!1}}return Za}var qt={},m0;function e1(){if(m0)return qt;m0=1;var E=qt&&qt.__read||function(i,h){var p=typeof Symbol=="function"&&i[Symbol.iterator];if(!p)return i;var d=p.call(i),f,s=[],o;try{for(;(h===void 0||h-- >0)&&!(f=d.next()).done;)s.push(f.value)}catch(u){o={error:u}}finally{try{f&&!f.done&&(p=d.return)&&p.call(d)}finally{if(o)throw o.error}}return s},t=qt&&qt.__spreadArray||function(i,h){for(var p=0,d=h.length,f=i.length;p<d;p++,f++)i[f]=h[p];return i};Object.defineProperty(qt,"__esModule",{value:!0}),qt.share=void 0;var m=fe(),y=Xe(),l=Os(),r=ee();function a(i){i===void 0&&(i={});var h=i.connector,p=h===void 0?function(){return new y.Subject}:h,d=i.resetOnError,f=d===void 0?!0:d,s=i.resetOnComplete,o=s===void 0?!0:s,u=i.resetOnRefCountZero,b=u===void 0?!0:u;return function(v){var _,g,x,T=0,O=!1,A=!1,R=function(){g==null||g.unsubscribe(),g=void 0},P=function(){R(),_=x=void 0,O=A=!1},C=function(){var U=_;P(),U==null||U.unsubscribe()};return r.operate(function(U,j){T++,!A&&!O&&R();var k=x=x??p();j.add(function(){T--,T===0&&!A&&!O&&(g=n(C,b))}),k.subscribe(j),!_&&T>0&&(_=new l.SafeSubscriber({next:function($){return k.next($)},error:function($){A=!0,R(),g=n(P,f,$),k.error($)},complete:function(){O=!0,R(),g=n(P,o),k.complete()}}),m.innerFrom(U).subscribe(_))})(v)}}qt.share=a;function n(i,h){for(var p=[],d=2;d<arguments.length;d++)p[d-2]=arguments[d];if(h===!0){i();return}if(h!==!1){var f=new l.SafeSubscriber({next:function(){f.unsubscribe(),i()}});return m.innerFrom(h.apply(void 0,t([],E(p)))).subscribe(f)}}return qt}var Ka={},b0;function C2(){if(b0)return Ka;b0=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.shareReplay=void 0;var E=Ml(),t=e1();function m(y,l,r){var a,n,i,h,p=!1;return y&&typeof y=="object"?(a=y.bufferSize,h=a===void 0?1/0:a,n=y.windowTime,l=n===void 0?1/0:n,i=y.refCount,p=i===void 0?!1:i,r=y.scheduler):h=y??1/0,t.share({connector:function(){return new E.ReplaySubject(h,l,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:p})}return Ka.shareReplay=m,Ka}var Qa={},g0;function N2(){if(g0)return Qa;g0=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.single=void 0;var E=Xr(),t=I_(),m=M_(),y=ee(),l=re();function r(a){return y.operate(function(n,i){var h=!1,p,d=!1,f=0;n.subscribe(l.createOperatorSubscriber(i,function(s){d=!0,(!a||a(s,f++,n))&&(h&&i.error(new t.SequenceError("Too many matching values")),h=!0,p=s)},function(){h?(i.next(p),i.complete()):i.error(d?new m.NotFoundError("No matching values"):new E.EmptyError)}))})}return Qa.single=r,Qa}var Ja={},y0;function z2(){if(y0)return Ja;y0=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.skip=void 0;var E=si();function t(m){return E.filter(function(y,l){return m<=l})}return Ja.skip=t,Ja}var es={},E0;function B2(){if(E0)return es;E0=1,Object.defineProperty(es,"__esModule",{value:!0}),es.skipLast=void 0;var E=He(),t=ee(),m=re();function y(l){return l<=0?E.identity:t.operate(function(r,a){var n=new Array(l),i=0;return r.subscribe(m.createOperatorSubscriber(a,function(h){var p=i++;if(p<l)n[p]=h;else{var d=p%l,f=n[d];n[d]=h,a.next(f)}})),function(){n=null}})}return es.skipLast=y,es}var ts={},T0;function D2(){if(T0)return ts;T0=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.skipUntil=void 0;var E=ee(),t=re(),m=fe(),y=$e();function l(r){return E.operate(function(a,n){var i=!1,h=t.createOperatorSubscriber(n,function(){h==null||h.unsubscribe(),i=!0},y.noop);m.innerFrom(r).subscribe(h),a.subscribe(t.createOperatorSubscriber(n,function(p){return i&&n.next(p)}))})}return ts.skipUntil=l,ts}var rs={},x0;function j2(){if(x0)return rs;x0=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.skipWhile=void 0;var E=ee(),t=re();function m(y){return E.operate(function(l,r){var a=!1,n=0;l.subscribe(t.createOperatorSubscriber(r,function(i){return(a||(a=!y(i,n++)))&&r.next(i)}))})}return rs.skipWhile=m,rs}var is={},S0;function U2(){if(S0)return is;S0=1,Object.defineProperty(is,"__esModule",{value:!0}),is.startWith=void 0;var E=yo(),t=it(),m=ee();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];var a=t.popScheduler(l);return m.operate(function(n,i){(a?E.concat(l,n,a):E.concat(l,n)).subscribe(i)})}return is.startWith=y,is}var ns={},as={},A0;function Ao(){if(A0)return as;A0=1,Object.defineProperty(as,"__esModule",{value:!0}),as.switchMap=void 0;var E=fe(),t=ee(),m=re();function y(l,r){return t.operate(function(a,n){var i=null,h=0,p=!1,d=function(){return p&&!i&&n.complete()};a.subscribe(m.createOperatorSubscriber(n,function(f){i==null||i.unsubscribe();var s=0,o=h++;E.innerFrom(l(f,o)).subscribe(i=m.createOperatorSubscriber(n,function(u){return n.next(r?r(f,u,o,s++):u)},function(){i=null,d()}))},function(){p=!0,d()}))})}return as.switchMap=y,as}var O0;function k2(){if(O0)return ns;O0=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.switchAll=void 0;var E=Ao(),t=He();function m(){return E.switchMap(t.identity)}return ns.switchAll=m,ns}var ss={},w0;function G2(){if(w0)return ss;w0=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.switchMapTo=void 0;var E=Ao(),t=ye();function m(y,l){return t.isFunction(l)?E.switchMap(function(){return y},l):E.switchMap(function(){return y})}return ss.switchMapTo=m,ss}var os={},P0;function q2(){if(P0)return os;P0=1,Object.defineProperty(os,"__esModule",{value:!0}),os.switchScan=void 0;var E=Ao(),t=ee();function m(y,l){return t.operate(function(r,a){var n=l;return E.switchMap(function(i,h){return y(n,i,h)},function(i,h){return n=h,h})(r).subscribe(a),function(){n=null}})}return os.switchScan=m,os}var us={},R0;function W2(){if(R0)return us;R0=1,Object.defineProperty(us,"__esModule",{value:!0}),us.takeUntil=void 0;var E=ee(),t=re(),m=fe(),y=$e();function l(r){return E.operate(function(a,n){m.innerFrom(r).subscribe(t.createOperatorSubscriber(n,function(){return n.complete()},y.noop)),!n.closed&&a.subscribe(n)})}return us.takeUntil=l,us}var ls={},L0;function V2(){if(L0)return ls;L0=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.takeWhile=void 0;var E=ee(),t=re();function m(y,l){return l===void 0&&(l=!1),E.operate(function(r,a){var n=0;r.subscribe(t.createOperatorSubscriber(a,function(i){var h=y(i,n++);(h||l)&&a.next(i),!h&&a.complete()}))})}return ls.takeWhile=m,ls}var cs={},M0;function $2(){if(M0)return cs;M0=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.tap=void 0;var E=ye(),t=ee(),m=re(),y=He();function l(r,a,n){var i=E.isFunction(r)||a||n?{next:r,error:a,complete:n}:r;return i?t.operate(function(h,p){var d;(d=i.subscribe)===null||d===void 0||d.call(i);var f=!0;h.subscribe(m.createOperatorSubscriber(p,function(s){var o;(o=i.next)===null||o===void 0||o.call(i,s),p.next(s)},function(){var s;f=!1,(s=i.complete)===null||s===void 0||s.call(i),p.complete()},function(s){var o;f=!1,(o=i.error)===null||o===void 0||o.call(i,s),p.error(s)},function(){var s,o;f&&((s=i.unsubscribe)===null||s===void 0||s.call(i)),(o=i.finalize)===null||o===void 0||o.call(i)}))}):y.identity}return cs.tap=l,cs}var hs={},I0;function t1(){if(I0)return hs;I0=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.throttle=void 0;var E=ee(),t=re(),m=fe();function y(l,r){return E.operate(function(a,n){var i=r??{},h=i.leading,p=h===void 0?!0:h,d=i.trailing,f=d===void 0?!1:d,s=!1,o=null,u=null,b=!1,v=function(){u==null||u.unsubscribe(),u=null,f&&(x(),b&&n.complete())},_=function(){u=null,b&&n.complete()},g=function(T){return u=m.innerFrom(l(T)).subscribe(t.createOperatorSubscriber(n,v,_))},x=function(){if(s){s=!1;var T=o;o=null,n.next(T),!b&&g(T)}};a.subscribe(t.createOperatorSubscriber(n,function(T){s=!0,o=T,!(u&&!u.closed)&&(p?x():g(T))},function(){b=!0,!(f&&s&&u&&!u.closed)&&n.complete()}))})}return hs.throttle=y,hs}var ds={},F0;function H2(){if(F0)return ds;F0=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.throttleTime=void 0;var E=rt(),t=t1(),m=Kr();function y(l,r,a){r===void 0&&(r=E.asyncScheduler);var n=m.timer(l,r);return t.throttle(function(){return n},a)}return ds.throttleTime=y,ds}var Dr={},C0;function X2(){if(C0)return Dr;C0=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.TimeInterval=Dr.timeInterval=void 0;var E=rt(),t=ee(),m=re();function y(r){return r===void 0&&(r=E.asyncScheduler),t.operate(function(a,n){var i=r.now();a.subscribe(m.createOperatorSubscriber(n,function(h){var p=r.now(),d=p-i;i=p,n.next(new l(h,d))}))})}Dr.timeInterval=y;var l=function(){function r(a,n){this.value=a,this.interval=n}return r}();return Dr.TimeInterval=l,Dr}var fs={},N0;function Y2(){if(N0)return fs;N0=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.timeoutWith=void 0;var E=rt(),t=Bl(),m=yl();function y(l,r,a){var n,i,h;if(a=a??E.async,t.isValidDate(l)?n=l:typeof l=="number"&&(i=l),r)h=function(){return r};else throw new TypeError("No observable provided to switch to");if(n==null&&i==null)throw new TypeError("No timeout provided.");return m.timeout({first:n,each:i,scheduler:a,with:h})}return fs.timeoutWith=y,fs}var _s={},z0;function Z2(){if(z0)return _s;z0=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.timestamp=void 0;var E=Ll(),t=Yr();function m(y){return y===void 0&&(y=E.dateTimestampProvider),t.map(function(l){return{value:l,timestamp:y.now()}})}return _s.timestamp=m,_s}var ps={},B0;function K2(){if(B0)return ps;B0=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.window=void 0;var E=Xe(),t=ee(),m=re(),y=$e(),l=fe();function r(a){return t.operate(function(n,i){var h=new E.Subject;i.next(h.asObservable());var p=function(d){h.error(d),i.error(d)};return n.subscribe(m.createOperatorSubscriber(i,function(d){return h==null?void 0:h.next(d)},function(){h.complete(),i.complete()},p)),l.innerFrom(a).subscribe(m.createOperatorSubscriber(i,function(){h.complete(),i.next(h=new E.Subject)},y.noop,p)),function(){h==null||h.unsubscribe(),h=null}})}return ps.window=r,ps}var jr={},D0;function Q2(){if(D0)return jr;D0=1;var E=jr&&jr.__values||function(r){var a=typeof Symbol=="function"&&Symbol.iterator,n=a&&r[a],i=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(jr,"__esModule",{value:!0}),jr.windowCount=void 0;var t=Xe(),m=ee(),y=re();function l(r,a){a===void 0&&(a=0);var n=a>0?a:r;return m.operate(function(i,h){var p=[new t.Subject],d=0;h.next(p[0].asObservable()),i.subscribe(y.createOperatorSubscriber(h,function(f){var s,o;try{for(var u=E(p),b=u.next();!b.done;b=u.next()){var v=b.value;v.next(f)}}catch(x){s={error:x}}finally{try{b&&!b.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}var _=d-r+1;if(_>=0&&_%n===0&&p.shift().complete(),++d%n===0){var g=new t.Subject;p.push(g),h.next(g.asObservable())}},function(){for(;p.length>0;)p.shift().complete();h.complete()},function(f){for(;p.length>0;)p.shift().error(f);h.error(f)},function(){p=null}))})}return jr.windowCount=l,jr}var vs={},j0;function J2(){if(j0)return vs;j0=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.windowTime=void 0;var E=Xe(),t=rt(),m=st(),y=ee(),l=re(),r=Jt(),a=it(),n=er();function i(h){for(var p,d,f=[],s=1;s<arguments.length;s++)f[s-1]=arguments[s];var o=(p=a.popScheduler(f))!==null&&p!==void 0?p:t.asyncScheduler,u=(d=f[0])!==null&&d!==void 0?d:null,b=f[1]||1/0;return y.operate(function(v,_){var g=[],x=!1,T=function(P){var C=P.window,U=P.subs;C.complete(),U.unsubscribe(),r.arrRemove(g,P),x&&O()},O=function(){if(g){var P=new m.Subscription;_.add(P);var C=new E.Subject,U={window:C,subs:P,seen:0};g.push(U),_.next(C.asObservable()),n.executeSchedule(P,o,function(){return T(U)},h)}};u!==null&&u>=0?n.executeSchedule(_,o,O,u,!0):x=!0,O();var A=function(P){return g.slice().forEach(P)},R=function(P){A(function(C){var U=C.window;return P(U)}),P(_),_.unsubscribe()};return v.subscribe(l.createOperatorSubscriber(_,function(P){A(function(C){C.window.next(P),b<=++C.seen&&T(C)})},function(){return R(function(P){return P.complete()})},function(P){return R(function(C){return C.error(P)})})),function(){g=null}})}return vs.windowTime=i,vs}var Ur={},U0;function eb(){if(U0)return Ur;U0=1;var E=Ur&&Ur.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,d=p&&h[p],f=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&f>=h.length&&(h=void 0),{value:h&&h[f++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.windowToggle=void 0;var t=Xe(),m=st(),y=ee(),l=fe(),r=re(),a=$e(),n=Jt();function i(h,p){return y.operate(function(d,f){var s=[],o=function(u){for(;0<s.length;)s.shift().error(u);f.error(u)};l.innerFrom(h).subscribe(r.createOperatorSubscriber(f,function(u){var b=new t.Subject;s.push(b);var v=new m.Subscription,_=function(){n.arrRemove(s,b),b.complete(),v.unsubscribe()},g;try{g=l.innerFrom(p(u))}catch(x){o(x);return}f.next(b.asObservable()),v.add(g.subscribe(r.createOperatorSubscriber(f,_,a.noop,o)))},a.noop)),d.subscribe(r.createOperatorSubscriber(f,function(u){var b,v,_=s.slice();try{for(var g=E(_),x=g.next();!x.done;x=g.next()){var T=x.value;T.next(u)}}catch(O){b={error:O}}finally{try{x&&!x.done&&(v=g.return)&&v.call(g)}finally{if(b)throw b.error}}},function(){for(;0<s.length;)s.shift().complete();f.complete()},o,function(){for(;0<s.length;)s.shift().unsubscribe()}))})}return Ur.windowToggle=i,Ur}var ms={},k0;function tb(){if(k0)return ms;k0=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.windowWhen=void 0;var E=Xe(),t=ee(),m=re(),y=fe();function l(r){return t.operate(function(a,n){var i,h,p=function(f){i.error(f),n.error(f)},d=function(){h==null||h.unsubscribe(),i==null||i.complete(),i=new E.Subject,n.next(i.asObservable());var f;try{f=y.innerFrom(r())}catch(s){p(s);return}f.subscribe(h=m.createOperatorSubscriber(n,d,d,p))};d(),a.subscribe(m.createOperatorSubscriber(n,function(f){return i.next(f)},function(){i.complete(),n.complete()},p,function(){h==null||h.unsubscribe(),i=null}))})}return ms.windowWhen=l,ms}var Wt={},G0;function rb(){if(G0)return Wt;G0=1;var E=Wt&&Wt.__read||function(h,p){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var f=d.call(h),s,o=[],u;try{for(;(p===void 0||p-- >0)&&!(s=f.next()).done;)o.push(s.value)}catch(b){u={error:b}}finally{try{s&&!s.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}return o},t=Wt&&Wt.__spreadArray||function(h,p){for(var d=0,f=p.length,s=h.length;d<f;d++,s++)h[s]=p[d];return h};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.withLatestFrom=void 0;var m=ee(),y=re(),l=fe(),r=He(),a=$e(),n=it();function i(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var d=n.popResultSelector(h);return m.operate(function(f,s){for(var o=h.length,u=new Array(o),b=h.map(function(){return!1}),v=!1,_=function(x){l.innerFrom(h[x]).subscribe(y.createOperatorSubscriber(s,function(T){u[x]=T,!v&&!b[x]&&(b[x]=!0,(v=b.every(r.identity))&&(b=null))},a.noop))},g=0;g<o;g++)_(g);f.subscribe(y.createOperatorSubscriber(s,function(x){if(v){var T=t([x],E(u));s.next(d?d.apply(void 0,t([],E(T))):T)}}))})}return Wt.withLatestFrom=i,Wt}var bs={},q0;function ib(){if(q0)return bs;q0=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.zipAll=void 0;var E=kl(),t=G_();function m(y){return t.joinAllInternals(E.zip,y)}return bs.zipAll=m,bs}var Vt={},$t={},W0;function nb(){if(W0)return $t;W0=1;var E=$t&&$t.__read||function(r,a){var n=typeof Symbol=="function"&&r[Symbol.iterator];if(!n)return r;var i=n.call(r),h,p=[],d;try{for(;(a===void 0||a-- >0)&&!(h=i.next()).done;)p.push(h.value)}catch(f){d={error:f}}finally{try{h&&!h.done&&(n=i.return)&&n.call(i)}finally{if(d)throw d.error}}return p},t=$t&&$t.__spreadArray||function(r,a){for(var n=0,i=a.length,h=r.length;n<i;n++,h++)r[h]=a[n];return r};Object.defineProperty($t,"__esModule",{value:!0}),$t.zip=void 0;var m=kl(),y=ee();function l(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return y.operate(function(n,i){m.zip.apply(void 0,t([n],E(r))).subscribe(i)})}return $t.zip=l,$t}var V0;function ab(){if(V0)return Vt;V0=1;var E=Vt&&Vt.__read||function(l,r){var a=typeof Symbol=="function"&&l[Symbol.iterator];if(!a)return l;var n=a.call(l),i,h=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)h.push(i.value)}catch(d){p={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(p)throw p.error}}return h},t=Vt&&Vt.__spreadArray||function(l,r){for(var a=0,n=r.length,i=l.length;a<n;a++,i++)l[i]=r[a];return l};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.zipWith=void 0;var m=nb();function y(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return m.zip.apply(void 0,t([],E(l)))}return Vt.zipWith=y,Vt}var $0;function sb(){return $0||($0=1,function(E){var t=sr&&sr.__createBinding||(Object.create?function(Kt,Qt,ct,wt){wt===void 0&&(wt=ct),Object.defineProperty(Kt,wt,{enumerable:!0,get:function(){return Qt[ct]}})}:function(Kt,Qt,ct,wt){wt===void 0&&(wt=ct),Kt[wt]=Qt[ct]}),m=sr&&sr.__exportStar||function(Kt,Qt){for(var ct in Kt)ct!=="default"&&!Object.prototype.hasOwnProperty.call(Qt,ct)&&t(Qt,Kt,ct)};Object.defineProperty(E,"__esModule",{value:!0}),E.interval=E.iif=E.generate=E.fromEventPattern=E.fromEvent=E.from=E.forkJoin=E.empty=E.defer=E.connectable=E.concat=E.combineLatest=E.bindNodeCallback=E.bindCallback=E.UnsubscriptionError=E.TimeoutError=E.SequenceError=E.ObjectUnsubscribedError=E.NotFoundError=E.EmptyError=E.ArgumentOutOfRangeError=E.firstValueFrom=E.lastValueFrom=E.isObservable=E.identity=E.noop=E.pipe=E.NotificationKind=E.Notification=E.Subscriber=E.Subscription=E.Scheduler=E.VirtualAction=E.VirtualTimeScheduler=E.animationFrameScheduler=E.animationFrame=E.queueScheduler=E.queue=E.asyncScheduler=E.async=E.asapScheduler=E.asap=E.AsyncSubject=E.ReplaySubject=E.BehaviorSubject=E.Subject=E.animationFrames=E.observable=E.ConnectableObservable=E.Observable=void 0,E.filter=E.expand=E.exhaustMap=E.exhaustAll=E.exhaust=E.every=E.endWith=E.elementAt=E.distinctUntilKeyChanged=E.distinctUntilChanged=E.distinct=E.dematerialize=E.delayWhen=E.delay=E.defaultIfEmpty=E.debounceTime=E.debounce=E.count=E.connect=E.concatWith=E.concatMapTo=E.concatMap=E.concatAll=E.combineLatestWith=E.combineLatestAll=E.combineAll=E.catchError=E.bufferWhen=E.bufferToggle=E.bufferTime=E.bufferCount=E.buffer=E.auditTime=E.audit=E.config=E.NEVER=E.EMPTY=E.scheduled=E.zip=E.using=E.timer=E.throwError=E.range=E.race=E.partition=E.pairs=E.onErrorResumeNext=E.of=E.never=E.merge=void 0,E.switchMap=E.switchAll=E.subscribeOn=E.startWith=E.skipWhile=E.skipUntil=E.skipLast=E.skip=E.single=E.shareReplay=E.share=E.sequenceEqual=E.scan=E.sampleTime=E.sample=E.refCount=E.retryWhen=E.retry=E.repeatWhen=E.repeat=E.reduce=E.raceWith=E.publishReplay=E.publishLast=E.publishBehavior=E.publish=E.pluck=E.pairwise=E.onErrorResumeNextWith=E.observeOn=E.multicast=E.min=E.mergeWith=E.mergeScan=E.mergeMapTo=E.mergeMap=E.flatMap=E.mergeAll=E.max=E.materialize=E.mapTo=E.map=E.last=E.isEmpty=E.ignoreElements=E.groupBy=E.first=E.findIndex=E.find=E.finalize=void 0,E.zipWith=E.zipAll=E.withLatestFrom=E.windowWhen=E.windowToggle=E.windowTime=E.windowCount=E.window=E.toArray=E.timestamp=E.timeoutWith=E.timeout=E.timeInterval=E.throwIfEmpty=E.throttleTime=E.throttle=E.tap=E.takeWhile=E.takeUntil=E.takeLast=E.take=E.switchScan=E.switchMapTo=void 0;var y=Te();Object.defineProperty(E,"Observable",{enumerable:!0,get:function(){return y.Observable}});var l=po();Object.defineProperty(E,"ConnectableObservable",{enumerable:!0,get:function(){return l.ConnectableObservable}});var r=fo();Object.defineProperty(E,"observable",{enumerable:!0,get:function(){return r.observable}});var a=Zv();Object.defineProperty(E,"animationFrames",{enumerable:!0,get:function(){return a.animationFrames}});var n=Xe();Object.defineProperty(E,"Subject",{enumerable:!0,get:function(){return n.Subject}});var i=b_();Object.defineProperty(E,"BehaviorSubject",{enumerable:!0,get:function(){return i.BehaviorSubject}});var h=Ml();Object.defineProperty(E,"ReplaySubject",{enumerable:!0,get:function(){return h.ReplaySubject}});var p=Il();Object.defineProperty(E,"AsyncSubject",{enumerable:!0,get:function(){return p.AsyncSubject}});var d=im();Object.defineProperty(E,"asap",{enumerable:!0,get:function(){return d.asap}}),Object.defineProperty(E,"asapScheduler",{enumerable:!0,get:function(){return d.asapScheduler}});var f=rt();Object.defineProperty(E,"async",{enumerable:!0,get:function(){return f.async}}),Object.defineProperty(E,"asyncScheduler",{enumerable:!0,get:function(){return f.asyncScheduler}});var s=sm();Object.defineProperty(E,"queue",{enumerable:!0,get:function(){return s.queue}}),Object.defineProperty(E,"queueScheduler",{enumerable:!0,get:function(){return s.queueScheduler}});var o=lm();Object.defineProperty(E,"animationFrame",{enumerable:!0,get:function(){return o.animationFrame}}),Object.defineProperty(E,"animationFrameScheduler",{enumerable:!0,get:function(){return o.animationFrameScheduler}});var u=cm();Object.defineProperty(E,"VirtualTimeScheduler",{enumerable:!0,get:function(){return u.VirtualTimeScheduler}}),Object.defineProperty(E,"VirtualAction",{enumerable:!0,get:function(){return u.VirtualAction}});var b=g_();Object.defineProperty(E,"Scheduler",{enumerable:!0,get:function(){return b.Scheduler}});var v=st();Object.defineProperty(E,"Subscription",{enumerable:!0,get:function(){return v.Subscription}});var _=Os();Object.defineProperty(E,"Subscriber",{enumerable:!0,get:function(){return _.Subscriber}});var g=zl();Object.defineProperty(E,"Notification",{enumerable:!0,get:function(){return g.Notification}}),Object.defineProperty(E,"NotificationKind",{enumerable:!0,get:function(){return g.NotificationKind}});var x=_o();Object.defineProperty(E,"pipe",{enumerable:!0,get:function(){return x.pipe}});var T=$e();Object.defineProperty(E,"noop",{enumerable:!0,get:function(){return T.noop}});var O=He();Object.defineProperty(E,"identity",{enumerable:!0,get:function(){return O.identity}});var A=pm();Object.defineProperty(E,"isObservable",{enumerable:!0,get:function(){return A.isObservable}});var R=vm();Object.defineProperty(E,"lastValueFrom",{enumerable:!0,get:function(){return R.lastValueFrom}});var P=mm();Object.defineProperty(E,"firstValueFrom",{enumerable:!0,get:function(){return P.firstValueFrom}});var C=L_();Object.defineProperty(E,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return C.ArgumentOutOfRangeError}});var U=Xr();Object.defineProperty(E,"EmptyError",{enumerable:!0,get:function(){return U.EmptyError}});var j=M_();Object.defineProperty(E,"NotFoundError",{enumerable:!0,get:function(){return j.NotFoundError}});var k=m_();Object.defineProperty(E,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return k.ObjectUnsubscribedError}});var $=I_();Object.defineProperty(E,"SequenceError",{enumerable:!0,get:function(){return $.SequenceError}});var Y=yl();Object.defineProperty(E,"TimeoutError",{enumerable:!0,get:function(){return Y.TimeoutError}});var Z=d_();Object.defineProperty(E,"UnsubscriptionError",{enumerable:!0,get:function(){return Z.UnsubscriptionError}});var J=bm();Object.defineProperty(E,"bindCallback",{enumerable:!0,get:function(){return J.bindCallback}});var te=gm();Object.defineProperty(E,"bindNodeCallback",{enumerable:!0,get:function(){return te.bindNodeCallback}});var Q=Dl();Object.defineProperty(E,"combineLatest",{enumerable:!0,get:function(){return Q.combineLatest}});var ie=yo();Object.defineProperty(E,"concat",{enumerable:!0,get:function(){return ie.concat}});var ce=ym();Object.defineProperty(E,"connectable",{enumerable:!0,get:function(){return ce.connectable}});var de=Eo();Object.defineProperty(E,"defer",{enumerable:!0,get:function(){return de.defer}});var me=Tt();Object.defineProperty(E,"empty",{enumerable:!0,get:function(){return me.empty}});var xe=Em();Object.defineProperty(E,"forkJoin",{enumerable:!0,get:function(){return xe.forkJoin}});var Ce=tr();Object.defineProperty(E,"from",{enumerable:!0,get:function(){return Ce.from}});var se=Tm();Object.defineProperty(E,"fromEvent",{enumerable:!0,get:function(){return se.fromEvent}});var we=xm();Object.defineProperty(E,"fromEventPattern",{enumerable:!0,get:function(){return we.fromEventPattern}});var Be=Sm();Object.defineProperty(E,"generate",{enumerable:!0,get:function(){return Be.generate}});var ot=Am();Object.defineProperty(E,"iif",{enumerable:!0,get:function(){return ot.iif}});var Qe=z_();Object.defineProperty(E,"interval",{enumerable:!0,get:function(){return Qe.interval}});var We=Om();Object.defineProperty(E,"merge",{enumerable:!0,get:function(){return We.merge}});var Ve=zd();Object.defineProperty(E,"never",{enumerable:!0,get:function(){return Ve.never}});var nt=Nl();Object.defineProperty(E,"of",{enumerable:!0,get:function(){return nt.of}});var ir=B_();Object.defineProperty(E,"onErrorResumeNext",{enumerable:!0,get:function(){return ir.onErrorResumeNext}});var ut=wm();Object.defineProperty(E,"pairs",{enumerable:!0,get:function(){return ut.pairs}});var St=Rm();Object.defineProperty(E,"partition",{enumerable:!0,get:function(){return St.partition}});var At=D_();Object.defineProperty(E,"race",{enumerable:!0,get:function(){return At.race}});var yt=Lm();Object.defineProperty(E,"range",{enumerable:!0,get:function(){return yt.range}});var nr=R_();Object.defineProperty(E,"throwError",{enumerable:!0,get:function(){return nr.throwError}});var hi=Kr();Object.defineProperty(E,"timer",{enumerable:!0,get:function(){return hi.timer}});var Ot=Mm();Object.defineProperty(E,"using",{enumerable:!0,get:function(){return Ot.using}});var Jr=kl();Object.defineProperty(E,"zip",{enumerable:!0,get:function(){return Jr.zip}});var di=P_();Object.defineProperty(E,"scheduled",{enumerable:!0,get:function(){return di.scheduled}});var fi=Tt();Object.defineProperty(E,"EMPTY",{enumerable:!0,get:function(){return fi.EMPTY}});var ei=zd();Object.defineProperty(E,"NEVER",{enumerable:!0,get:function(){return ei.NEVER}}),m(Im(),E);var _i=As();Object.defineProperty(E,"config",{enumerable:!0,get:function(){return _i.config}});var pi=j_();Object.defineProperty(E,"audit",{enumerable:!0,get:function(){return pi.audit}});var vi=Fm();Object.defineProperty(E,"auditTime",{enumerable:!0,get:function(){return vi.auditTime}});var ti=Cm();Object.defineProperty(E,"buffer",{enumerable:!0,get:function(){return ti.buffer}});var mi=Nm();Object.defineProperty(E,"bufferCount",{enumerable:!0,get:function(){return mi.bufferCount}});var bi=zm();Object.defineProperty(E,"bufferTime",{enumerable:!0,get:function(){return bi.bufferTime}});var ri=Bm();Object.defineProperty(E,"bufferToggle",{enumerable:!0,get:function(){return ri.bufferToggle}});var gi=Dm();Object.defineProperty(E,"bufferWhen",{enumerable:!0,get:function(){return gi.bufferWhen}});var ar=jm();Object.defineProperty(E,"catchError",{enumerable:!0,get:function(){return ar.catchError}});var Zt=Um();Object.defineProperty(E,"combineAll",{enumerable:!0,get:function(){return Zt.combineAll}});var yi=q_();Object.defineProperty(E,"combineLatestAll",{enumerable:!0,get:function(){return yi.combineLatestAll}});var Ei=Gm();Object.defineProperty(E,"combineLatestWith",{enumerable:!0,get:function(){return Ei.combineLatestWith}});var Ti=Ul();Object.defineProperty(E,"concatAll",{enumerable:!0,get:function(){return Ti.concatAll}});var Pe=W_();Object.defineProperty(E,"concatMap",{enumerable:!0,get:function(){return Pe.concatMap}});var De=qm();Object.defineProperty(E,"concatMapTo",{enumerable:!0,get:function(){return De.concatMapTo}});var Ue=Vm();Object.defineProperty(E,"concatWith",{enumerable:!0,get:function(){return Ue.concatWith}});var lt=Gl();Object.defineProperty(E,"connect",{enumerable:!0,get:function(){return lt.connect}});var Et=Hm();Object.defineProperty(E,"count",{enumerable:!0,get:function(){return Et.count}});var wo=Xm();Object.defineProperty(E,"debounce",{enumerable:!0,get:function(){return wo.debounce}});var Po=Ym();Object.defineProperty(E,"debounceTime",{enumerable:!0,get:function(){return Po.debounceTime}});var Ro=To();Object.defineProperty(E,"defaultIfEmpty",{enumerable:!0,get:function(){return Ro.defaultIfEmpty}});var Lo=Zm();Object.defineProperty(E,"delay",{enumerable:!0,get:function(){return Lo.delay}});var Mo=H_();Object.defineProperty(E,"delayWhen",{enumerable:!0,get:function(){return Mo.delayWhen}});var Io=Km();Object.defineProperty(E,"dematerialize",{enumerable:!0,get:function(){return Io.dematerialize}});var Ns=Qm();Object.defineProperty(E,"distinct",{enumerable:!0,get:function(){return Ns.distinct}});var Fo=X_();Object.defineProperty(E,"distinctUntilChanged",{enumerable:!0,get:function(){return Fo.distinctUntilChanged}});var Co=Jm();Object.defineProperty(E,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Co.distinctUntilKeyChanged}});var No=e2();Object.defineProperty(E,"elementAt",{enumerable:!0,get:function(){return No.elementAt}});var zo=t2();Object.defineProperty(E,"endWith",{enumerable:!0,get:function(){return zo.endWith}});var Bo=r2();Object.defineProperty(E,"every",{enumerable:!0,get:function(){return Bo.every}});var Do=i2();Object.defineProperty(E,"exhaust",{enumerable:!0,get:function(){return Do.exhaust}});var jo=Z_();Object.defineProperty(E,"exhaustAll",{enumerable:!0,get:function(){return jo.exhaustAll}});var Uo=Y_();Object.defineProperty(E,"exhaustMap",{enumerable:!0,get:function(){return Uo.exhaustMap}});var ko=n2();Object.defineProperty(E,"expand",{enumerable:!0,get:function(){return ko.expand}});var Go=si();Object.defineProperty(E,"filter",{enumerable:!0,get:function(){return Go.filter}});var qo=a2();Object.defineProperty(E,"finalize",{enumerable:!0,get:function(){return qo.finalize}});var Wo=K_();Object.defineProperty(E,"find",{enumerable:!0,get:function(){return Wo.find}});var Vo=s2();Object.defineProperty(E,"findIndex",{enumerable:!0,get:function(){return Vo.findIndex}});var zs=o2();Object.defineProperty(E,"first",{enumerable:!0,get:function(){return zs.first}});var $o=u2();Object.defineProperty(E,"groupBy",{enumerable:!0,get:function(){return $o.groupBy}});var Ho=V_();Object.defineProperty(E,"ignoreElements",{enumerable:!0,get:function(){return Ho.ignoreElements}});var Xo=l2();Object.defineProperty(E,"isEmpty",{enumerable:!0,get:function(){return Xo.isEmpty}});var Yo=c2();Object.defineProperty(E,"last",{enumerable:!0,get:function(){return Yo.last}});var Zo=Yr();Object.defineProperty(E,"map",{enumerable:!0,get:function(){return Zo.map}});var Ko=$_();Object.defineProperty(E,"mapTo",{enumerable:!0,get:function(){return Ko.mapTo}});var Qo=h2();Object.defineProperty(E,"materialize",{enumerable:!0,get:function(){return Qo.materialize}});var Jo=d2();Object.defineProperty(E,"max",{enumerable:!0,get:function(){return Jo.max}});var eu=go();Object.defineProperty(E,"mergeAll",{enumerable:!0,get:function(){return eu.mergeAll}});var tu=f2();Object.defineProperty(E,"flatMap",{enumerable:!0,get:function(){return tu.flatMap}});var ru=rr();Object.defineProperty(E,"mergeMap",{enumerable:!0,get:function(){return ru.mergeMap}});var Bs=_2();Object.defineProperty(E,"mergeMapTo",{enumerable:!0,get:function(){return Bs.mergeMapTo}});var iu=p2();Object.defineProperty(E,"mergeScan",{enumerable:!0,get:function(){return iu.mergeScan}});var nu=m2();Object.defineProperty(E,"mergeWith",{enumerable:!0,get:function(){return nu.mergeWith}});var au=b2();Object.defineProperty(E,"min",{enumerable:!0,get:function(){return au.min}});var su=ql();Object.defineProperty(E,"multicast",{enumerable:!0,get:function(){return su.multicast}});var Ds=mo();Object.defineProperty(E,"observeOn",{enumerable:!0,get:function(){return Ds.observeOn}});var ou=g2();Object.defineProperty(E,"onErrorResumeNextWith",{enumerable:!0,get:function(){return ou.onErrorResumeNextWith}});var uu=y2();Object.defineProperty(E,"pairwise",{enumerable:!0,get:function(){return uu.pairwise}});var lu=E2();Object.defineProperty(E,"pluck",{enumerable:!0,get:function(){return lu.pluck}});var cu=T2();Object.defineProperty(E,"publish",{enumerable:!0,get:function(){return cu.publish}});var hu=x2();Object.defineProperty(E,"publishBehavior",{enumerable:!0,get:function(){return hu.publishBehavior}});var du=S2();Object.defineProperty(E,"publishLast",{enumerable:!0,get:function(){return du.publishLast}});var fu=A2();Object.defineProperty(E,"publishReplay",{enumerable:!0,get:function(){return fu.publishReplay}});var _u=O2();Object.defineProperty(E,"raceWith",{enumerable:!0,get:function(){return _u.raceWith}});var pu=Ls();Object.defineProperty(E,"reduce",{enumerable:!0,get:function(){return pu.reduce}});var vu=w2();Object.defineProperty(E,"repeat",{enumerable:!0,get:function(){return vu.repeat}});var mu=P2();Object.defineProperty(E,"repeatWhen",{enumerable:!0,get:function(){return mu.repeatWhen}});var bu=R2();Object.defineProperty(E,"retry",{enumerable:!0,get:function(){return bu.retry}});var js=L2();Object.defineProperty(E,"retryWhen",{enumerable:!0,get:function(){return js.retryWhen}});var gu=p_();Object.defineProperty(E,"refCount",{enumerable:!0,get:function(){return gu.refCount}});var Us=J_();Object.defineProperty(E,"sample",{enumerable:!0,get:function(){return Us.sample}});var ks=M2();Object.defineProperty(E,"sampleTime",{enumerable:!0,get:function(){return ks.sampleTime}});var Gs=I2();Object.defineProperty(E,"scan",{enumerable:!0,get:function(){return Gs.scan}});var yu=F2();Object.defineProperty(E,"sequenceEqual",{enumerable:!0,get:function(){return yu.sequenceEqual}});var Eu=e1();Object.defineProperty(E,"share",{enumerable:!0,get:function(){return Eu.share}});var Tu=C2();Object.defineProperty(E,"shareReplay",{enumerable:!0,get:function(){return Tu.shareReplay}});var xu=N2();Object.defineProperty(E,"single",{enumerable:!0,get:function(){return xu.single}});var qs=z2();Object.defineProperty(E,"skip",{enumerable:!0,get:function(){return qs.skip}});var Su=B2();Object.defineProperty(E,"skipLast",{enumerable:!0,get:function(){return Su.skipLast}});var Au=D2();Object.defineProperty(E,"skipUntil",{enumerable:!0,get:function(){return Au.skipUntil}});var Ou=j2();Object.defineProperty(E,"skipWhile",{enumerable:!0,get:function(){return Ou.skipWhile}});var Ws=U2();Object.defineProperty(E,"startWith",{enumerable:!0,get:function(){return Ws.startWith}});var wu=bo();Object.defineProperty(E,"subscribeOn",{enumerable:!0,get:function(){return wu.subscribeOn}});var Pu=k2();Object.defineProperty(E,"switchAll",{enumerable:!0,get:function(){return Pu.switchAll}});var Ru=Ao();Object.defineProperty(E,"switchMap",{enumerable:!0,get:function(){return Ru.switchMap}});var Lu=G2();Object.defineProperty(E,"switchMapTo",{enumerable:!0,get:function(){return Lu.switchMapTo}});var Mu=q2();Object.defineProperty(E,"switchScan",{enumerable:!0,get:function(){return Mu.switchScan}});var Iu=xo();Object.defineProperty(E,"take",{enumerable:!0,get:function(){return Iu.take}});var Fu=Q_();Object.defineProperty(E,"takeLast",{enumerable:!0,get:function(){return Fu.takeLast}});var Vs=W2();Object.defineProperty(E,"takeUntil",{enumerable:!0,get:function(){return Vs.takeUntil}});var Cu=V2();Object.defineProperty(E,"takeWhile",{enumerable:!0,get:function(){return Cu.takeWhile}});var Nu=$2();Object.defineProperty(E,"tap",{enumerable:!0,get:function(){return Nu.tap}});var zu=t1();Object.defineProperty(E,"throttle",{enumerable:!0,get:function(){return zu.throttle}});var Bu=H2();Object.defineProperty(E,"throttleTime",{enumerable:!0,get:function(){return Bu.throttleTime}});var Du=So();Object.defineProperty(E,"throwIfEmpty",{enumerable:!0,get:function(){return Du.throwIfEmpty}});var ju=X2();Object.defineProperty(E,"timeInterval",{enumerable:!0,get:function(){return ju.timeInterval}});var xi=yl();Object.defineProperty(E,"timeout",{enumerable:!0,get:function(){return xi.timeout}});var Uu=Y2();Object.defineProperty(E,"timeoutWith",{enumerable:!0,get:function(){return Uu.timeoutWith}});var $s=Z2();Object.defineProperty(E,"timestamp",{enumerable:!0,get:function(){return $s.timestamp}});var Si=k_();Object.defineProperty(E,"toArray",{enumerable:!0,get:function(){return Si.toArray}});var ku=K2();Object.defineProperty(E,"window",{enumerable:!0,get:function(){return ku.window}});var Gu=Q2();Object.defineProperty(E,"windowCount",{enumerable:!0,get:function(){return Gu.windowCount}});var qu=J2();Object.defineProperty(E,"windowTime",{enumerable:!0,get:function(){return qu.windowTime}});var Hs=eb();Object.defineProperty(E,"windowToggle",{enumerable:!0,get:function(){return Hs.windowToggle}});var Xs=tb();Object.defineProperty(E,"windowWhen",{enumerable:!0,get:function(){return Xs.windowWhen}});var Ys=rb();Object.defineProperty(E,"withLatestFrom",{enumerable:!0,get:function(){return Ys.withLatestFrom}});var Wu=ib();Object.defineProperty(E,"zipAll",{enumerable:!0,get:function(){return Wu.zipAll}});var Vu=ab();Object.defineProperty(E,"zipWith",{enumerable:!0,get:function(){return Vu.zipWith}})}(sr)),sr}var H0;function ob(){return H0||(H0=1,(()=>{var E={3557:(l,r,a)=>{a.r(r),a.d(r,{glMatrix:()=>n,mat2:()=>i,mat2d:()=>h,mat3:()=>p,mat4:()=>d,quat:()=>o,quat2:()=>u,vec2:()=>b,vec3:()=>f,vec4:()=>s});var n={};a.r(n),a.d(n,{ARRAY_TYPE:()=>_,EPSILON:()=>v,RANDOM:()=>g,equals:()=>A,setMatrixArrayType:()=>x,toRadian:()=>O});var i={};a.r(i),a.d(i,{LDU:()=>Ce,add:()=>se,adjoint:()=>Z,clone:()=>P,copy:()=>C,create:()=>R,determinant:()=>J,equals:()=>ot,exactEquals:()=>Be,frob:()=>xe,fromRotation:()=>ce,fromScaling:()=>de,fromValues:()=>j,identity:()=>U,invert:()=>Y,mul:()=>Ve,multiply:()=>te,multiplyScalar:()=>Qe,multiplyScalarAndAdd:()=>We,rotate:()=>Q,scale:()=>ie,set:()=>k,str:()=>me,sub:()=>nt,subtract:()=>we,transpose:()=>$});var h={};a.r(h),a.d(h,{add:()=>bi,clone:()=>ut,copy:()=>St,create:()=>ir,determinant:()=>Ot,equals:()=>yi,exactEquals:()=>Zt,frob:()=>mi,fromRotation:()=>_i,fromScaling:()=>pi,fromTranslation:()=>vi,fromValues:()=>yt,identity:()=>At,invert:()=>hi,mul:()=>Ei,multiply:()=>Jr,multiplyScalar:()=>gi,multiplyScalarAndAdd:()=>ar,rotate:()=>di,scale:()=>fi,set:()=>nr,str:()=>ti,sub:()=>Ti,subtract:()=>ri,translate:()=>ei});var p={};a.r(p),a.d(p,{add:()=>Vo,adjoint:()=>Mo,clone:()=>Ue,copy:()=>lt,create:()=>Pe,determinant:()=>Io,equals:()=>Yo,exactEquals:()=>Xo,frob:()=>Wo,fromMat2d:()=>jo,fromMat4:()=>De,fromQuat:()=>Uo,fromRotation:()=>Bo,fromScaling:()=>Do,fromTranslation:()=>zo,fromValues:()=>Et,identity:()=>Po,invert:()=>Lo,mul:()=>Zo,multiply:()=>Ns,multiplyScalar:()=>$o,multiplyScalarAndAdd:()=>Ho,normalFromMat4:()=>ko,projection:()=>Go,rotate:()=>Co,scale:()=>No,set:()=>wo,str:()=>qo,sub:()=>Ko,subtract:()=>zs,translate:()=>Fo,transpose:()=>Ro});var d={};a.r(d),a.d(d,{add:()=>Fu,adjoint:()=>au,clone:()=>Jo,copy:()=>eu,create:()=>Qo,determinant:()=>su,equals:()=>Bu,exactEquals:()=>zu,frob:()=>Iu,fromQuat:()=>Tu,fromQuat2:()=>gu,fromRotation:()=>pu,fromRotationTranslation:()=>js,fromRotationTranslationScale:()=>yu,fromRotationTranslationScaleOrigin:()=>Eu,fromScaling:()=>_u,fromTranslation:()=>fu,fromValues:()=>tu,fromXRotation:()=>vu,fromYRotation:()=>mu,fromZRotation:()=>bu,frustum:()=>xu,getRotation:()=>Gs,getScaling:()=>ks,getTranslation:()=>Us,identity:()=>Bs,invert:()=>nu,lookAt:()=>Ru,mul:()=>Du,multiply:()=>Ds,multiplyScalar:()=>Cu,multiplyScalarAndAdd:()=>Nu,ortho:()=>wu,orthoNO:()=>Ws,orthoZO:()=>Pu,perspective:()=>Su,perspectiveFromFieldOfView:()=>Ou,perspectiveNO:()=>qs,perspectiveZO:()=>Au,rotate:()=>lu,rotateX:()=>cu,rotateY:()=>hu,rotateZ:()=>du,scale:()=>uu,set:()=>ru,str:()=>Mu,sub:()=>ju,subtract:()=>Vs,targetTo:()=>Lu,translate:()=>ou,transpose:()=>iu});var f={};a.r(f),a.d(f,{add:()=>qu,angle:()=>w1,bezier:()=>g1,ceil:()=>Wu,clone:()=>Uu,copy:()=>ku,create:()=>xi,cross:()=>Zs,dist:()=>N1,distance:()=>Wl,div:()=>C1,divide:()=>Ys,dot:()=>$u,equals:()=>M1,exactEquals:()=>L1,floor:()=>Vu,forEach:()=>D1,fromValues:()=>Si,hermite:()=>b1,inverse:()=>v1,len:()=>Xl,length:()=>$s,lerp:()=>m1,max:()=>Qt,min:()=>Kt,mul:()=>F1,multiply:()=>Xs,negate:()=>p1,normalize:()=>Hl,random:()=>y1,rotateX:()=>S1,rotateY:()=>A1,rotateZ:()=>O1,round:()=>ct,scale:()=>wt,scaleAndAdd:()=>_1,set:()=>Gu,sqrDist:()=>z1,sqrLen:()=>B1,squaredDistance:()=>Vl,squaredLength:()=>$l,str:()=>R1,sub:()=>I1,subtract:()=>Hs,transformMat3:()=>T1,transformMat4:()=>E1,transformQuat:()=>x1,zero:()=>P1});var s={};a.r(s),a.d(s,{add:()=>ec,ceil:()=>j1,clone:()=>Zl,copy:()=>Ql,create:()=>Yl,cross:()=>H1,dist:()=>rp,distance:()=>ac,div:()=>tp,divide:()=>ic,dot:()=>uc,equals:()=>hc,exactEquals:()=>cc,floor:()=>U1,forEach:()=>sp,fromValues:()=>Kl,inverse:()=>$1,len:()=>np,length:()=>Hu,lerp:()=>lc,max:()=>G1,min:()=>k1,mul:()=>ep,multiply:()=>rc,negate:()=>V1,normalize:()=>oc,random:()=>X1,round:()=>q1,scale:()=>nc,scaleAndAdd:()=>W1,set:()=>Jl,sqrDist:()=>ip,sqrLen:()=>ap,squaredDistance:()=>sc,squaredLength:()=>Xu,str:()=>Q1,sub:()=>J1,subtract:()=>tc,transformMat4:()=>Y1,transformQuat:()=>Z1,zero:()=>K1});var o={};a.r(o),a.d(o,{add:()=>yp,calculateW:()=>cp,clone:()=>mp,conjugate:()=>_p,copy:()=>Ku,create:()=>Ks,dot:()=>Qu,equals:()=>Op,exactEquals:()=>Ap,exp:()=>mc,fromEuler:()=>pp,fromMat3:()=>gc,fromValues:()=>bp,getAngle:()=>lp,getAxisAngle:()=>up,identity:()=>op,invert:()=>fp,len:()=>xp,length:()=>Ju,lerp:()=>Tp,ln:()=>bc,mul:()=>Ep,multiply:()=>fc,normalize:()=>tl,pow:()=>hp,random:()=>dp,rotateX:()=>_c,rotateY:()=>pc,rotateZ:()=>vc,rotationTo:()=>wp,scale:()=>Tc,set:()=>gp,setAxes:()=>Rp,setAxisAngle:()=>dc,slerp:()=>Qs,sqlerp:()=>Pp,sqrLen:()=>Sp,squaredLength:()=>el,str:()=>vp});var u={};a.r(u),a.d(u,{add:()=>Kp,clone:()=>Mp,conjugate:()=>rv,copy:()=>Sc,create:()=>Lp,dot:()=>Oc,equals:()=>uv,exactEquals:()=>ov,fromMat4:()=>zp,fromRotation:()=>Np,fromRotationTranslation:()=>xc,fromRotationTranslationValues:()=>Fp,fromTranslation:()=>Cp,fromValues:()=>Ip,getDual:()=>Up,getReal:()=>jp,getTranslation:()=>qp,identity:()=>Bp,invert:()=>tv,len:()=>iv,length:()=>wc,lerp:()=>ev,mul:()=>Qp,multiply:()=>Ac,normalize:()=>av,rotateAroundAxis:()=>Zp,rotateByQuatAppend:()=>Xp,rotateByQuatPrepend:()=>Yp,rotateX:()=>Vp,rotateY:()=>$p,rotateZ:()=>Hp,scale:()=>Jp,set:()=>Dp,setDual:()=>Gp,setReal:()=>kp,sqrLen:()=>nv,squaredLength:()=>Js,str:()=>sv,translate:()=>Wp});var b={};a.r(b),a.d(b,{add:()=>fv,angle:()=>Fv,ceil:()=>_v,clone:()=>lv,copy:()=>hv,create:()=>Pc,cross:()=>Av,dist:()=>Gv,distance:()=>Ic,div:()=>kv,divide:()=>Mc,dot:()=>Sv,equals:()=>Bv,exactEquals:()=>zv,floor:()=>pv,forEach:()=>Vv,fromValues:()=>cv,inverse:()=>Tv,len:()=>Dv,length:()=>Cc,lerp:()=>Ov,max:()=>mv,min:()=>vv,mul:()=>Uv,multiply:()=>Lc,negate:()=>Ev,normalize:()=>xv,random:()=>wv,rotate:()=>Iv,round:()=>bv,scale:()=>gv,scaleAndAdd:()=>yv,set:()=>dv,sqrDist:()=>qv,sqrLen:()=>Wv,squaredDistance:()=>Fc,squaredLength:()=>Nc,str:()=>Nv,sub:()=>jv,subtract:()=>Rc,transformMat2:()=>Pv,transformMat2d:()=>Rv,transformMat3:()=>Lv,transformMat4:()=>Mv,zero:()=>Cv});var v=1e-6,_=typeof Float32Array<"u"?Float32Array:Array,g=Math.random;function x(e){_=e}var T=Math.PI/180;function O(e){return e*T}function A(e,c){return Math.abs(e-c)<=v*Math.max(1,Math.abs(e),Math.abs(c))}function R(){var e=new _(4);return _!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function P(e){var c=new _(4);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c}function C(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e}function U(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function j(e,c,S,w){var L=new _(4);return L[0]=e,L[1]=c,L[2]=S,L[3]=w,L}function k(e,c,S,w,L){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e}function $(e,c){if(e===c){var S=c[1];e[1]=c[2],e[2]=S}else e[0]=c[0],e[1]=c[2],e[2]=c[1],e[3]=c[3];return e}function Y(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=S*M-L*w;return I?(I=1/I,e[0]=M*I,e[1]=-w*I,e[2]=-L*I,e[3]=S*I,e):null}function Z(e,c){var S=c[0];return e[0]=c[3],e[1]=-c[1],e[2]=-c[2],e[3]=S,e}function J(e){return e[0]*e[3]-e[2]*e[1]}function te(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=S[0],z=S[1],B=S[2],D=S[3];return e[0]=w*F+M*z,e[1]=L*F+I*z,e[2]=w*B+M*D,e[3]=L*B+I*D,e}function Q(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=Math.sin(S),z=Math.cos(S);return e[0]=w*z+M*F,e[1]=L*z+I*F,e[2]=w*-F+M*z,e[3]=L*-F+I*z,e}function ie(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=S[0],z=S[1];return e[0]=w*F,e[1]=L*F,e[2]=M*z,e[3]=I*z,e}function ce(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=w,e[1]=S,e[2]=-S,e[3]=w,e}function de(e,c){return e[0]=c[0],e[1]=0,e[2]=0,e[3]=c[1],e}function me(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function xe(e){return Math.hypot(e[0],e[1],e[2],e[3])}function Ce(e,c,S,w){return e[2]=w[2]/w[0],S[0]=w[0],S[1]=w[1],S[3]=w[3]-e[2]*S[1],[e,c,S]}function se(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e}function we(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e[3]=c[3]-S[3],e}function Be(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]}function ot(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=c[0],F=c[1],z=c[2],B=c[3];return Math.abs(S-I)<=v*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(w-F)<=v*Math.max(1,Math.abs(w),Math.abs(F))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}function Qe(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e}function We(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e[3]=c[3]+S[3]*w,e}Math.hypot||(Math.hypot=function(){for(var e=0,c=arguments.length;c--;)e+=arguments[c]*arguments[c];return Math.sqrt(e)});var Ve=te,nt=we;function ir(){var e=new _(6);return _!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function ut(e){var c=new _(6);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c}function St(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[4]=c[4],e[5]=c[5],e}function At(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function yt(e,c,S,w,L,M){var I=new _(6);return I[0]=e,I[1]=c,I[2]=S,I[3]=w,I[4]=L,I[5]=M,I}function nr(e,c,S,w,L,M,I){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e[4]=M,e[5]=I,e}function hi(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=S*M-w*L;return z?(z=1/z,e[0]=M*z,e[1]=-w*z,e[2]=-L*z,e[3]=S*z,e[4]=(L*F-M*I)*z,e[5]=(w*I-S*F)*z,e):null}function Ot(e){return e[0]*e[3]-e[1]*e[2]}function Jr(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=S[0],D=S[1],G=S[2],q=S[3],W=S[4],H=S[5];return e[0]=w*B+M*D,e[1]=L*B+I*D,e[2]=w*G+M*q,e[3]=L*G+I*q,e[4]=w*W+M*H+F,e[5]=L*W+I*H+z,e}function di(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=Math.sin(S),D=Math.cos(S);return e[0]=w*D+M*B,e[1]=L*D+I*B,e[2]=w*-B+M*D,e[3]=L*-B+I*D,e[4]=F,e[5]=z,e}function fi(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=S[0],D=S[1];return e[0]=w*B,e[1]=L*B,e[2]=M*D,e[3]=I*D,e[4]=F,e[5]=z,e}function ei(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=S[0],D=S[1];return e[0]=w,e[1]=L,e[2]=M,e[3]=I,e[4]=w*B+M*D+F,e[5]=L*B+I*D+z,e}function _i(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=w,e[1]=S,e[2]=-S,e[3]=w,e[4]=0,e[5]=0,e}function pi(e,c){return e[0]=c[0],e[1]=0,e[2]=0,e[3]=c[1],e[4]=0,e[5]=0,e}function vi(e,c){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=c[0],e[5]=c[1],e}function ti(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function mi(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function bi(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e[4]=c[4]+S[4],e[5]=c[5]+S[5],e}function ri(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e[3]=c[3]-S[3],e[4]=c[4]-S[4],e[5]=c[5]-S[5],e}function gi(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e[4]=c[4]*S,e[5]=c[5]*S,e}function ar(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e[3]=c[3]+S[3]*w,e[4]=c[4]+S[4]*w,e[5]=c[5]+S[5]*w,e}function Zt(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]&&e[4]===c[4]&&e[5]===c[5]}function yi(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=c[0],B=c[1],D=c[2],G=c[3],q=c[4],W=c[5];return Math.abs(S-z)<=v*Math.max(1,Math.abs(S),Math.abs(z))&&Math.abs(w-B)<=v*Math.max(1,Math.abs(w),Math.abs(B))&&Math.abs(L-D)<=v*Math.max(1,Math.abs(L),Math.abs(D))&&Math.abs(M-G)<=v*Math.max(1,Math.abs(M),Math.abs(G))&&Math.abs(I-q)<=v*Math.max(1,Math.abs(I),Math.abs(q))&&Math.abs(F-W)<=v*Math.max(1,Math.abs(F),Math.abs(W))}var Ei=Jr,Ti=ri;function Pe(){var e=new _(9);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function De(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[4],e[4]=c[5],e[5]=c[6],e[6]=c[8],e[7]=c[9],e[8]=c[10],e}function Ue(e){var c=new _(9);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],c}function lt(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e[8]=c[8],e}function Et(e,c,S,w,L,M,I,F,z){var B=new _(9);return B[0]=e,B[1]=c,B[2]=S,B[3]=w,B[4]=L,B[5]=M,B[6]=I,B[7]=F,B[8]=z,B}function wo(e,c,S,w,L,M,I,F,z,B){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e[8]=B,e}function Po(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ro(e,c){if(e===c){var S=c[1],w=c[2],L=c[5];e[1]=c[3],e[2]=c[6],e[3]=S,e[5]=c[7],e[6]=w,e[7]=L}else e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8];return e}function Lo(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=c[6],B=c[7],D=c[8],G=D*I-F*B,q=-D*M+F*z,W=B*M-I*z,H=S*G+w*q+L*W;return H?(H=1/H,e[0]=G*H,e[1]=(-D*w+L*B)*H,e[2]=(F*w-L*I)*H,e[3]=q*H,e[4]=(D*S-L*z)*H,e[5]=(-F*S+L*M)*H,e[6]=W*H,e[7]=(-B*S+w*z)*H,e[8]=(I*S-w*M)*H,e):null}function Mo(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=c[6],B=c[7],D=c[8];return e[0]=I*D-F*B,e[1]=L*B-w*D,e[2]=w*F-L*I,e[3]=F*z-M*D,e[4]=S*D-L*z,e[5]=L*M-S*F,e[6]=M*B-I*z,e[7]=w*z-S*B,e[8]=S*I-w*M,e}function Io(e){var c=e[0],S=e[1],w=e[2],L=e[3],M=e[4],I=e[5],F=e[6],z=e[7],B=e[8];return c*(B*M-I*z)+S*(-B*L+I*F)+w*(z*L-M*F)}function Ns(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=c[8],q=S[0],W=S[1],H=S[2],X=S[3],V=S[4],K=S[5],oe=S[6],ne=S[7],ae=S[8];return e[0]=q*w+W*I+H*B,e[1]=q*L+W*F+H*D,e[2]=q*M+W*z+H*G,e[3]=X*w+V*I+K*B,e[4]=X*L+V*F+K*D,e[5]=X*M+V*z+K*G,e[6]=oe*w+ne*I+ae*B,e[7]=oe*L+ne*F+ae*D,e[8]=oe*M+ne*z+ae*G,e}function Fo(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=c[8],q=S[0],W=S[1];return e[0]=w,e[1]=L,e[2]=M,e[3]=I,e[4]=F,e[5]=z,e[6]=q*w+W*I+B,e[7]=q*L+W*F+D,e[8]=q*M+W*z+G,e}function Co(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=c[8],q=Math.sin(S),W=Math.cos(S);return e[0]=W*w+q*I,e[1]=W*L+q*F,e[2]=W*M+q*z,e[3]=W*I-q*w,e[4]=W*F-q*L,e[5]=W*z-q*M,e[6]=B,e[7]=D,e[8]=G,e}function No(e,c,S){var w=S[0],L=S[1];return e[0]=w*c[0],e[1]=w*c[1],e[2]=w*c[2],e[3]=L*c[3],e[4]=L*c[4],e[5]=L*c[5],e[6]=c[6],e[7]=c[7],e[8]=c[8],e}function zo(e,c){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=c[0],e[7]=c[1],e[8]=1,e}function Bo(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=w,e[1]=S,e[2]=0,e[3]=-S,e[4]=w,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Do(e,c){return e[0]=c[0],e[1]=0,e[2]=0,e[3]=0,e[4]=c[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function jo(e,c){return e[0]=c[0],e[1]=c[1],e[2]=0,e[3]=c[2],e[4]=c[3],e[5]=0,e[6]=c[4],e[7]=c[5],e[8]=1,e}function Uo(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=S+S,F=w+w,z=L+L,B=S*I,D=w*I,G=w*F,q=L*I,W=L*F,H=L*z,X=M*I,V=M*F,K=M*z;return e[0]=1-G-H,e[3]=D-K,e[6]=q+V,e[1]=D+K,e[4]=1-B-H,e[7]=W-X,e[2]=q-V,e[5]=W+X,e[8]=1-B-G,e}function ko(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=c[6],B=c[7],D=c[8],G=c[9],q=c[10],W=c[11],H=c[12],X=c[13],V=c[14],K=c[15],oe=S*F-w*I,ne=S*z-L*I,ae=S*B-M*I,he=w*z-L*F,ue=w*B-M*F,Ie=L*B-M*z,Le=D*X-G*H,Me=D*V-q*H,Se=D*K-W*H,Ne=G*V-q*X,be=G*K-W*X,ge=q*K-W*V,le=oe*ge-ne*be+ae*Ne+he*Se-ue*Me+Ie*Le;return le?(le=1/le,e[0]=(F*ge-z*be+B*Ne)*le,e[1]=(z*Se-I*ge-B*Me)*le,e[2]=(I*be-F*Se+B*Le)*le,e[3]=(L*be-w*ge-M*Ne)*le,e[4]=(S*ge-L*Se+M*Me)*le,e[5]=(w*Se-S*be-M*Le)*le,e[6]=(X*Ie-V*ue+K*he)*le,e[7]=(V*ae-H*Ie-K*ne)*le,e[8]=(H*ue-X*ae+K*oe)*le,e):null}function Go(e,c,S){return e[0]=2/c,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/S,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function qo(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Wo(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Vo(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e[4]=c[4]+S[4],e[5]=c[5]+S[5],e[6]=c[6]+S[6],e[7]=c[7]+S[7],e[8]=c[8]+S[8],e}function zs(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e[3]=c[3]-S[3],e[4]=c[4]-S[4],e[5]=c[5]-S[5],e[6]=c[6]-S[6],e[7]=c[7]-S[7],e[8]=c[8]-S[8],e}function $o(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e[4]=c[4]*S,e[5]=c[5]*S,e[6]=c[6]*S,e[7]=c[7]*S,e[8]=c[8]*S,e}function Ho(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e[3]=c[3]+S[3]*w,e[4]=c[4]+S[4]*w,e[5]=c[5]+S[5]*w,e[6]=c[6]+S[6]*w,e[7]=c[7]+S[7]*w,e[8]=c[8]+S[8]*w,e}function Xo(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]&&e[4]===c[4]&&e[5]===c[5]&&e[6]===c[6]&&e[7]===c[7]&&e[8]===c[8]}function Yo(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=e[8],G=c[0],q=c[1],W=c[2],H=c[3],X=c[4],V=c[5],K=c[6],oe=c[7],ne=c[8];return Math.abs(S-G)<=v*Math.max(1,Math.abs(S),Math.abs(G))&&Math.abs(w-q)<=v*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(L-W)<=v*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(M-H)<=v*Math.max(1,Math.abs(M),Math.abs(H))&&Math.abs(I-X)<=v*Math.max(1,Math.abs(I),Math.abs(X))&&Math.abs(F-V)<=v*Math.max(1,Math.abs(F),Math.abs(V))&&Math.abs(z-K)<=v*Math.max(1,Math.abs(z),Math.abs(K))&&Math.abs(B-oe)<=v*Math.max(1,Math.abs(B),Math.abs(oe))&&Math.abs(D-ne)<=v*Math.max(1,Math.abs(D),Math.abs(ne))}var Zo=Ns,Ko=zs;function Qo(){var e=new _(16);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Jo(e){var c=new _(16);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=e[11],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15],c}function eu(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e[8]=c[8],e[9]=c[9],e[10]=c[10],e[11]=c[11],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15],e}function tu(e,c,S,w,L,M,I,F,z,B,D,G,q,W,H,X){var V=new _(16);return V[0]=e,V[1]=c,V[2]=S,V[3]=w,V[4]=L,V[5]=M,V[6]=I,V[7]=F,V[8]=z,V[9]=B,V[10]=D,V[11]=G,V[12]=q,V[13]=W,V[14]=H,V[15]=X,V}function ru(e,c,S,w,L,M,I,F,z,B,D,G,q,W,H,X,V){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e[8]=B,e[9]=D,e[10]=G,e[11]=q,e[12]=W,e[13]=H,e[14]=X,e[15]=V,e}function Bs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function iu(e,c){if(e===c){var S=c[1],w=c[2],L=c[3],M=c[6],I=c[7],F=c[11];e[1]=c[4],e[2]=c[8],e[3]=c[12],e[4]=S,e[6]=c[9],e[7]=c[13],e[8]=w,e[9]=M,e[11]=c[14],e[12]=L,e[13]=I,e[14]=F}else e[0]=c[0],e[1]=c[4],e[2]=c[8],e[3]=c[12],e[4]=c[1],e[5]=c[5],e[6]=c[9],e[7]=c[13],e[8]=c[2],e[9]=c[6],e[10]=c[10],e[11]=c[14],e[12]=c[3],e[13]=c[7],e[14]=c[11],e[15]=c[15];return e}function nu(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=c[6],B=c[7],D=c[8],G=c[9],q=c[10],W=c[11],H=c[12],X=c[13],V=c[14],K=c[15],oe=S*F-w*I,ne=S*z-L*I,ae=S*B-M*I,he=w*z-L*F,ue=w*B-M*F,Ie=L*B-M*z,Le=D*X-G*H,Me=D*V-q*H,Se=D*K-W*H,Ne=G*V-q*X,be=G*K-W*X,ge=q*K-W*V,le=oe*ge-ne*be+ae*Ne+he*Se-ue*Me+Ie*Le;return le?(le=1/le,e[0]=(F*ge-z*be+B*Ne)*le,e[1]=(L*be-w*ge-M*Ne)*le,e[2]=(X*Ie-V*ue+K*he)*le,e[3]=(q*ue-G*Ie-W*he)*le,e[4]=(z*Se-I*ge-B*Me)*le,e[5]=(S*ge-L*Se+M*Me)*le,e[6]=(V*ae-H*Ie-K*ne)*le,e[7]=(D*Ie-q*ae+W*ne)*le,e[8]=(I*be-F*Se+B*Le)*le,e[9]=(w*Se-S*be-M*Le)*le,e[10]=(H*ue-X*ae+K*oe)*le,e[11]=(G*ae-D*ue-W*oe)*le,e[12]=(F*Me-I*Ne-z*Le)*le,e[13]=(S*Ne-w*Me+L*Le)*le,e[14]=(X*ne-H*he-V*oe)*le,e[15]=(D*he-G*ne+q*oe)*le,e):null}function au(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=c[4],F=c[5],z=c[6],B=c[7],D=c[8],G=c[9],q=c[10],W=c[11],H=c[12],X=c[13],V=c[14],K=c[15];return e[0]=F*(q*K-W*V)-G*(z*K-B*V)+X*(z*W-B*q),e[1]=-(w*(q*K-W*V)-G*(L*K-M*V)+X*(L*W-M*q)),e[2]=w*(z*K-B*V)-F*(L*K-M*V)+X*(L*B-M*z),e[3]=-(w*(z*W-B*q)-F*(L*W-M*q)+G*(L*B-M*z)),e[4]=-(I*(q*K-W*V)-D*(z*K-B*V)+H*(z*W-B*q)),e[5]=S*(q*K-W*V)-D*(L*K-M*V)+H*(L*W-M*q),e[6]=-(S*(z*K-B*V)-I*(L*K-M*V)+H*(L*B-M*z)),e[7]=S*(z*W-B*q)-I*(L*W-M*q)+D*(L*B-M*z),e[8]=I*(G*K-W*X)-D*(F*K-B*X)+H*(F*W-B*G),e[9]=-(S*(G*K-W*X)-D*(w*K-M*X)+H*(w*W-M*G)),e[10]=S*(F*K-B*X)-I*(w*K-M*X)+H*(w*B-M*F),e[11]=-(S*(F*W-B*G)-I*(w*W-M*G)+D*(w*B-M*F)),e[12]=-(I*(G*V-q*X)-D*(F*V-z*X)+H*(F*q-z*G)),e[13]=S*(G*V-q*X)-D*(w*V-L*X)+H*(w*q-L*G),e[14]=-(S*(F*V-z*X)-I*(w*V-L*X)+H*(w*z-L*F)),e[15]=S*(F*q-z*G)-I*(w*q-L*G)+D*(w*z-L*F),e}function su(e){var c=e[0],S=e[1],w=e[2],L=e[3],M=e[4],I=e[5],F=e[6],z=e[7],B=e[8],D=e[9],G=e[10],q=e[11],W=e[12],H=e[13],X=e[14],V=e[15];return(c*I-S*M)*(G*V-q*X)-(c*F-w*M)*(D*V-q*H)+(c*z-L*M)*(D*X-G*H)+(S*F-w*I)*(B*V-q*W)-(S*z-L*I)*(B*X-G*W)+(w*z-L*F)*(B*H-D*W)}function Ds(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=c[8],q=c[9],W=c[10],H=c[11],X=c[12],V=c[13],K=c[14],oe=c[15],ne=S[0],ae=S[1],he=S[2],ue=S[3];return e[0]=ne*w+ae*F+he*G+ue*X,e[1]=ne*L+ae*z+he*q+ue*V,e[2]=ne*M+ae*B+he*W+ue*K,e[3]=ne*I+ae*D+he*H+ue*oe,ne=S[4],ae=S[5],he=S[6],ue=S[7],e[4]=ne*w+ae*F+he*G+ue*X,e[5]=ne*L+ae*z+he*q+ue*V,e[6]=ne*M+ae*B+he*W+ue*K,e[7]=ne*I+ae*D+he*H+ue*oe,ne=S[8],ae=S[9],he=S[10],ue=S[11],e[8]=ne*w+ae*F+he*G+ue*X,e[9]=ne*L+ae*z+he*q+ue*V,e[10]=ne*M+ae*B+he*W+ue*K,e[11]=ne*I+ae*D+he*H+ue*oe,ne=S[12],ae=S[13],he=S[14],ue=S[15],e[12]=ne*w+ae*F+he*G+ue*X,e[13]=ne*L+ae*z+he*q+ue*V,e[14]=ne*M+ae*B+he*W+ue*K,e[15]=ne*I+ae*D+he*H+ue*oe,e}function ou(e,c,S){var w,L,M,I,F,z,B,D,G,q,W,H,X=S[0],V=S[1],K=S[2];return c===e?(e[12]=c[0]*X+c[4]*V+c[8]*K+c[12],e[13]=c[1]*X+c[5]*V+c[9]*K+c[13],e[14]=c[2]*X+c[6]*V+c[10]*K+c[14],e[15]=c[3]*X+c[7]*V+c[11]*K+c[15]):(w=c[0],L=c[1],M=c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=c[8],q=c[9],W=c[10],H=c[11],e[0]=w,e[1]=L,e[2]=M,e[3]=I,e[4]=F,e[5]=z,e[6]=B,e[7]=D,e[8]=G,e[9]=q,e[10]=W,e[11]=H,e[12]=w*X+F*V+G*K+c[12],e[13]=L*X+z*V+q*K+c[13],e[14]=M*X+B*V+W*K+c[14],e[15]=I*X+D*V+H*K+c[15]),e}function uu(e,c,S){var w=S[0],L=S[1],M=S[2];return e[0]=c[0]*w,e[1]=c[1]*w,e[2]=c[2]*w,e[3]=c[3]*w,e[4]=c[4]*L,e[5]=c[5]*L,e[6]=c[6]*L,e[7]=c[7]*L,e[8]=c[8]*M,e[9]=c[9]*M,e[10]=c[10]*M,e[11]=c[11]*M,e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15],e}function lu(e,c,S,w){var L,M,I,F,z,B,D,G,q,W,H,X,V,K,oe,ne,ae,he,ue,Ie,Le,Me,Se,Ne,be=w[0],ge=w[1],le=w[2],ft=Math.hypot(be,ge,le);return ft<v?null:(be*=ft=1/ft,ge*=ft,le*=ft,L=Math.sin(S),I=1-(M=Math.cos(S)),F=c[0],z=c[1],B=c[2],D=c[3],G=c[4],q=c[5],W=c[6],H=c[7],X=c[8],V=c[9],K=c[10],oe=c[11],ne=be*be*I+M,ae=ge*be*I+le*L,he=le*be*I-ge*L,ue=be*ge*I-le*L,Ie=ge*ge*I+M,Le=le*ge*I+be*L,Me=be*le*I+ge*L,Se=ge*le*I-be*L,Ne=le*le*I+M,e[0]=F*ne+G*ae+X*he,e[1]=z*ne+q*ae+V*he,e[2]=B*ne+W*ae+K*he,e[3]=D*ne+H*ae+oe*he,e[4]=F*ue+G*Ie+X*Le,e[5]=z*ue+q*Ie+V*Le,e[6]=B*ue+W*Ie+K*Le,e[7]=D*ue+H*Ie+oe*Le,e[8]=F*Me+G*Se+X*Ne,e[9]=z*Me+q*Se+V*Ne,e[10]=B*Me+W*Se+K*Ne,e[11]=D*Me+H*Se+oe*Ne,c!==e&&(e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e)}function cu(e,c,S){var w=Math.sin(S),L=Math.cos(S),M=c[4],I=c[5],F=c[6],z=c[7],B=c[8],D=c[9],G=c[10],q=c[11];return c!==e&&(e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[4]=M*L+B*w,e[5]=I*L+D*w,e[6]=F*L+G*w,e[7]=z*L+q*w,e[8]=B*L-M*w,e[9]=D*L-I*w,e[10]=G*L-F*w,e[11]=q*L-z*w,e}function hu(e,c,S){var w=Math.sin(S),L=Math.cos(S),M=c[0],I=c[1],F=c[2],z=c[3],B=c[8],D=c[9],G=c[10],q=c[11];return c!==e&&(e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[0]=M*L-B*w,e[1]=I*L-D*w,e[2]=F*L-G*w,e[3]=z*L-q*w,e[8]=M*w+B*L,e[9]=I*w+D*L,e[10]=F*w+G*L,e[11]=z*w+q*L,e}function du(e,c,S){var w=Math.sin(S),L=Math.cos(S),M=c[0],I=c[1],F=c[2],z=c[3],B=c[4],D=c[5],G=c[6],q=c[7];return c!==e&&(e[8]=c[8],e[9]=c[9],e[10]=c[10],e[11]=c[11],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[0]=M*L+B*w,e[1]=I*L+D*w,e[2]=F*L+G*w,e[3]=z*L+q*w,e[4]=B*L-M*w,e[5]=D*L-I*w,e[6]=G*L-F*w,e[7]=q*L-z*w,e}function fu(e,c){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=c[0],e[13]=c[1],e[14]=c[2],e[15]=1,e}function _u(e,c){return e[0]=c[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pu(e,c,S){var w,L,M,I=S[0],F=S[1],z=S[2],B=Math.hypot(I,F,z);return B<v?null:(I*=B=1/B,F*=B,z*=B,w=Math.sin(c),M=1-(L=Math.cos(c)),e[0]=I*I*M+L,e[1]=F*I*M+z*w,e[2]=z*I*M-F*w,e[3]=0,e[4]=I*F*M-z*w,e[5]=F*F*M+L,e[6]=z*F*M+I*w,e[7]=0,e[8]=I*z*M+F*w,e[9]=F*z*M-I*w,e[10]=z*z*M+L,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function vu(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=w,e[6]=S,e[7]=0,e[8]=0,e[9]=-S,e[10]=w,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mu(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=w,e[1]=0,e[2]=-S,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=S,e[9]=0,e[10]=w,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bu(e,c){var S=Math.sin(c),w=Math.cos(c);return e[0]=w,e[1]=S,e[2]=0,e[3]=0,e[4]=-S,e[5]=w,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function js(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=w+w,z=L+L,B=M+M,D=w*F,G=w*z,q=w*B,W=L*z,H=L*B,X=M*B,V=I*F,K=I*z,oe=I*B;return e[0]=1-(W+X),e[1]=G+oe,e[2]=q-K,e[3]=0,e[4]=G-oe,e[5]=1-(D+X),e[6]=H+V,e[7]=0,e[8]=q+K,e[9]=H-V,e[10]=1-(D+W),e[11]=0,e[12]=S[0],e[13]=S[1],e[14]=S[2],e[15]=1,e}function gu(e,c){var S=new _(3),w=-c[0],L=-c[1],M=-c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=w*w+L*L+M*M+I*I;return G>0?(S[0]=2*(F*I+D*w+z*M-B*L)/G,S[1]=2*(z*I+D*L+B*w-F*M)/G,S[2]=2*(B*I+D*M+F*L-z*w)/G):(S[0]=2*(F*I+D*w+z*M-B*L),S[1]=2*(z*I+D*L+B*w-F*M),S[2]=2*(B*I+D*M+F*L-z*w)),js(e,c,S),e}function Us(e,c){return e[0]=c[12],e[1]=c[13],e[2]=c[14],e}function ks(e,c){var S=c[0],w=c[1],L=c[2],M=c[4],I=c[5],F=c[6],z=c[8],B=c[9],D=c[10];return e[0]=Math.hypot(S,w,L),e[1]=Math.hypot(M,I,F),e[2]=Math.hypot(z,B,D),e}function Gs(e,c){var S=new _(3);ks(S,c);var w=1/S[0],L=1/S[1],M=1/S[2],I=c[0]*w,F=c[1]*L,z=c[2]*M,B=c[4]*w,D=c[5]*L,G=c[6]*M,q=c[8]*w,W=c[9]*L,H=c[10]*M,X=I+D+H,V=0;return X>0?(V=2*Math.sqrt(X+1),e[3]=.25*V,e[0]=(G-W)/V,e[1]=(q-z)/V,e[2]=(F-B)/V):I>D&&I>H?(V=2*Math.sqrt(1+I-D-H),e[3]=(G-W)/V,e[0]=.25*V,e[1]=(F+B)/V,e[2]=(q+z)/V):D>H?(V=2*Math.sqrt(1+D-I-H),e[3]=(q-z)/V,e[0]=(F+B)/V,e[1]=.25*V,e[2]=(G+W)/V):(V=2*Math.sqrt(1+H-I-D),e[3]=(F-B)/V,e[0]=(q+z)/V,e[1]=(G+W)/V,e[2]=.25*V),e}function yu(e,c,S,w){var L=c[0],M=c[1],I=c[2],F=c[3],z=L+L,B=M+M,D=I+I,G=L*z,q=L*B,W=L*D,H=M*B,X=M*D,V=I*D,K=F*z,oe=F*B,ne=F*D,ae=w[0],he=w[1],ue=w[2];return e[0]=(1-(H+V))*ae,e[1]=(q+ne)*ae,e[2]=(W-oe)*ae,e[3]=0,e[4]=(q-ne)*he,e[5]=(1-(G+V))*he,e[6]=(X+K)*he,e[7]=0,e[8]=(W+oe)*ue,e[9]=(X-K)*ue,e[10]=(1-(G+H))*ue,e[11]=0,e[12]=S[0],e[13]=S[1],e[14]=S[2],e[15]=1,e}function Eu(e,c,S,w,L){var M=c[0],I=c[1],F=c[2],z=c[3],B=M+M,D=I+I,G=F+F,q=M*B,W=M*D,H=M*G,X=I*D,V=I*G,K=F*G,oe=z*B,ne=z*D,ae=z*G,he=w[0],ue=w[1],Ie=w[2],Le=L[0],Me=L[1],Se=L[2],Ne=(1-(X+K))*he,be=(W+ae)*he,ge=(H-ne)*he,le=(W-ae)*ue,ft=(1-(q+K))*ue,Ai=(V+oe)*ue,Oi=(H+ne)*Ie,zc=(V-oe)*Ie,Bc=(1-(q+X))*Ie;return e[0]=Ne,e[1]=be,e[2]=ge,e[3]=0,e[4]=le,e[5]=ft,e[6]=Ai,e[7]=0,e[8]=Oi,e[9]=zc,e[10]=Bc,e[11]=0,e[12]=S[0]+Le-(Ne*Le+le*Me+Oi*Se),e[13]=S[1]+Me-(be*Le+ft*Me+zc*Se),e[14]=S[2]+Se-(ge*Le+Ai*Me+Bc*Se),e[15]=1,e}function Tu(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=S+S,F=w+w,z=L+L,B=S*I,D=w*I,G=w*F,q=L*I,W=L*F,H=L*z,X=M*I,V=M*F,K=M*z;return e[0]=1-G-H,e[1]=D+K,e[2]=q-V,e[3]=0,e[4]=D-K,e[5]=1-B-H,e[6]=W+X,e[7]=0,e[8]=q+V,e[9]=W-X,e[10]=1-B-G,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xu(e,c,S,w,L,M,I){var F=1/(S-c),z=1/(L-w),B=1/(M-I);return e[0]=2*M*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*M*z,e[6]=0,e[7]=0,e[8]=(S+c)*F,e[9]=(L+w)*z,e[10]=(I+M)*B,e[11]=-1,e[12]=0,e[13]=0,e[14]=I*M*2*B,e[15]=0,e}function qs(e,c,S,w,L){var M,I=1/Math.tan(c/2);return e[0]=I/S,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(w-L),e[10]=(L+w)*M,e[14]=2*L*w*M):(e[10]=-1,e[14]=-2*w),e}var Su=qs;function Au(e,c,S,w,L){var M,I=1/Math.tan(c/2);return e[0]=I/S,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(w-L),e[10]=L*M,e[14]=L*w*M):(e[10]=-1,e[14]=-w),e}function Ou(e,c,S,w){var L=Math.tan(c.upDegrees*Math.PI/180),M=Math.tan(c.downDegrees*Math.PI/180),I=Math.tan(c.leftDegrees*Math.PI/180),F=Math.tan(c.rightDegrees*Math.PI/180),z=2/(I+F),B=2/(L+M);return e[0]=z,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=B,e[6]=0,e[7]=0,e[8]=-(I-F)*z*.5,e[9]=(L-M)*B*.5,e[10]=w/(S-w),e[11]=-1,e[12]=0,e[13]=0,e[14]=w*S/(S-w),e[15]=0,e}function Ws(e,c,S,w,L,M,I){var F=1/(c-S),z=1/(w-L),B=1/(M-I);return e[0]=-2*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*B,e[11]=0,e[12]=(c+S)*F,e[13]=(L+w)*z,e[14]=(I+M)*B,e[15]=1,e}var wu=Ws;function Pu(e,c,S,w,L,M,I){var F=1/(c-S),z=1/(w-L),B=1/(M-I);return e[0]=-2*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=B,e[11]=0,e[12]=(c+S)*F,e[13]=(L+w)*z,e[14]=M*B,e[15]=1,e}function Ru(e,c,S,w){var L,M,I,F,z,B,D,G,q,W,H=c[0],X=c[1],V=c[2],K=w[0],oe=w[1],ne=w[2],ae=S[0],he=S[1],ue=S[2];return Math.abs(H-ae)<v&&Math.abs(X-he)<v&&Math.abs(V-ue)<v?Bs(e):(D=H-ae,G=X-he,q=V-ue,L=oe*(q*=W=1/Math.hypot(D,G,q))-ne*(G*=W),M=ne*(D*=W)-K*q,I=K*G-oe*D,(W=Math.hypot(L,M,I))?(L*=W=1/W,M*=W,I*=W):(L=0,M=0,I=0),F=G*I-q*M,z=q*L-D*I,B=D*M-G*L,(W=Math.hypot(F,z,B))?(F*=W=1/W,z*=W,B*=W):(F=0,z=0,B=0),e[0]=L,e[1]=F,e[2]=D,e[3]=0,e[4]=M,e[5]=z,e[6]=G,e[7]=0,e[8]=I,e[9]=B,e[10]=q,e[11]=0,e[12]=-(L*H+M*X+I*V),e[13]=-(F*H+z*X+B*V),e[14]=-(D*H+G*X+q*V),e[15]=1,e)}function Lu(e,c,S,w){var L=c[0],M=c[1],I=c[2],F=w[0],z=w[1],B=w[2],D=L-S[0],G=M-S[1],q=I-S[2],W=D*D+G*G+q*q;W>0&&(D*=W=1/Math.sqrt(W),G*=W,q*=W);var H=z*q-B*G,X=B*D-F*q,V=F*G-z*D;return(W=H*H+X*X+V*V)>0&&(H*=W=1/Math.sqrt(W),X*=W,V*=W),e[0]=H,e[1]=X,e[2]=V,e[3]=0,e[4]=G*V-q*X,e[5]=q*H-D*V,e[6]=D*X-G*H,e[7]=0,e[8]=D,e[9]=G,e[10]=q,e[11]=0,e[12]=L,e[13]=M,e[14]=I,e[15]=1,e}function Mu(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Iu(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Fu(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e[4]=c[4]+S[4],e[5]=c[5]+S[5],e[6]=c[6]+S[6],e[7]=c[7]+S[7],e[8]=c[8]+S[8],e[9]=c[9]+S[9],e[10]=c[10]+S[10],e[11]=c[11]+S[11],e[12]=c[12]+S[12],e[13]=c[13]+S[13],e[14]=c[14]+S[14],e[15]=c[15]+S[15],e}function Vs(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e[3]=c[3]-S[3],e[4]=c[4]-S[4],e[5]=c[5]-S[5],e[6]=c[6]-S[6],e[7]=c[7]-S[7],e[8]=c[8]-S[8],e[9]=c[9]-S[9],e[10]=c[10]-S[10],e[11]=c[11]-S[11],e[12]=c[12]-S[12],e[13]=c[13]-S[13],e[14]=c[14]-S[14],e[15]=c[15]-S[15],e}function Cu(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e[4]=c[4]*S,e[5]=c[5]*S,e[6]=c[6]*S,e[7]=c[7]*S,e[8]=c[8]*S,e[9]=c[9]*S,e[10]=c[10]*S,e[11]=c[11]*S,e[12]=c[12]*S,e[13]=c[13]*S,e[14]=c[14]*S,e[15]=c[15]*S,e}function Nu(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e[3]=c[3]+S[3]*w,e[4]=c[4]+S[4]*w,e[5]=c[5]+S[5]*w,e[6]=c[6]+S[6]*w,e[7]=c[7]+S[7]*w,e[8]=c[8]+S[8]*w,e[9]=c[9]+S[9]*w,e[10]=c[10]+S[10]*w,e[11]=c[11]+S[11]*w,e[12]=c[12]+S[12]*w,e[13]=c[13]+S[13]*w,e[14]=c[14]+S[14]*w,e[15]=c[15]+S[15]*w,e}function zu(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]&&e[4]===c[4]&&e[5]===c[5]&&e[6]===c[6]&&e[7]===c[7]&&e[8]===c[8]&&e[9]===c[9]&&e[10]===c[10]&&e[11]===c[11]&&e[12]===c[12]&&e[13]===c[13]&&e[14]===c[14]&&e[15]===c[15]}function Bu(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=e[8],G=e[9],q=e[10],W=e[11],H=e[12],X=e[13],V=e[14],K=e[15],oe=c[0],ne=c[1],ae=c[2],he=c[3],ue=c[4],Ie=c[5],Le=c[6],Me=c[7],Se=c[8],Ne=c[9],be=c[10],ge=c[11],le=c[12],ft=c[13],Ai=c[14],Oi=c[15];return Math.abs(S-oe)<=v*Math.max(1,Math.abs(S),Math.abs(oe))&&Math.abs(w-ne)<=v*Math.max(1,Math.abs(w),Math.abs(ne))&&Math.abs(L-ae)<=v*Math.max(1,Math.abs(L),Math.abs(ae))&&Math.abs(M-he)<=v*Math.max(1,Math.abs(M),Math.abs(he))&&Math.abs(I-ue)<=v*Math.max(1,Math.abs(I),Math.abs(ue))&&Math.abs(F-Ie)<=v*Math.max(1,Math.abs(F),Math.abs(Ie))&&Math.abs(z-Le)<=v*Math.max(1,Math.abs(z),Math.abs(Le))&&Math.abs(B-Me)<=v*Math.max(1,Math.abs(B),Math.abs(Me))&&Math.abs(D-Se)<=v*Math.max(1,Math.abs(D),Math.abs(Se))&&Math.abs(G-Ne)<=v*Math.max(1,Math.abs(G),Math.abs(Ne))&&Math.abs(q-be)<=v*Math.max(1,Math.abs(q),Math.abs(be))&&Math.abs(W-ge)<=v*Math.max(1,Math.abs(W),Math.abs(ge))&&Math.abs(H-le)<=v*Math.max(1,Math.abs(H),Math.abs(le))&&Math.abs(X-ft)<=v*Math.max(1,Math.abs(X),Math.abs(ft))&&Math.abs(V-Ai)<=v*Math.max(1,Math.abs(V),Math.abs(Ai))&&Math.abs(K-Oi)<=v*Math.max(1,Math.abs(K),Math.abs(Oi))}var Du=Ds,ju=Vs;function xi(){var e=new _(3);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Uu(e){var c=new _(3);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c}function $s(e){var c=e[0],S=e[1],w=e[2];return Math.hypot(c,S,w)}function Si(e,c,S){var w=new _(3);return w[0]=e,w[1]=c,w[2]=S,w}function ku(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e}function Gu(e,c,S,w){return e[0]=c,e[1]=S,e[2]=w,e}function qu(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e}function Hs(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e}function Xs(e,c,S){return e[0]=c[0]*S[0],e[1]=c[1]*S[1],e[2]=c[2]*S[2],e}function Ys(e,c,S){return e[0]=c[0]/S[0],e[1]=c[1]/S[1],e[2]=c[2]/S[2],e}function Wu(e,c){return e[0]=Math.ceil(c[0]),e[1]=Math.ceil(c[1]),e[2]=Math.ceil(c[2]),e}function Vu(e,c){return e[0]=Math.floor(c[0]),e[1]=Math.floor(c[1]),e[2]=Math.floor(c[2]),e}function Kt(e,c,S){return e[0]=Math.min(c[0],S[0]),e[1]=Math.min(c[1],S[1]),e[2]=Math.min(c[2],S[2]),e}function Qt(e,c,S){return e[0]=Math.max(c[0],S[0]),e[1]=Math.max(c[1],S[1]),e[2]=Math.max(c[2],S[2]),e}function ct(e,c){return e[0]=Math.round(c[0]),e[1]=Math.round(c[1]),e[2]=Math.round(c[2]),e}function wt(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e}function _1(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e}function Wl(e,c){var S=c[0]-e[0],w=c[1]-e[1],L=c[2]-e[2];return Math.hypot(S,w,L)}function Vl(e,c){var S=c[0]-e[0],w=c[1]-e[1],L=c[2]-e[2];return S*S+w*w+L*L}function $l(e){var c=e[0],S=e[1],w=e[2];return c*c+S*S+w*w}function p1(e,c){return e[0]=-c[0],e[1]=-c[1],e[2]=-c[2],e}function v1(e,c){return e[0]=1/c[0],e[1]=1/c[1],e[2]=1/c[2],e}function Hl(e,c){var S=c[0],w=c[1],L=c[2],M=S*S+w*w+L*L;return M>0&&(M=1/Math.sqrt(M)),e[0]=c[0]*M,e[1]=c[1]*M,e[2]=c[2]*M,e}function $u(e,c){return e[0]*c[0]+e[1]*c[1]+e[2]*c[2]}function Zs(e,c,S){var w=c[0],L=c[1],M=c[2],I=S[0],F=S[1],z=S[2];return e[0]=L*z-M*F,e[1]=M*I-w*z,e[2]=w*F-L*I,e}function m1(e,c,S,w){var L=c[0],M=c[1],I=c[2];return e[0]=L+w*(S[0]-L),e[1]=M+w*(S[1]-M),e[2]=I+w*(S[2]-I),e}function b1(e,c,S,w,L,M){var I=M*M,F=I*(2*M-3)+1,z=I*(M-2)+M,B=I*(M-1),D=I*(3-2*M);return e[0]=c[0]*F+S[0]*z+w[0]*B+L[0]*D,e[1]=c[1]*F+S[1]*z+w[1]*B+L[1]*D,e[2]=c[2]*F+S[2]*z+w[2]*B+L[2]*D,e}function g1(e,c,S,w,L,M){var I=1-M,F=I*I,z=M*M,B=F*I,D=3*M*F,G=3*z*I,q=z*M;return e[0]=c[0]*B+S[0]*D+w[0]*G+L[0]*q,e[1]=c[1]*B+S[1]*D+w[1]*G+L[1]*q,e[2]=c[2]*B+S[2]*D+w[2]*G+L[2]*q,e}function y1(e,c){c=c||1;var S=2*g()*Math.PI,w=2*g()-1,L=Math.sqrt(1-w*w)*c;return e[0]=Math.cos(S)*L,e[1]=Math.sin(S)*L,e[2]=w*c,e}function E1(e,c,S){var w=c[0],L=c[1],M=c[2],I=S[3]*w+S[7]*L+S[11]*M+S[15];return I=I||1,e[0]=(S[0]*w+S[4]*L+S[8]*M+S[12])/I,e[1]=(S[1]*w+S[5]*L+S[9]*M+S[13])/I,e[2]=(S[2]*w+S[6]*L+S[10]*M+S[14])/I,e}function T1(e,c,S){var w=c[0],L=c[1],M=c[2];return e[0]=w*S[0]+L*S[3]+M*S[6],e[1]=w*S[1]+L*S[4]+M*S[7],e[2]=w*S[2]+L*S[5]+M*S[8],e}function x1(e,c,S){var w=S[0],L=S[1],M=S[2],I=S[3],F=c[0],z=c[1],B=c[2],D=L*B-M*z,G=M*F-w*B,q=w*z-L*F,W=L*q-M*G,H=M*D-w*q,X=w*G-L*D,V=2*I;return D*=V,G*=V,q*=V,W*=2,H*=2,X*=2,e[0]=F+D+W,e[1]=z+G+H,e[2]=B+q+X,e}function S1(e,c,S,w){var L=[],M=[];return L[0]=c[0]-S[0],L[1]=c[1]-S[1],L[2]=c[2]-S[2],M[0]=L[0],M[1]=L[1]*Math.cos(w)-L[2]*Math.sin(w),M[2]=L[1]*Math.sin(w)+L[2]*Math.cos(w),e[0]=M[0]+S[0],e[1]=M[1]+S[1],e[2]=M[2]+S[2],e}function A1(e,c,S,w){var L=[],M=[];return L[0]=c[0]-S[0],L[1]=c[1]-S[1],L[2]=c[2]-S[2],M[0]=L[2]*Math.sin(w)+L[0]*Math.cos(w),M[1]=L[1],M[2]=L[2]*Math.cos(w)-L[0]*Math.sin(w),e[0]=M[0]+S[0],e[1]=M[1]+S[1],e[2]=M[2]+S[2],e}function O1(e,c,S,w){var L=[],M=[];return L[0]=c[0]-S[0],L[1]=c[1]-S[1],L[2]=c[2]-S[2],M[0]=L[0]*Math.cos(w)-L[1]*Math.sin(w),M[1]=L[0]*Math.sin(w)+L[1]*Math.cos(w),M[2]=L[2],e[0]=M[0]+S[0],e[1]=M[1]+S[1],e[2]=M[2]+S[2],e}function w1(e,c){var S=e[0],w=e[1],L=e[2],M=c[0],I=c[1],F=c[2],z=Math.sqrt(S*S+w*w+L*L)*Math.sqrt(M*M+I*I+F*F),B=z&&$u(e,c)/z;return Math.acos(Math.min(Math.max(B,-1),1))}function P1(e){return e[0]=0,e[1]=0,e[2]=0,e}function R1(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function L1(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]}function M1(e,c){var S=e[0],w=e[1],L=e[2],M=c[0],I=c[1],F=c[2];return Math.abs(S-M)<=v*Math.max(1,Math.abs(S),Math.abs(M))&&Math.abs(w-I)<=v*Math.max(1,Math.abs(w),Math.abs(I))&&Math.abs(L-F)<=v*Math.max(1,Math.abs(L),Math.abs(F))}var Pt,I1=Hs,F1=Xs,C1=Ys,N1=Wl,z1=Vl,Xl=$s,B1=$l,D1=(Pt=xi(),function(e,c,S,w,L,M){var I,F;for(c||(c=3),S||(S=0),F=w?Math.min(w*c+S,e.length):e.length,I=S;I<F;I+=c)Pt[0]=e[I],Pt[1]=e[I+1],Pt[2]=e[I+2],L(Pt,Pt,M),e[I]=Pt[0],e[I+1]=Pt[1],e[I+2]=Pt[2];return e});function Yl(){var e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Zl(e){var c=new _(4);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c}function Kl(e,c,S,w){var L=new _(4);return L[0]=e,L[1]=c,L[2]=S,L[3]=w,L}function Ql(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e}function Jl(e,c,S,w,L){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e}function ec(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e}function tc(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e[2]=c[2]-S[2],e[3]=c[3]-S[3],e}function rc(e,c,S){return e[0]=c[0]*S[0],e[1]=c[1]*S[1],e[2]=c[2]*S[2],e[3]=c[3]*S[3],e}function ic(e,c,S){return e[0]=c[0]/S[0],e[1]=c[1]/S[1],e[2]=c[2]/S[2],e[3]=c[3]/S[3],e}function j1(e,c){return e[0]=Math.ceil(c[0]),e[1]=Math.ceil(c[1]),e[2]=Math.ceil(c[2]),e[3]=Math.ceil(c[3]),e}function U1(e,c){return e[0]=Math.floor(c[0]),e[1]=Math.floor(c[1]),e[2]=Math.floor(c[2]),e[3]=Math.floor(c[3]),e}function k1(e,c,S){return e[0]=Math.min(c[0],S[0]),e[1]=Math.min(c[1],S[1]),e[2]=Math.min(c[2],S[2]),e[3]=Math.min(c[3],S[3]),e}function G1(e,c,S){return e[0]=Math.max(c[0],S[0]),e[1]=Math.max(c[1],S[1]),e[2]=Math.max(c[2],S[2]),e[3]=Math.max(c[3],S[3]),e}function q1(e,c){return e[0]=Math.round(c[0]),e[1]=Math.round(c[1]),e[2]=Math.round(c[2]),e[3]=Math.round(c[3]),e}function nc(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e}function W1(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e[2]=c[2]+S[2]*w,e[3]=c[3]+S[3]*w,e}function ac(e,c){var S=c[0]-e[0],w=c[1]-e[1],L=c[2]-e[2],M=c[3]-e[3];return Math.hypot(S,w,L,M)}function sc(e,c){var S=c[0]-e[0],w=c[1]-e[1],L=c[2]-e[2],M=c[3]-e[3];return S*S+w*w+L*L+M*M}function Hu(e){var c=e[0],S=e[1],w=e[2],L=e[3];return Math.hypot(c,S,w,L)}function Xu(e){var c=e[0],S=e[1],w=e[2],L=e[3];return c*c+S*S+w*w+L*L}function V1(e,c){return e[0]=-c[0],e[1]=-c[1],e[2]=-c[2],e[3]=-c[3],e}function $1(e,c){return e[0]=1/c[0],e[1]=1/c[1],e[2]=1/c[2],e[3]=1/c[3],e}function oc(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=S*S+w*w+L*L+M*M;return I>0&&(I=1/Math.sqrt(I)),e[0]=S*I,e[1]=w*I,e[2]=L*I,e[3]=M*I,e}function uc(e,c){return e[0]*c[0]+e[1]*c[1]+e[2]*c[2]+e[3]*c[3]}function H1(e,c,S,w){var L=S[0]*w[1]-S[1]*w[0],M=S[0]*w[2]-S[2]*w[0],I=S[0]*w[3]-S[3]*w[0],F=S[1]*w[2]-S[2]*w[1],z=S[1]*w[3]-S[3]*w[1],B=S[2]*w[3]-S[3]*w[2],D=c[0],G=c[1],q=c[2],W=c[3];return e[0]=G*B-q*z+W*F,e[1]=-D*B+q*I-W*M,e[2]=D*z-G*I+W*L,e[3]=-D*F+G*M-q*L,e}function lc(e,c,S,w){var L=c[0],M=c[1],I=c[2],F=c[3];return e[0]=L+w*(S[0]-L),e[1]=M+w*(S[1]-M),e[2]=I+w*(S[2]-I),e[3]=F+w*(S[3]-F),e}function X1(e,c){var S,w,L,M,I,F;c=c||1;do I=(S=2*g()-1)*S+(w=2*g()-1)*w;while(I>=1);do F=(L=2*g()-1)*L+(M=2*g()-1)*M;while(F>=1);var z=Math.sqrt((1-I)/F);return e[0]=c*S,e[1]=c*w,e[2]=c*L*z,e[3]=c*M*z,e}function Y1(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3];return e[0]=S[0]*w+S[4]*L+S[8]*M+S[12]*I,e[1]=S[1]*w+S[5]*L+S[9]*M+S[13]*I,e[2]=S[2]*w+S[6]*L+S[10]*M+S[14]*I,e[3]=S[3]*w+S[7]*L+S[11]*M+S[15]*I,e}function Z1(e,c,S){var w=c[0],L=c[1],M=c[2],I=S[0],F=S[1],z=S[2],B=S[3],D=B*w+F*M-z*L,G=B*L+z*w-I*M,q=B*M+I*L-F*w,W=-I*w-F*L-z*M;return e[0]=D*B+W*-I+G*-z-q*-F,e[1]=G*B+W*-F+q*-I-D*-z,e[2]=q*B+W*-z+D*-F-G*-I,e[3]=c[3],e}function K1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Q1(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function cc(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]}function hc(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=c[0],F=c[1],z=c[2],B=c[3];return Math.abs(S-I)<=v*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(w-F)<=v*Math.max(1,Math.abs(w),Math.abs(F))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}var J1=tc,ep=rc,tp=ic,rp=ac,ip=sc,np=Hu,ap=Xu,sp=function(){var e=Yl();return function(c,S,w,L,M,I){var F,z;for(S||(S=4),w||(w=0),z=L?Math.min(L*S+w,c.length):c.length,F=w;F<z;F+=S)e[0]=c[F],e[1]=c[F+1],e[2]=c[F+2],e[3]=c[F+3],M(e,e,I),c[F]=e[0],c[F+1]=e[1],c[F+2]=e[2],c[F+3]=e[3];return c}}();function Ks(){var e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function op(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function dc(e,c,S){S*=.5;var w=Math.sin(S);return e[0]=w*c[0],e[1]=w*c[1],e[2]=w*c[2],e[3]=Math.cos(S),e}function up(e,c){var S=2*Math.acos(c[3]),w=Math.sin(S/2);return w>v?(e[0]=c[0]/w,e[1]=c[1]/w,e[2]=c[2]/w):(e[0]=1,e[1]=0,e[2]=0),S}function lp(e,c){var S=Qu(e,c);return Math.acos(2*S*S-1)}function fc(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=S[0],z=S[1],B=S[2],D=S[3];return e[0]=w*D+I*F+L*B-M*z,e[1]=L*D+I*z+M*F-w*B,e[2]=M*D+I*B+w*z-L*F,e[3]=I*D-w*F-L*z-M*B,e}function _c(e,c,S){S*=.5;var w=c[0],L=c[1],M=c[2],I=c[3],F=Math.sin(S),z=Math.cos(S);return e[0]=w*z+I*F,e[1]=L*z+M*F,e[2]=M*z-L*F,e[3]=I*z-w*F,e}function pc(e,c,S){S*=.5;var w=c[0],L=c[1],M=c[2],I=c[3],F=Math.sin(S),z=Math.cos(S);return e[0]=w*z-M*F,e[1]=L*z+I*F,e[2]=M*z+w*F,e[3]=I*z-L*F,e}function vc(e,c,S){S*=.5;var w=c[0],L=c[1],M=c[2],I=c[3],F=Math.sin(S),z=Math.cos(S);return e[0]=w*z+L*F,e[1]=L*z-w*F,e[2]=M*z+I*F,e[3]=I*z-M*F,e}function cp(e,c){var S=c[0],w=c[1],L=c[2];return e[0]=S,e[1]=w,e[2]=L,e[3]=Math.sqrt(Math.abs(1-S*S-w*w-L*L)),e}function mc(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=Math.sqrt(S*S+w*w+L*L),F=Math.exp(M),z=I>0?F*Math.sin(I)/I:0;return e[0]=S*z,e[1]=w*z,e[2]=L*z,e[3]=F*Math.cos(I),e}function bc(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=Math.sqrt(S*S+w*w+L*L),F=I>0?Math.atan2(I,M)/I:0;return e[0]=S*F,e[1]=w*F,e[2]=L*F,e[3]=.5*Math.log(S*S+w*w+L*L+M*M),e}function hp(e,c,S){return bc(e,c),Tc(e,e,S),mc(e,e),e}function Qs(e,c,S,w){var L,M,I,F,z,B=c[0],D=c[1],G=c[2],q=c[3],W=S[0],H=S[1],X=S[2],V=S[3];return(M=B*W+D*H+G*X+q*V)<0&&(M=-M,W=-W,H=-H,X=-X,V=-V),1-M>v?(L=Math.acos(M),I=Math.sin(L),F=Math.sin((1-w)*L)/I,z=Math.sin(w*L)/I):(F=1-w,z=w),e[0]=F*B+z*W,e[1]=F*D+z*H,e[2]=F*G+z*X,e[3]=F*q+z*V,e}function dp(e){var c=g(),S=g(),w=g(),L=Math.sqrt(1-c),M=Math.sqrt(c);return e[0]=L*Math.sin(2*Math.PI*S),e[1]=L*Math.cos(2*Math.PI*S),e[2]=M*Math.sin(2*Math.PI*w),e[3]=M*Math.cos(2*Math.PI*w),e}function fp(e,c){var S=c[0],w=c[1],L=c[2],M=c[3],I=S*S+w*w+L*L+M*M,F=I?1/I:0;return e[0]=-S*F,e[1]=-w*F,e[2]=-L*F,e[3]=M*F,e}function _p(e,c){return e[0]=-c[0],e[1]=-c[1],e[2]=-c[2],e[3]=c[3],e}function gc(e,c){var S,w=c[0]+c[4]+c[8];if(w>0)S=Math.sqrt(w+1),e[3]=.5*S,S=.5/S,e[0]=(c[5]-c[7])*S,e[1]=(c[6]-c[2])*S,e[2]=(c[1]-c[3])*S;else{var L=0;c[4]>c[0]&&(L=1),c[8]>c[3*L+L]&&(L=2);var M=(L+1)%3,I=(L+2)%3;S=Math.sqrt(c[3*L+L]-c[3*M+M]-c[3*I+I]+1),e[L]=.5*S,S=.5/S,e[3]=(c[3*M+I]-c[3*I+M])*S,e[M]=(c[3*M+L]+c[3*L+M])*S,e[I]=(c[3*I+L]+c[3*L+I])*S}return e}function pp(e,c,S,w){var L=.5*Math.PI/180;c*=L,S*=L,w*=L;var M=Math.sin(c),I=Math.cos(c),F=Math.sin(S),z=Math.cos(S),B=Math.sin(w),D=Math.cos(w);return e[0]=M*z*D-I*F*B,e[1]=I*F*D+M*z*B,e[2]=I*z*B-M*F*D,e[3]=I*z*D+M*F*B,e}function vp(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var ht,yc,Ec,Yu,Zu,dt,mp=Zl,bp=Kl,Ku=Ql,gp=Jl,yp=ec,Ep=fc,Tc=nc,Qu=uc,Tp=lc,Ju=Hu,xp=Ju,el=Xu,Sp=el,tl=oc,Ap=cc,Op=hc,wp=(ht=xi(),yc=Si(1,0,0),Ec=Si(0,1,0),function(e,c,S){var w=$u(c,S);return w<-.999999?(Zs(ht,yc,c),Xl(ht)<1e-6&&Zs(ht,Ec,c),Hl(ht,ht),dc(e,ht,Math.PI),e):w>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Zs(ht,c,S),e[0]=ht[0],e[1]=ht[1],e[2]=ht[2],e[3]=1+w,tl(e,e))}),Pp=(Yu=Ks(),Zu=Ks(),function(e,c,S,w,L,M){return Qs(Yu,c,L,M),Qs(Zu,S,w,M),Qs(e,Yu,Zu,2*M*(1-M)),e}),Rp=(dt=Pe(),function(e,c,S,w){return dt[0]=S[0],dt[3]=S[1],dt[6]=S[2],dt[1]=w[0],dt[4]=w[1],dt[7]=w[2],dt[2]=-c[0],dt[5]=-c[1],dt[8]=-c[2],tl(e,gc(e,dt))});function Lp(){var e=new _(8);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Mp(e){var c=new _(8);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c}function Ip(e,c,S,w,L,M,I,F){var z=new _(8);return z[0]=e,z[1]=c,z[2]=S,z[3]=w,z[4]=L,z[5]=M,z[6]=I,z[7]=F,z}function Fp(e,c,S,w,L,M,I){var F=new _(8);F[0]=e,F[1]=c,F[2]=S,F[3]=w;var z=.5*L,B=.5*M,D=.5*I;return F[4]=z*w+B*S-D*c,F[5]=B*w+D*e-z*S,F[6]=D*w+z*c-B*e,F[7]=-z*e-B*c-D*S,F}function xc(e,c,S){var w=.5*S[0],L=.5*S[1],M=.5*S[2],I=c[0],F=c[1],z=c[2],B=c[3];return e[0]=I,e[1]=F,e[2]=z,e[3]=B,e[4]=w*B+L*z-M*F,e[5]=L*B+M*I-w*z,e[6]=M*B+w*F-L*I,e[7]=-w*I-L*F-M*z,e}function Cp(e,c){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*c[0],e[5]=.5*c[1],e[6]=.5*c[2],e[7]=0,e}function Np(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function zp(e,c){var S=Ks();Gs(S,c);var w=new _(3);return Us(w,c),xc(e,S,w),e}function Sc(e,c){return e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e}function Bp(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Dp(e,c,S,w,L,M,I,F,z){return e[0]=c,e[1]=S,e[2]=w,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e}var jp=Ku;function Up(e,c){return e[0]=c[4],e[1]=c[5],e[2]=c[6],e[3]=c[7],e}var kp=Ku;function Gp(e,c){return e[4]=c[0],e[5]=c[1],e[6]=c[2],e[7]=c[3],e}function qp(e,c){var S=c[4],w=c[5],L=c[6],M=c[7],I=-c[0],F=-c[1],z=-c[2],B=c[3];return e[0]=2*(S*B+M*I+w*z-L*F),e[1]=2*(w*B+M*F+L*I-S*z),e[2]=2*(L*B+M*z+S*F-w*I),e}function Wp(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=.5*S[0],z=.5*S[1],B=.5*S[2],D=c[4],G=c[5],q=c[6],W=c[7];return e[0]=w,e[1]=L,e[2]=M,e[3]=I,e[4]=I*F+L*B-M*z+D,e[5]=I*z+M*F-w*B+G,e[6]=I*B+w*z-L*F+q,e[7]=-w*F-L*z-M*B+W,e}function Vp(e,c,S){var w=-c[0],L=-c[1],M=-c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=F*I+D*w+z*M-B*L,q=z*I+D*L+B*w-F*M,W=B*I+D*M+F*L-z*w,H=D*I-F*w-z*L-B*M;return _c(e,c,S),w=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+H*w+q*M-W*L,e[5]=q*I+H*L+W*w-G*M,e[6]=W*I+H*M+G*L-q*w,e[7]=H*I-G*w-q*L-W*M,e}function $p(e,c,S){var w=-c[0],L=-c[1],M=-c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=F*I+D*w+z*M-B*L,q=z*I+D*L+B*w-F*M,W=B*I+D*M+F*L-z*w,H=D*I-F*w-z*L-B*M;return pc(e,c,S),w=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+H*w+q*M-W*L,e[5]=q*I+H*L+W*w-G*M,e[6]=W*I+H*M+G*L-q*w,e[7]=H*I-G*w-q*L-W*M,e}function Hp(e,c,S){var w=-c[0],L=-c[1],M=-c[2],I=c[3],F=c[4],z=c[5],B=c[6],D=c[7],G=F*I+D*w+z*M-B*L,q=z*I+D*L+B*w-F*M,W=B*I+D*M+F*L-z*w,H=D*I-F*w-z*L-B*M;return vc(e,c,S),w=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+H*w+q*M-W*L,e[5]=q*I+H*L+W*w-G*M,e[6]=W*I+H*M+G*L-q*w,e[7]=H*I-G*w-q*L-W*M,e}function Xp(e,c,S){var w=S[0],L=S[1],M=S[2],I=S[3],F=c[0],z=c[1],B=c[2],D=c[3];return e[0]=F*I+D*w+z*M-B*L,e[1]=z*I+D*L+B*w-F*M,e[2]=B*I+D*M+F*L-z*w,e[3]=D*I-F*w-z*L-B*M,F=c[4],z=c[5],B=c[6],D=c[7],e[4]=F*I+D*w+z*M-B*L,e[5]=z*I+D*L+B*w-F*M,e[6]=B*I+D*M+F*L-z*w,e[7]=D*I-F*w-z*L-B*M,e}function Yp(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=S[0],z=S[1],B=S[2],D=S[3];return e[0]=w*D+I*F+L*B-M*z,e[1]=L*D+I*z+M*F-w*B,e[2]=M*D+I*B+w*z-L*F,e[3]=I*D-w*F-L*z-M*B,F=S[4],z=S[5],B=S[6],D=S[7],e[4]=w*D+I*F+L*B-M*z,e[5]=L*D+I*z+M*F-w*B,e[6]=M*D+I*B+w*z-L*F,e[7]=I*D-w*F-L*z-M*B,e}function Zp(e,c,S,w){if(Math.abs(w)<v)return Sc(e,c);var L=Math.hypot(S[0],S[1],S[2]);w*=.5;var M=Math.sin(w),I=M*S[0]/L,F=M*S[1]/L,z=M*S[2]/L,B=Math.cos(w),D=c[0],G=c[1],q=c[2],W=c[3];e[0]=D*B+W*I+G*z-q*F,e[1]=G*B+W*F+q*I-D*z,e[2]=q*B+W*z+D*F-G*I,e[3]=W*B-D*I-G*F-q*z;var H=c[4],X=c[5],V=c[6],K=c[7];return e[4]=H*B+K*I+X*z-V*F,e[5]=X*B+K*F+V*I-H*z,e[6]=V*B+K*z+H*F-X*I,e[7]=K*B-H*I-X*F-V*z,e}function Kp(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e[2]=c[2]+S[2],e[3]=c[3]+S[3],e[4]=c[4]+S[4],e[5]=c[5]+S[5],e[6]=c[6]+S[6],e[7]=c[7]+S[7],e}function Ac(e,c,S){var w=c[0],L=c[1],M=c[2],I=c[3],F=S[4],z=S[5],B=S[6],D=S[7],G=c[4],q=c[5],W=c[6],H=c[7],X=S[0],V=S[1],K=S[2],oe=S[3];return e[0]=w*oe+I*X+L*K-M*V,e[1]=L*oe+I*V+M*X-w*K,e[2]=M*oe+I*K+w*V-L*X,e[3]=I*oe-w*X-L*V-M*K,e[4]=w*D+I*F+L*B-M*z+G*oe+H*X+q*K-W*V,e[5]=L*D+I*z+M*F-w*B+q*oe+H*V+W*X-G*K,e[6]=M*D+I*B+w*z-L*F+W*oe+H*K+G*V-q*X,e[7]=I*D-w*F-L*z-M*B+H*oe-G*X-q*V-W*K,e}var Qp=Ac;function Jp(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e[2]=c[2]*S,e[3]=c[3]*S,e[4]=c[4]*S,e[5]=c[5]*S,e[6]=c[6]*S,e[7]=c[7]*S,e}var Oc=Qu;function ev(e,c,S,w){var L=1-w;return Oc(c,S)<0&&(w=-w),e[0]=c[0]*L+S[0]*w,e[1]=c[1]*L+S[1]*w,e[2]=c[2]*L+S[2]*w,e[3]=c[3]*L+S[3]*w,e[4]=c[4]*L+S[4]*w,e[5]=c[5]*L+S[5]*w,e[6]=c[6]*L+S[6]*w,e[7]=c[7]*L+S[7]*w,e}function tv(e,c){var S=Js(c);return e[0]=-c[0]/S,e[1]=-c[1]/S,e[2]=-c[2]/S,e[3]=c[3]/S,e[4]=-c[4]/S,e[5]=-c[5]/S,e[6]=-c[6]/S,e[7]=c[7]/S,e}function rv(e,c){return e[0]=-c[0],e[1]=-c[1],e[2]=-c[2],e[3]=c[3],e[4]=-c[4],e[5]=-c[5],e[6]=-c[6],e[7]=c[7],e}var wc=Ju,iv=wc,Js=el,nv=Js;function av(e,c){var S=Js(c);if(S>0){S=Math.sqrt(S);var w=c[0]/S,L=c[1]/S,M=c[2]/S,I=c[3]/S,F=c[4],z=c[5],B=c[6],D=c[7],G=w*F+L*z+M*B+I*D;e[0]=w,e[1]=L,e[2]=M,e[3]=I,e[4]=(F-w*G)/S,e[5]=(z-L*G)/S,e[6]=(B-M*G)/S,e[7]=(D-I*G)/S}return e}function sv(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function ov(e,c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]&&e[4]===c[4]&&e[5]===c[5]&&e[6]===c[6]&&e[7]===c[7]}function uv(e,c){var S=e[0],w=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=c[0],G=c[1],q=c[2],W=c[3],H=c[4],X=c[5],V=c[6],K=c[7];return Math.abs(S-D)<=v*Math.max(1,Math.abs(S),Math.abs(D))&&Math.abs(w-G)<=v*Math.max(1,Math.abs(w),Math.abs(G))&&Math.abs(L-q)<=v*Math.max(1,Math.abs(L),Math.abs(q))&&Math.abs(M-W)<=v*Math.max(1,Math.abs(M),Math.abs(W))&&Math.abs(I-H)<=v*Math.max(1,Math.abs(I),Math.abs(H))&&Math.abs(F-X)<=v*Math.max(1,Math.abs(F),Math.abs(X))&&Math.abs(z-V)<=v*Math.max(1,Math.abs(z),Math.abs(V))&&Math.abs(B-K)<=v*Math.max(1,Math.abs(B),Math.abs(K))}function Pc(){var e=new _(2);return _!=Float32Array&&(e[0]=0,e[1]=0),e}function lv(e){var c=new _(2);return c[0]=e[0],c[1]=e[1],c}function cv(e,c){var S=new _(2);return S[0]=e,S[1]=c,S}function hv(e,c){return e[0]=c[0],e[1]=c[1],e}function dv(e,c,S){return e[0]=c,e[1]=S,e}function fv(e,c,S){return e[0]=c[0]+S[0],e[1]=c[1]+S[1],e}function Rc(e,c,S){return e[0]=c[0]-S[0],e[1]=c[1]-S[1],e}function Lc(e,c,S){return e[0]=c[0]*S[0],e[1]=c[1]*S[1],e}function Mc(e,c,S){return e[0]=c[0]/S[0],e[1]=c[1]/S[1],e}function _v(e,c){return e[0]=Math.ceil(c[0]),e[1]=Math.ceil(c[1]),e}function pv(e,c){return e[0]=Math.floor(c[0]),e[1]=Math.floor(c[1]),e}function vv(e,c,S){return e[0]=Math.min(c[0],S[0]),e[1]=Math.min(c[1],S[1]),e}function mv(e,c,S){return e[0]=Math.max(c[0],S[0]),e[1]=Math.max(c[1],S[1]),e}function bv(e,c){return e[0]=Math.round(c[0]),e[1]=Math.round(c[1]),e}function gv(e,c,S){return e[0]=c[0]*S,e[1]=c[1]*S,e}function yv(e,c,S,w){return e[0]=c[0]+S[0]*w,e[1]=c[1]+S[1]*w,e}function Ic(e,c){var S=c[0]-e[0],w=c[1]-e[1];return Math.hypot(S,w)}function Fc(e,c){var S=c[0]-e[0],w=c[1]-e[1];return S*S+w*w}function Cc(e){var c=e[0],S=e[1];return Math.hypot(c,S)}function Nc(e){var c=e[0],S=e[1];return c*c+S*S}function Ev(e,c){return e[0]=-c[0],e[1]=-c[1],e}function Tv(e,c){return e[0]=1/c[0],e[1]=1/c[1],e}function xv(e,c){var S=c[0],w=c[1],L=S*S+w*w;return L>0&&(L=1/Math.sqrt(L)),e[0]=c[0]*L,e[1]=c[1]*L,e}function Sv(e,c){return e[0]*c[0]+e[1]*c[1]}function Av(e,c,S){var w=c[0]*S[1]-c[1]*S[0];return e[0]=e[1]=0,e[2]=w,e}function Ov(e,c,S,w){var L=c[0],M=c[1];return e[0]=L+w*(S[0]-L),e[1]=M+w*(S[1]-M),e}function wv(e,c){c=c||1;var S=2*g()*Math.PI;return e[0]=Math.cos(S)*c,e[1]=Math.sin(S)*c,e}function Pv(e,c,S){var w=c[0],L=c[1];return e[0]=S[0]*w+S[2]*L,e[1]=S[1]*w+S[3]*L,e}function Rv(e,c,S){var w=c[0],L=c[1];return e[0]=S[0]*w+S[2]*L+S[4],e[1]=S[1]*w+S[3]*L+S[5],e}function Lv(e,c,S){var w=c[0],L=c[1];return e[0]=S[0]*w+S[3]*L+S[6],e[1]=S[1]*w+S[4]*L+S[7],e}function Mv(e,c,S){var w=c[0],L=c[1];return e[0]=S[0]*w+S[4]*L+S[12],e[1]=S[1]*w+S[5]*L+S[13],e}function Iv(e,c,S,w){var L=c[0]-S[0],M=c[1]-S[1],I=Math.sin(w),F=Math.cos(w);return e[0]=L*F-M*I+S[0],e[1]=L*I+M*F+S[1],e}function Fv(e,c){var S=e[0],w=e[1],L=c[0],M=c[1],I=Math.sqrt(S*S+w*w)*Math.sqrt(L*L+M*M),F=I&&(S*L+w*M)/I;return Math.acos(Math.min(Math.max(F,-1),1))}function Cv(e){return e[0]=0,e[1]=0,e}function Nv(e){return"vec2("+e[0]+", "+e[1]+")"}function zv(e,c){return e[0]===c[0]&&e[1]===c[1]}function Bv(e,c){var S=e[0],w=e[1],L=c[0],M=c[1];return Math.abs(S-L)<=v*Math.max(1,Math.abs(S),Math.abs(L))&&Math.abs(w-M)<=v*Math.max(1,Math.abs(w),Math.abs(M))}var Dv=Cc,jv=Rc,Uv=Lc,kv=Mc,Gv=Ic,qv=Fc,Wv=Nc,Vv=function(){var e=Pc();return function(c,S,w,L,M,I){var F,z;for(S||(S=2),w||(w=0),z=L?Math.min(L*S+w,c.length):c.length,F=w;F<z;F+=S)e[0]=c[F],e[1]=c[F+1],M(e,e,I),c[F]=e[0],c[F+1]=e[1];return c}}()},4613:l=>{l.exports=function(r){var a={};function n(i){if(a[i])return a[i].exports;var h=a[i]={i,l:!1,exports:{}};return r[i].call(h.exports,h,h.exports,n),h.l=!0,h.exports}return n.m=r,n.c=a,n.d=function(i,h,p){n.o(i,h)||Object.defineProperty(i,h,{enumerable:!0,get:p})},n.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,h){if(1&h&&(i=n(i)),8&h||4&h&&typeof i=="object"&&i&&i.__esModule)return i;var p=Object.create(null);if(n.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:i}),2&h&&typeof i!="string")for(var d in i)n.d(p,d,(function(f){return i[f]}).bind(null,d));return p},n.n=function(i){var h=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(h,"a",h),h},n.o=function(i,h){return Object.prototype.hasOwnProperty.call(i,h)},n.p="",n(n.s=7)}([function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0}),a.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(i){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(i,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(i){this.itemsLoaded++,this.onProgress&&this.onProgress(i,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(i){this.onError&&this.onError(i)}resolveURL(i){return this.urlModifier?this.urlModifier(i):i}}},function(r,a,n){var i=this&&this.__awaiter||function(o,u,b,v){return new(b||(b=Promise))(function(_,g){function x(A){try{O(v.next(A))}catch(R){g(R)}}function T(A){try{O(v.throw(A))}catch(R){g(R)}}function O(A){A.done?_(A.value):new b(function(R){R(A.value)}).then(x,T)}O((v=v.apply(o,u||[])).next())})};Object.defineProperty(a,"__esModule",{value:!0});const h=n(3),p=n(0);a.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},a.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},a.GltfAsset=class{constructor(o,u,b,v=new p.LoadingManager){this.gltf=o,this.glbData=b,this.bufferData=new d(this,u,v),this.imageData=new f(this,u,v)}bufferViewData(o){return i(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const u=this.gltf.bufferViews[o],b=yield this.bufferData.get(u.buffer),v=u.byteLength||0,_=u.byteOffset||0,g=b.buffer,x=b.byteOffset;return new Uint8Array(g,x+_,v)})}accessorData(o){return i(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const u=this.gltf.accessors[o],b=a.GLTF_ELEMENTS_PER_TYPE[u.type];let v;if(u.bufferView!==void 0)v=yield this.bufferViewData(u.bufferView);else{const _=a.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType].BYTES_PER_ELEMENT*b*u.count;v=new Uint8Array(_)}if(u.sparse){const{count:_,indices:g,values:x}=u.sparse;let T=a.GLTF_COMPONENT_TYPE_ARRAYS[g.componentType],O=yield this.bufferViewData(g.bufferView);const A=new T(O.buffer,O.byteOffset+(g.byteOffset||0),_);T=a.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType],O=yield this.bufferViewData(x.bufferView);const R=new T((yield this.bufferViewData(x.bufferView)).buffer,O.byteOffset+(x.byteOffset||0),_*b);u.bufferView&&(v=new Uint8Array(v));const P=new a.GLTF_COMPONENT_TYPE_ARRAYS[u.componentType](v.buffer);for(let C=0;C<_;C++)for(let U=0;U<b;U++)P[b*A[C]+U]=R[b*C+U]}return v})}preFetchAll(){return i(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class d{constructor(u,b,v){this.bufferCache=[],this.asset=u,this.baseUri=b,this.manager=v,this.loader=new h.FileLoader(v),this.loader.responseType="arraybuffer"}get(u){return i(this,void 0,void 0,function*(){if(this.bufferCache[u]!==void 0)return this.bufferCache[u];const b=this.asset.gltf;if(!b.buffers)throw new Error("No buffers found.");const v=b.buffers[u];if(v.uri===void 0){if(u!==0)throw new Error("GLB container is required to be the first buffer");if(this.asset.glbData===void 0)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const _=s(v.uri,this.baseUri),g=yield this.loader.load(_),x=new Uint8Array(g);return this.bufferCache[u]=x,x})}preFetchAll(){return i(this,void 0,void 0,function*(){const u=this.asset.gltf.buffers;return u?Promise.all(u.map((b,v)=>this.get(v))):[]})}}a.BufferData=d;class f{constructor(u,b,v){this.crossOrigin="anonymous",this.imageCache=[],this.asset=u,this.baseUri=b,this.manager=v}get(u){return i(this,void 0,void 0,function*(){if(this.imageCache[u]!==void 0)return this.imageCache[u];const b=this.asset.gltf;if(!b.images)throw new Error("No images found.");const v=b.images[u];let _,g=!1;if(v.bufferView!==void 0){const T=yield this.asset.bufferViewData(v.bufferView);g=!0;const O=new Blob([T],{type:v.mimeType});_=URL.createObjectURL(O)}else{if(v.uri===void 0)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");_=this.manager.resolveURL(s(v.uri,this.baseUri))}const x=new Image;return x.crossOrigin=this.crossOrigin,new Promise((T,O)=>{x.onerror=()=>{O(`Failed to load ${_}`),this.manager.itemEnd(_),this.manager.itemError(_)},x.onload=()=>{g&&URL.revokeObjectURL(_),this.imageCache[u]=x,T(x),this.manager.itemEnd(_)},x.src=_,this.manager.itemStart(_)})})}preFetchAll(){return i(this,void 0,void 0,function*(){const u=this.asset.gltf.images;return u?Promise.all(u.map((b,v)=>this.get(v))):[]})}}function s(o,u){return typeof o!="string"||o===""?"":/^(https?:)?\/\//i.test(o)||/^data:.*,.*$/i.test(o)||/^blob:.*$/i.test(o)?o:u+o}a.ImageData=f,a.resolveURL=s},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0}),a.LoaderUtils=class{static decodeText(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let h="";for(const p of i)h+=String.fromCharCode(p);return decodeURIComponent(escape(h))}static extractUrlBase(i){const h=i.split("/");return h.length===1?"./":(h.pop(),h.join("/")+"/")}}},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0}),a.FileLoader=class{constructor(i){this.runningRequests={},this.manager=i}load(i,h){if(this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i),this.runningRequests[i])return this.runningRequests[i];const p=new Promise((d,f)=>{const s=new XMLHttpRequest;s.open("GET",i,!0);const o=this;s.onload=function(u){const b=this.response;this.status===0?(console.warn("FileLoader: HTTP Status 0 received."),d(b),o.manager.itemEnd(i)):this.status===200?(d(b),o.manager.itemEnd(i)):(f({url:i,status:this.status,statusText:s.statusText}),o.manager.itemEnd(i),o.manager.itemError(i)),delete o.runningRequests[i]},s.onprogress=u=>{h&&h(u)},s.onerror=function(u){f({url:i,status:this.status,statusText:s.statusText}),o.manager.itemEnd(i),o.manager.itemError(i),delete o.runningRequests[i]},this.responseType&&(s.responseType=this.responseType),this.withCredentials&&(s.withCredentials=this.withCredentials),this.mimeType&&s.overrideMimeType&&s.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const u in this.requestHeaders)s.setRequestHeader(u,this.requestHeaders[u]);s.send(null),this.manager.itemStart(i)});return this.runningRequests[i]=p,p}setRequestHeader(i,h){return this.requestHeaders[i]=h,this}}},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0})},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});const i=n(2);a.BINARY_HEADER_MAGIC="glTF",a.GLTFBinaryData=class{constructor(h){const p=new DataView(h,0,12),d=i.LoaderUtils.decodeText(new Uint8Array(h,0,4)),f=p.getUint32(4,!0);if(p.getUint32(8,!0),d!==a.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(f<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(h,12);let o=0;for(;o<s.byteLength;){const u=s.getUint32(o,!0);o+=4;const b=s.getUint32(o,!0);if(o+=4,b===1313821514){const v=new Uint8Array(h,12+o,u);this.json=i.LoaderUtils.decodeText(v)}else if(b===5130562){const v=12+o;this.binaryChunk=new Uint8Array(h,v,u)}o+=u}if(this.json===null)throw new Error("glTF-Binary: JSON content not found.")}}},function(r,a,n){var i=this&&this.__awaiter||function(b,v,_,g){return new(_||(_=Promise))(function(x,T){function O(P){try{R(g.next(P))}catch(C){T(C)}}function A(P){try{R(g.throw(P))}catch(C){T(C)}}function R(P){P.done?x(P.value):new _(function(C){C(P.value)}).then(O,A)}R((g=g.apply(b,v||[])).next())})};function h(b){for(var v in b)a.hasOwnProperty(v)||(a[v]=b[v])}Object.defineProperty(a,"__esModule",{value:!0});const p=n(3),d=n(5),f=n(1),s=n(2),o=n(0),u=n(4);a.gltf=u,h(n(1)),h(n(0)),a.GltfLoader=class{constructor(b){this.manager=b||new o.LoadingManager}load(b,v){return i(this,void 0,void 0,function*(){const _=s.LoaderUtils.extractUrlBase(b),g=new p.FileLoader(this.manager);g.responseType="arraybuffer";const x=yield g.load(b,v);return yield this.parse(x,_)})}loadFromFiles(b){return i(this,void 0,void 0,function*(){let v,_;for(const[A,R]of b)R.name.match(/\.(gltf|glb)$/)&&(v=R,_=A.replace(R.name,""));if(!v)throw new Error("No .gltf or .glb asset found.");const g=typeof v=="string"?v:URL.createObjectURL(v),x=s.LoaderUtils.extractUrlBase(g),T=[];this.manager.urlModifier=A=>{const R=_+A.replace(x,"").replace(/^(\.?\/)/,"");if(b.has(R)){const P=b.get(R),C=URL.createObjectURL(P);return T.push(C),C}return A};const O=yield this.load(g);return yield O.preFetchAll(),URL.revokeObjectURL(g),T.forEach(URL.revokeObjectURL),O})}parse(b,v){return i(this,void 0,void 0,function*(){let _,g;_=typeof b=="string"?b:s.LoaderUtils.decodeText(new Uint8Array(b,0,4))===d.BINARY_HEADER_MAGIC?(g=new d.GLTFBinaryData(b)).json:s.LoaderUtils.decodeText(new Uint8Array(b));const x=JSON.parse(_);if(x.asset===void 0||x.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new f.GltfAsset(x,v,g,this.manager)})}}},function(r,a,n){r.exports=n(6)}])},7648:(l,r,a)=>{var n=a(6433),i=n.ValidatorResult,h=n.SchemaError,p={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},d=p.validators={};function f(v,_,g,x,T){var O=_.throwError,A=_.throwAll;_.throwError=!1,_.throwAll=!1;var R=this.validateSchema(v,T,_,g);return _.throwError=O,_.throwAll=A,!R.valid&&x instanceof Function&&x(R),R.valid}function s(v,_){if(Object.hasOwnProperty.call(v,_))return v[_];if(_ in v){for(;v=Object.getPrototypeOf(v);)if(Object.propertyIsEnumerable.call(v,_))return v[_]}}function o(v,_,g,x,T,O){if(this.types.object(v)&&(!_.properties||_.properties[T]===void 0))if(_.additionalProperties===!1)O.addError({name:"additionalProperties",argument:T,message:"is not allowed to have the additional property "+JSON.stringify(T)});else{var A=_.additionalProperties||{};typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,T,A,g,x);var R=this.validateSchema(v[T],A,g,x.makeChild(A,T));R.instance!==O.instance[T]&&(O.instance[T]=R.instance),O.importErrors(R)}}d.type=function(v,_,g,x){if(v===void 0)return null;var T=new i(v,_,g,x),O=Array.isArray(_.type)?_.type:[_.type];if(!O.some(this.testType.bind(this,v,_,g,x))){var A=O.map(function(R){if(R){var P=R.$id||R.id;return P?"<"+P+">":R+""}});T.addError({name:"type",argument:A,message:"is not of a type(s) "+A})}return T},d.anyOf=function(v,_,g,x){if(v===void 0)return null;var T=new i(v,_,g,x),O=new i(v,_,g,x);if(!Array.isArray(_.anyOf))throw new h("anyOf must be an array");if(!_.anyOf.some(f.bind(this,v,g,x,function(R){O.importErrors(R)}))){var A=_.anyOf.map(function(R,P){var C=R.$id||R.id;return C?"<"+C+">":R.title&&JSON.stringify(R.title)||R.$ref&&"<"+R.$ref+">"||"[subschema "+P+"]"});g.nestedErrors&&T.importErrors(O),T.addError({name:"anyOf",argument:A,message:"is not any of "+A.join(",")})}return T},d.allOf=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.allOf))throw new h("allOf must be an array");var T=new i(v,_,g,x),O=this;return _.allOf.forEach(function(A,R){var P=O.validateSchema(v,A,g,x);if(!P.valid){var C=A.$id||A.id||A.title&&JSON.stringify(A.title)||A.$ref&&"<"+A.$ref+">"||"[subschema "+R+"]";T.addError({name:"allOf",argument:{id:C,length:P.errors.length,valid:P},message:"does not match allOf schema "+C+" with "+P.errors.length+" error[s]:"}),T.importErrors(P)}}),T},d.oneOf=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.oneOf))throw new h("oneOf must be an array");var T=new i(v,_,g,x),O=new i(v,_,g,x),A=_.oneOf.filter(f.bind(this,v,g,x,function(P){O.importErrors(P)})).length,R=_.oneOf.map(function(P,C){return P.$id||P.id||P.title&&JSON.stringify(P.title)||P.$ref&&"<"+P.$ref+">"||"[subschema "+C+"]"});return A!==1&&(g.nestedErrors&&T.importErrors(O),T.addError({name:"oneOf",argument:R,message:"is not exactly one from "+R.join(",")})),T},d.if=function(v,_,g,x){if(v===void 0)return null;if(!n.isSchema(_.if))throw new Error('Expected "if" keyword to be a schema');var T,O=f.call(this,v,g,x,null,_.if),A=new i(v,_,g,x);if(O){if(_.then===void 0)return;if(!n.isSchema(_.then))throw new Error('Expected "then" keyword to be a schema');T=this.validateSchema(v,_.then,g,x.makeChild(_.then)),A.importErrors(T)}else{if(_.else===void 0)return;if(!n.isSchema(_.else))throw new Error('Expected "else" keyword to be a schema');T=this.validateSchema(v,_.else,g,x.makeChild(_.else)),A.importErrors(T)}return A},d.propertyNames=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x),O=_.propertyNames!==void 0?_.propertyNames:{};if(!n.isSchema(O))throw new h('Expected "propertyNames" to be a schema (object or boolean)');for(var A in v)if(s(v,A)!==void 0){var R=this.validateSchema(A,O,g,x.makeChild(O));T.importErrors(R)}return T}},d.properties=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x),O=_.properties||{};for(var A in O){var R=O[A];if(R!==void 0){if(R===null)throw new h('Unexpected null, expected schema in "properties"');typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,A,R,g,x);var P=s(v,A),C=this.validateSchema(P,R,g,x.makeChild(R,A));C.instance!==T.instance[A]&&(T.instance[A]=C.instance),T.importErrors(C)}}return T}},d.patternProperties=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x),O=_.patternProperties||{};for(var A in v){var R=!0;for(var P in O){var C=O[P];if(C!==void 0){if(C===null)throw new h('Unexpected null, expected schema in "patternProperties"');try{var U=new RegExp(P,"u")}catch{U=new RegExp(P)}if(U.test(A)){R=!1,typeof g.preValidateProperty=="function"&&g.preValidateProperty(v,A,C,g,x);var j=this.validateSchema(v[A],C,g,x.makeChild(C,A));j.instance!==T.instance[A]&&(T.instance[A]=j.instance),T.importErrors(j)}}}R&&o.call(this,v,_,g,x,A,T)}return T}},d.additionalProperties=function(v,_,g,x){if(this.types.object(v)){if(_.patternProperties)return null;var T=new i(v,_,g,x);for(var O in v)o.call(this,v,_,g,x,O,T);return T}},d.minProperties=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x);return Object.keys(v).length>=_.minProperties||T.addError({name:"minProperties",argument:_.minProperties,message:"does not meet minimum property length of "+_.minProperties}),T}},d.maxProperties=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x);return Object.keys(v).length<=_.maxProperties||T.addError({name:"maxProperties",argument:_.maxProperties,message:"does not meet maximum property length of "+_.maxProperties}),T}},d.items=function(v,_,g,x){var T=this;if(this.types.array(v)&&_.items!==void 0){var O=new i(v,_,g,x);return v.every(function(A,R){if(Array.isArray(_.items))var P=_.items[R]===void 0?_.additionalItems:_.items[R];else P=_.items;if(P===void 0)return!0;if(P===!1)return O.addError({name:"items",message:"additionalItems not permitted"}),!1;var C=T.validateSchema(A,P,g,x.makeChild(P,R));return C.instance!==O.instance[R]&&(O.instance[R]=C.instance),O.importErrors(C),!0}),O}},d.contains=function(v,_,g,x){var T=this;if(this.types.array(v)&&_.contains!==void 0){if(!n.isSchema(_.contains))throw new Error('Expected "contains" keyword to be a schema');var O=new i(v,_,g,x);return v.some(function(A,R){return T.validateSchema(A,_.contains,g,x.makeChild(_.contains,R)).errors.length===0})===!1&&O.addError({name:"contains",argument:_.contains,message:"must contain an item matching given schema"}),O}},d.minimum=function(v,_,g,x){if(this.types.number(v)){var T=new i(v,_,g,x);return _.exclusiveMinimum&&_.exclusiveMinimum===!0?v>_.minimum||T.addError({name:"minimum",argument:_.minimum,message:"must be greater than "+_.minimum}):v>=_.minimum||T.addError({name:"minimum",argument:_.minimum,message:"must be greater than or equal to "+_.minimum}),T}},d.maximum=function(v,_,g,x){if(this.types.number(v)){var T=new i(v,_,g,x);return _.exclusiveMaximum&&_.exclusiveMaximum===!0?v<_.maximum||T.addError({name:"maximum",argument:_.maximum,message:"must be less than "+_.maximum}):v<=_.maximum||T.addError({name:"maximum",argument:_.maximum,message:"must be less than or equal to "+_.maximum}),T}},d.exclusiveMinimum=function(v,_,g,x){if(typeof _.exclusiveMinimum!="boolean"&&this.types.number(v)){var T=new i(v,_,g,x);return v>_.exclusiveMinimum||T.addError({name:"exclusiveMinimum",argument:_.exclusiveMinimum,message:"must be strictly greater than "+_.exclusiveMinimum}),T}},d.exclusiveMaximum=function(v,_,g,x){if(typeof _.exclusiveMaximum!="boolean"&&this.types.number(v)){var T=new i(v,_,g,x);return v<_.exclusiveMaximum||T.addError({name:"exclusiveMaximum",argument:_.exclusiveMaximum,message:"must be strictly less than "+_.exclusiveMaximum}),T}};var u=function(v,_,g,x,T,O){if(this.types.number(v)){var A=_[T];if(A==0)throw new h(T+" cannot be zero");var R=new i(v,_,g,x),P=n.getDecimalPlaces(v),C=n.getDecimalPlaces(A),U=Math.max(P,C),j=Math.pow(10,U);return Math.round(v*j)%Math.round(A*j)!=0&&R.addError({name:T,argument:A,message:O+JSON.stringify(A)}),R}};function b(v,_,g){var x,T=g.length;for(x=_+1;x<T;x++)if(n.deepCompareStrict(v,g[x]))return!1;return!0}d.multipleOf=function(v,_,g,x){return u.call(this,v,_,g,x,"multipleOf","is not a multiple of (divisible by) ")},d.divisibleBy=function(v,_,g,x){return u.call(this,v,_,g,x,"divisibleBy","is not divisible by (multiple of) ")},d.required=function(v,_,g,x){var T=new i(v,_,g,x);return v===void 0&&_.required===!0?T.addError({name:"required",message:"is required"}):this.types.object(v)&&Array.isArray(_.required)&&_.required.forEach(function(O){s(v,O)===void 0&&T.addError({name:"required",argument:O,message:"requires property "+JSON.stringify(O)})}),T},d.pattern=function(v,_,g,x){if(this.types.string(v)){var T=new i(v,_,g,x),O=_.pattern;try{var A=new RegExp(O,"u")}catch{A=new RegExp(O)}return v.match(A)||T.addError({name:"pattern",argument:_.pattern,message:"does not match pattern "+JSON.stringify(_.pattern.toString())}),T}},d.format=function(v,_,g,x){if(v!==void 0){var T=new i(v,_,g,x);return T.disableFormat||n.isFormat(v,_.format,this)||T.addError({name:"format",argument:_.format,message:"does not conform to the "+JSON.stringify(_.format)+" format"}),T}},d.minLength=function(v,_,g,x){if(this.types.string(v)){var T=new i(v,_,g,x),O=v.match(/[\uDC00-\uDFFF]/g);return v.length-(O?O.length:0)>=_.minLength||T.addError({name:"minLength",argument:_.minLength,message:"does not meet minimum length of "+_.minLength}),T}},d.maxLength=function(v,_,g,x){if(this.types.string(v)){var T=new i(v,_,g,x),O=v.match(/[\uDC00-\uDFFF]/g);return v.length-(O?O.length:0)<=_.maxLength||T.addError({name:"maxLength",argument:_.maxLength,message:"does not meet maximum length of "+_.maxLength}),T}},d.minItems=function(v,_,g,x){if(this.types.array(v)){var T=new i(v,_,g,x);return v.length>=_.minItems||T.addError({name:"minItems",argument:_.minItems,message:"does not meet minimum length of "+_.minItems}),T}},d.maxItems=function(v,_,g,x){if(this.types.array(v)){var T=new i(v,_,g,x);return v.length<=_.maxItems||T.addError({name:"maxItems",argument:_.maxItems,message:"does not meet maximum length of "+_.maxItems}),T}},d.uniqueItems=function(v,_,g,x){if(_.uniqueItems===!0&&this.types.array(v)){var T=new i(v,_,g,x);return v.every(b)||T.addError({name:"uniqueItems",message:"contains duplicate item"}),T}},d.dependencies=function(v,_,g,x){if(this.types.object(v)){var T=new i(v,_,g,x);for(var O in _.dependencies)if(v[O]!==void 0){var A=_.dependencies[O],R=x.makeChild(A,O);if(typeof A=="string"&&(A=[A]),Array.isArray(A))A.forEach(function(C){v[C]===void 0&&T.addError({name:"dependencies",argument:R.propertyPath,message:"property "+C+" not found, required by "+R.propertyPath})});else{var P=this.validateSchema(v,A,g,R);T.instance!==P.instance&&(T.instance=P.instance),P&&P.errors.length&&(T.addError({name:"dependencies",argument:R.propertyPath,message:"does not meet dependency required by "+R.propertyPath}),T.importErrors(P))}}return T}},d.enum=function(v,_,g,x){if(v===void 0)return null;if(!Array.isArray(_.enum))throw new h("enum expects an array",_);var T=new i(v,_,g,x);return _.enum.some(n.deepCompareStrict.bind(null,v))||T.addError({name:"enum",argument:_.enum,message:"is not one of enum values: "+_.enum.map(String).join(",")}),T},d.const=function(v,_,g,x){if(v===void 0)return null;var T=new i(v,_,g,x);return n.deepCompareStrict(_.const,v)||T.addError({name:"const",argument:_.const,message:"does not exactly match expected constant: "+_.const}),T},d.not=d.disallow=function(v,_,g,x){var T=this;if(v===void 0)return null;var O=new i(v,_,g,x),A=_.not||_.disallow;return A?(Array.isArray(A)||(A=[A]),A.forEach(function(R){if(T.testType(v,_,g,x,R)){var P=R&&(R.$id||R.id)||R;O.addError({name:"not",argument:P,message:"is of prohibited type "+P})}}),O):null},l.exports=p},6433:(l,r,a)=>{var n=a(9983),i=r.ValidationError=function(T,O,A,R,P,C){if(Array.isArray(R)?(this.path=R,this.property=R.reduce(function(j,k){return j+u(k)},"instance")):R!==void 0&&(this.property=R),T&&(this.message=T),A){var U=A.$id||A.id;this.schema=U||A}O!==void 0&&(this.instance=O),this.name=P,this.argument=C,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var h=r.ValidatorResult=function(T,O,A,R){this.instance=T,this.schema=O,this.options=A,this.path=R.path,this.propertyPath=R.propertyPath,this.errors=[],this.throwError=A&&A.throwError,this.throwFirst=A&&A.throwFirst,this.throwAll=A&&A.throwAll,this.disableFormat=A&&A.disableFormat===!0};function p(T,O){return O+": "+T.toString()+`
`}function d(T){Error.captureStackTrace&&Error.captureStackTrace(this,d),this.instance=T.instance,this.schema=T.schema,this.options=T.options,this.errors=T.errors}h.prototype.addError=function(T){var O;if(typeof T=="string")O=new i(T,this.instance,this.schema,this.path);else{if(!T)throw new Error("Missing error detail");if(!T.message)throw new Error("Missing error message");if(!T.name)throw new Error("Missing validator type");O=new i(T.message,this.instance,this.schema,this.path,T.name,T.argument)}if(this.errors.push(O),this.throwFirst)throw new d(this);if(this.throwError)throw O;return O},h.prototype.importErrors=function(T){typeof T=="string"||T&&T.validatorType?this.addError(T):T&&T.errors&&(this.errors=this.errors.concat(T.errors))},h.prototype.toString=function(T){return this.errors.map(p).join("")},Object.defineProperty(h.prototype,"valid",{get:function(){return!this.errors.length}}),l.exports.ValidatorResultError=d,d.prototype=new Error,d.prototype.constructor=d,d.prototype.name="Validation Error";var f=r.SchemaError=function T(O,A){this.message=O,this.schema=A,Error.call(this,O),Error.captureStackTrace(this,T)};f.prototype=Object.create(Error.prototype,{constructor:{value:f,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var s=r.SchemaContext=function(T,O,A,R,P){this.schema=T,this.options=O,Array.isArray(A)?(this.path=A,this.propertyPath=A.reduce(function(C,U){return C+u(U)},"instance")):this.propertyPath=A,this.base=R,this.schemas=P};s.prototype.resolve=function(T){return n.resolve(this.base,T)},s.prototype.makeChild=function(T,O){var A=O===void 0?this.path:this.path.concat([O]),R=T.$id||T.id,P=n.resolve(this.base,R||""),C=new s(T,this.options,A,P,Object.create(this.schemas));return R&&!C.schemas[P]&&(C.schemas[P]=T),C};var o=r.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(T){return typeof T=="string"&&parseFloat(T)===parseInt(T,10)&&!isNaN(T)},regex:function(T){var O=!0;try{new RegExp(T)}catch{O=!1}return O},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};o.regexp=o.regex,o.pattern=o.regex,o.ipv4=o["ip-address"],r.isFormat=function(T,O,A){if(typeof T=="string"&&o[O]!==void 0){if(o[O]instanceof RegExp)return o[O].test(T);if(typeof o[O]=="function")return o[O](T)}else if(A&&A.customFormats&&typeof A.customFormats[O]=="function")return A.customFormats[O](T);return!0};var u=r.makeSuffix=function(T){return(T=T.toString()).match(/[.\s\[\]]/)||T.match(/^[\d]/)?T.match(/^\d+$/)?"["+T+"]":"["+JSON.stringify(T)+"]":"."+T};function b(T,O,A,R){typeof A=="object"?O[R]=g(T[R],A):T.indexOf(A)===-1&&O.push(A)}function v(T,O,A){O[A]=T[A]}function _(T,O,A,R){typeof O[R]=="object"&&O[R]&&T[R]?A[R]=g(T[R],O[R]):A[R]=O[R]}function g(T,O){var A=Array.isArray(O),R=A&&[]||{};return A?(T=T||[],R=R.concat(T),O.forEach(b.bind(null,T,R))):(T&&typeof T=="object"&&Object.keys(T).forEach(v.bind(null,T,R)),Object.keys(O).forEach(_.bind(null,T,O,R))),R}function x(T){return"/"+encodeURIComponent(T).replace(/~/g,"%7E")}r.deepCompareStrict=function T(O,A){if(typeof O!=typeof A)return!1;if(Array.isArray(O))return!!Array.isArray(A)&&O.length===A.length&&O.every(function(C,U){return T(O[U],A[U])});if(typeof O=="object"){if(!O||!A)return O===A;var R=Object.keys(O),P=Object.keys(A);return R.length===P.length&&R.every(function(C){return T(O[C],A[C])})}return O===A},l.exports.deepMerge=g,r.objectGetPath=function(T,O){for(var A,R=O.split("/").slice(1);typeof(A=R.shift())=="string";){var P=decodeURIComponent(A.replace(/~0/,"~").replace(/~1/g,"/"));if(!(P in T))return;T=T[P]}return T},r.encodePath=function(T){return T.map(x).join("")},r.getDecimalPlaces=function(T){var O=0;if(isNaN(T))return O;typeof T!="number"&&(T=Number(T));var A=T.toString().split("e");if(A.length===2){if(A[1][0]!=="-")return O;O=Number(A[1].slice(1))}var R=A[0].split(".");return R.length===2&&(O+=R[1].length),O},r.isSchema=function(T){return typeof T=="object"&&T||typeof T=="boolean"}},3780:(l,r,a)=>{var n=l.exports.Validator=a(4622);l.exports.ValidatorResult=a(6433).ValidatorResult,l.exports.ValidatorResultError=a(6433).ValidatorResultError,l.exports.ValidationError=a(6433).ValidationError,l.exports.SchemaError=a(6433).SchemaError,l.exports.SchemaScanResult=a(8075).SchemaScanResult,l.exports.scan=a(8075).scan,l.exports.validate=function(i,h,p){return new n().validate(i,h,p)}},8075:(l,r,a)=>{var n=a(9983),i=a(6433);function h(p,d){this.id=p,this.ref=d}l.exports.SchemaScanResult=h,l.exports.scan=function(p,d){function f(v,_){if(_&&typeof _=="object")if(_.$ref){var g=n.resolve(v,_.$ref);b[g]=b[g]?b[g]+1:0}else{var x=_.$id||_.id,T=x?n.resolve(v,x):v;if(T){if(T.indexOf("#")<0&&(T+="#"),u[T]){if(!i.deepCompareStrict(u[T],_))throw new Error("Schema <"+T+"> already exists with different definition");return u[T]}u[T]=_,T[T.length-1]=="#"&&(u[T.substring(0,T.length-1)]=_)}s(T+"/items",Array.isArray(_.items)?_.items:[_.items]),s(T+"/extends",Array.isArray(_.extends)?_.extends:[_.extends]),f(T+"/additionalItems",_.additionalItems),o(T+"/properties",_.properties),f(T+"/additionalProperties",_.additionalProperties),o(T+"/definitions",_.definitions),o(T+"/patternProperties",_.patternProperties),o(T+"/dependencies",_.dependencies),s(T+"/disallow",_.disallow),s(T+"/allOf",_.allOf),s(T+"/anyOf",_.anyOf),s(T+"/oneOf",_.oneOf),f(T+"/not",_.not)}}function s(v,_){if(Array.isArray(_))for(var g=0;g<_.length;g++)f(v+"/"+g,_[g])}function o(v,_){if(_&&typeof _=="object")for(var g in _)f(v+"/"+g,_[g])}var u={},b={};return f(p,d),new h(u,b)}},4622:(l,r,a)=>{var n=a(9983),i=a(7648),h=a(6433),p=a(8075).scan,d=h.ValidatorResult,f=h.ValidatorResultError,s=h.SchemaError,o=h.SchemaContext,u=function _(){this.customFormats=Object.create(_.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(v),this.attributes=Object.create(i.validators)};function b(_){var g=typeof _=="string"?_:_.$ref;return typeof g=="string"&&g}u.prototype.customFormats={},u.prototype.schemas=null,u.prototype.types=null,u.prototype.attributes=null,u.prototype.unresolvedRefs=null,u.prototype.addSchema=function(_,g){var x=this;if(!_)return null;var T=p(g||"/",_),O=g||_.$id||_.id;for(var A in T.id)this.schemas[A]=T.id[A];for(var A in T.ref)this.unresolvedRefs.push(A);return this.unresolvedRefs=this.unresolvedRefs.filter(function(R){return x.schemas[R]===void 0}),this.schemas[O]},u.prototype.addSubSchemaArray=function(_,g){if(Array.isArray(g))for(var x=0;x<g.length;x++)this.addSubSchema(_,g[x])},u.prototype.addSubSchemaObject=function(_,g){if(g&&typeof g=="object")for(var x in g)this.addSubSchema(_,g[x])},u.prototype.setSchemas=function(_){this.schemas=_},u.prototype.getSchema=function(_){return this.schemas[_]},u.prototype.validate=function(_,g,x,T){if(typeof g!="boolean"&&typeof g!="object"||g===null)throw new s("Expected `schema` to be an object or boolean");x||(x={});var O,A=g.$id||g.id,R=n.resolve(x.base||"/",A||"");if(!T){(T=new o(g,x,[],R,Object.create(this.schemas))).schemas[R]||(T.schemas[R]=g);var P=p(R,g);for(var C in P.id){var U=P.id[C];T.schemas[C]=U}}if(x.required&&_===void 0)return(O=new d(_,g,x,T)).addError("is required, but is undefined"),O;if(!(O=this.validateSchema(_,g,x,T)))throw new Error("Result undefined");if(x.throwAll&&O.errors.length)throw new f(O);return O},u.prototype.validateSchema=function(_,g,x,T){var O=new d(_,g,x,T);if(typeof g=="boolean")g===!0?g={}:g===!1&&(g={type:[]});else if(!g)throw new Error("schema is undefined");if(g.extends)if(Array.isArray(g.extends)){var A={schema:g,ctx:T};g.extends.forEach(this.schemaTraverser.bind(this,A)),g=A.schema,A.schema=null,A.ctx=null,A=null}else g=h.deepMerge(g,this.superResolve(g.extends,T));var R=b(g);if(R){var P=this.resolve(g,R,T),C=new o(P.subschema,x,T.path,P.switchSchema,T.schemas);return this.validateSchema(_,P.subschema,x,C)}var U=x&&x.skipAttributes||[];for(var j in g)if(!i.ignoreProperties[j]&&U.indexOf(j)<0){var k=null,$=this.attributes[j];if($)k=$.call(this,_,g,x,T);else if(x.allowUnknownAttributes===!1)throw new s("Unsupported attribute: "+j,g);k&&O.importErrors(k)}if(typeof x.rewrite=="function"){var Y=x.rewrite.call(this,_,g,x,T);O.instance=Y}return O},u.prototype.schemaTraverser=function(_,g){_.schema=h.deepMerge(_.schema,this.superResolve(g,_.ctx))},u.prototype.superResolve=function(_,g){var x=b(_);return x?this.resolve(_,x,g).subschema:_},u.prototype.resolve=function(_,g,x){if(g=x.resolve(g),x.schemas[g])return{subschema:x.schemas[g],switchSchema:g};var T=n.parse(g),O=T&&T.hash,A=O&&O.length&&g.substr(0,g.length-O.length);if(!A||!x.schemas[A])throw new s("no such schema <"+g+">",_);var R=h.objectGetPath(x.schemas[A],O.substr(1));if(R===void 0)throw new s("no such schema "+O+" located in <"+A+">",_);return{subschema:R,switchSchema:g}},u.prototype.testType=function(_,g,x,T,O){if(O!==void 0){if(O===null)throw new s('Unexpected null in "type" keyword');if(typeof this.types[O]=="function")return this.types[O].call(this,_);if(O&&typeof O=="object"){var A=this.validateSchema(_,O,x,T);return A===void 0||!(A&&A.errors.length)}return!0}};var v=u.prototype.types={};v.string=function(_){return typeof _=="string"},v.number=function(_){return typeof _=="number"&&isFinite(_)},v.integer=function(_){return typeof _=="number"&&_%1==0},v.boolean=function(_){return typeof _=="boolean"},v.array=function(_){return Array.isArray(_)},v.null=function(_){return _===null},v.date=function(_){return _ instanceof Date},v.any=function(_){return!0},v.object=function(_){return _&&typeof _=="object"&&!Array.isArray(_)&&!(_ instanceof Date)},l.exports=u},6751:(l,r,a)=>{a.r(r),a.d(r,{decode:()=>T,default:()=>P,encode:()=>O,toASCII:()=>R,toUnicode:()=>A,ucs2decode:()=>v,ucs2encode:()=>_});const n=2147483647,i=36,h=/^xn--/,p=/[^\0-\x7F]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},s=Math.floor,o=String.fromCharCode;function u(C){throw new RangeError(f[C])}function b(C,U){const j=C.split("@");let k="";j.length>1&&(k=j[0]+"@",C=j[1]);const $=function(Y,Z){const J=[];let te=Y.length;for(;te--;)J[te]=Z(Y[te]);return J}((C=C.replace(d,".")).split("."),U).join(".");return k+$}function v(C){const U=[];let j=0;const k=C.length;for(;j<k;){const $=C.charCodeAt(j++);if($>=55296&&$<=56319&&j<k){const Y=C.charCodeAt(j++);(64512&Y)==56320?U.push(((1023&$)<<10)+(1023&Y)+65536):(U.push($),j--)}else U.push($)}return U}const _=C=>String.fromCodePoint(...C),g=function(C,U){return C+22+75*(C<26)-((U!=0)<<5)},x=function(C,U,j){let k=0;for(C=j?s(C/700):C>>1,C+=s(C/U);C>455;k+=i)C=s(C/35);return s(k+36*C/(C+38))},T=function(C){const U=[],j=C.length;let k=0,$=128,Y=72,Z=C.lastIndexOf("-");Z<0&&(Z=0);for(let te=0;te<Z;++te)C.charCodeAt(te)>=128&&u("not-basic"),U.push(C.charCodeAt(te));for(let te=Z>0?Z+1:0;te<j;){const Q=k;for(let ce=1,de=i;;de+=i){te>=j&&u("invalid-input");const me=(J=C.charCodeAt(te++))>=48&&J<58?J-48+26:J>=65&&J<91?J-65:J>=97&&J<123?J-97:i;me>=i&&u("invalid-input"),me>s((n-k)/ce)&&u("overflow"),k+=me*ce;const xe=de<=Y?1:de>=Y+26?26:de-Y;if(me<xe)break;const Ce=i-xe;ce>s(n/Ce)&&u("overflow"),ce*=Ce}const ie=U.length+1;Y=x(k-Q,ie,Q==0),s(k/ie)>n-$&&u("overflow"),$+=s(k/ie),k%=ie,U.splice(k++,0,$)}var J;return String.fromCodePoint(...U)},O=function(C){const U=[],j=(C=v(C)).length;let k=128,$=0,Y=72;for(const te of C)te<128&&U.push(o(te));const Z=U.length;let J=Z;for(Z&&U.push("-");J<j;){let te=n;for(const ie of C)ie>=k&&ie<te&&(te=ie);const Q=J+1;te-k>s((n-$)/Q)&&u("overflow"),$+=(te-k)*Q,k=te;for(const ie of C)if(ie<k&&++$>n&&u("overflow"),ie===k){let ce=$;for(let de=i;;de+=i){const me=de<=Y?1:de>=Y+26?26:de-Y;if(ce<me)break;const xe=ce-me,Ce=i-me;U.push(o(g(me+xe%Ce,0))),ce=s(xe/Ce)}U.push(o(g(ce,0))),Y=x($,Q,J===Z),$=0,++J}++$,++k}return U.join("")},A=function(C){return b(C,function(U){return h.test(U)?T(U.slice(4).toLowerCase()):U})},R=function(C){return b(C,function(U){return p.test(U)?"xn--"+O(U):U})},P={version:"2.3.1",ucs2:{decode:v,encode:_},decode:T,encode:O,toASCII:R,toUnicode:A}},769:l=>{var r=String.prototype.replace,a=/%20/g;l.exports={default:"RFC3986",formatters:{RFC1738:function(n){return r.call(n,a,"+")},RFC3986:function(n){return String(n)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},8985:(l,r,a)=>{var n=a(1088),i=a(2286),h=a(769);l.exports={formats:h,parse:i,stringify:n}},2286:(l,r,a)=>{var n=a(5364),i=Object.prototype.hasOwnProperty,h={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},p=function(d,f,s){if(d){var o=s.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,u=/(\[[^[\]]*])/g,b=/(\[[^[\]]*])/.exec(o),v=b?o.slice(0,b.index):o,_=[];if(v){if(!s.plainObjects&&i.call(Object.prototype,v)&&!s.allowPrototypes)return;_.push(v)}for(var g=0;(b=u.exec(o))!==null&&g<s.depth;){if(g+=1,!s.plainObjects&&i.call(Object.prototype,b[1].slice(1,-1))&&!s.allowPrototypes)return;_.push(b[1])}return b&&_.push("["+o.slice(b.index)+"]"),function(x,T,O){for(var A=T,R=x.length-1;R>=0;--R){var P,C=x[R];if(C==="[]"&&O.parseArrays)P=[].concat(A);else{P=O.plainObjects?Object.create(null):{};var U=C.charAt(0)==="["&&C.charAt(C.length-1)==="]"?C.slice(1,-1):C,j=parseInt(U,10);O.parseArrays||U!==""?!isNaN(j)&&C!==U&&String(j)===U&&j>=0&&O.parseArrays&&j<=O.arrayLimit?(P=[])[j]=A:U!=="__proto__"&&(P[U]=A):P={0:A}}A=P}return A}(_,f,s)}};l.exports=function(d,f){var s=f?n.assign({},f):{};if(s.decoder!==null&&s.decoder!==void 0&&typeof s.decoder!="function")throw new TypeError("Decoder has to be a function.");if(s.ignoreQueryPrefix=s.ignoreQueryPrefix===!0,s.delimiter=typeof s.delimiter=="string"||n.isRegExp(s.delimiter)?s.delimiter:h.delimiter,s.depth=typeof s.depth=="number"?s.depth:h.depth,s.arrayLimit=typeof s.arrayLimit=="number"?s.arrayLimit:h.arrayLimit,s.parseArrays=s.parseArrays!==!1,s.decoder=typeof s.decoder=="function"?s.decoder:h.decoder,s.allowDots=typeof s.allowDots=="boolean"?s.allowDots:h.allowDots,s.plainObjects=typeof s.plainObjects=="boolean"?s.plainObjects:h.plainObjects,s.allowPrototypes=typeof s.allowPrototypes=="boolean"?s.allowPrototypes:h.allowPrototypes,s.parameterLimit=typeof s.parameterLimit=="number"?s.parameterLimit:h.parameterLimit,s.strictNullHandling=typeof s.strictNullHandling=="boolean"?s.strictNullHandling:h.strictNullHandling,d===""||d==null)return s.plainObjects?Object.create(null):{};for(var o=typeof d=="string"?function(x,T){for(var O={},A=T.ignoreQueryPrefix?x.replace(/^\?/,""):x,R=T.parameterLimit===1/0?void 0:T.parameterLimit,P=A.split(T.delimiter,R),C=0;C<P.length;++C){var U,j,k=P[C],$=k.indexOf("]="),Y=$===-1?k.indexOf("="):$+1;Y===-1?(U=T.decoder(k,h.decoder),j=T.strictNullHandling?null:""):(U=T.decoder(k.slice(0,Y),h.decoder),j=T.decoder(k.slice(Y+1),h.decoder)),i.call(O,U)?O[U]=[].concat(O[U]).concat(j):O[U]=j}return O}(d,s):d,u=s.plainObjects?Object.create(null):{},b=Object.keys(o),v=0;v<b.length;++v){var _=b[v],g=p(_,o[_],s);u=n.merge(u,g,s)}return n.compact(u)}},1088:(l,r,a)=>{var n=a(5364),i=a(769),h={brackets:function(b){return b+"[]"},indices:function(b,v){return b+"["+v+"]"},repeat:function(b){return b}},p=Array.isArray,d=Array.prototype.push,f=function(b,v){d.apply(b,p(v)?v:[v])},s=Date.prototype.toISOString,o={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(b){return s.call(b)},skipNulls:!1,strictNullHandling:!1},u=function b(v,_,g,x,T,O,A,R,P,C,U,j){var k=v;if(typeof A=="function"?k=A(_,k):k instanceof Date&&(k=C(k)),k===null){if(x)return O&&!j?O(_,o.encoder):_;k=""}if(typeof k=="string"||typeof k=="number"||typeof k=="boolean"||n.isBuffer(k))return O?[U(j?_:O(_,o.encoder))+"="+U(O(k,o.encoder))]:[U(_)+"="+U(String(k))];var $,Y=[];if(k===void 0)return Y;if(p(A))$=A;else{var Z=Object.keys(k);$=R?Z.sort(R):Z}for(var J=0;J<$.length;++J){var te=$[J];T&&k[te]===null||(p(k)?f(Y,b(k[te],g(_,te),g,x,T,O,A,R,P,C,U,j)):f(Y,b(k[te],_+(P?"."+te:"["+te+"]"),g,x,T,O,A,R,P,C,U,j)))}return Y};l.exports=function(b,v){var _=b,g=v?n.assign({},v):{};if(g.encoder!==null&&g.encoder!==void 0&&typeof g.encoder!="function")throw new TypeError("Encoder has to be a function.");var x=g.delimiter===void 0?o.delimiter:g.delimiter,T=typeof g.strictNullHandling=="boolean"?g.strictNullHandling:o.strictNullHandling,O=typeof g.skipNulls=="boolean"?g.skipNulls:o.skipNulls,A=typeof g.encode=="boolean"?g.encode:o.encode,R=typeof g.encoder=="function"?g.encoder:o.encoder,P=typeof g.sort=="function"?g.sort:null,C=g.allowDots!==void 0&&g.allowDots,U=typeof g.serializeDate=="function"?g.serializeDate:o.serializeDate,j=typeof g.encodeValuesOnly=="boolean"?g.encodeValuesOnly:o.encodeValuesOnly;if(g.format===void 0)g.format=i.default;else if(!Object.prototype.hasOwnProperty.call(i.formatters,g.format))throw new TypeError("Unknown format option provided.");var k,$,Y=i.formatters[g.format];typeof g.filter=="function"?_=($=g.filter)("",_):p(g.filter)&&(k=$=g.filter);var Z,J=[];if(typeof _!="object"||_===null)return"";Z=g.arrayFormat in h?g.arrayFormat:"indices"in g?g.indices?"indices":"repeat":"indices";var te=h[Z];k||(k=Object.keys(_)),P&&k.sort(P);for(var Q=0;Q<k.length;++Q){var ie=k[Q];O&&_[ie]===null||f(J,u(_[ie],ie,te,T,O,A?R:null,$,P,C,U,Y,j))}var ce=J.join(x),de=g.addQueryPrefix===!0?"?":"";return ce.length>0?de+ce:""}},5364:l=>{var r=Object.prototype.hasOwnProperty,a=function(){for(var i=[],h=0;h<256;++h)i.push("%"+((h<16?"0":"")+h.toString(16)).toUpperCase());return i}(),n=function(i,h){for(var p=h&&h.plainObjects?Object.create(null):{},d=0;d<i.length;++d)i[d]!==void 0&&(p[d]=i[d]);return p};l.exports={arrayToObject:n,assign:function(i,h){return Object.keys(h).reduce(function(p,d){return p[d]=h[d],p},i)},compact:function(i){for(var h=[{obj:{o:i},prop:"o"}],p=[],d=0;d<h.length;++d)for(var f=h[d],s=f.obj[f.prop],o=Object.keys(s),u=0;u<o.length;++u){var b=o[u],v=s[b];typeof v=="object"&&v!==null&&p.indexOf(v)===-1&&(h.push({obj:s,prop:b}),p.push(v))}return function(_){for(var g;_.length;){var x=_.pop();if(g=x.obj[x.prop],Array.isArray(g)){for(var T=[],O=0;O<g.length;++O)g[O]!==void 0&&T.push(g[O]);x.obj[x.prop]=T}}return g}(h)},decode:function(i){try{return decodeURIComponent(i.replace(/\+/g," "))}catch{return i}},encode:function(i){if(i.length===0)return i;for(var h=typeof i=="string"?i:String(i),p="",d=0;d<h.length;++d){var f=h.charCodeAt(d);f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122?p+=h.charAt(d):f<128?p+=a[f]:f<2048?p+=a[192|f>>6]+a[128|63&f]:f<55296||f>=57344?p+=a[224|f>>12]+a[128|f>>6&63]+a[128|63&f]:(d+=1,f=65536+((1023&f)<<10|1023&h.charCodeAt(d)),p+=a[240|f>>18]+a[128|f>>12&63]+a[128|f>>6&63]+a[128|63&f])}return p},isBuffer:function(i){return i!=null&&!!(i.constructor&&i.constructor.isBuffer&&i.constructor.isBuffer(i))},isRegExp:function(i){return Object.prototype.toString.call(i)==="[object RegExp]"},merge:function i(h,p,d){if(!p)return h;if(typeof p!="object"){if(Array.isArray(h))h.push(p);else{if(!h||typeof h!="object")return[h,p];(d&&(d.plainObjects||d.allowPrototypes)||!r.call(Object.prototype,p))&&(h[p]=!0)}return h}if(!h||typeof h!="object")return[h].concat(p);var f=h;return Array.isArray(h)&&!Array.isArray(p)&&(f=n(h,d)),Array.isArray(h)&&Array.isArray(p)?(p.forEach(function(s,o){if(r.call(h,o)){var u=h[o];u&&typeof u=="object"&&s&&typeof s=="object"?h[o]=i(u,s,d):h.push(s)}else h[o]=s}),h):Object.keys(p).reduce(function(s,o){var u=p[o];return r.call(s,o)?s[o]=i(s[o],u,d):s[o]=u,s},f)}}},9017:function(l,r,a){var n=this&&this.__decorate||function(_,g,x,T){var O,A=arguments.length,R=A<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,x):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,T);else for(var P=_.length-1;P>=0;P--)(O=_[P])&&(R=(A<3?O(R):A>3?O(g,x,R):O(g,x))||R);return A>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(r,"__esModule",{value:!0}),r.AccumulatePass=void 0;const i=a(9504),h=a(7564),p=a(8215),d=a(4127),f=a(1896),s=a(4168),o=a(771),u=a(8593),b=a(9217);class v extends d.Initializable{constructor(g){super(),this._altered=Object.assign(new h.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=b.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=g}initialize(g){const x=this._context.gl;this._accumulationFBOs=[new p.Framebuffer(this._context,"AccumPingFBO"),new p.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new u.Texture2D(this._context,"AccumPingTexture"),new u.Texture2D(this._context,"AccumPongTexture")],g===void 0?this._ndcTriangle=new f.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=g,this._ndcTriangleShared=!0);const T=new o.Shader(this._context,x.VERTEX_SHADER,"ndcvertices.vert (accumulate)");T.initialize(a(9657));const O=new o.Shader(this._context,x.FRAGMENT_SHADER,"accumulate.frag");return O.initialize(a(8058)),this._program=new s.Program(this._context,"AccumulateProgram"),this._program.initialize([T,O],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),x.uniform1f(this._uWeight,0),x.uniform1i(this._program.uniform("u_accumulationTexture"),0),x.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void(0,i.log)(i.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const g=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!g)return void(0,i.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const x=this._context.gl,T=this._context.gl2facade,O=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||g)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const A=b.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].reformat(A[0],x.RGBA,A[1]),this._accumulationTextures[1].reformat(A[0],x.RGBA,A[1])}}else{const A=b.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].initialize(O[0],O[1],A[0],x.RGBA,A[1]),this._accumulationTextures[1].initialize(O[0],O[1],A[0],x.RGBA,A[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[T.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[T.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),(0,i.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(g,x){if((0,i.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||this._texture===void 0)return;(0,i.logIf)(!this._texture||!this._texture.valid,i.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const T=this._context.gl;x!==void 0&&T.viewport(0,0,x[0],x[1]);const O=g%2,A=this._write=1-O,R=this._accumulationTextures[O],P=this._texture;R.bind(T.TEXTURE0),P.bind(T.TEXTURE1),this._program.bind(),T.uniform1f(this._uWeight,1/(g+1)),this._accumulationFBOs[A].bind(T.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[A].unbind(T.DRAW_FRAMEBUFFER),R.unbind(T.TEXTURE0),P.unbind(T.TEXTURE1)}set texture(g){this.assertInitialized(),this._texture!==g&&(this._texture=g,this._altered.alter("texture"))}set precision(g){this.assertInitialized(),this._precision!==g&&(this._precision=g,this._altered.alter("precision"))}set passThrough(g){this.assertInitialized(),this._passThrough!==g&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=g,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}r.AccumulatePass=v,n([d.Initializable.initialize()],v.prototype,"initialize",null),n([d.Initializable.uninitialize()],v.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],v.prototype,"update",null),n([d.Initializable.assert_initialized()],v.prototype,"frame",null)},7501:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AllocationRegister=void 0;const n=a(7032),i=a(9504);r.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new n.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(h){(0,i.assert)(this._bytesByIdentifier.has(h),"allocation identifier unknown")}createUniqueIdentifier(h){let p=h,d=2;for(;this._bytesByIdentifier.has(p);)p=`${h}-${d}`,++d;return this._bytesByIdentifier.set(p,0),p}deleteUniqueIdentifier(h){(0,i.assert)(this._bytesByIdentifier.has(h),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(h)}allocate(h,p){if(this.assertIdentifier(h),(0,i.assert)(p>=0,`positive number of bytes expected for allocation, given ${p}`),p===0)return;const d=this._bytesByIdentifier.get(h)+p;this._bytesByIdentifier.set(h,d),this._bytes=this._bytes+p,this.bytesNext()}deallocate(h,p){this.assertIdentifier(h);const d=this._bytesByIdentifier.get(h);(0,i.assert)(p>=0,`positive number of bytes expected for deallocation, given ${p}`),(0,i.assert)(p<=d,`deallocation cannot exceed previous allocations of ${d}, given ${p}`),p!==0&&(this._bytesByIdentifier.set(h,d-p),this._bytes=this._bytes-p,this.bytesNext())}reallocate(h,p){this.assertIdentifier(h),(0,i.assert)(p>=0,`positive number of bytes expected for reallocation, given ${p}`);const d=this._bytesByIdentifier.get(h);d!==p&&(this._bytes=this._bytes-d,this._bytesByIdentifier.set(h,p),this._bytes=this._bytes+p,this.bytesNext())}allocated(h){return h===void 0?this._bytes:(this.assertIdentifier(h),this._bytesByIdentifier.get(h))}toString(){const h=new Array;return this._bytesByIdentifier.forEach((p,d)=>{h.push(`${d}: ${(0,i.prettyPrintBytes)(p)}`)}),h.join(", ")}bytesToString(h){return(0,i.prettyPrintBytes)(this.allocated(h))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},2419:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AntiAliasingKernel=void 0;const n=a(3039);class i extends n.RandomSquareKernel{constructor(p){super(p)}generate(){switch(this._width){case 8:this.fromJSON(a(3058));break;case 64:this.fromJSON(a(9148));break;case 128:this.fromJSON(a(6399));break;default:super.generate()}}}r.AntiAliasingKernel=i},9504:(l,r,a)=>{const n=a(5150);var i;(function(h){let p,d=2;h.logVerbosity=function(T){return T!==void 0&&(d=Math.max(-1,T)),d},function(T){T[T.Debug=3]="Debug",T[T.Info=2]="Info",T[T.Warning=1]="Warning",T[T.Error=0]="Error"}(p=h.LogLevel||(h.LogLevel={}));const f=(T,O)=>{if(!T)throw new EvalError(O)},s=(T,O)=>{};function o(T,...O){T>d||console.log(`[${T}]`,...O)}function u(T){const O=`${T}-start`;h.assert(performance.getEntriesByName(T).length===0,`expected mark identifier to not already exists, given ${T}`),h.assert(performance.getEntriesByName(O).length===0,`expected mark identifier to not already exists, given ${O}`),performance.mark(O)}function b(T,O,A=0){const R=`${T}-start`,P=`${T}-end`;h.assert(performance.getEntriesByName(T).length===0,`expected mark identifier to not already exists, given ${T}`),h.assert(performance.getEntriesByName(P).length===0,`expected mark identifier to not already exists, given ${P}`),performance.mark(P),performance.measure(T,R,P);const C=performance.getEntriesByName(T)[0];performance.clearMarks(R),performance.clearMarks(P),performance.clearMeasures(T);const U=O===void 0||O.length===0?0:2,j=Math.max(U,A-T.length-(O?O.length:0)-1),k=x(C.duration);o(p.Debug,`${T}${" ".repeat(j)}${O||""} | ${k}`)}h.assert=f,h.assertions=function(T){return T!==void 0&&(h.assert=T?f:s),h.assert!==s},h.log=o,h.logIf=function(T,O,...A){T&&o(O,...A)},h.logPerformanceStart=u,h.logPerformanceStartIf=function(T,O){T&&u(O)},h.logPerformanceStop=b,h.logPerformanceStopIf=function(T,O,A,R=0){T&&b(O,A,R)},h.rand=function(T=0,O=1){return Math.random()*(O-T)+T},h.isPowerOfTwo=function(T){return Number.isInteger(T)&&Number.isInteger(Math.log2(T))},h.upperPowerOfTwo=function(T){return--T,T|=T>>1,T|=T>>2,T|=T>>4,T|=T>>8,T|=T>>16,++T};const v=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];h.prettyPrintBytes=function(T){const O=T>0?Math.floor(Math.log(T)/Math.log(1024)):0,A=T/Math.pow(1024,O);return`${O>0?A.toFixed(3):A}${v[O]}B`};const _=["ms","ns","μs","ms","s"],g=[0,1e6,1e3,1,.001];function x(T){let O=T>0?Math.max(1,Math.floor(Math.log(10*T)/Math.log(1e3))+3):0;return O=(0,n.clamp)(O,0,4),`${(T*g[O]).toFixed(3)}${_[O]}`}h.prettyPrintMilliseconds=x,h.bitInBitfield=function(T,O){return O!==void 0&&(T&O)===O},h.RAD2DEG=57.29577951308232,h.DEG2RAD=.017453292519943295,h.GETsearch=function(){var O,A;let T=window.location.search;return T||(T=((A=(O=window.top)==null?void 0:O.location)==null?void 0:A.search)||""),T},h.GETparameter=function(T){var R,P;const O=new RegExp(`${T}=([^&]+)`);let A=window.location.search.match(O);if(A||(A=((P=(R=window.top)==null?void 0:R.location)==null?void 0:P.search.match(O))||null),A)return A[1]},h.PATH_SEPARATOR="/",h.dirname=function(T){return T.includes(h.PATH_SEPARATOR)===!1?"":T.substr(0,T.lastIndexOf(h.PATH_SEPARATOR)).trimLeft()},h.basename=function(T){return T.includes(h.PATH_SEPARATOR)===!1?T:T.substr(T.lastIndexOf(h.PATH_SEPARATOR)+1).trimRight()}})(i||(i={})),l.exports=i},8263:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Benchmark=void 0,r.Benchmark=class{constructor(){this._running=!1,this._results=new Array,this._framePrepare=void 0,this._runsFinished=void 0}initialize(a,n,i,h,p){this._running?console.log("benchmark already in progress"):(this._framePrepare=h,this._runsFinished=p,this._running=!0,this._frames=0,this._runs=Math.max(0,a),this._framesForWarmup=Math.max(0,n),this._framesPerCycle=Math.max(1,i),this._results.length=this._runs,this._results.fill(0))}frame(){if(this._running===!1)return;++this._frames;const a=this._frames-this._framesForWarmup,n=a<0?a:a%this._framesPerCycle,i=a>=0?Math.floor(a/this._framesPerCycle):-1;a===1-this._framesForWarmup&&console.log("---- benchmark warmup ------"),a===0&&console.log("---- benchmark started -----"),a%this._framesPerCycle==0&&i>0&&(this._results[i-1]=(performance.now()-this._results[i-1])/this._framesPerCycle,console.log(" --  cycle: "+i.toString().padStart(2,"0")+", tpf: "+this._results[i-1].toFixed(4).padStart(9,"0")+", fps: "+(1e3/this._results[i-1]).toFixed(4).padStart(9,"0"))),a%this._framesPerCycle==0&&i>=0&&i<this._runs&&(this._results[i]=performance.now()),i>=this._runs?(this._running=!1,console.log("---- benchmark stopped -----"),this._framePrepare=void 0,this._runsFinished(this._runs,this._framesForWarmup,this._framesPerCycle,this._results),this._runsFinished=void 0):this._framePrepare(n,this._framesForWarmup,this._framesPerCycle,i)}get running(){return this._running}}},8196:function(l,r,a){var n=this&&this.__decorate||function(b,v,_,g){var x,T=arguments.length,O=T<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(b,v,_,g);else for(var A=b.length-1;A>=0;A--)(x=b[A])&&(O=(T<3?x(O):T>3?x(v,_,O):x(v,_))||O);return T>3&&O&&Object.defineProperty(v,_,O),O};Object.defineProperty(r,"__esModule",{value:!0}),r.BlitPass=void 0;const i=a(3557),h=a(9504),p=a(5150),d=a(4127),f=a(1896),s=a(4168),o=a(771);class u extends d.Initializable{constructor(v){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=v}functionBlit(){const v=this._context.gl;if(this._target.bind(v.DRAW_FRAMEBUFFER),this._framebuffer.bind(v.READ_FRAMEBUFFER),v.readBuffer(this._readBuffer),this._drawBuffer>=v.COLOR_ATTACHMENT1&&this._drawBuffer<=v.COLOR_ATTACHMENT15){const x=this._drawBuffer-v.COLOR_ATTACHMENT0,T=new Array(x+1).fill(v.NONE);T[x]=this._drawBuffer,v.drawBuffers(T)}else v.drawBuffers([this._drawBuffer]);v.enable(v.SCISSOR_TEST),v.scissor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),v.disable(v.SCISSOR_TEST);const _=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],g=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];v.blitFramebuffer(_[0],_[1],_[2],_[3],g[0],g[1],g[2],g[3],v.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(v.READ_FRAMEBUFFER),this._target.unbind(v.DRAW_FRAMEBUFFER)}programBlit(){this._program===void 0&&this.createProgram(),(0,h.assert)(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const v=this._context.gl,_=this._srcBounds?this._srcBounds:i.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),g=this._dstBounds?this._dstBounds:i.vec4.fromValues(0,0,this._target.width,this._target.height),x=i.vec4.div((0,p.v4)(),_,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),T=i.vec4.div((0,p.v4)(),g,[this._target.width,this._target.height,this._target.width,this._target.height]);v.viewport(g[0],g[1],g[2]-g[0],g[3]-g[1]),v.disable(v.DEPTH_TEST),v.depthMask(!1),this._program.bind(),v.uniform4fv(this._uSrcBounds,x),v.uniform4fv(this._uDstBounds,T),v.uniform1i(this._uNearest,this.filter===v.nearest);const O=this._framebuffer.texture(this._readBuffer);O.bind(v.TEXTURE0);const A=this._context.isWebGL2?v.DRAW_FRAMEBUFFER:v.FRAMEBUFFER;this._target.bind(A),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(A),O.unbind(),v.enable(v.DEPTH_TEST),v.depthMask(!0)}createProgram(){(0,h.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const v=this._context.gl,_=new o.Shader(this._context,v.VERTEX_SHADER,"blit.vert (blit)");_.initialize(a(3354));const g=new o.Shader(this._context,v.FRAGMENT_SHADER,"blit.frag (blit)");return g.initialize(a(6523)),this._program=new s.Program(this._context,"BlitProgram"),this._program.initialize([_,g],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),v.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(v){const _=this._context.gl;return v===void 0?this._ndcTriangle=new f.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._filter=_.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){(0,h.logIf)(!this._target||!this._target.valid,h.LogLevel.Warning,`valid target expected, given ${this._target}`),(0,h.logIf)(!this._framebuffer||!this._framebuffer.valid,h.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const v=this._context.gl;switch(this._readBuffer){case v.DEPTH_ATTACHMENT:case v.STENCIL_ATTACHMENT:case v.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&this._enforceProgramBlit===!1)return this.functionBlit();this.programBlit()}set framebuffer(v){this.assertInitialized(),this._framebuffer=v}set readBuffer(v){this.assertInitialized(),this._readBuffer=v}set drawBuffer(v){this.assertInitialized(),this._drawBuffer=v}set target(v){this.assertInitialized(),this._target=v}set filter(v){this._filter=v}set srcBounds(v){this._srcBounds=v?i.vec4.clone(v):void 0}set dstBounds(v){this._dstBounds=v?i.vec4.clone(v):void 0}set enforceProgramBlit(v){this._enforceProgramBlit=v}}r.BlitPass=u,n([d.Initializable.initialize()],u.prototype,"initialize",null),n([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],u.prototype,"frame",null)},7340:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.Buffer=void 0;const i=a(9504),h=a(4127),p=a(9965);class d extends p.AbstractObject{constructor(){super(...arguments),this._target=d.DEFAULT_BUFFER}create(s){const o=this._context.gl;return this._object=o.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&((0,i.assert)(s===o.ARRAY_BUFFER||s===o.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=s),this._object}delete(){(0,i.assert)(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=d.DEFAULT_BUFFER}bind(){(0,i.assert)(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,d.DEFAULT_BUFFER)}data(s,o,u=!0,b=!0){const v=this.context.gl;u&&this.bind(),v.bufferData(this._target,s,o),b&&this.unbind(),this._valid=v.isBuffer(this._object)&&v.getError()===v.NO_ERROR;const _=typeof s=="number"?s:s.byteLength,g=this._valid?_:0;this.context.allocationRegister.reallocate(this._identifier,g)}subData(s,o,u=0,b=0,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),this.context.gl2facade.bufferSubData(this._target,s,o,u,b),_&&this.unbind(),this._valid=g.getError()===g.NO_ERROR}attribEnable(s,o,u,b=!1,v=0,_=0,g=!0,x=!0){const T=this.context.gl;g&&this.bind(),T.vertexAttribPointer(s,o,u,b,v,_),T.enableVertexAttribArray(s),x&&this.unbind()}attribEnableInt(s,o,u,b=0,v=0,_=!0,g=!0){const x=this.context.gl;_&&this.bind(),x.vertexAttribIPointer(s,o,u,b,v),x.enableVertexAttribArray(s),g&&this.unbind()}attribDisable(s,o=!0,u=!0){const b=this.context.gl;o&&this.bind(),b.disableVertexAttribArray(s),u&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}r.Buffer=d,d.DEFAULT_BUFFER=void 0,n([h.Initializable.assert_initialized()],d.prototype,"bind",null),n([h.Initializable.assert_initialized()],d.prototype,"unbind",null),n([h.Initializable.assert_initialized()],d.prototype,"data",null),n([h.Initializable.assert_initialized()],d.prototype,"attribEnable",null),n([h.Initializable.assert_initialized()],d.prototype,"attribEnableInt",null),n([h.Initializable.assert_initialized()],d.prototype,"attribDisable",null)},3025:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Camera=void 0;const n=a(3557),i=a(5150),h=a(9504),p=a(2813);class d{static calculateFovY(s,o){return 2*Math.atan(.5*s/o)}constructor(s,o,u){this._fovy=d.DEFAULT_FOVY,this._near=d.DEFAULT_NEAR,this._far=d.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=s?n.vec3.clone(s):n.vec3.clone(d.DEFAULT_EYE),this._center=o?n.vec3.clone(o):n.vec3.clone(d.DEFAULT_CENTER),this._up=u?n.vec3.clone(u):n.vec3.clone(d.DEFAULT_UP)}invalidate(s,o,u=!1){s&&(this._view=void 0,this._viewInverse=void 0),o&&(this._projection=void 0,this._projectionInverse=void 0),(s||o||u)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(s){n.vec3.equals(this._eye,s)||(this._eye=n.vec3.clone(s),this.invalidate(!0,!1))}get center(){return this._center}set center(s){n.vec3.equals(this._center,s)||(this._center=n.vec3.clone(s),this.invalidate(!0,!1))}get up(){return this._up}set up(s){n.vec3.equals(this._up,s)||(this._up=n.vec3.clone(s),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(s){this._fovy!==s&&(this._fovy=s,this.invalidate(!1,!0))}set fovx(s){const o=s*h.DEG2RAD,u=2*Math.atan(Math.tan(o/2)*(1/this.aspect))*h.RAD2DEG;this._fovy!==u&&(this._fovy=u,this.invalidate(!1,!0))}fovFromLens(s,o){const u=2*Math.atan(s/(2*o));this.fovx=u*h.RAD2DEG}get near(){return this._near}set near(s){this._near!==s&&(s>=this._far&&(0,h.log)(h.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${s}`),this._near=s,this.invalidate(!1,!0))}get far(){return this._far}set far(s){this._far!==s&&(this._near>=s&&(0,h.log)(h.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${s}`),this._far=s,this.invalidate(!1,!0))}set viewport(s){this._viewport[0]===s[0]&&this._viewport[1]===s[1]||(this._viewport=(0,p.duplicate2)(s),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(s){this._aspect!==s&&(this._aspect=s)}get aspect(){return this._aspect}get view(){return this._view||(this._view=n.mat4.lookAt((0,i.m4)(),this._eye,this._center,this._up)),this._view}get viewInverse(){return this._viewInverse!==void 0||(this._viewInverse=n.mat4.invert((0,i.m4)(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=n.mat4.perspective((0,i.m4)(),this.fovy*h.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return this._projectionInverse!==void 0||(this._projectionInverse=n.mat4.invert((0,i.m4)(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=n.mat4.multiply((0,i.m4)(),this.projection,this.view),this._viewProjection=n.mat4.multiply((0,i.m4)(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return this._viewProjectionInverse!==void 0||(this._viewProjectionInverse=n.mat4.invert((0,i.m4)(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:n.mat4.identity((0,i.m4)())}set postViewProjection(s){this._postViewProjection=s,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(s){this._altered=s}}r.Camera=d,d.DEFAULT_EYE=n.vec3.fromValues(0,0,1),d.DEFAULT_CENTER=n.vec3.fromValues(0,0,0),d.DEFAULT_UP=n.vec3.fromValues(0,1,0),d.DEFAULT_FOVY=45,d.DEFAULT_NEAR=2,d.DEFAULT_FAR=8},7344:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CameraModifier=void 0;const n=a(3025);r.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new n.Camera}set camera(i){this._camera!==i&&(this._camera=i,i!==void 0&&(Object.assign(this._reference,i),this.update()))}}},7858:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Canvas=void 0;const n=a(7032),i=a(3557),h=a(5150),p=a(9504),d=a(2813),f=a(3847),s=a(2527),o=a(8234),u=a(3975),b=a(4602),v=a(8216),_=a(9137),g=a(8870),x=a(5678),T=a(9217);class O extends _.Resizable{constructor(R,P){super(),this._framePrecisionSubject=new n.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new n.ReplaySubject(1),this._frameScaleSubject=new n.ReplaySubject(1),this._frameSizeSubject=new n.ReplaySubject(1),this._element=R instanceof HTMLCanvasElement?R:document.getElementById(R),this._element.addEventListener("webglcontextcreationerror",k=>{console.log(k.statusMessage||"Unknown error")},!1),this.observe(this._element),this._mouseEventProvider=new b.MouseEventProvider(this._element,200),this._touchEventProvider=new g.TouchEventProvider(this._element,200),this._pointerEventProvider=new v.PointerEventProvider(this._element,200),this._keyboardEventProvider=new x.KeyboardEventProvider(this._element,200),this._element.style.touchAction="none";const C=this._element.dataset;let U;this._context=s.Context.request(this._element,P),this.configureController(C),this.configureSizeAndScale(C),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),C.clearColor&&(U=(0,h.parseVec4)(C.clearColor),(0,p.logIf)(U===void 0,p.LogLevel.Warning,`data-clear-color could not be parsed, given '${C.clearColor}'`)),this._clearColor=U?new f.Color((0,d.tuple4)(U)):O.DEFAULT_CLEAR_COLOR;let j=C.accumulationFormat?C.accumulationFormat:O.DEFAULT_FRAME_PRECISION;j in T.Wizard.Precision||(j=O.DEFAULT_FRAME_PRECISION,(0,p.log)(p.LogLevel.Warning,`unknown frame precision '${C.accumulationFormat}' changed to '${j}'`)),this._framePrecision=j,this.framePrecisionNext()}configureController(R){let P,C;this._controller=new o.Controller,this._controller.block(),R.multiFrameNumber&&(P=parseInt(R.multiFrameNumber,10),(0,p.logIf)(isNaN(P),p.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${R.multiFrameNumber}'`)),R.debugFrameNumber&&(C=parseInt(R.debugFrameNumber,10),(0,p.logIf)(isNaN(C),p.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${R.debugFrameNumber}'`)),this._controller.multiFrameNumber=P||O.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=C||0;const U=!!P&&P!==this._controller.multiFrameNumber;(0,p.logIf)(U,p.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${R.multiFrameNumber}'`);const j=!!C&&C!==this._controller.debugFrameNumber;(0,p.logIf)(j,p.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${R.debugFrameNumber}'`)}configureSizeAndScale(R){let P,C;R.frameScale&&(P=(0,h.parseVec2)(R.frameScale),(0,p.logIf)(R.frameScale!==void 0&&P===void 0,p.LogLevel.Warning,`data-frame-scale could not be parsed, given '${R.frameScale}'`)),this._frameScale=P?(0,d.tuple2)(P):[1,1],R.frameSize&&(C=(0,h.parseVec2)(R.frameSize),(0,p.logIf)(R.frameSize!==void 0&&C===void 0,p.LogLevel.Warning,`data-frame-size could not be parsed, given '${R.frameSize}'`)),this._favorSizeOverScale=C!==void 0,this._frameSize=C?(0,d.tuple2)(C):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",R=>{R.preventDefault(),this.onContextLost()},!1),this._element.addEventListener("webglcontextrestored",()=>{this.onContextRestore()},!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){(0,p.log)(p.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){(0,p.log)(p.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const R=this._renderer;this.unbind(),this.bind(R),this._controller.unblock();const P=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=P}retrieveSize(){const R=_.Resizable.elementSize(this._element);R!==void 0?(this._size=[R[0],R[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),this._size[0]===0||this._size[1]===0)return(0,p.log)(p.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(R){this._renderer!==R&&(this.unbind(),R!==void 0&&((0,p.assert)(this._controller.blocked,"expected controller to be blocked"),this._renderer=R,this._renderer.initialize(this.context,P=>this._controller.update(P),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider,keyboardEventProvider:this._keyboardEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){this._renderer!==void 0&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(R){this.bind(R)}get frameScale(){return this._frameScale}set frameScale(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,p.log)(p.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,p.logIf)(R[0]<0||R[0]>8,p.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${R[0]}`),(0,p.logIf)(R[1]<0||R[1]>8,p.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${R[0]}`);const P=i.vec2.create();(0,h.clamp2)(P,R,[0,0],[8,8]);const C=i.vec2.create();i.vec2.mul(C,this._size,P),i.vec2.max(C,[1,1],C),i.vec2.round(C,C),i.vec2.div(P,C,this._size),(0,p.logIf)(!i.vec2.exactEquals(P,R),2,`frame scale was adjusted to ${P.toString()}, given ${R.toString()}`),this._frameScale=(0,d.tuple2)(P),this._frameSize=(0,d.tuple2)(C),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,p.log)(p.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,p.logIf)(R[0]<1||R[0]>8*this._size[0],p.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${R[0]}`),(0,p.logIf)(R[1]<1||R[1]>8*this._size[1],p.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${R[1]}`);const P=i.vec2.create();(0,h.clamp2)(P,R,[1,1],[8*this._size[0],8*this._size[1]]),i.vec2.round(P,P),(0,p.logIf)(!i.vec2.exactEquals(P,R),p.LogLevel.Warning,`frame size was adjusted to ${P.toString()}, given ${R.toString()}`);const C=i.vec2.create();i.vec2.div(C,P,this._size),this._frameScale=(0,d.tuple2)(C),this._frameSize=(0,d.tuple2)(P),this._favorSizeOverScale=!i.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(R){this._clearColor=R,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(R){this._framePrecision=R,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}get keyboardEventProvider(){return this._keyboardEventProvider}testLoseContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.loseContext()}testRestoreContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(R,P){this._eyeGazeEventProvider=new u.EyeGazeEventProvider(R,P)}}r.Canvas=O,O.DEFAULT_CLEAR_COLOR=new f.Color([.203,.227,.25,1]),O.DEFAULT_FRAME_PRECISION=T.Wizard.Precision.auto,O.DEFAULT_MULTI_FRAME_NUMBER=0},8596:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasRecorder=void 0;const n=a(9504);class i{static isSupported(){return window.MediaRecorder!==void 0}static isMIMETypeSupported(p){return MediaRecorder.isTypeSupported(p)}constructor(p){(0,n.assert)(i.isSupported(),"Recording the canvas is not supported."),this._canvas=p,this._state=i.State.INACTIVE,this._images=new Array}start(p,d="video/webm",f=4194304){(0,n.assert)(p>=0,"FPS has to be positive"),(0,n.assert)(this._state===i.State.INACTIVE,"Recorder has to be inactive."),(0,n.assert)(i.isMIMETypeSupported(d),`MIME type: ${d} is not supported.`),this._stream=this._canvas.element.captureStream(p),this._recorder=new MediaRecorder(this._stream,{mimeType:d,bitsPerSecond:f}),this._images.length=0,this._mimeType=d,this._recorder.ondataavailable=s=>this._images.push(s.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=i.State.RECORDING}stop(){(0,n.assert)(this._state!==i.State.INACTIVE,"Recorder must not be inactive.");const p=this._stream.getTracks();(0,n.assert)(p.length===1,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),p[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=i.State.INACTIVE}pause(){(0,n.assert)(this._state!==i.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=i.State.PAUSED}resume(){(0,n.assert)(this._state!==i.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=i.State.RECORDING}frame(){(0,n.assert)(this._state===i.State.RECORDING,"Recorder has to be recording.");const p=this._stream.getTracks();(0,n.assert)(p.length===1,"CanvasRecorder uses unknown implementation of MediaStream API."),(0,n.assert)(this._stream.requestFrame||p[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():p[0].requestFrame()}download(p){const d=URL.createObjectURL(this.blob),f=document.createElement("a");f.style.display="none",f.setAttribute("href",d),f.setAttribute("download",p),document.body.appendChild(f),f.click(),setTimeout(()=>{document.body.removeChild(f),window.URL.revokeObjectURL(d)},256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(p){this._onImagesAvailable=p}}r.CanvasRecorder=i,function(h){(function(p){p[p.INACTIVE=0]="INACTIVE",p[p.RECORDING=1]="RECORDING",p[p.PAUSED=2]="PAUSED"})(h.State||(h.State={}))}(i||(r.CanvasRecorder=i={}))},7564:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ChangeLookup=void 0;const n=a(9504);class i{static alter(p,d){(0,n.assert)(d.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),d.any=!0;const f=p.split("."),s=f.shift();if((0,n.assert)(s===""||d.hasOwnProperty(s),`expected object to have key '${s}' in order to capture alterations`),s!==""&&typeof d[s]!="object")return void(d[s]=!0);if(s!==""&&f.length>0)return void i.alter(f.join("."),d[s]);const o=s!==""?d[s]:d;for(const u of Object.getOwnPropertyNames(o))u!=="any"&&i.alter(u,o)}static reset(p){for(const d of Object.getOwnPropertyNames(p))typeof p[d]!="object"?p[d]=!1:i.reset(p[d])}alter(p){return i.alter(p,this)}reset(){return i.reset(this)}}r.ChangeLookup=i},3847:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Color=void 0;const n=a(3557),i=a(5150),h=a(9504),p=a(2813);class d{static hue2rgb(s,o,u){return(0,h.assert)(u>=-1&&u<=2,"t is expected to be between -1 and 2"),u<0?u+=1:u>1&&(u-=1),6*u<1?s+6*(o-s)*u:2*u<1?o:3*u<2?s+6*(o-s)*(.6666666666666666-u):s}static to2CharHexCode(s){return(s<.060784313725490195?"0":"")+Math.round(255*s).toString(16)}static hsl2rgb(s){const o=(0,p.clampf3)(s,"HSL input");if(o[1]===0)return[o[2],o[2],o[2]];const u=o[2]<.5?o[2]*(1+o[1]):o[2]+o[1]-o[1]*o[2],b=2*o[2]-u;return[d.hue2rgb(b,u,o[0]+.3333333333333333),d.hue2rgb(b,u,o[0]),d.hue2rgb(b,u,o[0]-.3333333333333333)]}static rgb2hsl(s){const o=(0,p.clampf3)(s,"RGB input"),u=[0,0,0],b=Math.min(o[0],o[1],o[2]),v=Math.max(o[0],o[1],o[2]),_=v-b;if(u[2]=.5*(v+b),_===0)return u;u[1]=u[2]<.5?_/(v+b):_/(2-v-b);const g=((v-o[0])/6+_/2)/_,x=((v-o[1])/6+_/2)/_,T=((v-o[2])/6+_/2)/_;return o[0]===v?u[0]=T-x:o[1]===v?u[0]=g-T+.3333333333333333:u[0]=x-g+.6666666666666666,u}static lab2xyz(s){const o=(0,p.clampf3)(s,"LAB input"),u=(100*o[0]+16)/116,b=(256*o[1]-128)/500+u,v=u-(256*o[2]-128)/200,_=Math.pow(b,3),g=Math.pow(u,3),x=Math.pow(v,3);return[.95047*(_>.008856?_:(b-.13793103448275862)/7.787),1*(g>.008856?g:(u-.13793103448275862)/7.787),1.08883*(x>.008856?x:(v-.13793103448275862)/7.787)]}static xyz2lab(s){const o=[s[0]/.95047,s[1]/1,s[2]/1.08883],u=o[0]>.008856?Math.cbrt(o[0]):7.787*o[0]+16/116,b=o[1]>.008856?Math.cbrt(o[1]):7.787*o[1]+16/116,v=o[2]>.008856?Math.cbrt(o[2]):7.787*o[2]+16/116;return(0,p.clampf3)([(116*b-16)/100,(500*(u-b)+128)/256,(200*(b-v)+128)/256])}static xyz2rgb(s){const o=2.04137*s[0]+-.56495*s[1]+-.34469*s[2],u=-.96927*s[0]+1.87601*s[1]+.04156*s[2],b=.01345*s[0]+-.11839*s[1]+1.01541*s[2];return(0,p.clampf3)([o>0?Math.pow(o,.4547069271758437):0,u>0?Math.pow(u,.4547069271758437):0,b>0?Math.pow(b,.4547069271758437):0])}static rgb2xyz(s){const o=(0,p.clampf3)(s,"RGB input"),u=Math.pow(o[0],2.19921875),b=Math.pow(o[1],2.19921875),v=Math.pow(o[2],2.19921875);return[.57667*u+.18555*b+.18819*v,.29738*u+.62735*b+.07527*v,.02703*u+.07069*b+.9911*v]}static lab2rgb(s){return d.xyz2rgb(d.lab2xyz(s))}static rgb2lab(s){return d.xyz2lab(d.rgb2xyz(s))}static cmyk2rgb(s){const o=(0,p.clampf4)(s,"CMYK input"),u=1-o[3];return[(1-o[0])*u,(1-o[1])*u,(1-o[2])*u]}static rgb2cmyk(s){const o=(0,p.clampf3)(s,"RGB input"),u=1-Math.max(o[0],o[1],o[2]),b=1-u,v=b===0?0:1/b;return[(b-o[0])*v,(b-o[1])*v,(b-o[2])*v,u]}static hex2rgba(s){const o=[0,0,0,d.DEFAULT_ALPHA];if(!d.HEX_FORMAT_REGEX.test(s))return(0,h.log)(h.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${s}'`),o;const u=s.startsWith("0x")?2:s.startsWith("#")?1:0,b=Math.floor((s.length-u)/3),v=b-1;return o[0]=parseInt(s[u+0*b]+s[u+0*b+v],16)/255,o[1]=parseInt(s[u+1*b]+s[u+1*b+v],16)/255,o[2]=parseInt(s[u+2*b]+s[u+2*b+v],16)/255,s.length-u!=4&&s.length-u!=8||(o[3]=parseInt(s[u+3*b]+s[u+3*b+v],16)/255),(0,h.assert)(!(isNaN(o[0])||isNaN(o[1])||isNaN(o[2])||isNaN(o[3])),`expected well formated hexadecimal RGBA string, given '${s}'`),o}static rgb2hex(s){const o=(0,p.clampf3)(s,"RGB input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])}static rgba2hex(s){const o=(0,p.clampf4)(s,"RGBA input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])+d.to2CharHexCode(o[3])}static lerp(s,o,u,b=d.Space.LAB){if(u<=0)return new d(s.rgba);if(u>=1)return new d(o.rgba);const v=n.vec4.create();switch(b){case d.Space.CMYK:n.vec4.lerp(v,s.cmyk,o.cmyk,u);const _=(0,i.mix)(s.a,o.a,u);return new d().fromCMYK(v[0],v[1],v[2],v[3],_);case d.Space.LAB:return n.vec4.lerp(v,s.laba,o.laba,u),new d().fromLAB(v[0],v[1],v[2],v[3]);case d.Space.HSL:return n.vec4.lerp(v,s.hsla,o.hsla,u),new d().fromHSL(v[0],v[1],v[2],v[3]);case d.Space.RGB:return n.vec4.lerp(v,s.rgba,o.rgba,u),new d().fromRGB(v[0],v[1],v[2],v[3])}}constructor(s,o){this._rgba=[0,0,0,d.DEFAULT_ALPHA],this._altered=!1,s!==void 0&&(s.length===3&&o!==void 0?this.fromF32(s[0],s[1],s[2],o):s.length===4?(this.fromF32(s[0],s[1],s[2],s[3]),(0,h.assert)(o===void 0,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(s[0],s[1],s[2]))}equals(s){return(0,p.equals4)(this._rgba,s._rgba)}fromF32(s,o,u,b=d.DEFAULT_ALPHA){const v=(0,p.duplicate4)(this._rgba);return this._rgba[0]=(0,p.clampf)(s,"red value"),this._rgba[1]=(0,p.clampf)(o,"green value"),this._rgba[2]=(0,p.clampf)(u,"blue value"),this._rgba[3]=(0,p.clampf)(b,"alpha value"),this._altered=!(0,p.equals4)(this._rgba,v),this}fromUI8(s,o,u,b=Math.floor(255*d.DEFAULT_ALPHA)){const v=(0,p.duplicate4)(this._rgba);return this._rgba[0]=(0,i.clamp)(s,0,255)/255,this._rgba[1]=(0,i.clamp)(o,0,255)/255,this._rgba[2]=(0,i.clamp)(u,0,255)/255,this._rgba[3]=(0,i.clamp)(b,0,255)/255,this._altered=!(0,p.equals4)(this._rgba,v),this}fromRGB(s,o,u,b=d.DEFAULT_ALPHA){const v=(0,p.duplicate4)(this._rgba);return this._rgba=(0,p.clampf4)([s,o,u,b],"RGBA input"),this._altered=!(0,p.equals4)(this._rgba,v),this}fromHSL(s,o,u,b=d.DEFAULT_ALPHA){const v=(0,p.duplicate4)(this._rgba),_=d.hsl2rgb([s,o,u]),g=(0,p.clampf)(b,"ALPHA input");return this._rgba=[_[0],_[1],_[2],g],this._altered=!(0,p.equals4)(this._rgba,v),this}fromLAB(s,o,u,b=d.DEFAULT_ALPHA){const v=(0,p.duplicate4)(this._rgba),_=d.lab2rgb([s,o,u]),g=(0,p.clampf)(b,"ALPHA input");return this._rgba=[_[0],_[1],_[2],g],this._altered=!(0,p.equals4)(this._rgba,v),this}fromCMYK(s,o,u,b,v=d.DEFAULT_ALPHA){const _=(0,p.duplicate4)(this._rgba),g=d.cmyk2rgb([s,o,u,b]),x=(0,p.clampf)(v,"ALPHA input");return this._rgba=[g[0],g[1],g[2],x],this._altered=!(0,p.equals4)(this._rgba,_),this}fromHex(s){const o=(0,p.duplicate4)(this._rgba);return this._rgba=d.hex2rgba(s),this._altered=!(0,p.equals4)(this._rgba,o),this}gray(s=d.GrayscaleAlgorithm.LinearLuminance){switch(s){case d.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case d.GrayscaleAlgorithm.LeastSaturatedVariant:return .5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case d.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.LinearLuminance:return .2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(s,o=!0){switch(s){case d.Space.RGB:return o?this.rgba:this.rgb;case d.Space.LAB:return o?this.laba:this.lab;case d.Space.CMYK:return o?this.cmyka:this.cmyk;case d.Space.HSL:return o?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const s=new Uint8Array(3);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s}get rgbF32(){const s=new Float32Array(3);return s[0]=this._rgba[0],s[1]=this._rgba[1],s[2]=this._rgba[2],s}get rgba(){return this._rgba}get rgbaUI8(){const s=new Uint8Array(4);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s[3]=Math.round(255*this._rgba[3]),s}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return d.rgb2hex(this.rgb)}get hexRGBA(){return d.rgba2hex(this._rgba)}get hsl(){return d.rgb2hsl(this.rgb)}get hsla(){const s=d.rgb2hsl(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get lab(){return d.rgb2lab(this.rgb)}get laba(){const s=d.rgb2lab(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get cmyk(){return d.rgb2cmyk(this.rgb)}get cmyka(){const s=d.rgb2cmyk(this.rgb);return[s[0],s[1],s[2],s[3],this._rgba[3]]}get altered(){return this._altered}set altered(s){this._altered=s}}r.Color=d,d.DEFAULT_ALPHA=1,d.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(f){(function(s){s.Average="average",s.LinearLuminance="linear-luminance",s.LeastSaturatedVariant="least-saturated-variant",s.MinimumDecomposition="minimum-decomposition",s.MaximumDecomposition="maximum-decomposition"})(f.GrayscaleAlgorithm||(f.GrayscaleAlgorithm={})),function(s){s.RGB="rgb",s.HSL="hsl",s.LAB="lab",s.CMYK="cmyk"}(f.Space||(f.Space={}))}(d||(r.Color=d={}))},5837:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorScale=void 0;const n=a(5150),i=a(9504),h=a(3847),p=a(64);class d{constructor(){this._hint=d.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(s){switch(s){case d.ArrayType.RGBA:case d.ArrayType.RGBAf:return 4;case d.ArrayType.RGB:case d.ArrayType.RGBf:default:return 3}}static fromPreset(s,o,u){return(0,p.fetchJsonAsync)(s,b=>{let v;for(const P of b)if(P.identifier===o){v=P;break}if(v===void 0)return;const _=v.format,g=d.stride(_),x=v.colors;let T=x.length-1;for(let P=0;P<x.length;++P)if(x[P].length===u*g){T=P;break}const O=x[T],A=v.positions;if(A===void 0)return d.fromArray(O,_,u,void 0);let R;for(let P=0;P<A.length;++P)A[P].length===O.length&&(R=A[P]);return d.fromArray(O,_,u,R)},d.SCHEMA.properties)}static fromArray(s,o,u,b){if(u===0||s.length===0)return new d;const v=s,_=d.stride(o),g=v.length/_,x=new Array(g);for(let P=0;P<v.length;P+=_){const C=new h.Color;switch(o){case d.ArrayType.RGB:C.fromUI8(v[P+0],v[P+1],v[P+2]);break;case d.ArrayType.RGBA:C.fromUI8(v[P+0],v[P+1],v[P+2],v[P+3]);break;case d.ArrayType.RGBf:C.fromF32(v[P+0],v[P+1],v[P+2]);break;case d.ArrayType.RGBAf:C.fromF32(v[P+0],v[P+1],v[P+2],v[P+3])}x[P/_]=C}const T=new d;if(b===void 0&&u===g)return T._colors=x,T;if(u===1&&T._colors.push(x[0]),b===void 0){(b=new Array(g))[0]=0;for(let P=1;P<g;++P)b[P]=P/(g-1)}(0,i.assert)(b.length===x.length,`expected number of positions (${b.length}) to match number of colors (${x.length})`);let O=0,A=O+1;const R=g-1;for(let P=0;P<u;++P){const C=P===0?0:P/(u-1);if(C<=b[O]){T._colors.push(x[O]);continue}if(b[R]<=C){T._colors.push(x[R]);continue}for(let j=O+1;j<g;++j)if(!(b[j]<C)){A=j,O=j-1;break}const U=(C-b[O])/(b[A]-b[O]);T._colors.push(h.Color.lerp(x[O],x[A],U,h.Color.Space.LAB))}return T}lerp(s,o=h.Color.Space.LAB){if(this._colors.length===0)return;if(this._colors.length===1)return this._colors[0];const u=(0,n.clamp)(s,0,1);if(u<=0)return this._colors[0];if(u>=1)return this._colors[this._colors.length-1];const b=s*this._colors.length,v=Math.floor(b),_=v+1;return _>=this._colors.length?this._colors[this._colors.length-1]:((0,i.assert)(_<this._colors.length,`expected upper not exceed maximum color index: ${_} < ${this._colors.length}`),this._hint===d.InterpolationHint.Nearest?this._colors[b-v<=_-b?v:_]:h.Color.lerp(this._colors[v],this._colors[_],b-v,o))}color(s){if(!(s<0||s>=this._colors.length))return this._colors[s]}get colors(){return this._colors}set colors(s){this._colors=s}set hint(s){this._hint=s}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(s=h.Color.Space.RGB,o=!0){const u=this._colors.length,b=o?4:3,v=new Uint8Array(u*b);for(let _=0;_<u;++_){const g=this._colors[_].tuple(s,o);v[_*b+0]=255*g[0],v[_*b+1]=255*g[1],v[_*b+2]=255*g[2],o&&g.length===4&&(v[_*b+3]=255*g[3])}return v}bitsF32(s=h.Color.Space.RGB,o=!0){const u=this._colors.length,b=o?4:3,v=new Float32Array(u*b);for(let _=0;_<u;++_){const g=this._colors[_].tuple(s,o);v[_*b+0]=g[0],v[_*b+1]=g[1],v[_*b+2]=g[2],o&&g.length===4&&(v[_*b+3]=g[3])}return v}}r.ColorScale=d,d.SCHEMA=a(421),function(f){(function(s){s.Linear="linear",s.Nearest="nearest"})(f.InterpolationHint||(f.InterpolationHint={})),function(s){s.sequential="sequential",s.diverging="diverging",s.qualitative="qualitative"}(f.ScaleType||(f.ScaleType={})),function(s){s.RGB="rgb",s.RGBf="rgbf",s.RGBA="rgba",s.RGBAf="rgbaf"}(f.ArrayType||(f.ArrayType={}))}(d||(r.ColorScale=d={}))},2527:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Context=void 0;const n=a(9504),i=a(3513),h=a(7501),p=a(5557),d=a(5304),f=a(5060),s=a(829);class o{static createMasqueradeFromGETorDataAttribute(b){return p.ContextMasquerade.fromGET()||(b.msqrdH?p.ContextMasquerade.fromHash(b.msqrdH):b.msqrdP?p.ContextMasquerade.fromPreset(b.msqrdP):void 0)}static request(b,v=o.DEFAULT_ATTRIBUTES){const _=b.dataset,g=o.createMasqueradeFromGETorDataAttribute(_);let x,T=g?g.backend:_.backend?_.backend.toLowerCase():"auto";switch(T in o.BackendRequestType||((0,n.log)(n.LogLevel.Warning,`unknown backend '${_.backend}' changed to '${o.BackendRequestType.auto}'`),T="auto"),T){case o.BackendRequestType.webgl:break;case o.BackendRequestType.experimental:case o.BackendRequestType.webgl1:case o.BackendRequestType.experimental1:T=o.BackendRequestType.webgl;break;case o.BackendRequestType.webgl2:case o.BackendRequestType.experimental2:T=o.BackendRequestType.webgl2;break;default:T=o.BackendRequestType.auto}return T!==o.BackendRequestType.webgl&&(x=this.requestWebGL2(b,v)),x||(x=this.requestWebGL1(b,v),(0,n.logIf)(x!==void 0&&T===o.BackendRequestType.webgl2,n.LogLevel.Info,`backend changed to '${o.BackendRequestType.webgl}', given '${T}'`)),(0,n.assert)(!!x,"creating a context failed"),new o(x,g)}static requestWebGL1(b,v=o.DEFAULT_ATTRIBUTES){let _=b.getContext(o.BackendRequestType.webgl,v);return _||(_=b.getContext(o.BackendRequestType.experimental,v),_===null?void 0:_)}static requestWebGL2(b,v=o.DEFAULT_ATTRIBUTES){let _=b.getContext(o.BackendRequestType.webgl2,v);return _||(_=b.getContext(o.BackendRequestType.experimental2,v),_===null?void 0:_)}queryAttributes(){const b=this._context.getContextAttributes();b!==null?this._attributes=b:(0,n.log)(n.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(b){if(this._mask&&this._mask.extensionsConceal.indexOf(b)>-1)return!1;switch(this._backend){case o.BackendType.WebGL1:(0,n.assert)(d.WEBGL1_EXTENSIONS.indexOf(b)>-1,`extension ${b} not available to WebGL1`);break;case o.BackendType.WebGL2:(0,n.assert)(d.WEBGL2_DEFAULT_EXTENSIONS.indexOf(b)===-1,`extension ${b} supported by default in WebGL2`),(0,n.assert)(d.WEBGL2_EXTENSIONS.indexOf(b)>-1,`extension ${b} not available to WebGL2`)}return this._extensions.indexOf(b)>-1}enable(b){for(const v of b)this.isWebGL1&&d.WEBGL1_EXTENSIONS.indexOf(v)===-1||this.isWebGL2&&d.WEBGL2_EXTENSIONS.indexOf(v)===-1||this.supports(v)!==!1&&this.extension(void 0,v)}queryExtensionSupport(){const b=this._context.getSupportedExtensions();if(b!==null){for(const v of b)this._mask&&this._mask.extensionsConceal.indexOf(v)>-1||this._extensions.push(v);this._backend===o.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===o.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else(0,n.log)(n.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(b,v){return b===void 0&&((0,n.assert)(this.supports(v),`extension ${v} expected to be supported`),b=this._context.getExtension(v)),b}constructor(b,v){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new h.AllocationRegister,this._context=b,this._mask=v;const _=b.toString();{const g=/WebGLRenderingContext/.test(_)||/CaptureContext/.test(_),x=/WebGL2RenderingContext/.test(_);this._backend=g?o.BackendType.WebGL1:x?o.BackendType.WebGL2:void 0}if((0,n.assert)(this._backend!==void 0&&this._backend.valueOf()!==o.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${_}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const g in this._mask.functionsUndefine)this._context[g]=void 0;this._gl2=new s.GL2Facade(this)}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case o.BackendType.WebGL1:return"WebGL";case o.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===o.BackendType.WebGL1}get isWebGL2(){return this._backend===o.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case o.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case o.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return this._context.blitFramebuffer!==void 0}get supportsReadBuffer(){return this._context.readBuffer!==void 0}get supportsTexImage3D(){return this._context.texImage3D!==void 0}param(b){return(0,n.assert)(!!this._context,"expected context to be valid"),this._context.getParameter(b)}hash(){return f.ExtensionsHash.encode(this._backend,this._extensions)}about(){const b="ok",v="na";if(this._backend===o.BackendType.Invalid)return new Array;(0,n.assert)(!!this._context,"expected context to be valid");const _=this._context,g=new Array;g.push(["BACKEND (GLOPERATE)",this.backend]),g.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),g.push(["RENDERER",this.param(_.RENDERER)]),g.push(["VENDOR",this.param(_.VENDOR)]),g.push(["VERSION",this.param(_.VERSION)]),g.push(["SHADING_LANGUAGE_VERSION",this.param(_.SHADING_LANGUAGE_VERSION)]),g.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):v]),g.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):v]),g.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),g.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),g.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),g.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),g.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),g.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),g.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),g.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),g.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),g.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),g.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),g.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),g.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),g.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),g.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),g.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(_.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(_.MAX_CUBE_MAP_TEXTURE_SIZE)]),g.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(_.MAX_FRAGMENT_UNIFORM_VECTORS)]),g.push(["MAX_RENDERBUFFER_SIZE",this.param(_.MAX_RENDERBUFFER_SIZE)]),g.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(_.MAX_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_TEXTURE_SIZE",this.param(_.MAX_TEXTURE_SIZE)]),g.push(["MAX_VARYING_VECTORS",this.param(_.MAX_VARYING_VECTORS)]),g.push(["MAX_VERTEX_ATTRIBS",this.param(_.MAX_VERTEX_ATTRIBS)]),g.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(_.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),g.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(_.MAX_VERTEX_UNIFORM_VECTORS)]);const x=this.param(_.MAX_VIEWPORT_DIMS);if(g.push(["MAX_VIEWPORT_DIMS (WIDTH)",x?x[0]:null]),g.push(["MAX_VIEWPORT_DIMS (HEIGHT)",x?x[1]:null]),this.isWebGL2){const T=this._context;g.push(["MAX_3D_TEXTURE_SIZE",this.param(T.MAX_3D_TEXTURE_SIZE)]),g.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(T.MAX_ARRAY_TEXTURE_LAYERS)]),g.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(T.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),g.push(["MAX_COLOR_ATTACHMENTS",this.param(T.MAX_COLOR_ATTACHMENTS)]),g.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(T.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),g.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(T.MAX_COMBINED_UNIFORM_BLOCKS)]),g.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(T.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),g.push(["MAX_DRAW_BUFFERS",this.param(T.MAX_DRAW_BUFFERS)]),g.push(["MAX_ELEMENT_INDEX",this.param(T.MAX_ELEMENT_INDEX)]),g.push(["MAX_ELEMENTS_INDICES",this.param(T.MAX_ELEMENTS_INDICES)]),g.push(["MAX_ELEMENTS_VERTICES",this.param(T.MAX_ELEMENTS_VERTICES)]),g.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(T.MAX_FRAGMENT_INPUT_COMPONENTS)]),g.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(T.MAX_FRAGMENT_UNIFORM_BLOCKS)]),g.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(T.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),g.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(T.MAX_PROGRAM_TEXEL_OFFSET)]),g.push(["MAX_SAMPLES",this.param(T.MAX_SAMPLES)]),g.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(T.MAX_SERVER_WAIT_TIMEOUT)]),g.push(["MAX_TEXTURE_LOD_BIAS",this.param(T.MAX_TEXTURE_LOD_BIAS)]),g.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(T.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),g.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(T.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),g.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(T.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),g.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(T.MAX_UNIFORM_BLOCK_SIZE)]),g.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(T.MAX_UNIFORM_BUFFER_BINDINGS)]),g.push(["MAX_VARYING_COMPONENTS",this.param(T.MAX_VARYING_COMPONENTS)]),g.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(T.MAX_VERTEX_OUTPUT_COMPONENTS)]),g.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(T.MAX_VERTEX_UNIFORM_BLOCKS)]),g.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(T.MAX_VERTEX_UNIFORM_COMPONENTS)]),g.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(T.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const T of d.WEBGL1_EXTENSIONS)g.push([T,this.supports(T)?b:v]);else if(this.isWebGL2){for(const T of d.WEBGL2_DEFAULT_EXTENSIONS)g.push([`${T} (default)`,b]);for(const T of d.WEBGL2_EXTENSIONS)g.push([T,this.supports(T)?b:v])}return g}aboutString(){const b=this.about();let v=0;for(const T of b)v=Math.max(T[0].length,v);let _=0,g="";const x=this.isWebGL2?63+d.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const T of b){switch(_){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case x:g+=`
`}g+=`  ${T[0]} ${"-".repeat(v-T[0].length)}-- ${T[1]}
`,++_}return g+=`
`,g}logAbout(b=n.LogLevel.Info){(0,n.log)(b,`context.about

`+this.aboutString())}logAboutIf(b,v=n.LogLevel.Info){(0,n.logIf)(b,v,`context.about

`+this.aboutString())}byteSizeOfFormat(b){return(0,i.byteSizeOfFormat)(this,b)}}r.Context=o,o.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(u){(function(b){b.Invalid="invalid",b.WebGL1="webgl1",b.WebGL2="webgl2"})(u.BackendType||(u.BackendType={})),function(b){b.auto="auto",b.webgl="webgl",b.experimental="experimental-webgl",b.webgl1="webgl1",b.experimental1="experimental-webgl1",b.webgl2="webgl2",b.experimental2="experimental-webgl2"}(u.BackendRequestType||(u.BackendRequestType={}))}(o||(r.Context=o={}))},5557:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ContextMasquerade=void 0;const n=a(9504),i=a(5060);class h{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(d){const f=new h,s=i.ExtensionsHash.decode(d);return f._backend=s[0],f._extensionsStrive=s[1],f._extensionsConceal=i.ExtensionsHash.complement(f._backend,f._extensionsStrive),f}static fromPreset(d){const f=new h,s=new Array;let o;for(const u of h.presets())if(s.push(u.identifier),u.identifier===d){o=u;break}if(o===void 0&&(0,n.assert)(!1,`expected valid identifier, available ['${s.join("', '")}'], given '${d}'`),o.extensions_hash!==void 0){const u=i.ExtensionsHash.decode(o.extensions_hash);f._backend=u[0],f._extensionsStrive=u[1]}else f._backend=o.backend;return(0,n.assert)(f._backend!==void 0,"expected backend to be included in preset"),o.extensions_strive===void 0?(f._extensionsStrive=[],f._extensionsConceal=o.extensions_conceal?o.extensions_conceal:[]):(f._extensionsStrive=o.extensions_strive,f._extensionsConceal=i.ExtensionsHash.complement(f._backend,o.extensions_strive)),f._functionsUndefine=o.functions_undefine?o.functions_undefine:[],f}static fromGET(){const d=(0,n.GETparameter)("msqrd_h");if(d!==void 0)return h.fromHash(d);const f=(0,n.GETparameter)("msqrd_p");return f!==void 0?h.fromPreset(f):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}r.ContextMasquerade=h,h.MASQUERADE_JSON=a(7857)},8234:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Controller=void 0;const n=a(7032),i=a(9504),h=a(5150);class p{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new n.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new n.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new n.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new n.Subject,this._postSwapEventSubject=new n.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(f){f&&(0,i.logVerbosity)()<i.LogLevel.Debug&&((0,i.logVerbosity)(i.LogLevel.Debug),(0,i.log)(i.LogLevel.Debug,`changed log verbosity to ${i.LogLevel.Debug} (debug)`)),p._debug=f}set batch(f){(0,i.log)(i.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,f)}request(f=p.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame(()=>this.invoke(f))}invoke(f){if(this._animationFrameID!==0){if((0,i.assert)(this._controllable!==void 0,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),f===p.RequestType.Frame&&this._frameNumber===1)return this._timeoutID===void 0&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return(0,i.logIf)(p._debug,i.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){(0,i.logIf)(p._debug,i.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const f=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=f,this._updateFrameTime=f}invokeFrameAndSwap(){(0,i.logIf)(p._debug,i.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const f=this._debugFrameNumber>0;(0,i.assert)(!f||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const s=performance.now();let o=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(o=Math.min(o,this._debugFrameNumber));this._frameNumber<o;++this._frameNumber)(0,i.logIf)(p._debug,i.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;(0,i.logIf)(p._debug,i.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const u=this._multiTime[1]-s;this._multiFrameTime+=u,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],u),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],u),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout(()=>{this.request(p.RequestType.MultiFrame),this._timeoutID=void 0},this._multiFrameDelay)}cancelWaitMultiFrame(){this._timeoutID!==void 0&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(f=!1){this._invalidated=!0,this._force=this._force||f,this._animationFrameID===0&&this.request()}block(){(0,i.logIf)(p._debug,i.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){(0,i.logIf)(p._debug,i.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){this._animationFrameID!==0&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(f){f!==this._controllable&&(this._controllable=f,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(f){const s=Math.max(1,isNaN(f)?1:f);s!==this._multiFrameNumber&&(this._multiFrameNumber=s,this.multiFrameNumberNext(),(0,i.logIf)(s!==f,i.LogLevel.Debug,`multi-frame number adjusted to ${s}, given ${f}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(f){const s=(0,h.clamp)(isNaN(f)?0:f,0,this.multiFrameNumber);s!==this._debugFrameNumber&&(this._debugFrameNumber=s,this.debugFrameNumberNext(),(0,i.logIf)(s!==f,i.LogLevel.Debug,`debug-frame number adjusted to ${s}, given ${f}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(f){const s=Math.max(0,f);s!==this._multiFrameDelay&&(this._multiFrameDelay=s)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return this._frameNumber===0?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return this._frameNumber===0?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return this._frameNumber===0?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}r.Controller=p,p._debug=!1,function(d){(function(f){f[f.Frame=0]="Frame",f[f.MultiFrame=1]="MultiFrame"})(d.RequestType||(d.RequestType={}))}(p||(r.Controller=p={}))},6710:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CuboidGeometry=void 0;const n=a(3557),i=a(7340),h=a(638);class p extends h.Geometry{constructor(f,s,o=!1,u=[1,1,1]){super(f,s),this._vertexLocation=0,this._extent=n.vec3.fromValues(1,1,1),this._uvCoordinates=!1,s=s!==void 0&&s!==""?s:this.constructor.name;const b=new i.Buffer(f,s+"VBO");this._buffers.push(b);const v=new i.Buffer(f,`${s}IndicesVBO`);this._buffers.push(v),this._extent=n.vec3.clone(u),this._uvCoordinates=o}bindBuffers(){this._uvCoordinates===!1?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(f=0,s=1){this._vertexLocation=f,this._uvCoordLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[f,s]),b=this._uvCoordinates;let v=b?p.VERTICES_UV:p.VERTICES;return v=v.map((_,g)=>_*(b===!1?.5*this._extent[g%3]:g%5<3?.5*this._extent[g%5]:1)),this._buffers[0].data(v,o.STATIC_DRAW),this._buffers[1].data(b?p.INDICES_UV:p.INDICES,o.STATIC_DRAW),this._count=b?p.INDICES_UV.length:p.INDICES.length,u}draw(){const f=this.context.gl;f.drawElements(f.TRIANGLE_STRIP,this._count,f.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}get count(){return this._count}}r.CuboidGeometry=p,p.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),p.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),p.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),p.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},4890:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GeosphereGeometry=void 0;const n=a(9504),i=a(7340),h=a(638),p=a(5431);class d extends h.Geometry{constructor(s,o,u=1,b=!0){super(s,o),this._diameter=1,this._textured=!1,this._size=0,o=o!==void 0&&o!==""?o:this.constructor.name,this._diameter=u,this._textured=b;const v=new i.Buffer(s,o+"IndexBuffer");this._buffers.push(v);const _=new i.Buffer(s,o+"VBO");if(this._buffers.push(_),this._textured){const g=new i.Buffer(s,o+"UV");this._buffers.push(g)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(s=0,o=1){const u=this.context.gl;this._vertexLocation=s,this._texCoordLocation=o;const b=super.initialize([u.ELEMENT_ARRAY_BUFFER,u.ARRAY_BUFFER,u.ARRAY_BUFFER],[8,s,o]);(0,n.assert)(this._buffers[0]!==void 0&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),(0,n.assert)(this._buffers[1]!==void 0&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&(0,n.assert)(this._buffers[2]!==void 0&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const v=new p.Icosahedron;v.generateGeometry(3),this._textured&&v.generateTextureCoordinates();const _=v.faces,g=new Uint16Array(3*_.length);let x=0;for(const A of _)g[x+0]=A[0],g[x+1]=A[1],g[x+2]=A[2],x+=3;this._buffers[0].data(g,u.STATIC_DRAW),this._size=3*_.length;const T=v.vertices,O=new Float32Array(3*T.length);x=0;for(const A of T)O[x+0]=A[0]*this._diameter,O[x+1]=A[1]*this._diameter,O[x+2]=A[2]*this._diameter,x+=3;if(this._buffers[1].data(O,u.STATIC_DRAW),this._textured){const A=v.texcoords,R=new Float32Array(2*A.length);if(A&&A.length>0){x=0;for(const P of A)R[x+0]=P[0],R[x+1]=P[1],x+=2}this._buffers[2].data(R,u.STATIC_DRAW)}return b}draw(){const s=this.context.gl;s.drawElements(s.TRIANGLES,this._size,s.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}r.GeosphereGeometry=d},5431:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Icosahedron=void 0;const n=a(3557),i=a(5150);r.Icosahedron=class{constructor(){}baseVertices(){const h=.5*(1+Math.sqrt(5)),p=1/Math.sqrt(h*h+1),d=h*p;return[n.vec3.fromValues(-p,+d,0),n.vec3.fromValues(+p,+d,0),n.vec3.fromValues(-p,-d,0),n.vec3.fromValues(+p,-d,0),n.vec3.fromValues(0,-p,+d),n.vec3.fromValues(0,+p,+d),n.vec3.fromValues(0,-p,-d),n.vec3.fromValues(0,+p,-d),n.vec3.fromValues(+d,0,-p),n.vec3.fromValues(+d,0,+p),n.vec3.fromValues(-d,0,-p),n.vec3.fromValues(-d,0,+p)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(h,p,d){const f=new Map;for(let s=0;s<d;s++){const o=p.length;for(let u=0;u<o;u++){const b=p[u],v=b[0],_=b[1],g=b[2],x=this.split(v,_,h,f),T=this.split(_,g,h,f),O=this.split(g,v,h,f);p[u]=[x,T,O],p.push([v,x,O]),p.push([_,T,x]),p.push([g,O,T])}}}split(h,p,d,f){const s=h<p,o=((s?h:p)<<16)+(s?p:h);if(f.has(o))return f.get(o);const u=n.vec3.add((0,i.v3)(),d[h],d[p]);n.vec3.normalize(u,u),d.push(u);const b=d.length-1;return f.set(o,b),b}generateGeometry(h){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),h>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(h,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const h of this._vertices){const p=n.vec3.normalize((0,i.v3)(),h),d=n.vec2.fromValues(.5-Math.atan2(p[2],p[0])/(2*Math.PI),Math.asin(p[1])/Math.PI+.5);this._texcoords.push(d)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},1854:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ResourceManager=r.PlaneGeometry=r.GeosphereGeometry=r.Icosahedron=r.CuboidGeometry=void 0;var n=a(6710);Object.defineProperty(r,"CuboidGeometry",{enumerable:!0,get:function(){return n.CuboidGeometry}});var i=a(5431);Object.defineProperty(r,"Icosahedron",{enumerable:!0,get:function(){return i.Icosahedron}});var h=a(4890);Object.defineProperty(r,"GeosphereGeometry",{enumerable:!0,get:function(){return h.GeosphereGeometry}});var p=a(8500);Object.defineProperty(r,"PlaneGeometry",{enumerable:!0,get:function(){return p.PlaneGeometry}});var d=a(6449);Object.defineProperty(r,"ResourceManager",{enumerable:!0,get:function(){return d.ResourceManager}})},8500:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PlaneGeometry=void 0;const n=a(3557),i=a(7340),h=a(638);class p extends h.Geometry{constructor(f,s){super(f,s),this._vertexLocation=0,this._texCoordLocation=1,this._translation=n.vec3.fromValues(0,0,0),this._scale=n.vec3.fromValues(1,1,1),this._rotation=n.quat.create(),s=s!==void 0&&s!==""?s:this.constructor.name;const o=new i.Buffer(f,s+"VertexVBO"),u=new i.Buffer(f,s+"TexCoordVBO"),b=new i.Buffer(f,s+"IndexBuffer");this._buffers.push(o),this._buffers.push(u),this._buffers.push(b)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(f=0,s=1){const o=this.context.gl;this._vertexLocation=f,this._texCoordLocation=s;const u=super.initialize([o.ARRAY_BUFFER,o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[f,s,8]);return this._buffers[0].data(p.VERTICES,o.STATIC_DRAW),this._buffers[1].data(p.UV,o.STATIC_DRAW),this._buffers[2].data(p.INDICES,o.STATIC_DRAW),u}draw(){const f=this.context.gl;f.drawElements(f.TRIANGLE_STRIP,p.INDICES.length,f.UNSIGNED_BYTE,0)}set translation(f){this._translation=f}set scale(f){this._scale=n.vec3.fromValues(f[0],1,f[1])}set rotation(f){this._rotation=f}get transformation(){const f=n.mat4.create();return n.mat4.fromRotationTranslationScale(f,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}r.PlaneGeometry=p,p.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),p.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),p.INDICES=new Uint8Array([0,1,2,3])},6449:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ResourceManager=void 0;const n=a(9504),i=a(7340),h=a(638),p=a(5315),d=a(8593);r.ResourceManager=class{constructor(f){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=f}fetchTexture2D(f,s,o=!1){if(this._texture2Ds.has(f))return;const u=new d.Texture2D(this._context,f);return(0,n.assert)(u.identifier===f,"expected object identifier to be unchanged"),this._texture2Ds.set(f,u),u.fetch(s,o)}add(f,s){const o=new Array;if(f instanceof d.Texture2D){const u=f;for(const b of s)this._texture2Ds.has(b)||(this._texture2Ds.set(b,u),o.push(b))}if(f instanceof p.Material){const u=f;for(const b of s)this._materials.has(b)||(this._materials.set(b,u),o.push(b))}if(f instanceof h.Geometry){const u=f;for(const b of s)this._geometries.has(b)||(this._geometries.set(b,u),o.push(b))}if(f instanceof i.Buffer){const u=f;for(const b of s)this._buffers.has(b)||(this._buffers.set(b,u),o.push(b))}return o}get(f){return this._texture2Ds.has(f)?this._texture2Ds.get(f):this._materials.has(f)?this._materials.get(f):this._geometries.has(f)?this._geometries.get(f):this._buffers.has(f)?this._buffers.get(f):void 0}uninitialize(){for(const f of Array.from(this._geometries.values()))f.initialized&&f.uninitialize();this._geometries.clear();for(const f of Array.from(this._texture2Ds.values()))f.initialized&&f.uninitialize();this._texture2Ds.clear();for(const f of Array.from(this._buffers.values()))f.initialized&&f.uninitialize();this._buffers.clear(),this._materials.clear()}}},2016:function(l,r,a){var n=this&&this.__createBinding||(Object.create?function(s,o,u,b){b===void 0&&(b=u);var v=Object.getOwnPropertyDescriptor(o,u);v&&!("get"in v?!o.__esModule:v.writable||v.configurable)||(v={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(s,b,v)}:function(s,o,u,b){b===void 0&&(b=u),s[b]=o[u]}),i=this&&this.__setModuleDefault||(Object.create?function(s,o){Object.defineProperty(s,"default",{enumerable:!0,value:o})}:function(s,o){s.default=o}),h=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var o={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&n(o,s,u);return i(o,s),o};Object.defineProperty(r,"__esModule",{value:!0}),r.debug=void 0;const p=h(a(1728)),d=h(a(5657));var f;(function(s){s.TestRenderer=d.TestRenderer,s.TestNavigation=p.TestNavigation})(f||(r.debug=f={}))},1728:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TestNavigation=void 0;const n=a(2);r.TestNavigation=class{constructor(i,h){this._altered=!1,this._eventHandler=new n.EventHandler(i,h),this._eventHandler.pushMouseEnterHandler((p,d)=>this.onMouseEnter(p,d)),this._eventHandler.pushMouseLeaveHandler((p,d)=>this.onMouseLeave(p,d))}onMouseEnter(i,h){this._altered=!1}onMouseLeave(i,h){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},5657:(l,r,a)=>{const n=a(9504),i=a(9017),h=a(2419),p=a(8196),d=a(8386),f=a(8215),s=a(1896),o=a(4168),u=a(8400),b=a(3105),v=a(771),_=a(8593),g=a(1728);var x;(function(T){class O extends b.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(R,P,C){const U=this._context.gl,j=this._context.gl2facade;this._extensions===!1&&this._context.isWebGL1&&((0,n.assert)(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const k=new v.Shader(this._context,U.VERTEX_SHADER,"testrenderer.vert");k.initialize(a(5077));const $=new v.Shader(this._context,U.FRAGMENT_SHADER,"testrenderer.frag");$.initialize(a(6296)),this._program=new o.Program(this._context),this._program.initialize([k,$]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new s.NdcFillingTriangle(this._context);const Y=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(Y),this._ndcOffsetKernel=new h.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new d.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new _.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new u.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new f.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new i.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new p.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=j.COLOR_ATTACHMENT0,this._blit.drawBuffer=U.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new g.TestNavigation(()=>this.invalidate(),C),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const R=this._testNavigation.altered;return this._testNavigation.reset(),!(!R&&!this._altered.any)&&R}onPrepare(){const R=this._context.gl,P=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?R.RGBA8:R.RGBA,R.RGBA,R.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],R.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[P.COLOR_ATTACHMENT0,this._colorRenderTexture],[R.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(R){const P=this._context.gl;P.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const C=this._ndcOffsetKernel.get(R);C[0]=2*C[0]/this._frameSize[0],C[1]=2*C[1]/this._frameSize[1],P.uniform2fv(this._uNdcOffset,C),P.uniform1i(this._uFrameNumber,R),this._intermediateFBO.clear(P.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(R)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}T.TestRenderer=O})(x||(x={})),l.exports=x},3334:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DebugPass=void 0;const n=a(9504),i=a(4168),h=a(771),p=a(8196);class d extends p.BlitPass{constructor(){super(...arguments),this._debug=d.Mode.Depth,this._near=0,this._far=0}createProgram(){(0,n.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const s=this._context.gl,o=new h.Shader(this._context,s.VERTEX_SHADER,"blit.vert (debug)");o.initialize(a(3354));const u=new h.Shader(this._context,s.FRAGMENT_SHADER,"blit_debug.frag (debug)");return u.initialize(a(8359)),this._program=new i.Program(this._context,"DebugProgram"),this._program.initialize([o,u]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),s.uniform1i(this._program.uniform("u_source"),0),s.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(s){const o=super.initialize(s);return this.enforceProgramBlit=!0,o&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(s){this.assertInitialized(),this._debug!==s&&(this._debug=s,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(s){this._near=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(s){this._far=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}r.DebugPass=d,function(f){(function(s){s[s.None=0]="None",s[s.Depth=1]="Depth",s[s.DepthLinear=2]="DepthLinear",s[s.DepthPacked=3]="DepthPacked",s[s.DepthLinearPacked=4]="DepthLinearPacked"})(f.Mode||(f.Mode={}))}(d||(r.DebugPass=d={}))},8386:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultFramebuffer=void 0;const i=a(9504),h=a(8215),p=a(4127);class d extends h.Framebuffer{create(){return this._object=h.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(s){return!1}bind(s=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(s,this._object)}clearColor(s){super.clearColor(s)}resize(){(0,i.assert)(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}r.DefaultFramebuffer=d,n([p.Initializable.assert_initialized()],d.prototype,"bind",null)},6464:function(l,r,a){var n=this&&this.__decorate||function(v,_,g,x){var T,O=arguments.length,A=O<3?_:x===null?x=Object.getOwnPropertyDescriptor(_,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,_,g,x);else for(var R=v.length-1;R>=0;R--)(T=v[R])&&(A=(O<3?T(A):O>3?T(_,g,A):T(_,g))||A);return O>3&&A&&Object.defineProperty(_,g,A),A};Object.defineProperty(r,"__esModule",{value:!0}),r.EnvironmentTextureType=r.EnvironmentRenderingPass=void 0;const i=a(9504),h=a(4127),p=a(1896),d=a(4168),f=a(771),s=a(8593),o=a(5186);class u extends h.Initializable{constructor(_){super(),this._skipCubeLod=!1,this._altered=!0,this._context=_,this._cubeMapProgram=new d.Program(_,"CubemapEnvironmentProgram"),this._equiMapProgram=new d.Program(_,"EquimapEnvironmentProgram"),this._polarMapProgram=new d.Program(_,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new d.Program(_,"SpheremapEnvironmentProgram"),this._ndcTriangle=new p.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const _=this._context.gl;this._ndcTriangle.initialize();const g=new f.Shader(this._context,_.VERTEX_SHADER,"env-projections.vert");g.initialize(a(3761));const x=new f.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");x.initialize(a(9196),!1),x.replace("PROJECTION_TYPE","CUBE_MAP"),x.compile(),this._cubeMapProgram.initialize([g,x],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),_.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const T=new f.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");T.initialize(a(9196),!1),T.replace("PROJECTION_TYPE","EQUI_MAP"),T.compile(),this._equiMapProgram.initialize([g,T],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),_.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const O=new f.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");O.initialize(a(9196),!1),O.replace("PROJECTION_TYPE","SPHERE_MAP"),O.compile(),this._sphereMapProgram.initialize([g,O],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),_.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const A=new f.Shader(this._context,_.FRAGMENT_SHADER,"env-projections.frag");return A.initialize(a(9196),!1),A.replace("PROJECTION_TYPE","POLAR_MAP"),A.compile(),this._polarMapProgram.initialize([g,A],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),_.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(this._altered===!1)return;const _=this._context.gl;this._cubeMapProgram.bind(),_.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const _=this._context.gl;(0,i.assert)(this._camera!==void 0,"Camera is undefined in environment rendering pass."),(0,i.assert)(this._environmentTexture!==void 0,"Environment texture is undefined in environment rendering pass.");let g=this._cubeMapProgram;this._envTextureType===b.EquirectangularMap?((0,i.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._equiMapProgram):this._envTextureType===b.SphereMap?((0,i.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._sphereMapProgram):this._envTextureType===b.CubeMap?((0,i.assert)(this._environmentTexture instanceof o.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(_.TEXTURE0),g=this._cubeMapProgram):this._envTextureType===b.PolarMap&&((0,i.assert)(this._environmentTexture2!==void 0,"Two input textures expected for polar mapping."),(0,i.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),(0,i.assert)(this._environmentTexture2 instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(_.TEXTURE0),this._environmentTexture2.bind(_.TEXTURE1),g=this._polarMapProgram),g.bind(),_.uniformMatrix4fv(g.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),g.unbind()}set environmentTextureType(_){this._envTextureType=_}set environmentTexture(_){this._environmentTexture=_}set environmentTexture2(_){this._environmentTexture2=_}set camera(_){this._camera=_}set skipCubeLod(_){this._skipCubeLod!==_&&(this._skipCubeLod=_,this._altered=!0)}}var b;r.EnvironmentRenderingPass=u,n([h.Initializable.initialize()],u.prototype,"initialize",null),n([h.Initializable.uninitialize()],u.prototype,"uninitialize",null),function(v){v[v.CubeMap=0]="CubeMap",v[v.EquirectangularMap=1]="EquirectangularMap",v[v.SphereMap=2]="SphereMap",v[v.PolarMap=3]="PolarMap"}(b||(r.EnvironmentTextureType=b={}))},2:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EventHandler=void 0;const n=a(3557),i=a(9504),h=a(3975),p=a(4602),d=a(8216),f=a(8870),s=a(5678);r.EventHandler=class{constructor(o,u){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._latestKeyboardEventsByType=new Map,this._previousKeyboardEventsByType=new Map,this._keyboardEventHandlerByType=new Map,this._invalidate=o,this._mouseEventProvider=u.mouseEventProvider,this._mouseEventProvider.preventDefault(p.MouseEventProvider.Type.Wheel),this._pointerEventProvider=u.pointerEventProvider,this._eyeGazeEventProvider=u.eyeGazeEventProvider,this._keyboardEventProvider=u.keyboardEventProvider}invalidate(o=!1){this._invalidate&&this._invalidate(o)}pushMouseEventHandler(o,u){if(this._mouseEventHandlerByType.has(o))return void this._mouseEventHandlerByType.get(o).push(u);this._mouseEventHandlerByType.set(o,new Array),this._previousMouseEventsByType.set(o,new Array);const b=new Array;this._latestMouseEventsByType.set(o,b),(0,i.assert)(this._mouseEventProvider!==void 0,"expected valid mouse event provider");const v=this._mouseEventProvider.observable(o);p.MouseEventProvider.Type.Wheel,this._subscriptions.push(v.subscribe(_=>{b.push(_),this.invalidate()})),this._mouseEventHandlerByType.get(o).push(u)}invokeMouseEventHandler(o){const u=this._mouseEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const b=this._latestMouseEventsByType.get(o);if(b.length===0)return;const v=this._previousMouseEventsByType.get(o);u.forEach(_=>_(b,v)),Object.assign(v,b),b.length=0}pushTouchEventHandler(o,u){if(this._touchEventHandlerByType.has(o))return void this._touchEventHandlerByType.get(o).push(u);this._touchEventHandlerByType.set(o,new Array),this._previousTouchEventsByType.set(o,new Array);const b=new Array;this._latestTouchEventsByType.set(o,b),(0,i.assert)(this._touchEventProvider!==void 0,"expected valid touch event provider");const v=this._touchEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{b.push(_),this.invalidate()})),this._touchEventHandlerByType.get(o).push(u)}invokeTouchEventHandler(o){const u=this._touchEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const b=this._latestTouchEventsByType.get(o);if(b.length===0)return;const v=this._previousTouchEventsByType.get(o);u.forEach(_=>_(b,v)),Object.assign(v,b),b.length=0}pushPointerEventHandler(o,u){if(this._pointerEventHandlerByType.has(o))return void this._pointerEventHandlerByType.get(o).push(u);this._pointerEventHandlerByType.set(o,new Array),this._previousPointerEventsByType.set(o,new Array);const b=new Array;this._latestPointerEventsByType.set(o,b),(0,i.assert)(this._pointerEventProvider!==void 0,"expected valid pointer event provider");const v=this._pointerEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{b.push(_),this.invalidate()})),this._pointerEventHandlerByType.get(o).push(u)}invokePointerEventHandler(o){const u=this._pointerEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const b=this._latestPointerEventsByType.get(o);if(b.length===0)return;const v=this._previousPointerEventsByType.get(o);u.forEach(_=>_(b,v)),Object.assign(v,b),b.length=0}pushEyeGazeEventHandler(o,u){if(this._eyeGazeEventHandlerByType.has(o))return void this._eyeGazeEventHandlerByType.get(o).push(u);this._eyeGazeEventHandlerByType.set(o,new Array),this._previousEyeGazeEventsByType.set(o,new Array);const b=new Array;this._latestEyeGazeEventsByType.set(o,b),(0,i.assert)(this._eyeGazeEventProvider!==void 0,"expected valid eye gaze event provider");const v=this._eyeGazeEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{b.push(_),this.invalidate()})),this._eyeGazeEventHandlerByType.get(o).push(u)}invokeEyeGazeEventHandler(o){const u=this._eyeGazeEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const b=this._latestEyeGazeEventsByType.get(o);if(b.length===0)return;const v=this._previousEyeGazeEventsByType.get(o);u.forEach(_=>_(b,v)),Object.assign(v,b),b.length=0}pushKeyboardEventHandler(o,u){if(this._keyboardEventHandlerByType.has(o))return void this._keyboardEventHandlerByType.get(o).push(u);this._keyboardEventHandlerByType.set(o,new Array),this._previousKeyboardEventsByType.set(o,new Array);const b=new Array;this._latestKeyboardEventsByType.set(o,b),(0,i.assert)(this._keyboardEventProvider!==void 0,"expected valid keyboard event provider");const v=this._keyboardEventProvider.observable(o);this._subscriptions.push(v.subscribe(_=>{b.push(_),this.invalidate()})),this._keyboardEventHandlerByType.get(o).push(u)}invokeKeyboardEventHandler(o){const u=this._keyboardEventHandlerByType.get(o);if(u===void 0||u.length===0)return;const b=this._latestKeyboardEventsByType.get(o);if(b.length===0)return;const v=this._previousKeyboardEventsByType.get(o);u.forEach(_=>_(b,v)),Object.assign(v,b),b.length=0}dispose(){this._latestMouseEventsByType.forEach(o=>o.length=0),this._previousMouseEventsByType.forEach(o=>o.length=0),this._latestTouchEventsByType.forEach(o=>o.length=0),this._previousTouchEventsByType.forEach(o=>o.length=0),this._latestPointerEventsByType.forEach(o=>o.length=0),this._previousPointerEventsByType.forEach(o=>o.length=0),this._previousEyeGazeEventsByType.forEach(o=>o.length=0),this._latestEyeGazeEventsByType.forEach(o=>o.length=0),this._latestKeyboardEventsByType.forEach(o=>o.length=0),this._previousKeyboardEventsByType.forEach(o=>o.length=0);for(const o of this._subscriptions)o.unsubscribe()}update(){this.invokeMouseEventHandler(p.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(p.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(f.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(f.TouchEventProvider.Type.End),this.invokeTouchEventHandler(f.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(f.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(d.PointerEventProvider.Type.Move),this.invokePointerEventHandler(d.PointerEventProvider.Type.Down),this.invokePointerEventHandler(d.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(d.PointerEventProvider.Type.Up),this.invokePointerEventHandler(d.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(d.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.BinaryMessageParsingError),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyDown),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyPress),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyUp)}offsets(o,u=!0){const b=new Array;let v=!1;if(o instanceof MouseEvent){const g=o;v=g.offsetX!==0&&g.offsetY!==0,b.push(v?n.vec2.fromValues(g.offsetX,g.offsetY):n.vec2.fromValues(g.clientX,g.clientY))}else if(o instanceof WheelEvent){const g=o;v=g.offsetX!==0&&g.offsetY!==0,b.push(v?n.vec2.fromValues(g.offsetX,g.offsetY):n.vec2.fromValues(g.clientX,g.clientY))}else if(o instanceof TouchEvent){const g=o;for(let x=0;x<g.touches.length;++x){const T=g.touches.item(x);b.push(n.vec2.fromValues(T.clientX,T.clientY))}}if(v){if(u)for(const g of b)n.vec2.scale(g,g,window.devicePixelRatio);return b}const _=(o.target||o.currentTarget||o.srcElement).getBoundingClientRect();for(const g of b)g[0]=Math.floor(g[0]-_.left),g[1]=Math.floor(g[1]-_.top),u&&n.vec2.scale(g,g,window.devicePixelRatio);return b}pushClickHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Click,o)}pushMouseEnterHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Enter,o)}pushMouseLeaveHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Leave,o)}pushMouseDownHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Down,o)}pushMouseUpHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Up,o)}pushMouseMoveHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Move,o)}pushMouseWheelHandler(o){this.pushMouseEventHandler(p.MouseEventProvider.Type.Wheel,o)}pushTouchStartHandler(o){this.pushTouchEventHandler(f.TouchEventProvider.Type.Start,o)}pushTouchEndHandler(o){this.pushTouchEventHandler(f.TouchEventProvider.Type.End,o)}pushTouchMoveHandler(o){this.pushTouchEventHandler(f.TouchEventProvider.Type.Move,o)}pushTouchCancelHandler(o){this.pushTouchEventHandler(f.TouchEventProvider.Type.Cancel,o)}pushPointerUpHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Up,o)}pushPointerDownHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Down,o)}pushPointerEnterHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Enter,o)}pushPointerLeaveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Leave,o)}pushPointerMoveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Move,o)}pushPointerCancelHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Cancel,o)}pushEyeGazeDataHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.EyeGazeData,o)}pushEyeGazeServerMessageHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.NewServerMessage,o)}pushEyeGazeConnectionStatusHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.ConnectionStatus,o)}pushEyeGazeBinaryMessageParsingErrorHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.BinaryMessageParsingError,o)}pushKeyDownHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyDown,o)}pushKeyPressHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyPress,o)}pushKeyUpHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyUp,o)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},5304:l=>{var r;(function(a){a.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],a.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],a.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]})(r||(r={})),l.exports=r},5060:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ExtensionsHash=void 0;const n=a(9504),i=a(5304);class h{static encode64(d){return(0,n.assert)(d>=0&&d<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${d}`),h.BASE64_ALPHABET[d]}static decode64(d){(0,n.assert)(d.length===1,`expected single base64 character, given '${d}'`);const f=h.BASE64_ALPHABET.indexOf(d);return(0,n.assert)(f>-1,`unknown base64 character, given '${d}'`),f}static encode(d,f){const s=h.LATEST_VERSION,o=h.EXTENSIONS_BY_VERSION.get(s),u=h.WEBGL_BACKENDS.indexOf(d);(0,n.assert)(u>-1,`expected valid backend ${h.WEBGL_BACKENDS}, given ${d} `);let b=h.encode64(s<<3|u+1);if(f.length===0)return b;let v=0;for(let _=0;_<o.length;++_)v|=f.indexOf(o[_])>-1?32>>_%6:0,_%6<5&&_<o.length-1||(b+=h.encode64(v),v=0);return b}static decode(d){const f=h.decode64(d[0]),s=f>>3,o=(7&f)-1;(0,n.assert)(o<h.WEBGL_BACKENDS.length,`expected valid backend index, given ${o}`);const u=h.WEBGL_BACKENDS[o];(0,n.assert)(h.EXTENSIONS_BY_VERSION.has(s),`expected valid hash version, given ${s}`);const b=h.EXTENSIONS_BY_VERSION.get(s),v=Math.ceil(b.length/6)+1;(0,n.assert)(d.length===v,`expected hash of version ${s} to have a length of ${v}, given ${d}`);const _=new Array;for(let g=1;g<d.length;++g){const x=h.decode64(d[g]),T=6*(g-1);32&x&&_.push(b[T+0]),16&x&&_.push(b[T+1]),8&x&&_.push(b[T+2]),4&x&&_.push(b[T+3]),2&x&&_.push(b[T+4]),1&x&&_.push(b[T+5])}return[u,_]}static complement(d,f){const s=h.WEBGL_BACKENDS.indexOf(d);return(0,n.assert)(s>-1,`expected valid backend ${h.WEBGL_BACKENDS}, given ${d} `),h.WEBGL_EXTENSIONS_BY_BACKEND.get(s).filter(o=>f.indexOf(o)<0)}}r.ExtensionsHash=h,h.WEBGL_BACKENDS=["webgl1","webgl2"],h.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,i.WEBGL1_EXTENSIONS],[1,i.WEBGL2_EXTENSIONS]]),h.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),h.LATEST_VERSION=0,h.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},3404:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EyeGazeDataStreams=r.EyeGazeDataStream=r.EyeGazeEventTarget=void 0;const n=a(6662);class i extends EventTarget{}r.EyeGazeEventTarget=i;class h{constructor(){this._eyeGazeDataStreams=new p,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const f=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(f[0]=1|f[0]),this._eyeGazeDataStreams.gazeOrigin&&(f[0]=2|f[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(f[0]=4|f[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(f[0]=8|f[0]),this._eyeGazeDataStreams.userPresence&&(f[0]=16|f[0]),f}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const f=this.generateStreamConfigByte();this._webSocket.send(f)}parseEyeTrackingData(f){if(f.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(h.BINARY_MESSAGE_PARSING_ERROR);let s=0;const o=new n.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(o.gazePositionXY[0]=f[s++],o.gazePositionXY[1]=f[s++]),this._eyeGazeDataStreams.gazeOrigin&&(o.gazeOriginRightXYZ[0]=f[s++],o.gazeOriginRightXYZ[1]=f[s++],o.gazeOriginRightXYZ[2]=f[s++],o.gazeOriginLeftXYZ[0]=f[s++],o.gazeOriginLeftXYZ[1]=f[s++],o.gazeOriginLeftXYZ[2]=f[s++]),this._eyeGazeDataStreams.eyePositionNormalized&&(o.eyePositionRightNormalizedXYZ[0]=f[s++],o.eyePositionRightNormalizedXYZ[1]=f[s++],o.eyePositionRightNormalizedXYZ[2]=f[s++],o.eyePositionLeftNormalizedXYZ[0]=f[s++],o.eyePositionLeftNormalizedXYZ[1]=f[s++],o.eyePositionLeftNormalizedXYZ[2]=f[s++]),this._eyeGazeDataStreams.headPositionAndRotation&&(o.headPositionXYZ[0]=f[s++],o.headPositionXYZ[1]=f[s++],o.headPositionXYZ[2]=f[s++],o.headRotationXYZ[0]=f[s++],o.headRotationXYZ[1]=f[s++],o.headRotationXYZ[2]=f[s++]),this._eyeGazeDataStreams.userPresence&&(o.userPresence=f[s]!==0),new CustomEvent(h.EYE_GAZE_DATA,{detail:{eyeGazeData:o}})}onOpen(f){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.SUCCESSFULLY_CONNECTED_TO_SERVER,event:f}})),this.performHandshake()}onClose(f){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.DISCONNECTED_TO_SERVER,event:f}}))}onError(f){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.CONNECTION_ERROR,event:f}}))}async onMessage(f){if(typeof f.data!="string"){const s=await f.data.arrayBuffer(),o=new Float32Array(s);this.dispatchEvent(this.parseEyeTrackingData(o))}else this.dispatchEvent(new CustomEvent(h.NEW_SERVER_MESSAGE,{detail:{message:f.data}}))}connect(f){this._webSocket=new WebSocket(f),this._webSocket.onopen=s=>{this.onOpen(s)},this._webSocket.onclose=s=>{this.onClose(s)},this._webSocket.onerror=s=>{this.onError(s)},this._webSocket.onmessage=s=>{this.onMessage(s)}}addEventListener(f,s,o){this._eyeGazeEventTarget.addEventListener(f,s||null,o)}dispatchEvent(f){return this._eyeGazeEventTarget.dispatchEvent(f)}removeEventListener(f,s,o){this._eyeGazeEventTarget.removeEventListener(f,s||null,o)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(f){this._eyeGazeDataStreams!==f&&(this._eyeGazeDataStreams=f)}}r.EyeGazeDataStream=h,h.EYE_GAZE_DATA="eyegazedata",h.NEW_SERVER_MESSAGE="newservermessage",h.CONNECTION_STATUS="connectionstatus",h.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",h.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",h.DISCONNECTED_TO_SERVER="disconnected to server",h.CONNECTION_ERROR="connection error with server";class p{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let f=0;this.gazePosition&&(f+=2),this.gazeOrigin&&(f+=6),this.eyePositionNormalized&&(f+=6),this.headPositionAndRotation&&(f+=6),this.userPresence&&(f+=1),this.expectedNumberOfFloats=f}}r.EyeGazeDataStreams=p},6662:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EyeGazeData=void 0,r.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let a="";return a+=`Gaze Position: ${this.gazePositionXY}
`,a+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}
`,a+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}
`,a+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}
`,a+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}
`,a+=`Head Position: ${this.headPositionXYZ}
`,a+=`Head Rotation: ${this.headRotationXYZ}
`,a+=`User Presence: ${this.userPresence}
`,a}}},3975:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EyeGazeEventProvider=void 0;const n=a(7032),i=a(9504),h=a(3404);class p{constructor(f,s){(0,i.assert)(f!==void 0,`expected a valid eye gaze data streams object on initialization, given ${f}.`),this._eyeGazeDataStream=new h.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=f,this._eyeGazeDataStream.connect(s)}preventDefaultOnEvent(f,s){(0,i.bitInBitfield)(this._preventDefaultMask,f)&&s.preventDefault()}allowDefault(...f){for(const s of f)(0,i.bitInBitfield)(this._preventDefaultMask,s)&&(this._preventDefaultMask&=~s)}preventDefault(...f){for(const s of f)(0,i.bitInBitfield)(this._preventDefaultMask,s)||(this._preventDefaultMask|=s)}observable(f){switch(f){case p.Type.EyeGazeData:return this.EyeGazeData$;case p.Type.NewServerMessage:return this.NewServerMessage$;case p.Type.ConnectionStatus:return this.ConnectionStatus$;case p.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return this._eyeGazeDataSubject===void 0&&(this._eyeGazeDataSubject=new n.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=f=>{this.preventDefaultOnEvent(p.Type.EyeGazeData,f),this._eyeGazeDataSubject.next(f)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return this._newServerMessageSubject===void 0&&(this._newServerMessageSubject=new n.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=f=>{this.preventDefaultOnEvent(p.Type.NewServerMessage,f),this._newServerMessageSubject.next(f)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return this._connectionStatusSubject===void 0&&(this._connectionStatusSubject=new n.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=f=>{this.preventDefaultOnEvent(p.Type.ConnectionStatus,f),this._connectionStatusSubject.next(f)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return this._binaryMessageParsingErrorSubject===void 0&&(this._binaryMessageParsingErrorSubject=new n.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=f=>{this.preventDefaultOnEvent(p.Type.BinaryMessageParsingError,f),this._binaryMessageParsingErrorSubject.next(f)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}r.EyeGazeEventProvider=p,function(d){(function(f){f[f.EyeGazeData=1]="EyeGazeData",f[f.NewServerMessage=2]="NewServerMessage",f[f.ConnectionStatus=4]="ConnectionStatus",f[f.BinaryMessageParsingError=8]="BinaryMessageParsingError"})(d.Type||(d.Type={}))}(p||(r.EyeGazeEventProvider=p={}))},64:(l,r,a)=>{const n=a(1407);var i;(function(h){const p=(d,f)=>`fetching '${d}' failed (${f.status}): ${f.statusText}`;h.fetchAsync=function(d,f){return new Promise((s,o)=>{const u=new XMLHttpRequest;u.open("GET",d,!0),u.responseType=f,u.onload=()=>{u.status<200||u.status>=300?o(p(d,u)):s(u.response)},u.onerror=()=>o(p(d,u)),u.ontimeout=()=>o(p(d,u)),u.send()})},h.fetchJsonAsync=function(d,f,s){return new Promise((o,u)=>{const b=new XMLHttpRequest;b.open("GET",d,!0),b.onload=()=>{if(b.status<200||b.status>=300)return void u(p(d,b));const v=b.responseText;if(s!==void 0&&!(0,n.validate)(v,s))return;let _;try{_=JSON.parse(v)}catch(x){return void u(`fetching '${d}' failed (${x.name}): ${x.message}`)}const g=f(_);g!==void 0?o(g):u(`fetching '${d}' failed (TransformError): transforming the object failed.`)},b.onerror=()=>u(p(d,b)),b.ontimeout=()=>u(p(d,b)),b.send()})}})(i||(i={})),l.exports=i},4850:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FirstPersonModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._rotation=n.mat4.create(),this._sensitivity=p.DEFAULT_SENSITIVITY}initiate(f){Object.assign(this._reference,this._camera),this._initialPoint=f}process(f,s){this._currentPoint=f;const o=n.vec2.create();s===void 0?n.vec2.subtract(o,this._initialPoint,this._currentPoint):n.vec2.copy(o,s),n.vec2.scale(o,o,window.devicePixelRatio*this._sensitivity),n.vec2.copy(this._initialPoint,this._currentPoint);const u=n.vec3.sub((0,i.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(u,u);const b=n.vec3.cross((0,i.v3)(),u,this._reference.up),v=n.mat4.fromRotation((0,i.m4)(),-o[0],this._reference.up),_=n.mat4.fromRotation((0,i.m4)(),o[1],b);n.mat4.mul(this._rotation,_,v),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._reference.eye);n.mat4.multiply(f,f,this._rotation),n.mat4.translate(f,f,n.vec3.negate((0,i.v3)(),this._reference.eye));const s=n.vec3.transformMat4((0,i.v3)(),this._reference.center,f);this._camera.center=s,Object.assign(this._reference,this._camera)}set sensitivity(f){this._sensitivity=f}get sensitivity(){return this._sensitivity}}r.FirstPersonModifier=p,p.DEFAULT_SENSITIVITY=8e-4},3513:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.byteSizeOfFormat=function(p,d){const f=p.gl;if(d===void 0)return(0,n.assert)(!1,"expected given format to be defined"),0;if(function(o,u){const b=o.gl,v=o.gl2facade;if(u===void 0)return!1;if(i===void 0){const _=o.supportsDepthTexture?o.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;i=new Array(b.UNSIGNED_BYTE,b.UNSIGNED_SHORT_5_6_5,b.UNSIGNED_SHORT_4_4_4_4,b.UNSIGNED_SHORT_5_5_5_1,b.UNSIGNED_SHORT,b.UNSIGNED_INT,_,b.FLOAT,v.HALF_FLOAT,b.BYTE,b.SHORT,b.INT,b.HALF_FLOAT,b.UNSIGNED_INT_2_10_10_10_REV,b.UNSIGNED_INT_10F_11F_11F_REV,b.UNSIGNED_INT_5_9_9_9_REV,b.UNSIGNED_INT_24_8,b.FLOAT_32_UNSIGNED_INT_24_8_REV)}return i.indexOf(u)>-1}(p,d))return(0,n.assert)(!1,`expected format instead of type ${d}`),0;if(d===f.DEPTH_COMPONENT||d===f.DEPTH_STENCIL)return(0,n.assert)(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const s=function(o){if(h.has(o))return h.get(o);const u=o.gl,b=new Map([[u.ALPHA,1],[u.LUMINANCE,1],[u.R8,1],[u.R8I,1],[u.R8UI,1],[u.STENCIL_INDEX8,1],[u.DEPTH_COMPONENT16,2],[u.LUMINANCE_ALPHA,2],[u.R16F,2],[u.R16I,2],[u.R16UI,2],[u.RG8,2],[u.RG8I,2],[u.RG8UI,2],[u.RGB565,2],[u.RGB5_A1,2],[u.RGBA4,2],[u.DEPTH_COMPONENT24,3],[u.RGB,3],[u.RGB8,3],[u.RGB8UI,3],[u.SRGB,3],[u.SRGB8,3],[u.DEPTH24_STENCIL8,4],[u.DEPTH_COMPONENT32F,4],[u.R11F_G11F_B10F,4],[u.R32F,4],[u.R32I,4],[u.R32UI,4],[u.RG16F,4],[u.RG16I,4],[u.RG16UI,4],[u.RGB10_A2,4],[u.RGB10_A2UI,4],[u.RGB9_E5,4],[u.RGBA,4],[u.RGBA8,4],[u.RGBA8I,4],[u.RGBA8UI,4],[u.SRGB8_ALPHA8,4],[u.SRGB_ALPHA,4],[u.SRGB_ALPHA8,4],[u.SRGB_APLHA8,4],[u.DEPTH32F_STENCIL8,5],[u.RGB16F,6],[u.RG32F,8],[u.RG32I,8],[u.RG32UI,8],[u.RGBA16F,8],[u.RGBA16I,8],[u.RGBA16UI,8],[u.RGB32F,12],[u.RGBA32F,16],[u.RGBA32I,16],[u.RGBA32UI,16]]);return o.isWebGL1&&o.supportsSRGB&&(b.set(o.sRGB.SRGB_EXT,3),b.set(o.sRGB.SRGB_ALPHA_EXT,4),b.set(o.sRGB.SRGB8_ALPHA8_EXT,4)),o.supportsColorBufferFloat&&(b.set(o.colorBufferFloat.RGB32F_EXT,12),b.set(o.colorBufferFloat.RGBA32F_EXT,16)),h.set(o,b),b}(p).get(d);return(0,n.assert)(s!==void 0,`size of format ${d} is unknown`),s||0};const n=a(9504);let i;const h=new Map},8215:function(l,r,a){var n=this&&this.__decorate||function(o,u,b,v){var _,g=arguments.length,x=g<3?u:v===null?v=Object.getOwnPropertyDescriptor(u,b):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,u,b,v);else for(var T=o.length-1;T>=0;T--)(_=o[T])&&(x=(g<3?_(x):g>3?_(u,b,x):_(u,b))||x);return g>3&&x&&Object.defineProperty(u,b,x),x};Object.defineProperty(r,"__esModule",{value:!0}),r.Framebuffer=void 0;const i=a(9504),h=a(4127),p=a(9965),d=a(8400),f=a(8593);class s extends p.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(u,b){const v=u.gl;switch(b){case v.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case v.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case v.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return(0,i.assert)(!1,`expected known framebuffer status, given ${b}`),""}}create(u){const b=this._context.gl,v=this.context.gl2facade;this._object=b.createFramebuffer(),this._clearColors=new Array(v.COLOR_ATTACHMENT_MAX-v.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const g of u){const x=g[0],T=g[1];if(T instanceof d.Renderbuffer?this._buffersByAttachment.set(x,T):T instanceof f.Texture2D&&this._texturesByAttachment.set(x,T),x<v.COLOR_ATTACHMENT_MIN||x>v.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(x);const O=x-b.COLOR_ATTACHMENT0;this._colorClearQueue.push(O),this._clearColors[O]=[0,0,0,0]}this._drawBuffersChanged=!0,b.bindFramebuffer(b.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach((g,x)=>{b.framebufferRenderbuffer(b.FRAMEBUFFER,x,b.RENDERBUFFER,g.object)}),this._texturesByAttachment.forEach((g,x)=>{b.framebufferTexture2D(b.FRAMEBUFFER,x,b.TEXTURE_2D,g.object,0)});const _=b.checkFramebufferStatus(b.FRAMEBUFFER);return this._valid=b.isFramebuffer(this._object)&&_===b.FRAMEBUFFER_COMPLETE,(0,i.logIf)(!this._valid,i.LogLevel.Warning,s.statusString(this.context,_)),v.drawBuffers&&v.drawBuffers(this._drawBuffers),b.bindFramebuffer(b.FRAMEBUFFER,s.DEFAULT_FRAMEBUFFER),this._object}delete(){(0,i.assert)(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(u,b=!0,v=!0){const _=this.context.gl,g=(0,i.bitInBitfield)(u,_.DEPTH_BUFFER_BIT),x=(0,i.bitInBitfield)(u,_.STENCIL_BUFFER_BIT),T=(0,i.bitInBitfield)(u,_.COLOR_BUFFER_BIT);if(T||g||x){if(b&&this.bind(),T&&this._clearColors[0]!==void 0){const O=this._clearColors[0];_.clearColor(O[0],O[1],O[2],O[3])}g&&this._clearDepth!==void 0&&_.clearDepth(this._clearDepth),x&&this._clearStencil!==void 0&&_.clearStencil(this._clearStencil),_.clear(u),v&&this.unbind()}}es3Clear(u,b=!0,v=!0,_){const g=this.context.gl,x=(0,i.bitInBitfield)(u,g.DEPTH_BUFFER_BIT),T=(0,i.bitInBitfield)(u,g.STENCIL_BUFFER_BIT),O=(0,i.bitInBitfield)(u,g.COLOR_BUFFER_BIT);if(O||x||T){if(b&&this.bind(),O){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const A=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];g.clearColor(A[0],A[1],A[2],A[3]),g.clear(g.COLOR_BUFFER_BIT)}for(const A of _||this._colorClearQueue)g.clearBufferfv(g.COLOR,A,this._clearColors[A])}x&&T?(g.clearStencil(this._clearStencil),g.clearDepth(this._clearDepth),g.clear(g.STENCIL_BUFFER_BIT|g.DEPTH_BUFFER_BIT)):x?g.clearBufferfv(g.DEPTH,0,[this._clearDepth]):T&&(g.clearStencil(this._clearStencil),g.clear(g.STENCIL_BUFFER_BIT)),v&&this.unbind()}}hasAttachment(u){return this._texturesByAttachment.has(u)||this._buffersByAttachment.has(u)}bind(u=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(u,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(u=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(u,s.DEFAULT_FRAMEBUFFER)}clearColor(u,b){(0,i.assert)(b===void 0||b===0||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const v=u[3]<1&&!this.context.alpha;(0,i.logIf)(v,i.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const _=[u[0],u[1],u[2],v?1:u[3]];if(this.context.premultipliedAlpha&&!v&&(_[0]*=_[3],_[1]*=_[3],_[2]*=_[3]),b!==void 0)this._clearColors[b]=_;else for(let g=0;g<this._clearColors.length;++g)this._clearColors[g]=_}clearDepth(u){this._clearDepth=u}clearStencil(u){this._clearStencil=u}texture(u){return this._texturesByAttachment.get(u)}resize(u,b,v=!0,_=!0){this._buffersByAttachment.forEach(g=>{g.resize(u,b,v,_)}),this._texturesByAttachment.forEach(g=>{g.resize(u,b,v,_)})}get width(){this.assertInitialized();let u=NaN;return this._buffersByAttachment.forEach(b=>{(isNaN(u)||b.width<u)&&(u=b.width)}),this._texturesByAttachment.forEach(b=>{(isNaN(u)||b.width<u)&&(u=b.width)}),u}get height(){this.assertInitialized();let u=NaN;return this._buffersByAttachment.forEach(b=>{(isNaN(u)||b.height<u)&&(u=b.height)}),this._texturesByAttachment.forEach(b=>{(isNaN(u)||b.height<u)&&(u=b.height)}),u}get size(){return[this.width,this.height]}set drawBuffers(u){this.assertInitialized();const b=this.context.gl2facade;for(const v of u)(0,i.assert)(this.hasAttachment(v),`valid attachment expected for draw buffer, given ${v}`),(0,i.assert)(v>=b.COLOR_ATTACHMENT_MIN&&v<=b.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${v}`),this._drawBuffersChanged=this._drawBuffersChanged||this._drawBuffers.indexOf(v)===-1;this._drawBuffersChanged=this._drawBuffersChanged||u.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=u)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}r.Framebuffer=s,s.DEFAULT_FRAMEBUFFER=void 0,n([h.Initializable.assert_initialized()],s.prototype,"es2Clear",null),n([h.Initializable.assert_initialized()],s.prototype,"es3Clear",null),n([h.Initializable.assert_initialized()],s.prototype,"bind",null),n([h.Initializable.assert_initialized()],s.prototype,"unbind",null),n([h.Initializable.assert_initialized()],s.prototype,"clearColor",null),n([h.Initializable.assert_initialized()],s.prototype,"clearDepth",null),n([h.Initializable.assert_initialized()],s.prototype,"clearStencil",null),n([h.Initializable.assert_initialized()],s.prototype,"texture",null),n([h.Initializable.assert_initialized()],s.prototype,"resize",null)},1215:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FrameCapture=void 0;const n=a(9504),i=a(8215),h=a(8386);class p{static createDataURL(f,s,o){const u=document.createElement("canvas"),b=u.getContext("2d");return u.width=f.width,u.height=f.height,b.putImageData(f,0,0),u.toDataURL(s,o)}static captureDefaultFramebuffer(f,s,o){const u=f.context.gl;f.bind(),u.readPixels(s.x,s.y,s.width,s.height,u.RGBA,u.UNSIGNED_BYTE,o),f.unbind()}static captureFramebuffer(f,s,o,u){const b=f.context.gl,v=f.texture(s);if((0,n.assert)(v!==void 0,`Framebuffer does not have given attachment ${s}.`),(0,n.assert)(v.format===b.RGBA,`Unsupported texture format ${v.format}.`),(0,n.assert)(v.type===b.UNSIGNED_BYTE||v.type===b.FLOAT||v.type===b.HALF_FLOAT,`Unsupported texture type ${v.type}.`),b.readBuffer(s),v.type===b.FLOAT||v.type===b.HALF_FLOAT){const _=new Float32Array(o.width*o.height*4);b.readPixels(o.x,o.y,o.width,o.height,b.RGBA,b.FLOAT,_),_.forEach((g,x)=>{u[x]=255*g})}else v.type===b.UNSIGNED_BYTE&&b.readPixels(o.x,o.y,o.width,o.height,b.RGBA,b.UNSIGNED_BYTE,u)}static flipImageDataVertically(f){const s=f.height,o=f.data.length/s,u=Math.floor(s/2);for(let b=0;b<u;++b){const v=f.data.slice(b*o,(b+1)*o);f.data.copyWithin(b*o,(s-b-1)*o,(s-b)*o),f.data.set(v,(s-b-1)*o)}}static capture(f,s,o){const u=f.context.gl,b=f.size;o===void 0&&(o={x:0,y:0,width:b[0],height:b[1]}),s===void 0&&(s=u.COLOR_ATTACHMENT0);const v=new ImageData(o.width,o.height),_=new Uint8Array(v.data.buffer);return f.bind(u.READ_FRAMEBUFFER),f instanceof h.DefaultFramebuffer?p.captureDefaultFramebuffer(f,o,_):f instanceof i.Framebuffer&&p.captureFramebuffer(f,s,o,_),f.unbind(u.READ_FRAMEBUFFER),p.flipImageDataVertically(v),v}}r.FrameCapture=p},3395:function(l,r,a){var n=this&&this.__decorate||function(b,v,_,g){var x,T=arguments.length,O=T<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(b,v,_,g);else for(var A=b.length-1;A>=0;A--)(x=b[A])&&(O=(T<3?x(O):T>3?x(v,_,O):x(v,_))||O);return T>3&&O&&Object.defineProperty(v,_,O),O};Object.defineProperty(r,"__esModule",{value:!0}),r.GaussFilter=void 0;const i=a(3557),h=a(9504),p=a(5150),d=a(4127),f=a(1896),s=a(4168),o=a(771);class u extends d.Initializable{constructor(v){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=v}recalculateWeights(){if(this._weights)return!1;const v=1/Math.sqrt(2*Math.PI)*this._standardDeviation,_=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let g=0;for(let x=0;x<=Math.floor(this._kernelSize/2);x++)this._weights[x]=v*Math.pow(Math.E,-Math.pow(x,2)/_),g+=x>0?2*this._weights[x]:this._weights[x];if(this._redistribute){const x=1-g;for(let T=0;T<=Math.floor(this._kernelSize/2);T++)this._weights[T]+=this._weights[T]/g*x}return!0}get kernelSize(){return this._kernelSize}set kernelSize(v){(0,h.assert)(v>0,"Kernel size has to be positive."),(0,h.assert)(v<=2*(u._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(u._MAXKERNELSIZEHALF-1)+2)+"."),(0,h.assert)(Number.isInteger(v),"Kernel size has to be an integer."),(0,h.assert)(v%2==1,"Kernel size has to be odd."),this._kernelSize=v,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(v){(0,h.assert)(v>0,"Standard deviation has to be positive."),this._standardDeviation=v,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(v){this._redistribute=v,this._weights=void 0}initialize(v){const _=this._context.gl,g=new o.Shader(this._context,_.VERTEX_SHADER,"gauss.vert");g.initialize(a(9214)),this._fragmentShader=new o.Shader(this._context,_.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(a(1687)),this._program=new s.Program(this._context),this._program.initialize([g,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const x=this._program.attribute("a_vertex",0);return v===void 0?this._ndcTriangle=new f.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(x),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(v,_){const g=this._context.gl,x=[i.vec2.fromValues(1,0),i.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),g.uniform1fv(this._uWeights,this._weights)),this._program.bind(),v.bind(g.TEXTURE0),g.uniform2fv(this._uDelta,i.vec2.divide((0,p.v2)(),x[_],v.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),v.unbind(g.TEXTURE0),this._program.unbind()}}r.GaussFilter=u,u._MAXKERNELSIZEHALF=32,n([d.Initializable.initialize()],u.prototype,"initialize",null),n([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],u.prototype,"filter",null),function(b){(function(v){v[v.Horizontal=0]="Horizontal",v[v.Vertical=1]="Vertical"})(b.Direction||(b.Direction={}))}(u||(r.GaussFilter=u={}))},638:function(l,r,a){var n=this&&this.__decorate||function(d,f,s,o){var u,b=arguments.length,v=b<3?f:o===null?o=Object.getOwnPropertyDescriptor(f,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,f,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(b<3?u(v):b>3?u(f,s,v):u(f,s))||v);return b>3&&v&&Object.defineProperty(f,s,v),v};Object.defineProperty(r,"__esModule",{value:!0}),r.Geometry=void 0;const i=a(4127),h=a(5507);class p extends i.Initializable{constructor(f,s){super(),this._buffers=new Array,s=s!==void 0&&s!==""?s:this.constructor.name,this._vertexArray=new h.VertexArray(f,`${s}VAO`)}initialize(...f){const s=f[0],o=f[1];let u=!0;for(let b=0;b<this._buffers.length;++b)u=this._buffers[b].initialize(s[b])&&u;return this._vertexArray.initialize(()=>this.bindBuffers(o),()=>this.unbindBuffers(o)),this._vertexArray.valid&&u}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach(f=>f.uninitialize())}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}r.Geometry=p,n([i.Initializable.initialize()],p.prototype,"initialize",null),n([i.Initializable.uninitialize()],p.prototype,"uninitialize",null),n([i.Initializable.assert_initialized()],p.prototype,"bind",null),n([i.Initializable.assert_initialized()],p.prototype,"unbind",null)},5150:(l,r,a)=>{const n=a(3557);var i;(function(h){function p(f){return f>0?f-Math.floor(f):f-Math.ceil(f)}h.sign=function(f){return f>0?1:f<0?-1:0},h.clamp=function(f,s,o){return Math.max(s,Math.min(o,f))},h.fract=p,h.v2=function(){return n.vec2.create()},h.clamp2=function(f,s,o,u){return f[0]=Math.max(o[0],Math.min(u[0],s[0])),f[1]=Math.max(o[1],Math.min(u[1],s[1])),f},h.abs2=function(f,s){return f[0]=Math.abs(s[0]),f[1]=Math.abs(s[1]),f},h.v3=function(){return n.vec3.create()},h.clamp3=function(f,s,o,u){return f[0]=Math.max(o[0],Math.min(u[0],s[0])),f[1]=Math.max(o[1],Math.min(u[1],s[1])),f[2]=Math.max(o[2],Math.min(u[2],s[2])),f},h.abs3=function(f,s){return f[0]=Math.abs(s[0]),f[1]=Math.abs(s[1]),f[2]=Math.abs(s[2]),f};const d=1/256;h.encode_float24x1_to_uint8x3=function(f,s){return f[0]=Math.floor(256*s),f[1]=Math.floor(256*p(256*s)),f[2]=Math.floor(256*p(65536*s)),f},h.decode_float24x1_from_uint8x3=function(f){return(f[0]+(f[1]+f[2]*d)*d)*d},h.encode_uint24_to_rgb8=function(f,s){return f[0]=s>>>0&255,f[1]=s>>>8&255,f[2]=s>>>16&255,f},h.encode_uint32_to_rgba8=function(f,s){return f[0]=s>>>0&255,f[1]=s>>>8&255,f[2]=s>>>16&255,f[3]=s>>>24&255,f},h.decode_uint24_from_rgb8=function(f){return f[0]+(f[1]<<8)+(f[2]<<16)},h.decode_uint32_from_rgba8=function(f){return f[0]+(f[1]<<8)+(f[2]<<16)+(f[3]<<24)>>>0},h.fromVec4=function(f){return f[3]===0?n.vec3.fromValues(f[0],f[1],f[2]):n.vec3.fromValues(f[0]/f[3],f[1]/f[3],f[2]/f[3])},h.v4=function(){return n.vec4.create()},h.clamp4=function(f,s,o,u){return f[0]=Math.max(o[0],Math.min(u[0],s[0])),f[1]=Math.max(o[1],Math.min(u[1],s[1])),f[2]=Math.max(o[2],Math.min(u[2],s[2])),f[3]=Math.max(o[3],Math.min(u[3],s[3])),f},h.abs4=function(f,s){return f[0]=Math.abs(s[0]),f[1]=Math.abs(s[1]),f[2]=Math.abs(s[2]),f[3]=Math.abs(s[3]),f},h.fromVec3=function(f){return n.vec4.fromValues(f[0],f[1],f[2],1)},h.parseVec2=function(f){if(f===void 0||f==="")return;let s=[];try{s=JSON.parse(`[${f}]`)}catch{return}return s.length!==2||isNaN(s[0])||isNaN(s[1])?void 0:n.vec2.clone(s)},h.parseVec3=function(f){if(f===void 0||f==="")return;let s=[];try{s=JSON.parse(`[${f}]`)}catch{return}return s.length!==3||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?void 0:n.vec3.clone(s)},h.parseVec4=function(f){if(f===void 0||f==="")return;let s=[];try{s=JSON.parse(`[${f}]`)}catch{return}return s.length!==4||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?void 0:n.vec4.clone(s)},h.mix=function(f,s,o){return f*(1-o)+s*o},h.m2=function(){return n.mat2.create()},h.m3=function(){return n.mat3.create()},h.m4=function(){return n.mat4.create()}})(i||(i={})),l.exports=i},829:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GL2Facade=void 0;const n=a(9504),i=a(2527);r.GL2Facade=class{constructor(h){this.drawBuffers=void 0,(0,n.assert)(h!==void 0,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(h),this.queryColorAttachments(h),this.queryInstancedArraySupport(h),this.queryDrawBuffersSupport(h),this.queryVertexArrayObjectSupport(h),this.queryMaxUniformVec3Components(h),this.queryBufferSubDataInterface(h),this.queryTexImageInterface(h)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(h){switch(h.backend){case i.Context.BackendType.WebGL1:this._halfFloat=h.supportsTextureHalfFloat&&h.textureHalfFloat?h.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case i.Context.BackendType.WebGL2:default:this._halfFloat=h.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(h){const p=h.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=p.COLOR_ATTACHMENT0,h.backend){case i.Context.BackendType.WebGL1:const d=h.supportsDrawBuffers?h.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(d?p.getParameter(d.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=d?d.COLOR_ATTACHMENT0_WEBGL:p.COLOR_ATTACHMENT0,!d)break;for(let f=1;f<16;++f)this._colorAttachments[f]=d.COLOR_ATTACHMENT0_WEBGL+f;break;case i.Context.BackendType.WebGL2:default:this._colorAttachmentMin=h.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=h.gl.COLOR_ATTACHMENT0+p.getParameter(p.MAX_COLOR_ATTACHMENTS);for(let f=0;f<16;++f)this._colorAttachments[f]=p.COLOR_ATTACHMENT0+f}}queryInstancedArraySupport(h){(h.isWebGL2||h.supportsInstancedArrays)&&(this.drawArraysInstanced=h.isWebGL2?(p,d,f,s)=>h.gl.drawArraysInstanced(p,d,f,s):(p,d,f,s)=>h.instancedArrays.drawArraysInstancedANGLE(p,d,f,s),this.drawElementsInstanced=h.isWebGL2?(p,d,f,s,o)=>h.gl.drawElementsInstanced(p,d,f,s,o):(p,d,f,s,o)=>h.instancedArrays.drawElementsInstancedANGLE(p,d,f,s,o),this.vertexAttribDivisor=h.isWebGL2?(p,d)=>h.gl.vertexAttribDivisor(p,d):(p,d)=>h.instancedArrays.vertexAttribDivisorANGLE(p,d))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(h){(h.isWebGL2||h.supportsDrawBuffers)&&(this.drawBuffers=h.isWebGL2?p=>h.gl.drawBuffers(p):p=>h.drawBuffers.drawBuffersWEBGL(p),this._maxDrawBuffers=h.isWebGL2?h.gl.MAX_DRAW_BUFFERS:h.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(h){(h.isWebGL2||h.supportsVertexArrayObject)&&(this.createVertexArray=h.isWebGL2?()=>h.gl.createVertexArray():()=>h.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=h.isWebGL2?p=>h.gl.deleteVertexArray(p):p=>h.vertexArrayObject.deleteVertexArrayOES(p),this.isVertexArray=h.isWebGL2?p=>h.gl.isVertexArray(p):p=>h.vertexArrayObject.isVertexArrayOES(p),this.bindVertexArray=h.isWebGL2?p=>h.gl.bindVertexArray(p):p=>h.vertexArrayObject.bindVertexArrayOES(p))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(h){const p=h.gl;this._maxUniformVec3Components=h.isWebGL2?p.getParameter(p.MAX_VERTEX_UNIFORM_COMPONENTS):3*p.getParameter(p.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(h){const p=h.gl;h.isWebGL2?this.bufferSubData=(d,f,s,o,u=0)=>p.bufferSubData(d,f,s,o,u):this.bufferSubData=(d,f,s,o=0,u=0)=>((0,n.logIf)(o!==0,n.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),(0,n.logIf)(u!==0,n.LogLevel.Warning,"length ignored (not supported in WebGL)"),p.bufferSubData(d,f,s))}queryTexImageInterface(h){const p=h.gl;h.isWebGL2?this.texImage2D=(d,f,s,o,u,b,v,_,g,x)=>g instanceof ArrayBuffer?p.texImage2D(d,f,s,o,u,b,v,_,g===void 0?null:g,x):((0,n.assert)(x===void 0,"offset expected to be undefined for non ArrayBuffer source"),p.texImage2D(d,f,s,o,u,b,v,_,g===void 0?null:g)):this.texImage2D=(d,f,s,o,u,b,v,_,g,x)=>g===void 0?p.texImage2D(d,f,s,o,u,b,v,_,null):g instanceof Int8Array||g instanceof Uint8Array||g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array||g instanceof DataView?p.texImage2D(d,f,s,o,u,b,v,_,g):p.texImage2D(d,f,s,v,_,g),h.supportsTexImage3D?this.texImage3D=(d,f,s,o,u,b,v,_,g,x,T)=>x instanceof ArrayBuffer?p.texImage3D(d,f,s,o,u,b,v,_,g,x===void 0?null:x,T):((0,n.assert)(T===void 0,"offset expected to be undefined for non ArrayBuffer source"),p.texImage3D(d,f,s,o,u,b,v,_,g,x===void 0?null:x)):this.texImage3D=(d,f,s,o,u,b,v,_,g,x,T)=>(0,n.assert)(!1,"texImage3D not supported on this context")}}},6119:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFHelper=void 0;const n=a(9504);r.GLTFHelper=class{static modeToEnum(i,h){return(h<0||h>6)&&(0,n.log)(n.LogLevel.Error,`Specified draw mode is ${h} but is required to be between 0 and 6`),h===0?i.POINTS:h===1?i.LINES:h===2?i.LINE_LOOP:h===3?i.LINE_STRIP:h===4?i.TRIANGLES:h===5?i.TRIANGLE_STRIP:h===6?i.TRIANGLE_FAN:i.TRIANGLES}static nameToAttributeIndex(i){return i==="POSITION"?0:i==="NORMAL"?1:i==="TANGENT"?2:i==="TEXCOORD_0"?3:i==="TEXCOORD_1"?4:i==="TEXCOORD_2"?5:i==="JOINTS_0"?6:i==="WEIGHTS_0"?7:i==="COLOR_0"?8:((0,n.log)(n.LogLevel.Warning,`Unknown attribute name '${i}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},2604:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFLoader=void 0;const n=a(3557),i=a(9504),h=a(4613),p=a(6119),d=a(122),f=a(9806),s=a(2078),o=a(7340),u=a(1854),b=a(4168),v=a(5315),_=a(651),g=a(771),x=a(8593);r.GLTFLoader=class{constructor(T){this._context=T;const O=this._context.gl;this._resourceManager=new u.ResourceManager(this._context),this._scenes=new Array;const A=new g.Shader(this._context,O.VERTEX_SHADER,"gltf_default.vert");A.initialize(a(6626));const R=new g.Shader(this._context,O.FRAGMENT_SHADER,"gltf_default.frag");R.initialize(a(5347)),this._pbrProgram=new b.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([A,R])}async loadTextures(T){const O=this._context.gl;this._uriTextureMap=new Map;const A=T.gltf.textures,R=T.gltf.images,P=T.gltf.samplers;if(!A||!R)return;let C=0;for(const U of A){if(U.source===void 0){(0,i.log)(i.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),C++;continue}const j=U.source,k=R[j],$=this._sceneName+"_texture_"+C,Y=k.name===void 0?k.uri:k.name;let Z=await T.imageData.get(j);if(!(0,i.isPowerOfTwo)(Z.width)||!(0,i.isPowerOfTwo)(Z.height)){const Q=document.createElement("canvas");Q.width=(0,i.upperPowerOfTwo)(Z.width),Q.height=(0,i.upperPowerOfTwo)(Z.height);const ie=Q.getContext("2d");ie===void 0&&(0,i.log)(i.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),ie.drawImage(Z,0,0,Q.width,Q.height),Z=Q}const J=new x.Texture2D(this._context,Y);if(J.initialize(Z.width,Z.height,O.RGBA8,O.RGBA,O.UNSIGNED_BYTE),J.data(Z),P===void 0||U.sampler===void 0)J.wrap(O.REPEAT,O.REPEAT),J.filter(O.LINEAR,O.LINEAR);else{const Q=P[U.sampler];J.wrap(Q.wrapS||O.REPEAT,Q.wrapT||O.REPEAT),J.filter(Q.magFilter||O.LINEAR,Q.minFilter||O.LINEAR),Q.minFilter!==O.NEAREST_MIPMAP_NEAREST&&Q.minFilter!==O.LINEAR_MIPMAP_NEAREST&&Q.minFilter!==O.NEAREST_MIPMAP_LINEAR&&Q.minFilter!==O.LINEAR_MIPMAP_LINEAR||J.generateMipMap()}this._resourceManager.add(J,[Y,$]);const te=k.uri?k.uri:$;this._uriTextureMap.set(te,J),C++}}getTexture(T){const O=this._sceneName+"_texture_"+T,A=this._resourceManager.get(O);if(A!==void 0)return A;(0,i.log)(i.LogLevel.Warning,`Texture with index ${T} could not be located.`)}async loadMaterials(T){this._pbrDefaultMaterial=new f.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const O=T.gltf.materials;if(!O)return;let A=0;for(const R of O){const P=this._sceneName+"_material_"+A,C=new f.GLTFPbrMaterial(this._context,R.name),U=R.normalTexture;U!==void 0&&(C.normalTexture=this.getTexture(U.index),C.normalTexCoord=U.texCoord||0,C.normalScale=U.scale||1);const j=R.occlusionTexture;j!==void 0&&(C.occlusionTexture=this.getTexture(j.index),C.occlusionTexCoord=j.texCoord||0);const k=R.emissiveTexture;k!==void 0&&(C.emissiveTexture=this.getTexture(k.index),C.emissiveTexCoord=k.texCoord||0),C.emissiveFactor=n.vec3.fromValues(0,0,0),R.emissiveFactor!==void 0&&(C.emissiveFactor=n.vec3.fromValues.apply(void 0,R.emissiveFactor)),C.alphaMode=f.GLTFAlphaMode.OPAQUE,R.alphaMode==="MASK"?(C.alphaMode=f.GLTFAlphaMode.MASK,R.alphaCutoff===void 0?C.alphaCutoff=.5:C.alphaCutoff=R.alphaCutoff):R.alphaMode==="BLEND"&&(C.alphaMode=f.GLTFAlphaMode.BLEND,C.isTransparent=!0),C.isDoubleSided=R.doubleSided||!1;const $=R.pbrMetallicRoughness;$===void 0&&(0,i.log)(i.LogLevel.Warning,"Model contains a material without PBR information");const Y=$.baseColorTexture;Y!==void 0&&(C.baseColorTexture=this.getTexture(Y.index),C.baseColorTexCoord=Y.texCoord||0);const Z=$.metallicRoughnessTexture;Z!==void 0&&(C.metallicRoughnessTexture=this.getTexture(Z.index),C.metallicRoughnessTexCoord=Z.texCoord||0),C.baseColorFactor=n.vec4.fromValues(1,1,1,1),$.baseColorFactor!==void 0&&(C.baseColorFactor=n.vec4.fromValues.apply(void 0,$.baseColorFactor)),C.metallicFactor=1,$.metallicFactor!==void 0&&(C.metallicFactor=$.metallicFactor),C.roughnessFactor=1,$.roughnessFactor!==void 0&&(C.roughnessFactor=$.roughnessFactor),this._resourceManager.add(C,[R.name,P]),A++}}inferBufferUsage(T,O){const A=this._context.gl,R=T.gltf.meshes,P=T.gltf.accessors;if(R===void 0||P===void 0)return(0,i.log)(i.LogLevel.Error,"Asset does not include any meshes or accessors"),A.ARRAY_BUFFER;for(const C of R)for(const U of C.primitives){const j=U.indices;if(j===void 0)continue;const k=P[j].bufferView;if(k!==void 0&&k===O)return A.ELEMENT_ARRAY_BUFFER}return A.ARRAY_BUFFER}async loadBuffers(T){const O=this._context.gl,A=T.gltf.bufferViews,R=T.gltf.accessors;if(!A)return void(0,i.log)(i.LogLevel.Warning,"The asset does not include any buffer view information.");if(!R)return void(0,i.log)(i.LogLevel.Warning,"The asset does not include any accessor information.");let P=0;for(const U of A){const j=this._sceneName+"_bufferView_"+P,k=await T.bufferViewData(P);let $=U.target;$===void 0&&($=this.inferBufferUsage(T,P));const Y=new o.Buffer(this._context,j);Y.initialize($),Y.data(k,O.STATIC_DRAW),this._resourceManager.add(Y,[j]),P++}let C=0;for(const U of R){const j=U.bufferView,k=U.sparse;if(j===void 0||k!==void 0){const $=this._sceneName+"_accessor_"+C,Y=new o.Buffer(this._context,$),Z=await T.accessorData(C);Y.initialize(O.ARRAY_BUFFER),Y.data(Z,O.STATIC_DRAW),this._resourceManager.add(Y,[$])}C++}}async loadMeshes(T){this._meshes=new Array,this._nameMeshMap=new Map;const O=T.gltf.meshes;if(O===void 0)return(0,i.log)(i.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let A=0;for(const R of O){const P=new d.GLTFMesh(R.name);for(const C of R.primitives){const U=await this.loadPrimitive(T,C,A);U!==void 0&&P.addPrimitive(U),A++}R.name&&this._nameMeshMap.set(R.name,P),this._meshes.push(P)}return this._meshes}async loadPrimitive(T,O,A){const R=this._context.gl,P=T.gltf.accessors,C=T.gltf.bufferViews;if(P===void 0)return void(0,i.log)(i.LogLevel.Error,"GLTF asset does not have any accessors.");if(C===void 0)return void(0,i.log)(i.LogLevel.Error,"GLTF asset does not have any buffer views.");let U=O.mode;const j=this._sceneName+"_primitive_"+A;U||(U=4);const k=p.GLTFHelper.modeToEnum(R,U),$=new Array;let Y=this._pbrDefaultMaterial;if(O.material!==void 0){const Q=this._sceneName+"_material_"+O.material,ie=this._resourceManager.get(Q);ie!==void 0?Y=ie:(0,i.log)(i.LogLevel.Warning,`Material ${Q} could not be found.`)}let Z,J=0;for(const Q in O.attributes){const ie=p.GLTFHelper.nameToAttributeIndex(Q);Q==="NORMAL"&&(J|=f.GLTFShaderFlags.HAS_NORMALS),Q==="TANGENT"&&(J|=f.GLTFShaderFlags.HAS_TANGENTS),Q==="COLOR_0"&&(J|=f.GLTFShaderFlags.HAS_COLORS),Q!=="TEXCOORD_0"&&Q!=="TEXCOORD_1"&&Q!=="TEXCOORD_2"||(J|=f.GLTFShaderFlags.HAS_UV);const ce=O.attributes[Q],de=P[ce],me=de.bufferView,xe=de.sparse;let Ce,se=0;if(me===void 0||xe!==void 0){const Be=this._sceneName+"_accessor_"+ce;Ce=this._resourceManager.get(Be)}else{const Be=C[me],ot=this._sceneName+"_bufferView_"+me;Ce=this._resourceManager.get(ot),se=Be.byteStride||0}const we=new s.VertexBinding;we.buffer=Ce,we.attributeIndex=ie,we.numVertices=de.count,we.normalized=de.normalized||!1,we.size=h.GLTF_ELEMENTS_PER_TYPE[de.type],we.offset=de.byteOffset||0,we.stride=se,we.type=de.componentType,$.push(we)}if(O.indices!==void 0){const Q=P[O.indices],ie=Q.bufferView;!ie===void 0&&(0,i.log)(i.LogLevel.Error,"Accessor does not reference a BufferView.");const ce=this._sceneName+"_bufferView_"+ie,de=this._resourceManager.get(ce);Z=new s.IndexBinding,Z.buffer=de,Z.numIndices=Q.count,Z.offset=Q.byteOffset||0,Z.type=Q.componentType}const te=new s.GLTFPrimitive(this._context,$,Z,k,Y,J);return te.initialize(),this._resourceManager.add(te,[j]),te}async generateScenes(T){const O=T.gltf.nodes,A=T.gltf.scenes;if(!O||!A)return void(0,i.log)(i.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const R=new Map;let P=0;for(const j of O){const k=j.name||"node_"+P,$=new _.SceneNode(k);if(R.set(P,$),j.matrix){const Y=n.mat4.fromValues.apply(void 0,j.matrix),Z=new v.TransformComponent(Y);$.addComponent(Z)}else if(j.translation||j.rotation||j.scale){let Y=n.quat.create();j.rotation&&(Y=n.quat.fromValues.apply(void 0,j.rotation));let Z=n.vec3.create();j.translation&&(Z=n.vec3.fromValues.apply(void 0,j.translation));let J=n.vec3.fromValues(1,1,1);j.scale&&(J=n.vec3.fromValues.apply(void 0,j.scale));const te=n.mat4.fromRotationTranslationScale(n.mat4.create(),Y,Z,J),Q=new v.TransformComponent(te);$.addComponent(Q)}if(j.mesh!==void 0){const Y=this._meshes[j.mesh];for(const Z of Y.primitives){const J=new v.GeometryComponent;J.material=Z.material,J.geometry=Z,$.addComponent(J)}}(j.skin||j.weights)&&(0,i.log)(i.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),P++}P=0;for(const j of O){const k=R.get(P);if((0,i.assert)(k!==void 0,"Scene node could not be found."),j.children)for(const $ of j.children){const Y=R.get($);Y||(0,i.log)(i.LogLevel.Error,"Model references a node that does not exist."),k.addNode(Y)}P++}let C=0;for(const j of A){const k=j.name||"scene_"+C,$=new _.SceneNode(k);if(j.nodes)for(const Y of j.nodes){const Z=R.get(Y);Z||(0,i.log)(i.LogLevel.Error,"Scene references a node that does not exist."),$.addNode(Z)}else(0,i.log)(i.LogLevel.Warning,`Scene ${k} does not contain any nodes.`);this._scenes.push($),C++}const U=T.gltf.scene;U!==void 0&&(this._defaultScene=this._scenes[U])}async loadAsset(T){const O=new h.GltfLoader,A=await O.load(T),R=A.gltf;this._sceneName="scene",R.scenes&&R.scene&&R.scenes[R.scene].name&&(this._sceneName=R.scenes[R.scene].name),await this.loadTextures(A).then(()=>this.loadMaterials(A)).then(()=>this.loadBuffers(A)).then(()=>this.loadMeshes(A)).then(()=>this.generateScenes(A))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(T){return this._nameMeshMap.get(T)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return this._defaultScene!==void 0?this._defaultScene:this._scenes!==void 0&&this._scenes.length>0?this._scenes[0]:((0,i.log)(i.LogLevel.Warning,"Default scene was requested, but none is available."),new _.SceneNode("EmptyScene"))}}},122:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFMesh=void 0,r.GLTFMesh=class{constructor(a){this._name=a,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(a){this._primitives.push(a)}}},9806:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFPbrMaterial=r.GLTFAlphaMode=r.GLTFShaderFlags=void 0;const n=a(3557),i=a(5315);var h,p;(function(f){f[f.HAS_NORMALS=1]="HAS_NORMALS",f[f.HAS_TANGENTS=2]="HAS_TANGENTS",f[f.HAS_UV=4]="HAS_UV",f[f.HAS_COLORS=8]="HAS_COLORS",f[f.USE_IBL=16]="USE_IBL",f[f.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",f[f.HAS_NORMALMAP=64]="HAS_NORMALMAP",f[f.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",f[f.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",f[f.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",f[f.USE_TEX_LOD=1024]="USE_TEX_LOD"})(h||(r.GLTFShaderFlags=h={})),function(f){f[f.OPAQUE=0]="OPAQUE",f[f.MASK=1]="MASK",f[f.BLEND=2]="BLEND"}(p||(r.GLTFAlphaMode=p={}));class d extends i.Material{constructor(s,o){super(s,o),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=p.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=n.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=n.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(s){this._baseColorTexture=s}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(s){this._metallicRoughnessTexture=s}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(s){this._normalTexture=s}get normalTexture(){return this._normalTexture}set occlusionTexture(s){this._occlusionTexture=s}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(s){this._emissiveTexture=s}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(s){this._emissiveFactor=s}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(s){this._baseColorFactor=s}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(s){this._metallicFactor=s}get metallicFactor(){return this._metallicFactor}set roughnessFactor(s){this._roughnessFactor=s}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(s){this._normalScale=s}set isDoubleSided(s){this._isDoubleSided=s}get isDoubleSided(){return this._isDoubleSided}set alphaMode(s){this._alphaMode=s}get alphaMode(){return this._alphaMode}set alphaCutoff(s){this._alphaCutoff=s}get alphaCutoff(){return this._alphaCutoff}get flags(){let s=0;return this.baseColorTexture!==void 0&&(s|=h.HAS_BASECOLORMAP),this.metallicRoughnessTexture!==void 0&&(s|=h.HAS_METALROUGHNESSMAP),this.normalTexture!==void 0&&(s|=h.HAS_NORMALMAP),this.occlusionTexture!==void 0&&(s|=h.HAS_OCCLUSIONMAP),this.emissiveTexture!==void 0&&(s|=h.HAS_EMISSIVEMAP),s}}r.GLTFPbrMaterial=d},2078:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFPrimitive=r.VertexBinding=r.IndexBinding=void 0;const n=a(638),i=a(6119);r.IndexBinding=class{},r.VertexBinding=class{};class h extends n.Geometry{constructor(d,f,s,o,u,b,v){super(d,v),this._bindings=f,this._indexBinding=s,this._material=u,this._geometryFlags=b,this._drawMode=o}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const d of this._bindings)d.buffer.attribEnable(d.attributeIndex,d.size,d.type,d.normalized,d.stride,d.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const d of this._bindings)d.buffer.attribDisable(d.attributeIndex,!0,!0)}draw(){const d=this.context.gl;this._indexBinding?d.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):d.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(d){const f=i.GLTFHelper.nameToAttributeIndex(d);for(const s of this._bindings)if(s.attributeIndex===f)return s}}r.GLTFPrimitive=h},8892:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFMesh=r.GLTFPrimitive=r.GLTFShaderFlags=r.GLTFPbrMaterial=r.GLTFAlphaMode=r.GLTFLoader=void 0;var n=a(2604);Object.defineProperty(r,"GLTFLoader",{enumerable:!0,get:function(){return n.GLTFLoader}});var i=a(9806);Object.defineProperty(r,"GLTFAlphaMode",{enumerable:!0,get:function(){return i.GLTFAlphaMode}}),Object.defineProperty(r,"GLTFPbrMaterial",{enumerable:!0,get:function(){return i.GLTFPbrMaterial}}),Object.defineProperty(r,"GLTFShaderFlags",{enumerable:!0,get:function(){return i.GLTFShaderFlags}});var h=a(2078);Object.defineProperty(r,"GLTFPrimitive",{enumerable:!0,get:function(){return h.GLTFPrimitive}});var p=a(122);Object.defineProperty(r,"GLTFMesh",{enumerable:!0,get:function(){return p.GLTFMesh}})},4127:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Initializable=void 0;const n=a(9504);class i{constructor(){this._initialized=!1,this.assertInitialized=()=>i.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(p,d,f)=>{const s=f.value;return f.value=function(){return(0,n.assert)(this._initialized===!1,"re-initialization of initialized object not anticipated"),this._initialized=s.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>i.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>i.assertInitializedFalse(this)),this._initialized},f}}static uninitialize(){return(p,d,f)=>{const s=f.value;return f.value=function(){(0,n.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>i.assertInitializedFalse(this)},f}}static discard(){return(p,d,f)=>{const s=f.value;return f.value=function(){(0,n.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>i.assertInitializedFalse(this)},f}}static assert_initialized(){return(p,d,f)=>{const s=f.value;return f.value=function(){return this.assertInitialized(),s.apply(this,arguments)},f}}static assert_uninitialized(){return(p,d,f)=>{const s=f.value;return f.value=function(){this.assertUninitialized(),s.apply(this,arguments)},f}}get initialized(){return this._initialized}}r.Initializable=i,i.assertInitializedFalse=h=>(0,n.assert)(!1,`instance of ${h.constructor.name} expected to be initialized`),i.assertUninitializedFalse=h=>(0,n.assert)(!1,`instance of ${h.constructor.name} not expected to be initialized`)},4287:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.KernelI8=r.KernelUI8=r.KernelI32=r.KernelUI32=r.KernelF32=r.AbstractKernel=void 0;const n=a(9504);class i{constructor(p,d,f=1,s=1){this._components=p,this._width=isNaN(d)?1:Math.max(1,d),this._height=Math.max(1,f),this._depth=Math.max(1,s),this.resize()}get(p,d,f){let s;switch(s=d===void 0&&f===void 0?this._components*p:this.index(p,d,f||0),(0,n.assert)(s<this.length,`index expected to be in range [0, ${this.length-1}], given ${s}`),this._components){case 1:return[this._samples[s]];case 2:return[this._samples[s],this._samples[s+1]];case 3:return[this._samples[s],this._samples[s+1],this._samples[s+2]];case 4:return[this._samples[s],this._samples[s+1],this._samples[s+2],this._samples[s+3]]}}set(p,d,f,s){let o;switch((0,n.assert)(p.length===this._components,`number of components expected to be ${this._components}, given ${p.length}`),o=f===void 0&&s===void 0?this._components*Math.min(this.elements,Math.max(0,d)):this._components*this.index(d,f,s||0),(0,n.assert)(o<this.length,`index expected to be in range [0, ${this.length-1}], given ${o}`),this._components){case 4:this._samples[o+3]=p[3];case 3:this._samples[o+2]=p[2];case 2:this._samples[o+1]=p[1];case 1:this._samples[o+0]=p[0]}}fromJSON(p){(0,n.assert)(p.size&&p.size.width!==void 0&&p.size.height!==void 0&&p.size.depth!==void 0,`expected kernel width, height, and depth to be set, given '${p.size}'`);const d=s=>s.reduce((o,u)=>o.concat(Array.isArray(u)?d(u):u),[]);this._width=Math.max(1,p.size.width),this._height=Math.max(1,p.size.height),this._depth=Math.max(1,p.size.depth);const f=d(p.kernel);this._components=Math.floor(f.length/this.elements),this.resize(),this.fromArray(f)}index(p,d=0,f=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,f))+Math.min(this._height,Math.max(0,d)))+Math.min(this._width,Math.max(0,p))}position(p){let d=Math.min(this.elements,Math.max(0,p));const f=Math.floor(d/(this._width*this._height));d-=f*this._width*this._height;const s=Math.floor(d/this._width);return d-=s*this._width,[d,s,f]}sort(p){if(this.elements<2)return;const d=Array(this.elements);for(let s=0;s<this.elements;++s){let o=0;i.SortApproach.BySquaredLength;for(let u=0;u<this._components;++u){const b=this._samples[s*this._components+u];o+=b*b}d[s]=[s,o]}i.SortApproach.BySquaredLength,d.sort((s,o)=>s[1]-o[1]);const f=this._samples.slice();for(let s=0;s<d.length;++s)for(let o=0;o<this._components;++o){const u=d[s][0]*this._components+o,b=s*this._components+o;this._samples[b]=f[u]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const p=this._width*this._height*this._depth;return isNaN(p)?0:p}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}r.AbstractKernel=i,function(h){(function(p){p[p.BySquaredLength=0]="BySquaredLength"})(h.SortApproach||(h.SortApproach={}))}(i||(r.AbstractKernel=i={})),r.KernelF32=class extends i{resize(){this._samples=new Float32Array(this.length)}fromArray(h){(0,n.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(h))}get bytesPerComponent(){return 4}},r.KernelUI32=class extends i{resize(){this._samples=new Uint32Array(this.length)}fromArray(h){(0,n.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(h))}get bytesPerComponent(){return 4}},r.KernelI32=class extends i{resize(){this._samples=new Int32Array(this.length)}fromArray(h){(0,n.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(h))}get bytesPerComponent(){return 4}},r.KernelUI8=class extends i{resize(){this._samples=new Uint8Array(this.length)}fromArray(h){(0,n.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(h))}get bytesPerComponent(){return 4}},r.KernelI8=class extends i{resize(){this._samples=new Int8Array(this.length)}fromArray(h){(0,n.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(h))}get bytesPerComponent(){return 4}}},5678:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardEventType=r.KeyboardEventProvider=void 0;const n=a(7032),i=a(9504);var h;r.KeyboardEventProvider=class{constructor(p,d){(0,i.assert)(p!==void 0,`expected valid canvas element on initialization, given ${p}`),this._element=p,this._timeframe=d}preventDefaultOnEvent(p,d){(0,i.bitInBitfield)(this._preventDefaultMask,p)&&d.preventDefault()}preventDefault(...p){for(const d of p)(0,i.bitInBitfield)(this._preventDefaultMask,d)||(this._preventDefaultMask|=d)}allowDefault(...p){for(const d of p)(0,i.bitInBitfield)(this._preventDefaultMask,d)&&(this._preventDefaultMask&=~d)}observable(p){switch(p){case h.KeyDown:return this.keyDown$;case h.KeyPress:return this.keyPress$;case h.KeyUp:return this.keyUp$;default:return}}get keyDown$(){return this._keyDownSubject===void 0&&(this._keyDownSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyDownListener=p=>{this.preventDefaultOnEvent(h.KeyDown,p),this._keyDownSubject.next(p)},this._element.addEventListener("keydown",this._keyDownListener)),this._keyDownSubject.asObservable()}get keyPress$(){return this._keyPressSubject===void 0&&(this._keyPressSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyPressListener=p=>{this.preventDefaultOnEvent(h.KeyPress,p),this._keyPressSubject.next(p)},this._element.addEventListener("keypress",this._keyPressListener)),this._keyPressSubject.asObservable()}get keyUp$(){return this._keyUpSubject===void 0&&(this._keyUpSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyUpListener=p=>{this.preventDefaultOnEvent(h.KeyUp,p),this._keyUpSubject.next(p)},this._element.addEventListener("keyup",this._keyUpListener)),this._keyUpSubject.asObservable()}},function(p){p[p.KeyDown=1]="KeyDown",p[p.KeyPress=2]="KeyPress",p[p.KeyUp=4]="KeyUp"}(h||(r.KeyboardEventType=h={}))},4602:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MouseEventProvider=void 0;const n=a(7032),i=a(9504),h=a(8853),p=a(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,i.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(h.IS_EDGE||h.IS_IE11)&&this._element.addEventListener("dragstart",u=>u.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&p.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,i.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,i.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,i.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Click:return this.click$;case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Wheel:return this.wheel$;case d.Type.Drag:return this.drag$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,p.PointerLock.exit())}get pointerLock(){return p.PointerLock.active(this._element)}get click$(){return this._clickSubject===void 0&&(this._clickSubject=new n.ReplaySubject(void 0,this._timeframe),this._clickListener=s=>{this.preventDefaultOnEvent(d.Type.Click,s),this._clickSubject.next(s)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return this._wheelSubject===void 0&&(this._wheelSubject=new n.ReplaySubject(void 0,this._timeframe),this._wheelListener=s=>{this.preventDefaultOnEvent(d.Type.Wheel,s),this._wheelSubject.next(s)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return this._dragSubject===void 0&&(this._dragSubject=new n.ReplaySubject(void 0,this._timeframe),this._dragListener=s=>{this.preventDefaultOnEvent(d.Type.Drag,s),this._dragSubject.next(s)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}r.MouseEventProvider=d,function(f){(function(s){s[s.Click=1]="Click",s[s.Wheel=2]="Wheel",s[s.Enter=4]="Enter",s[s.Leave=8]="Leave",s[s.Move=16]="Move",s[s.Down=32]="Down",s[s.Up=64]="Up",s[s.Drag=128]="Drag"})(f.Type||(f.Type={}))}(d||(r.MouseEventProvider=d={}))},8853:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.IS_EDGE=r.IS_IE11=void 0,r.IS_IE11=typeof navigator>"u"?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),r.IS_EDGE=typeof navigator>"u"?void 0:/Edge\/\d./i.test(navigator.userAgent)},4264:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Navigation=void 0;const n=a(3557),i=a(2),h=a(2010),p=a(9504),d=a(4850),f=a(506),s=a(5222),o=a(3151),u=a(9184),b=a(7137);class v{constructor(g,x){this._alwaysRotateOnMove=!1,this._invalidate=g,this._eventHandler=new i.EventHandler(g,x),this._eventHandler.pushPointerDownHandler((T,O)=>this.onPointerDown(T,O)),this._eventHandler.pushPointerUpHandler((T,O)=>this.onPointerUp(T,O)),this._eventHandler.pushPointerEnterHandler((T,O)=>this.onPointerEnter(T,O)),this._eventHandler.pushPointerLeaveHandler((T,O)=>this.onPointerLeave(T,O)),this._eventHandler.pushPointerMoveHandler((T,O)=>this.onPointerMove(T,O)),this._eventHandler.pushPointerCancelHandler((T,O)=>this.onPointerCancel(T,O)),this._eventHandler.pushMouseWheelHandler((T,O)=>this.onWheel(T,O)),this.rotationMetaphor=v.RotationMetaphor.Turntable,this._pan=new f.PanModifier,this._pinch=new s.PinchZoomModifier,this._wheelZoom=new b.WheelZoomModifier,this._activeEvents=new Map}mode(){const g=Array.from(this._activeEvents.values()),x=this.getPrimaryEvent(g);if(x===void 0)return void(0,p.log)(p.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const T=x.pointerType==="mouse",O=x.pointerType==="touch"||x.pointerType==="pen",A=1&x.buttons,R=x.shiftKey,P=h.PointerLock.active()&&this._alwaysRotateOnMove,C=this._activeEvents.size;return P?v.Modes.Rotate:T&&A&&R&&C===1?v.Modes.Pan:O&&C===2?v.Modes.MultiTouch:T&&A&&C===1||O&&C===1?v.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void(0,p.log)(p.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const g=Array.from(this._activeEvents.values()),x=n.vec2.fromValues(g[0].movementX,g[0].movementY),T=n.vec2.fromValues(g[1].movementX,g[1].movementY);return n.vec2.length(x)===0||n.vec2.length(T)===0?v.Modes.Zoom:(n.vec2.normalize(x,x),n.vec2.normalize(T,T),n.vec2.dot(x,T)>.2?v.Modes.Pan:v.Modes.Zoom)}rotate(g){if(this._activeEvents.size!==1)return void(0,p.log)(p.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),T=this._eventHandler.offsets(x[0])[0];switch(this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:const O=this._firstPerson;let A;h.PointerLock.active()&&event instanceof MouseEvent&&(A=n.vec2.fromValues(event.movementX,event.movementY)),g?O.initiate(T):O.process(T,A);break;case v.RotationMetaphor.Trackball:const R=this._trackball;g?R.initiate(T):R.process(T);break;case v.RotationMetaphor.Turntable:const P=this._turntable;g?P.initiate(T):P.process(T)}}pan(g){const x=Array.from(this._activeEvents.values()),T=this.getPrimaryEvent(x);if(T===void 0)return void(0,p.log)(p.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const O=this._eventHandler.offsets(T)[0],A=this._pan;g?A.initiate(O):A.process(O)}pinch(g){if(this._activeEvents.size!==2)return void(0,p.log)(p.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),T=this._eventHandler.offsets(x[0])[0],O=this._eventHandler.offsets(x[1])[0],A=this._pinch;g?A.initiate(T,O):A.process(T,O)}getPrimaryEvent(g){for(const x of g)if(x.isPrimary)return x}onPointerDown(g,x){for(const T of g)this._activeEvents.set(T.pointerId,T);switch(this._mode=this.mode(),this._mode){case v.Modes.Rotate:this.rotate(!0);break;case v.Modes.Pan:this.pan(!0);break;case v.Modes.Zoom:this.pinch(!0)}}onPointerUp(g,x){for(const T of g)this._activeEvents.delete(T.pointerId)}onPointerEnter(g,x){}onPointerLeave(g,x){for(const T of g)this._activeEvents.delete(T.pointerId)}onPointerCancel(g,x){for(const T of g)this._activeEvents.delete(T.pointerId)}onPointerMove(g,x){for(const R of g)this._activeEvents.set(R.pointerId,R);if(this._mode===void 0)return;const T=Array.from(this._activeEvents.values()),O=this.getPrimaryEvent(T);O&&O.pointerType==="mouse"&&(this._mode=this.mode());let A=!1;switch(this._mode===v.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),A=!0),this._mode){case v.Modes.Rotate:this.rotate(A);break;case v.Modes.Pan:this.pan(A);break;case v.Modes.Zoom:this.pinch(A)}this._lastInteractionTime=performance.now()}onWheel(g,x){const T=g[0];this._wheelZoom.process(T.deltaY)}update(){this._eventHandler.update()}set camera(g){this._camera=g,this._firstPerson&&(this._firstPerson.camera=g),this._trackball&&(this._trackball.camera=g),this._turntable&&(this._turntable.camera=g),this._pan&&(this._pan.camera=g),this._pinch&&(this._pinch.camera=g),this._wheelZoom&&(this._wheelZoom.camera=g)}set rotationMetaphor(g){if(this._rotationMetaphor!==g){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=g,this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new d.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case v.RotationMetaphor.Trackball:this._trackball=new o.TrackballModifier,this._trackball.camera=this._camera;break;case v.RotationMetaphor.Turntable:this._turntable=new u.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}r.Navigation=v,function(_){(function(g){g[g.Move=0]="Move",g[g.Pan=1]="Pan",g[g.MultiTouch=2]="MultiTouch",g[g.Rotate=3]="Rotate",g[g.Zoom=4]="Zoom",g[g.ZoomStep=5]="ZoomStep"})(_.Modes||(_.Modes={})),function(g){g.FirstPerson="firstperson",g.Flight="flight",g.Trackball="trackball",g.Turntable="turntable"}(_.RotationMetaphor||(_.RotationMetaphor={}))}(v||(r.Navigation=v={}))},5491:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.NdcFillingRectangle=void 0;const i=a(7340),h=a(638),p=a(4127);class d extends h.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const u=new i.Buffer(s,`${o}VBO`);this._buffers.push(u)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),u}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}r.NdcFillingRectangle=d,d.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),n([p.Initializable.assert_initialized()],d.prototype,"draw",null)},1896:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.NdcFillingTriangle=void 0;const i=a(7340),h=a(638),p=a(4127);class d extends h.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const u=new i.Buffer(s,`${o}VBO`);this._buffers.push(u)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,u=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),u}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}r.NdcFillingTriangle=d,d.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),n([p.Initializable.assert_initialized()],d.prototype,"draw",null)},9965:function(l,r,a){var n=this&&this.__decorate||function(d,f,s,o){var u,b=arguments.length,v=b<3?f:o===null?o=Object.getOwnPropertyDescriptor(f,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,f,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(b<3?u(v):b>3?u(f,s,v):u(f,s))||v);return b>3&&v&&Object.defineProperty(f,s,v),v};Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractObject=void 0;const i=a(9504),h=a(4127);class p extends h.Initializable{constructor(f,s){super(),this._valid=!1,this._referenceCount=0,this._context=f,this._identifier=s!==void 0&&s!==""?s:"Object"}initialize(...f){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...f),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),(0,i.log)(i.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),(0,i.assert)(this._object===void 0,`expected object '${this._identifier}' to be undefined after delete`),(0,i.assert)(this._valid===!1,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return(0,i.assert)(this._object!==void 0,"access to undefined object"),this._object}get valid(){return this._valid}ref(){(0,i.assert)(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){(0,i.assert)(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}r.AbstractObject=p,n([h.Initializable.initialize()],p.prototype,"initialize",null),n([h.Initializable.uninitialize()],p.prototype,"uninitialize",null)},506:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PanModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=p.DEFAULT_SENSITIVITY,this._translation=(0,i.v3)()}initiate(f){Object.assign(this._reference,this._camera),this._initialPoint=f}process(f){this._currentPoint=f;const s=n.vec2.subtract((0,i.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity);const o=n.vec3.sub((0,i.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(o,o);const u=this._reference.up;n.vec3.normalize(u,u);const b=n.vec3.cross((0,i.v3)(),u,o),v=n.vec3.scale((0,i.v3)(),b,s[0]),_=n.vec3.scale((0,i.v3)(),u,s[1]);n.vec3.negate(_,_),this._translation=n.vec3.add((0,i.v3)(),_,v),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._translation),s=n.vec3.transformMat4((0,i.v3)(),this._reference.eye,f),o=n.vec3.transformMat4((0,i.v3)(),this._reference.center,f);this._camera.eye=s,this._camera.center=o}}r.PanModifier=p,p.DEFAULT_SENSITIVITY=.002},5222:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PinchZoomModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=p.DEFAULT_SENSITIVITY,this._translation=(0,i.v3)()}initiate(f,s){Object.assign(this._reference,this._camera);const o=n.vec2.subtract((0,i.v2)(),f,s);this._initialDistance=n.vec2.length(o)}process(f,s){const o=n.vec2.subtract((0,i.v2)(),f,s);this._currentDistance=n.vec2.length(o);const u=(this._currentDistance/this._initialDistance-1)*p.DEFAULT_SENSITIVITY,b=n.vec3.sub((0,i.v3)(),this._reference.center,this._reference.eye);n.vec3.normalize(b,b),this._translation=n.vec3.scale((0,i.v3)(),b,u),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._translation),s=n.vec3.transformMat4((0,i.v3)(),this._reference.eye,f);this._camera.eye=s}}r.PinchZoomModifier=p,p.DEFAULT_SENSITIVITY=2},8216:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PointerEventProvider=void 0;const n=a(7032),i=a(9504),h=a(8853),p=a(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,i.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(h.IS_EDGE||h.IS_IE11)&&this._element.addEventListener("dragstart",u=>u.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&p.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,i.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,i.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,i.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Cancel:return this.cancel$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,p.PointerLock.exit())}get pointerLock(){return p.PointerLock.active(this._element)}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new n.ReplaySubject(void 0,this._timeframe),this._cancelListener=s=>{this.preventDefaultOnEvent(d.Type.Cancel,s),this._cancelSubject.next(s)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}r.PointerEventProvider=d,function(f){(function(s){s[s.Enter=1]="Enter",s[s.Leave=2]="Leave",s[s.Move=4]="Move",s[s.Down=8]="Down",s[s.Up=16]="Up",s[s.Cancel=32]="Cancel"})(f.Type||(f.Type={}))}(d||(r.PointerEventProvider=d={}))},2010:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PointerLock=void 0;const n=a(9504);class i{static queryAndCacheAPI(){if(i._exit!==void 0)return;const p=window.document,d=[p.exitPointerLock,p.mozExitPointerLock,p.webkitExitPointerLock,void 0];let f=0;for(;f<d.length&&d[f]===void 0;++f);switch(f){case 0:i._exit=()=>p.exitPointerLock(),i._request=s=>s.requestPointerLock(),i._element=()=>p.pointerLockElement;break;case 1:i._exit=()=>p.mozCancelPointerLock(),i._request=s=>s.mozRequestPointerLock(),i._element=()=>p.mozPointerLockElement;break;case 2:i._exit=()=>p.webkitExitPointerLock(),i._request=s=>s.webkitRequestPointerLock(),i._element=()=>p.webkitPointerLockElement;break;default:(0,n.assert)(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(p){return this._element!==void 0&&(p!==void 0&&i._element()===p||p===void 0&&i._element()!==void 0&&i._element()!==null)}static request(p,d){p!==void 0&&(i.queryAndCacheAPI(),i.active()&&i._element()!==p&&i._exit(),i.active()||i._request(p))}static exit(){i._exit&&i._exit()}}r.PointerLock=i},4985:function(){String.prototype.repeat===void 0&&(String.prototype.repeat=function(l){if(this===null)throw new TypeError("can't convert "+this+" to object");const r=""+this;if((l=+l)!=l&&(l=0),l<0)throw new RangeError("repeat count must be non-negative");if(l===1/0)throw new RangeError("repeat count must be less than infinity");if(l=Math.floor(l),r.length===0||l===0)return"";if(r.length*l>=268435456)throw new RangeError("repeat count must not overflow maximum string size");let a="";for(let n=0;n<l;n++)a+=r;return a}),String.prototype.startsWith===void 0&&(String.prototype.startsWith=function(l,r){return r=r||0,this.indexOf(l,r)===r}),String.prototype.endsWith===void 0&&(String.prototype.endsWith=function(l,r){return(r===void 0||r>this.length)&&(r=this.length),this.substring(r-l.length,r)===l}),String.prototype.includes===void 0&&(String.prototype.includes=function(l,r){return typeof r!="number"&&(r=0),!(r+l.length>this.length)&&this.indexOf(l,r)!==-1}),String.prototype.trimLeft===void 0&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight===void 0&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Array.prototype.forEach===void 0&&(Array.prototype.forEach=(l,r)=>{const a=this.length;for(let n=0;n<a;n++)n in this&&l.call(r,this[n],n,this)}),Array.prototype.fill===void 0&&(Array.prototype.fill=(l,r,a)=>{if(this===null)throw new TypeError("this is null or not defined");const n=Object(this),i=n.length>>>0,h=0|r;let p=h<0?Math.max(i+h,0):Math.min(h,i);const d=a===void 0?i:0|a,f=d<0?Math.max(i+d,0):Math.min(d,i);for(;p<f;)n[p]=l,++p;return n}),Math.log10===void 0&&(Math.log10=l=>Math.log(l)*Math.LOG10E),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach(l=>{l.prototype.slice||Object.defineProperty(l.prototype,"slice",{value:Array.prototype.slice}),l.prototype.reduce||Object.defineProperty(l.prototype,"reduce",{value:Array.prototype.reduce}),l.prototype.filter||Object.defineProperty(l.prototype,"filter",{value:Array.prototype.filter}),l.prototype.map||Object.defineProperty(l.prototype,"map",{value:Array.prototype.map}),l.prototype.indexOf||Object.defineProperty(l.prototype,"indexOf",{value:Array.prototype.indexOf})}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{value(l,r){if(l===void 0&&l===null)throw new TypeError("Cannot convert undefined or null to object");const a=Object(l);for(let n=1;n<arguments.length;n++){const i=arguments[n];if(i!=null)for(const h in i)Object.prototype.hasOwnProperty.call(i,h)&&(a[h]=i[h])}return a},configurable:!0,writable:!0})},4168:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.Program=void 0;const i=a(9504),h=a(4127),p=a(9965);class d extends p.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(s=new Array,o=!0){const u=this._context.gl;let b=0,v=0;for(const _ of s)switch(_.type){case u.VERTEX_SHADER:++b;break;case u.FRAGMENT_SHADER:++v;break;default:(0,i.assert)(!1,"Unknown shader type detected.")}if((0,i.logIf)(b<1,i.LogLevel.Error,"at least one vertex shader is expected"),(0,i.logIf)(v<1,i.LogLevel.Error,"at least one fragment shader is expected"),!(b<1||v<1))return this._object=u.createProgram(),this._valid=u.isProgram(this._object),(0,i.assert)(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),s.length>0&&this.attach(s,o),this._object}delete(){(0,i.assert)(this._object!==void 0,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(s,o=!1){(0,i.assert)(this._object!==void 0,"expected a WebGLProgram object");const u=this._context.gl;for(const b of s instanceof Array?s:[s])this._shaders.indexOf(b)>-1||(this._shaders.push(b),b.initialized?(u.attachShader(this._object,b.object),b.ref()):(0,i.log)(i.LogLevel.Error,`shader '${b.identifier}' not initialized.`));return o&&this.link(),!0}detach(s){(0,i.assert)(this._object!==void 0,"expected WebGLProgram object");const o=this._context.gl;for(const u of s instanceof Array?s:[s]){const b=this._shaders.indexOf(u);b>-1&&this._shaders.splice(b),(0,i.assert)(u.initialized,`expected shader '${u.identifier}' to be initialized`),o.detachShader(this._object,u.object),u.unref()}}link(){(0,i.assert)(this._object!==void 0,"expected WebGLProgram object");const s=this._context.gl;if(s.linkProgram(this._object),s.getProgramParameter(this._object,s.LINK_STATUS))this._linked=!0;else{const o=s.getProgramInfoLog(this._object);(0,i.log)(i.LogLevel.Error,`linking of program '${this._identifier}' failed: '${o}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(d.DEFAULT_PROGRAM)}uniform(s){return this._context.gl.getUniformLocation(this._object,s)}attribute(s,o){return o!==void 0?((0,i.logIf)(this._linked,i.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${s} -> ${o} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,o,s),o):this._context.gl.getAttribLocation(this._object,s)}get shaders(){return this._shaders}get linked(){return this._linked}}r.Program=d,d.DEFAULT_PROGRAM=void 0,n([h.Initializable.assert_initialized()],d.prototype,"bind",null),n([h.Initializable.assert_initialized()],d.prototype,"unbind",null),n([h.Initializable.assert_initialized()],d.prototype,"uniform",null),n([h.Initializable.assert_initialized()],d.prototype,"attribute",null)},1407:(l,r,a)=>{const n=a(3780),i=a(9504);function h(f,s){const o=s.properties,u=Object.getOwnPropertyNames(o);for(const b of u){const v=o[b],_=v.type==="object",g=f.hasOwnProperty(b),x=v.hasOwnProperty("properties"),T=v.hasOwnProperty("default");(0,i.assert)(x&&_||!x&&!_,`expected property '${b}' to be of type 'object', given '${v.type}'`),g&&x?d.complement(f[b],v):!g&&T&&Object.defineProperty(f,b,{value:v.default,writable:!0})}}function p(f,s){const o=s.items;if(o.type==="object")for(const u of Object.getOwnPropertyNames(f))u!=="length"&&d.complement(f[u],o)}var d;(function(f){f.validate=function(s,o,u){const b=new n.Validator;if(u!==void 0)for(const _ of u)b.addSchema(_[0],_[1]);const v=b.validate(s,o);return(0,i.logIf)(!v.valid,i.LogLevel.Warning,`schema expected to be valid:
${v.toString()}`),v.valid},f.complement=function(s,o){if(s!==void 0)switch((0,i.assert)(o.hasOwnProperty("properties")&&o.type==="object"||o.hasOwnProperty("items")&&o.type==="array",`expected schema to have 'properties' or 'items', given ${o}`),o.type){case"object":h(s,o);break;case"array":p(s,o)}},f.compare=function s(o,u,b,v=""){const _=b!==void 0;if((0,i.assert)(!_||b.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),o===void 0&&u!==void 0||o!==void 0&&u===void 0)return _&&b.alter(v),!0;let g=!0,x=[typeof o,typeof u];const T=[o instanceof Array,u instanceof Array];if(!(T[0]&&T[1]||x[0]==="object"&&x[1]==="object"))return g=o===u,!g&&_&&b.alter(`${v}`),!g;const O=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(o),Object.getOwnPropertyNames(u))).values());for(const A of O){if(A==="length")continue;const R=[o[A],u[A]];x=[typeof R[0],typeof R[1]];const P=`${v}${v.length>0&&!T[0]?".":""}${T[0]?"":A}`;if(R[0]instanceof Array&&R[1]instanceof Array||x[0]==="object"&&x[1]==="object")g=g&&!s(R[0],R[1],b,P);else{if(x[0]===x[1]&&R[0]===R[1])continue;g=!1,_&&b.alter(P)}}return!g}})(d||(d={})),l.exports=d},3039:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.RandomSquareKernel=void 0;const n=a(9504),i=a(4287);class h extends i.KernelF32{constructor(d){super(2,d),this.generate()}generate(){(0,n.assert)(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let d=1;d<this.width;++d)this.set([(0,n.rand)(-.5,.5),(0,n.rand)(-.5,.5)],d)}get width(){return this._width}set width(d){this._width!==d&&(this._width=d,this.resize(),this.generate())}}r.RandomSquareKernel=h},8962:(l,r,a)=>{const n=a(3557),i=a(5150),h=a(9504);var p;(function(d){function f(b,v,_=1){const g=n.vec2.subtract((0,i.v2)(),v,b);if(n.vec2.equals(g,n.vec2.fromValues(0,0)))return;const x=n.vec2.squaredLength(g),T=2*n.vec2.dot(g,b),O=T*T-4*x*(n.vec2.squaredLength(b)-_*_);if(O<0)return;const A=Math.sqrt(O),R=Math.min((-T+A)/(2*x),(-T-A)/(2*x)),P=n.vec2.scale((0,i.v2)(),g,R);return n.vec2.add(P,P,b)}function s(b,v,_,g){const x=b,T=n.vec2.sub((0,i.v2)(),v,b),O=_,A=n.vec2.sub((0,i.v2)(),g,_),R=n.vec2.cross((0,i.v3)(),T,A)[2];if(R===0)return;const P=n.vec2.sub((0,i.v2)(),O,x),C=n.vec2.cross((0,i.v3)(),P,n.vec2.scale((0,i.v2)(),T,1/R))[2],U=n.vec2.cross((0,i.v3)(),P,n.vec2.scale((0,i.v2)(),A,1/R))[2];return C<0||C>1||U<0?void 0:[n.vec2.add((0,i.v2)(),O,n.vec2.scale((0,i.v2)(),A,C)),U]}function o(b,v,_=n.vec3.fromValues(0,0,0),g=n.vec3.fromValues(0,1,0)){const x=n.vec3.normalize((0,i.v3)(),n.vec3.subtract((0,i.v3)(),v,b)),T=n.vec3.dot(x,g);if(n.vec3.equals(x,[0,0,0])||T>=0)return;const O=n.vec3.dot(n.vec3.subtract((0,i.v3)(),_,b),g)/T;return n.vec3.add((0,i.v3)(),n.vec3.scale((0,i.v3)(),x,O),b)}function u(b,v,_){const g=n.vec3.subtract((0,i.v3)(),v,b),x=n.vec3.squaredLength(g);if(x===0)return 0;const T=n.vec3.subtract((0,i.v3)(),_,b);return n.vec3.dot(T,g)/x}d.rayCircleIntersection=f,d.pointSquareIntersection=function(b,v=1){const _=(0,i.abs2)((0,i.v2)(),b);return _[0]>=_[1]?n.vec2.fromValues((0,i.sign)(b[0])*v,b[1]/_[0]*v):n.vec2.fromValues(b[0]/_[1]*v,(0,i.sign)(b[1])*v)},d.raySquareIntersection=function(b,v,_=1){const g=[n.vec2.fromValues(-_,+_),n.vec2.fromValues(-_,-_),n.vec2.fromValues(+_,-_),n.vec2.fromValues(+_,+_)],x=new Array;for(let T=0;T<4;++T){const O=s(b,v,g[T],g[(T+1)%4]);O&&x.push(O[1])}return x},d.rayLineIntersection=s,d.rayPlaneIntersection=o,d.raySphereIntersection=function(b,v,_=n.vec3.fromValues(0,0,0),g=1){const x=n.vec3.subtract((0,i.v3)(),b,_),T=n.vec3.normalize((0,i.v3)(),n.vec3.subtract((0,i.v3)(),v,b)),O=n.vec3.dot(T,x),A=O*O-n.vec3.squaredLength(x)+g*g;if(!(A<=0))return n.vec3.add((0,i.v3)(),b,n.vec3.scale((0,i.v3)(),T,-O-Math.sqrt(A)))},d.rayPlaneIntersection_tube=function(b,v,_=1){const g=o(b,v);if(g!==void 0&&n.vec3.length(g)<_)return g;const x=f(n.vec2.fromValues(b[0],b[2]),n.vec2.fromValues(v[0],v[2]),_);return x?n.vec3.fromValues(x[0],0,x[1]):void 0},d.isPointWithinSquare=function(b,v=1){const _=(0,i.abs2)((0,i.v2)(),b);return _[0]<=v&&_[1]<=v},d.isPointWithinNDC=function(b,v){const _=n.vec3.transformMat4((0,i.v3)(),v,b),g=(0,i.abs3)((0,i.v3)(),_);return g[0]<=1&&g[1]<=1&&_[2]>=0&&_[2]<=1},d.distancePointToRay=u,d.eyeWithPointInView=function(b,v){const _=n.vec3.subtract((0,i.v3)(),b.center,b.eye),g=n.vec3.normalize((0,i.v3)(),_),x=n.vec3.normalize((0,i.v3)(),n.vec3.cross((0,i.v3)(),g,b.up)),T=n.vec3.normalize((0,i.v3)(),n.vec3.cross((0,i.v3)(),x,g)),O=u(b.eye,b.center,v),A=n.vec3.add((0,i.v3)(),b.eye,n.vec3.scale((0,i.v3)(),_,O)),R=n.vec3.subtract((0,i.v3)(),v,A),P=Math.abs(n.vec3.dot(R,x))/b.aspect,C=Math.abs(n.vec3.dot(R,T)),U=Math.max(P,C)/Math.tan(b.fovy*h.DEG2RAD*.5);return n.vec3.subtract((0,i.v3)(),A,n.vec3.scale((0,i.v3)(),g,U))}})(p||(p={})),l.exports=p},1900:function(l,r,a){var n=this&&this.__decorate||function(_,g,x,T){var O,A=arguments.length,R=A<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,x):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,T);else for(var P=_.length-1;P>=0;P--)(O=_[P])&&(R=(A<3?O(R):A>3?O(g,x,R):O(g,x))||R);return A>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(r,"__esModule",{value:!0}),r.ReadbackPass=void 0;const i=a(3557),h=a(9504),p=a(5150),d=a(8215),f=a(4127),s=a(1896),o=a(4168),u=a(771),b=a(8593);class v extends f.Initializable{static maxClearDepth(){return(0,p.decode_float24x1_from_uint8x3)(i.vec3.fromValues(255,255,255))}constructor(g){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=g}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(g,x){return 65535*x+g}directReadDepthAt(g,x){(0,h.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const T=this._depthFBO.texture(this._depthAttachment),O=this._context.gl,A=T.size;this._depthFBO.bind();const R=this._referenceSize===void 0?[1,1]:[A[0]/this._referenceSize[0],A[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&O.readBuffer(this._depthAttachment),O.readPixels(g*R[0],A[1]-x*R[1],1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(g,x){(0,h.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const T=this._depthFBO.texture(this._depthAttachment),O=this._context.gl,A=T.size,R=this._referenceSize===void 0?[1,1]:[A[0]/this._referenceSize[0],A[1]/this._referenceSize[1]];return O.viewport(0,0,1,1),this._program.bind(),O.uniform2f(this._uOffset,g*R[0]/A[0],(A[1]-x*R[1])/A[1]),O.uniform2f(this._uScale,1/A[0],1/A[1]),T.bind(O.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),T.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&O.readBuffer&&O.readBuffer(O.COLOR_ATTACHMENT0),O.readPixels(0,0,1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(g,x){const T=this._context.gl,O=this._context.gl2facade;if(x)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const A=new u.Shader(this._context,T.VERTEX_SHADER,"ndcvertices.vert (readback)");A.initialize(a(9657));const R=new u.Shader(this._context,T.FRAGMENT_SHADER,"readbackdepth.frag");return R.initialize(a(688)),this._program=new o.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([A,R],!1),g===void 0?this._ndcTriangle=new s.NdcFillingTriangle(this._context):(this._ndcTriangle=g,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),T.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new b.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,T.RGBA,T.RGBA,T.UNSIGNED_BYTE),this._framebuffer=new d.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[O.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(g,x){const T=this.hash(g,x);if(this._cache&&this._cachedDepths.has(T))return this._cachedDepths.get(T);const O=this.readDepthAt(g,x),A=O[0]===255&&O[1]===255&&O[2]===255?void 0:(0,p.decode_float24x1_from_uint8x3)(i.vec3.fromValues(O[0],O[1],O[2]));return this._cache&&this._cachedDepths.set(T,A),A}coordsAt(g,x,T,O){const A=this._depthFBO.texture(this._depthAttachment).size,R=T===void 0?this.depthAt(g,x):T;if(R===void 0)return;const P=this._referenceSize===void 0?[1,1]:[A[0]/this._referenceSize[0],A[1]/this._referenceSize[1]],C=i.vec3.fromValues(g*P[0]*2/A[0]-1,1-x*P[1]*2/A[1],2*R-1);return i.vec3.transformMat4(i.vec3.create(),C,O)}idAt(g,x){const T=this.hash(g,x);if(this._cache&&this._cachedIDs.has(T))return this._cachedIDs.get(T);const O=this._context.gl,A=this._idFBO.texture(this._idAttachment).size,R=this._referenceSize===void 0?[1,1]:[A[0]/this._referenceSize[0],A[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&O.readBuffer(this._idAttachment),O.readPixels(g*R[0],A[1]-x*R[1],1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer);const P=(0,p.decode_uint32_from_rgba8)(i.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(T,P),P}frame(){this.onFrame()}set cache(g){this._cache=g}set depthFBO(g){this._depthFBO=g}set depthAttachment(g){this._depthAttachment=g}set idFBO(g){this._idFBO=g}set idAttachment(g){this._idAttachment=g}set coordinateReferenceSize(g){this._referenceSize=g}}r.ReadbackPass=v,n([f.Initializable.assert_initialized()],v.prototype,"directReadDepthAt",null),n([f.Initializable.assert_initialized()],v.prototype,"renderThenReadDepthAt",null),n([f.Initializable.initialize()],v.prototype,"initialize",null),n([f.Initializable.uninitialize()],v.prototype,"uninitialize",null),n([f.Initializable.assert_initialized()],v.prototype,"depthAt",null),n([f.Initializable.assert_initialized()],v.prototype,"coordsAt",null),n([f.Initializable.assert_initialized()],v.prototype,"idAt",null)},8400:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.Renderbuffer=void 0;const i=a(9504),h=a(3513),p=a(4127),d=a(9965);class f extends d.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(o,u,b,v=1){(0,i.assert)(o>0&&u>0,"renderbuffer object requires valid width and height greater than zero");const _=this.context.gl;this._object=_.createRenderbuffer(),this._width=o,this._height=u,this._internalFormat=b,this._samples=v,_.bindRenderbuffer(_.RENDERBUFFER,this._object),this._samples>1?_.renderbufferStorageMultisample(_.RENDERBUFFER,this._samples,b,o,u):_.renderbufferStorage(_.RENDERBUFFER,b,o,u),this._valid=_.isRenderbuffer(this._object),_.bindRenderbuffer(_.RENDERBUFFER,f.DEFAULT_RENDER_BUFFER);const g=o*u*(0,h.byteSizeOfFormat)(this.context,b);return this.context.allocationRegister.reallocate(this._identifier,g),this._object}delete(){(0,i.assert)(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,f.DEFAULT_RENDER_BUFFER)}resize(o,u,b=!1,v=!1){if(o===this._width&&u===this._height)return;this._width=o,this._height=u;const _=this.context.gl;b&&this.bind(),this._samples>1?_.renderbufferStorageMultisample(_.RENDERBUFFER,this._samples,this._internalFormat,o,u):_.renderbufferStorage(_.RENDERBUFFER,this._internalFormat,o,u),v&&this.unbind();const g=o*u*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,g)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}r.Renderbuffer=f,f.DEFAULT_RENDER_BUFFER=void 0,n([p.Initializable.assert_initialized()],f.prototype,"bind",null),n([p.Initializable.assert_initialized()],f.prototype,"unbind",null),n([p.Initializable.assert_initialized()],f.prototype,"resize",null)},3105:function(l,r,a){var n=this&&this.__decorate||function(_,g,x,T){var O,A=arguments.length,R=A<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,x):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(_,g,x,T);else for(var P=_.length-1;P>=0;P--)(O=_[P])&&(R=(A<3?O(R):A>3?O(g,x,R):O(g,x))||R);return A>3&&R&&Object.defineProperty(g,x,R),R};Object.defineProperty(r,"__esModule",{value:!0}),r.Renderer=r.LoadingStatus=void 0;const i=a(7032),h=a(3557),p=a(9504),d=a(5150),f=a(7564),s=a(4127),o=a(2813),u=a(9217);var b;(function(_){_[_.Started=0]="Started",_[_.Finished=1]="Finished"})(b||(r.LoadingStatus=b={}));class v extends s.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new f.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=u.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new i.ReplaySubject(1)}invalidate(g=!1){this._invalidate(g)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(b.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(b.Finished)}initialize(g,x,T){return(0,p.assert)(g!==void 0,"valid webgl context required"),this._context=g,(0,p.assert)(x!==void 0,"valid multi-frame update callback required"),this._invalidate=x,this._isLoading=!0,this._loadingStatusSubscription=new i.ReplaySubject,this.onInitialize(g,x,T)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(g){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==g&&(this._multiFrameNumber=g,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(g){this.onFrame(g)}swap(){this.onSwap()}frameCoords(g,x){const T=h.vec2.divide((0,d.v2)(),this._frameSize,this.canvasSize);return h.vec2.floor(T,h.vec2.multiply(T,[g+.5,x+.5],T)),h.vec2.add(T,T,[.5,.5]),(0,o.tuple2)(T)}set frameSize(g){this.assertInitialized(),h.vec2.equals(this._frameSize,g)||(Object.assign(this._frameSize,g),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(g){this.assertInitialized(),this._framePrecision!==g&&(this._framePrecision=g,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(g){this.assertInitialized(),h.vec4.equals(this._clearColor,g)||(Object.assign(this._clearColor,g),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(g){this.assertInitialized(),this._debugTexture!==g&&((0,p.logIf)(g>=this._debugTextures.length,p.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${g} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=g<this._debugTextures.length?(0,d.clamp)(g,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}r.Renderer=v,n([s.Initializable.assert_initialized()],v.prototype,"invalidate",null),n([s.Initializable.initialize()],v.prototype,"initialize",null),n([s.Initializable.uninitialize()],v.prototype,"uninitialize",null),n([s.Initializable.discard()],v.prototype,"discard",null),n([s.Initializable.assert_initialized()],v.prototype,"update",null),n([s.Initializable.assert_initialized()],v.prototype,"prepare",null),n([s.Initializable.assert_initialized()],v.prototype,"frame",null),n([s.Initializable.assert_initialized()],v.prototype,"swap",null)},9137:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Resizable=void 0;const n=a(9504);class i{static resize(){(0,n.assert)(i.instances.length>0,"resize event received without a single resizable registered"),i.instances.forEach(p=>p.onResize())}static elementSize(p){if(p===void 0||window===void 0||typeof window.devicePixelRatio!="number")return[0,0];const d=window.devicePixelRatio,f=getComputedStyle(p);if(f.width===null||!f.width.endsWith("px")||f.height===null||!f.height.endsWith("px"))return void(0,n.log)(n.LogLevel.Debug,`computed element size expected in 'px', given ${f.width} ${f.height}`);const s=[parseFloat(f.width),parseFloat(f.height)];return[Math.round(s[0]*d),Math.round(s[1]*d)]}constructor(){if(this._resizeEventListener=()=>i.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),i.resize()},i.instances.length===0){const p=`on${i.EVENT_IDENTIFIER}`;i.eventSupported=document&&(p in document.documentElement||p in document.body),(0,n.logIf)(!i.eventSupported,n.LogLevel.Warning,"resize event not supported")}i.instances.length===0&&i.eventSupported&&window.addEventListener(i.EVENT_IDENTIFIER,this._resizeEventListener),i.instances.push(this)}observe(p){p!==void 0&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(p,i.MUTATION_OBSERVER_CONFIG)}dispose(){const p=i.instances.indexOf(this);(0,n.assert)(p!==-1,"invalid reference counting of resizable instances"),i.instances.splice(p,1),i.instances.length===0&&i.eventSupported&&window.removeEventListener(i.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}r.Resizable=i,i.EVENT_IDENTIFIER="resize",i.instances=[],i.eventSupported=!1,i.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},6197:function(l,r,a){var n=this&&this.__decorate||function(o,u,b,v){var _,g=arguments.length,x=g<3?u:v===null?v=Object.getOwnPropertyDescriptor(u,b):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,u,b,v);else for(var T=o.length-1;T>=0;T--)(_=o[T])&&(x=(g<3?_(x):g>3?_(u,b,x):_(u,b))||x);return g>3&&x&&Object.defineProperty(u,b,x),x};Object.defineProperty(r,"__esModule",{value:!0}),r.ForwardSceneRenderPass=void 0;const i=a(3557),h=a(9504),p=a(7564),d=a(4127),f=a(5138);class s extends f.SceneRenderPass{constructor(u){super(),this._altered=Object.assign(new p.ChangeLookup,{any:!1,camera:!1}),this._context=u,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){(0,h.assert)(this._scene!==void 0,"Scene was undefined during preprocessing."),this._scene!==void 0&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,i.mat4.create()))}preprocessNode(u,b){const v=i.mat4.clone(b),_=u.componentsOfType("TransformComponent");if((0,h.assert)(_.length<=1,"SceneNode can not have more than one transform component"),_.length===1){const x=_[0];i.mat4.mul(v,v,x.transform)}const g=u.componentsOfType("GeometryComponent");for(const x of g){const T=x,O=T.material,A=T.geometry;if(O.isTransparent){let R=this._transparentGeometryMap.get(O);R===void 0&&(R=[]),R.push([A,v]),this._transparentGeometryMap.set(O,R)}else{let R=this._opaqueGeometryMap.get(O);R===void 0&&(R=[]),R.push([A,v]),this._opaqueGeometryMap.set(O,R)}}if(u.nodes!==void 0)for(const x of u.nodes)this.preprocessNode(x,v)}renderGeometryMap(u){for(const b of Array.from(u.keys())){this.bindMaterial(b);const v=u.get(b);for(const[_,g]of v)_.bind(),this.bindGeometry!==void 0&&this.bindGeometry(_),this.updateModelTransform(g),_.draw(),_.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(u=!1){}frame(){if((0,h.assert)(this._target&&this._target.valid,"valid target expected"),(0,h.assert)(this._program&&this._program.valid,"valid program expected"),(0,h.assert)(this.updateModelTransform!==void 0,"Model transform function needs to be initialized."),(0,h.assert)(this.updateViewProjectionTransform!==void 0,"View Projection transform function needs to be initialized."),(0,h.assert)(this.bindMaterial!==void 0,"Material binding function needs to be initialized."),this._scene===void 0)return;const u=this._context.gl;u.enable(u.DEPTH_TEST);const b=this._target.size;u.viewport(0,0,b[0],b[1]),this._program.bind(),this.bindUniforms!==void 0&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),u.disable(u.BLEND)}drawCalls(u=!0){this._scene!==void 0&&(this.renderGeometryMap(this._opaqueGeometryMap),u&&this.renderGeometryMap(this._transparentGeometryMap))}set target(u){this.assertInitialized(),this._target=u}set ndcOffset(u){this.assertInitialized(),this._ndcOffset=u}set camera(u){this.assertInitialized(),this._camera!==u&&(this._camera=u,this._altered.alter("camera"))}set clearColor(u){this._clearColor=u}set program(u){this._program=u}}r.ForwardSceneRenderPass=s,n([d.Initializable.initialize()],s.prototype,"initialize",null),n([d.Initializable.uninitialize()],s.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],s.prototype,"update",null),n([d.Initializable.assert_initialized()],s.prototype,"frame",null),n([d.Initializable.assert_initialized()],s.prototype,"drawCalls",null)},2384:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GeometryComponent=void 0;const n=a(6344);class i extends n.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(p){this._geometry=p}get geometry(){return this._geometry}set material(p){this._material=p}get material(){return this._material}}r.GeometryComponent=i},5315:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SceneRenderPass=r.Material=r.GeometryComponent=r.TransformComponent=r.SceneNodeComponent=r.SceneNode=r.ForwardSceneRenderPass=void 0;var n=a(6197);Object.defineProperty(r,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return n.ForwardSceneRenderPass}});var i=a(651);Object.defineProperty(r,"SceneNode",{enumerable:!0,get:function(){return i.SceneNode}});var h=a(6344);Object.defineProperty(r,"SceneNodeComponent",{enumerable:!0,get:function(){return h.SceneNodeComponent}});var p=a(6244);Object.defineProperty(r,"TransformComponent",{enumerable:!0,get:function(){return p.TransformComponent}});var d=a(2384);Object.defineProperty(r,"GeometryComponent",{enumerable:!0,get:function(){return d.GeometryComponent}});var f=a(7874);Object.defineProperty(r,"Material",{enumerable:!0,get:function(){return f.Material}});var s=a(5138);Object.defineProperty(r,"SceneRenderPass",{enumerable:!0,get:function(){return s.SceneRenderPass}})},7874:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Material=void 0,r.Material=class{constructor(a,n){this._context=a,this._name=n,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(a){this._isTransparent=a}}},651:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SceneNode=void 0,r.SceneNode=class{constructor(a){this._nodes=new Array,this._components=new Array,this._name=a,this._parent=void 0}traverse(a){a(this);for(const n of this._nodes)n.traverse(a)}addNode(a){return a._parent=this,this._nodes.push(a),a}addComponent(a){return this._components.push(a),a}componentsOfType(a){return this._components.filter(n=>a===n.type)}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return this._nodes.length===0}get isRoot(){return this._parent===void 0}}},6344:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SceneNodeComponent=void 0,r.SceneNodeComponent=class{constructor(a){this._type=a}get type(){return this._type}}},5138:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SceneRenderPass=void 0;const n=a(4127);class i extends n.Initializable{set scene(p){this._scene=p,this._scene!==void 0&&this.preprocessScene()}get scene(){return this._scene}}r.SceneRenderPass=i},6244:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TransformComponent=void 0;const n=a(6344);class i extends n.SceneNodeComponent{constructor(p){super("TransformComponent"),this._transform=p}get transform(){return this._transform}}r.TransformComponent=i},771:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Shader=void 0;const n=a(9504),i=a(9965);class h extends i.AbstractObject{constructor(d,f,s){super(d,s),this._compiled=!1;const o=d.gl;if(s===void 0)switch(f){case d.gl.FRAGMENT_SHADER:s="FragmentShader";break;case d.gl.VERTEX_SHADER:s="VertexShader";break;default:(0,n.assert)(!1,`expected either a FRAGMENT_SHADER (${o.FRAGMENT_SHADER}) or a VERTEX_SHADER (${o.VERTEX_SHADER}), given ${f}`)}this._type=f}create(d,f=!0){const s=this._context.gl;return this._object=s.createShader(this._type),this._valid=s.isShader(this._object),this._compiled=!1,(0,n.assert)(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),d&&(this.source=d),d&&f&&this.compile(),this._object}delete(){(0,n.assert)(this._object!==void 0,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const d=this._context.gl;let f=this.sourceWithReplacements;if(this._context.isWebGL2&&(f=`#version 300 es
${f}`),d.shaderSource(this._object,f),d.compileShader(this._object),this._compiled=d.getShaderParameter(this._object,d.COMPILE_STATUS),!this._compiled){const s=d.getShaderInfoLog(this._object);(0,n.log)(n.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${s}`)}}replace(d,f){this._replacements===void 0&&(this._replacements=new Map),this._replacements.set(d,f)}get type(){return this.assertInitialized(),this._type}set source(d){this._source!==d&&(this._source=d)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(this._replacements===void 0)return this._source;let d=this._source;return this._replacements.forEach((f,s)=>{const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");d=d.replace(new RegExp(o,"g"),f)}),d}get compiled(){return this.assertInitialized(),this._compiled}}r.Shader=h},9011:function(l,r,a){var n=this&&this.__decorate||function(b,v,_,g){var x,T=arguments.length,O=T<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(b,v,_,g);else for(var A=b.length-1;A>=0;A--)(x=b[A])&&(O=(T<3?x(O):T>3?x(v,_,O):x(v,_))||O);return T>3&&O&&Object.defineProperty(v,_,O),O};Object.defineProperty(r,"__esModule",{value:!0}),r.ShadowPass=void 0;const i=a(9504),h=a(8215),p=a(3395),d=a(4127),f=a(8400),s=a(8593),o=a(9217);class u extends d.Initializable{constructor(v){super(),this._gaussFilterKernelSize=21,this._context=v}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==u.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(v){v!==this._gaussFilterKernelSize&&(this._gaussFilter!==void 0&&(this._gaussFilter.kernelSize=v,this._gaussFilter.standardDeviation=v/6),this._gaussFilterKernelSize=v)}resize(v,_=!0,g=!0){(0,i.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._shadowMapSize=v,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],_,g)}resizeBlurTexture(v,_=!0,g=!0){(0,i.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=v,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,g),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,g)}initialize(v,_,g){(0,i.assert)(_[0]>0&&_[1]>0,"Size has to be > 0."),this._shadowType=v,this._shadowMapSize=_,this._blurredShadowMapSize=g!==void 0?g:this._shadowMapSize;const x=this._context.gl,T=this._context.gl2facade;let O=x.RGBA;if(this._context.isWebGL2){const C=this._context.gl;switch(this._shadowType){case u.ShadowMappingType.HardLinear:case u.ShadowMappingType.HardExponential:O=C.RED;break;case u.ShadowMappingType.SoftLinear:O=C.RG;break;case u.ShadowMappingType.SoftExponential:O=C.RGBA;break;default:(0,i.assert)(!1,"Unexpected value for shadowType")}}const[A,R]=o.Wizard.queryInternalTextureFormat(this._context,O,o.Wizard.Precision.float);this._shadowType!==u.ShadowMappingType.HardLinear&&R!==x.FLOAT&&((0,i.log)(i.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=u.ShadowMappingType.HardLinear);let P=x.LINEAR;return R!==x.FLOAT||this._context.supportsTextureFloatLinear||(P=x.NEAREST),R!==T.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(P=x.NEAREST),this._shadowMapTexture=new s.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],A,O,x.FLOAT),this._shadowMapTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._shadowMapTexture.filter(P,P),this._shadowMapRenderbuffer=new f.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],x.DEPTH_COMPONENT16),this._shadowMapFBO=new h.Framebuffer(this._context),this._shadowMapFBO.initialize([[T.COLOR_ATTACHMENT0,this._shadowMapTexture],[x.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new p.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new s.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],A,O,x.FLOAT),this._intermediateBlurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(P,P),this._intermediateBlurFBO=new h.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[T.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new s.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],A,O,x.FLOAT),this._blurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._blurTexture.filter(P,P),this._blurFBO=new h.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[T.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(v){const _=this._context.gl;_.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL),this._shadowMapFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),v(),_.disable(_.DEPTH_TEST),_.depthFunc(_.LESS),this.hasBlur&&(_.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,p.GaussFilter.Direction.Horizontal),_.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,p.GaussFilter.Direction.Vertical))}}r.ShadowPass=u,n([d.Initializable.assert_initialized()],u.prototype,"resize",null),n([d.Initializable.assert_initialized()],u.prototype,"resizeBlurTexture",null),n([d.Initializable.initialize()],u.prototype,"initialize",null),n([d.Initializable.uninitialize()],u.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],u.prototype,"frame",null),function(b){(function(v){v[v.HardLinear=0]="HardLinear",v[v.SoftLinear=1]="SoftLinear",v[v.HardExponential=2]="HardExponential",v[v.SoftExponential=3]="SoftExponential"})(b.ShadowMappingType||(b.ShadowMappingType={}))}(u||(r.ShadowPass=u={}))},8296:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontFace=void 0;const n=a(9504),i=a(8593),h=a(9217),p=a(64),d=a(1575),f=a(2668);class s{static fromFile(u,b,v=!1,_){return(0,p.fetchAsync)(u,"text").then(g=>{const x=new s(b,_);return d.FontFaceLoader.process(x,g,u,void 0,v).then(T=>T).catch(T=>Promise.reject(`processing font face data failed: ${T}`))})}static fromFiles(u,b,v,_=!1,g){return(0,p.fetchAsync)(u,"text").then(x=>{const T=new s(v,g);return d.FontFaceLoader.process(T,x,u,b,_).then(O=>O).catch(O=>Promise.reject(`processing font face data failed: ${O}`))})}constructor(u,b){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=u;const v=u.gl;b=b!==void 0&&b!==""?b:this.constructor.name,this._glyphTexture=new i.Texture2D(u,`${b}GlyphAtlas`);const _=h.Wizard.queryInternalTextureFormat(u,v.RGBA,h.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,_[0],v.RGBA,_[1]),this._glyphTexture.filter(v.LINEAR,v.LINEAR)}hasGlyph(u){return!!this._glyphs.get(u)}glyph(u){const b=this._glyphs.get(u);if(b)return b;const v=new f.Glyph;return v.index=u,v}addGlyph(u){(0,n.assert)(!this._glyphs.get(u.index),"expected glyph to not already exist"),this._glyphs.set(u.index,u)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(u){return this.glyph(u).depictable()}kerning(u,b){const v=this._glyphs.get(u);return v?v.kerning(b):0}setKerning(u,b,v){const _=this._glyphs.get(u);_&&this.hasGlyph(b)?_.setKerning(b,v):(0,n.assert)(!1,`expected glyph or glyph of subsequent index to exist,                 given ${u} and ${b} respectively`)}set size(u){(0,n.assert)(u>0,`expected size to be greater than 0.0, given ${u}`),this._size=u}get size(){return this._size}set base(u){(0,n.assert)(u>0,`expected base to be greater than 0.0, given ${u}`),this._base=u}get base(){return this._base}set ascent(u){(0,n.assert)(u>0,`expected ascent to be greater than 0.0, given ${u}`),this._ascent=u}get ascent(){return this._ascent}set descent(u){this._descent=u}get descent(){return this._descent}set lineGap(u){this._lineGap=u}get lineGap(){return this._lineGap}set lineHeight(u){(0,n.assert)(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=u-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(u){this._lineGap=this.size*(u-1)}get lineSpace(){return this.lineHeight===0?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(u){(0,n.assert)(u[0]>0,`expected extent.x to be greater than 0.0, given ${u[0]}`),(0,n.assert)(u[1]>0,`expected extent.y to be greater than 0.0, given ${u[1]}`),this._glyphTextureExtent=u}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(u){(0,n.assert)(u[0]>=0,`expected padding[0] to be greater than 0.0, given ${u[0]}`),(0,n.assert)(u[1]>=0,`expected padding[1] to be greater than 0.0, given ${u[1]}`),(0,n.assert)(u[2]>=0,`expected padding[2] to be greater than 0.0, given ${u[2]}`),(0,n.assert)(u[3]>=0,`expected padding[3] to be greater than 0.0, given ${u[3]}`),this._glyphTexturePadding=u}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(u){this._glyphTexture=u}get glyphTexture(){return this._glyphTexture}}r.FontFace=s},1575:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontFaceLoader=void 0;const n=a(9504),i=a(2668);class h{static processInfo(d,f){const s=new Map;if(!this.readKeyValuePairs(d,["size","padding"],s))return!1;f.size=parseFloat(s.get("size"));const o=s.get("padding").split(",");if(o.length!==4)return(0,n.log)(n.LogLevel.Warning,`expected 4 values for padding, given ${o} (${o.length})`),!1;const u=[parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])];return f.glyphTexturePadding=u,!0}static processCommon(d,f){const s=new Map;return!!this.readKeyValuePairs(d,["lineHeight","base","scaleW","scaleH"],s)&&(f.base=parseFloat(s.get("base")),s.has("ascent")&&(f.ascent=parseFloat(s.get("ascent"))),s.has("descent")&&(f.descent=parseFloat(s.get("descent"))),f.lineHeight=parseFloat(s.get("lineHeight")),f.glyphTextureExtent=[parseFloat(s.get("scaleW")),parseFloat(s.get("scaleH"))],!0)}static processPage(d,f,s){const o=new Map;if(!this.readKeyValuePairs(d,["file"],o))return;const u=(0,n.dirname)(s);let b=o.get("file");return b=b.replace(/['"]+/g,""),f.glyphTexture.fetch(`${u}/${b}`,!0,!0).catch(()=>Promise.reject(`page '${b}' referenced in font file '${s}' was not found`))}static processPages(d,f){(0,n.logIf)(f.size!==1,n.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),(0,n.assert)(f.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const s=f.get(0);if(s)return d.glyphTexture.fetch(`${s}`,!0,!0).catch(()=>Promise.reject(`fetching page '0' from '${s}' failed`))}static processChar(d,f){const s=new Map;if(!this.readKeyValuePairs(d,["id","x","y","width","height","xoffset","yoffset","xadvance"],s))return!1;const o=parseInt(s.get("id"),10);(0,n.logIf)(o<=0,n.LogLevel.Warning,`expected glyph index to be greater than 0, given ${o}`);const u=new i.Glyph;u.index=o;const b=[1/f.glyphTextureExtent[0],1/f.glyphTextureExtent[1]],v=[parseFloat(s.get("width")),parseFloat(s.get("height"))];return u.subTextureOrigin=[parseFloat(s.get("x"))*b[0],1-(parseFloat(s.get("y"))+v[1])*b[1]],u.extent=v,u.subTextureExtent[0]=v[0]*b[0],u.subTextureExtent[1]=v[1]*b[1],u.bearingFromFontBaseAndOffset(f.base,parseFloat(s.get("xoffset")),parseFloat(s.get("yoffset"))),u.advance=parseFloat(s.get("xadvance")),f.addGlyph(u),!0}static processKerning(d,f){const s=new Map;if(!this.readKeyValuePairs(d,["first","second","amount"],s))return!1;const o=parseInt(s.get("first"),10);if(o<=0)return(0,n.log)(n.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${o}`),!1;const u=parseInt(s.get("second"),10);if(u<=0)return(0,n.log)(n.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${u}`),!1;const b=parseFloat(s.get("amount"));return f.setKerning(o,u,b),!0}static readKeyValuePairs(d,f,s){let o,u;for(const v of d){const _=v.split("=");o=_[0],u=_[1],s.set(o,u)}let b=!0;return f.forEach(v=>b=b&&s.has(v)),b||(0,n.log)(n.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${f}`),b}static findAscentAndDescentIfNoneProvided(d,f){if(d.ascent>0&&d.descent<0)return;d.ascent>0&&(d.descent=d.ascent-f),d.descent<0&&(d.ascent=d.descent-f);let s=Number.MIN_VALUE;for(const o of d.arrayOfGlyphIndices())d.glyph(o).extent[1]!==0&&(s=Math.max(d.glyph(o).bearing[1],s));d.ascent=s,d.descent=d.ascent-f,(0,n.log)(n.LogLevel.Debug,`ascent not specified, derived ${d.ascent} from maximum y-offset`)}static process(d,f,s,o,u=!1){const b=f.split(`
`),v=new Array;let _=!0;if(!u&&o){const g=this.processPages(d,o);g!==void 0&&v.push(g)}for(const g of b){let x=g.split(" ");const T=x[0];switch(x=x.slice(1),T){case"info":_=this.processInfo(x,d);break;case"common":_=this.processCommon(x,d);break;case"page":if(u||o)break;const O=this.processPage(x,d,s);O!==void 0&&v.push(O);break;case"char":_=this.processChar(x,d);break;case"kerning":this.processKerning(x,d)}if(_===!1)break}return h.findAscentAndDescentIfNoneProvided(d,d.size),d.size<=0&&(0,n.log)(n.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${d.size}`),Promise.all(v).then(()=>d)}}r.FontFaceLoader=h},2668:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Glyph=void 0;const n=a(2813);r.Glyph=class{constructor(i=0,h=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=i,this._advance=h}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(i){const h=this._kernings.get(i);return h!==void 0?h:0}setKerning(i,h){this._kernings.set(i,h)}set index(i){this._index=i}get index(){return this._index}set subTextureOrigin(i){this._subTextureOrigin=(0,n.clampf2)(i,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(i){this._subTextureExtent=(0,n.clampf2)(i,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(i){this._bearing=i}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(i,h,p){this._bearing[0]=h,this._bearing[1]=i-p}set extent(i){this._extent=i}get extent(){return this._extent}set advance(i){this._advance=i}get advance(){return this._advance}}},9495:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlyphVertices=void 0;class a{static concat(i){let h=0;i.forEach(f=>h+=f?f.length:0);const p=new a(h);let d=0;for(let f=0;f<i.length;++f){const s=i[f];s!==void 0&&s.length!==0&&(p._texCoords.set(s._texCoords,d*a.FLOATS_PER_TEXCOORD),p._origins.set(s._origins,d*a.FLOATS_PER_ORIGIN),p._tangents.set(s._tangents,d*a.FLOATS_PER_TANGENT),p._ups.set(s._ups,d*a.FLOATS_PER_UP),d+=s.length)}return p}constructor(i){const h=Math.max(0,i);this._texCoords=new Float32Array(h*a.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(h*a.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(h*a.FLOATS_PER_TANGENT),this._ups=new Float32Array(h*a.FLOATS_PER_UP)}shrink(i){const h=Math.max(0,i);if(this.length===h)return;const p=(d,f,s)=>new Float32Array(d.buffer.slice(0,f*d.BYTES_PER_ELEMENT*s),0,f*s);p(this._texCoords,h,a.FLOATS_PER_TEXCOORD),p(this._origins,h,a.FLOATS_PER_ORIGIN),p(this._ups,h,a.FLOATS_PER_TANGENT),p(this._tangents,h,a.FLOATS_PER_UP)}uvLowerLeft(i){const h=i*a.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(h,h+2)}uvUpperRight(i){const h=i*a.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(h,h+2)}origin(i){const h=i*a.FLOATS_PER_ORIGIN;return this._origins.subarray(h,h+a.FLOATS_PER_ORIGIN)}tangent(i){const h=i*a.FLOATS_PER_TANGENT;return this._tangents.subarray(h,h+a.FLOATS_PER_TANGENT)}up(i){const h=i*a.FLOATS_PER_UP;return this._ups.subarray(h,h+a.FLOATS_PER_UP)}get length(){return this._origins.length/a.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}r.GlyphVertices=a,a.FLOATS_PER_TEXCOORD=4,a.FLOATS_PER_ORIGIN=3,a.FLOATS_PER_TANGENT=3,a.FLOATS_PER_UP=3},1058:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Typesetter=r.Text=r.Projected3DLabel=r.Position3DLabel=r.Position2DLabel=r.LabelRenderPass=r.LabelGeometry=r.Label=r.GlyphVertices=r.FontFace=void 0;var n=a(8296);Object.defineProperty(r,"FontFace",{enumerable:!0,get:function(){return n.FontFace}});var i=a(9495);Object.defineProperty(r,"GlyphVertices",{enumerable:!0,get:function(){return i.GlyphVertices}});var h=a(7188);Object.defineProperty(r,"Label",{enumerable:!0,get:function(){return h.Label}});var p=a(4128);Object.defineProperty(r,"LabelGeometry",{enumerable:!0,get:function(){return p.LabelGeometry}});var d=a(265);Object.defineProperty(r,"LabelRenderPass",{enumerable:!0,get:function(){return d.LabelRenderPass}});var f=a(5035);Object.defineProperty(r,"Position2DLabel",{enumerable:!0,get:function(){return f.Position2DLabel}});var s=a(5036);Object.defineProperty(r,"Position3DLabel",{enumerable:!0,get:function(){return s.Position3DLabel}});var o=a(135);Object.defineProperty(r,"Projected3DLabel",{enumerable:!0,get:function(){return o.Projected3DLabel}});var u=a(7623);Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return u.Text}});var b=a(967);Object.defineProperty(r,"Typesetter",{enumerable:!0,get:function(){return b.Typesetter}})},7188:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Label=void 0;const n=a(3557),i=a(7564),h=a(3847),p=a(9495),d=a(7623);class f{static devicePixelRatio(){return window===void 0||typeof window.devicePixelRatio!="number"?1:window.devicePixelRatio}constructor(o,u,b){this._alignment=f.Alignment.Left,this._lineAnchor=f.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=f.Unit.World,this._color=new h.Color(f.DEFAULT_COLOR),this._altered=Object.assign(new i.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=f.Elide.None,this._ellipsis=f.DEFAULT_ELLIPSIS,this._text=o,this._type=u,this._staticTransform=n.mat4.create(),this._dynamicTransform=n.mat4.create(),this._extent=[0,0],b&&(this._fontFace=b)}vertices(){return new p.GlyphVertices(this.length+this.ellipsis.length)}charAt(o){return this._text.charAt(o)}charCodeAt(o){return this._text.charCodeAt(o)}lineFeedAt(o){return this.charAt(o)===this.lineFeed}kerningBefore(o){return o<1||o>this.length?NaN:this._fontFace.kerning(this.charCodeAt(o-1),this.charCodeAt(o))}kerningAfter(o){return o<0||o>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(o),this.charCodeAt(o+1))}advance(o){return o<0||o>this.length?NaN:this._fontFace.glyph(this.charCodeAt(o)).advance}toString(){return this._text instanceof d.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(o){this._altered.alter("text"),this._text=o}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof d.Text?this._text.lineFeed:d.Text.DEFAULT_LINE_FEED}set wrap(o){this._wrap=o}get wrap(){return this._wrap}set elide(o){this._elide=o}get elide(){return this._elide}set ellipsis(o){this._ellipsis!==o&&(this._ellipsis=o,this._elide!==f.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(o){this._lineWidth!==o&&(this._lineWidth=o,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(o){this._alignment!==o&&(this._alignment=o,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(o){this._lineAnchor!==o&&(this._lineAnchor=o,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(o){this._fontSize!==o&&(this._fontSize=o,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(o){this._fontSizeUnit!==o&&(this._fontSizeUnit=o,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(o){this._fontFace!==o&&(this._fontFace=o,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(o){this._color.equals(o)||(this._color=o,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(o){this._backgroundColor.equals(o)||(this._backgroundColor=o,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(o){n.mat4.equals(this._staticTransform,o)||(this._staticTransform=o,this._altered.alter("static"))}get staticTransform(){const o=this.fontSize/this._fontFace.size,u=n.mat4.create();return n.mat4.scale(u,this._staticTransform,n.vec3.fromValues(o,o,o)),u}set dynamicTransform(o){this._altered.alter("dynamic"),this._dynamicTransform=o}get dynamicTransform(){return this._dynamicTransform}set extent(o){this._extent=o}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return this._fontFace!==void 0&&this._fontFace.glyphTexture.valid&&this._text.length>0}}r.Label=f,f.DEFAULT_COLOR=[.1098,.4588,.7373,1],f.DEFAULT_ELLIPSIS="...",function(s){(function(o){o.Static="static",o.Dynamic="dynamic"})(s.Type||(s.Type={})),function(o){o.None="none",o.Left="left",o.Middle="middle",o.Right="right"}(s.Elide||(s.Elide={})),function(o){o.Left="left",o.Center="center",o.Right="right"}(s.Alignment||(s.Alignment={})),function(o){o.Top="top",o.Ascent="ascent",o.Center="center",o.Baseline="baseline",o.Descent="descent",o.Bottom="bottom"}(s.LineAnchor||(s.LineAnchor={})),function(o){o.World="world",o.Pixel="pixel",o.Mixed="mixed"}(s.Unit||(s.Unit={}))}(f||(r.Label=f={}))},4128:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.LabelGeometry=void 0;const i=a(9504),h=a(7340),p=a(638),d=a(4127);class f extends p.Geometry{constructor(o,u){super(o,u),this._numberOfGlyphs=0,(0,i.assert)(o.isWebGL2||o.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),u=u!==void 0&&u!==""?u:this.constructor.name,this._vertices=new h.Buffer(o,`${u}VBO`),this._buffers.push(this._vertices),this._texCoords=new h.Buffer(o,`${u}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new h.Buffer(o,`${u}OriginVBO`),this._buffers.push(this._origins),this._tangents=new h.Buffer(o,`${u}TangentVBO`),this._buffers.push(this._tangents),this._ups=new h.Buffer(o,`${u}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const o=this.context.gl,u=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,o.FLOAT,!1,8,0,!0,!1),u.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,o.FLOAT,!1,16,0,!0,!1),u.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,o.FLOAT,!1,12,0,!0,!1),u.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(o=0,u=1,b=2,v=3,_=4){this._vertexLocation=o,this._texCoordLocation=u,this._originLocation=b,this._tangentLocation=v,this._upLocation=_;const g=this.context.gl,x=super.initialize([g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER,g.ARRAY_BUFFER]);return this._vertices.data(f.VERTICES,g.STATIC_DRAW),x}update(o,u,b,v){this._numberOfGlyphs=o.length/3;const _=this.context.gl;this._texCoords.data(v,_.STATIC_DRAW),this._origins.data(o,_.STATIC_DRAW),this._tangents.data(u,_.STATIC_DRAW),this._ups.data(b,_.STATIC_DRAW)}draw(o=0,u=0){const b=this.context.gl,v=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,b.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,b.FLOAT,!1,16,16*o,!0,!1),this._origins.attribEnable(this._originLocation,3,b.FLOAT,!1,12,12*o,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,b.FLOAT,!1,12,12*o,!0,!1),this._ups.attribEnable(this._upLocation,3,b.FLOAT,!1,12,12*o,!0,!1),v.drawArraysInstanced(b.TRIANGLE_STRIP,0,4,u)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const o=this._vertices&&this._vertices.valid,u=this._texCoords&&this._texCoords.valid,b=this._origins&&this._origins.valid,v=this._tangents&&this._tangents.valid,_=this._ups&&this._ups.valid;return this.initialized&&o&&u&&b&&v&&_}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}r.LabelGeometry=f,f.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),n([d.Initializable.assert_initialized()],f.prototype,"draw",null)},265:function(l,r,a){var n=this&&this.__decorate||function(O,A,R,P){var C,U=arguments.length,j=U<3?A:P===null?P=Object.getOwnPropertyDescriptor(A,R):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(O,A,R,P);else for(var k=O.length-1;k>=0;k--)(C=O[k])&&(j=(U<3?C(j):U>3?C(A,R,j):C(A,R))||j);return U>3&&j&&Object.defineProperty(A,R,j),j};Object.defineProperty(r,"__esModule",{value:!0}),r.LabelRenderPass=void 0;const i=a(3557),h=a(9504),p=a(7564),d=a(4127),f=a(4168),s=a(771),o=a(8593),u=a(9495),b=a(7188),v=a(4128),_=a(5035),g=a(5036),x=a(135);class T extends d.Initializable{constructor(A){super(),this._altered=Object.assign(new p.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=T.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=A,this._depthFunc=A.gl.LESS,this._program=new f.Program(A,"LabelRenderProgram"),this._geometry=new v.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=T.DEFAULT_AA_STEP_SCALE}prepare(){const A=this._camera.viewport;for(let P=0;P<this._labels.length;++P){const C=this._labels[P];let U;const j=this._altered.labels&&this._verticesPerLabel[P]===void 0;C instanceof _.Position2DLabel?(C.frameSize=A,U=C.typeset(j)):C instanceof x.Projected3DLabel?(C.camera=this._camera,U=C.typeset(j)):C instanceof g.Position3DLabel&&(U=C.typeset(j)),U===void 0?U=this._verticesPerLabel[P]:this._verticesPerLabel[P]=U;const k=P>0?this._ranges[P-1][1]:0,$=k+(U===void 0?0:U.length);this._ranges[P]=[k,$]}const R=u.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(R.origins,R.tangents,R.ups,R.texCoords)}draw(){const A=this._context.gl,R=[0,0];let P,C;const U=i.mat4.create();for(let j=0;j<this._labels.length;++j){const k=this._labels[j];if(R[1]=this._ranges[j][1],R[0]===R[1]||j<this._labels.length-1&&!k.valid)continue;const $=j<this._labels.length-1?this._labels[j+1]:void 0,Y=$&&k.type===b.Label.Type.Static&&$.type===b.Label.Type.Static,Z=$&&k.color.equals($.color),J=$&&k.fontFace===$.fontFace,te=$&&k.fontSizeUnit===$.fontSizeUnit;if($&&(this._ranges[j+1][0]===this._ranges[j+1][1]||Y&&Z&&J&&te))continue;const Q=k.type===b.Label.Type.Dynamic;switch(A.uniform1i(this._uDynamic,Q),Q&&A.uniformMatrix4fv(this._uTransform,!1,k.dynamicTransform),P!==void 0&&P.equals(k.color)||(A.uniform4fv(this._uColor,k.color.rgbaF32),P=k.color),C!==k.fontFace&&(k.fontFace.glyphTexture.bind(A.TEXTURE0),C=k.fontFace),k.fontSizeUnit){case b.Label.Unit.Pixel:A.uniformMatrix4fv(this._uViewProjection,!1,U);break;case b.Label.Unit.World:case b.Label.Unit.Mixed:default:A.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(R[0],R[1]-R[0]),R[0]=R[1]}}initialize(){const A=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const R=new s.Shader(this._context,A.VERTEX_SHADER,"glyph.vert");R.initialize(a(1616));const P=new s.Shader(this._context,A.FRAGMENT_SHADER,"glyph.frag");return P.initialize(a(5389)),this._program.initialize([R,P],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),A.uniform1i(this._program.uniform("u_glyphs"),0),A.uniform1f(this._uAAStepScale,this._aaStepScale),A.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(A=!1){const R=this._context.gl;this._program.bind(),(A||this._altered.camera||this._camera.altered)&&R.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(A||this._altered.aaStepScale)&&R.uniform1f(this._uAAStepScale,this._aaStepScale),(A||this._altered.aaSampling)&&R.uniform1i(this._uAASampling,this._aaSampling);let P=A||this._altered.labels||this._altered.camera||this._camera.altered,C=0;for(;P===!1&&C<this._labels.length;)P=this._labels[C].altered,++C;P&&this.prepare(),this._altered.reset()}frame(){if(this._geometry.numGlyphs===0||this._labels.length===0)return;(0,h.assert)(this._target&&this._target.valid,"valid target expected");const A=this._context.gl,R=this._target.size;A.viewport(0,0,R[0],R[1]),A.enable(A.DEPTH_TEST),A.depthFunc(this._depthFunc),this._depthMask===!1&&A.depthMask(this._depthMask),A.enable(A.BLEND),A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA),this._program.bind(),A.uniform2fv(this._uNdcOffset,this._ndcOffset),A.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),A.bindTexture(A.TEXTURE_2D,o.Texture2D.DEFAULT_TEXTURE),this._depthMask===!1&&A.depthMask(!0),A.depthFunc(A.LESS),A.disable(A.DEPTH_TEST),A.disable(A.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(A){this.assertInitialized(),this._target=A}set ndcOffset(A){this.assertInitialized(),this._ndcOffset=A}set camera(A){this.assertInitialized(),this._camera!==A&&(this._camera=A,this._altered.alter("camera"))}set depthMask(A){this._depthMask=A}get depthMask(){return this._depthMask}set depthFunc(A){this._depthFunc=A}get depthFunc(){return this._depthFunc}set labels(A){this._labels=A,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(A){this._aaStepScale!==A&&(this._aaStepScale=A,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(A){this._aaSampling!==A&&(this._aaSampling=A,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}r.LabelRenderPass=T,T.DEFAULT_AA_STEP_SCALE=.6666,n([d.Initializable.initialize()],T.prototype,"initialize",null),n([d.Initializable.uninitialize()],T.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],T.prototype,"update",null),n([d.Initializable.assert_initialized()],T.prototype,"frame",null),n([d.Initializable.assert_initialized()],T.prototype,"unbind",null),function(O){(function(A){A[A.None=0]="None",A[A.Smooth1=1]="Smooth1",A[A.Horizontal3=2]="Horizontal3",A[A.Vertical3=3]="Vertical3",A[A.Grid3x3=4]="Grid3x3",A[A.Grid4x4=5]="Grid4x4"})(O.Sampling||(O.Sampling={}))}(T||(r.LabelRenderPass=T={}))},5035:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Position2DLabel=void 0;const n=a(3557),i=a(9504),h=a(5150),p=a(9495),d=a(7188),f=a(967);class s extends d.Label{constructor(u,b,v){super(u,b,v),this._position=n.vec2.fromValues(0,0),this._direction=n.vec2.fromValues(1,0),this._frameSize=n.vec2.create(),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Pixel}typeset(u=!1){const b=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!b&&!this._altered.dynamic&&!u)return;if(!this.valid)return new p.GlyphVertices(0);const v=n.vec4.create(),_=n.mat4.create();n.mat4.translate(_,(0,h.m4)(),n.vec3.fromValues(-1,-1,0)),n.mat4.scale(_,_,n.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const g=n.vec2.sub((0,h.v2)(),n.vec2.fromValues(this._frameSize[0],this._frameSize[1]),n.vec2.fromValues(v[3]+v[1],v[2]+v[0])),x=n.vec3.fromValues(.5*g[0],.5*g[1],0);n.vec3.add(x,x,n.vec3.fromValues(v[3],v[2],0)),n.mat4.translate(_,_,x),n.mat4.translate(_,_,n.vec3.fromValues(this._position[0],this._position[1],0));const T=n.vec2.fromValues(1,0);let O=n.vec2.angle(T,this._direction);switch(T[0]*this._direction[1]-T[1]*this._direction[0]<0&&(O=-O),n.mat4.rotateZ(_,_,O),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(_),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=n.mat4.clone(_)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!b)return;const A=this.vertices();return f.Typesetter.typeset(this,A),A}set frameSize(u){n.vec2.equals(this._frameSize,u)||(n.vec2.max(this._frameSize,u,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(u){n.vec2.equals(this._position,u)||(this._position=n.vec2.clone(u),this._altered.alter(this._type))}get position(){return this._position}set direction(u){n.vec2.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(u){(0,i.logIf)(u!==d.Label.Unit.Pixel,i.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}r.Position2DLabel=s,s.DEFAULT_FONTSIZE_PX=20},5036:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Position3DLabel=void 0;const n=a(3557),i=a(9504),h=a(5150),p=a(9495),d=a(7188),f=a(967);class s extends d.Label{constructor(u,b,v){super(u,b,v),this._position=n.vec3.fromValues(0,0,0),this._direction=n.vec3.fromValues(1,0,0),this._up=n.vec3.fromValues(0,1,0),this._fontSize=s.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=d.Label.Unit.World}typeset(u=!1){const b=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!b&&!this._altered.dynamic&&!u)return;if(!this.valid)return new p.GlyphVertices(0);const v=n.mat4.create();n.mat4.translate(v,(0,h.m4)(),this._position);const _=n.vec3.cross((0,h.v3)(),this._direction,this._up),g=n.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,_[0],_[1],_[2],0,0,0,0,1);switch(n.mat4.mul(v,v,g),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(v),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=n.mat4.clone(v)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!b)return;const x=this.vertices();return f.Typesetter.typeset(this,x),x}set position(u){this._position=n.vec3.clone(u),this._altered.alter(this._type)}get position(){return this._position}set direction(u){n.vec3.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set up(u){this._up=n.vec3.normalize(this._up,u),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(u){(0,i.logIf)(u!==d.Label.Unit.World,i.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}r.Position3DLabel=s,s.DEFAULT_FONTSIZE_WORLD=.05},135:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Projected3DLabel=void 0;const n=a(3557),i=a(9504),h=a(5150),p=a(9495),d=a(7188),f=a(967);class s extends d.Label{constructor(u,b,v){super(u,b,v),this._position=n.vec3.fromValues(0,0,0),this._direction=n.vec2.fromValues(1,0),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Mixed}typeset(u=!1){const b=u||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!b&&!this._altered.dynamic&&!u)return;if(!this.valid||this._camera===void 0)return new p.GlyphVertices(0);const v=n.vec4.create(),_=n.mat4.create();n.mat4.translate(_,_,n.vec3.fromValues(-1,-1,0)),n.mat4.scale(_,_,n.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),n.mat4.scale(_,_,n.vec3.fromValues(1,1,1));const g=n.vec2.create();n.vec2.sub(g,n.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),n.vec2.fromValues(v[3]+v[1],v[2]+v[0]));const x=n.vec3.fromValues(.5*g[0],.5*g[1],0);n.vec3.add(x,x,n.vec3.fromValues(v[3],v[2],0)),n.mat4.translate(_,_,x);const T=n.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);n.vec4.transformMat4(T,T,this._camera.viewProjection);const O=n.mat4.create(),A=T[3];n.mat4.translate(O,O,n.vec3.fromValues(T[0]/A,T[1]/A,T[2]/A)),n.mat4.mul(_,O,_);const R=n.vec2.fromValues(1,0);let P=n.vec2.angle(R,this._direction);switch(R[0]*this._direction[1]-R[1]*this._direction[0]<0&&(P=-P),n.mat4.rotateZ(_,_,P),this._camera.viewProjectionInverse?n.mat4.mul(_,this._camera.viewProjectionInverse,_):(0,i.log)(i.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(_),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=n.mat4.clone(_)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!b)return;const C=this.vertices();return f.Typesetter.typeset(this,C),C}set camera(u){this._camera=u,this._altered.alter(this._type)}get camera(){return this._camera}set position(u){this._position=n.vec3.clone(u),this._altered.alter(this._type)}get position(){return this._position}set direction(u){n.vec2.normalize(this._direction,u),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(u){(0,i.logIf)(u!==d.Label.Unit.Mixed,i.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${u}`)}get fontSizeUnit(){return this._fontSizeUnit}}r.Projected3DLabel=s,s.DEFAULT_FONTSIZE_PX=20},7623:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Text=void 0;class a{constructor(i,h){this._lineFeed=a.DEFAULT_LINE_FEED,this._altered=!1,this._text=i||"",this._lineFeed=h!==void 0?h:this._lineFeed}get length(){return this._text.length}charAt(i){return this._text.charAt(i)}charCodeAt(i){return this._text.charCodeAt(i)}set text(i){this._text!==i&&(this._altered=!0,this._text=i)}get text(){return this._text}set lineFeed(i){this._lineFeed!==i&&(this._altered=!0,this._lineFeed=i)}get lineFeed(){return this._lineFeed}set altered(i){this._altered=i}get altered(){return this._altered}}r.Text=a,a.DEFAULT_LINE_FEED=`
`},967:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Typesetter=void 0;const n=a(3557),i=a(9504),h=a(5150),p=a(7188);class d{static writeVertex(s,o,u,b,v){if(b===void 0||u.depictable()===!1)return;const _=s.glyphTexturePadding,g=b.origin(v);n.vec3.set(g,o[0],o[1],0),g[0]+=u.bearing[0]-_[3],g[1]+=u.bearing[1]-u.extent[1],n.vec3.set(b.tangent(v),u.extent[0],0,0),n.vec3.set(b.up(v),0,u.extent[1],0);const x=b.uvLowerLeft(v);n.vec2.copy(x,u.subTextureOrigin);const T=b.uvUpperRight(v);n.vec2.add(T,u.subTextureOrigin,u.subTextureExtent)}static lineAnchorOffset(s){let o=0;const u=s.fontFace.glyphTexturePadding,b=s.fontFace;switch(s.lineAnchor){case p.Label.LineAnchor.Ascent:o=b.ascent-u[0];break;case p.Label.LineAnchor.Descent:o=b.descent*(1+u[0]/b.ascent);break;case p.Label.LineAnchor.Center:o=b.ascent-u[0]-.5*b.size;break;case p.Label.LineAnchor.Top:o=b.ascent-u[0]+.5*b.lineGap;break;case p.Label.LineAnchor.Bottom:o=b.ascent-u[0]+.5*b.lineGap-b.lineHeight;break;case p.Label.LineAnchor.Baseline:default:o=-u[0]}return o}static advances(s,o){(0,i.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve advances"),o===void 0&&(o=s.text.text);const u=new Float32Array(o.length);for(let b=0;b<o.length;++b){const v=o.charCodeAt(b);u[b]=s.fontFace.glyph(v).advance}return u}static kernings(s,o){if((0,i.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve kernings"),o===void 0){const v=new Float32Array(s.length);for(let _=0;_<s.length;++_){const g=s.kerningAfter(_);v[_]=isNaN(g)?0:g}return v}const u=new Float32Array(o.length);for(let v=0;v<o.length;++v){const _=(b=v)<0||b>o.length-1?NaN:s.fontFace.kerning(o.charCodeAt(b),o.charCodeAt(b+1));u[v]=isNaN(_)?0:_}var b;return u}static fragments(s){const o=new Array;let u,b=0;for(let v=0;v<s.length;++v){if(u=d.DELIMITERS.indexOf(s.charAt(v))>-1,!u)continue;b<v&&o.push([b,v,d.FragmentType.Word]);const _=s.lineFeedAt(v)?d.FragmentType.LineFeed:d.FragmentType.Delimiter;o.push([v,v+1,_]),b=v+1}return u||o.push([b,s.length,d.FragmentType.Word]),o}static fragmentWidths(s,o,u){const b=new Float32Array(s.length);for(let v=0;v<s.length;++v){const _=s[v];b[v]=o.subarray(_[0],_[1]).reduce((g,x,T)=>g+x+(T<_[1]?u[T+_[0]]:0),0)}return b}static elideThresholds(s,o){switch(s.elide){case p.Label.Elide.Right:return[s.lineWidth-o,0];case p.Label.Elide.Middle:const u=s.lineWidth/2-o/2;return[u,u];case p.Label.Elide.Left:return[0,s.lineWidth-o];default:return[0,0]}}static elideFragments(s,o,u,b,v,_){const g=new Array,x=new Array;let T=0,O=0;for(let A=_?o.length-1:0;_?A>-1:A<o.length;_?--A:++A){const R=o[A];if(R[2]!==d.FragmentType.LineFeed){if(!(T+u[A]<s)){if(R[2]===d.FragmentType.Delimiter||T+b[_?R[1]-1:R[0]]>s)break;for(let P=_?R[1]-1:R[0];_?P>=R[0]:P<R[1];_?--P:++P){if(!(T+O+b[P]+v[P]<s)){g.push([_?P+1:R[0],_?R[1]:P,R[2]]),x.push(O);break}O+=b[P]+v[P]}break}T+=u[A],g.push(R),x.push(u[A])}}return[g,x,T+O]}static transformVertices(s,o,u,b){if(o!==void 0&&!n.mat4.equals(s,n.mat4.create()))for(let v=u;v<b;++v){const _=o.origin(v),g=(0,h.v3)();n.vec3.transformMat4(g,_,s);const x=(0,h.v3)();n.vec3.transformMat4(x,n.vec3.add(x,_,o.tangent(v)),s);const T=(0,h.v3)();n.vec3.transformMat4(T,n.vec3.add(T,_,o.up(v)),s),n.vec3.copy(o.origin(v),g),n.vec3.sub(o.tangent(v),x,g),n.vec3.sub(o.up(v),T,g)}}static updateRectangleMinMax(s,o){(0,i.assert)(s.length===6&&o.length===6,"expected the rectangles to have 6 values!");let u=0;for(;u<3;u++)s[u]=Math.min(s[u],o[u]);for(;u<6;u++)s[u]=Math.max(s[u],o[u])}static minMax(s,o,u){const b=Math.min(s,...u),v=Math.max(o,...u);return n.vec2.fromValues(b,v)}static getMinMaxVertices(s,o,u){let b=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,_=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(let O=o;O<u;++O){const A=d.minMax(b,v,[s.origin(O)[0],s.origin(O)[0]+s.up(O)[0],s.origin(O)[0]+s.tangent(O)[0]]);b=A[0],v=A[1];const R=d.minMax(_,g,[s.origin(O)[1],s.origin(O)[1]+s.up(O)[1],s.origin(O)[1]+s.tangent(O)[1]]);_=R[0],g=R[1];const P=d.minMax(x,T,[s.origin(O)[2],s.origin(O)[2]+s.up(O)[2],s.origin(O)[2]+s.tangent(O)[2]]);x=P[0],T=P[1]}return[b,_,x,v,g,T]}static transformAlignment(s,o,u,b,v){if(u===void 0||o===p.Label.Alignment.Left)return;let _=-s;o===p.Label.Alignment.Center&&(_*=.5);for(let g=b;g<v;++g)u.origin(g)[0]+=_}static transform(s,o,u){const b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const A of u)d.transformAlignment(A[2],s.alignment,o,A[0],A[1]),d.updateRectangleMinMax(b,d.getMinMaxVertices(o,A[0],A[1])),d.transformVertices(s.staticTransform,o,A[0],A[1]);const v=b[3]-b[0],_=b[4]-b[1],g=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(0,0,0,1),s.staticTransform),x=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(v,0,0,1),s.staticTransform),T=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(0,_,0,1),s.staticTransform),O=n.vec2.fromValues(n.vec4.distance(x,g),n.vec4.distance(T,g));s.extent=[O[0],O[1]]}static typeset(s,o){if(s.length===0)return 0;(0,i.assert)(s.fontFace!==void 0,"expected a font face for label before typesetting");const u=s.fontFace,b=U=>U<s.length?u.glyph(s.charCodeAt(U)):u.glyph(s.ellipsis.charCodeAt(U-s.length)),v=d.advances(s),_=d.kernings(s),g=d.fragments(s),x=d.fragmentWidths(g,v,_),T=n.vec2.fromValues(0,-d.lineAnchorOffset(s)),O=new Array;let A=0;const R=s.elide!==p.Label.Elide.None,P=(U,j,k=NaN,$=v,Y=_,Z=0)=>{let J=A;for(let te=0;te<U.length;++te){const Q=U[te];if(Q[0]>=Q[1])continue;const ie=!R&&Q[2]===d.FragmentType.LineFeed;let ce=!1;if(!R&&!ie&&s.wrap){const de=Q[2]!==d.FragmentType.Delimiter||b(Q[0]).depictable(),me=Q[2]===d.FragmentType.Word&&te<U.length-1&&U[te+1][2]===d.FragmentType.Delimiter&&b(U[te+1][0]).depictable();ce=T[0]+(de?j[te]:0)+(me?j[te+1]:0)>s.lineWidth}if(!ie&&!ce||(O.push([J,A,T[0]]),J=A,T[0]=0,T[1]-=u.lineHeight,!ie))for(let de=Q[0];de<Q[1];++de)b(de).depictable()&&(d.writeVertex(u,T,b(de),o,A),++A),T[0]+=$[de-Z]+Y[de-Z]}J<A&&O.push([J,A,T[0]])},C=x.reduce((U,j)=>U+j,0);if(R&&C>s.lineWidth){const U=[[s.length,s.length+s.ellipsis.length,d.FragmentType.Word]],j=d.advances(s,s.ellipsis),k=d.kernings(s,s.ellipsis),$=d.fragmentWidths([[0,s.ellipsis.length,d.FragmentType.Word]],j,k),Y=$[0];if(s.lineWidth<Y)return 0;const Z=d.elideThresholds(s,Y),[J,te,Q]=d.elideFragments(Z[0],g,x,v,_,!1);s.elide===p.Label.Elide.Middle&&(Z[1]+=Z[0]-Q);const[ie,ce]=d.elideFragments(Z[1],g,x,v,_,!0);P(J,new Float32Array(te)),P(U,$,NaN,j,k,s.length),P(ie.reverse(),new Float32Array(ce.reverse())),(0,i.assert)(O.length<4,`expected at most 3-line-yield from advance, given ${O}`),O[0][1]=O[O.length-1][1],O[0][2]=T[0],O.length=1}else P(g,x,s.lineWidth);return d.transform(s,o,O),o.shrink(A),A}}r.Typesetter=d,d.DELIMITERS=`
 ,.-/()[]<>`,function(f){(function(s){s[s.Word=0]="Word",s[s.Delimiter=1]="Delimiter",s[s.LineFeed=2]="LineFeed"})(f.FragmentType||(f.FragmentType={}))}(d||(r.Typesetter=d={}))},8593:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.Texture2D=void 0;const i=a(9504),h=a(3513),p=a(4127),d=a(9965);class f extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(o,u,b,v,_){(0,i.assert)(o>0&&u>0,"texture requires valid width and height of greater than zero");const g=this._context.gl,x=this._context.gl2facade;if(this._object=g.createTexture(),this._width=o,this._height=u,this._internalFormat=b,this._format=v,this._type=_,g.bindTexture(g.TEXTURE_2D,this._object),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),f.MAX_ANISOTROPY===void 0)if(this._context.supportsTextureFilterAnisotropic){const T=this._context.textureFilterAnisotropic;f.MAX_ANISOTROPY=g.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else f.MAX_ANISOTROPY=0;return x.texImage2D(g.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),g.bindTexture(g.TEXTURE_2D,f.DEFAULT_TEXTURE),this._valid=g.isTexture(this._object),this.reallocate(),this._object}delete(){(0,i.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let b=this._width*this._height*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?b*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(b*=4),this.context.allocationRegister.reallocate(this._identifier,b)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D,f.DEFAULT_TEXTURE)}fetch(o,u=!1,b=!1){const v=this.context.gl;return new Promise((_,g)=>{const x=new Image;x.onerror=()=>{(0,i.log)(i.LogLevel.Error,`loading image from '${x.src}' failed`),g()},x.onload=()=>{this.resize(x.width,x.height),b||v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data(x),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),_()},u&&(x.crossOrigin="anonymous"),x.src=o})}data(o,u=!0,b=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage2D(v.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,o),this._anisotropy!==void 0&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),b&&this.unbind(),this.reallocate()}filter(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),(0,i.logIf)(o===_.LINEAR_MIPMAP_LINEAR||o===_.LINEAR_MIPMAP_NEAREST,i.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u),this._mipmap=u===_.LINEAR_MIPMAP_LINEAR||u===_.LINEAR_MIPMAP_NEAREST,this._mipmap&&_.generateMipmap(_.TEXTURE_2D),v&&this.unbind()}wrap(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,u),v&&this.unbind()}reformat(o,u,b,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||b!==void 0&&b!==this._type)&&((0,i.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),b&&(this._type=b),this.data(void 0,v,_))}resize(o,u,b=!0,v=!0){o===this._width&&u===this._height||(this._width=o,this._height=u,this.data(void 0,b,v))}generateMipMap(o=!0,u=!0){const b=this.context.gl;o&&this.bind(),b.generateMipmap(b.TEXTURE_2D),u&&this.unbind(),this._mipmap=!0}maxAnisotropy(o,u=!0,b=!0){if(this._context.supportsTextureFilterAnisotropic===!1)return void(0,i.log)(i.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const v=this.context.gl,_=this._context.textureFilterAnisotropic;return this._anisotropy=o===void 0?void 0:Math.max(0,Math.min(f.MAX_ANISOTROPY,o)),(0,i.logIf)(o!==this._anisotropy,i.LogLevel.Debug,`value clamped to max supported anisotropy of ${f.MAX_ANISOTROPY}, given ${o}`),u&&this.bind(),v.texParameterf(v.TEXTURE_2D,_.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy===void 0?0:this._anisotropy),this.generateMipMap(!1,b),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}r.Texture2D=f,f.DEFAULT_TEXTURE=void 0,f.MAX_ANISOTROPY=void 0,n([p.Initializable.assert_initialized()],f.prototype,"bind",null),n([p.Initializable.assert_initialized()],f.prototype,"unbind",null),n([p.Initializable.assert_initialized()],f.prototype,"fetch",null),n([p.Initializable.assert_initialized()],f.prototype,"data",null),n([p.Initializable.assert_initialized()],f.prototype,"filter",null),n([p.Initializable.assert_initialized()],f.prototype,"wrap",null),n([p.Initializable.assert_initialized()],f.prototype,"reformat",null),n([p.Initializable.assert_initialized()],f.prototype,"resize",null)},7380:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.Texture2DArray=void 0;const i=a(9504),h=a(3513),p=a(4127),d=a(9965);class f extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,u,b,v,_,g){(0,i.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,i.assert)(o>0&&u>0&&b>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,T=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=u,this._depth=b,this._internalFormat=v,this._format=_,this._type=g,x.bindTexture(x.TEXTURE_2D_ARRAY,this._object),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),T.texImage3D(x.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_2D_ARRAY,f.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,i.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let b=this._width*this._height*this._depth*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?b*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(b*=4),this.context.allocationRegister.reallocate(this._identifier,b)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D_ARRAY,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_2D_ARRAY,f.DEFAULT_TEXTURE)}fetch(o,u,b=!1){return new Promise((v,_)=>{const g=new Image;g.onerror=()=>{(0,i.log)(i.LogLevel.Error,`loading image from '${g.src}' failed`),_()},g.onload=()=>{this.resize(g.width,g.height/u,u),this.data(g),v()},b&&(g.crossOrigin="anonymous"),g.src=o})}data(o,u=!0,b=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage3D(v.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),b&&this.unbind(),this.reallocate()}filter(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_2D_ARRAY,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D_ARRAY,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,b,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_T,u),g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_WRAP_R,b),_&&this.unbind()}reformat(o,u,b,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||b!==void 0&&b!==this._type)&&((0,i.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),b&&(this._type=b),this.data(void 0,v,_))}resize(o,u,b,v=!0,_=!0){o===this._width&&u===this._height&&b===this._depth||(this._width=o,this._height=u,this._depth=b,this.data(void 0,v,_))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}r.Texture2DArray=f,f.DEFAULT_TEXTURE=void 0,n([p.Initializable.assert_initialized()],f.prototype,"bind",null),n([p.Initializable.assert_initialized()],f.prototype,"unbind",null),n([p.Initializable.assert_initialized()],f.prototype,"fetch",null),n([p.Initializable.assert_initialized()],f.prototype,"data",null),n([p.Initializable.assert_initialized()],f.prototype,"filter",null),n([p.Initializable.assert_initialized()],f.prototype,"wrap",null),n([p.Initializable.assert_initialized()],f.prototype,"reformat",null),n([p.Initializable.assert_initialized()],f.prototype,"resize",null)},9584:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.Texture3D=void 0;const i=a(9504),h=a(3513),p=a(4127),d=a(9965);class f extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,u,b,v,_,g){(0,i.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,i.assert)(o>0&&u>0&&b>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,T=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=u,this._depth=b,this._internalFormat=v,this._format=_,this._type=g,x.bindTexture(x.TEXTURE_3D,this._object),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),T.texImage3D(x.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_3D,f.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,i.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,u=this._context.gl2facade;let b=this._width*this._height*this._depth*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===u.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?b*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(b*=4),this.context.allocationRegister.reallocate(this._identifier,b)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_3D,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_3D,f.DEFAULT_TEXTURE)}load(o,u,b=!1,v=!1){return new Promise((_,g)=>{const x=new Image;x.onerror=()=>g(),x.onload=()=>{const T=document.createElement("canvas"),O=T.getContext("2d");let A,R,P,C;if((0,i.assert)(O!==void 0,"expected auxiliary 2D context for temporary slicing"),v===!1){(0,i.assert)(x.height%u==0&&x.height/u>=1,"expected height to be a multitude of number of slices"),A=x.width,R=Math.floor(x.height/u),P=u,T.width=A,T.height=R,C=new Uint8Array(A*R*P);const U=A*R;for(let j=0;j<u;++j){O.drawImage(x,0,R*j,A,R,0,0,A,R);const k=O.getImageData(0,0,A,R).data;for(let $=0;$<U;++$)C[U*j+$]=k[4*$]}}else{(0,i.assert)(x.width%u==0&&x.width/u>=1,"expected width to be a multitude of number of slices"),A=Math.floor(x.width/u),R=x.height,P=u,T.width=A,T.height=R,C=new Uint8Array(A*R*P);const U=A*R;for(let j=0;j<u;++j){O.drawImage(x,A*j,0,A,R,0,0,A,R);const k=O.getImageData(0,0,A,R).data;for(let $=0;$<U;++$)C[U*j+$]=k[4*$]}}this.resize(A,R,P),this.data(C),_()},b&&(x.crossOrigin="anonymous"),x.src=o})}loadFromSingleImages(o,u,b=!1,v=!1){return new Promise((_,g)=>{const x=document.createElement("canvas"),T=x.getContext("2d"),O=[];let A,R;for(let P=0;P<o.length;P++){const C=new Image;C.onerror=()=>g();const U=new Promise((j,k)=>{try{C.onload=()=>{const $=C.width,Y=C.height;v===!1?(A===void 0?(A=$*o.length,x.width=A):(0,i.assert)($*o.length===A,"The single images do not have the same width"),R===void 0?(R=Y,x.height=R):(0,i.assert)(Y===R,"The single images do not have the same height"),T.drawImage(C,$*P,0)):(A===void 0?(A=$,x.width=A):(0,i.assert)($===A,"The single images do not have the same width"),R===void 0?(R=Y*o.length,x.height=R):(0,i.assert)(Y*o.length===R,"The single images do not have the same height"),T.drawImage(C,0,Y*P)),j()}}catch($){k($)}});O.push(U),b&&(C.crossOrigin="anonymous"),C.src=o[P]}Promise.all(O).then(()=>{const P=x.toDataURL("image/png",1);return this.load(P,u,b,v).then(()=>{_()})})})}data(o,u=!0,b=!0){const v=this.context.gl,_=this._context.gl2facade;u&&this.bind(),_.texImage3D(v.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),b&&this.unbind(),this.reallocate()}filter(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,b,v=!0,_=!0){const g=this.context.gl;v&&this.bind(),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_T,u),g.texParameteri(g.TEXTURE_3D,g.TEXTURE_WRAP_R,b),_&&this.unbind()}reformat(o,u,b,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||b!==void 0&&b!==this._type)&&((0,i.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),b&&(this._type=b),this.data(void 0,v,_))}resize(o,u,b,v=!0,_=!0){o===this._width&&u===this._height&&b===this._depth||(this._width=o,this._height=u,this._depth=b,this.data(void 0,v,_))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}r.Texture3D=f,f.DEFAULT_TEXTURE=void 0,n([p.Initializable.assert_initialized()],f.prototype,"bind",null),n([p.Initializable.assert_initialized()],f.prototype,"unbind",null),n([p.Initializable.assert_initialized()],f.prototype,"load",null),n([p.Initializable.assert_initialized()],f.prototype,"loadFromSingleImages",null),n([p.Initializable.assert_initialized()],f.prototype,"data",null),n([p.Initializable.assert_initialized()],f.prototype,"filter",null),n([p.Initializable.assert_initialized()],f.prototype,"wrap",null),n([p.Initializable.assert_initialized()],f.prototype,"reformat",null),n([p.Initializable.assert_initialized()],f.prototype,"resize",null)},5186:function(l,r,a){var n=this&&this.__decorate||function(s,o,u,b){var v,_=arguments.length,g=_<3?o:b===null?b=Object.getOwnPropertyDescriptor(o,u):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(s,o,u,b);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(g=(_<3?v(g):_>3?v(o,u,g):v(o,u))||g);return _>3&&g&&Object.defineProperty(o,u,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.TextureCube=void 0;const i=a(9504),h=a(3513),p=a(4127),d=a(9965);class f extends d.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(o){const u=this._context.gl;switch(o){case u.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case u.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case u.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case u.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case u.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case u.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return(0,i.assert)(!1,`expected texture cube map identifier (${u.TEXTURE_CUBE_MAP_POSITIVE_X}, ${u.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${u.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${u.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${u.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${u.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${o}`),-1}}create(o,u,b,v){(0,i.assert)(o>0,"texture cube requires valid size (width/height) of greater than zero");const _=this._context.gl,g=this._context.gl2facade;return this._object=_.createTexture(),this._size=o,this._internalFormat=u,this._format=b,this._type=v,_.bindTexture(_.TEXTURE_CUBE_MAP,this._object),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),_.bindTexture(_.TEXTURE_CUBE_MAP,f.DEFAULT_TEXTURE),this._valid=_.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){(0,i.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(o,u,b,v,_){const g=document.createElement("canvas");g.width=v,g.height=_;const x=g.getContext("2d");return x?(x.drawImage(o,u,b,v,_,0,0,v,_),x.getImageData(0,0,v,_)):(console.log(i.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(o,u){const b=this.context.gl,v=o.height/2*Math.pow(.5,u),_=[0,0],g=[o.width,o.height];for(let C=0;C<u;++C)g[0]/=2,g[1]/=2,_[0]+=g[0],_[1]+=g[1];b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);const x=this.cropImage(o,_[0],_[1],v,v);this.data([b.TEXTURE_CUBE_MAP_NEGATIVE_X,x],u);const T=this.cropImage(o,_[0]+v,_[1],v,v);this.data([b.TEXTURE_CUBE_MAP_POSITIVE_Z,T],u);const O=this.cropImage(o,_[0]+2*v,_[1],v,v);this.data([b.TEXTURE_CUBE_MAP_POSITIVE_X,O],u);const A=this.cropImage(o,_[0]+3*v,_[1],v,v);this.data([b.TEXTURE_CUBE_MAP_NEGATIVE_Z,A],u);const R=this.cropImage(o,_[0],_[1]+v,v,v);this.data([b.TEXTURE_CUBE_MAP_POSITIVE_Y,R],u);const P=this.cropImage(o,_[0]+v,_[1]+v,v,v);this.data([b.TEXTURE_CUBE_MAP_NEGATIVE_Y,P],u),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)}bind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_CUBE_MAP,this._object)}unbind(o){const u=this.context.gl;o&&u.activeTexture(o),u.bindTexture(u.TEXTURE_CUBE_MAP,f.DEFAULT_TEXTURE)}fetch(o,u=!1,b=0){const v=this.context.gl;return new Promise((_,g)=>{const x=new Array;o.positiveX&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_X,o.positiveX]),o.negativeX&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_X,o.negativeX]),o.positiveY&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Y,o.positiveY]),o.negativeY&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Y,o.negativeY]),o.positiveZ&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Z,o.positiveZ]),o.negativeZ&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Z,o.negativeZ]);let T=x.length;for(const O of x){const A=new Image;A.crossOrigin="anonymous",A.onerror=()=>g(),A.onload=()=>{const R=this.calculateMipLevelSize(b);A.width===A.height?A.width===R?(v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data([O[0],A],b),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),T-=1,T===0&&_()):(0,i.log)(i.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${R}, given ${A.width}`):(0,i.log)(i.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},u&&(A.crossOrigin="anonymous"),A.src=O[1]}})}fetchMipmapAtlas(o,u=!1){return new Promise((b,v)=>{const _=new Image;_.onerror=()=>v(),_.onload=()=>{if(_.width!==2*_.height)return void(0,i.log)(i.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const g=_.height/2,x=Math.log2(g);for(let T=0;T<x;++T)this.extractMipLevelFromAtlas(_,T);b()},u&&(_.crossOrigin="anonymous"),_.src=o})}calculateMipLevelSize(o){return this._size*Math.pow(.5,o)}data(o,u=0,b=!0,v=!0){const _=this.context.gl,g=this.context.gl2facade,x=this.calculateMipLevelSize(u);let T=x*x*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?T*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(T*=4),b&&this.bind(),o instanceof Array&&o.length===2){g.texImage2D(o[0],u,this._internalFormat,x,x,0,this._format,this._type,o[1]);const O=this.faceID(o[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[O]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[O]=T}else{const O=o;O.positiveX!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X,u,this._internalFormat,x,x,0,this._format,this._type,O.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[0]=T),O.negativeX!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_X,u,this._internalFormat,x,x,0,this._format,this._type,O.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[1]=T),O.positiveY!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Y,u,this._internalFormat,x,x,0,this._format,this._type,O.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[2]=T),O.negativeY!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,u,this._internalFormat,x,x,0,this._format,this._type,O.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[3]=T),O.positiveZ!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Z,u,this._internalFormat,x,x,0,this._format,this._type,O.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[4]=T),O.negativeZ!==void 0&&(g.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,u,this._internalFormat,x,x,0,this._format,this._type,O.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,T),this._bytes[5]=T)}v&&this.unbind()}filter(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,u),v&&this.unbind()}wrap(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_WRAP_T,u),v&&this.unbind()}levels(o,u,b=!0,v=!0){const _=this.context.gl;b&&this.bind(),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_BASE_LEVEL,o),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAX_LEVEL,u),v&&this.unbind()}reformat(o,u,b,v=!0,_=!0){(o!==this._internalFormat||u!==void 0&&u!==this._format||b!==void 0&&b!==this._type)&&((0,i.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,u&&(this._format=u),b&&(this._type=b),this.data({clearOnUndefined:!0},0,v,_))}resize(o,u=!0,b=!0){o!==this._size&&(this._size=o,this.data({clearOnUndefined:!0},0,u,b))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}r.TextureCube=f,f.DEFAULT_TEXTURE=void 0,n([p.Initializable.assert_initialized()],f.prototype,"bind",null),n([p.Initializable.assert_initialized()],f.prototype,"unbind",null),n([p.Initializable.assert_initialized()],f.prototype,"fetch",null),n([p.Initializable.assert_initialized()],f.prototype,"fetchMipmapAtlas",null),n([p.Initializable.assert_initialized()],f.prototype,"data",null),n([p.Initializable.assert_initialized()],f.prototype,"filter",null),n([p.Initializable.assert_initialized()],f.prototype,"wrap",null),n([p.Initializable.assert_initialized()],f.prototype,"levels",null),n([p.Initializable.assert_initialized()],f.prototype,"reformat",null),n([p.Initializable.assert_initialized()],f.prototype,"resize",null)},5608:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TileCameraGenerator=void 0;const n=a(3557),i=a(5150),h=a(9504);class p{constructor(){this._tileSize=[0,0],this._padding=n.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=p.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(f,s,o,u,b,v,_,g,x,T,O){if(T>0)return O=this.hilbertIndices(f,s,o,u,b,g/2,x/2,v/2,_/2,T-1,O),O=this.hilbertIndices(f,s,o,u+v/2,b+_/2,v/2,_/2,g/2,x/2,T-1,O),O=this.hilbertIndices(f,s,o,u+v/2+g/2,b+_/2+x/2,v/2,_/2,g/2,x/2,T-1,O),this.hilbertIndices(f,s,o,u+v/2+g,b+_/2+x,-g/2,-x/2,-v/2,-_/2,T-1,O);if(b+=(_+x-1)/2,(u+=(v+g-1)/2)<s&&b<o){const A=2*O;f[A+0]=u,f[A+1]=b,++O}return O}static generateHilbertIndices(f,s,o){(0,h.assert)(f.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${f.length}`);const u=Math.max(s,o),b=Math.ceil(Math.log2(u)),v=(0,h.upperPowerOfTwo)(u);this.hilbertIndices(f,s,o,0,0,v,0,0,v,b,0)}static generateScanLineIndices(f,s,o){(0,h.assert)(f.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${f.length}`);for(let u=0;u<o;++u)for(let b=0;b<s;++b){const v=2*(b+u*s);f[v+0]=b,f[v+1]=u}}static generateZCurveIndices(f,s,o){(0,h.assert)(f.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${f.length}`);const u=Math.max(s,o),b=2*Math.floor(Math.log2(u));let v=0;for(let _=0;_<s*o;++v){let g=0,x=0;for(let T=0;T<b;++T)g+=(v>>2*T&1)<<T,x+=(v>>2*T+1&1)<<T;if(g<s&&x<o){const T=2*_;f[T+0]=g,f[T+1]=x,++_}}}invalidate(f){f&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case p.Algorithm.ScanLine:p.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case p.Algorithm.HilbertCurve:p.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case p.Algorithm.ZCurve:p.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:p.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const f=2*this.tile;return[this._indices[f+0],this._indices[f+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){(0,h.assert)(this._sourceCamera!==void 0,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return(0,h.log)(h.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;(0,h.assert)(this._sourceViewport!==void 0&&this._sourceCamera!==void 0,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const f=this.tableIndices(),s=this.sourceViewport,o=this.getPaddedTileSize(),u=[0,0];u[0]=f[0]*this.tileSize[0]+o[0]/2,u[1]=f[1]*this.tileSize[1]+o[1]/2;const b=[0,0];b[0]=f[0]*this.tileSize[0],b[1]=f[1]*this.tileSize[1];const v=[2*u[0]/s[0]-1,2*u[1]/s[1]-1],_=n.vec3.fromValues(s[0]/o[0],s[1]/o[1],1),g=n.vec3.fromValues(-v[0],-v[1],0),x=n.mat4.scale((0,i.m4)(),n.mat4.identity((0,i.m4)()),_),T=n.mat4.translate((0,i.m4)(),x,g);return this._camera.postViewProjection=T,this._offset=b,b}get valid(){return this._camera!==void 0&&this._sourceCamera!==void 0&&this._valid}get numXTiles(){return(0,h.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return(0,h.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(f){f!==void 0?(this._sourceCamera=f,this._camera=Object.create(f),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(f){this._tile!==f&&(this._tile=f,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(f){this._sourceViewport!==void 0&&f!==void 0&&this._sourceViewport[0]===f[0]&&this._sourceViewport[1]===f[1]||(this._sourceViewport=f,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(f){this._tileSize[0]===f[0]&&this._tileSize[1]===f[1]||(this._tileSize=f,this.invalidate(!0))}get padding(){return this._padding}set padding(f){n.vec4.equals(this._padding,f)||(this._padding=n.vec4.clone(f),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(f){this._algorithm!==f&&(this._algorithm=f,this.invalidate(!0))}}r.TileCameraGenerator=p,function(d){(function(f){f.ScanLine="scanline",f.HilbertCurve="hilbertcurve",f.ZCurve="zcurve"})(d.Algorithm||(d.Algorithm={}))}(p||(r.TileCameraGenerator=p={}))},8870:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TouchEventProvider=void 0;const n=a(7032),i=a(9504);class h{constructor(d,f){(0,i.assert)(d!==void 0,`expected valid canvas element on initialization, given ${d}`),this._element=d,this._timeframe=f}preventDefaultOnEvent(d,f){(0,i.bitInBitfield)(this._preventDefaultMask,d)&&f.preventDefault()}preventDefault(...d){for(const f of d)(0,i.bitInBitfield)(this._preventDefaultMask,f)||(this._preventDefaultMask|=f)}allowDefault(...d){for(const f of d)(0,i.bitInBitfield)(this._preventDefaultMask,f)&&(this._preventDefaultMask&=~f)}observable(d){switch(d){case h.Type.Start:return this.start$;case h.Type.End:return this.end$;case h.Type.Move:return this.move$;case h.Type.Cancel:return this.cancel$}return(0,i.assert)(!1,"Encountered unknown touch event."),new n.Observable}get start$(){return this._startSubject===void 0&&(this._startSubject=new n.ReplaySubject(void 0,this._timeframe),this._startListener=d=>{this.preventDefaultOnEvent(h.Type.Start,d),this._startSubject.next(d)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return this._endSubject===void 0&&(this._endSubject=new n.ReplaySubject(void 0,this._timeframe),this._endListener=d=>{this.preventDefaultOnEvent(h.Type.End,d),this._endSubject.next(d)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=d=>{this.preventDefaultOnEvent(h.Type.Move,d),this._moveSubject.next(d)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new n.ReplaySubject(void 0,this._timeframe),this._cancelListener=d=>{this.preventDefaultOnEvent(h.Type.Cancel,d),this._cancelSubject.next(d)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}r.TouchEventProvider=h,function(p){(function(d){d[d.Start=1]="Start",d[d.End=2]="End",d[d.Move=4]="Move",d[d.Cancel=8]="Cancel"})(p.Type||(p.Type={}))}(h||(r.TouchEventProvider=h={}))},3151:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TrackballModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._rotation=n.mat4.create(),this._sensitivity=p.DEFAULT_SENSITIVITY}initiate(f){this._initialPoint=f}process(f){this._currentPoint=f;const s=n.vec2.subtract((0,i.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),n.vec2.copy(this._initialPoint,this._currentPoint);const o=n.vec3.sub((0,i.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(o,o);const u=n.vec3.normalize((0,i.v3)(),this._reference.up),b=n.vec3.cross((0,i.v3)(),o,u);n.vec3.scale(u,u,s[1]),n.vec3.scale(b,b,s[0]);const v=n.vec3.cross((0,i.v3)(),n.vec3.add((0,i.v3)(),u,b),o);n.vec3.normalize(v,v);const _=n.quat.setAxisAngle(n.quat.create(),v,n.vec2.len(s));n.mat4.multiply(this._rotation,this._rotation,n.mat4.fromQuat((0,i.m4)(),_)),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._reference.center);n.mat4.multiply(f,f,this._rotation),n.mat4.translate(f,f,n.vec3.negate((0,i.v3)(),this._reference.center));const s=n.vec3.transformMat4((0,i.v3)(),[0,1,0],this._rotation),o=n.vec3.transformMat4((0,i.v3)(),this._reference.eye,f);this._camera.up=s,this._camera.eye=o}set sensitivity(f){this._sensitivity=f}get sensitivity(){return this._sensitivity}}r.TrackballModifier=p,p.DEFAULT_SENSITIVITY=.002},2813:(l,r,a)=>{const n=a(3557),i=a(5150),h=a(9504);var p;(function(d){function f(u){return(0,h.assert)(u.length===2,`expected length of buffer to be 2, given ${u.length}`),[u[0],u[1]]}function s(u){return(0,h.assert)(u.length===3,`expected length of buffer to be 3, given ${u.length}`),[u[0],u[1],u[2]]}function o(u){return(0,h.assert)(u.length===4,`expected length of buffer to be 4, given ${u.length}`),[u[0],u[1],u[2],u[3]]}d.tuple2=f,d.tuple3=s,d.tuple4=o,d.clampf=function(u,b){const v=(0,i.clamp)(u,0,1);return(0,h.logIf)(b!==void 0&&u<0||u>1,h.LogLevel.Info,`${b} clamped to [${v}], given [${u}]`),v},d.clampf2=function(u,b){const v=n.vec2.fromValues(u[0],u[1]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1)&&((0,i.clamp2)(v,v,n.vec2.fromValues(0,0),n.vec2.fromValues(1,1)),(0,h.logIf)(b!==void 0,h.LogLevel.Info,`${b} clamped to [${v}], given [${u}]`)),f(v)},d.clampf3=function(u,b){const v=n.vec3.fromValues(u[0],u[1],u[2]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1||u[2]<0||u[2]>1)&&((0,i.clamp3)(v,v,n.vec3.fromValues(0,0,0),n.vec3.fromValues(1,1,1)),(0,h.logIf)(b!==void 0,h.LogLevel.Info,`${b} clamped to [${v}], given [${u}]`)),s(v)},d.clampf4=function(u,b){const v=n.vec4.fromValues(u[0],u[1],u[2],u[3]);return(u[0]<0||u[0]>1||u[1]<0||u[1]>1||u[2]<0||u[2]>1||u[3]<0||u[3]>1)&&((0,i.clamp4)(v,v,n.vec4.fromValues(0,0,0,0),n.vec4.fromValues(1,1,1,1)),(0,h.logIf)(b!==void 0,h.LogLevel.Info,`${b} clamped to [${v}], given [${u}]`)),o(v)},d.duplicate2=function(u){return[u[0],u[1]]},d.duplicate3=function(u){return[u[0],u[1],u[2]]},d.duplicate4=function(u){return[u[0],u[1],u[2],u[3]]},d.equals2=function(u,b){return u[0]===b[0]&&u[1]===b[1]},d.equals3=function(u,b){return u[0]===b[0]&&u[1]===b[1]&&u[2]===b[2]},d.equals4=function(u,b){return u[0]===b[0]&&u[1]===b[1]&&u[2]===b[2]&&u[3]===b[3]}})(p||(p={})),l.exports=p},9184:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TurntableModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._rotation=(0,i.m4)(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=(0,i.v3)(),this._sensitivity=p.DEFAULT_SENSITIVITY}initiate(f){Object.assign(this._reference,this._camera),this._initialPoint=f;const s=n.vec3.sub((0,i.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(s,s),this._xAxisScreenSpace=n.vec3.cross((0,i.v3)(),[0,1,0],s),this._azimuth=Math.acos(n.vec3.dot(s,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(f){this._currentPoint=f;const s=n.vec2.subtract((0,i.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),Number.isFinite(this._minAzimuth)&&(s[1]=Math.min(this._azimuth-this._minAzimuth,s[1])),Number.isFinite(this._maxAzimuth)&&(s[1]=Math.max(this._azimuth-this._maxAzimuth,s[1])),n.mat4.rotateY(this._rotation,(0,i.m4)(),s[0]),n.mat4.rotate(this._rotation,this._rotation,s[1],this._xAxisScreenSpace),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._reference.center);n.mat4.multiply(f,f,this._rotation),n.mat4.translate(f,f,n.vec3.negate((0,i.v3)(),this._reference.center));const s=n.vec3.transformMat4((0,i.v3)(),[0,1,0],this._rotation),o=n.vec3.transformMat4((0,i.v3)(),this._reference.eye,f);this._camera.up=s,this._camera.eye=o}set sensitivity(f){this._sensitivity=f}get sensitivity(){return this._sensitivity}}r.TurntableModifier=p,p.DEFAULT_SENSITIVITY=.002},216:function(l,r,a){var n=this&&this.__decorate||function(d,f,s,o){var u,b=arguments.length,v=b<3?f:o===null?o=Object.getOwnPropertyDescriptor(f,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,f,s,o);else for(var _=d.length-1;_>=0;_--)(u=d[_])&&(v=(b<3?u(v):b>3?u(f,s,v):u(f,s))||v);return b>3&&v&&Object.defineProperty(f,s,v),v};Object.defineProperty(r,"__esModule",{value:!0}),r.UnifiedBuffer=void 0;const i=a(7340),h=a(4127);class p extends h.Initializable{static updatesNeedMerge(f,s,o){return s.begin-f.end<o||o===-1}constructor(f,s,o,u=0,b){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(s),this._gpuBuffer=new i.Buffer(f,b),this._usage=o,this._mergeThreshold=u}mergeUpdatesLeft(f){let s=0;const o=this._updates[f];for(let u=f-1;u>=0;u--){const b=this._updates[u];if(!p.updatesNeedMerge(b,o,this._mergeThreshold))break;o.begin=Math.min(o.begin,b.begin),o.end=Math.max(o.end,b.end),s++}return this._updates.splice(f-s,s),s+1}mergeUpdatesRight(f){let s=0;const o=this._updates[f];for(let u=f+1;u<this._updates.length;u++){const b=this._updates[u];if(!p.updatesNeedMerge(o,b,this._mergeThreshold))break;o.begin=Math.min(o.begin,b.begin),o.end=Math.max(o.end,b.end),s++}return this._updates.splice(f+1,s),s+1}addUpdate(f){const s=this._updates.findIndex(o=>f.begin<o.begin);s===-1?(this._updates.push(f),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(s,0,f),this.mergeUpdatesRight(s),this.mergeUpdatesLeft(s))}initialize(f){return this._gpuBuffer.initialize(f)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(f,s,o,u=!1,b=0,v=0,_=!0,g=!0){this._gpuBuffer.attribEnable(f,s,o,u,b,v,_,g)}attribDisable(f,s=!0,o=!0){this._gpuBuffer.attribDisable(f,s,o)}mergeSubDataRanges(){let f=0;for(;f<this._updates.length;)f+=this.mergeUpdatesRight(f)}subData(f,s){let o;o=s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),new Uint8Array(this._cpuBuffer).set(o,f),this.addUpdate({begin:f,end:f+o.byteLength})}update(f=!1,s=!1){if(f&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const o=new Uint8Array(this._cpuBuffer);for(const u of this._updates){const b=o.subarray(u.begin,u.end);this._gpuBuffer.subData(u.begin,b)}}s&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(f){const s=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(f);const o=new Uint8Array(s).slice(0,f);new Uint8Array(this._cpuBuffer).set(o)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(f){this._usage=f}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(f){this._mergeThreshold=f}}r.UnifiedBuffer=p,n([h.Initializable.initialize()],p.prototype,"initialize",null),n([h.Initializable.uninitialize()],p.prototype,"uninitialize",null),n([h.Initializable.assert_initialized()],p.prototype,"bind",null),n([h.Initializable.assert_initialized()],p.prototype,"unbind",null),n([h.Initializable.assert_initialized()],p.prototype,"attribEnable",null),n([h.Initializable.assert_initialized()],p.prototype,"attribDisable",null),n([h.Initializable.assert_initialized()],p.prototype,"update",null)},4536:(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.version=r.commit=r.branch=void 0,r.branch="master",r.commit="08005ba3cdde715e0e81bf865bd6014b95d74922",r.version="v0.9.0"},5507:function(l,r,a){var n=this&&this.__decorate||function(f,s,o,u){var b,v=arguments.length,_=v<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(f,s,o,u);else for(var g=f.length-1;g>=0;g--)(b=f[g])&&(_=(v<3?b(_):v>3?b(s,o,_):b(s,o))||_);return v>3&&_&&Object.defineProperty(s,o,_),_};Object.defineProperty(r,"__esModule",{value:!0}),r.VertexArray=void 0;const i=a(9504),h=a(4127),p=a(9965);class d extends p.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(s,o){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const u=this.context.gl2facade;this._object=u.createVertexArray(),this._valid=this._object!==void 0,this._bind=()=>{u.bindVertexArray(this.object),this._buffersBound||(s(),this._buffersBound=!0)},this._unbind=()=>u.bindVertexArray(d.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>s(),this._unbind=()=>o(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?((0,i.assert)(this._object!==void 0,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}r.VertexArray=d,d.DEFAULT_VERTEX_ARRAY=void 0,n([h.Initializable.assert_initialized()],d.prototype,"bind",null),n([h.Initializable.assert_initialized()],d.prototype,"unbind",null)},7645:l=>{var r;(function(a){a.EventBlocker=class{constructor(n,i){if(this._blockListenerByEvent=new Map,this._element=n,i!==void 0)for(const h of i)this.block(h)}block(n){this._blockListenerByEvent.has(n)||(this._blockListenerByEvent.set(n,i=>(i.preventDefault(),i.stopPropagation(),!1)),this._element.addEventListener(n,this._blockListenerByEvent.get(n)))}unblock(n){this._blockListenerByEvent.has(n)&&(this._element.removeEventListener(n,this._blockListenerByEvent.get(n)),this._blockListenerByEvent.delete(n))}}})(r||(r={})),l.exports=r},6378:(l,r,a)=>{const n=a(9504);var i;(function(h){class p{static queryAndCacheAPI(){if(p._exit!==void 0)return;const f=window.document,s=[f.exitFullScreen,f.msExitFullscreen,f.mozCancelFullScreen,f.webkitExitFullscreen,void 0];let o=0;for(;o<s.length&&s[o]===void 0;++o);switch(o){case 0:p._exit=()=>f.exitFullScreen(),p._request=u=>u.requestFullscreen(),p._element=()=>f.fullscreenElement,p._event="fullscreenchange";break;case 1:p._exit=()=>f.msExitFullscreen(),p._request=u=>u.msRequestFullscreen(),p._element=()=>f.msFullscreenElement,p._event="msfullscreenchange";break;case 2:p._exit=()=>f.mozCancelFullScreen(),p._request=u=>u.mozRequestFullScreen(),p._element=()=>f.mozFullScreenElement,p._event="mozfullscreenchange";break;case 3:p._exit=()=>f.webkitExitFullscreen(),p._request=u=>u.webkitRequestFullscreen(),p._element=()=>f.webkitFullscreenElement,p._event="webkitfullscreenchange";break;default:(0,n.assert)(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return p._element()!==void 0&&p._element()!==null}static toggle(f,s){if(f===void 0)return;p.queryAndCacheAPI();const o=p.active();if(!o){const u=getComputedStyle(f);p._size[0]=u.width,p._size[1]=u.height}s&&s(),o?(p._callback=void 0,window.removeEventListener(p._event,p.removeEventListener),f.style.width=p._size[0],f.style.height=p._size[1]):(p._callback=s,window.addEventListener(p._event,p.addEventListener)),o?p._exit():p._request(f)}}p._size=["0","0"],p.addEventListener=()=>{window.removeEventListener(p._event,p.addEventListener),window.addEventListener(p._event,p.removeEventListener)},p.removeEventListener=()=>{p._callback&&(p._callback(),p._callback=void 0),window.removeEventListener(p._event,p.removeEventListener)},h.Fullscreen=p})(i||(i={})),l.exports=i},5109:function(l,r,a){var n=this&&this.__createBinding||(Object.create?function(Pe,De,Ue,lt){lt===void 0&&(lt=Ue);var Et=Object.getOwnPropertyDescriptor(De,Ue);Et&&!("get"in Et?!De.__esModule:Et.writable||Et.configurable)||(Et={enumerable:!0,get:function(){return De[Ue]}}),Object.defineProperty(Pe,lt,Et)}:function(Pe,De,Ue,lt){lt===void 0&&(lt=Ue),Pe[lt]=De[Ue]}),i=this&&this.__setModuleDefault||(Object.create?function(Pe,De){Object.defineProperty(Pe,"default",{enumerable:!0,value:De})}:function(Pe,De){Pe.default=De}),h=this&&this.__exportStar||function(Pe,De){for(var Ue in Pe)Ue==="default"||Object.prototype.hasOwnProperty.call(De,Ue)||n(De,Pe,Ue)},p=this&&this.__importStar||function(Pe){if(Pe&&Pe.__esModule)return Pe;var De={};if(Pe!=null)for(var Ue in Pe)Ue!=="default"&&Object.prototype.hasOwnProperty.call(Pe,Ue)&&n(De,Pe,Ue);return i(De,Pe),De};Object.defineProperty(r,"__esModule",{value:!0}),r.KernelF32=r.RandomSquareKernel=r.AntiAliasingKernel=r.AbstractKernel=r.NdcFillingTriangle=r.NdcFillingRectangle=r.CanvasRecorder=r.WheelZoomModifier=r.PinchZoomModifier=r.TurntableModifier=r.TrackballModifier=r.PointerLock=r.PanModifier=r.FirstPersonModifier=r.Navigation=r.CameraModifier=r.TileCameraGenerator=r.Camera=r.Wizard=r.VertexArray=r.UnifiedBuffer=r.TextureCube=r.Texture2DArray=r.Texture3D=r.Texture2D=r.Shader=r.LoadingStatus=r.Renderer=r.Renderbuffer=r.Program=r.Geometry=r.Framebuffer=r.DefaultFramebuffer=r.ColorScale=r.Color=r.Buffer=r.EventHandler=r.PointerEventProvider=r.TouchEventProvider=r.MouseEventProvider=r.ChangeLookup=r.ExtensionsHash=r.ContextMasquerade=r.Initializable=r.Controller=r.Canvas=r.Context=r.version=r.commit=r.branch=void 0,r.tuples=r.gl_matrix_extensions=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.vec4=r.vec3=r.vec2=r.auxiliaries=r.FrameCapture=r.EyeGazeData=r.EyeGazeEventProvider=r.EyeGazeDataStreams=r.EyeGazeDataStream=r.ShadowPass=r.GaussFilter=r.ReadbackPass=r.EnvironmentTextureType=r.EnvironmentRenderingPass=r.DebugPass=r.BlitPass=r.AccumulatePass=r.KernelUI8=r.KernelUI32=r.KernelI8=r.KernelI32=void 0;var d=a(4536);Object.defineProperty(r,"branch",{enumerable:!0,get:function(){return d.branch}}),Object.defineProperty(r,"commit",{enumerable:!0,get:function(){return d.commit}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return d.version}});var f=a(2527);Object.defineProperty(r,"Context",{enumerable:!0,get:function(){return f.Context}});var s=a(7858);Object.defineProperty(r,"Canvas",{enumerable:!0,get:function(){return s.Canvas}});var o=a(8234);Object.defineProperty(r,"Controller",{enumerable:!0,get:function(){return o.Controller}});var u=a(4127);Object.defineProperty(r,"Initializable",{enumerable:!0,get:function(){return u.Initializable}});var b=a(5557);Object.defineProperty(r,"ContextMasquerade",{enumerable:!0,get:function(){return b.ContextMasquerade}});var v=a(5060);Object.defineProperty(r,"ExtensionsHash",{enumerable:!0,get:function(){return v.ExtensionsHash}});var _=a(7564);Object.defineProperty(r,"ChangeLookup",{enumerable:!0,get:function(){return _.ChangeLookup}});var g=a(4602);Object.defineProperty(r,"MouseEventProvider",{enumerable:!0,get:function(){return g.MouseEventProvider}});var x=a(8870);Object.defineProperty(r,"TouchEventProvider",{enumerable:!0,get:function(){return x.TouchEventProvider}});var T=a(8216);Object.defineProperty(r,"PointerEventProvider",{enumerable:!0,get:function(){return T.PointerEventProvider}});var O=a(2);Object.defineProperty(r,"EventHandler",{enumerable:!0,get:function(){return O.EventHandler}});var A=a(7340);Object.defineProperty(r,"Buffer",{enumerable:!0,get:function(){return A.Buffer}});var R=a(3847);Object.defineProperty(r,"Color",{enumerable:!0,get:function(){return R.Color}});var P=a(5837);Object.defineProperty(r,"ColorScale",{enumerable:!0,get:function(){return P.ColorScale}});var C=a(8386);Object.defineProperty(r,"DefaultFramebuffer",{enumerable:!0,get:function(){return C.DefaultFramebuffer}});var U=a(8215);Object.defineProperty(r,"Framebuffer",{enumerable:!0,get:function(){return U.Framebuffer}});var j=a(638);Object.defineProperty(r,"Geometry",{enumerable:!0,get:function(){return j.Geometry}});var k=a(4168);Object.defineProperty(r,"Program",{enumerable:!0,get:function(){return k.Program}});var $=a(8400);Object.defineProperty(r,"Renderbuffer",{enumerable:!0,get:function(){return $.Renderbuffer}});var Y=a(3105);Object.defineProperty(r,"Renderer",{enumerable:!0,get:function(){return Y.Renderer}}),Object.defineProperty(r,"LoadingStatus",{enumerable:!0,get:function(){return Y.LoadingStatus}});var Z=a(771);Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return Z.Shader}});var J=a(8593);Object.defineProperty(r,"Texture2D",{enumerable:!0,get:function(){return J.Texture2D}});var te=a(9584);Object.defineProperty(r,"Texture3D",{enumerable:!0,get:function(){return te.Texture3D}});var Q=a(7380);Object.defineProperty(r,"Texture2DArray",{enumerable:!0,get:function(){return Q.Texture2DArray}});var ie=a(5186);Object.defineProperty(r,"TextureCube",{enumerable:!0,get:function(){return ie.TextureCube}});var ce=a(216);Object.defineProperty(r,"UnifiedBuffer",{enumerable:!0,get:function(){return ce.UnifiedBuffer}});var de=a(5507);Object.defineProperty(r,"VertexArray",{enumerable:!0,get:function(){return de.VertexArray}});var me=a(9217);Object.defineProperty(r,"Wizard",{enumerable:!0,get:function(){return me.Wizard}});var xe=a(3025);Object.defineProperty(r,"Camera",{enumerable:!0,get:function(){return xe.Camera}});var Ce=a(5608);Object.defineProperty(r,"TileCameraGenerator",{enumerable:!0,get:function(){return Ce.TileCameraGenerator}});var se=a(7344);Object.defineProperty(r,"CameraModifier",{enumerable:!0,get:function(){return se.CameraModifier}});var we=a(4264);Object.defineProperty(r,"Navigation",{enumerable:!0,get:function(){return we.Navigation}});var Be=a(4850);Object.defineProperty(r,"FirstPersonModifier",{enumerable:!0,get:function(){return Be.FirstPersonModifier}});var ot=a(506);Object.defineProperty(r,"PanModifier",{enumerable:!0,get:function(){return ot.PanModifier}});var Qe=a(2010);Object.defineProperty(r,"PointerLock",{enumerable:!0,get:function(){return Qe.PointerLock}});var We=a(3151);Object.defineProperty(r,"TrackballModifier",{enumerable:!0,get:function(){return We.TrackballModifier}});var Ve=a(9184);Object.defineProperty(r,"TurntableModifier",{enumerable:!0,get:function(){return Ve.TurntableModifier}});var nt=a(5222);Object.defineProperty(r,"PinchZoomModifier",{enumerable:!0,get:function(){return nt.PinchZoomModifier}});var ir=a(7137);Object.defineProperty(r,"WheelZoomModifier",{enumerable:!0,get:function(){return ir.WheelZoomModifier}});var ut=a(8596);Object.defineProperty(r,"CanvasRecorder",{enumerable:!0,get:function(){return ut.CanvasRecorder}});var St=a(5491);Object.defineProperty(r,"NdcFillingRectangle",{enumerable:!0,get:function(){return St.NdcFillingRectangle}});var At=a(1896);Object.defineProperty(r,"NdcFillingTriangle",{enumerable:!0,get:function(){return At.NdcFillingTriangle}});var yt=a(4287);Object.defineProperty(r,"AbstractKernel",{enumerable:!0,get:function(){return yt.AbstractKernel}});var nr=a(2419);Object.defineProperty(r,"AntiAliasingKernel",{enumerable:!0,get:function(){return nr.AntiAliasingKernel}});var hi=a(3039);Object.defineProperty(r,"RandomSquareKernel",{enumerable:!0,get:function(){return hi.RandomSquareKernel}});var Ot=a(4287);Object.defineProperty(r,"KernelF32",{enumerable:!0,get:function(){return Ot.KernelF32}}),Object.defineProperty(r,"KernelI32",{enumerable:!0,get:function(){return Ot.KernelI32}}),Object.defineProperty(r,"KernelI8",{enumerable:!0,get:function(){return Ot.KernelI8}}),Object.defineProperty(r,"KernelUI32",{enumerable:!0,get:function(){return Ot.KernelUI32}}),Object.defineProperty(r,"KernelUI8",{enumerable:!0,get:function(){return Ot.KernelUI8}});var Jr=a(9017);Object.defineProperty(r,"AccumulatePass",{enumerable:!0,get:function(){return Jr.AccumulatePass}});var di=a(8196);Object.defineProperty(r,"BlitPass",{enumerable:!0,get:function(){return di.BlitPass}});var fi=a(3334);Object.defineProperty(r,"DebugPass",{enumerable:!0,get:function(){return fi.DebugPass}});var ei=a(6464);Object.defineProperty(r,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return ei.EnvironmentRenderingPass}}),Object.defineProperty(r,"EnvironmentTextureType",{enumerable:!0,get:function(){return ei.EnvironmentTextureType}});var _i=a(1900);Object.defineProperty(r,"ReadbackPass",{enumerable:!0,get:function(){return _i.ReadbackPass}});var pi=a(3395);Object.defineProperty(r,"GaussFilter",{enumerable:!0,get:function(){return pi.GaussFilter}});var vi=a(9011);Object.defineProperty(r,"ShadowPass",{enumerable:!0,get:function(){return vi.ShadowPass}});var ti=a(3404);Object.defineProperty(r,"EyeGazeDataStream",{enumerable:!0,get:function(){return ti.EyeGazeDataStream}}),Object.defineProperty(r,"EyeGazeDataStreams",{enumerable:!0,get:function(){return ti.EyeGazeDataStreams}});var mi=a(3975);Object.defineProperty(r,"EyeGazeEventProvider",{enumerable:!0,get:function(){return mi.EyeGazeEventProvider}});var bi=a(6662);Object.defineProperty(r,"EyeGazeData",{enumerable:!0,get:function(){return bi.EyeGazeData}});var ri=a(1215);Object.defineProperty(r,"FrameCapture",{enumerable:!0,get:function(){return ri.FrameCapture}}),h(a(1854),r),h(a(5315),r),h(a(1058),r);const gi=p(a(9504));r.auxiliaries=gi;var ar=a(3557);Object.defineProperty(r,"vec2",{enumerable:!0,get:function(){return ar.vec2}}),Object.defineProperty(r,"vec3",{enumerable:!0,get:function(){return ar.vec3}}),Object.defineProperty(r,"vec4",{enumerable:!0,get:function(){return ar.vec4}});var Zt=a(3557);Object.defineProperty(r,"mat2",{enumerable:!0,get:function(){return Zt.mat2}}),Object.defineProperty(r,"mat2d",{enumerable:!0,get:function(){return Zt.mat2d}}),Object.defineProperty(r,"mat3",{enumerable:!0,get:function(){return Zt.mat3}}),Object.defineProperty(r,"mat4",{enumerable:!0,get:function(){return Zt.mat4}});var yi=a(3557);Object.defineProperty(r,"quat",{enumerable:!0,get:function(){return yi.quat}});const Ei=p(a(5150));r.gl_matrix_extensions=Ei;const Ti=p(a(2813));r.tuples=Ti},8184:function(l,r,a){var n=this&&this.__createBinding||(Object.create?function(_,g,x,T){T===void 0&&(T=x);var O=Object.getOwnPropertyDescriptor(g,x);O&&!("get"in O?!g.__esModule:O.writable||O.configurable)||(O={enumerable:!0,get:function(){return g[x]}}),Object.defineProperty(_,T,O)}:function(_,g,x,T){T===void 0&&(T=x),_[T]=g[x]}),i=this&&this.__setModuleDefault||(Object.create?function(_,g){Object.defineProperty(_,"default",{enumerable:!0,value:g})}:function(_,g){_.default=g}),h=this&&this.__exportStar||function(_,g){for(var x in _)x==="default"||Object.prototype.hasOwnProperty.call(g,x)||n(g,_,x)},p=this&&this.__importStar||function(_){if(_&&_.__esModule)return _;var g={};if(_!=null)for(var x in _)x!=="default"&&Object.prototype.hasOwnProperty.call(_,x)&&n(g,_,x);return i(g,_),g};Object.defineProperty(r,"__esModule",{value:!0}),r.viewer=r.Benchmark=r.ray_math=r.fetch=r.properties=void 0,h(a(5109),r),h(a(8892),r);const d=p(a(1407));r.properties=d;const f=p(a(64));r.fetch=f;const s=p(a(8962));r.ray_math=s;var o=a(8263);Object.defineProperty(r,"Benchmark",{enumerable:!0,get:function(){return o.Benchmark}}),h(a(2016),r);const u=p(a(7645)),b=p(a(6378));var v;(function(_){_.EventBlocker=u.EventBlocker,_.Fullscreen=b.Fullscreen})(v||(r.viewer=v={}))},7137:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WheelZoomModifier=void 0;const n=a(3557),i=a(5150),h=a(7344);class p extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=p.DEFAULT_SENSITIVITY,this._translation=(0,i.v3)()}process(f){Object.assign(this._reference,this._camera);const s=f*this._sensitivity,o=n.vec3.sub((0,i.v3)(),this._reference.center,this._reference.eye);n.vec3.normalize(o,o),this._translation=n.vec3.scale((0,i.v3)(),o,s),this.update()}update(){if(this._camera===void 0)return;const f=n.mat4.fromTranslation((0,i.m4)(),this._translation),s=n.vec3.transformMat4((0,i.v3)(),this._reference.eye,f);this._camera.eye=s}}r.WheelZoomModifier=p,p.DEFAULT_SENSITIVITY=.002},9217:(l,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Wizard=void 0;const n=a(9504);class i{static queryPrecisionSupport(p,d){const f=p.gl,s=p.gl2facade,o=p.isWebGL1&&p.supportsTextureFloat||p.isWebGL2&&p.supportsColorBufferFloat,u=p.isWebGL1&&p.supportsTextureHalfFloat||p.isWebGL2&&p.supportsColorBufferFloat;let b=d;return d in i.Precision||((0,n.log)(n.LogLevel.Warning,`unknown precision '${b}' changed to '${i.Precision.auto}'`),d=i.Precision.auto),d===i.Precision.auto&&(b=o?i.Precision.float:u?i.Precision.half:i.Precision.byte),b===i.Precision.half&&u?(p.isWebGL2?p.colorBufferFloat:p.textureHalfFloat,[b,s.HALF_FLOAT,1]):b!==i.Precision.float&&b!==i.Precision.half||!o?[b,f.UNSIGNED_BYTE,2]:(p.isWebGL2?p.colorBufferFloat:p.textureFloat,[b,f.FLOAT,0])}static queryInternalTextureFormat(p,d,f=i.Precision.auto){const[s,o,u]=this.queryPrecisionSupport(p,f),b=p.gl;if(p.isWebGL1)return(0,n.assert)([b.RGB,b.RGBA].includes(d),"target must be gl.RGB or gl.RGBA in WebGL 1"),[d,o,s];switch(d){case b.RGBA:return[[b.RGBA32F,b.RGBA16F,b.RGBA8][u],o,s];case b.RGB:return[[b.RGB32F,b.RGB16F,b.RGB8][u],o,s];case b.RG:return[[b.RG32F,b.RG16F,b.RG8][u],o,s];case b.RED:return[[b.R32F,b.R16F,b.R8][u],o,s];default:(0,n.assert)(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[b.NONE,b.NONE,s]}}r.Wizard=i,function(h){(function(p){p.float="float",p.half="half",p.byte="byte",p.auto="auto"})(h.Precision||(h.Precision={}))}(i||(r.Wizard=i={}))},9983:(l,r,a)=>{var n=a(6751);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var h=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,f=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),s=["'"].concat(f),o=["%","/","?",";","#"].concat(s),u=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,v=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=a(8985);function O(A,R,P){if(A&&typeof A=="object"&&A instanceof i)return A;var C=new i;return C.parse(A,R,P),C}i.prototype.parse=function(A,R,P){if(typeof A!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof A);var C=A.indexOf("?"),U=C!==-1&&C<A.indexOf("#")?"?":"#",j=A.split(U);j[0]=j[0].replace(/\\/g,"/");var k=A=j.join(U);if(k=k.trim(),!P&&A.split("#").length===1){var $=d.exec(k);if($)return this.path=k,this.href=k,this.pathname=$[1],$[2]?(this.search=$[2],this.query=R?T.parse(this.search.substr(1)):this.search.substr(1)):R&&(this.search="",this.query={}),this}var Y=h.exec(k);if(Y){var Z=(Y=Y[0]).toLowerCase();this.protocol=Z,k=k.substr(Y.length)}if(P||Y||k.match(/^\/\/[^@/]+@[^@/]+/)){var J=k.substr(0,2)==="//";!J||Y&&g[Y]||(k=k.substr(2),this.slashes=!0)}if(!g[Y]&&(J||Y&&!x[Y])){for(var te,Q,ie=-1,ce=0;ce<u.length;ce++)(de=k.indexOf(u[ce]))!==-1&&(ie===-1||de<ie)&&(ie=de);for((Q=ie===-1?k.lastIndexOf("@"):k.lastIndexOf("@",ie))!==-1&&(te=k.slice(0,Q),k=k.slice(Q+1),this.auth=decodeURIComponent(te)),ie=-1,ce=0;ce<o.length;ce++){var de;(de=k.indexOf(o[ce]))!==-1&&(ie===-1||de<ie)&&(ie=de)}ie===-1&&(ie=k.length),this.host=k.slice(0,ie),k=k.slice(ie),this.parseHost(),this.hostname=this.hostname||"";var me=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!me)for(var xe=this.hostname.split(/\./),Ce=(ce=0,xe.length);ce<Ce;ce++){var se=xe[ce];if(se&&!se.match(b)){for(var we="",Be=0,ot=se.length;Be<ot;Be++)se.charCodeAt(Be)>127?we+="x":we+=se[Be];if(!we.match(b)){var Qe=xe.slice(0,ce),We=xe.slice(ce+1),Ve=se.match(v);Ve&&(Qe.push(Ve[1]),We.unshift(Ve[2])),We.length&&(k="/"+We.join(".")+k),this.hostname=Qe.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),me||(this.hostname=n.toASCII(this.hostname));var nt=this.port?":"+this.port:"",ir=this.hostname||"";this.host=ir+nt,this.href+=this.host,me&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),k[0]!=="/"&&(k="/"+k))}if(!_[Z])for(ce=0,Ce=s.length;ce<Ce;ce++){var ut=s[ce];if(k.indexOf(ut)!==-1){var St=encodeURIComponent(ut);St===ut&&(St=escape(ut)),k=k.split(ut).join(St)}}var At=k.indexOf("#");At!==-1&&(this.hash=k.substr(At),k=k.slice(0,At));var yt=k.indexOf("?");if(yt!==-1?(this.search=k.substr(yt),this.query=k.substr(yt+1),R&&(this.query=T.parse(this.query)),k=k.slice(0,yt)):R&&(this.search="",this.query={}),k&&(this.pathname=k),x[Z]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){nt=this.pathname||"";var nr=this.search||"";this.path=nt+nr}return this.href=this.format(),this},i.prototype.format=function(){var A=this.auth||"";A&&(A=(A=encodeURIComponent(A)).replace(/%3A/i,":"),A+="@");var R=this.protocol||"",P=this.pathname||"",C=this.hash||"",U=!1,j="";this.host?U=A+this.host:this.hostname&&(U=A+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(U+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(j=T.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var k=this.search||j&&"?"+j||"";return R&&R.substr(-1)!==":"&&(R+=":"),this.slashes||(!R||x[R])&&U!==!1?(U="//"+(U||""),P&&P.charAt(0)!=="/"&&(P="/"+P)):U||(U=""),C&&C.charAt(0)!=="#"&&(C="#"+C),k&&k.charAt(0)!=="?"&&(k="?"+k),R+U+(P=P.replace(/[?#]/g,function($){return encodeURIComponent($)}))+(k=k.replace("#","%23"))+C},i.prototype.resolve=function(A){return this.resolveObject(O(A,!1,!0)).format()},i.prototype.resolveObject=function(A){if(typeof A=="string"){var R=new i;R.parse(A,!1,!0),A=R}for(var P=new i,C=Object.keys(this),U=0;U<C.length;U++){var j=C[U];P[j]=this[j]}if(P.hash=A.hash,A.href==="")return P.href=P.format(),P;if(A.slashes&&!A.protocol){for(var k=Object.keys(A),$=0;$<k.length;$++){var Y=k[$];Y!=="protocol"&&(P[Y]=A[Y])}return x[P.protocol]&&P.hostname&&!P.pathname&&(P.pathname="/",P.path=P.pathname),P.href=P.format(),P}if(A.protocol&&A.protocol!==P.protocol){if(!x[A.protocol]){for(var Z=Object.keys(A),J=0;J<Z.length;J++){var te=Z[J];P[te]=A[te]}return P.href=P.format(),P}if(P.protocol=A.protocol,A.host||g[A.protocol])P.pathname=A.pathname;else{for(var Q=(A.pathname||"").split("/");Q.length&&!(A.host=Q.shift()););A.host||(A.host=""),A.hostname||(A.hostname=""),Q[0]!==""&&Q.unshift(""),Q.length<2&&Q.unshift(""),P.pathname=Q.join("/")}if(P.search=A.search,P.query=A.query,P.host=A.host||"",P.auth=A.auth,P.hostname=A.hostname||A.host,P.port=A.port,P.pathname||P.search){var ie=P.pathname||"",ce=P.search||"";P.path=ie+ce}return P.slashes=P.slashes||A.slashes,P.href=P.format(),P}var de=P.pathname&&P.pathname.charAt(0)==="/",me=A.host||A.pathname&&A.pathname.charAt(0)==="/",xe=me||de||P.host&&A.pathname,Ce=xe,se=P.pathname&&P.pathname.split("/")||[],we=(Q=A.pathname&&A.pathname.split("/")||[],P.protocol&&!x[P.protocol]);if(we&&(P.hostname="",P.port=null,P.host&&(se[0]===""?se[0]=P.host:se.unshift(P.host)),P.host="",A.protocol&&(A.hostname=null,A.port=null,A.host&&(Q[0]===""?Q[0]=A.host:Q.unshift(A.host)),A.host=null),xe=xe&&(Q[0]===""||se[0]==="")),me)P.host=A.host||A.host===""?A.host:P.host,P.hostname=A.hostname||A.hostname===""?A.hostname:P.hostname,P.search=A.search,P.query=A.query,se=Q;else if(Q.length)se||(se=[]),se.pop(),se=se.concat(Q),P.search=A.search,P.query=A.query;else if(A.search!=null)return we&&(P.host=se.shift(),P.hostname=P.host,(Ve=!!(P.host&&P.host.indexOf("@")>0)&&P.host.split("@"))&&(P.auth=Ve.shift(),P.hostname=Ve.shift(),P.host=P.hostname)),P.search=A.search,P.query=A.query,P.pathname===null&&P.search===null||(P.path=(P.pathname?P.pathname:"")+(P.search?P.search:"")),P.href=P.format(),P;if(!se.length)return P.pathname=null,P.search?P.path="/"+P.search:P.path=null,P.href=P.format(),P;for(var Be=se.slice(-1)[0],ot=(P.host||A.host||se.length>1)&&(Be==="."||Be==="..")||Be==="",Qe=0,We=se.length;We>=0;We--)(Be=se[We])==="."?se.splice(We,1):Be===".."?(se.splice(We,1),Qe++):Qe&&(se.splice(We,1),Qe--);if(!xe&&!Ce)for(;Qe--;Qe)se.unshift("..");!xe||se[0]===""||se[0]&&se[0].charAt(0)==="/"||se.unshift(""),ot&&se.join("/").substr(-1)!=="/"&&se.push("");var Ve,nt=se[0]===""||se[0]&&se[0].charAt(0)==="/";return we&&(P.hostname=nt?"":se.length?se.shift():"",P.host=P.hostname,(Ve=!!(P.host&&P.host.indexOf("@")>0)&&P.host.split("@"))&&(P.auth=Ve.shift(),P.hostname=Ve.shift(),P.host=P.hostname)),(xe=xe||P.host&&se.length)&&!nt&&se.unshift(""),se.length>0?P.pathname=se.join("/"):(P.pathname=null,P.path=null),P.pathname===null&&P.search===null||(P.path=(P.pathname?P.pathname:"")+(P.search?P.search:"")),P.auth=A.auth||P.auth,P.slashes=P.slashes||A.slashes,P.href=P.format(),P},i.prototype.parseHost=function(){var A=this.host,R=p.exec(A);R&&((R=R[0])!==":"&&(this.port=R.substr(1)),A=A.substr(0,A.length-R.length)),A&&(this.hostname=A)},r.parse=O,r.resolve=function(A,R){return O(A,!1,!0).resolve(R)},r.resolveObject=function(A,R){return A?O(A,!1,!0).resolveObject(R):R},r.format=function(A){return typeof A=="string"&&(A=O(A)),A instanceof i?A.format():i.prototype.format.call(A)},r.Url=i},6296:l=>{l.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
    #extension GL_OES_standard_derivatives : enable\r
#else \r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
uniform int u_frameNumber;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r
    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r
\r
    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r
    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r
    if(!any(bvec2(cstep))) {\r
        discard;\r
    }\r
    fragColor = vec4(color, 1.0); \r
}\r
`},5077:l=>{l.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else \r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec2 u_ndcOffset;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex.xy * 0.5 + 0.5;\r
\r
    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r
    ndcOffset(vertex, u_ndcOffset);\r
\r
    gl_Position = vertex;\r
}\r
`},5347:l=>{l.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
// References:\r
// [1] Real Shading in Unreal Engine 4\r
//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r
// [2] Physically Based Shading at Disney\r
//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r
// [3] README.md - Environment Maps\r
//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r
// [4] "An Inexpensive BRDF Model for Physically based Rendering" by Christophe Schlick\r
//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
const int USE_IBL               = 1 << 4;\r
const int HAS_BASECOLORMAP      = 1 << 5;\r
const int HAS_NORMALMAP         = 1 << 6;\r
const int HAS_EMISSIVEMAP       = 1 << 7;\r
const int HAS_METALROUGHNESSMAP = 1 << 8;\r
const int HAS_OCCLUSIONMAP      = 1 << 9;\r
const int USE_TEX_LOD           = 1 << 10;\r
\r
const vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\r
const vec3 u_LightColor = vec3(1, 1, 1);\r
\r
const float M_PI = 3.141592653589793;\r
const float c_MinRoughness = 0.04;\r
\r
uniform sampler2D u_baseColor;\r
uniform sampler2D u_metallicRoughness;\r
uniform sampler2D u_normal;\r
uniform sampler2D u_emissive;\r
uniform sampler2D u_occlusion;\r
\r
uniform samplerCube u_specularEnvironment;\r
uniform sampler2D u_brdfLUT;\r
\r
uniform int u_baseColorTexCoord;\r
uniform int u_normalTexCoord;\r
uniform int u_metallicRoughnessTexCoord;\r
uniform int u_occlusionTexCoord;\r
uniform int u_emissiveTexCoord;\r
\r
uniform vec4 u_baseColorFactor;\r
uniform float u_metallicFactor;\r
uniform float u_roughnessFactor;\r
uniform vec3 u_emissiveFactor;\r
uniform float u_normalScale;\r
uniform int u_blendMode;\r
uniform float u_blendCutoff;\r
\r
uniform mediump int u_geometryFlags;\r
uniform mediump int u_pbrFlags;\r
uniform vec3 u_eye;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
// Encapsulate the various inputs used by the various functions in the shading equation\r
// We store values in this struct to simplify the integration of alternative implementations\r
// of the shading terms, outlined in the Readme.MD Appendix.\r
struct PBRInfo\r
{\r
    float NdotL;                  // cos angle between normal and light direction\r
    float NdotV;                  // cos angle between normal and view direction\r
    float NdotH;                  // cos angle between normal and half vector\r
    float LdotH;                  // cos angle between light direction and half vector\r
    float VdotH;                  // cos angle between view direction and half vector\r
    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r
    float metalness;              // metallic value at the surface\r
    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r
    vec3 reflectance90;           // reflectance color at grazing angle\r
    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r
    vec3 diffuseColor;            // color contribution from diffuse lighting\r
    vec3 specularColor;           // color contribution from specular lighting\r
};\r
\r
bool checkGeometryFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
bool checkFlag(int flag) {\r
    return (u_pbrFlags & flag) == flag;\r
}\r
\r
vec4 SRGBtoLINEAR(vec4 srgbIn)\r
{\r
    #ifdef MANUAL_SRGB\r
    #ifdef SRGB_FAST_APPROXIMATION\r
    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r
    #else //SRGB_FAST_APPROXIMATION\r
    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r
    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r
    #endif //SRGB_FAST_APPROXIMATION\r
    return vec4(linOut,srgbIn.w);;\r
    #else //MANUAL_SRGB\r
    return srgbIn;\r
    #endif //MANUAL_SRGB\r
}\r
\r
// Find the normal for this fragment, pulling either from a predefined normal map\r
// or from the interpolated mesh normal and tangent attributes.\r
vec3 getNormal()\r
{\r
    // Retrieve the tangent space matrix\r
    mat3 tbn;\r
    if (!checkGeometryFlag(HAS_TANGENTS)) {\r
        vec3 pos_dx = dFdx(v_position);\r
        vec3 pos_dy = dFdy(v_position);\r
        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\r
        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\r
        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r
\r
        vec3 ng;\r
        if (checkGeometryFlag(HAS_NORMALS))\r
            ng = normalize(v_normal);\r
        else\r
            ng = cross(pos_dx, pos_dy);\r
\r
            t = normalize(t - ng * dot(ng, t));\r
            vec3 b = normalize(cross(ng, t));\r
            tbn = mat3(t, b, ng);\r
        }\r
    else { // HAS_TANGENTS\r
        tbn = v_TBN;\r
    }\r
\r
    vec3 n;\r
    if (checkFlag(HAS_NORMALMAP)) {\r
        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\r
        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\r
    } else {\r
        // The tbn matrix is linearly interpolated, so we need to re-normalize\r
        n = normalize(tbn[2].xyz);\r
    }\r
\r
    // reverse backface normals\r
    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r
\r
    return n;\r
}\r
\r
// Basic Lambertian diffuse\r
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r
// See also [1], Equation 1\r
vec3 diffuse(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.diffuseColor / M_PI;\r
}\r
\r
 // The following equation models the Fresnel reflectance term of the spec equation (aka F())\r
// Implementation of fresnel from [4], Equation 15\r
vec3 specularReflection(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r
}\r
\r
 // This calculates the specular geometric attenuation (aka G()),\r
// where rougher material will reflect less light back to the viewer.\r
// This implementation is based on [1] Equation 4, and we adopt their modifications to\r
// alphaRoughness as input as originally proposed in [2].\r
float geometricOcclusion(PBRInfo pbrInputs)\r
{\r
    float NdotL = pbrInputs.NdotL;\r
    float NdotV = pbrInputs.NdotV;\r
    float r = pbrInputs.alphaRoughness;\r
\r
    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r
    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r
    return attenuationL * attenuationV;\r
}\r
\r
 // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r
// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\r
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r
float microfacetDistribution(PBRInfo pbrInputs)\r
{\r
    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r
    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r
    return roughnessSq / (M_PI * f * f);\r
}\r
\r
vec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\r
{\r
    float NdotV = clamp(dot(n, v), 0.0, 1.0);\r
\r
    // TODO: pass uniform for mip count\r
    const float MIP_COUNT = 8.0;\r
    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\r
    vec3 reflection = normalize(reflect(-v, n));\r
\r
    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\r
    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\r
\r
    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\r
    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\r
\r
    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\r
    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\r
\r
    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\r
    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\r
\r
    return specular;\r
    // return diffuse + specular;\r
}\r
\r
void main(void)\r
{\r
    float perceptualRoughness = u_roughnessFactor;\r
    float metallic = u_metallicFactor;\r
    if (checkFlag(HAS_METALROUGHNESSMAP)) {\r
        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r
        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r
        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\r
        perceptualRoughness = mrSample.g * perceptualRoughness;\r
        metallic = mrSample.b * metallic;\r
    }\r
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r
    metallic = clamp(metallic, 0.0, 1.0);\r
    // Roughness is authored as perceptual roughness; as is convention,\r
    // convert to material roughness by squaring the perceptual roughness [2].\r
    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r
\r
     // The albedo may be defined from a base texture or a flat color\r
    vec4 baseColor;\r
    if (checkFlag(HAS_BASECOLORMAP)) {\r
        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\r
    } else {\r
        baseColor = u_baseColorFactor;\r
    }\r
\r
    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r
    // TODO!: distinguish vec3/vec4 colors...\r
    baseColor *= vec4(v_color.rgb, 1.0);\r
\r
    vec3 f0 = vec3(0.04);\r
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r
    diffuseColor *= 1.0 - metallic;\r
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r
\r
    // Compute reflectance.\r
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r
\r
    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r
    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r
    vec3 specularEnvironmentR0 = specularColor.rgb;\r
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r
\r
    vec3 n = getNormal();                         // normal at surface point\r
    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\r
    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\r
    vec3 h = normalize(l+v);                       // Half vector between both l and v\r
    vec3 reflection = -normalize(reflect(v, n));\r
\r
    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r
    float NdotV = abs(dot(n, v)) + 0.001;\r
    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r
    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r
    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r
\r
    PBRInfo pbrInputs = PBRInfo(\r
        NdotL,\r
        NdotV,\r
        NdotH,\r
        LdotH,\r
        VdotH,\r
        perceptualRoughness,\r
        metallic,\r
        specularEnvironmentR0,\r
        specularEnvironmentR90,\r
        alphaRoughness,\r
        diffuseColor,\r
        specularColor\r
    );\r
\r
     // Calculate the shading terms for the microfacet specular shading model\r
    vec3 F = specularReflection(pbrInputs);\r
    float G = geometricOcclusion(pbrInputs);\r
    float D = microfacetDistribution(pbrInputs);\r
\r
     // Calculation of analytical lighting contribution\r
    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r
    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r
    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r
    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r
\r
    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\r
    color += environmentLight;\r
\r
    if (checkFlag(HAS_EMISSIVEMAP)) {\r
        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\r
        color += emissive;\r
    }\r
\r
    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r
    float alpha = 1.0;\r
    if (u_blendMode == 1) {\r
        if (baseColor.a < u_blendCutoff) {\r
            discard;\r
        }\r
    }\r
    else if (u_blendMode == 2) {\r
        alpha = baseColor.a;\r
    }\r
\r
    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\r
}\r
`},6626:l=>{l.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
\r
#if __VERSION__ == 100\r
    attribute vec4 a_position;\r
    attribute vec4 a_normal;\r
    attribute vec4 a_tangent;\r
    attribute vec2 a_texcoord_0;\r
    attribute vec2 a_texcoord_1;\r
    attribute vec2 a_texcoord_2;\r
    attribute vec4 a_joints;\r
    attribute vec4 a_weights;\r
    attribute vec4 a_color;\r
#else\r
    layout (location = 0) in vec4 a_position;\r
    layout (location = 1) in vec3 a_normal;\r
    layout (location = 2) in vec4 a_tangent;\r
    layout (location = 3) in vec2 a_texcoord_0;\r
    layout (location = 4) in vec2 a_texcoord_1;\r
    layout (location = 5) in vec2 a_texcoord_2;\r
    layout (location = 6) in vec4 a_joints;\r
    layout (location = 7) in vec4 a_weights;\r
    layout (location = 8) in vec4 a_color;\r
#endif\r
\r
uniform mat4 u_model;\r
uniform mat4 u_viewProjection;\r
uniform mat3 u_normalMatrix;\r
\r
uniform mediump int u_geometryFlags;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
bool checkFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
void main(void)\r
{\r
    vec4 pos = u_model * a_position;\r
    v_position = vec3(pos.xyz) / pos.w;\r
\r
    if (checkFlag(HAS_NORMALS)) {\r
        if (checkFlag(HAS_TANGENTS)) {\r
            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\r
            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\r
            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r
            v_TBN = mat3(tangentW, bitangentW, normalW);\r
        } else { // HAS_TANGENTS != 1\r
            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\r
        }\r
    }\r
\r
    if (checkFlag(HAS_UV)) {\r
        v_uv[0] = a_texcoord_0;\r
        v_uv[1] = a_texcoord_1;\r
        v_uv[2] = a_texcoord_2;\r
    } else {\r
        v_uv[0] = vec2(0., 0.);\r
        v_uv[1] = vec2(0., 0.);\r
        v_uv[2] = vec2(0., 0.);\r
    }\r
\r
    if (checkFlag(HAS_COLORS)) {\r
        v_color = a_color;\r
    } else {\r
        v_color = vec4(1.0);\r
    }\r
\r
    gl_Position = u_viewProjection * u_model * a_position;\r
}\r
`},8058:l=>{l.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weight;\r
uniform sampler2D u_accumulationTexture;\r
uniform sampler2D u_currentFrameTexture;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r
    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r
    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r
}\r
`},6523:l=>{l.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    fragColor = texture(u_source, v_uv);\r
}\r
`},3354:l=>{l.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec4 u_srcBounds; // normalized\r
uniform vec4 u_dstBounds; // normalized\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = a_vertex * 0.5 + 0.5;\r
\r
    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\r
    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\r
}\r
`},8359:l=>{l.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
float linearizeDepth(float zInNDC, float near, float far) {\r
    float zLinear = 2.0 * near;\r
    zLinear /= far + near - zInNDC * (far - near);\r
    return zLinear;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
uniform int u_mode; /* Debug mode. */\r
uniform vec2 u_linearize; /* [ zNear, zFar ] */\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 source = texture(u_source, v_uv);\r
\r
    /* u_mode == 0                 None */\r
\r
    if(u_mode == 1) {           /* Depth */\r
        source.rgb = vec3(source[0]);\r
\r
    } else if (u_mode == 2) {   /* DepthLinear */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = vec3(zLinear);\r
\r
    } else if(u_mode == 3) {    /* DepthPacked */\r
        source.rgb = float24x1_to_uint8x3(source[0]);\r
\r
    } else if (u_mode == 4) {   /* DepthLinearPacked */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = float24x1_to_uint8x3(zLinear);\r
    }\r
\r
    fragColor = source;\r
}\r
`},9196:l=>{l.exports=`precision highp float;\r
precision highp int;\r
\r
/**\r
  To be replaced via Shader.replace();\r
 */\r
#define PROJECTION_TYPE\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform int u_mode;\r
uniform bool u_skipLod;\r
\r
#if defined(CUBE_MAP)\r
    uniform samplerCube u_cubemap;\r
#elif defined(EQUI_MAP)\r
    uniform sampler2D u_equirectmap;\r
#elif defined(SPHERE_MAP)\r
    uniform sampler2D u_spheremap;\r
#elif defined(POLAR_MAP)\r
    uniform sampler2D u_polarmap[2];\r
#endif\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
const float PI = 3.141592653589793;\r
const float OneOver2PI = 0.1591549430918953357688837633725;\r
const float OneOverPI  = 0.3183098861837906715377675267450;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = v_uv;\r
    vec3 ray = normalize(v_ray.xyz);\r
\r
    #if defined(CUBE_MAP)\r
        #if __VERSION__ == 100\r
            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\r
        #else\r
            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\r
        #endif\r
    #endif\r
\r
    #if defined(EQUI_MAP)\r
        float v = acos(-ray.y) * OneOverPI;\r
        float m = atan(-ray.x, ray.z);\r
        uv = vec2(m * OneOver2PI + 0.5, v);\r
\r
        fragColor = texture(u_equirectmap, uv);\r
    #endif\r
\r
    #if defined(SPHERE_MAP)\r
        ray = -ray.xzy;\r
        ray.y *= -1.0;\r
        ray.z += +1.0;\r
        uv = 0.5 + 0.5 * ray.xy / length(ray);\r
\r
        fragColor = texture(u_spheremap, uv);\r
    #endif\r
\r
    #if defined(POLAR_MAP)\r
        ray.xz /= abs(ray.y) + 1.0;\r
        ray.xz = ray.xz * 0.5 + 0.5;\r
        ray.x *= -1.0;\r
\r
        fragColor = mix(texture(u_polarmap[1], ray.xz),\r
                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\r
                        step(0.0, ray.y));\r
    #endif\r
}\r
`},3761:l=>{l.exports=`precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    in vec2 a_vertex;\r
#endif\r
\r
\r
uniform mat4 u_viewProjectionInverse;\r
\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\r
\r
    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\r
}\r
`},1687:l=>{l.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  #define fragColor gl_FragColor\r
#else\r
  layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weights[32];\r
uniform vec2 u_delta;\r
\r
uniform sampler2D u_texture;\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\r
    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\r
    {\r
        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\r
        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\r
    }\r
\r
    fragColor = result;\r
}\r
`},9214:l=>{l.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  attribute vec2 a_vertex;\r
#else\r
  layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    v_texCoords = a_vertex * 0.5 + 0.5;\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},9657:l=>{l.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},688:l=>{l.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragDepth gl_FragColor\r
#else \r
    layout(location = 0) out vec4 fragDepth;\r
#endif\r
\r
\r
uniform sampler2D u_texture;\r
uniform vec2 u_offset;\r
uniform vec2 u_scale;\r
\r
varying vec2 v_uv;\r
\r
\r
\r
void main(void)\r
{\r
    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r
    float depth = texture(u_texture, uv).r;\r
\r
    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r
}\r
`},5389:l=>{l.exports=`precision mediump float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
\r
    #ifdef GL_OES_standard_derivatives\r
        #extension GL_OES_standard_derivatives : enable\r
        #define AASTEP\r
    #endif\r
\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
\r
    #define AASTEP\r
\r
#endif\r
\r
\r
uniform sampler2D u_glyphs;\r
uniform vec4 u_color;\r
uniform float u_aaStepScale;\r
uniform int u_aaSampling;\r
\r
varying vec2 v_uv;\r
\r
const int channel = 0;\r
\r
\r
float aastep(float t, float value)\r
{\r
#ifdef AASTEP\r
    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\r
    float afwidth = fwidth(value) * u_aaStepScale;\r
    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\r
     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\r
     */\r
\r
    return smoothstep(t - afwidth, t + afwidth, value);\r
#else\r
    return step(t, value);\r
#endif\r
}\r
\r
float texStep(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return step(t, distanceValue);\r
}\r
\r
float texSmooth(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return aastep(t, distanceValue);\r
}\r
\r
#ifdef AASTEP\r
\r
float aastep3h(float t, vec2 uv)\r
{\r
    float x = dFdy(uv.x) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( -x, 0.0))\r
            + texSmooth(t, uv + vec2(0.0, 0.0))\r
            + texSmooth(t, uv + vec2( +x, 0.0));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3v(float t, vec2 uv)\r
{\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( 0.0,  -y))\r
            + texSmooth(t, uv + vec2( 0.0, 0.0))\r
            + texSmooth(t, uv + vec2( 0.0,  +y));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3x3(float t, vec2 uv)\r
{\r
    float x = dFdx(uv.x) * 1.0 / 3.0;\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\r
            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\r
            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\r
\r
    return v / 9.0;\r
}\r
\r
float aastep4x4(float t, vec2 uv)\r
{\r
    float x0 = dFdx(uv.x);\r
    float y0 = dFdx(uv.y);\r
    float x1 = x0 * 1.0 / 8.0;\r
    float y1 = y0 * 1.0 / 8.0;\r
    float x2 = x0 * 3.0 / 8.0;\r
    float y2 = y0 * 3.0 / 8.0;\r
\r
    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\r
            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\r
\r
            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\r
            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\r
            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\r
            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\r
\r
    return v / 16.0;\r
}\r
\r
// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\r
// {\r
//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\r
// }\r
\r
#endif\r
\r
void main(void)\r
{\r
    /** @todo mipmap access? */\r
\r
    float a = 0.0;\r
    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\r
#ifdef AASTEP\r
    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\r
#endif\r
\r
        a = texStep(0.5, v_uv);\r
\r
#ifdef AASTEP\r
    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\r
        a = texSmooth(0.5, v_uv);\r
    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\r
        a = aastep3h(0.5, v_uv);\r
    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\r
        a = aastep3v(0.5, v_uv);\r
    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\r
        a = aastep3x3(0.5, v_uv);\r
    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\r
        a = aastep4x4(0.5, v_uv);\r
    }\r
#endif\r
\r
    /**\r
     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\r
     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\r
     * it's bad for IMR, TBR, TBDR and early-Z optimization\r
     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\r
     */\r
    if(a <= 0.0) {\r
        discard;\r
    }\r
    fragColor = vec4(u_color.rgb, u_color.a * a);\r
\r
    /* use when pre-multiplied color is required. */\r
    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\r
}\r
`},1616:l=>{l.exports=`precision mediump float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
\r
#extension GL_EXT_draw_buffers : enable\r
attribute vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ] */\r
attribute vec4 a_texCoord;\r
attribute vec3 a_origin;\r
attribute vec3 a_tangent;\r
attribute vec3 a_up;\r
\r
#else\r
\r
in vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ]*/\r
in vec4 a_texCoord;\r
in vec3 a_origin;\r
in vec3 a_tangent;\r
in vec3 a_up;\r
\r
#endif\r
\r
\r
uniform mat4 u_viewProjection;\r
uniform vec2 u_ndcOffset;\r
uniform mat4 u_transform;\r
uniform bool u_dynamic;\r
\r
varying vec2 v_uv;\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
void main(void)\r
{\r
    /* TEXTURE COORDS */\r
\r
    /* flip y-coordinates */\r
    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\r
\r
    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\r
\r
    /* POSITIONING */\r
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\r
     * 2-------4\r
     * |  \\    |\r
     * |    \\  |\r
     * 1-------3\r
     * The current vertex is calculated based on the current quad corners and the tangent attributes.\r
     * The following lines are optimized for MAD optimization.\r
     */\r
    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\r
    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\r
\r
    if(u_dynamic) {\r
        vertex = u_transform * vertex;\r
    }\r
    vertex = u_viewProjection * vertex;\r
\r
    ndcOffset(vertex, u_ndcOffset);\r
    gl_Position = vertex;\r
}\r
`},7032:l=>{l.exports=sb()},421:l=>{l.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},3058:l=>{l.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},6399:l=>{l.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},9148:l=>{l.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},7857:l=>{l.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')}},t={};function m(l){var r=t[l];if(r!==void 0)return r.exports;var a=t[l]={exports:{}};return E[l].call(a.exports,a,a.exports,m),a.exports}m.d=(l,r)=>{for(var a in r)m.o(r,a)&&!m.o(l,a)&&Object.defineProperty(l,a,{enumerable:!0,get:r[a]})},m.o=(l,r)=>Object.prototype.hasOwnProperty.call(l,r),m.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},m(4985);var y=m(8184);rl.exports=y})()),rl.exports}var N=ob();const ub=Hv(N),Xg=$v({__proto__:null,default:ub},[N]),ke=class ke{constructor(t,m,y){this._lastChild=ke.INVALID_INDEX,this.index=ke.INVALID_INDEX,this.id=ke.INVALID_ID,this.depth=ke.INVALID_DEPTH,this.parent=ke.INVALID_INDEX,this.firstChild=ke.INVALID_INDEX,this.initialFirstChild=ke.INVALID_INDEX,this.nextSibling=ke.INVALID_INDEX,this.initialNextSibling=ke.INVALID_INDEX,this.id=t,this.index=m,y!==void 0?(this.depth=y.depth+1,this.parent=y.index,y.initialFirstChild===ke.INVALID_INDEX&&(y.initialFirstChild=m,y.firstChild=m),y._lastChild=m):this.depth=0}get lastChild(){return this._lastChild}get isLeaf(){return this.firstChild===ke.INVALID_INDEX}get isRoot(){return this.parent===ke.INVALID_INDEX}};ke.INVALID_ID=-1,ke.INVALID_INDEX=-1,ke.INVALID_DEPTH=-1,ke.INVALID_HEIGHT=-1;let Fe=ke;class lb{constructor(){this._slices=[]}clear(){this._slices=[]}slice(t){if(!(t<0||t>=this._slices.length))return this._slices[t]}startSlice(t){this._slices.push([t,t])}endSlice(t){this._slices[this._slices.length-1][1]=t}nextSlice(t){this.endSlice(t-1),this.startSlice(t)}addSliceByRange(t,m){this._slices.push([t,m])}addSliceByLength(t){if(this.length===0){this._slices.push([0,t-1]);return}const m=this._slices[this._slices.length-1][1];this._slices.push([m+1,m+t])}sliceDo(t,m){if(t<0||t>=this._slices.length)return;const y=this._slices[t];m(y[0],y[1])}slicesDo(t){for(const m of this._slices)t(m[0],m[1])}get slices(){return this._slices}get numberOfInnerNodes(){return this._slices[this._slices.length-1][0]}get numberOfLeafNodes(){return this.numberOfNodes-this.numberOfInnerNodes}get numberOfNodes(){return this._slices[this._slices.length-1][1]+1}get length(){return this._slices.length}}const Ht=N.auxiliaries.assert;class Je{constructor(){this._linearization=new lb,this._nodes=new Array,this._innerNodeIndicesById=new Map,this._leafNodeIndicesById=new Map,this._edgeIndexToTopologyIndexMap=new Array,this._topologyIndexToEdgeIndexMap=new Array}fromInterleavedEdgesIdById(t){Ht(t.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const m=new Array,y=new Map,l=new Array;m.push(new Fe(t[0],0)),y.set(m[0].id,m[0]),l.push(new Array),l[0].push(m[0]);let r=m[0];for(let a=0;a<t.length;a+=2){const n=[t[a+0],t[a+1]],i=a+2<t.length?[t[a+2],t[a+3]]:[Fe.INVALID_ID,Fe.INVALID_ID];if(r.lastChild!==Fe.INVALID_INDEX){const p=m[r.lastChild];Ht(p.nextSibling===Fe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),p.initialNextSibling=m.length,p.nextSibling=m.length}const h=new Fe(n[1],m.length,r);for(m.push(h);l.length<=h.depth;)l.push(new Array);l[h.depth].push(h),y.set(h.id,h),!(i[0]===Fe.INVALID_ID&&i[1]===Fe.INVALID_ID)&&(i[0]===n[1]?r=h:i[0]!==n[0]&&(Ht(y.has(i[0]),`expected next parent to be already created, given ${i[0]}`),r=y.get(i[0])))}this.fromNodes(m,l)}fromInterleavedEdgesIndexById(t){Ht(t.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const m=new Array,y=new Array;let l=0;for(m.push(new Fe(0,0)),y.push(new Array),y[0].push(m[0]),t[0]===-1&&(l+=2);l<t.length;l+=2){const r=[t[l+0],t[l+1]];let a;if(r[0]<m.length&&t[0]===-1?a=m[r[0]]:(Ht(r[0]<m.length,"expected parent to be processed before child"),a=m[r[0]<0?0:r[0]+1]),a.lastChild!==Fe.INVALID_INDEX){const i=m[a.lastChild];Ht(i.nextSibling===Fe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),i.initialNextSibling=m.length,i.nextSibling=m.length}const n=new Fe(r[1],m.length,a);m.push(n),y.length===n.depth&&y.push(new Array),y[n.depth].push(n)}this.fromNodes(m,y)}fromNodes(t,m){this._linearization.clear(),this._innerNodeIndicesById.clear(),this._leafNodeIndicesById.clear(),this._edgeIndexToTopologyIndexMap.length=t.length,this._topologyIndexToEdgeIndexMap.length=t.length,this._edgeIndexToTopologyIndexMap.fill(-1),this._topologyIndexToEdgeIndexMap.fill(-1);const y=new Array,l=new Array;for(const n of m){const i=n.filter(p=>p.isLeaf);for(const p of i)y.push(p);const h=n.filter(p=>!p.isLeaf);h.length>0&&l.push(h)}l.push(y);for(const n of l)this._linearization.addSliceByLength(n.length);const r=new Map;this._nodes.length=t.length,r.set(-1,-1);let a=0;for(const n of l)for(const i of n)this._nodes[a]=i,(i.isLeaf?this._leafNodeIndicesById:this._innerNodeIndicesById).set(i.id,a),r.set(i.index,a),this._edgeIndexToTopologyIndexMap[i.index]=a,this._topologyIndexToEdgeIndexMap[a]=i.index,++a;for(const n of this._nodes)n.index=r.get(n.index),n.parent=r.get(n.parent),n.initialNextSibling=r.get(n.initialNextSibling),n.initialFirstChild=r.get(n.initialFirstChild),n.nextSibling=n.initialNextSibling,n.firstChild=n.initialFirstChild}sliceDo(t,m){const y=(l,r)=>{for(let a=l;a<=r;++a)m(this._nodes[a])};this.sliceRangeDo(t,y)}sliceRangeDo(t,m){this._linearization.sliceDo(t,m)}initialize(t,m,y){switch(m){case Je.InputSemantics.ParentIdId:switch(t){case Je.InputFormat.Tupled:this.fromInterleavedEdgesIdById([].concat(...y));break;case Je.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIdById(y);break}break;case Je.InputSemantics.ParentIndexId:switch(t){case Je.InputFormat.Tupled:this.fromInterleavedEdgesIndexById([].concat(...y));break;case Je.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIndexById(y);break}break}return!0}node(t){if(!(this._nodes.length<=t))return this._nodes[t]}innerNodeIndexById(t){return this._innerNodeIndicesById.get(t)}leafNodeIndexById(t){return this._leafNodeIndicesById.get(t)}innerNodeById(t){const m=this.innerNodeIndexById(t);if(m!==void 0)return this.node(m)}leafNodeById(t){const m=this.leafNodeIndexById(t);if(m!==void 0)return this.node(m)}forEachInnerNode(t){for(let m=0;m<this.depth-1;++m)this.sliceDo(m,t)}parentsDoUntilDepth(t,m){const y=Math.min(Math.max(t,0),this.depth-1);for(let l=0;l<y;++l)this.sliceDo(l,m)}forEachLeafNode(t){this.sliceDo(this.depth-1,t)}nodesDo(t){this.forEachInnerNode(t),this.forEachLeafNode(t)}reverseNodesDo(t){this.forEachLeafNode(t),this.reverseParentsDo(t)}depthFirstDo(t){t(this.root)}childrenDo(t,m){Ht(t!==void 0,"Parent is expected to be valid."),t.firstChild!==Fe.INVALID_INDEX&&this.siblingsDo(this.node(t.firstChild),m)}siblingsDo(t,m){let y=t;for(m(y);y.nextSibling!==Fe.INVALID_INDEX;)y=this.node(y.nextSibling),m(y)}siblingsRangeDo(t,m,y){if(m===void 0)return this.siblingsDo(t,y);for(let l=t;l!==void 0&&l!==m;l=this.node(l.nextSibling))y(l)}reverseParentsDo(t){for(let m=this.depth-2;m>=0;--m)this.sliceDo(m,t)}get linearization(){return this._linearization}get numberOfNodes(){return this._linearization.numberOfNodes}get numberOfInnerNodes(){return this._linearization.numberOfInnerNodes}get numberOfLeafNodes(){return this._linearization.numberOfLeafNodes}get depth(){return this._linearization.length}get root(){return this._nodes[0]}get nodes(){return this._nodes}get edgeIndexToTopologyIndexMap(){return this._edgeIndexToTopologyIndexMap}get topologyIndexToEdgeIndexMap(){return this._topologyIndexToEdgeIndexMap}}(E=>{(t=>{t.Interleaved="interleaved",t.Tupled="tupled"})(E.InputFormat||(E.InputFormat={})),(t=>{t.ParentIdId="parent-id-id",t.ParentIndexId="parent-index-id"})(E.InputSemantics||(E.InputSemantics={})),(t=>{t.TopDown="top-down",t.BottomUp="bottom-up",t.DepthFirst="depth-first"})(E.IterationDirection||(E.IterationDirection={}))})(Je||(Je={}));const at=N.auxiliaries.assert,cb=N.auxiliaries.log,_l=N.auxiliaries.logIf,eo=N.auxiliaries.LogLevel;var Es;(E=>{function t(b,v){const _=new Array(b.numberOfNodes);let g;if(v.topology.format===Je.InputFormat.Interleaved){const x=v.topology.edges,T=2*(b.numberOfNodes-1);_l(x.length!==T,eo.Warning,`expected an edgelist of size ${T} instead of ${x.length}`),g=O=>{const A=2*(O-1);return at(A<x.length,`expected an index within the ranges of edges but got ${O}`),A<x.length?[x[A+0],x[A+1]]:[Fe.INVALID_INDEX,Fe.INVALID_INDEX]}}else{const x=v.topology.edges,T=b.numberOfNodes-1;_l(x.length!==T,eo.Warning,`expected an edgelist of size ${T} instead of ${x.length}`),g=O=>(at(O-1<x.length,`expected an index within the ranges of edges but got${O}`),O-1<x.length?x[O-1]:[Fe.INVALID_INDEX,Fe.INVALID_INDEX])}_[0]=0;for(let x=1;x<b.numberOfNodes;x++){let T;const O=g(x);x+1<b.numberOfNodes&&g(x+1)[0]===O[1]?T=b.innerNodeIndexById(O[1]):T=b.leafNodeIndexById(O[1]),at(T!==void 0,`expected a valid index, given ${T} for ${O[1]}`),_[x]=T}return _}E.normalization_backup=t;function m(b,v){const _=new Float32Array(v.length);_l(v.length!==b.length,eo.Warning,`expected value buffer to be sized with the number of nodes but got ${b.length} instead of ${v.length}`);for(let g=0;g<_.length;++g)_[v[g]]=b[g];return _}E.renormalize=m;function y(b,v,_){const g=new Float32Array(_.length);switch(g.fill(NaN),v.type){case tt.LinearizationMapping.IdMapping:at(!1,"Id-Mapping not yet implemented");break;case tt.LinearizationMapping.IndexMapping:for(let x=0;x<b.length;++x){let T=v.mapping[x];T!==void 0&&(g[_[T]]=b[x])}break}return g}E.renormalize_using_intermediate_linearization=y;function l(b,v,_,g,x){for(const T of g)switch(T.type){case"normalize":E.applyNormalization(b,_,T);break;case"range-transform":E.applyRangeTransform(b,_,T);break;case"propagate-up":E.applyPropagation(b,_,T);break;case"fill-invalid":E.applyFill(b,_,T);break;case"mask":E.applyMask(b,_,T);break;case"clamp":E.applyClamp(b,_,T);break;case"threshold":E.applyThreshold(b,_,T);break;case"compare":E.applyCompare(b,_,T);break;case"transform":E.applyTransform(b,v,_,T,x);break;case"discretize":E.applyDiscretization(b,_,T);break;case"callback":E.applyCallback(b,_,T);break}return _}E.applyTransformations=l;function r(b,v,_){if(b.numberOfLeafNodes===0)return;let g=0,x=1;switch(_.operation){case"zero-to-max":{let T;b.forEachLeafNode(O=>{const A=v[O.index];T=T===void 0?A:Math.max(T,A)}),at(T!==void 0,"Valid max expected"),T===void 0&&(T=1),g=0,x=1/T}break;case"min-to-max":{let T,O;b.forEachLeafNode(A=>{const R=v[A.index];T=T===void 0?R:Math.max(T,R),O=O===void 0?R:Math.min(O,R)}),at(T!==void 0,"Valid max expected"),at(O!==void 0,"Valid min expected"),O===void 0&&(O=0),T===void 0&&(T=1),g=-O,x=1/(T-O)}break;case"sign-agnostic-max":{let T;b.forEachLeafNode(O=>{const A=Math.abs(v[O.index]);T=T===void 0?A:Math.max(T,A)}),at(T!==void 0,"Valid max expected"),T===void 0&&(T=1),g=0,x=1/T}break;case"diverging":{const T=_.neutralElement===void 0?0:_.neutralElement;let O,A;b.forEachLeafNode(P=>{const C=v[P.index];O=O===void 0?C:Math.max(O,C),A=A===void 0?C:Math.min(A,C)}),at(O!==void 0,"Valid max expected"),at(A!==void 0,"Valid min expected"),A===void 0&&(A=0),O===void 0&&(O=1);const R=Math.max(Math.abs(T-A),Math.abs(O-T));g=R-T,x=1/(2*R)}break}v.forEach((T,O)=>{v[O]=(v[O]+g)*x})}E.applyNormalization=r;function a(b,v,_){if(b.numberOfLeafNodes===0||_.sourceRange===void 0||_.targetRange===void 0)return;const g=_.sourceRange,x=_.targetRange,T=-g[0],O=x[0],A=g[1]===g[0]?0:(x[1]-x[0])/(g[1]-g[0]);for(let R=0;R<v.length;R++)v[R]<g[0]?v[R]=-1:v[R]=O+(v[R]+T)*A}E.applyRangeTransform=a;function n(b,v,_){if(b.numberOfLeafNodes!==0)switch(_.operation){case"average":b.reverseParentsDo(g=>{let x=0,T=0;b.childrenDo(g,O=>{const A=v[O.index];x+=A,++T}),v[g.index]=T===0?0:x/T});break;case"sum":b.reverseParentsDo(g=>{let x=0;b.childrenDo(g,T=>{const O=v[T.index];x+=O}),v[g.index]=x});break;case"min":b.reverseParentsDo(g=>{let x;b.childrenDo(g,T=>{const O=v[T.index];x=x===void 0?O:Math.min(O,x)}),x===void 0&&(x=0),v[g.index]=x});break;case"max":b.reverseParentsDo(g=>{let x;b.childrenDo(g,T=>{const O=v[T.index];x=x===void 0?O:Math.max(O,x)}),x===void 0&&(x=0),v[g.index]=x});break;case"median":b.reverseParentsDo(g=>{const x=new Array;b.childrenDo(g,T=>{const O=v[T.index];x.push(O)}),x.sort(),x.length%2===0?v[g.index]=(x[x.length/2]+x[x.length/2])/2:v[g.index]=x[x.length/2]});break;case"closest-to-zero":b.reverseParentsDo(g=>{let x;b.childrenDo(g,T=>{const O=v[T.index];(x===void 0||Math.abs(O)<Math.abs(x))&&(x=O)}),x===void 0&&(x=0),v[g.index]=x});break;case"closest-to-infinity":b.reverseParentsDo(g=>{let x;b.childrenDo(g,T=>{const O=v[T.index];(x===void 0||Math.abs(O)>Math.abs(x))&&(x=O)}),x===void 0&&(x=0),v[g.index]=x});break;default:cb(eo.Warning,"Transformation type not recognized.");break}}E.applyPropagation=n;function i(b,v,_){const g=_.value,x="invalidValue"in _?_.invalidValue:void 0;b.nodesDo(T=>{v[T.index]===x&&(v[T.index]=g)})}E.applyFill=i;function h(b,v,_){let g,x;"range"in _?(g=_.range[0],x=_.range[0]):(g=_.min,x=_.max),at(g<=x,"Require valid min-max range."),b.nodesDo(T=>{const O=v[T.index];O!==void 0&&(v[T.index]=Math.min(x,Math.max(g,O)))})}E.applyClamp=h;function p(b,v,_){const g=_.value;b.nodesDo(x=>{v[x.index]=v[x.index]===g?1:0})}E.applyMask=p;function d(b,v,_){const g=_.value;b.nodesDo(x=>{v[x.index]=v[x.index]>=g?1:0})}E.applyThreshold=d;function f(b,v,_){const g=_.value;b.nodesDo(x=>{v[x.index]=v[x.index]>g?1:v[x.index]<g?-1:0})}E.applyCompare=f;function s(b,v,_,g,x){const T=g.operation,O=g.parameter,A=g.buffer;let R=P=>O;if(A!==void 0){const P=tt.create(b,v,A,x);P!==void 0&&(R=C=>P[C.index])}switch(T){case"min":b.nodesDo(P=>{_[P.index]=Math.min(_[P.index],R(P))});break;case"max":b.nodesDo(P=>{_[P.index]=Math.max(_[P.index],R(P))});break;case"add":b.nodesDo(P=>{_[P.index]=_[P.index]+R(P)});break;case"subtract":b.nodesDo(P=>{_[P.index]=_[P.index]-R(P)});break;case"multiply":b.nodesDo(P=>{_[P.index]=_[P.index]*R(P)});break;case"divide":b.nodesDo(P=>{_[P.index]=_[P.index]/R(P)});break;case"inverse":b.nodesDo(P=>{_[P.index]=1/_[P.index]});break;case"pow":b.nodesDo(P=>{_[P.index]=Math.pow(_[P.index],R(P))});break;case"nth-root":b.nodesDo(P=>{const C=1/R(P);_[P.index]=Math.pow(_[P.index],C)});break;case"log":O!==void 0&&O!==0?b.nodesDo(P=>{const C=Math.log(R(P));_[P.index]=Math.log(_[P.index])/C}):b.nodesDo(P=>{_[P.index]=Math.log(_[P.index])});break;case"square":b.nodesDo(P=>{_[P.index]=Math.pow(_[P.index],2)});break;case"square-root":b.nodesDo(P=>{_[P.index]=Math.sqrt(_[P.index])});break;case"as-multiplier":b.nodesDo(P=>{_[P.index]=Math.abs(_[P.index])});break;case"as-remainder":b.nodesDo(P=>{_[P.index]=1-Math.abs(_[P.index])});break;case"abs":b.nodesDo(P=>{_[P.index]=Math.abs(_[P.index])});break;case"compare":b.nodesDo(P=>{const C=_[P.index],U=R(P);C<U?_[P.index]=-1:C>U?_[P.index]=1:_[P.index]=0});break;default:return}}E.applyTransform=s;function o(b,v,_){at(!1,"Implementation missing")}E.applyDiscretization=o;function u(b,v,_){const g=_.operation;switch(_.iteration){case Je.IterationDirection.TopDown:b.nodesDo(T=>{v[T.index]=g(v[T.index],T,v,b)});break;case Je.IterationDirection.DepthFirst:b.reverseNodesDo(T=>{v[T.index]=g(v[T.index],T,v,b)});break;case Je.IterationDirection.BottomUp:default:b.depthFirstDo(T=>{v[T.index]=g(v[T.index],T,v,b)});break}}E.applyCallback=u})(Es||(Es={}));const X0=N.auxiliaries.assert,Y0=N.auxiliaries.log,Z0=N.auxiliaries.LogLevel;var tt;(E=>{(n=>{n.String="string",n.Numbers="numbers",n.Uint8="uint8",n.Int8="int8",n.Uint16="uint16",n.Int16="int16",n.Uint32="uint32",n.Int32="int32",n.Float32="float32",n.Float64="float64"})(E.DataType||(E.DataType={})),(n=>{n.Native="native"})(E.Encoding||(E.Encoding={})),(n=>{n.Topology="topology",n.Identity="identity"})(E.Linearization||(E.Linearization={})),(n=>{n.IdMapping="id-mapping",n.IndexMapping="index-mapping"})(E.LinearizationMapping||(E.LinearizationMapping={}));function t(n,i){return n.edgeIndexToTopologyIndexMap}E.createNormalization=t;function m(n,i,h,p){const d=h.indexOf(":");if(d===void 0||d<0){Y0(Z0.Error,"Buffer type not recognized.");return}switch(h.substr(0,d)){case"buffer":return E.createSourceBuffer(i,h.substr(d+1),p);case"bufferView":return E.createView(n,i,h.substr(d+1),p);default:Y0(Z0.Error,"Buffer type not recognized.");break}}E.create=m;function y(n){if(n.length!==0)return Array.prototype.reduce.apply(n,[(i,h)=>[Math.min(h,i[0]),Math.max(h,i[1])],[1/0,-1/0]])}E.range=y;function l(n,i){if(n.length===0)return;let h=[1/0,-1/0];return i.forEachLeafNode(p=>{const d=n[p.index];h=[Math.min(d,h[0]),Math.max(d,h[1])]}),h}E.leafRange=l;function r(n,i,h){const p=h.buffers.find(d=>d.identifier===i);if(!(!p||p.encoding!=="native"))return X0(p.linearization!=="identity","Expect linearization to be of type topology or mapping. Identity is currently unsupported"),$r.isLinearizationMapping(p.linearization)?Es.renormalize_using_intermediate_linearization(p.data,p.linearization,n):(X0(p.linearization==="topology","Expect linearization to be of type topology or identity."),Es.renormalize(p.data,n))}E.createSourceBuffer=r;function a(n,i,h,p){const d=p.bufferViews.find(s=>s.identifier===h);if(d===void 0)return;const f=E.create(n,i,d.source,p);if(f!==void 0)return d.transformations===void 0||d.transformations.length===0?f:Es.applyTransformations(n,i,f,d.transformations,p)}E.createView=a})(tt||(tt={}));const hb="http://json-schema.org/draft-06/schema#",db="Treemap Configuration Schema",fb="JSON schema for a treemap configuration object, targeting the treemap renderer module.",_b="object",pb={topology:{type:"object",properties:{format:{type:"string",enum:["interleaved","tupled"],default:"interleaved"},semantics:{type:"string",enum:["parent-id-id","parent-index-id"],default:"parent-id-id"},edges:{type:"array",items:{anyOf:[{type:"integer",minimum:-1},{type:"array",items:{type:"integer",minimum:-1},minItems:2,maxItems:2,uniqueItems:!0}],minItems:0}}},required:["edges"],additionalProperties:!1},buffers:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},type:{type:"string",enum:["numbers","uint8","uint16","int16","uint32","int32","float32","float64"]},encoding:{type:"string",enum:["base64","native"],default:"native"},data:{anyOf:[{type:"array",items:{type:"number"}},{type:"Uint8Array"},{type:"Uint16Array"},{type:"Int16Array"},{type:"Uint32Array"},{type:"Int32Array"},{type:"Float32Array"},{type:"Float64Array"}]},linearization:{anyOf:[{type:"string",enum:["topology","identity"]},{type:"object",properties:{type:{type:"string",enum:["id-mapping","index-mapping"]},mapping:{type:"array",items:{type:"integer"}}},required:["type","mapping"],additionalProperties:!1}],default:"topology"}},required:["identifier","type","data"],additionalProperties:!1}},bufferViews:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},source:{$ref:"/BufferReference"},transformations:{type:"array",items:{anyOf:[{type:"object",properties:{type:{type:"string",enum:["propagate-up"]},operation:{type:"string",enum:["average","sum","min","max","median","closest-to-zero","closest-to-infinity"]},weight:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["fill-invalid"]},value:{type:"number"},invalidValue:{anyOf:[{type:"number"},{type:"null"}]}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["mask"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},min:{type:"number"},max:{type:"number"}},required:["type","min","max"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},range:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","range"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["range-transform"]},sourceRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2},targetRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","sourceRange","targetRange"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["normalize"]},operation:{type:"string",enum:["zero-to-max","min-to-max","sign-agnostic-max","diverging"]},neutralElement:{type:"number"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["threshold"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["compare"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["transform"]},operation:{type:"string",enum:["add","subtract","multiply","divide","inverse","pow","nth-root","log","square","square-root","as-multiplier","as-remainder","abs"]},parameter:{type:"number",default:0},buffer:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},operation:{type:"string",enum:["quantiles","quartiles"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},percentiles:{type:"array",items:{type:"number"}}},required:["type","percentiles"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["callback"]}},required:["type","operation"],additionalProperties:!0}]}}},required:["identifier","source"],additionalProperties:!1}},colors:{type:"array",items:{oneOf:[{type:"object",properties:{identifier:{type:"string"},colorspace:{type:"string",enum:["rgb","hsl","lab","cmyk","hex"],description:"The color space is based on supported webgl-operate color spaces.",default:"hex"},value:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]},values:{type:"array",minItems:2,items:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]}}},required:["identifier","colorspace"],oneOf:[{type:"object",required:["value"]},{type:"object",required:["values"]}],additionalProperties:!1},{type:"object",properties:{identifier:{type:"string"},preset:{type:"string",description:"The preset from a webgl-operate Color Scheme Preset file."},steps:{type:"number",minimum:3,maximum:12,default:5}},required:["identifier","preset"],additionalProperties:!1}]}},layout:{type:"object",properties:{algorithm:{type:"string",enum:["strip","snake","codecity"]},weight:{$ref:"/BufferReference"},aspectRatio:{type:"number",exclusiveMinimum:0,default:1},sort:{type:"object",properties:{algorithm:{type:"string",enum:["ascending","descending","keep"],default:"keep"},key:{anyOf:[{type:"string",enum:["identity","weight"]},{$ref:"/BufferReference"}],default:"identity"}},required:["algorithm"],additionalProperties:!1},siblingMargin:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0}],default:0}},required:["type","value"],additionalProperties:!1},parentPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute","mixed"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0}},required:["type","value"],additionalProperties:!1},accessoryPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"absolute"},direction:{type:"string",enum:["top","left","bottom","right"],default:"bottom"},value:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}]},relativeAreaThreshold:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0},targetAspectRatio:{anyOf:[{type:"number",minimum:0},{type:"null"}],default:null}},required:["value"],additionalProperties:!1}},required:["algorithm","weight"],additionalProperties:!1},geometry:{type:"object",properties:{parentLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:inner"},showRoot:{type:"boolean",default:!1}},additionalProperties:!1},leafLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:leaf"},height:{$ref:"/BufferReference"},colors:{$ref:"/BufferReference"},colorsNormalized:{type:"boolean",default:!1}},additionalProperties:!1},auxiliary:{$ref:"/ColorReference",default:"color:auxiliary"},emphasis:{type:"object",properties:{outline:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},highlight:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},color:{$ref:"/ColorReference",default:"color:emphasis"},outlineWidth:{type:"number",minimum:0,description:"unit: device-independent pixel",default:1.6}},additionalProperties:!1},heightScale:{anyOf:[{type:"string",enum:["SomethingInverseSqrt"]},{type:"number"}],default:.125},outlineWidth:{type:"number",minimum:0,description:"unit: native pixel",default:.8}},required:[],additionalProperties:!1},labels:{type:"object",properties:{names:{anyOf:[{$ref:"/BufferReference"},{type:"object",additionalProperties:{type:"string"}}]},additionallyLabelSet:{type:"array",items:{type:"number",minimum:0},default:[]},innerNodeLayerRange:{type:"array",items:{type:"number",minimum:0},minItems:2,maxItems:2,default:[1,2]},numTopInnerNodes:{type:"number",minimum:0,default:0},numTopWeightNodes:{type:"number",minimum:0,default:0},numTopHeightNodes:{type:"number",minimum:0,default:0},numTopColorNodes:{type:"number",minimum:0,default:0}},required:[]}},vb=["topology","layout"],mb=!1,bb={$schema:hb,title:db,description:fb,type:_b,properties:pb,required:vb,additionalProperties:mb},gb="/BufferReference",yb="string",Eb="^(buffer|bufferView):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",Tb="Named identifier used to reference a buffer or buffer view throughout the treemap configuration.",xb={id:gb,type:yb,pattern:Eb,description:Tb},Sb="/ColorReference",Ab="string",Ob="^(color):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",wb="Named identifier used to reference a color throughout the treemap configuration.",Pb={id:Sb,type:Ab,pattern:Ob,description:wb},Rb="/ColorScheme",Lb="object",Mb={inverted:{type:"boolean",default:!1},classBounds:{type:"array",items:{type:"number"}}},Ib={id:Rb,type:Lb,properties:Mb},je=class je{constructor(){this._altered=Object.assign(new N.ChangeLookup,{any:!1,topology:!1,buffers:!1,bufferViews:!1,colors:!1,layout:{any:!1,weight:!1,sort:!1,algorithm:!1,siblingMargin:!1,parentPadding:!1,accessoryPadding:!1},geometry:{any:!1,aggregation:!1,outlineWidth:!1,emphasis:{any:!1,outline:!1,highlight:!1,outlineWidth:!1},areaScale:!1,heights:!1,heightScale:!1,colors:!1,parentLayer:!1,leafLayer:!1},labels:!1}),this._buffers=[],this._bufferViews=[],this._colors=[]}get altered(){return this._altered}set topology(t){const m=je.TREEMAP_SCHEMA.properties.topology;N.properties.validate(t,m,[])&&(N.properties.complement(t,m),N.properties.compare(t,this._topology,this._altered,"topology"),this._topology=t)}get topology(){return this._topology}set buffers(t){const m=je.TREEMAP_SCHEMA.properties.buffers;N.properties.validate(t,m,[])&&(N.properties.complement(t,m),N.properties.compare(t,this._buffers,this._altered,"buffers"),this._buffers=t)}get buffers(){return this._buffers}set bufferViews(t){const m=je.TREEMAP_SCHEMA.properties.bufferViews;N.properties.validate(t,m,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(t,m),N.properties.compare(t,this._bufferViews,this._altered,"bufferViews"),this._bufferViews=t)}get bufferViews(){return this._bufferViews}set colors(t){const m=je.TREEMAP_SCHEMA.properties.colors;N.properties.validate(t,m,[[je.COLOR_REFERENCE_SCHEMA,"/ColorReference"]])&&(N.properties.complement(t,m),N.properties.compare(t,this._colors,this._altered,"colors"),this._colors=t)}get colors(){return this._colors}set layout(t){const m=je.TREEMAP_SCHEMA.properties.layout;N.properties.validate(t,m,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(t,m),N.properties.compare(t,this._layout,this._altered,"layout"),this._layout=t)}get layout(){return this._layout}set geometry(t){const m=je.TREEMAP_SCHEMA.properties.geometry;N.properties.validate(t,m,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"],[je.COLOR_REFERENCE_SCHEMA,"/ColorReference"],[je.COLOR_SCHEMA_SCHEMA,"/ColorScheme"]])&&(N.properties.complement(t,m),N.properties.compare(t,this._geometry,this._altered,"geometry"),this._geometry=t)}get geometry(){return this._geometry}set labels(t){const m=je.TREEMAP_SCHEMA.properties.labels;N.properties.validate(t,m,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(t,m),N.properties.compare(t,this._labels,this._altered,"labels"),"names"in t&&typeof t.names=="object"&&!(t.names instanceof Map)&&(t.names=new Map(Object.entries(t.names).map(y=>[Number.parseFloat(y[0]),y[1]]))),this._labels=t)}get labels(){return this._labels}labelsToJSON(){const t=Object.assign({},this._labels);return t.names&&typeof t.names!="string"&&(t.names=Object.fromEntries(this._labels.names)),t}toJSON(){return{topology:this.topology,buffers:this.buffers,bufferViews:this.bufferViews,colors:this.colors,layout:this.layout,geometry:this.geometry,labels:this.labelsToJSON()}}};je.TREEMAP_SCHEMA=bb,je.BUFFER_REFERENCE_SCHEMA=xb,je.COLOR_REFERENCE_SCHEMA=Pb,je.COLOR_SCHEMA_SCHEMA=Ib;let $r=je;(E=>{function t(l){return typeof l=="string"||l instanceof String||l in tt.Linearization?!1:"type"in l&&l.type in tt.LinearizationMapping&&"mapping"in l}E.isLinearizationMapping=t;function m(l){return typeof l!="object"?!1:"identifier"in l&&"colorspace"in l}E.isColorArray=m;function y(l){return typeof l!="object"?!1:"identifier"in l&&"preset"in l}E.isColorPreset=y})($r||($r={}));var ai;(E=>{function t(l,r="SomethingInverseSqrt"){switch(r){default:case"SomethingInverseSqrt":return N.gl_matrix_extensions.clamp(100/Math.sqrt(l.numberOfNodes)+.0125,.0625,.3333)}}E.heightScale=t,(l=>{l.SomethingInverseSqrt="SomethingInverseSqrt"})(E.HeightScaleApproach||(E.HeightScaleApproach={}));function m(l,r="SomethingLog10"){switch(r){default:case"SomethingLog10":return .04+(1-Math.log10(l.numberOfNodes+1)/6)*.12}}E.parentMargin=m;function y(l,r="SomethingLog10"){switch(r){default:case"SomethingLog10":return .01+(1-Math.log10(l.numberOfNodes+1)/6)*.12}}E.siblingMargin=y,(l=>{l.SomethingLog10="SomethingLog10"})(E.MarginApproach||(E.MarginApproach={}))})(ai||(ai={}));var Fb=Object.defineProperty,Cb=Object.getOwnPropertyDescriptor,Nb=(E,t,m,y)=>{for(var l=Cb(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&Fb(t,m,l),l},Oe;const r1=(Oe=class extends N.Geometry{static referenceVerticesVBO(t){let m;Oe.VERTICES_BY_CONTEXT.has(t)?m=Oe.VERTICES_BY_CONTEXT.get(t):(m=new N.Buffer(t,"CuboidVertexVBO"),Oe.VERTICES_BY_CONTEXT.set(t,m),Oe.REFCOUNT_BY_TEMPLATE.set(m,0));const y=Oe.REFCOUNT_BY_TEMPLATE.get(m)+1;return Oe.REFCOUNT_BY_TEMPLATE.set(m,y),m}static unreferenceTemplateVBO(t){if(!Oe.VERTICES_BY_CONTEXT.has(t))return;const m=Oe.VERTICES_BY_CONTEXT.get(t),y=Oe.REFCOUNT_BY_TEMPLATE.get(m)-1;Oe.REFCOUNT_BY_TEMPLATE.set(m,y),!(y>0)&&(m.uninitialize(),Oe.VERTICES_BY_CONTEXT.delete(t),Oe.REFCOUNT_BY_TEMPLATE.delete(m))}constructor(t,m){super(t,m),m=m!==void 0&&m!==""?m:"CuboidGeometry",this._vertices=Oe.referenceVerticesVBO(t),this._buffers.push(this._vertices),this._layout=new N.Buffer(t,`${m}LayoutVBO`),this._buffers.push(this._layout),this._ids=new N.Buffer(t,`${m}IdVBO`),this._buffers.push(this._ids),this._emphases=new N.Buffer(t,`${m}EmphasisVBO`),this._buffers.push(this._emphases),this._areaScales=new N.Buffer(t,`${m}AreaScaleVBO`),this._buffers.push(this._areaScales),this._colors=new N.Buffer(t,`${m}ColorVBO`),this._buffers.push(this._colors),this._heights=new N.Buffer(t,`${m}HeightVBO`),this._buffers.push(this._heights)}bindBuffers(t){const m=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,m.FLOAT,!1,20,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._vertices.attribEnable(this._texCoordLocation,2,m.FLOAT,!1,20,12,!0,!1),y.vertexAttribDivisor(this._texCoordLocation,0),this._layout.attribEnable(this._layoutLocation,4,m.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._areaScales.attribEnable(this._areaScaleLocation,1,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._areaScaleLocation,1),this._colors.attribEnable(this._colorLocation,1,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1),this._heights.attribEnable(this._heightLocation,2,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._heightLocation,1)}unbindBuffers(t){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._vertices.attribDisable(this._texCoordLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._areaScales.attribDisable(this._areaScaleLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1),this._heights.attribDisable(this._heightLocation,!1,!1)}initialize(t=0,m=1,y=2,l=3,r=4,a=5,n=6,i=7){this._vertexLocation=t,this._texCoordLocation=m,this._idLocation=l,this._layoutLocation=y,this._emphasisLocation=r,this._areaScaleLocation=a,this._colorLocation=n,this._heightLocation=i;const h=this.context.gl,p=super.initialize([h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER]);return this._vertices.data(Oe.DATA,h.STATIC_DRAW),p&&this._vertices.valid}uninitialize(){Oe.unreferenceTemplateVBO(this.context),this._layout.uninitialize(),this._ids.uninitialize(),this._emphases.uninitialize(),this._areaScales.uninitialize(),this._colors.uninitialize(),this._heights.uninitialize(),super.uninitialize()}update(){this.bind()}draw(t=0,m=0,y=0){const l=this.context.gl,r=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,l.FLOAT,!1,20,m,!0,!1),this._vertices.attribEnable(this._texCoordLocation,2,l.FLOAT,!1,20,12+m,!0,!1),this._ids.attribEnable(this._idLocation,4,l.UNSIGNED_BYTE,!1,4,t*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,l.FLOAT,!1,16,t*16,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,l.UNSIGNED_BYTE,!1,1,t*1,!0,!1),this._areaScales.attribEnable(this._areaScaleLocation,1,l.UNSIGNED_BYTE,!1,1,t*1,!0,!1),this._colors.attribEnable(this._colorLocation,1,l.UNSIGNED_BYTE,!1,1,t*1,!0,!1),this._heights.attribEnable(this._heightLocation,2,l.UNSIGNED_BYTE,!1,2,t*2,!0,!1),r.drawArraysInstanced(l.TRIANGLE_STRIP,0,4,y)}set layout(t){const m=this.context.gl;this._layout.data(t,m.STATIC_DRAW)}set ids(t){const m=this.context.gl;this._ids.data(t,m.STATIC_DRAW)}set areaScales(t){const m=this.context.gl;this._areaScales.data(t,m.STATIC_DRAW)}set colors(t){const m=this.context.gl;this._colors.data(t,m.STATIC_DRAW)}set emphases(t){const m=this.context.gl;this._emphases.data(t,m.STATIC_DRAW)}set heights(t){const m=this.context.gl;this._heights.data(t,m.STATIC_DRAW)}get valid(){const t=this._layout&&this._layout.valid,m=this._ids&&this._ids.valid,y=this._areaScales&&this._areaScales.valid,l=this._colors&&this._colors.valid,r=this._emphases&&this._emphases.valid,a=this._heights&&this._heights.valid;return this.initialized&&this._vertices.valid&&t&&m&&y&&l&&r&&a}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get areaScaleLocation(){return this._areaScaleLocation}get colorLocation(){return this._colorLocation}get heightLocation(){return this._heightLocation}},Oe.VERTICES_BY_CONTEXT=new Map,Oe.REFCOUNT_BY_TEMPLATE=new Map,Oe.DATA=new Float32Array([0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,0,0,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,1,1,1,1]),Oe.BYTES_PER_VERTEX=Oe.DATA.length/6,Oe);Nb([N.Initializable.assert_initialized()],r1.prototype,"draw");let K0=r1;var zb=Object.defineProperty,Bb=Object.getOwnPropertyDescriptor,i1=(E,t,m,y)=>{for(var l=Bb(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&zb(t,m,l),l};const kr=N.auxiliaries.assert;class xt extends N.Initializable{constructor(t){super(),this._context=t}initializeES2_basic(t,m){const y=this._context.gl,l=this._context.gl2facade;this._drawRestricted=!0,this._colorRenderTexture.initialize(t,m,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(t,m,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(t,m,y.RGB,y.RGB,y.UNSIGNED_BYTE),this._depthStencilRenderbuffer.initialize(t,m,y.DEPTH_STENCIL),this._depthFBO=new N.Framebuffer(this._context,"DepthFBO"),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._primaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._secondaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.initialize([[l.COLOR_ATTACHMENT0,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.clearColor([1,1,1,1],0),this._depthFBO.initialize([[l.COLOR_ATTACHMENT0,this._depthStencilRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._depthFBO.clearColor([1,1,1,1],0)}initializeES2_extensions(t,m){const y=this._context.gl,l=this._context.gl2facade;this._drawRestricted=!1,this._context.isWebGL1&&(kr(this._context.supportsDrawBuffers,"expected WEBGL_draw_buffers to be supported"),kr(this._context.supportsDepthTexture,"expected WEBGL_depth_texture to be supported")),this._colorRenderTexture.initialize(t,m,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(t,m,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(t,m,y.DEPTH_STENCIL,y.DEPTH_STENCIL,this._context.depthTexture.UNSIGNED_INT_24_8_WEBGL),this._depthStencilRenderbuffer.initialize(t,m,y.DEPTH_STENCIL),this._primaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[l.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._idFBO.initialize([[l.COLOR_ATTACHMENT0,this._idRenderTexture]])}initializeES3(t,m){const y=this._context.gl,l=this._context.gl2facade;this._drawRestricted=!1,kr(this._context.isWebGL2,"expected a webgl2 context"),this._colorRenderTexture.initialize(t,m,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(t,m,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(t,m,y.DEPTH24_STENCIL8,y.DEPTH_STENCIL,y.UNSIGNED_INT_24_8),this._depthStencilRenderbuffer.initialize(t,m,y.DEPTH24_STENCIL8),this._primaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[l.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[l.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]])}initialize(){this._defaultFBO=new N.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new N.Texture2D(this._context,"ColorRenderTexture"),this._idRenderTexture=new N.Texture2D(this._context,"IdRenderTexture"),this._depthStencilRenderTexture=new N.Texture2D(this._context,"DepthStencilRenderTexture"),this._depthStencilRenderbuffer=new N.Renderbuffer(this._context,"DepthStencilRenderbuffer"),this._primaryFBO=new N.Framebuffer(this._context,"PrimaryFBO"),this._secondaryFBO=new N.Framebuffer(this._context,"SecondaryFBO");const t=this._defaultFBO.width,m=this._defaultFBO.height;return this._context.isWebGL2?this.initializeES3(t,m):this._context.supportsDepthTexture&&this._context.supportsDrawBuffers&&this._context.gl.getParameter(this._context.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)>=2?this.initializeES2_extensions(t,m):this.initializeES2_basic(t,m),this._primaryFBO.clearColor([0,0,0,1],0),this._secondaryFBO.clearColor([0,0,0,1],0),this._primaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._primaryFBO.clearStencil(0),this._secondaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._secondaryFBO.clearStencil(0),kr(this._primaryFBO.valid,`${this._primaryFBO.identifier} expected to be valid for rendering`),kr(this._secondaryFBO.valid,`${this._secondaryFBO.identifier} expected to be valid for rendering`),kr(this._idFBO===void 0||this._idFBO.valid,`${this._idFBO?this._idFBO.identifier:""} expected to be valid for rendering`),kr(this._depthFBO===void 0||this._depthFBO.valid,`${this._depthFBO?this._depthFBO.identifier:""} expected to be valid for rendering`),!0}uninitialize(){this._defaultFBO.uninitialize(),this._primaryFBO.uninitialize(),this._idFBO&&this._idFBO.uninitialize(),this._depthFBO&&this._depthFBO.uninitialize(),this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.uninitialize(),this._colorRenderTexture.uninitialize(),this._idRenderTexture.uninitialize(),this._depthStencilRenderTexture.uninitialize()}setClearColor(t){this._primaryFBO.clearColor(t,0),this._secondaryFBO.clearColor(t,0)}resize(t,m){this._primaryFBO.resize(t,m),this._secondaryFBO.resize(t,m),this._idFBO&&this._idFBO.resize(t,m),this._depthFBO&&this._depthFBO.resize(t,m)}get drawRestricted(){return this._drawRestricted}get primaryFBO(){return this._primaryFBO}get secondaryFBO(){return this._secondaryFBO}get defaultFBO(){return this._defaultFBO}get depthFBO(){return this._drawRestricted?this._depthFBO:void 0}get idFBO(){return this._drawRestricted?this._idFBO:void 0}get readBackIdFBO(){return this._idFBO}get colorRenderTexture(){return this._colorRenderTexture}get idRenderTexture(){return this._idRenderTexture}}i1([N.Initializable.initialize()],xt.prototype,"initialize");i1([N.Initializable.uninitialize()],xt.prototype,"uninitialize");(E=>{(t=>{t[t.Undefined=-1]="Undefined",t[t.Color=0]="Color",t[t.Id=1]="Id",t[t.Depth=2]="Depth"})(E.Attachment||(E.Attachment={}))})(xt||(xt={}));var Db=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec3  a_vertex;
attribute vec4  a_layout; 
attribute vec4  a_id; /* encoded uint32 id in byte4 */
attribute float a_areaScale;
attribute float a_color;
attribute float a_emphasis;
attribute vec2  a_heights; /* [ bottom: float, top: float ] */
attribute vec2  a_texCoord;

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec3  a_vertex;
in vec4  a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4  a_id; /* encoded uint32 id in byte4 */
in float a_areaScale;
in float a_color;
in float a_emphasis;
in vec2  a_heights; /* [ bottom: float, top: float ] */
in vec2  a_texCoord;

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform int u_face;
uniform vec4 u_normalAndLambert;

uniform float u_heightScale;
uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec4 v_uv;

const float ONE_OVER_255 = 1.0 / 255.0;
const int FACE_INDEX_TOP = 1; /* see CuboidRenderPass.FaceIndex.Top */

const vec3 AMBIENT = vec3(0.0, 0.0, 0.0); /* @todo expose to API */
const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

/**
 * Transforms the cuboid vertices based on the associated face and height mapping. An earlier implementation of this
 * used the same geometry template and transformed it to either orientation. The current implementation uses a pre-set
 * vertex sequence/orientation and has to adjust the height only.
 * Appart from that, each cuboid face is moved to its position and adjusted to the provided height values. ID, color,
 * and extent along the y-axis are encoded per vertex (or even per face/cuboid) to reduce per-fragment processing.
 */
void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    float height = (a_heights[1] - a_heights[0]) * u_heightScale;

    /* Compute the position and extend of the cuboid based on the face. */
    vec4 pos = vec4(a_layout[0], u_face == FACE_INDEX_TOP ?
        a_heights[1] * u_heightScale : a_heights[0] * u_heightScale, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], height, a_layout[3], 1.0);

    /* Area scaling */
    float shrinkage = 1.0 - a_areaScale * ONE_OVER_255;
    pos.x += ext.x * shrinkage * 0.5;
    pos.z += ext.z * shrinkage * 0.5;
    ext.x -= ext.x * shrinkage;
    ext.z -= ext.z * shrinkage;

    /* Compute the final vertex position and pass through texture coordinates and layout data. */
    vec4 vertex = vec4(a_vertex, 1.0) * ext + pos;

    v_uv.st = a_texCoord.st;
    v_id = a_id * ONE_OVER_255;

    /* The y-extent provides world-space height of the cuboid that can be used for fragment-processing. */
    v_uv[2] = 1.0; 
    v_uv[3] = height / mix(a_layout[2], a_layout[3], step(5.0, float(u_face)));

    /* REVIEW AND SIMPLIFY THE FOLLOWING COLOR COMPUTATION (probably to many states) */

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    int colorIndex = int(abs(a_color - 32.0));
    v_baseColor = mix(u_colorTable[colorIndex], emphasisColor, step(2.0, a_emphasis));

    vertex = u_viewProjection * vertex;

    v_uv[2] *= (a_texCoord.x - 0.5);
    v_uv[3] *= 1.0 - a_texCoord.y;

    v_baseColor = u_colorTable[colorIndex];
    v_baseColor = mix(v_baseColor, emphasisColor, step(2.0, a_emphasis));

    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline should be darkened based on the face orientation. */
    v_outlineColor.rgb = mix(AMBIENT, v_outlineColor.rgb, u_normalAndLambert[3]);
    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    v_baseColor = mix(vec4(AMBIENT, 1.0), v_baseColor, u_normalAndLambert[3]);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,jb=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

uniform int u_face;

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;

varying vec4 v_id;
varying vec4 v_uv;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];
    vec2 awidth2 = fwidth(v_uv.zw);

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step(v_uv.st - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(1.0), v_uv.st + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,Ub=Object.defineProperty,kb=Object.getOwnPropertyDescriptor,oi=(E,t,m,y)=>{for(var l=kb(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&Ub(t,m,l),l};const Gb=N.auxiliaries.log,qb=N.auxiliaries.LogLevel;var _e;const Qr=(_e=class extends N.Initializable{constructor(t){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!0,camera:!0,geometry:!0,colorTable:!0,colorTableLength:!0,emphases:!0,heightScale:!0,outlineWidth:!0,emphasisOutlineWidth:!0}),this._outlineWidth=_e.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=_e.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=xt.Attachment.Undefined,this._faceSequence=new Array,this._faceData=new Map,this._context=t,this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._program=new N.Program(t,"CuboidRenderProgram"),this._geometry=_e.referenceGeometry(t)}static referenceGeometry(t){let m;_e.GEOMETRY_BY_CONTEXT.has(t)?m=_e.GEOMETRY_BY_CONTEXT.get(t):(m=new K0(t,"CuboidGeometry"),m.initialize(),_e.GEOMETRY_BY_CONTEXT.set(t,m),_e.REFCOUNT_BY_GEOMETRY.set(m,0));const y=_e.REFCOUNT_BY_GEOMETRY.get(m)+1;return _e.REFCOUNT_BY_GEOMETRY.set(m,y),m}static unreferenceGeometry(t){if(!_e.GEOMETRY_BY_CONTEXT.has(t))return;const m=_e.GEOMETRY_BY_CONTEXT.get(t),y=_e.REFCOUNT_BY_GEOMETRY.get(m)-1;_e.REFCOUNT_BY_GEOMETRY.set(m,y),!(y>0)&&(m.uninitialize(),_e.GEOMETRY_BY_CONTEXT.delete(t),_e.REFCOUNT_BY_GEOMETRY.delete(m))}relink(){if(this._colorTable===void 0){Gb(qb.Warning,"Color table is not defined. Could not compile shaders.");return}for(const t of this._program.shaders)t.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_areaScale",this._geometry.areaScaleLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation),this._program.attribute("a_heights",this._geometry.heightLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation);for(const t of this._program.shaders)t.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uFace=this._program.uniform("u_face"),this._uNormalAndLambert=this._program.uniform("u_normalAndLambert"),this._uHeightScale=this._program.uniform("u_heightScale"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}optimizeFaceSequence(){const t=this._camera.eye,m=this._camera.center;let y=new Array;const l=N.vec3.create();N.vec3.sub(l,t,m),N.vec3.normalize(l,l),t[1]>0&&y.push([_e.Face.Top,Math.abs(N.vec3.dot(N.vec3.fromValues(0,1,0),l))]),t[2]>-1&&y.push([_e.Face.Front,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,1),l))]),t[2]<1&&y.push([_e.Face.Back,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,-1),l))]),t[0]>-1&&y.push([_e.Face.Left,Math.abs(N.vec3.dot(N.vec3.fromValues(1,0,0),l))]),t[0]<1&&y.push([_e.Face.Right,Math.abs(N.vec3.dot(N.vec3.fromValues(-1,0,0),l))]),y=y.sort((r,a)=>a[1]-r[1]),this._faceSequence=y.map(r=>r[0])}initialize(){const t=this._context.gl;this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const m=new N.Shader(this._context,t.VERTEX_SHADER,"cuboid.vert");m.initialize(Db,!1);const y=new N.Shader(this._context,t.FRAGMENT_SHADER,"cuboid.frag");return y.initialize(jb,!1),this._program.initialize([m,y],!1),this._faceData.set(_e.Face.Top,[0,1,0,1]),this._faceData.set(_e.Face.Bottom,[0,-1,0,.68]),this._faceData.set(_e.Face.Front,[0,0,1,.88]),this._faceData.set(_e.Face.Back,[0,0,-1,.88]),this._faceData.set(_e.Face.Left,[1,0,0,.84]),this._faceData.set(_e.Face.Right,[-1,0,0,.84]),!0}uninitialize(){_e.unreferenceGeometry(this._context),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uFace=void 0,this._uNormalAndLambert=void 0,this._uHeightScale=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const t=this._context.gl;let m=!1;if(!this._program.initialized||!this._program.linked||this._altered.colorTableLength){if(this.relink(),!this._program.linked)return;m=!0}if(this._program.bind(),(m||this._altered.camera||this._camera.altered)&&(t.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this.optimizeFaceSequence()),(m||this._colorTable)&&t.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),(m||this._altered.heightScale)&&t.uniform1f(this._uHeightScale,this._heightScale/255),(m||this._altered.outlineWidth)&&t.uniform1f(this._uOutlineWidth,this._outlineWidth),m||this._altered.emphasisOutlineWidth){const y=window.devicePixelRatio;t.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*y)}this._altered.reset()}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0||this._geometry.valid===void 0)return;const t=this._context.gl,m=this._target.size;t.viewport(0,0,m[0],m[1]),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,2,255),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),this._depthMask===!1&&(t.depthFunc(t.LEQUAL),t.depthMask(!1)),this._program.bind(),this._drawRestricted&&t.uniform1i(this._uAttachment,this._attachment),t.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind();for(const y of this._faceSequence){t.uniform1i(this._uFace,y),t.uniform4fv(this._uNormalAndLambert,this._faceData.get(y));const l=(y-1)*K0.BYTES_PER_VERTEX*4;this._topology.sliceRangeDo(this._topology.depth-1,(r,a)=>{const n=r-this._topology.numberOfInnerNodes,i=a-r+1;this._geometry.draw(n,l,i)})}this._depthMask===!1&&(t.depthFunc(t.LESS),t.depthMask(!0)),t.disable(t.STENCIL_TEST),t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)}colorTableLengthAltered(){this._altered.alter("colorTableLength")}set target(t){this.assertInitialized(),this._target=t}set topology(t){this._topology=t}set ndcOffset(t){this.assertInitialized(),this._ndcOffset=t}set camera(t){this.assertInitialized(),this._camera!==t&&(this._camera=t,this._altered.alter("camera"))}set layoutData(t){this.assertInitialized(),this._geometry.layout=t,this._altered.alter("geometry")}set ids(t){this.assertInitialized(),this._geometry.ids=t,this._altered.alter("geometry")}set areaScales(t){this.assertInitialized(),this._geometry.areaScales=t,this._altered.alter("geometry")}set colors(t){this.assertInitialized(),this._geometry.colors=t,this._altered.alter("geometry")}set emphases(t){this.assertInitialized(),this._geometry.emphases=t,this._altered.alter("emphases")}set heights(t){this.assertInitialized(),this._geometry.heights=t,this._altered.alter("geometry")}set colorTable(t){this.assertInitialized(),this._colorTable=t,this._altered.alter("colorTable")}set outlineWidth(t){this.assertInitialized(),this._outlineWidth!==t&&(this._outlineWidth=t===void 0?_e.OUTLINE_WIDTH_DEFAULT:Math.max(0,t),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(t){this.assertInitialized(),this._emphasisOutlineWidth!==t&&(this._emphasisOutlineWidth=t===void 0?_e.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,t),this._altered.alter("emphasisOutlineWidth"))}set heightScale(t){this.assertInitialized(),this._heightScale!==t&&(this._heightScale=t===void 0?0:N.gl_matrix_extensions.clamp(t,0,1),this._altered.alter("heightScale"))}set attachment(t){N.auxiliaries.logIf(t!==xt.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=t}set depthMask(t){this._depthMask=t}},_e.GEOMETRY_BY_CONTEXT=new Map,_e.REFCOUNT_BY_GEOMETRY=new Map,_e.OUTLINE_WIDTH_DEFAULT=.8,_e.EMPHASIS_OUTLINE_WIDTH_DEFAULT=1.6,_e);oi([N.Initializable.assert_initialized()],Qr.prototype,"relink");oi([N.Initializable.assert_initialized()],Qr.prototype,"optimizeFaceSequence");oi([N.Initializable.initialize()],Qr.prototype,"initialize");oi([N.Initializable.uninitialize()],Qr.prototype,"uninitialize");oi([N.Initializable.assert_initialized()],Qr.prototype,"update");oi([N.Initializable.assert_initialized()],Qr.prototype,"frame");let qr=Qr;(E=>{(t=>{t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Front=3]="Front",t[t.Back=4]="Back",t[t.Left=5]="Left",t[t.Right=6]="Right"})(E.Face||(E.Face={}))})(qr||(qr={}));var El=function(E,t){return El=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var l in y)Object.prototype.hasOwnProperty.call(y,l)&&(m[l]=y[l])},El(E,t)};function Ms(E,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");El(E,t);function m(){this.constructor=E}E.prototype=t===null?Object.create(t):(m.prototype=t.prototype,new m)}function Tl(E){var t=typeof Symbol=="function"&&Symbol.iterator,m=t&&E[t],y=0;if(m)return m.call(E);if(E&&typeof E.length=="number")return{next:function(){return E&&y>=E.length&&(E=void 0),{value:E&&E[y++],done:!E}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function xl(E,t){var m=typeof Symbol=="function"&&E[Symbol.iterator];if(!m)return E;var y=m.call(E),l,r=[],a;try{for(;(t===void 0||t-- >0)&&!(l=y.next()).done;)r.push(l.value)}catch(n){a={error:n}}finally{try{l&&!l.done&&(m=y.return)&&m.call(y)}finally{if(a)throw a.error}}return r}function Sl(E,t,m){if(m||arguments.length===2)for(var y=0,l=t.length,r;y<l;y++)(r||!(y in t))&&(r||(r=Array.prototype.slice.call(t,0,y)),r[y]=t[y]);return E.concat(r||Array.prototype.slice.call(t))}function Yt(E){return typeof E=="function"}function n1(E){var t=function(y){Error.call(y),y.stack=new Error().stack},m=E(t);return m.prototype=Object.create(Error.prototype),m.prototype.constructor=m,m}var pl=n1(function(E){return function(m){E(this),this.message=m?m.length+` errors occurred during unsubscription:
`+m.map(function(y,l){return l+1+") "+y.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=m}});function Al(E,t){if(E){var m=E.indexOf(t);0<=m&&E.splice(m,1)}}var Oo=function(){function E(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return E.prototype.unsubscribe=function(){var t,m,y,l,r;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var n=Tl(a),i=n.next();!i.done;i=n.next()){var h=i.value;h.remove(this)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(m=n.return)&&m.call(n)}finally{if(t)throw t.error}}else a.remove(this);var p=this.initialTeardown;if(Yt(p))try{p()}catch(u){r=u instanceof pl?u.errors:[u]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Tl(d),s=f.next();!s.done;s=f.next()){var o=s.value;try{Q0(o)}catch(u){r=r??[],u instanceof pl?r=Sl(Sl([],xl(r)),xl(u.errors)):r.push(u)}}}catch(u){y={error:u}}finally{try{s&&!s.done&&(l=f.return)&&l.call(f)}finally{if(y)throw y.error}}}if(r)throw new pl(r)}},E.prototype.add=function(t){var m;if(t&&t!==this)if(this.closed)Q0(t);else{if(t instanceof E){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(m=this._finalizers)!==null&&m!==void 0?m:[]).push(t)}},E.prototype._hasParent=function(t){var m=this._parentage;return m===t||Array.isArray(m)&&m.includes(t)},E.prototype._addParent=function(t){var m=this._parentage;this._parentage=Array.isArray(m)?(m.push(t),m):m?[m,t]:t},E.prototype._removeParent=function(t){var m=this._parentage;m===t?this._parentage=null:Array.isArray(m)&&Al(m,t)},E.prototype.remove=function(t){var m=this._finalizers;m&&Al(m,t),t instanceof E&&t._removeParent(this)},E.EMPTY=function(){var t=new E;return t.closed=!0,t}(),E}(),a1=Oo.EMPTY;function s1(E){return E instanceof Oo||E&&"closed"in E&&Yt(E.remove)&&Yt(E.add)&&Yt(E.unsubscribe)}function Q0(E){Yt(E)?E():E.unsubscribe()}var Wb={Promise:void 0},Vb={setTimeout:function(E,t){for(var m=[],y=2;y<arguments.length;y++)m[y-2]=arguments[y];return setTimeout.apply(void 0,Sl([E,t],xl(m)))},clearTimeout:function(E){return clearTimeout(E)},delegate:void 0};function $b(E){Vb.setTimeout(function(){throw E})}function J0(){}function lo(E){E()}var o1=function(E){Ms(t,E);function t(m){var y=E.call(this)||this;return y.isStopped=!1,m?(y.destination=m,s1(m)&&m.add(y)):y.destination=Yb,y}return t.create=function(m,y,l){return new Ol(m,y,l)},t.prototype.next=function(m){this.isStopped||this._next(m)},t.prototype.error=function(m){this.isStopped||(this.isStopped=!0,this._error(m))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,E.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(m){this.destination.next(m)},t.prototype._error=function(m){try{this.destination.error(m)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Oo),Hb=function(){function E(t){this.partialObserver=t}return E.prototype.next=function(t){var m=this.partialObserver;if(m.next)try{m.next(t)}catch(y){to(y)}},E.prototype.error=function(t){var m=this.partialObserver;if(m.error)try{m.error(t)}catch(y){to(y)}else to(t)},E.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(m){to(m)}},E}(),Ol=function(E){Ms(t,E);function t(m,y,l){var r=E.call(this)||this,a;return Yt(m)||!m?a={next:m??void 0,error:y??void 0,complete:l??void 0}:a=m,r.destination=new Hb(a),r}return t}(o1);function to(E){$b(E)}function Xb(E){throw E}var Yb={closed:!0,next:J0,error:Xb,complete:J0},Zb=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Kb(E){return E}function Qb(E){return E.length===0?Kb:E.length===1?E[0]:function(m){return E.reduce(function(y,l){return l(y)},m)}}var e_=function(){function E(t){t&&(this._subscribe=t)}return E.prototype.lift=function(t){var m=new E;return m.source=this,m.operator=t,m},E.prototype.subscribe=function(t,m,y){var l=this,r=eg(t)?t:new Ol(t,m,y);return lo(function(){var a=l,n=a.operator,i=a.source;r.add(n?n.call(r,i):i?l._subscribe(r):l._trySubscribe(r))}),r},E.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(m){t.error(m)}},E.prototype.forEach=function(t,m){var y=this;return m=t_(m),new m(function(l,r){var a=new Ol({next:function(n){try{t(n)}catch(i){r(i),a.unsubscribe()}},error:r,complete:l});y.subscribe(a)})},E.prototype._subscribe=function(t){var m;return(m=this.source)===null||m===void 0?void 0:m.subscribe(t)},E.prototype[Zb]=function(){return this},E.prototype.pipe=function(){for(var t=[],m=0;m<arguments.length;m++)t[m]=arguments[m];return Qb(t)(this)},E.prototype.toPromise=function(t){var m=this;return t=t_(t),new t(function(y,l){var r;m.subscribe(function(a){return r=a},function(a){return l(a)},function(){return y(r)})})},E.create=function(t){return new E(t)},E}();function t_(E){var t;return(t=E??Wb.Promise)!==null&&t!==void 0?t:Promise}function Jb(E){return E&&Yt(E.next)&&Yt(E.error)&&Yt(E.complete)}function eg(E){return E&&E instanceof o1||Jb(E)&&s1(E)}var tg=n1(function(E){return function(){E(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),u1=function(E){Ms(t,E);function t(){var m=E.call(this)||this;return m.closed=!1,m.currentObservers=null,m.observers=[],m.isStopped=!1,m.hasError=!1,m.thrownError=null,m}return t.prototype.lift=function(m){var y=new r_(this,this);return y.operator=m,y},t.prototype._throwIfClosed=function(){if(this.closed)throw new tg},t.prototype.next=function(m){var y=this;lo(function(){var l,r;if(y._throwIfClosed(),!y.isStopped){y.currentObservers||(y.currentObservers=Array.from(y.observers));try{for(var a=Tl(y.currentObservers),n=a.next();!n.done;n=a.next()){var i=n.value;i.next(m)}}catch(h){l={error:h}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(l)throw l.error}}}})},t.prototype.error=function(m){var y=this;lo(function(){if(y._throwIfClosed(),!y.isStopped){y.hasError=y.isStopped=!0,y.thrownError=m;for(var l=y.observers;l.length;)l.shift().error(m)}})},t.prototype.complete=function(){var m=this;lo(function(){if(m._throwIfClosed(),!m.isStopped){m.isStopped=!0;for(var y=m.observers;y.length;)y.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var m;return((m=this.observers)===null||m===void 0?void 0:m.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(m){return this._throwIfClosed(),E.prototype._trySubscribe.call(this,m)},t.prototype._subscribe=function(m){return this._throwIfClosed(),this._checkFinalizedStatuses(m),this._innerSubscribe(m)},t.prototype._innerSubscribe=function(m){var y=this,l=this,r=l.hasError,a=l.isStopped,n=l.observers;return r||a?a1:(this.currentObservers=null,n.push(m),new Oo(function(){y.currentObservers=null,Al(n,m)}))},t.prototype._checkFinalizedStatuses=function(m){var y=this,l=y.hasError,r=y.thrownError,a=y.isStopped;l?m.error(r):a&&m.complete()},t.prototype.asObservable=function(){var m=new e_;return m.source=this,m},t.create=function(m,y){return new r_(m,y)},t}(e_),r_=function(E){Ms(t,E);function t(m,y){var l=E.call(this)||this;return l.destination=m,l.source=y,l}return t.prototype.next=function(m){var y,l;(l=(y=this.destination)===null||y===void 0?void 0:y.next)===null||l===void 0||l.call(y,m)},t.prototype.error=function(m){var y,l;(l=(y=this.destination)===null||y===void 0?void 0:y.error)===null||l===void 0||l.call(y,m)},t.prototype.complete=function(){var m,y;(y=(m=this.destination)===null||m===void 0?void 0:m.complete)===null||y===void 0||y.call(m)},t.prototype._subscribe=function(m){var y,l;return(l=(y=this.source)===null||y===void 0?void 0:y.subscribe(m))!==null&&l!==void 0?l:a1},t}(u1),l1={now:function(){return(l1.delegate||Date).now()},delegate:void 0},gs=function(E){Ms(t,E);function t(m,y,l){m===void 0&&(m=1/0),y===void 0&&(y=1/0),l===void 0&&(l=l1);var r=E.call(this)||this;return r._bufferSize=m,r._windowTime=y,r._timestampProvider=l,r._buffer=[],r._infiniteTimeWindow=!0,r._infiniteTimeWindow=y===1/0,r._bufferSize=Math.max(1,m),r._windowTime=Math.max(1,y),r}return t.prototype.next=function(m){var y=this,l=y.isStopped,r=y._buffer,a=y._infiniteTimeWindow,n=y._timestampProvider,i=y._windowTime;l||(r.push(m),!a&&r.push(n.now()+i)),this._trimBuffer(),E.prototype.next.call(this,m)},t.prototype._subscribe=function(m){this._throwIfClosed(),this._trimBuffer();for(var y=this._innerSubscribe(m),l=this,r=l._infiniteTimeWindow,a=l._buffer,n=a.slice(),i=0;i<n.length&&!m.closed;i+=r?1:2)m.next(n[i]);return this._checkFinalizedStatuses(m),y},t.prototype._trimBuffer=function(){var m=this,y=m._bufferSize,l=m._timestampProvider,r=m._buffer,a=m._infiniteTimeWindow,n=(a?1:2)*y;if(y<1/0&&n<r.length&&r.splice(0,r.length-n),!a){for(var i=l.now(),h=0,p=1;p<r.length&&r[p]<=i;p+=2)h=p;h&&r.splice(0,h+1)}},t}(u1);const ys=N.gl_matrix_extensions.v2,ze=N.gl_matrix_extensions.v3,i_=N.gl_matrix_extensions.sign,n_=N.gl_matrix_extensions.clamp,vl=N.gl_matrix_extensions.clamp3,ii=N.auxiliaries.DEG2RAD,ml=N.auxiliaries.assert;class ro{constructor(){this.screen=N.vec2.create(),this.world=N.vec3.create()}}const Ze=class Ze extends N.CameraModifier{constructor(){super(...arguments),this.initialPoints=[new ro,new ro],this.currentPoints=[new ro,new ro],this.initialEye=N.vec3.create(),this.initialCenter=N.vec3.create(),this.initialViewProjectionInverse=N.mat4.create(),this._xAxisScreenSpace=N.vec3.create(),this._maxAngles=[+Math.PI*.6666-Math.PI,60*ii-Math.PI],this._minAngles=[-Math.PI*.6666-Math.PI,-Math.PI+1*ii],this.referencePlane=[N.vec3.create(),N.vec3.create(),0]}get valid(){return this.initialPoints[0].world!==void 0}set camera(t){this._camera=t}needStart(){return this._maxAngles===void 0||this._minAngles===void 0}set coordsAccess(t){this._coordsAccess=t}static rayY0SquareIntersection(t,m){const y=N.ray_math.rayPlaneIntersection(t,m);if(y===void 0)return;const l=N.vec2.fromValues(y[0],y[2]);return N.ray_math.isPointWithinSquare(l,Ze.HALF_SQUARE_LENGTH)?y:void 0}assert_valid(){}invalidate(){this.initialPoints[0].world=void 0,this.currentPoints[0].world=void 0,this.initialPoints[1].world=void 0,this.currentPoints[1].world=void 0}initiateTranslateConstraints(t){if(t){this._maxNegativeTranslate=void 0,this._maxPositiveTranslate=void 0;return}const m=N.vec3.fromValues(-1,0,-1),y=N.vec3.fromValues(1,0,1);this._maxNegativeTranslate=N.vec3.sub(ze(),m,this.initialCenter),this._maxPositiveTranslate=N.vec3.sub(ze(),y,this.initialCenter)}initiateScaleConstraints(t){const m=N.vec3.sub(ze(),this.initialEye,this.initialCenter),y=1/N.vec3.length(m);if(t){this._minScale=this._camera.near*y-1,this._maxScale=this._camera.far*y-1;return}N.ray_math.rayPlaneIntersection(this.initialEye,this.initialCenter,[0,0,0],[0,1,0])&&(this._minScale=this._camera.near*Ze.MIN_NEAR_PLANE_FACTOR*y-1,this._maxScale=Ze.MAX_DISTANCE_TO_SQUARE*y-1)}initiateRotateConstraints(t){const m=N.vec3.normalize(ze(),N.vec3.sub(ze(),this.initialEye,this.initialCenter));this._xAxisScreenSpace=N.vec3.cross(ze(),[0,1,0],m);const y=Math.acos(N.vec3.dot(m,[0,1,0]));if(this._maxAngles=[void 0,(90-.01)*ii-y],this._minAngles=[void 0,-y+.01*ii],t)return;const l=N.vec2.normalize(ys(),[m[0],m[2]]);let r=Math.asin(N.vec2.dot(l,[1,0]));l[1]<0&&(r=i_(r)*Math.PI-r),this._maxAngles=[+Math.PI*.6666-r,60*ii-y],this._minAngles=[-Math.PI*.6666-r,-y+1*ii]}initiate(t,m,y=[!1,!1,!1],l=!1){this._override=l;const r=this._camera.viewProjectionInverse;return r?(N.mat4.copy(this.initialViewProjectionInverse,r),N.vec3.copy(this.initialEye,this._camera.eye),N.vec3.copy(this.initialCenter,this._camera.center),N.vec2.copy(this.initialPoints[0].screen,t),this.initialPoints[0].world=this.coordsAt(t,!1),this.initialPoints[0].world===void 0?(this.invalidate(),!1):(this.initialPoints[1].screen=m===void 0?void 0:N.vec2.copy(ys(),m),this.initialPoints[1].world=this.coordsAt(m,!1),this.referencePlane[0]=this.initialPoints[0].world,this.referencePlane[1]=N.vec3.fromValues(0,1,0),this.referencePlane[2]=N.vec3.length(this.initialPoints[0].world),ml(this.initialCenter[1]===0,"camera center is expected to be on y = 0 (ground plane)"),y[0]&&this.initiateTranslateConstraints(l),y[1]&&this.initiateScaleConstraints(l),y[2]&&this.initiateRotateConstraints(l),!0)):!1}update_positions(t,m){return this.assert_valid(),this.currentPoints[0].world=this.coordsAt(t),this._override&&this.currentPoints[0].world===void 0?(this.invalidate(),!1):(N.vec2.copy(this.currentPoints[0].screen,t),m===void 0?!0:(this.currentPoints[1].world=this.coordsAt(m),this._override&&this.currentPoints[1].world===void 0?(this.invalidate(),!1):(this.currentPoints[1].screen=m===void 0?void 0:N.vec2.copy(ys(),m),!0)))}translate(){this.assert_valid();const t=this.initialPoints[0].world,m=this.currentPoints[0].world;if(!t||!m)return;const y=N.vec3.subtract(ze(),t,m);this._maxNegativeTranslate&&this._maxPositiveTranslate&&vl(y,y,this._maxNegativeTranslate,this._maxPositiveTranslate),this._camera.eye=N.vec3.add(ze(),this.initialEye,y);const l=N.vec3.add(ze(),this.initialCenter,y),r=N.ray_math.rayPlaneIntersection(this._camera.eye,l);r&&(this._camera.center=r)}scale(t){this.assert_valid(),ml(this._minScale!==void 0&&this._maxScale!==void 0,"valid scale constraints expected");let m;if(t===void 0){const h=this.currentPoints[0].screen,p=this.initialPoints[0].screen;if(!p||!h)return;m=N.vec2.subtract(ys(),p,h)[1]/window.devicePixelRatio}else m=-i_(t)*Ze.SCALE_STEP_FACTOR;m=n_(m*Ze.SCALE_FACTOR,this._minScale,this._maxScale);const y=this.initialPoints[0].world;if(!y)return;const l=N.vec3.sub(ze(),this.initialEye,y),r=N.vec3.sub(ze(),this.initialCenter,y),a=N.vec3.add(ze(),this.initialEye,N.vec3.scale(ze(),l,m)),n=N.vec3.add(ze(),this.initialCenter,N.vec3.scale(ze(),r,m)),i=N.ray_math.rayPlaneIntersection(this._camera.eye,n);i&&(this._camera.center=this._override?i:vl(ze(),i,[-1,0,-1],[1,0,1]),this._camera.eye=N.vec3.add(ze(),a,N.vec3.sub(ze(),this._camera.center,i)))}rotate(){this.assert_valid();const t=this.currentPoints[0].screen,m=this.initialPoints[0].screen;if(!m||!t)return;const y=N.vec2.subtract(ys(),m,t);N.vec2.scale(y,y,window.devicePixelRatio*Ze.ROTATE_FACTOR),this._minAngles[1]&&this._maxAngles[1]&&(y[1]=n_(y[1],this._minAngles[1],this._maxAngles[1]));const l=this._override?this.initialCenter:vl(ze(),this.initialCenter,[-1,0,-1],[1,0,1]),r=N.mat4.translate(N.mat4.create(),N.mat4.create(),l);N.mat4.rotateY(r,r,y[0]),N.mat4.rotate(r,r,y[1],this._xAxisScreenSpace),N.mat4.translate(r,r,N.vec3.negate(ze(),l)),this._camera.center=l;const a=N.vec3.transformMat4(ze(),this.initialEye,r);a&&(this._camera.eye=a)}coordsAt(t,m=!0){if(t===void 0)return;const y=m?this.initialViewProjectionInverse:this._camera.viewProjectionInverse;if(m){ml(this.referencePlane[0]!==void 0&&this.referencePlane[1]!==void 0,"valid reference plane expected for reference coordinate retrieval");const n=this._coordsAccess(t[0],t[1],0,y),i=this._coordsAccess(t[0],t[1],1,y);return N.ray_math.rayPlaneIntersection(n,i,this.referencePlane[0],this.referencePlane[1])}const l=this._coordsAccess(t[0],t[1],void 0,y);if(l!==void 0)return l;const r=this._coordsAccess(t[0],t[1],0,y),a=this._coordsAccess(t[0],t[1],1,y);return Ze.rayY0SquareIntersection(r,a)}update(){}};Ze.HALF_SQUARE_LENGTH=2,Ze.SCALE_FACTOR=.004,Ze.SCALE_STEP_FACTOR=16,Ze.ROTATE_FACTOR=.002,Ze.MAX_DISTANCE_TO_SQUARE=4,Ze.MIN_NEAR_PLANE_FACTOR=4;let wl=Ze;const a_=N.auxiliaries.assert,s_=N.gl_matrix_extensions.v2;class Ge{constructor(t,m){this._mouseMovedSinceDown=!1,this._cameraModifier=new wl,this._nodeEnterSubject=new gs(1),this._nodeMoveSubject=new gs(1),this._nodeLeaveSubject=new gs(1),this._nodeSelectSubject=new gs(1),this._navigationStartSubject=new gs(1),this._invalidate=t;const y="ontouchstart";this._touchSupported=document.documentElement&&y in document.documentElement||y in document.body,m.mouseEventProvider.preventDefault(N.MouseEventProvider.Type.Wheel,N.MouseEventProvider.Type.Click),m.pointerEventProvider.preventDefault(N.PointerEventProvider.Type.Down,N.PointerEventProvider.Type.Move,N.PointerEventProvider.Type.Up),this._eventHandler=new N.EventHandler(t,m),this._eventHandler.pushMouseDownHandler((l,r)=>this.onMouseDown(l,r)),this._eventHandler.pushMouseUpHandler((l,r)=>this.onMouseUp(l,r)),this._eventHandler.pushMouseMoveHandler((l,r)=>this.onMouseMove(l,r)),this._eventHandler.pushMouseWheelHandler((l,r)=>this.onMouseWheel(l,r)),this._eventHandler.pushClickHandler((l,r)=>this.onClick(l,r)),this._touchSupported&&(this._eventHandler.pushTouchStartHandler((l,r)=>this.onTouchStart(l,r)),this._eventHandler.pushTouchEndHandler((l,r)=>this.onTouchEnd(l,r)),this._eventHandler.pushTouchMoveHandler((l,r)=>this.onTouchMove(l,r)),this._eventHandler.pushTouchCancelHandler((l,r)=>this.onTouchCancel(l,r)))}mode(t){const m=t.type==="mousedown"||t.type==="mousemove",y=t.type==="wheel";if(m&&this.isPrimaryButtonDown(t))return Ge.Mode.Rotate;if(m&&this.isSecondaryButtonDown(t))return Ge.Mode.Pan;if(m&&this.isAuxiliaryButtonDown(t))return Ge.Mode.Zoom;if(y)return Ge.Mode.ZoomStep;if(this._touchSupported&&t instanceof TouchEvent&&t.touches.length===1)return Ge.Mode.Pan}rotate(t,m){const y=N.vec2.fromValues(t.clientX,t.clientY);m||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!1,!0],t.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.rotate())}pan(t,m){const y=this._eventHandler.offsets(t)[0];m||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!0,!1,!1],t.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.translate())}zoom(t,m){const y=this._eventHandler.offsets(t)[0];m||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!0,!1],t.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.scale())}emitNodeMovementEvents(t){if(this._idAccess===void 0)return;const m=this._eventHandler.offsets(t,!1)[0],y=N.vec2.scale(s_(),m,window.devicePixelRatio),l=this._idAccess.idAt(y[0],y[1]);this._lastNode===l&&l!==void 0&&this._nodeMoveSubject.next({node:l,point:m}),this._lastNode!==l&&this._lastNode!==void 0&&this._nodeLeaveSubject.next({node:this._lastNode,point:m}),this._lastNode!==l&&l!==void 0&&this._nodeEnterSubject.next({node:l,point:m}),this._lastNode=l}emitNodeClick(t){if(this._idAccess===void 0)return;const m=this._eventHandler.offsets(t,!1)[0],y=N.vec2.scale(s_(),m,window.devicePixelRatio),l=this._idAccess.idAt(y[0],y[1]);l!==void 0&&this._nodeSelectSubject.next({node:l,point:m})}applyZoomStep(t){const m=this._eventHandler.offsets(t)[0];this._cameraModifier.initiate(m,void 0,[!1,!0,!1],t.shiftKey),t.preventDefault(),this._cameraModifier.scale(t.deltaY)}onMouseDown(t,m){this._mouseMovedSinceDown=!1}onMouseUp(t,m){}onMouseMove(t,m){const y=t[t.length-1];this._mouseMovedSinceDown=!0;const l=this._mode===void 0;switch(this._mode=this.mode(y),this._mode){case Ge.Mode.Rotate:this.rotate(y,l),l&&this._navigationStartSubject.next();return;case Ge.Mode.Pan:this.pan(y,l),l&&this._navigationStartSubject.next();return;case Ge.Mode.Zoom:this.zoom(y,l),l&&this._navigationStartSubject.next();return;default:this.emitNodeMovementEvents(y);break}}onClick(t,m){const y=t[t.length-1];switch(this._mode){case Ge.Mode.Rotate:case Ge.Mode.Pan:case Ge.Mode.Zoom:return;default:this.emitNodeClick(y);break}}onMouseWheel(t,m){const y=t[t.length-1];switch(this._mode=this.mode(y),this._mode){case Ge.Mode.ZoomStep:this.applyZoomStep(y),this._navigationStartSubject.next();break}}onTouchStart(t,m){const y=t[t.length-1];if(this._mode=this.mode(y),this._mode===Ge.Mode.Pan){this.pan(y,!0);return}a_(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchMove(t,m){const y=t[t.length-1],l=this._mode===void 0;if(this._mode=this.mode(y),this._mode===Ge.Mode.Pan){this.pan(y,l);return}a_(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchEnd(t,m){}onTouchCancel(t,m){}isPrimaryButtonDown(t){return(t.buttons===void 0?t.which:t.buttons)===1}isSecondaryButtonDown(t){return t.buttons===void 0?t.which===3:t.buttons===2}isAuxiliaryButtonDown(t){return t.buttons===void 0?t.which===2:t.buttons===4}update(){this._eventHandler.update()}set camera(t){this._camera=t,this._cameraModifier.camera=t}set coordsAccess(t){this._coordsAccess=t,this._cameraModifier.coordsAccess=this._coordsAccess.coordsAt}set idAccess(t){this._idAccess=t}get nodeEnter$(){return this._nodeEnterSubject.asObservable()}get nodeMove$(){return this._nodeMoveSubject.asObservable()}get nodeLeave$(){return this._nodeLeaveSubject.asObservable()}get nodeSelect$(){return this._nodeSelectSubject.asObservable()}get navigationStart$(){return this._navigationStartSubject.asObservable()}}(E=>{(t=>{t[t.Move=0]="Move",t[t.Pan=1]="Pan",t[t.Rotate=2]="Rotate",t[t.Zoom=3]="Zoom",t[t.ZoomStep=4]="ZoomStep"})(E.Mode||(E.Mode={}))})(Ge||(Ge={}));var rg=Object.defineProperty,ig=Object.getOwnPropertyDescriptor,ng=(E,t,m,y)=>{for(var l=ig(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&rg(t,m,l),l};class c1 extends N.Geometry{constructor(t,m){super(t,m),m=m!==void 0&&m!==""?m:"PointGeometry",this._vertices=new N.Buffer(t,`${m}VertexVBO`),this._buffers.push(this._vertices),this._colors=new N.Buffer(t,`${m}ColorVBO`),this._buffers.push(this._colors)}bindBuffers(t){const m=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,m.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._colors.attribEnable(this._colorLocation,4,m.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,0)}unbindBuffers(t){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(t=0,m=1){this._vertexLocation=t,this._colorLocation=m;const y=this.context.gl;return super.initialize([y.ARRAY_BUFFER,y.ARRAY_BUFFER])&&this._vertices.valid}update(){this.bind()}draw(t=0){if(!this._count)return;const m=this.context.gl;this._vertices.attribEnable(this._vertexLocation,3,m.FLOAT,!1,0,t*4,!0,!1),this._colors.attribEnable(this._colorLocation,4,m.FLOAT,!1,0,t*4,!0,!1),m.drawArrays(m.POINTS,0,this._count)}set vertices(t){this._count=t.length/3,this._vertices.data(t,this.context.gl.STATIC_DRAW)}set colors(t){this._colors.data(t,this.context.gl.STATIC_DRAW)}get valid(){return this.initialized&&this._vertices.valid&&this._colors&&this._colors.valid}get vertexLocation(){return this._vertexLocation}get colorLocation(){return this._colorLocation}}ng([N.Initializable.assert_initialized()],c1.prototype,"draw");var ag=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100
attribute vec3 a_vertex;
attribute vec4 a_color;
#else

in vec3 a_vertex;
in vec4 a_color;
#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;
uniform float u_pointSize;

varying vec4 v_color;

void main(void)
{
    vec4 vertex = u_viewProjection * vec4(a_vertex, 1.0);

    v_color = a_color;

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
    gl_PointSize = u_pointSize;
}`,sg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
    #endif
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying vec4 v_color;

void main(void)
{
    
    
    

    float dist = distance(gl_PointCoord, vec2(0.5, 0.5));
    float alpha = v_color.a - step(0.5, dist);

    fragColor = vec4(v_color.xyz, alpha);
}`,og=Object.defineProperty,ug=Object.getOwnPropertyDescriptor,Is=(E,t,m,y)=>{for(var l=ug(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&og(t,m,l),l};class ui extends N.Initializable{constructor(t){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=t,this._program=new N.Program(t,"PointRenderProgram"),this._geometry=new c1(this._context,"Point")}relink(){for(const t of this._program.shaders)t.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uPointSize=this._program.uniform("u_pointSize"))}initialize(){const t=this._context.gl,m=new N.Shader(this._context,t.VERTEX_SHADER,"point.vert");m.initialize(ag,!1);const y=new N.Shader(this._context,t.FRAGMENT_SHADER,"point.frag");return y.initialize(sg,!1),this._program.initialize([y,m],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uPointSize=void 0}update(){const t=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&t.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const t=this._context.gl,m=this._target.size;t.viewport(0,0,m[0],m[1]),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(t.depthFunc(t.LEQUAL),t.depthMask(!1)),this._program.bind(),t.uniform2fv(this._uNdcOffset,this._ndcOffset),t.uniform1f(this._uPointSize,this._pointSize*window.devicePixelRatio),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(t.depthFunc(t.LESS),t.depthMask(!0)),t.disable(t.BLEND)}set target(t){this.assertInitialized(),this._target=t}set ndcOffset(t){this.assertInitialized(),this._ndcOffset=t}set pointSize(t){this._pointSize=t}set camera(t){this.assertInitialized(),this._camera!==t&&(this._camera=t,this._altered.alter("camera"))}set positions(t){this._geometry.vertices=t,this._altered.alter("geometry")}set colors(t){this.assertInitialized(),this._geometry.colors=t,this._altered.alter("geometry")}set depthMask(t){this._depthMask=t}}Is([N.Initializable.assert_initialized()],ui.prototype,"relink");Is([N.Initializable.initialize()],ui.prototype,"initialize");Is([N.Initializable.uninitialize()],ui.prototype,"uninitialize");Is([N.Initializable.assert_initialized()],ui.prototype,"update");Is([N.Initializable.assert_initialized()],ui.prototype,"frame");var lg=Object.defineProperty,cg=Object.getOwnPropertyDescriptor,hg=(E,t,m,y)=>{for(var l=cg(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&lg(t,m,l),l},Wr;const h1=(Wr=class extends N.Geometry{constructor(t,m){super(t,m),m=m!==void 0&&m!==""?m:"QuadGeometry",this._vertices=new N.Buffer(t,m+"VertexVBO"),this._buffers.push(this._vertices),this._layout=new N.Buffer(t,m+"LayoutVBO"),this._buffers.push(this._layout),this._ids=new N.Buffer(t,m+"IdVBO"),this._buffers.push(this._ids),this._emphases=new N.Buffer(t,m+"EmphasisVBO"),this._buffers.push(this._emphases),this._colors=new N.Buffer(t,m+"ColorVBO"),this._buffers.push(this._colors)}bindBuffers(t){const m=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._layout.attribEnable(this._layoutLocation,4,m.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._colors.attribEnable(this._colorLocation,1,m.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1)}unbindBuffers(t){this._vertices.attribDisable(this.vertexLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(t=0,m=2,y=3,l=4,r=5){this._vertexLocation=t,this._idLocation=y,this._layoutLocation=m,this._colorLocation=r,this._emphasisLocation=l;const a=this.context.gl,n=super.initialize([a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER]);return this._vertices.data(Wr.DATA,a.STATIC_DRAW),n&&this._vertices.valid}update(){this.bind()}draw(t=0,m=0){const y=this.context.gl,l=this.context.gl2facade;this._ids.attribEnable(this._idLocation,4,y.UNSIGNED_BYTE,!1,4,t*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,y.FLOAT,!1,16,t*16,!0,!1),this._colors.attribEnable(this._colorLocation,1,y.UNSIGNED_BYTE,!1,1,t*1,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,y.UNSIGNED_BYTE,!1,1,t*1,!0,!1),l.drawArraysInstanced(y.TRIANGLE_STRIP,0,4,m)}set layout(t){this._layout.data(t,this.context.gl.STATIC_DRAW)}set ids(t){this._ids.data(t,this.context.gl.STATIC_DRAW)}set colors(t){this._colors.data(t,this.context.gl.STATIC_DRAW)}set emphases(t){this._emphases.data(t,this.context.gl.STATIC_DRAW)}get valid(){const t=this._layout&&this._layout.valid,m=this._ids&&this._ids.valid,y=this._colors&&this._colors.valid,l=this._emphases&&this._emphases.valid;return this.initialized&&this._vertices.valid&&t&&m&&y&&l}get vertexLocation(){return this._vertexLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get colorLocation(){return this._colorLocation}},Wr.DATA=new Float32Array([0,0,0,1,1,0,1,1]),Wr);hg([N.Initializable.assert_initialized()],h1.prototype,"draw");let dg=h1;var fg=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec2 a_vertex;
attribute vec4 a_layout; 
attribute vec4 a_id; /* encoded uint32 id in byte4 */
attribute float a_color; /* color index as unsigned byte */
attribute float a_emphasis; /* emphasis mode as unsigned byte */

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec2 a_vertex;
in vec4 a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4 a_id; /* encoded uint32 id in byte4 */
in float a_color; /* color index as unsigned byte */
in float a_emphasis; /* emphasis mode as unsigned byte */

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec2 v_uv;
varying vec4 v_layout;

const float ONE_OVER_255 = 1.0 / 255.0;

const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    vec4 pos = vec4(a_layout[0], 0.0, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], 0.0, a_layout[3], 1.0);

    vec4 vertex = vec4(a_vertex.x, 0.0, a_vertex.y, 1.0) * ext + pos;

    v_uv = vertex.xz;
    v_layout = a_layout;
    v_id = a_id * ONE_OVER_255;

    vertex = u_viewProjection * vertex;

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    v_baseColor = mix(u_colorTable[int(a_color)], emphasisColor, step(2.0, a_emphasis));
    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,_g=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying mediump vec2 v_uv;
varying mediump vec4 v_layout;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step((v_uv.st - v_layout.xy) - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(0.0), (v_uv.st - v_layout.xy) - v_layout.zw + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,pg=Object.defineProperty,vg=Object.getOwnPropertyDescriptor,Fs=(E,t,m,y)=>{for(var l=vg(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&pg(t,m,l),l};class li extends N.Initializable{constructor(t){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1,colorTable:!1,emphases:!1,outlineWidth:!0,emphasisOutlineWidth:!0}),this._showRoot=!1,this._outlineWidth=qr.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=qr.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=xt.Attachment.Undefined,this._context=t,this._program=new N.Program(t,"QuadRenderProgram"),this._geometry=new dg(this._context,"Quad")}relink(){if(this._colorTable!==void 0){for(const t of this._program.shaders)t.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation);for(const t of this._program.shaders)t.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}}initialize(){const t=this._context.gl;this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const m=new N.Shader(this._context,t.VERTEX_SHADER,"quad.vert");m.initialize(fg,!1);const y=new N.Shader(this._context,t.FRAGMENT_SHADER,"quad.frag");return y.initialize(_g,!1),this._program.initialize([y,m],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const t=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&t.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._colorTable&&t.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.outlineWidth&&t.uniform1f(this._uOutlineWidth,this._outlineWidth),this._target&&this._target.valid&&t.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*window.devicePixelRatio),this._altered.reset())}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0)return;const t=this._context.gl,m=this._target.size;if(t.viewport(0,0,m[0],m[1]),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.stencilFunc(t.GREATER,1,255),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),this._depthMask===!1&&(t.depthFunc(t.LEQUAL),t.depthMask(!1)),this._program.bind(),this._drawRestricted&&t.uniform1i(this._uAttachment,this._attachment),t.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid){const y=this._topology.linearization.slices,l=this._showRoot===!1?1:0;for(let r=y.length-2;r>=l;--r){const a=y[r][0],n=y[r][1]-y[r][0]+1;this._geometry.draw(a,n)}}this._depthMask===!1&&(t.depthFunc(t.LESS),t.depthMask(!0)),t.disable(t.STENCIL_TEST),t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)}set target(t){this.assertInitialized(),this._target=t}set ndcOffset(t){this.assertInitialized(),this._ndcOffset=t}set camera(t){this.assertInitialized(),this._camera!==t&&(this._camera=t,this._altered.alter("camera"))}set layout(t){this.assertInitialized(),this._geometry.layout=t,this._altered.alter("geometry")}set ids(t){this.assertInitialized(),this._geometry.ids=t,this._altered.alter("geometry")}set colors(t){this.assertInitialized(),this._geometry.colors=t,this._altered.alter("geometry")}set emphases(t){this.assertInitialized(),this._geometry.emphases=t,this._altered.alter("emphases")}set showRoot(t){this._showRoot=!!t}set topology(t){this._topology=t}set colorTable(t){this.assertInitialized(),this._colorTable=t,this._altered.alter("colorTable")}set outlineWidth(t){this.assertInitialized(),this._outlineWidth!==t&&(this._outlineWidth=t===void 0?qr.OUTLINE_WIDTH_DEFAULT:Math.max(0,t),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(t){this.assertInitialized(),this._emphasisOutlineWidth!==t&&(this._emphasisOutlineWidth=t===void 0?qr.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,t),this._altered.alter("emphasisOutlineWidth"))}set attachment(t){N.auxiliaries.logIf(t!==xt.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=t}set depthMask(t){this._depthMask=t}}Fs([N.Initializable.assert_initialized()],li.prototype,"relink");Fs([N.Initializable.initialize()],li.prototype,"initialize");Fs([N.Initializable.uninitialize()],li.prototype,"uninitialize");Fs([N.Initializable.assert_initialized()],li.prototype,"update");Fs([N.Initializable.assert_initialized()],li.prototype,"frame");var mg=Object.defineProperty,bg=Object.getOwnPropertyDescriptor,gg=(E,t,m,y)=>{for(var l=bg(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&mg(t,m,l),l};const yg=N.auxiliaries.assert;var Vr;const d1=(Vr=class extends N.Geometry{constructor(t,m){super(t,m),yg(t.isWebGL2||t.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),m=m!==void 0&&m!==""?m:"ScreenAlignedQuadGeometry",this._vertices=new N.Buffer(t,`${m}VertexVBO`),this._buffers.push(this._vertices),this._origins=new N.Buffer(t,`${m}OriginVBO`),this._buffers.push(this._origins),this._extents=new N.Buffer(t,`${m}ExtentVBO`),this._buffers.push(this._extents),this._offsets=new N.Buffer(t,`${m}OffsetVBO`),this._buffers.push(this._offsets),this._pointyCorners=new N.Buffer(t,`${m}PointyCornerVBO`),this._buffers.push(this._pointyCorners)}bindBuffers(t){const m=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._origins.attribEnable(this._originLocation,3,m.FLOAT,!1,12,0,!0,!1),y.vertexAttribDivisor(this._originLocation,1),this._extents.attribEnable(this._extentLocation,2,m.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._extentLocation,1),this._offsets.attribEnable(this._offsetLocation,2,m.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._offsetLocation,1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,m.UNSIGNED_BYTE,!1,1,0,!0,!1),y.vertexAttribDivisor(this._pointyCornerLocation,1)}unbindBuffers(t){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._extents.attribDisable(this._extentLocation,!1,!1),this._offsets.attribDisable(this._offsetLocation,!1,!1),this._pointyCorners.attribDisable(this._pointyCornerLocation,!1,!1)}initialize(t=0,m=1,y=2,l=3,r=4){this._vertexLocation=t,this._originLocation=m,this._extentLocation=y,this._offsetLocation=l,this._pointyCornerLocation=r;const a=this.context.gl,n=super.initialize([a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER,a.ARRAY_BUFFER]);return this._vertices.data(Vr.VERTICES,a.STATIC_DRAW),n&&this._vertices.valid}updateData(t,m,y,l){this.bind(),this._count=t.length/3,this._origins.data(t,this.context.gl.STATIC_DRAW),this._extents.data(m,this.context.gl.STATIC_DRAW),this._offsets.data(y,this.context.gl.STATIC_DRAW),this._pointyCorners.data(l,this.context.gl.STATIC_DRAW)}update(){this.bind()}draw(t=0){if(!this._count)return;const m=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,8,0,!0,!1),this._origins.attribEnable(this._originLocation,3,m.FLOAT,!1,12,t*12,!0,!1),this._extents.attribEnable(this._extentLocation,2,m.FLOAT,!1,8,t*8,!0,!1),this._offsets.attribEnable(this._offsetLocation,2,m.FLOAT,!1,8,t*8,!0,!1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,m.UNSIGNED_BYTE,!1,1,t*1,!0,!1),y.drawArraysInstanced(m.TRIANGLE_STRIP,0,4,this._count)}get valid(){return this.initialized&&this._vertices.valid&&this._origins&&this._origins.valid&&this._offsets&&this._offsets.valid&&this._extents&&this._extents.valid&&this._pointyCorners&&this._pointyCorners.valid}get vertexLocation(){return this._vertexLocation}get originLocation(){return this._originLocation}get extentLocation(){return this._extentLocation}get offsetLocation(){return this._offsetLocation}get pointyCornerLocation(){return this._pointyCornerLocation}},Vr.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),Vr);gg([N.Initializable.assert_initialized()],d1.prototype,"draw");let Eg=d1;var Tg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

#extension GL_EXT_draw_buffers : enable
attribute vec2 a_vertex;
attribute vec3 a_origin;
attribute vec2 a_extent;
attribute vec2 a_offset;
attribute float a_pointyCorner;

#else

in vec2 a_vertex;
in vec3 a_origin;
in vec2 a_extent;
in vec2 a_offset;
in float a_pointyCorner; 

#endif

uniform vec2 u_ndcOffset;
uniform mat4 u_viewProjection;
uniform float u_aspectRatio;

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

float modI(float a, float b) {
    float m = a - floor((a + 0.5) / b) * b;
    return floor(m + 0.5);
}

void main(void)
{
    v_pointyCornerLeft = step(a_pointyCorner, 2.0);
    v_pointyCornerBottom = modI(a_pointyCorner, 2.0);

    /* POSITIONING */
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.
     * 2-------4
     * |  \\    |
     * |    \\  |
     * 1-------3
     * The current vertex is calculated based on the current quad corners and the extent attributes.
     */

    vec2 extent = a_extent;
    vec2 offset = a_offset;

    
    float radius = extent.y * u_aspectRatio * 0.5;
    extent.x += radius;
    offset.x -= mix(radius, 0.0, step(a_pointyCorner, 2.0));

    v_extent = vec2(extent.x, extent.y * u_aspectRatio);
    v_uv = a_vertex * vec2(extent.x, extent.y * u_aspectRatio);
    v_radius = radius;

    vec4 origin = u_viewProjection * vec4(a_origin, 1.0);
    vec2 originNDC = vec2(origin.x / origin.w, origin.y / origin.w);
    vec4 vertex = vec4(originNDC + a_vertex * extent + offset, origin.z/origin.w, 1.0);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,xg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
    #define fragColor gl_FragColor
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

const float ALPHA = 0.8;
const vec3 COLOR = vec3(1.0);

void main(void)
{
    

    
    vec2 mLeft =  vec2(v_radius);
    vec2 mRight = vec2(v_extent.x - v_radius, v_radius);

    
    float borderLeft =   step(v_uv.x, mLeft.x);
    float borderBottom = step(v_uv.y, mLeft.y);
    float borderRight =  step(mRight.x, v_uv.x);
    float borderTop =    step(mRight.y, v_uv.y);

    float alphaLeft =  step(v_radius, distance(v_uv, mLeft))  * borderLeft;
    float alphaRight = step(v_radius, distance(v_uv, mRight)) * borderRight;

    
    
    float alphaLeftBottom =  alphaLeft  * borderBottom;
    float alphaLeftTop =     alphaLeft  * borderTop;
    float alphaRightBottom = alphaRight * borderBottom;
    float alphaRightTop =    alphaRight * borderTop;

    
    float pointyLeftBottom =         v_pointyCornerLeft  *        v_pointyCornerBottom;
    float pointyLeftTop =            v_pointyCornerLeft  * (1.0 - v_pointyCornerBottom);
    float pointyRightBottom = (1.0 - v_pointyCornerLeft) *        v_pointyCornerBottom;
    float pointyRightTop =    (1.0 - v_pointyCornerLeft) * (1.0 - v_pointyCornerBottom);

    
    float shouldBeCutAway = sign(
          alphaLeftBottom  * (1.0 - pointyLeftBottom)
        + alphaLeftTop     * (1.0 - pointyLeftTop)
        + alphaRightBottom * (1.0 - pointyRightBottom)
        + alphaRightTop    * (1.0 - pointyRightTop));

    float alpha = mix(ALPHA, 0.0, shouldBeCutAway);
    fragColor = vec4(COLOR, alpha);
}`,Sg=Object.defineProperty,Ag=Object.getOwnPropertyDescriptor,Cs=(E,t,m,y)=>{for(var l=Ag(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&Sg(t,m,l),l};class ci extends N.Initializable{constructor(t){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=t,this._program=new N.Program(t,"ScreenAlignedQuadRenderProgram"),this._geometry=new Eg(this._context,"ScreenAlignedQuad")}relink(){for(const t of this._program.shaders)t.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_extent",this._geometry.extentLocation),this._program.attribute("a_offset",this._geometry.offsetLocation),this._program.attribute("a_pointyCorner",this._geometry.pointyCornerLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uAspectRatio=this._program.uniform("u_aspectRatio"))}initialize(){const t=this._context.gl,m=new N.Shader(this._context,t.VERTEX_SHADER,"screenalignedquad.vert");m.initialize(Tg,!1);const y=new N.Shader(this._context,t.FRAGMENT_SHADER,"screenalignedquad.frag");return y.initialize(xg,!1),this._program.initialize([y,m],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uAspectRatio=void 0}update(){const t=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&(t.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),t.uniform1f(this._uAspectRatio,1/this._camera.aspect)),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const t=this._context.gl,m=this._target.size;t.viewport(0,0,m[0],m[1]),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(t.depthFunc(t.LEQUAL),t.depthMask(!1)),this._program.bind(),t.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(t.depthFunc(t.LESS),t.depthMask(!0)),t.disable(t.BLEND)}set target(t){this.assertInitialized(),this._target=t}set ndcOffset(t){this.assertInitialized(),this._ndcOffset=t}set camera(t){this.assertInitialized(),this._camera!==t&&(this._camera=t,this._altered.alter("camera"))}updateData(t,m,y,l){this._geometry.updateData(t,m,y,l),this._altered.alter("geometry")}set depthMask(t){this._depthMask=t}}Cs([N.Initializable.assert_initialized()],ci.prototype,"relink");Cs([N.Initializable.initialize()],ci.prototype,"initialize");Cs([N.Initializable.uninitialize()],ci.prototype,"uninitialize");Cs([N.Initializable.assert_initialized()],ci.prototype,"update");Cs([N.Initializable.assert_initialized()],ci.prototype,"frame");const Og="/treemap-renderer/assets/roboto-C39txIsk.fnt",wg="/treemap-renderer/assets/roboto-Cij1YBZt.png",Pg=N.auxiliaries.log,Rg=N.auxiliaries.LogLevel,ni=N.auxiliaries.assert,bl=3.5,Gr=class Gr extends N.Renderer{constructor(t){super(),this._ndcOffsetScale=1,this.coordsAt=(m,y,l,r)=>this._readbackPass.coordsAt(m,y,l,r===void 0?this._camera.viewProjectionInverse:r),this.idAt=(m,y)=>{if(!this._geometry.initialized)return;const l=this._readbackPass.idAt(m,y);if(l===void 0||l===0)return;const r=this._geometry.topology.node(l);return r===void 0?void 0:r.id},this._visualization=t}get geometry(){return this._geometry}set geometry(t){this._geometry=t}get navigation(){return this._navigation}get camera(){return this._camera}set ndcOffsetScale(t){this._ndcOffsetScale!==t&&(this._ndcOffsetScale=t,this.invalidate())}get ndcOffsetScale(){return this._ndcOffsetScale}static verifyMinimumContextRequirements(t){return t.enable(["ANGLE_instanced_arrays","OES_standard_derivatives"]),!0}renderInnerNodes(t,m,y){this._geometry.valid&&(this._innerPass.target=t,this._innerPass.attachment=m,this._innerPass.depthMask=y,this._innerPass.frame())}renderLeafNodes(t,m,y){this._geometry.valid&&this._geometry.leafNodeHeights&&(this._leafPass.target=t,this._leafPass.attachment=m,this._leafPass.depthMask=y,this._leafPass.frame())}renderLeafLabelBackgrounds(t,m){this._labelBackgroundPass.target=t,this._labelBackgroundPass.depthMask=m,this._labelBackgroundPass.frame()}renderPoints(t,m){this._pointPass.target=t,this._pointPass.depthMask=m,this._pointPass.frame()}renderInnerLabels(t,m,y){if(!this._geometry.valid)return;this._innerLabelPass.target=t,this._innerLabelPass.depthMask=y;const l=this._context.gl;l.enable(l.STENCIL_TEST),l.enable(l.DEPTH_TEST),l.stencilFunc(l.EQUAL,1,255),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),this._innerLabelPass.frame(),l.disable(l.STENCIL_TEST)}renderLeafLabels(t,m,y){this._geometry.valid&&(this._leafLabelPass.target=t,this._leafLabelPass.depthMask=y,this._leafLabelPass.frame())}initializeMultiRenderTarget(t){this.assertUninitialized(),this._multiRenderTarget=new xt(t),this._multiRenderTarget.initialize(),this._multiRenderTarget.primaryFBO.clearStencil(0),this._multiRenderTarget.secondaryFBO.clearStencil(0)}initializeLeafPasses(t){this._leafPass=new qr(t),this._leafPass.initialize(),this._leafPass.camera=this._camera}initializeInnerPass(t){this.assertUninitialized(),this._innerPass=new li(t),this._innerPass.initialize(),this._innerPass.camera=this._camera}initializePointPass(t){this._pointPass=new ui(t),this._pointPass.initialize(),this._pointPass.camera=this.camera,this._pointPass.pointSize=bl}initializeLeafLabelBackgroundPass(t){this._labelBackgroundPass=new ci(t),this._labelBackgroundPass.initialize(),this._labelBackgroundPass.camera=this.camera}initializeLabelPasses(t){this.assertUninitialized(),this._innerLabelPass=new N.LabelRenderPass(t),this._innerLabelPass.initialize(),this._innerLabelPass.camera=this.camera,this._innerLabelPass.target=this._multiRenderTarget.defaultFBO,this._innerLabelPass.depthFunc=t.gl.ALWAYS,this._innerLabelPass.aaStepScale=.3,this._innerLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass=new N.LabelRenderPass(t),this._leafLabelPass.initialize(),this._leafLabelPass.camera=this.camera,this._leafLabelPass.target=this._multiRenderTarget.defaultFBO,this._leafLabelPass.aaStepScale=.3,this._leafLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass.depthFunc=t.gl.ALWAYS,N.FontFace.fromFiles(Og,new Map([[0,wg]]),t).then(m=>{for(const y of this._innerLabelPass.labels)y.fontFace=m;for(const y of this._leafLabelPass.labels)y.fontFace=m;this._fontFace=m,this._innerLabelPass.update(!0),this._leafLabelPass.update(!0),this._visualization.configuration&&(this._visualization.configuration.altered.alter("geometry"),this._visualization.configuration.altered.alter("labels")),this.invalidate()}).catch(m=>N.auxiliaries.log(N.auxiliaries.LogLevel.Error,m))}initializeAccumulationPass(t){this.assertUninitialized(),ni(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),ni(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._accumulationPass=new N.AccumulatePass(t),this._accumulationPass.initialize(this._ndcTriangle),this._accumulationPass.precision=this._framePrecision,this._accumulationPass.texture=this._multiRenderTarget.colorRenderTexture}initializeBlitPass(t){this.assertUninitialized(),ni(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),ni(this._ndcTriangle!==void 0,"expected NDC triangle to be defined");const m=this._context.gl,y=this._context.gl2facade;this._blitPass=new N.BlitPass(t),this._blitPass.initialize(this._ndcTriangle),this._blitPass.readBuffer=y.COLOR_ATTACHMENT0,this._blitPass.drawBuffer=m.BACK,this._blitPass.target=this._multiRenderTarget.defaultFBO}initializeReadbackPass(t){this.assertUninitialized(),ni(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),ni(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._readbackPass=new N.ReadbackPass(t),this._readbackPass.initialize(this._ndcTriangle,this._multiRenderTarget.depthFBO!==void 0),this._readbackPass.cache=!0;const m=this._context.gl,y=this._context.gl2facade;this._multiRenderTarget.depthFBO?(this._readbackPass.depthFBO=this._multiRenderTarget.depthFBO,this._readbackPass.depthAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.depthFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.depthAttachment=m.DEPTH_STENCIL_ATTACHMENT),this._multiRenderTarget.readBackIdFBO?(this._readbackPass.idFBO=this._multiRenderTarget.readBackIdFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.idFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT1)}initializeCamera(){this.assertUninitialized(),this._camera=new N.Camera,this._camera.near=Gr.CAMERA_NEAR_DEFAULT,this._camera.far=Gr.CAMERA_FAR_DEFAULT,this._camera.eye=N.vec3.fromValues(0,1.5,2.2),this._camera.center=N.vec3.fromValues(0,0,.2),this._camera.up=N.vec3.fromValues(0,1,0),this._camera.fovy=2*N.Camera.calculateFovY(20,60)*N.auxiliaries.RAD2DEG}initializeNavigation(t,m){this.assertUninitialized(),this._navigation=new Ge(t,m),this._navigation.camera=this._camera,this._navigation.idAccess=this,this._navigation.coordsAccess=this}onInitialize(t,m,y){return Gr.verifyMinimumContextRequirements(t)?(this._ndcOffsetKernel=new N.AntiAliasingKernel(this._multiFrameNumber),this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength),this._ndcTriangle=new N.NdcFillingTriangle(t,"NdcTriangle"),this._ndcTriangle.initialize(0),this.initializeMultiRenderTarget(t),this.initializeAccumulationPass(t),this.initializeBlitPass(t),this.initializeReadbackPass(t),this.initializeCamera(),this.initializeNavigation(m,y),this.initializeInnerPass(t),this.initializeLeafPasses(t),this.initializePointPass(t),this.initializeLeafLabelBackgroundPass(t),this.initializeLabelPasses(t),!0):!1}onUninitialize(){this._ndcTriangle.uninitialize(),this._multiRenderTarget.uninitialize(),this._accumulationPass.uninitialize(),this._blitPass.uninitialize(),this._readbackPass.uninitialize(),this._innerPass.uninitialize(),this._pointPass.uninitialize(),this._innerLabelPass.uninitialize(),this._leafLabelPass.uninitialize(),this._labelBackgroundPass.uninitialize()}onDiscarded(){}onUpdate(){this._navigation.update();let t=!1;try{t=this._visualization.update()}catch(y){Pg(Rg.Error,y)}let m=!1;for(const y of this._innerLabelPass.labels)if(y.altered||y.color.altered){m=!0;break}for(const y of this._leafLabelPass.labels)if(y.altered||y.color.altered){m=!0;break}return t||m||this._altered.any||this._camera.altered}onPrepare(){this._geometry.altered.any&&this._geometry.valid&&(this._innerPass.ids=this._geometry.innerNodeIndices,this._innerPass.layout=this._geometry.innerNodeLayouts,this._innerPass.colors=this._geometry.innerNodeColors,this._innerPass.emphases=this._geometry.innerNodeEmphases,this._innerPass.colorTable=this._geometry.colorTable,this._innerPass.topology=this._geometry.topology,this._innerPass.showRoot=this._geometry.showRoot,this._leafPass.ids=this._geometry.leafNodeIndices,this._leafPass.layoutData=this._geometry.leafNodeLayouts,this._leafPass.areaScales=this._geometry.leafNodeAreaScales,this._leafPass.colors=this._geometry.leafNodeColors,this._leafPass.emphases=this._geometry.leafNodeEmphases,this._leafPass.heights=this._geometry.leafNodeHeights,this._leafPass.colorTable=this._geometry.colorTable,this._leafPass.topology=this._geometry.topology),this._geometry.altered.colorTableLength&&this._leafPass.colorTableLengthAltered(),this._geometry.altered.outlineWidth&&(this._innerPass.outlineWidth=this._geometry.outlineWidth,this._leafPass.outlineWidth=this._geometry.outlineWidth),this._geometry.altered.emphasisOutlineWidth&&(this._innerPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth,this._leafPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth),this._geometry.altered.heightScale&&(this._leafPass.heightScale=this._geometry.heightScale),this._altered.frameSize&&(this._multiRenderTarget.resize(this._frameSize[0],this._frameSize[1]),this._camera.viewport=[this._frameSize[0],this._frameSize[1]],this.invalidate()),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1],this._readbackPass.coordinateReferenceSize=this._canvasSize),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber,this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength)),this._altered.framePrecision&&(this._accumulationPass.precision=this._framePrecision),this._altered.clearColor&&this._multiRenderTarget.setClearColor(this._clearColor),this._innerPass.update(),this._leafPass.update(),this._pointPass.update(),this._labelBackgroundPass.update(),this._innerLabelPass.update(),this._leafLabelPass.update(),this._accumulationPass.update(),this._readbackPass.frame(),this._visualization.prepare(),this._camera.altered=!1,this._geometry.altered.reset(),this._altered.reset()}onFrame(t){const m=this._context.gl,y=this._context.gl2facade,l=this._ndcOffsetKernel.get(t);l[0]=this._ndcOffsetScale*2*l[0]/this._frameSize[0],l[1]=this._ndcOffsetScale*2*l[1]/this._frameSize[1],this._leafPass.ndcOffset=l,this._innerPass.ndcOffset=l,this._innerLabelPass.ndcOffset=l,this._leafLabelPass.ndcOffset=l,this._pointPass.ndcOffset=l,this._labelBackgroundPass.ndcOffset=l;const r=t===0,a=this._multiRenderTarget,n=r?a.primaryFBO:a.secondaryFBO;n.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT|m.STENCIL_BUFFER_BIT,!0,!1),m.viewport(0,0,this._camera.viewport[0],this._camera.viewport[1]),m.depthFunc(m.LESS);const i=xt.Attachment;a.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),this.renderLeafNodes(n,a.drawRestricted?i.Color:i.Undefined,!0),this.renderInnerNodes(n,a.drawRestricted?i.Color:i.Undefined,!0),a.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,m.NONE]),this.renderInnerLabels(n,a.drawRestricted?i.Color:i.Undefined,!1),this.renderLeafLabelBackgrounds(n,!1),this.renderLeafLabels(n,a.drawRestricted?i.Color:i.Undefined,!1),this.renderPoints(n,!1),a.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),r&&a.idFBO&&(a.idFBO.clear(m.COLOR_BUFFER_BIT|m.STENCIL_BUFFER_BIT),this.renderLeafNodes(a.idFBO,i.Id,!1),this.renderInnerNodes(a.idFBO,i.Id,!1)),r&&a.depthFBO&&(a.depthFBO.clear(m.COLOR_BUFFER_BIT|m.STENCIL_BUFFER_BIT),this.renderLeafNodes(a.depthFBO,i.Depth,!1),this.renderInnerNodes(a.depthFBO,i.Depth,!1)),this._accumulationPass.frame(t)}onSwap(){var m;if(!this._accumulationPass.initialized||!((m=this._accumulationPass.framebuffer)!=null&&m.initialized)||!this._blitPass.initialized)return;const t=this._blitPass;t.framebuffer=this._accumulationPass.framebuffer,t.readBuffer=this._context.gl2facade.COLOR_ATTACHMENT0,t.frame()}updateLabelsForPass(t,m){const y=[];for(const l of t)l!==void 0&&(l.fontFace=this._fontFace,y.push(l));m.labels=y,m.update()}updateLabels(t,m){this.updateLabelsForPass(t,this._innerLabelPass),this.updateLabelsForPass(m,this._leafLabelPass)}updateLeafLabelPass(){this._leafLabelPass.update()}updateLeafLabelBackgrounds(t){const m=[],y=[],l=[],r=[];let a=0;for(const n of t){if(!n||n.color.a===0)continue;const i=2*n.extent[1]/this._frameSize[1];a=Math.max(a,i)}for(const n of t){if(!n||n.color.a===0)continue;m.push(n.position[0],n.position[1],n.position[2]);const i=bl*.5,h=bl*.5,p=(2*n.extent[0]+i)/this._frameSize[0];y.push(p,a);const d=i/this._frameSize[1],f=n.alignment===N.Label.Alignment.Right?-d-p:d,s=h/this._frameSize[1],o=n.lineAnchor===N.Label.LineAnchor.Top?s-a:-s;l.push(f,o);let u=0;n.alignment===N.Label.Alignment.Left?n.lineAnchor===N.Label.LineAnchor.Bottom?u=1:n.lineAnchor===N.Label.LineAnchor.Top&&(u=2):n.alignment===N.Label.Alignment.Right&&(n.lineAnchor===N.Label.LineAnchor.Bottom?u=3:n.lineAnchor===N.Label.LineAnchor.Top&&(u=4)),r.push(u)}this._labelBackgroundPass.updateData(new Float32Array(m),new Float32Array(y),new Float32Array(l),new Uint8Array(r))}updatePoints(t){const m=[],y=[];for(const l of t)l&&(m.push(l.position[0],l.position[1],l.position[2]),y.push(l.color.r,l.color.g,l.color.b,l.color.a));this._pointPass.positions=new Float32Array(m),this._pointPass.colors=new Float32Array(y)}frameSizeAltered(){return this._altered.frameSize}setCameraEye(t,m,y){this._camera.eye=N.vec3.fromValues(t,m,y)}invalidate(){this.initialized&&super.invalidate(!0)}};Gr.CAMERA_NEAR_DEFAULT=.01,Gr.CAMERA_FAR_DEFAULT=10;let Pl=Gr;class Lg{static innerNodes(t,m,y){const l=new Uint8Array(t.numberOfInnerNodes);return t.forEachInnerNode(r=>{l[r.index]=m+r.depth%y}),l}}var Mg=Object.defineProperty,Ig=Object.getOwnPropertyDescriptor,f1=(E,t,m,y)=>{for(var l=Ig(t,m),r=E.length-1,a;r>=0;r--)(a=E[r])&&(l=a(t,m,l)||l);return l&&Mg(t,m,l),l};class gt extends N.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new N.ChangeLookup,{any:!1,colorTableLength:!1,colorTable:!1,innerNodeIndices:!1,innerNodeLayouts:!1,innerNodeEmphases:!1,innerNodeColors:!1,leafNodeIndices:!1,leafNodeLayouts:!1,leafNodeEmphases:!1,leafNodeAreaScales:!1,leafNodeColors:!1,leafNodeHeights:!1,outlineWidth:!1,emphasisOutlineWidth:!1,heightScale:!1,labels:!1})}initialize(t){return this._topology=t,this._altered.alter("any"),this._topology.numberOfInnerNodes>0||this._topology.numberOfLeafNodes>0}uninitialize(){this._topology=void 0,this._colorTable=void 0,this._leafNodeAreaScales=void 0,this._leafNodeColors=void 0,this._leafNodeHeights=void 0,this._innerNodeIndices=void 0,this._innerNodeLayouts=void 0,this._innerNodeEmphases=void 0,this._innerNodeColors=void 0,this._leafNodeIndices=void 0,this._leafNodeLayouts=void 0,this._leafNodeEmphases=void 0,this._showRoot=!0}get altered(){return this._altered}get topology(){return this.assertInitialized(),this._topology}set innerNodeIndices(t){this.assertInitialized(),this._innerNodeIndices=t,this._altered.alter("innerNodeIndices")}get innerNodeIndices(){return this._innerNodeIndices}set innerNodeLayouts(t){this.assertInitialized(),this._innerNodeLayouts=t,this._altered.alter("innerNodeLayouts")}get innerNodeLayouts(){return this._innerNodeLayouts}set innerNodeEmphases(t){this.assertInitialized(),this._innerNodeEmphases=t,this._altered.alter("innerNodeEmphases")}get innerNodeEmphases(){return this._innerNodeEmphases}set innerNodeColors(t){this.assertInitialized(),this._innerNodeColors=t,this._altered.alter("innerNodeColors")}get innerNodeColors(){return this._innerNodeColors}set leafNodeIndices(t){this.assertInitialized(),this._leafNodeIndices=t,this._altered.alter("leafNodeIndices")}get leafNodeIndices(){return this._leafNodeIndices}set leafNodeLayouts(t){this.assertInitialized(),this._leafNodeLayouts=t,this._altered.alter("leafNodeLayouts")}get leafNodeLayouts(){return this._leafNodeLayouts}set leafNodeEmphases(t){this.assertInitialized(),this._leafNodeEmphases=t,this._altered.alter("leafNodeEmphases")}get leafNodeEmphases(){return this._leafNodeEmphases}get leafNodeAreaScales(){return this._leafNodeAreaScales}set leafNodeAreaScales(t){this.assertInitialized(),this._leafNodeAreaScales=t,this._altered.alter("leafNodeAreaScales")}get leafNodeColors(){return this._leafNodeColors}set leafNodeColors(t){this.assertInitialized(),this._leafNodeColors=t,this._altered.alter("leafNodeColors")}set colorTable(t){this.assertInitialized(),this._colorTable=t,this._altered.alter("colorTable")}get colorTable(){return this._colorTable}get leafNodeHeights(){return this._leafNodeHeights}set leafNodeHeights(t){this.assertInitialized(),this._leafNodeHeights=t,this._altered.alter("leafNodeHeights")}get innerNodeCount(){return this.assertInitialized(),this._topology.numberOfInnerNodes}get leafNodeCount(){return this.assertInitialized(),this._topology.numberOfLeafNodes}set heightScale(t){this.assertInitialized(),this._heightScale=t,this._altered.alter("heightScale")}get heightScale(){return this._heightScale}set outlineWidth(t){this.assertInitialized(),this._outlineWidth=t,this._altered.alter("outlineWidth")}get outlineWidth(){return this._outlineWidth}set emphasisOutlineWidth(t){this.assertInitialized(),this._emphasisOutlineWidth=t,this._altered.alter("emphasisOutlineWidth")}get emphasisOutlineWidth(){return this._emphasisOutlineWidth}set showRoot(t){this.assertInitialized(),this._showRoot=!!t,this._altered.alter("any")}get showRoot(){return this._showRoot}get valid(){return this.initialized}}f1([N.Initializable.initialize()],gt.prototype,"initialize");f1([N.Initializable.uninitialize()],gt.prototype,"uninitialize");(E=>{(t=>{t[t.None=0]="None",t[t.Outline=1]="Outline",t[t.Highlight=2]="Highlight"})(E.Emphasis||(E.Emphasis={}))})(gt||(gt={}));class o_{static innerNodes(t,m,y){const l=new Uint8Array(t.numberOfInnerNodes);return t.forEachInnerNode(r=>{y&&y.has(r.id)?l[r.index]=gt.Emphasis.Highlight:m&&m.has(r.id)?l[r.index]=gt.Emphasis.Outline:l[r.index]=gt.Emphasis.None}),l}static leafNodes(t,m,y){const l=new Uint8Array(t.numberOfLeafNodes);return t.forEachLeafNode(r=>{const a=r.index-t.numberOfInnerNodes;y&&y.has(r.id)?l[a]=gt.Emphasis.Highlight:m&&m.has(r.id)?l[a]=gt.Emphasis.Outline:l[a]=gt.Emphasis.None}),l}}class u_{static innerNodes(t){const m=new Uint8Array(4*t.numberOfInnerNodes);return t.forEachInnerNode(y=>{const l=y.index,r=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(r,y.index),m[4*l+0]=r[0],m[4*l+1]=r[1],m[4*l+2]=r[2],m[4*l+3]=r[3]}),m}static leafNodes(t){const m=new Uint8Array(4*t.numberOfLeafNodes),y=t.numberOfInnerNodes;return t.forEachLeafNode(l=>{const r=l.index-y,a=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(a,l.index),m[4*r+0]=a[0],m[4*r+1]=a[1],m[4*r+2]=a[2],m[4*r+3]=a[3]}),m}}class l_{constructor(){this.outer=0,this.inner=0}next(t){++this.inner,this.inner===t[this.outer].length&&(++this.outer,this.inner=0)}end(t){return this.outer===t.length}element(t){return t[this.outer][this.inner]}}const c_=N.auxiliaries.assert,io=N.gl_matrix_extensions.v2;var Ee;(E=>{(l=>{l.UpperRight="upper-right",l.UpperLeft="upper-left",l.LowerRight="lower-right",l.LowerLeft="lower-left",l.Hidden="hidden"})(E.Type||(E.Type={}));function t(l,r,a){switch(l){case"upper-right":return r;case"upper-left":return N.vec2.sub(io(),r,[a[0],0]);case"lower-left":return N.vec2.sub(io(),r,a);case"lower-right":return N.vec2.sub(io(),r,[0,a[1]]);case"hidden":return r;default:c_(!1,"No valid type for relative label position, given"+l)}return N.vec2.create()}E.labelOrigin=t;function m(l){return l!=="hidden"}E.isVisible=m;function y(l,r){const a=N.vec2.add(io(),l,[r[0]/2,r[1]/2]);return a[0]>0&&a[1]>0?"upper-right":a[0]<0&&a[1]>0?"upper-left":a[0]<0&&a[1]<0?"lower-left":a[0]>0&&a[1]<0?"lower-right":(c_(!1,`midpointOffset is ${a}, given offset ${l} and extent ${r}`),"hidden")}E.relativeLabelPosition=y})(Ee||(Ee={}));const Re=N.gl_matrix_extensions.v2;class gl{constructor(t,m,y){this.origin=t,this.extent=m,this.position=y}areBothPositionsHidden(t){return this.position===Ee.Type.Hidden||t===Ee.Type.Hidden}overlaps(t){if(this.areBothPositionsHidden(t.position))return!1;const m=N.vec2.add(Re(),this.origin,this.extent),y=N.vec2.add(Re(),t.origin,t.extent);return this.origin[0]<y[0]&&m[0]>t.origin[0]&&this.origin[1]<y[1]&&m[1]>t.origin[1]}paddedOverlaps(t,m){if(this.areBothPositionsHidden(t.position))return!1;const y=N.vec2.fromValues(m[0]+1,m[1]+1),l=N.vec2.sub(Re(),this.origin,N.vec2.mul(Re(),this.extent,m)),r=N.vec2.sub(Re(),t.origin,N.vec2.mul(Re(),t.extent,m)),a=N.vec2.add(Re(),this.origin,N.vec2.mul(Re(),this.extent,y)),n=N.vec2.add(Re(),t.origin,N.vec2.mul(Re(),t.extent,y));return l[0]<n[0]&&a[0]>r[0]&&l[1]<n[1]&&a[1]>r[1]}overlapArea(t){if(this.areBothPositionsHidden(t.position))return 0;const m=N.vec2.max(Re(),this.origin,t.origin),y=N.vec2.min(Re(),N.vec2.add(Re(),this.origin,this.extent),N.vec2.add(Re(),t.origin,t.extent));return Math.max(0,y[0]-m[0])*Math.max(0,y[1]-m[1])}paddedOverlapArea(t,m){if(this.areBothPositionsHidden(t.position))return 0;const y=N.vec2.max(Re(),N.vec2.sub(Re(),this.origin,N.vec2.mul(Re(),this.extent,m)),N.vec2.sub(Re(),t.origin,N.vec2.mul(Re(),t.extent,m))),l=N.vec2.fromValues(m[0]+1,m[1]+1),r=N.vec2.min(Re(),N.vec2.add(Re(),this.origin,N.vec2.mul(Re(),this.extent,l)),N.vec2.add(Re(),t.origin,N.vec2.mul(Re(),t.extent,l)));return Math.max(0,r[0]-y[0])*Math.max(0,r[1]-y[1])}area(){return this.extent[0]*this.extent[1]}}const Fg=N.auxiliaries.assert,Cg=N.auxiliaries.log,Ng=N.auxiliaries.LogLevel,zg=20;function no(E,t,m){E.length>0&&E[E.length-1].value<t&&(E[E.length-1]={nodeId:m,value:t},E.sort((y,l)=>l.value-y.value))}function ao(E,t){t.filter(m=>m.nodeId!==void 0&&m.nodeId!=Fe.INVALID_INDEX).map(m=>{E.add(m.nodeId)})}class Ke{static createLeafLabel(t,m){const y=new N.Projected3DLabel(new N.Text("  "+t+"  "),N.Label.Type.Dynamic);return y.color.fromF32(...Ke.leafLabelColor),y.lineAnchor=N.Label.LineAnchor.Bottom,y.fontSize=zg*window.devicePixelRatio,Fg(m.length===3,`Expected a 3D position for leaf label anchor, got ${m}`),y.position=m,y}static createInnerNodeLabel(t,m,y){const l=new N.Position3DLabel(new N.Text(t),N.Label.Type.Static);l.color.fromF32(...Ke.innerLabelColor),l.alignment=N.Label.Alignment.Center,l.lineAnchor=N.Label.LineAnchor.Bottom;const r=0;let a=0;const n=0;let i=0;switch(l.fontSize=y*2,l.elide=N.Label.Elide.Middle,r){case 0:a=m.left+m.right-1,i=(m.bottom-y)*2-1,l.lineWidth=m.width*2,l.direction=[1,0,0],l.up=[0,0,-1];break;case 1:a=m.left+m.right-1,i=(m.top+y)*2-1,l.lineWidth=m.width*2,l.direction=[-1,0,0],l.up=[0,0,1];break;case 2:a=(m.left-y)*2-1,i=m.top+m.bottom-1,l.lineWidth=m.height*2,l.direction=[0,0,1],l.up=[1,0,0];break;case 3:a=(m.right+y)*2-1,i=m.top+m.bottom-1,l.lineWidth=m.height*2,l.direction=[0,0,-1],l.up=[-1,0,0];break;default:l.fontSize=0,Cg(Ng.Warning,`${r} is not a valid value of LabelPaddingSide, skip label '${t}'`)}return l.position=[a,n,-i],l}static createInnerNodeLabelOnAccessory(t,m){const y=new N.Position3DLabel(new N.Text(t),N.Label.Type.Static);y.color.fromF32(...Ke.innerLabelColor),y.alignment=N.Label.Alignment.Center,y.lineAnchor=N.Label.LineAnchor.Bottom;const l=m.left+m.right-1,r=0,a=m.bottom*2-1;return y.fontSize=m.height*2,y.elide=N.Label.Elide.Middle,y.lineWidth=m.width*2,y.position=[l,r,-a],y.direction=[1,0,0],y.up=[0,0,-1],y}static fillLeafLabelArray(t,m,y,l,r,a){const n=new Array(t.numberOfInnerNodes);return y.forEach(i=>{const h=t.leafNodeById(i),p=m.get(i);if(h===void 0||p===void 0||p.length===0)return;const d=h.index-t.numberOfInnerNodes,f=d*4,s=r[f+0],o=r[f+1],u=r[f+2],b=r[f+3],v=d*2,_=a[v+1];if(u>0&&b>0){const g=s+u*.5,x=_*l/255,T=o+b*.5;n[h.index]=Ke.createLeafLabel(p,[g,x,T])}}),n}static fillInnerNodeLabelArrayOnAccessory(t,m,y,l){const r=new Array(t.numberOfInnerNodes);return y.forEach(a=>{const n=t.innerNodeById(a);if(n!==void 0&&l[n.index]!==void 0&&l[n.index].area>0){const i=m.get(a);if(i===void 0||i.length===0)return;r[n.index]=Ke.createInnerNodeLabelOnAccessory(i,l[n.index])}}),r}static fillInnerNodeLabelArray(t,m,y,l,r){const a=new Array(t.numberOfInnerNodes);return y.forEach(n=>{const i=t.innerNodeById(n);if(i!==void 0&&l[i.index]!==void 0){const h=m.get(n);if(h===void 0||h.length===0)return;!i.isLeaf&&l[i.index].area>0&&(a[i.index]=Ke.createInnerNodeLabel(h,l[i.index],r[i.index]))}}),a}static createLabelSelection(t,m,y,l,r,a,n,i,h,p){const d=new Set,f=new Array(n),s=new Array(i),o=new Array(h),u=new Array(p),b=new Array(1);f.fill({nodeId:void 0,value:-1}),s.fill({nodeId:void 0,value:-1}),o.fill({nodeId:void 0,value:-1}),u.fill({nodeId:void 0,value:-1}),b.fill({nodeId:void 0,value:-1}),t.parentsDoUntilDepth(a[1],_=>{_.depth<a[0]||no(f,m[_.index],_.id)}),t.forEachLeafNode(_=>{_.id!==void 0&&(no(s,m[_.index],_.id),no(o,y[_.index],_.id),no(u,l[_.index],_.id))}),ao(d,f),ao(d,s),ao(d,o),ao(d,u);const v=r.entries();for(const _ of v)d.add(_[1]);return d}static fillLeafLabelArrayByExplicitNames(t,m,y,l,r){const a=new Set;return m.forEach((n,i)=>{a.add(i)}),Ke.fillLeafLabelArray(t,m,a,y,l,r)}static fillInnerNodeLabelArrayOnAccessoryByExplicitNames(t,m,y){const l=new Set;return m.forEach((r,a)=>{l.add(a)}),Ke.fillInnerNodeLabelArrayOnAccessory(t,m,l,y)}}(E=>{E.leafLabelColor=[0,0,0,.8],E.innerLabelColor=[0,0,0,.54]})(Ke||(Ke={}));const co=N.auxiliaries.assert,Bg=N.gl_matrix_extensions.v2;var ho;(E=>{E.leafLabelsTreemap=(t,m,y,l)=>{let r=0;switch(y){case Ee.Type.UpperRight:r=0*l;break;case Ee.Type.LowerRight:r=1*l;break;case Ee.Type.UpperLeft:r=1*l;break;case Ee.Type.LowerLeft:r=3*l;break;case Ee.Type.Hidden:r=60*l;break;default:co(!1,`No valid relative position type, given ${y}`)}return 15*m+.3*r}})(ho||(ho={}));class Dg{static getNDCExtentForLeafLabel(t,m){co(m.width!==0&&m.height!==0,`camera viewport is invalid: ${m.width} ${m.height}`);const y=t.label.extent[0]/m.width,l=t.label.extent[1]/m.height;return N.vec2.fromValues(y,l)}static placementFor(t,m){const y=N.vec2.sub(Bg(),t.origin,m);let l=!0,r=N.Label.Alignment.Left,a=N.Label.LineAnchor.Bottom;switch(t.position){case Ee.Type.UpperRight:break;case Ee.Type.LowerRight:a=N.Label.LineAnchor.Top;break;case Ee.Type.UpperLeft:r=N.Label.Alignment.Right;break;case Ee.Type.LowerLeft:a=N.Label.LineAnchor.Top,r=N.Label.Alignment.Right;break;case Ee.Type.Hidden:l=!1;break;default:co(!1,"No valid type for relative label position, given"+y)}return{offset:y,alignment:r,lineAnchor:a,display:l}}static createCollisionGraph(t,m){m||(m=N.vec2.fromValues(1,1));const y=[];for(let r=0;r<t.length;r++){y.push([]);for(const a of t[r])y[r].push([])}const l=new l_;for(;!l.end(t);l.next(t)){const r=l.element(y),a=l.element(t),n=new l_;for(;!n.end(t);n.next(t)){if(l.outer===n.outer)continue;const i=n.element(t);if(a.paddedOverlaps(i,m)){const h=a.paddedOverlapArea(i,m);r.push({index:n.outer,position:n.inner,overlapArea:h});const p=l.element(y).length;co(p>0,`Size expected to be greater than zero, given ${p.length}`)}}}return y}static computeLabelAreas(t,m,y){const l=[];for(const r of t){l.push([]);const a=this.getNDCExtentForLeafLabel(r,y);for(const n of m){const i=Ee.labelOrigin(n,r.pointLocation,a);l[l.length-1].push(new gl(i,a,n))}}return l}static getRandomInt(t){return Math.floor(Math.random()*Math.floor(t))}static randomIndexExcept(t,m){const y=this.getRandomInt(m-1);return y===t?m-1:y}static randomStartLabelAreas(t){const m=[];for(const y of t)m.push(this.getRandomInt(y.length));return m}static computePenalty(t,m,y,l,r){if(t.extent[0]===0||t.extent[1]===0)return 0;let a=0,n=0;for(const i of m)r[i.index]===i.position&&(a+=i.overlapArea,++n);return a/=t.area(),l(n,a,t.position,y)}static simulatedAnnealing(t,m,y,l){const r=[Ee.Type.UpperRight,Ee.Type.UpperLeft,Ee.Type.LowerLeft,Ee.Type.LowerRight,Ee.Type.Hidden],a=this.computeLabelAreas(t,r,l),n=this.randomStartLabelAreas(a),i=this.createCollisionGraph(a,y),h=.91023922662,p=50,d=.9,f=5*t.length,s=20*t.length;let o=h,u=0,b=0,v=0;for(;;){const _=this.getRandomInt(t.length),g=n[_],x=this.randomIndexExcept(g,a[_].length),T=this.computePenalty(a[_][g],i[_][g],t[_].priority,m,n),O=this.computePenalty(a[_][x],i[_][x],t[_].priority,m,n),A=T-O,R=Math.exp(A/o),P=Math.max(0,Math.min(R,1)),C=Math.random()<P;if((A>0||C)&&(n[_]=x,++b),++v,b>f||v>s){if(b===0||u===p)break;o*=d,b=0,v=0,++u}}for(let _=0;_<t.length;++_)t[_].placement=this.placementFor(a[_][n[_]],t[_].pointLocation)}static greedy(t,m,y,l){const r=[],a=[Ee.Type.UpperRight,Ee.Type.UpperLeft,Ee.Type.LowerLeft,Ee.Type.LowerRight,Ee.Type.Hidden];for(const n of t){const i=this.getNDCExtentForLeafLabel(n,l);let h=Number.POSITIVE_INFINITY,p=new gl(N.vec2.create(),N.vec2.create(),Ee.Type.LowerLeft);for(const d of a){const f=Ee.labelOrigin(d,n.pointLocation,i),s=new gl(f,i,d);let o=0,u=0;for(const v of r)o+=s.paddedOverlapArea(v,y),u+=s.paddedOverlaps(v,y)?1:0;o/=s.area();const b=m(u,o,d,n.priority);b<h&&(h=b,p=s)}n.placement=this.placementFor(p,n.pointLocation),r.push(p)}}static prepareLeafLabels(t,m){const y=[];return t.forEach((l,r)=>{if(!l)return;const a=N.vec4.fromValues(l.position[0],l.position[1],l.position[2],1);N.vec4.transformMat4(a,a,m.viewProjection);const n=a[3],i=N.vec2.fromValues(a[0]/n,a[1]/n);y.push({label:l,pointLocation:i,priority:l.position[1]*9+1+10*(r+1)/t.length,placement:{offset:N.vec2.create(),alignment:l.alignment,lineAnchor:l.lineAnchor,display:!0}})}),y}static applyNewPlacements(t){let m=!1,y=!1;for(const l of t){const r=l.label.alignment!==l.placement.alignment,a=l.label.lineAnchor!==l.placement.lineAnchor;l.label.alignment=l.placement.alignment,l.label.lineAnchor=l.placement.lineAnchor;const n=l.placement.display?Ke.leafLabelColor[3]:0;l.label.color.fromRGB(l.label.color.r,l.label.color.g,l.label.color.b,n),m=m?!0:l.label.color.altered,y=y?!0:r||a}return{visibility:m,positioning:y}}static adaptPositionToPreventOverlapGreedy(t,m){const y=this.prepareLeafLabels(t,m);y.sort((r,a)=>a.priority-r.priority);const l=N.vec2.fromValues(1,1);return this.greedy(y,ho.leafLabelsTreemap,l,m),this.applyNewPlacements(y)}static adaptPositionToPreventOverlapSimulatedAnnealing(t,m){const y=this.prepareLeafLabels(t,m),l=N.vec2.fromValues(1,1);return this.simulatedAnnealing(y,ho.leafLabelsTreemap,l,m),this.applyNewPlacements(y)}}class jg{constructor(t){this._topology=t}resolve(t,m,y,l){if(l&&(t===void 0||t===""))return l();const r=tt.create(this._topology,y,t,m);return l&&r===void 0?l():r}constBufferCallback(t=0){return()=>{const m=new Float32Array(this._topology.numberOfNodes);return m.fill(t),m}}}class Ug{constructor(t,m,y,l){this._emphasis=t.rgbaF32,this._auxiliary=new Float32Array(m.length*4);for(let r=0;r<m.length;++r)this._auxiliary.set(m[r].rgbaF32,r*4);this._inner=new Float32Array(y.length*4);for(let r=0;r<y.length;++r)this._inner.set(y[r].rgbaF32,r*4);this._leaf=new Float32Array(l.length*4);for(let r=0;r<l.length;++r)this._leaf.set(l[r].rgbaF32,r*4)}get innerNodeColorOffset(){return this.auxiliaryColorCount}get innerNodeColorCount(){return this._inner.length/4}get leafColorOffset(){return this.innerNodeColorOffset+this.innerNodeColorCount}get leafColorCount(){return this._leaf.length/4}get auxiliaryColorOffset(){return 0}get auxiliaryColorCount(){return this._auxiliary.length/4+1}get selectionColorIndex(){return 0}get bits(){const t=new Float32Array((this.auxiliaryColorCount+this.innerNodeColorCount+this.leafColorCount)*4);return t.set(this._emphasis,0),t.set(this._auxiliary,4),t.set(this._inner,this.innerNodeColorOffset*4),t.set(this._leaf,this.leafColorOffset*4),t}get length(){return this.auxiliaryColorCount+this.leafColorCount+this.innerNodeColorCount}}class mt{static getColorIndex(t,m,y){const r=(t-y[0])/(y[1]-y[0]);return Math.min(m-1,Math.floor(Math.max(0,m*r-1e-4)))}static getColorIndexInverted(t,m,y){return m-1-this.getColorIndex(t,m,y)}static getColorIndexComputation(t,m){return y=>this.getColorIndex(y,t,m)}static insertLayoutIntoBuffer(t,m,y){const l=4*m;t[l+0]=-1+2*y.left,t[l+1]=1-2*y.bottom-2*y.height,t[l+2]=2*y.width,t[l+3]=2*y.height}static createLeafLayoutBuffer(t,m,y){const l=new Float32Array(4*t.numberOfLeafNodes),r=t.numberOfInnerNodes;return t.forEachLeafNode(a=>{const n=a.index-r,i=m[a.index];mt.insertLayoutIntoBuffer(l,n,i)}),l}static createLayerHeightBuffer(t,m,y,l){const r=new Uint8Array(2*t.numberOfLeafNodes),a=t.numberOfInnerNodes;let n=!1;return t.forEachLeafNode(i=>{const h=i.index-a,p=y!==void 0?Math.max(y[2*h+1],0):0,d=Math.max(m[i.index],0);let f=p+d*255;p>0&&d>0&&(f=Math.ceil(f)),f>255&&(n=!0,f=255),r[2*h+0]=p,r[2*h+1]=f}),n&&console.error("Height value overflow"),r}static createEmptyLayerHeightBuffer(t){return new Uint8Array(2*t.numberOfLeafNodes)}static createLeafAreaScalesBuffer(t,m){const y=new Uint8Array(t.numberOfLeafNodes),l=t.numberOfInnerNodes;return t.forEachLeafNode(r=>{const a=r.index-l,n=Math.min(m[r.index]*255,255);y[a]=n}),y}static createDefaultLeafAreaScalesBuffer(t,m=1){const y=new Uint8Array(t.numberOfLeafNodes);return y.fill(m*255),y}static createParentLayoutBuffer(t,m,y){const l=new Float32Array(4*t.numberOfInnerNodes);return t.forEachInnerNode(r=>{const a=r.index,n=m[r.index];mt.insertLayoutIntoBuffer(l,a,n)}),l}static defaultLeafNodeColors(t,m){const y=new Uint8Array(t.numberOfLeafNodes);return y.fill(m),y}static createLeafNodeColors(t,m,y,l,r){const a=new Uint8Array(t.numberOfLeafNodes),n=t.numberOfInnerNodes,i=this.getColorIndexComputation(l,r);return t.forEachLeafNode(h=>{const p=h.index-n,d=m[h.index];a[p]=y+i(d)+32}),a}static createLeafNodeHeights(){return new Uint8Array(0)}static createLeafNodeAreaScales(){return new Uint8Array(0)}}class kg{constructor(){this.topology=new Je}}const Xt=N.auxiliaries.assert;class pe{static clone(t){return new pe(t.left,t.bottom,t.right,t.top)}constructor(t,m,y,l,r){this._left=t,this._right=Math.max(y,t),this._bottom=m,this._top=Math.max(l,m),this.orientation=r}get area(){return this.width*this.height}get center(){return[(this._left+this._right)/2,(this._bottom+this._top)/2]}get shorterSide(){return Math.min(this.width,this.height)}get longerSide(){return Math.max(this.width,this.height)}get isReversed(){return this.orientation===void 0?!1:this.orientation>=pe.Orientation.DC}get top(){return this._top}set top(t){Xt(t>=this.bottom,"Non-negative height expected"),this._top=t}get left(){return this._left}set left(t){Xt(t<=this.right,"Non-negative width expected"),this._left=t}get right(){return this._right}set right(t){Xt(t>=this.left,"Non-negative width expected"),this._right=t}get bottom(){return this._bottom}set bottom(t){Xt(t<=this.top,"Non-negative height expected"),this._bottom=t}get width(){return this._right-this._left}get height(){return this._top-this._bottom}get isHorizontal(){return this.width>this.height}get isVertical(){return this.width<=this.height}relativeTop(t){return this.relativeRect(0,1-t,1,t)}truncateTop(t){return Xt(t<=this._top&&t>=this._bottom,"Expect new top to be within rectangle"),new pe(this._left,this._bottom,this._right,t)}relativeLeft(t){return this.relativeRect(0,0,t,1)}truncateLeft(t){return Xt(t<=this._right&&t>=this._left,"Expect new top to be within rectangle"),new pe(t,this._bottom,this._right,this._top)}relativeRight(t){return this.relativeRect(1-t,0,t,1)}truncateRight(t){return Xt(t<=this._right&&t>=this._left,"Expect new top to be within rectangle"),new pe(this._left,this._bottom,t,this._top)}relativeBottom(t){return this.relativeRect(0,0,1,t)}truncateBottom(t){return Xt(t<=this._top&&t>=this._bottom,"Expect new top to be within rectangle"),new pe(this._left,t,this._right,this._top)}applyOffset(t,m){this._left+=t,this._right+=t,this._top+=m,this._bottom+=m}relativeRect(t,m,y,l,r){const a=this._left+t*this.width,n=this._bottom+m*this.height,i=Math.min(a+y*this.width,this._right),h=Math.min(n+l*this.height,this._top);return new pe(a,n,i,h,r)}equalizedMargin(t,m,y){if(this.area<=0)return 0;let l=t;const r=2*this.width*t+2*this.height*t-4*t*t;if(r<0||r/this.area>=m||this.shorterSide<2*t){let a;const n=this.area*m*.99,i=.25*(this.width+this.height),h=.25*n,p=i*i-h;if(p<=0)a=i;else{const d=Math.sqrt(p),f=i+d,s=i-d;a=Math.min(f,s),a=a<0?0:a}Xt(a<l,`expected ${a} to be smaller than ${l}`),l=a}return l}equalizedRelativeMargin(t){if(this.area<=0)return 0;const m=this.area*(1-t),y=this.width/this.height,l=Math.sqrt(m*y),r=Math.sqrt(m/y),a=this.area-m,n=-(l+r)*.5,i=a*.25,h=n*n*.25-i,p=h<0?0:Math.sqrt(h),d=-n*.5+p,f=-n*.5-p;return d<0||f<0?Math.max(d,f):Math.min(d,f)}padded(t){return this.width<2*t||this.height<2*t?new pe(this.left,this.bottom,this.left,this.bottom):new pe(this.left+t,this.bottom+t,this.right-t,this.top-t)}paddedWithMinArea(t,m){return t<=0?this.padded(t):1-(2*this.width*t+2*this.height*t-4*t*t)/this.area>=m&&this.shorterSide>4*t?this.padded(t):this.padded(this.shorterSide/4).relativePadded(Math.max(0,1-t/(4*this.shorterSide)))}relativePadded(t){const m=t/2;return this.relativeRect(m,m,1-t,1-t)}map(t,m){const y=(this.left-t.left)/t.width*m.width+m.left,l=m.right-(t.right-this.right)/t.width*m.width,r=m.top-(t.top-this.top)/t.height*m.height,a=(this.bottom-t.bottom)/t.height*m.height+m.bottom;return new pe(y,a,l,r)}enclose(t){const m=Math.min(this.left,t.left),y=Math.max(this.top,t.top),l=Math.max(this.right,t.right),r=Math.min(this.bottom,t.bottom);this._left=m,this._right=l,this._top=y,this._bottom=r}intersects(t){return!(t.left+Number.EPSILON>=this.right||t.right<=this.left+Number.EPSILON||t.top<=this.bottom+Number.EPSILON||t.bottom+Number.EPSILON>=this.top)}comprises(t){return this.left-Number.EPSILON<=t.left+Number.EPSILON&&this.right+Number.EPSILON>=t.right-Number.EPSILON&&this.bottom-Number.EPSILON<=t.bottom+Number.EPSILON&&this.top+Number.EPSILON>=t.top-Number.EPSILON}get aspectRatio(){return this.width/this.height}centerAround(t){const m=this.center,y=[t[0]-m[0],t[1]-m[1]];this.applyOffset(y[0],y[1])}}(E=>{(t=>{t[t.CD=0]="CD",t[t.AC=1]="AC",t[t.BA=2]="BA",t[t.DB=3]="DB",t[t.DC=4]="DC",t[t.CA=5]="CA",t[t.AB=6]="AB",t[t.BD=7]="BD"})(E.Orientation||(E.Orientation={}))})(pe||(pe={}));class bt{static compute(t,m,y,l,r,a,n,i){const h=m[t.root.index];t.nodesDo(s=>{const o=m[s.index],u=Math.sqrt(o/h);l[s.index]=new pe(0,0,u*y,u)});const p=new Array;p[t.root.index]=[0,0],t.reverseParentsDo(s=>{let o=0,u=0,b=o,v=u,_=bt.Direction.Y;t.childrenDo(s,x=>{const T=l[x.index]=r.siblingMarginAfterCallback(l[x.index],l[s.index],l[s.index],x);switch(_){case bt.Direction.X:o+T.width>=b&&(o=b,u=0,_=bt.Direction.Y);break;default:case bt.Direction.Y:u+T.height>=v&&(o=0,u=v,_=bt.Direction.X);break}switch(p[x.index]=[o,u],_){case bt.Direction.X:o+=T.width,b=Math.max(b,o),v=Math.max(v,Math.max(u+T.height,T.top));break;default:case bt.Direction.Y:u+=T.height,b=Math.max(b,Math.max(o+T.width,T.right)),v=Math.max(v,u);break}});const g=r.parentPaddingCallback(new pe(0,0,b,v),s,t,l,n,i);l[s.index]=r.accessoryPaddingCallback(g,s,t,l,a)}),t.nodesDo(s=>{const o=l[s.index],u=p[s.index];o.applyOffset(u[0],u[1]),t.childrenDo(s,b=>{const v=p[b.index];v[0]+=u[0],v[1]+=u[1]})});const d=l[t.root.index],f=new pe(0,0,d.aspectRatio,1);f.centerAround([.5,.5]),t.reverseNodesDo(s=>{l[s.index]=l[s.index].map(d,f)})}}(E=>{(t=>{t[t.X=0]="X",t[t.Y=1]="Y"})(E.Direction||(E.Direction={}))})(bt||(bt={}));const so=N.auxiliaries.assert;class Ts{static aspectRatio(t,m,y){const l=t*m,r=y;return l>r?l/r:r/l}constructor(t,m,y,l,r){this._tree=t,this._weights=m,this._availableSpace=y,this._availableWeight=l,this._horizontal=r,this._insertedChildrenCount=0,this._overallChildrenCount=0,this._parentWeight=l,this._childrenWeight=0,this._overallChildrenWeight=0}optimizedAverageAspectRatio(t){if(t){const m=Math.min(this._childrenWeight+t,this._availableWeight),y=Math.min(m/this._availableWeight,1),l=this._horizontal?this._availableSpace.width:this._availableSpace.height,r=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return Ts.aspectRatio(1/(this._insertedChildrenCount+1),l,r)}else{const m=this._childrenWeight,y=Math.min(m/this._availableWeight,1),l=this._horizontal?this._availableSpace.width:this._availableSpace.height,r=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return Ts.aspectRatio(1/this._insertedChildrenCount,l,r)}}insert(t,m){this._firstChild||(this._firstChild=t),so(this._lastChild===void 0||this._lastChild===t,"Next node invariant not held."),this._lastChild=this._tree.node(t.nextSibling),m>Number.EPSILON&&(this._childrenWeight=Math.min(this._childrenWeight+m,this._availableWeight),this._overallChildrenWeight=Math.min(this._overallChildrenWeight+m,this._parentWeight),this._insertedChildrenCount+=1)}layoutNodes(t){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,y=>{t[y.index]=new pe(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const m=this.currentSpace;if(this._horizontal){let y=m.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,l=>{const r=this._weights[l.index],a=m.width*r/this._childrenWeight,n=Math.min(y+a,m.right);t[l.index]=new pe(y,m.bottom,n,m.top),so(this._availableSpace.comprises(t[l.index]),"Expect that child rect is within parent rect"),y=n})}else{let y=m.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,l=>{const r=this._weights[l.index],a=m.height*r/this._childrenWeight,n=Math.min(y+a,m.top);t[l.index]=new pe(m.left,y,m.right,n),so(this._availableSpace.comprises(t[l.index]),"Expect that child rect is within parent rect"),y=n})}}get isDisabled(){return this._availableWeight<=0||this._availableSpace.width<=0||this._availableSpace.height<=0}get availableWeight(){return this._availableWeight}get remainingWeight(){return this.isDisabled?0:Math.max(this._parentWeight-this._overallChildrenWeight,0)}get availableSpace(){return this._availableSpace}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return pe.clone(this.availableSpace);const t=this._childrenWeight/this._availableWeight;if(this._horizontal){const m=this._availableSpace.bottom+t*this._availableSpace.height;return this._availableSpace.truncateTop(m)}else{const m=this._availableSpace.left+t*this._availableSpace.width;return this._availableSpace.truncateRight(m)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const t=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal){const m=this._availableSpace.bottom+t*this._availableSpace.height;return this._availableSpace.truncateBottom(m)}else{const m=this._availableSpace.left+t*this._availableSpace.width;return this._availableSpace.truncateLeft(m)}}get isHorizontal(){return this._horizontal}increasesAverageAspectRatio(t){return this.isDisabled||this._firstChild===void 0||t<=Number.EPSILON?!1:this.optimizedAverageAspectRatio(t)>this.optimizedAverageAspectRatio()+Number.EPSILON}next(t){const m=this.remainingSpace;so(this._availableSpace.comprises(m),"Remaining Space should not exceed available space"),this._availableSpace=m,this._availableWeight=this.remainingWeight,this._horizontal=t,this._firstChild=void 0,this._lastChild=void 0,this._insertedChildrenCount=0,this._childrenWeight=0}}const oo=N.auxiliaries.assert;class Gg extends Ts{constructor(t,m,y,l,r,a,n){super(t,m,y,l,r),this._reverse=a,this._parentReverse=n}get reverse(){return this._reverse}set reverse(t){this._reverse=t}get parentReverse(){return this._parentReverse}set parentReverse(t){this._parentReverse=t}layoutNodes(t){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,l=>{t[l.index]=new pe(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const m=this.currentSpace,y=this._reverse?pe.Orientation.DC:pe.Orientation.CD;if(this._horizontal)if(this._parentReverse){let l=m.right;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,r=>{const a=this._weights[r.index],n=m.width*a/this._childrenWeight,i=Math.max(l-n,m.left);t[r.index]=new pe(i,m.bottom,l,m.top,y),oo(this._availableSpace.comprises(t[r.index]),"Expect that child rect is within parent rect"),l=i})}else{let l=m.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,r=>{const a=this._weights[r.index],n=m.width*a/this._childrenWeight,i=Math.min(l+n,m.right);t[r.index]=new pe(l,m.bottom,i,m.top,y),oo(this._availableSpace.comprises(t[r.index]),"Expect that child rect is within parent rect"),l=i})}else if(this._parentReverse){let l=m.top;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,r=>{const a=this._weights[r.index],n=m.height*a/this._childrenWeight,i=Math.max(l-n,m.bottom);t[r.index]=new pe(m.left,i,m.right,l,y),oo(this._availableSpace.comprises(t[r.index]),"Expect that child rect is within parent rect"),l=i})}else{let l=m.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,r=>{const a=this._weights[r.index],n=m.height*a/this._childrenWeight,i=Math.min(l+n,m.top);t[r.index]=new pe(m.left,l,m.right,i,y),oo(this._availableSpace.comprises(t[r.index]),"Expect that child rect is within parent rect"),l=i})}}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return pe.clone(this.availableSpace);const t=this._childrenWeight/this._availableWeight;if(this._horizontal)if(this._parentReverse){const m=this._availableSpace.top-t*this._availableSpace.height;return this._availableSpace.truncateBottom(m)}else{const m=this._availableSpace.bottom+t*this._availableSpace.height;return this._availableSpace.truncateTop(m)}else if(this._parentReverse){const m=this._availableSpace.right-t*this._availableSpace.width;return this._availableSpace.truncateLeft(m)}else{const m=this._availableSpace.left+t*this._availableSpace.width;return this._availableSpace.truncateRight(m)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const t=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal)if(this._parentReverse){const m=this._availableSpace.top-t*this._availableSpace.height;return this._availableSpace.truncateTop(m)}else{const m=this._availableSpace.bottom+t*this._availableSpace.height;return this._availableSpace.truncateBottom(m)}else if(this._parentReverse){const m=this._availableSpace.right-t*this._availableSpace.width;return this._availableSpace.truncateRight(m)}else{const m=this._availableSpace.left+t*this._availableSpace.width;return this._availableSpace.truncateLeft(m)}}next(t){super.next(t),this._reverse=!this._reverse}}class qg{static compute(t,m,y,l,r,a,n,i){l[t.root.index]=new pe(0,0,y,1),l[t.root.index].centerAround([.5,.5]),t.forEachInnerNode(h=>{let p=r.accessoryPaddingCallback(l[h.index],h,t,l,a);p=r.parentPaddingCallback(p,h,t,l,n,i);const d=r.siblingMarginBeforeCallback(p,h,t,l,n,i),f=d.isReversed,s=f,o=new Gg(t,m,d,m[h.index],d.isVertical,s,f);t.childrenDo(h,u=>{const b=m[u.index];o.increasesAverageAspectRatio(b)&&(o.layoutNodes(l),o.next(d.isVertical)),o.insert(u,b)}),o.layoutNodes(l),t.childrenDo(h,u=>{l[u.index]=r.siblingMarginAfterCallback(l[u.index],d,p,u)})})}}class Wg{static compute(t,m,y,l,r,a,n,i){l[t.root.index]=new pe(0,0,y,1),l[t.root.index].centerAround([.5,.5]),t.forEachInnerNode(h=>{let p=r.accessoryPaddingCallback(l[h.index],h,t,l,a);p=r.parentPaddingCallback(p,h,t,l,n,i);const d=r.siblingMarginBeforeCallback(p,h,t,l,n,i),f=new Ts(t,m,d,m[h.index],p.isVertical);t.childrenDo(h,s=>{const o=m[s.index];f.increasesAverageAspectRatio(o)&&(f.layoutNodes(l),f.next(d.isVertical)),f.insert(s,o)}),f.layoutNodes(l),t.childrenDo(h,s=>{l[s.index]=r.siblingMarginAfterCallback(l[s.index],d,p,s)})})}}const h_=N.auxiliaries.assert,ve=class ve{static createLayout(t,m,y,l,r,a){const n=new Array(t.numberOfNodes);if(h_(m!==void 0,"Valid weights expected"),m===void 0)return n;const i=m[0];if(N.auxiliaries.assertions()&&t.numberOfNodes>1){let p=0;t.forEachLeafNode(d=>{p+=m[d.index]}),h_(i!==void 0&&(p===0||i>0),"Accumulated leaf weights as root weight expected")}const h=y.aspectRatio;switch(y.algorithm){case ve.LayoutAlgorithm.Strip:Wg.compute(t,m,h,n,ve.splittingLayoutPostprocessing(y),l,r,a);break;case ve.LayoutAlgorithm.Snake:qg.compute(t,m,h,n,ve.splittingLayoutPostprocessing(y),l,r,a);break;case ve.LayoutAlgorithm.CodeCity:bt.compute(t,m,h,n,ve.packingLayoutPostprocessing(y),l,r,a);break}return n}static splittingLayoutPostprocessing(t){const m={parentPaddingCallback:ve.emptyParentCallback,siblingMarginBeforeCallback:ve.emptyParentCallback,siblingMarginAfterCallback:ve.emptySiblingCallback,accessoryPaddingCallback:ve.emptyAccessoryParentCallback};let y=[0],l=0;if(t.siblingMargin!==void 0&&(l=t.siblingMargin.value,l>=0))switch(t.siblingMargin.type){case ve.SiblingMarginType.Absolute:m.siblingMarginAfterCallback=(r,a,n,i)=>{if(i.isRoot)return r;const h=l;return r.map(a,n).paddedWithMinArea(h*.5,0)};break;case ve.SiblingMarginType.Relative:m.siblingMarginAfterCallback=(r,a,n,i)=>{if(i.isRoot)return r;const h=r.equalizedRelativeMargin(l);return r.map(a,n).paddedWithMinArea(h*.5,0)};break}if(t.parentPadding!==void 0&&(t.parentPadding.value instanceof Array?y=t.parentPadding.value:y=[t.parentPadding.value],y[0]>=0))switch(t.parentPadding.type){case ve.ParentPaddingType.Mixed:m.parentPaddingCallback=(r,a,n,i,h,p)=>{let d,f;if(y.length-1>a.depth){const s=y[a.depth];d=r.equalizedMargin(s,.5,.9),f=r.padded(d),h!==void 0&&p!==void 0&&(h[a.index]=f,p[a.index]=d)}else d=r.equalizedRelativeMargin(y[y.length-1]),f=r.padded(d);return f},m.siblingMarginBeforeCallback=(r,a,n,i)=>{let h;return y.length>a.depth?h=l:h=r.equalizedRelativeMargin(l),r.padded(-h*.5)};break;case ve.ParentPaddingType.Absolute:m.parentPaddingCallback=(r,a,n,i)=>{const h=r.equalizedMargin(y[0],.5,.6);return r.padded(h)},m.siblingMarginBeforeCallback=(r,a,n,i)=>{const h=l;return r.padded(-h*.5)};break;case ve.ParentPaddingType.Relative:m.parentPaddingCallback=(r,a,n,i)=>{const h=r.equalizedRelativeMargin(y[0]);return r.padded(h)},m.siblingMarginBeforeCallback=(r,a,n,i)=>{const h=r.equalizedRelativeMargin(l);return r.padded(-h*.5)};break}if(t.accessoryPadding!==void 0){const r=t.accessoryPadding.type,a=t.accessoryPadding.value,n=t.accessoryPadding.direction,i=t.accessoryPadding.relativeAreaThreshold!==void 0?t.accessoryPadding.relativeAreaThreshold:0,h=t.accessoryPadding.targetAspectRatio!==void 0?t.accessoryPadding.targetAspectRatio:Number.NaN;if(a!==void 0)switch(r){case ve.AccessoryPaddingType.Absolute:{switch(n){case ve.AccessoryPaddingDirection.Bottom:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;if(a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a,u>p.height)return o[d.index]=new pe(0,0,0,0),p;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.truncateBottom(p.bottom+u),_=p.truncateTop(v.bottom);return v.area/p.area<=b||_.aspectRatio<h?(o[d.index]=new pe(0,0,0,0),p):(o[d.index]=_,v)};break}case ve.AccessoryPaddingDirection.Top:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;if(a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a,u>p.height)return o[d.index]=new pe(0,0,0,0),p;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.truncateTop(p.top-u),_=p.truncateBottom(v.top);return v.area/p.area<=b||_.aspectRatio<h?(o[d.index]=new pe(0,0,0,0),p):(o[d.index]=_,v)};break}case ve.AccessoryPaddingDirection.Left:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;if(a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a,u>p.width)return o[d.index]=new pe(0,0,0,0),p;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.truncateLeft(p.left+u),_=p.truncateRight(v.left);return v.area/p.area<=b||_.aspectRatio<h?(o[d.index]=new pe(0,0,0,0),p):(o[d.index]=_,v)};break}case ve.AccessoryPaddingDirection.Right:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;if(a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a,u>p.width)return o[d.index]=new pe(0,0,0,0),p;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.truncateRight(p.right+u),_=p.truncateLeft(v.right);return v.area/p.area<=b||_.aspectRatio<h?(o[d.index]=new pe(0,0,0,0),p):(o[d.index]=_,v)};break}}break}case ve.AccessoryPaddingType.Relative:{switch(n){case ve.AccessoryPaddingDirection.Bottom:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.relativeTop(1-u);return v.area/p.area>b?v:p};break}case ve.AccessoryPaddingDirection.Top:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.relativeBottom(1-u);return v.area/p.area>b?v:p};break}case ve.AccessoryPaddingDirection.Left:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.relativeRight(1-u);return v.area/p.area>b?v:p};break}case ve.AccessoryPaddingDirection.Right:{m.accessoryPaddingCallback=(p,d,f,s,o)=>{let u;a instanceof Array?u=a.length>d.depth?a[d.depth]:0:u=a;let b;i instanceof Array?b=i.length>d.depth?i[d.depth]:1:b=i;const v=p.relativeLeft(1-u);return v.area/p.area>b?v:p};break}}break}}}return m}static packingLayoutPostprocessing(t){return{parentPaddingCallback:ve.emptyParentCallback,siblingMarginBeforeCallback:ve.emptyParentCallback,siblingMarginAfterCallback:ve.emptySiblingCallback,accessoryPaddingCallback:ve.emptyAccessoryParentCallback}}};ve.emptyParentCallback=(t,m,y,l)=>t,ve.emptyAccessoryParentCallback=(t,m,y,l,r)=>t,ve.emptySiblingCallback=(t,m,y,l)=>t;let xs=ve;(E=>{(t=>{t.Strip="strip",t.Snake="snake",t.CodeCity="codecity"})(E.LayoutAlgorithm||(E.LayoutAlgorithm={})),(t=>{t.Relative="relative",t.Absolute="absolute"})(E.SiblingMarginType||(E.SiblingMarginType={})),(t=>{t.Relative="relative",t.Absolute="absolute",t.Mixed="mixed"})(E.ParentPaddingType||(E.ParentPaddingType={})),(t=>{t.Relative="relative",t.Absolute="absolute"})(E.AccessoryPaddingType||(E.AccessoryPaddingType={})),(t=>{t.Top="top",t.Bottom="bottom",t.Left="left",t.Right="right"})(E.AccessoryPaddingDirection||(E.AccessoryPaddingDirection={}))})(xs||(xs={}));const qe=class qe{static byValue(t,m,y){if(!(m.length<2)){m.sort(y);for(let l=0;l<m.length-1;++l)m[l][0].nextSibling=m[l+1][0].index;m[m.length-1][0].nextSibling=Fe.INVALID_INDEX,t.firstChild=m[0][0].index}}static byValues(t,m,y,l){const r=new Array;let a=t.node(m.firstChild);do r.push([a,y[a.index]]),a=t.node(a.nextSibling);while(a!==void 0);qe.byValue(m,r,l)}static byIdentifier(t,m,y){const l=new Array;let r=t.node(m.firstChild);for(;r!==void 0;)l.push([r,r.id]),r=t.node(r.nextSibling);qe.byValue(m,l,y)}static restoreOriginalSortOrder(t,m){m.firstChild=m.initialFirstChild;for(let y=t.node(m.initialFirstChild);y!==void 0;y=t.node(y.initialNextSibling))y.nextSibling=y.initialNextSibling}static sortNodes(t,m,y,l){const r=l.layout.sort;if(r===void 0||r.algorithm===qe.Algorithm.Keep)return t.forEachInnerNode(n=>qe.restoreOriginalSortOrder(t,n)),!0;let a;switch(r.algorithm){case qe.Algorithm.Ascending:a=qe.ASCENDING_COMPARATOR;break;case qe.Algorithm.Descending:default:a=qe.DESCENDING_COMPARATOR;break}switch(r.key){case qe.Key.Weight:const n=tt.create(t,m,l.layout.weight,l);n&&t.forEachInnerNode(i=>qe.byValues(t,i,n,a));break;case qe.Key.Identity:t.forEachInnerNode(i=>qe.byIdentifier(t,i,a));break;default:y!==void 0&&t.forEachInnerNode(i=>qe.byValues(t,i,y,a))}return!0}};qe.ASCENDING_COMPARATOR=(t,m)=>t[1]-m[1],qe.DESCENDING_COMPARATOR=(t,m)=>m[1]-t[1];let Ss=qe;(E=>{(t=>{t.Keep="keep",t.Ascending="ascending",t.Descending="descending"})(E.Algorithm||(E.Algorithm={})),(t=>{t.Identity="identity",t.Weight="weight"})(E.Key||(E.Key={}))})(Ss||(Ss={}));const Vg=JSON.parse('[{"identifier":"Spectral","type":"diverging","format":"rgb","colors":[[252,141,89,255,255,191,153,213,148],[215,25,28,253,174,97,171,221,164,43,131,186],[215,25,28,253,174,97,255,255,191,171,221,164,43,131,186],[213,62,79,252,141,89,254,224,139,230,245,152,153,213,148,50,136,189],[213,62,79,252,141,89,254,224,139,255,255,191,230,245,152,153,213,148,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162]]},{"identifier":"RdYlGn","type":"diverging","format":"rgb","colors":[[252,141,89,255,255,191,145,207,96],[215,25,28,253,174,97,166,217,106,26,150,65],[215,25,28,253,174,97,255,255,191,166,217,106,26,150,65],[215,48,39,252,141,89,254,224,139,217,239,139,145,207,96,26,152,80],[215,48,39,252,141,89,254,224,139,255,255,191,217,239,139,145,207,96,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55]]},{"identifier":"RdBu","type":"diverging","format":"rgb","colors":[[239,138,98,247,247,247,103,169,207],[202,0,32,244,165,130,146,197,222,5,113,176],[202,0,32,244,165,130,247,247,247,146,197,222,5,113,176],[178,24,43,239,138,98,253,219,199,209,229,240,103,169,207,33,102,172],[178,24,43,239,138,98,253,219,199,247,247,247,209,229,240,103,169,207,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97]]},{"identifier":"PiYG","type":"diverging","format":"rgb","colors":[[233,163,201,247,247,247,161,215,106],[208,28,139,241,182,218,184,225,134,77,172,38],[208,28,139,241,182,218,247,247,247,184,225,134,77,172,38],[197,27,125,233,163,201,253,224,239,230,245,208,161,215,106,77,146,33],[197,27,125,233,163,201,253,224,239,247,247,247,230,245,208,161,215,106,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25]]},{"identifier":"PRGn","type":"diverging","format":"rgb","colors":[[175,141,195,247,247,247,127,191,123],[123,50,148,194,165,207,166,219,160,0,136,55],[123,50,148,194,165,207,247,247,247,166,219,160,0,136,55],[118,42,131,175,141,195,231,212,232,217,240,211,127,191,123,27,120,55],[118,42,131,175,141,195,231,212,232,247,247,247,217,240,211,127,191,123,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27]]},{"identifier":"RdYlBu","type":"diverging","format":"rgb","colors":[[252,141,89,255,255,191,145,191,219],[215,25,28,253,174,97,171,217,233,44,123,182],[215,25,28,253,174,97,255,255,191,171,217,233,44,123,182],[215,48,39,252,141,89,254,224,144,224,243,248,145,191,219,69,117,180],[215,48,39,252,141,89,254,224,144,255,255,191,224,243,248,145,191,219,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149]]},{"identifier":"BrBG","type":"diverging","format":"rgb","colors":[[216,179,101,245,245,245,90,180,172],[166,97,26,223,194,125,128,205,193,1,133,113],[166,97,26,223,194,125,245,245,245,128,205,193,1,133,113],[140,81,10,216,179,101,246,232,195,199,234,229,90,180,172,1,102,94],[140,81,10,216,179,101,246,232,195,245,245,245,199,234,229,90,180,172,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48]]},{"identifier":"RdGy","type":"diverging","format":"rgb","colors":[[239,138,98,255,255,255,153,153,153],[202,0,32,244,165,130,186,186,186,64,64,64],[202,0,32,244,165,130,255,255,255,186,186,186,64,64,64],[178,24,43,239,138,98,253,219,199,224,224,224,153,153,153,77,77,77],[178,24,43,239,138,98,253,219,199,255,255,255,224,224,224,153,153,153,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26]]},{"identifier":"PuOr","type":"diverging","format":"rgb","colors":[[241,163,64,247,247,247,153,142,195],[230,97,1,253,184,99,178,171,210,94,60,153],[230,97,1,253,184,99,247,247,247,178,171,210,94,60,153],[179,88,6,241,163,64,254,224,182,216,218,235,153,142,195,84,39,136],[179,88,6,241,163,64,254,224,182,247,247,247,216,218,235,153,142,195,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75]]},{"identifier":"Set2","type":"qualitative","format":"rgb","colors":[[102,194,165,252,141,98,141,160,203],[102,194,165,252,141,98,141,160,203,231,138,195],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148,179,179,179]]},{"identifier":"Accent","type":"qualitative","format":"rgb","colors":[[127,201,127,190,174,212,253,192,134],[127,201,127,190,174,212,253,192,134,255,255,153],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23,102,102,102]]},{"identifier":"Set1","type":"qualitative","format":"rgb","colors":[[228,26,28,55,126,184,77,175,74],[228,26,28,55,126,184,77,175,74,152,78,163],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191,153,153,153]]},{"identifier":"Set3","type":"qualitative","format":"rgb","colors":[[141,211,199,255,255,179,190,186,218],[141,211,199,255,255,179,190,186,218,251,128,114],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197,255,237,111]]},{"identifier":"Dark2","type":"qualitative","format":"rgb","colors":[[27,158,119,217,95,2,117,112,179],[27,158,119,217,95,2,117,112,179,231,41,138],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29,102,102,102]]},{"identifier":"Paired","type":"qualitative","format":"rgb","colors":[[166,206,227,31,120,180,178,223,138],[166,206,227,31,120,180,178,223,138,51,160,44],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153,177,89,40]]},{"identifier":"Pastel2","type":"qualitative","format":"rgb","colors":[[179,226,205,253,205,172,203,213,232],[179,226,205,253,205,172,203,213,232,244,202,228],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204,204,204,204]]},{"identifier":"Pastel1","type":"qualitative","format":"rgb","colors":[[251,180,174,179,205,227,204,235,197],[251,180,174,179,205,227,204,235,197,222,203,228],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236,242,242,242]]},{"identifier":"OrRd","type":"sequential","format":"rgb","colors":[[254,232,200,253,187,132,227,74,51],[254,240,217,253,204,138,252,141,89,215,48,31],[254,240,217,253,204,138,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,179,0,0,127,0,0]]},{"identifier":"PuBu","type":"sequential","format":"rgb","colors":[[236,231,242,166,189,219,43,140,190],[241,238,246,189,201,225,116,169,207,5,112,176],[241,238,246,189,201,225,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,4,90,141,2,56,88]]},{"identifier":"BuPu","type":"sequential","format":"rgb","colors":[[224,236,244,158,188,218,136,86,167],[237,248,251,179,205,227,140,150,198,136,65,157],[237,248,251,179,205,227,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,129,15,124,77,0,75]]},{"identifier":"Oranges","type":"sequential","format":"rgb","colors":[[254,230,206,253,174,107,230,85,13],[254,237,222,253,190,133,253,141,60,217,71,1],[254,237,222,253,190,133,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,166,54,3,127,39,4]]},{"identifier":"BuGn","type":"sequential","format":"rgb","colors":[[229,245,249,153,216,201,44,162,95],[237,248,251,178,226,226,102,194,164,35,139,69],[237,248,251,178,226,226,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,109,44,0,68,27]]},{"identifier":"YlOrBr","type":"sequential","format":"rgb","colors":[[255,247,188,254,196,79,217,95,14],[255,255,212,254,217,142,254,153,41,204,76,2],[255,255,212,254,217,142,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,153,52,4,102,37,6]]},{"identifier":"YlGn","type":"sequential","format":"rgb","colors":[[247,252,185,173,221,142,49,163,84],[255,255,204,194,230,153,120,198,121,35,132,67],[255,255,204,194,230,153,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,104,55,0,69,41]]},{"identifier":"Reds","type":"sequential","format":"rgb","colors":[[254,224,210,252,146,114,222,45,38],[254,229,217,252,174,145,251,106,74,203,24,29],[254,229,217,252,174,145,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,165,15,21,103,0,13]]},{"identifier":"RdPu","type":"sequential","format":"rgb","colors":[[253,224,221,250,159,181,197,27,138],[254,235,226,251,180,185,247,104,161,174,1,126],[254,235,226,251,180,185,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119,73,0,106]]},{"identifier":"Greens","type":"sequential","format":"rgb","colors":[[229,245,224,161,217,155,49,163,84],[237,248,233,186,228,179,116,196,118,35,139,69],[237,248,233,186,228,179,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,109,44,0,68,27]]},{"identifier":"YlGnBu","type":"sequential","format":"rgb","colors":[[237,248,177,127,205,187,44,127,184],[255,255,204,161,218,180,65,182,196,34,94,168],[255,255,204,161,218,180,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,37,52,148,8,29,88]]},{"identifier":"Purples","type":"sequential","format":"rgb","colors":[[239,237,245,188,189,220,117,107,177],[242,240,247,203,201,226,158,154,200,106,81,163],[242,240,247,203,201,226,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,84,39,143,63,0,125]]},{"identifier":"GnBu","type":"sequential","format":"rgb","colors":[[224,243,219,168,221,181,67,162,202],[240,249,232,186,228,188,123,204,196,43,140,190],[240,249,232,186,228,188,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,104,172,8,64,129]]},{"identifier":"Greys","type":"sequential","format":"rgb","colors":[[240,240,240,189,189,189,99,99,99],[247,247,247,204,204,204,150,150,150,82,82,82],[247,247,247,204,204,204,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37,0,0,0]]},{"identifier":"YlOrRd","type":"sequential","format":"rgb","colors":[[255,237,160,254,178,76,240,59,32],[255,255,178,254,204,92,253,141,60,227,26,28],[255,255,178,254,204,92,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,189,0,38,128,0,38]]},{"identifier":"PuRd","type":"sequential","format":"rgb","colors":[[231,225,239,201,148,199,221,28,119],[241,238,246,215,181,216,223,101,176,206,18,86],[241,238,246,215,181,216,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,152,0,67,103,0,31]]},{"identifier":"Blues","type":"sequential","format":"rgb","colors":[[222,235,247,158,202,225,49,130,189],[239,243,255,189,215,231,107,174,214,33,113,181],[239,243,255,189,215,231,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,81,156,8,48,107]]},{"identifier":"PuBuGn","type":"sequential","format":"rgb","colors":[[236,226,240,166,189,219,28,144,153],[246,239,247,189,201,225,103,169,207,2,129,138],[246,239,247,189,201,225,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,108,89,1,70,54]]}]'),$g=JSON.parse('[{"identifier":"magma","type":"sequential","format":"rgbf","colors":[[0.001462,0.000466,0.013866,0.002258,0.001295,0.018331,0.003279,0.002305,0.023708,0.004512,0.00349,0.029965,0.00595,0.004843,0.03713,0.007588,0.006356,0.044973,0.009426,0.008022,0.052844,0.011465,0.009828,0.06075,0.013708,0.011771,0.068667,0.016156,0.01384,0.076603,0.018815,0.016026,0.084584,0.021692,0.01832,0.09261,0.024792,0.020715,0.100676,0.028123,0.023201,0.108787,0.031696,0.025765,0.116965,0.03552,0.028397,0.125209,0.039608,0.03109,0.133515,0.04383,0.03383,0.141886,0.048062,0.036607,0.150327,0.05232,0.039407,0.158841,0.056615,0.04216,0.167446,0.060949,0.044794,0.176129,0.06533,0.047318,0.184892,0.069764,0.049726,0.193735,0.074257,0.052017,0.20266,0.078815,0.054184,0.211667,0.083446,0.056225,0.220755,0.088155,0.058133,0.229922,0.092949,0.059904,0.239164,0.097833,0.061531,0.248477,0.102815,0.06301,0.257854,0.107899,0.064335,0.267289,0.113094,0.065492,0.276784,0.118405,0.066479,0.286321,0.123833,0.067295,0.295879,0.12938,0.067935,0.305443,0.135053,0.068391,0.315,0.140858,0.068654,0.324538,0.146785,0.068738,0.334011,0.152839,0.068637,0.343404,0.159018,0.068354,0.352688,0.165308,0.067911,0.361816,0.171713,0.067305,0.370771,0.178212,0.066576,0.379497,0.184801,0.065732,0.387973,0.19146,0.064818,0.396152,0.198177,0.063862,0.404009,0.204935,0.062907,0.411514,0.211718,0.061992,0.418647,0.218512,0.061158,0.425392,0.225302,0.060445,0.431742,0.232077,0.059889,0.437695,0.238826,0.059517,0.443256,0.245543,0.059352,0.448436,0.25222,0.059415,0.453248,0.258857,0.059706,0.45771,0.265447,0.060237,0.46184,0.271994,0.060994,0.46566,0.278493,0.061978,0.46919,0.284951,0.063168,0.472451,0.291366,0.064553,0.475462,0.29774,0.066117,0.478243,0.304081,0.067835,0.480812,0.310382,0.069702,0.483186,0.316654,0.07169,0.48538,0.322899,0.073782,0.487408,0.329114,0.075972,0.489287,0.335308,0.078236,0.491024,0.341482,0.080564,0.492631,0.347636,0.082946,0.494121,0.353773,0.085373,0.495501,0.359898,0.087831,0.496778,0.366012,0.090314,0.49796,0.372116,0.092816,0.499053,0.378211,0.095332,0.500067,0.384299,0.097855,0.501002,0.390384,0.100379,0.501864,0.396467,0.102902,0.502658,0.402548,0.10542,0.503386,0.408629,0.10793,0.504052,0.414709,0.110431,0.504662,0.420791,0.11292,0.505215,0.426877,0.115395,0.505714,0.432967,0.117855,0.50616,0.439062,0.120298,0.506555,0.445163,0.122724,0.506901,0.451271,0.125132,0.507198,0.457386,0.127522,0.507448,0.463508,0.129893,0.507652,0.46964,0.132245,0.507809,0.47578,0.134577,0.507921,0.481929,0.136891,0.507989,0.488088,0.139186,0.508011,0.494258,0.141462,0.507988,0.500438,0.143719,0.50792,0.506629,0.145958,0.507806,0.512831,0.148179,0.507648,0.519045,0.150383,0.507443,0.52527,0.152569,0.507192,0.531507,0.154739,0.506895,0.537755,0.156894,0.506551,0.544015,0.159033,0.506159,0.550287,0.161158,0.505719,0.556571,0.163269,0.50523,0.562866,0.165368,0.504692,0.569172,0.167454,0.504105,0.57549,0.16953,0.503466,0.581819,0.171596,0.502777,0.588158,0.173652,0.502035,0.594508,0.175701,0.501241,0.600868,0.177743,0.500394,0.607238,0.179779,0.499492,0.613617,0.181811,0.498536,0.620005,0.18384,0.497524,0.626401,0.185867,0.496456,0.632805,0.187893,0.495332,0.639216,0.189921,0.49415,0.645633,0.191952,0.49291,0.652056,0.193986,0.491611,0.658483,0.196027,0.490253,0.664915,0.198075,0.488836,0.671349,0.200133,0.487358,0.677786,0.202203,0.485819,0.684224,0.204286,0.484219,0.690661,0.206384,0.482558,0.697098,0.208501,0.480835,0.703532,0.210638,0.479049,0.709962,0.212797,0.477201,0.716387,0.214982,0.47529,0.722805,0.217194,0.473316,0.729216,0.219437,0.471279,0.735616,0.221713,0.46918,0.742004,0.224025,0.467018,0.748378,0.226377,0.464794,0.754737,0.228772,0.462509,0.761077,0.231214,0.460162,0.767398,0.233705,0.457755,0.773695,0.236249,0.455289,0.779968,0.238851,0.452765,0.786212,0.241514,0.450184,0.792427,0.244242,0.447543,0.798608,0.24704,0.444848,0.804752,0.249911,0.442102,0.810855,0.252861,0.439305,0.816914,0.255895,0.436461,0.822926,0.259016,0.433573,0.828886,0.262229,0.430644,0.834791,0.26554,0.427671,0.840636,0.268953,0.424666,0.846416,0.272473,0.421631,0.852126,0.276106,0.418573,0.857763,0.279857,0.415496,0.86332,0.283729,0.412403,0.868793,0.287728,0.409303,0.874176,0.291859,0.406205,0.879464,0.296125,0.403118,0.884651,0.30053,0.400047,0.889731,0.305079,0.397002,0.8947,0.309773,0.393995,0.899552,0.314616,0.391037,0.904281,0.31961,0.388137,0.908884,0.324755,0.385308,0.913354,0.330052,0.382563,0.917689,0.3355,0.379915,0.921884,0.341098,0.377376,0.925937,0.346844,0.374959,0.929845,0.352734,0.372677,0.933606,0.358764,0.370541,0.937221,0.364929,0.368567,0.940687,0.371224,0.366762,0.944006,0.377643,0.365136,0.94718,0.384178,0.363701,0.95021,0.39082,0.362468,0.953099,0.397563,0.361438,0.955849,0.4044,0.360619,0.958464,0.411324,0.360014,0.960949,0.418323,0.35963,0.96331,0.42539,0.359469,0.965549,0.432519,0.359529,0.967671,0.439703,0.35981,0.96968,0.446936,0.360311,0.971582,0.45421,0.36103,0.973381,0.46152,0.361965,0.975082,0.468861,0.363111,0.97669,0.476226,0.364466,0.97821,0.483612,0.366025,0.979645,0.491014,0.367783,0.981,0.498428,0.369734,0.982279,0.505851,0.371874,0.983485,0.51328,0.374198,0.984622,0.520713,0.376698,0.985693,0.528148,0.379371,0.9867,0.535582,0.38221,0.987646,0.543015,0.38521,0.988533,0.550446,0.388365,0.989363,0.557873,0.391671,0.990138,0.565296,0.395122,0.990871,0.572706,0.398714,0.991558,0.580107,0.402441,0.992196,0.587502,0.406299,0.992785,0.594891,0.410283,0.993326,0.602275,0.41439,0.993834,0.609644,0.418613,0.994309,0.616999,0.42295,0.994738,0.62435,0.427397,0.995122,0.631696,0.431951,0.99548,0.639027,0.436607,0.99581,0.646344,0.441361,0.996096,0.653659,0.446213,0.996341,0.660969,0.45116,0.99658,0.668256,0.456192,0.996775,0.675541,0.461314,0.996925,0.682828,0.466526,0.997077,0.690088,0.471811,0.997186,0.697349,0.477182,0.997254,0.704611,0.482635,0.997325,0.711848,0.488154,0.997351,0.719089,0.493755,0.997351,0.726324,0.499428,0.997341,0.733545,0.505167,0.997285,0.740772,0.510983,0.997228,0.747981,0.516859,0.997138,0.75519,0.522806,0.997019,0.762398,0.528821,0.996898,0.769591,0.534892,0.996727,0.776795,0.541039,0.996571,0.783977,0.547233,0.996369,0.791167,0.553499,0.996162,0.798348,0.55982,0.995932,0.805527,0.566202,0.99568,0.812706,0.572645,0.995424,0.819875,0.57914,0.995131,0.827052,0.585701,0.994851,0.834213,0.592307,0.994524,0.841387,0.598983,0.994222,0.84854,0.605696,0.993866,0.855711,0.612482,0.993545,0.862859,0.619299,0.99317,0.870024,0.626189,0.992831,0.877168,0.633109,0.99244,0.88433,0.640099,0.992089,0.89147,0.647116,0.991688,0.898627,0.654202,0.991332,0.905763,0.661309,0.99093,0.912915,0.668481,0.99057,0.920049,0.675675,0.990175,0.927196,0.682926,0.989815,0.934329,0.690198,0.989434,0.94147,0.697519,0.989077,0.948604,0.704863,0.988717,0.955742,0.712242,0.988367,0.962878,0.719649,0.988033,0.970012,0.727077,0.987691,0.977154,0.734536,0.987387,0.984288,0.742002,0.987053,0.991438,0.7495]]},{"identifier":"inferno","type":"sequential","format":"rgbf","colors":[[0.001462,0.000466,0.013866,0.002267,0.00127,0.01857,0.003299,0.002249,0.024239,0.004547,0.003392,0.030909,0.006006,0.004692,0.038558,0.007676,0.006136,0.046836,0.009561,0.007713,0.055143,0.011663,0.009417,0.06346,0.013995,0.011225,0.071862,0.016561,0.013136,0.080282,0.019373,0.015133,0.088767,0.022447,0.017199,0.097327,0.025793,0.019331,0.10593,0.029432,0.021503,0.114621,0.033385,0.023702,0.123397,0.037668,0.025921,0.132232,0.042253,0.028139,0.141141,0.046915,0.030324,0.150164,0.051644,0.032474,0.159254,0.056449,0.034569,0.168414,0.06134,0.03659,0.177642,0.066331,0.038504,0.186962,0.071429,0.040294,0.196354,0.076637,0.041905,0.205799,0.081962,0.043328,0.215289,0.087411,0.044556,0.224813,0.09299,0.045583,0.234358,0.098702,0.046402,0.243904,0.104551,0.047008,0.25343,0.110536,0.047399,0.262912,0.116656,0.047574,0.272321,0.122908,0.047536,0.281624,0.129285,0.047293,0.290788,0.135778,0.046856,0.299776,0.142378,0.046242,0.308553,0.149073,0.045468,0.317085,0.15585,0.044559,0.325338,0.162689,0.043554,0.333277,0.169575,0.042489,0.340874,0.176493,0.041402,0.348111,0.183429,0.040329,0.354971,0.190367,0.039309,0.361447,0.197297,0.0384,0.367535,0.204209,0.037632,0.373238,0.211095,0.03703,0.378563,0.217949,0.036615,0.383522,0.224763,0.036405,0.388129,0.231538,0.036405,0.3924,0.238273,0.036621,0.396353,0.244967,0.037055,0.400007,0.25162,0.037705,0.403378,0.258234,0.038571,0.406485,0.26481,0.039647,0.409345,0.271347,0.040922,0.411976,0.27785,0.042353,0.414392,0.284321,0.043933,0.416608,0.290763,0.045644,0.418637,0.297178,0.04747,0.420491,0.303568,0.049396,0.422182,0.309935,0.051407,0.423721,0.316282,0.05349,0.425116,0.32261,0.055634,0.426377,0.328921,0.057827,0.427511,0.335217,0.06006,0.428524,0.3415,0.062325,0.429425,0.347771,0.064616,0.430217,0.354032,0.066925,0.430906,0.360284,0.069247,0.431497,0.366529,0.071579,0.431994,0.372768,0.073915,0.4324,0.379001,0.076253,0.432719,0.385228,0.078591,0.432955,0.391453,0.080927,0.433109,0.397674,0.083257,0.433183,0.403894,0.08558,0.433179,0.410113,0.087896,0.433098,0.416331,0.090203,0.432943,0.422549,0.092501,0.432714,0.428768,0.09479,0.432412,0.434987,0.097069,0.432039,0.441207,0.099338,0.431594,0.447428,0.101597,0.43108,0.453651,0.103848,0.430498,0.459875,0.106089,0.429846,0.4661,0.108322,0.429125,0.472328,0.110547,0.428334,0.478558,0.112764,0.427475,0.484789,0.114974,0.426548,0.491022,0.117179,0.425552,0.497257,0.119379,0.424488,0.503493,0.121575,0.423356,0.50973,0.123769,0.422156,0.515967,0.12596,0.420887,0.522206,0.12815,0.419549,0.528444,0.130341,0.418142,0.534683,0.132534,0.416667,0.54092,0.134729,0.415123,0.547157,0.136929,0.413511,0.553392,0.139134,0.411829,0.559624,0.141346,0.410078,0.565854,0.143567,0.408258,0.572081,0.145797,0.406369,0.578304,0.148039,0.404411,0.584521,0.150294,0.402385,0.590734,0.152563,0.40029,0.59694,0.154848,0.398125,0.603139,0.157151,0.395891,0.60933,0.159474,0.393589,0.615513,0.161817,0.391219,0.621685,0.164184,0.388781,0.627847,0.166575,0.386276,0.633998,0.168992,0.383704,0.640135,0.171438,0.381065,0.64626,0.173914,0.378359,0.652369,0.176421,0.375586,0.658463,0.178962,0.372748,0.66454,0.181539,0.369846,0.670599,0.184153,0.366879,0.676638,0.186807,0.363849,0.682656,0.189501,0.360757,0.688653,0.192239,0.357603,0.694627,0.195021,0.354388,0.700576,0.197851,0.351113,0.7065,0.200728,0.347777,0.712396,0.203656,0.344383,0.718264,0.206636,0.340931,0.724103,0.20967,0.337424,0.729909,0.212759,0.333861,0.735683,0.215906,0.330245,0.741423,0.219112,0.326576,0.747127,0.222378,0.322856,0.752794,0.225706,0.319085,0.758422,0.229097,0.315266,0.76401,0.232554,0.311399,0.769556,0.236077,0.307485,0.775059,0.239667,0.303526,0.780517,0.243327,0.299523,0.785929,0.247056,0.295477,0.791293,0.250856,0.29139,0.796607,0.254728,0.287264,0.801871,0.258674,0.283099,0.807082,0.262692,0.278898,0.812239,0.266786,0.274661,0.817341,0.270954,0.27039,0.822386,0.275197,0.266085,0.827372,0.279517,0.26175,0.832299,0.283913,0.257383,0.837165,0.288385,0.252988,0.841969,0.292933,0.248564,0.846709,0.297559,0.244113,0.851384,0.30226,0.239636,0.855992,0.307038,0.235133,0.860533,0.311892,0.230606,0.865006,0.316822,0.226055,0.869409,0.321827,0.221482,0.873741,0.326906,0.216886,0.878001,0.33206,0.212268,0.882188,0.337287,0.207628,0.886302,0.342586,0.202968,0.890341,0.347957,0.198286,0.894305,0.353399,0.193584,0.898192,0.358911,0.18886,0.902003,0.364492,0.184116,0.905735,0.37014,0.17935,0.90939,0.375856,0.174563,0.912966,0.381636,0.169755,0.916462,0.387481,0.164924,0.919879,0.393389,0.16007,0.923215,0.399359,0.155193,0.92647,0.405389,0.150292,0.929644,0.411479,0.145367,0.932737,0.417627,0.140417,0.935747,0.423831,0.13544,0.938675,0.430091,0.130438,0.941521,0.436405,0.125409,0.944285,0.442772,0.120354,0.946965,0.449191,0.115272,0.949562,0.45566,0.110164,0.952075,0.462178,0.105031,0.954506,0.468744,0.099874,0.956852,0.475356,0.094695,0.959114,0.482014,0.089499,0.961293,0.488716,0.084289,0.963387,0.495462,0.079073,0.965397,0.502249,0.073859,0.967322,0.509078,0.068659,0.969163,0.515946,0.063488,0.970919,0.522853,0.058367,0.97259,0.529798,0.053324,0.974176,0.53678,0.048392,0.975677,0.543798,0.043618,0.977092,0.55085,0.03905,0.978422,0.557937,0.034931,0.979666,0.565057,0.031409,0.980824,0.572209,0.028508,0.981895,0.579392,0.02625,0.982881,0.586606,0.024661,0.983779,0.593849,0.02377,0.984591,0.601122,0.023606,0.985315,0.608422,0.024202,0.985952,0.61575,0.025592,0.986502,0.623105,0.027814,0.986964,0.630485,0.030908,0.987337,0.63789,0.034916,0.987622,0.64532,0.039886,0.987819,0.652773,0.045581,0.987926,0.66025,0.05175,0.987945,0.667748,0.058329,0.987874,0.675267,0.065257,0.987714,0.682807,0.072489,0.987464,0.690366,0.07999,0.987124,0.697944,0.087731,0.986694,0.70554,0.095694,0.986175,0.713153,0.103863,0.985566,0.720782,0.112229,0.984865,0.728427,0.120785,0.984075,0.736087,0.129527,0.983196,0.743758,0.138453,0.982228,0.751442,0.147565,0.981173,0.759135,0.156863,0.980032,0.766837,0.166353,0.978806,0.774545,0.176037,0.977497,0.782258,0.185923,0.976108,0.789974,0.196018,0.974638,0.797692,0.206332,0.973088,0.805409,0.216877,0.971468,0.813122,0.227658,0.969783,0.820825,0.238686,0.968041,0.828515,0.249972,0.966243,0.836191,0.261534,0.964394,0.843848,0.273391,0.962517,0.851476,0.285546,0.960626,0.859069,0.29801,0.95872,0.866624,0.31082,0.956834,0.874129,0.323974,0.954997,0.881569,0.337475,0.953215,0.888942,0.351369,0.951546,0.896226,0.365627,0.950018,0.903409,0.380271,0.948683,0.910473,0.395289,0.947594,0.917399,0.410665,0.946809,0.924168,0.426373,0.946392,0.930761,0.442367,0.946403,0.937159,0.458592,0.946903,0.943348,0.47497,0.947937,0.949318,0.491426,0.949545,0.955063,0.50786,0.95174,0.960587,0.524203,0.954529,0.965896,0.540361,0.957896,0.971003,0.556275,0.961812,0.975924,0.571925,0.966249,0.980678,0.587206,0.971162,0.985282,0.602154,0.976511,0.989753,0.61676,0.982257,0.994109,0.631017,0.988362,0.998364,0.644924]]},{"identifier":"plasma","type":"diverging","format":"rgbf","colors":[[0.050383,0.029803,0.527975,0.063536,0.028426,0.533124,0.075353,0.027206,0.538007,0.086222,0.026125,0.542658,0.096379,0.025165,0.547103,0.10598,0.024309,0.551368,0.115124,0.023556,0.555468,0.123903,0.022878,0.559423,0.132381,0.022258,0.56325,0.140603,0.021687,0.566959,0.148607,0.021154,0.570562,0.156421,0.020651,0.574065,0.16407,0.020171,0.577478,0.171574,0.019706,0.580806,0.17895,0.019252,0.584054,0.186213,0.018803,0.587228,0.193374,0.018354,0.59033,0.200445,0.017902,0.593364,0.207435,0.017442,0.596333,0.21435,0.016973,0.599239,0.221197,0.016497,0.602083,0.227983,0.016007,0.604867,0.234715,0.015502,0.607592,0.241396,0.014979,0.610259,0.248032,0.014439,0.612868,0.254627,0.013882,0.615419,0.261183,0.013308,0.617911,0.267703,0.012716,0.620346,0.274191,0.012109,0.622722,0.280648,0.011488,0.625038,0.287076,0.010855,0.627295,0.293478,0.010213,0.62949,0.299855,0.009561,0.631624,0.30621,0.008902,0.633694,0.312543,0.008239,0.6357,0.318856,0.007576,0.63764,0.32515,0.006915,0.639512,0.331426,0.006261,0.641316,0.337683,0.005618,0.643049,0.343925,0.004991,0.64471,0.35015,0.004382,0.646298,0.356359,0.003798,0.64781,0.362553,0.003243,0.649245,0.368733,0.002724,0.650601,0.374897,0.002245,0.651876,0.381047,0.001814,0.653068,0.387183,0.001434,0.654177,0.393304,0.001114,0.655199,0.399411,0.000859,0.656133,0.405503,0.000678,0.656977,0.41158,0.000577,0.65773,0.417642,0.000564,0.65839,0.423689,0.000646,0.658956,0.429719,0.000831,0.659425,0.435734,0.001127,0.659797,0.441732,0.00154,0.660069,0.447714,0.00208,0.66024,0.453677,0.002755,0.66031,0.459623,0.003574,0.660277,0.46555,0.004545,0.660139,0.471457,0.005678,0.659897,0.477344,0.00698,0.659549,0.48321,0.00846,0.659095,0.489055,0.010127,0.658534,0.494877,0.01199,0.657865,0.500678,0.014055,0.657088,0.506454,0.016333,0.656202,0.512206,0.018833,0.655209,0.517933,0.021563,0.654109,0.523633,0.024532,0.652901,0.529306,0.027747,0.651586,0.534952,0.031217,0.650165,0.54057,0.03495,0.64864,0.546157,0.038954,0.64701,0.551715,0.043136,0.645277,0.557243,0.047331,0.643443,0.562738,0.051545,0.641509,0.568201,0.055778,0.639477,0.573632,0.060028,0.637349,0.579029,0.064296,0.635126,0.584391,0.068579,0.632812,0.589719,0.072878,0.630408,0.595011,0.07719,0.627917,0.600266,0.081516,0.625342,0.605485,0.085854,0.622686,0.610667,0.090204,0.619951,0.615812,0.094564,0.61714,0.620919,0.098934,0.614257,0.625987,0.103312,0.611305,0.631017,0.107699,0.608287,0.636008,0.112092,0.605205,0.640959,0.116492,0.602065,0.645872,0.120898,0.598867,0.650746,0.125309,0.595617,0.65558,0.129725,0.592317,0.660374,0.134144,0.588971,0.665129,0.138566,0.585582,0.669845,0.142992,0.582154,0.674522,0.147419,0.578688,0.67916,0.151848,0.575189,0.683758,0.156278,0.57166,0.688318,0.160709,0.568103,0.69284,0.165141,0.564522,0.697324,0.169573,0.560919,0.701769,0.174005,0.557296,0.706178,0.178437,0.553657,0.710549,0.182868,0.550004,0.714883,0.187299,0.546338,0.719181,0.191729,0.542663,0.723444,0.196158,0.538981,0.72767,0.200586,0.535293,0.731862,0.205013,0.531601,0.736019,0.209439,0.527908,0.740143,0.213864,0.524216,0.744232,0.218288,0.520524,0.748289,0.222711,0.516834,0.752312,0.227133,0.513149,0.756304,0.231555,0.509468,0.760264,0.235976,0.505794,0.764193,0.240396,0.502126,0.76809,0.244817,0.498465,0.771958,0.249237,0.494813,0.775796,0.253658,0.491171,0.779604,0.258078,0.487539,0.783383,0.2625,0.483918,0.787133,0.266922,0.480307,0.790855,0.271345,0.476706,0.794549,0.27577,0.473117,0.798216,0.280197,0.469538,0.801855,0.284626,0.465971,0.805467,0.289057,0.462415,0.809052,0.293491,0.45887,0.812612,0.297928,0.455338,0.816144,0.302368,0.451816,0.819651,0.306812,0.448306,0.823132,0.311261,0.444806,0.826588,0.315714,0.441316,0.830018,0.320172,0.437836,0.833422,0.324635,0.434366,0.836801,0.329105,0.430905,0.840155,0.33358,0.427455,0.843484,0.338062,0.424013,0.846788,0.342551,0.420579,0.850066,0.347048,0.417153,0.853319,0.351553,0.413734,0.856547,0.356066,0.410322,0.85975,0.360588,0.406917,0.862927,0.365119,0.403519,0.866078,0.36966,0.400126,0.869203,0.374212,0.396738,0.872303,0.378774,0.393355,0.875376,0.383347,0.389976,0.878423,0.387932,0.3866,0.881443,0.392529,0.383229,0.884436,0.397139,0.37986,0.887402,0.401762,0.376494,0.89034,0.406398,0.37313,0.89325,0.411048,0.369768,0.896131,0.415712,0.366407,0.898984,0.420392,0.363047,0.901807,0.425087,0.359688,0.904601,0.429797,0.356329,0.907365,0.434524,0.35297,0.910098,0.439268,0.34961,0.9128,0.444029,0.346251,0.915471,0.448807,0.34289,0.918109,0.453603,0.339529,0.920714,0.458417,0.336166,0.923287,0.463251,0.332801,0.925825,0.468103,0.329435,0.928329,0.472975,0.326067,0.930798,0.477867,0.322697,0.933232,0.48278,0.319325,0.93563,0.487712,0.315952,0.93799,0.492667,0.312575,0.940313,0.497642,0.309197,0.942598,0.502639,0.305816,0.944844,0.507658,0.302433,0.947051,0.512699,0.299049,0.949217,0.517763,0.295662,0.951344,0.52285,0.292275,0.953428,0.52796,0.288883,0.95547,0.533093,0.28549,0.957469,0.53825,0.282096,0.959424,0.543431,0.278701,0.961336,0.548636,0.275305,0.963203,0.553865,0.271909,0.965024,0.559118,0.268513,0.966798,0.564396,0.265118,0.968526,0.5697,0.261721,0.970205,0.575028,0.258325,0.971835,0.580382,0.254931,0.973416,0.585761,0.25154,0.974947,0.591165,0.248151,0.976428,0.596595,0.244767,0.977856,0.602051,0.241387,0.979233,0.607532,0.238013,0.980556,0.613039,0.234646,0.981826,0.618572,0.231287,0.983041,0.624131,0.227937,0.984199,0.629718,0.224595,0.985301,0.63533,0.221265,0.986345,0.640969,0.217948,0.987332,0.646633,0.214648,0.98826,0.652325,0.211364,0.989128,0.658043,0.2081,0.989935,0.663787,0.204859,0.990681,0.669558,0.201642,0.991365,0.675355,0.198453,0.991985,0.681179,0.195295,0.992541,0.68703,0.19217,0.993032,0.692907,0.189084,0.993456,0.69881,0.186041,0.993814,0.704741,0.183043,0.994103,0.710698,0.180097,0.994324,0.716681,0.177208,0.994474,0.722691,0.174381,0.994553,0.728728,0.171622,0.994561,0.734791,0.168938,0.994495,0.74088,0.166335,0.994355,0.746995,0.163821,0.994141,0.753137,0.161404,0.993851,0.759304,0.159092,0.993482,0.765499,0.156891,0.993033,0.77172,0.154808,0.992505,0.777967,0.152855,0.991897,0.784239,0.151042,0.991209,0.790537,0.149377,0.990439,0.796859,0.14787,0.989587,0.803205,0.146529,0.988648,0.809579,0.145357,0.987621,0.815978,0.144363,0.986509,0.822401,0.143557,0.985314,0.828846,0.142945,0.984031,0.835315,0.142528,0.982653,0.841812,0.142303,0.98119,0.848329,0.142279,0.979644,0.854866,0.142453,0.977995,0.861432,0.142808,0.976265,0.868016,0.143351,0.974443,0.874622,0.144061,0.97253,0.88125,0.144923,0.970533,0.887896,0.145919,0.968443,0.894564,0.147014,0.966271,0.901249,0.14818,0.964021,0.90795,0.14937,0.961681,0.914672,0.15052,0.959276,0.921407,0.151566,0.956808,0.928152,0.152409,0.954287,0.934908,0.152921,0.951726,0.941671,0.152925,0.949151,0.948435,0.152178,0.946602,0.95519,0.150328,0.944152,0.961916,0.146861,0.941896,0.96859,0.140956,0.940015,0.975158,0.131326]]},{"identifier":"viridis","type":"diverging","format":"rgbf","colors":[[0.267004,0.004874,0.329415,0.26851,0.009605,0.335427,0.269944,0.014625,0.341379,0.271305,0.019942,0.347269,0.272594,0.025563,0.353093,0.273809,0.031497,0.358853,0.274952,0.037752,0.364543,0.276022,0.044167,0.370164,0.277018,0.050344,0.375715,0.277941,0.056324,0.381191,0.278791,0.062145,0.386592,0.279566,0.067836,0.391917,0.280267,0.073417,0.397163,0.280894,0.078907,0.402329,0.281446,0.08432,0.407414,0.281924,0.089666,0.412415,0.282327,0.094955,0.417331,0.282656,0.100196,0.42216,0.28291,0.105393,0.426902,0.283091,0.110553,0.431554,0.283197,0.11568,0.436115,0.283229,0.120777,0.440584,0.283187,0.125848,0.44496,0.283072,0.130895,0.449241,0.282884,0.13592,0.453427,0.282623,0.140926,0.457517,0.28229,0.145912,0.46151,0.281887,0.150881,0.465405,0.281412,0.155834,0.469201,0.280868,0.160771,0.472899,0.280255,0.165693,0.476498,0.279574,0.170599,0.479997,0.278826,0.17549,0.483397,0.278012,0.180367,0.486697,0.277134,0.185228,0.489898,0.276194,0.190074,0.493001,0.275191,0.194905,0.496005,0.274128,0.199721,0.498911,0.273006,0.20452,0.501721,0.271828,0.209303,0.504434,0.270595,0.214069,0.507052,0.269308,0.218818,0.509577,0.267968,0.223549,0.512008,0.26658,0.228262,0.514349,0.265145,0.232956,0.516599,0.263663,0.237631,0.518762,0.262138,0.242286,0.520837,0.260571,0.246922,0.522828,0.258965,0.251537,0.524736,0.257322,0.25613,0.526563,0.255645,0.260703,0.528312,0.253935,0.265254,0.529983,0.252194,0.269783,0.531579,0.250425,0.27429,0.533103,0.248629,0.278775,0.534556,0.246811,0.283237,0.535941,0.244972,0.287675,0.53726,0.243113,0.292092,0.538516,0.241237,0.296485,0.539709,0.239346,0.300855,0.540844,0.237441,0.305202,0.541921,0.235526,0.309527,0.542944,0.233603,0.313828,0.543914,0.231674,0.318106,0.544834,0.229739,0.322361,0.545706,0.227802,0.326594,0.546532,0.225863,0.330805,0.547314,0.223925,0.334994,0.548053,0.221989,0.339161,0.548752,0.220057,0.343307,0.549413,0.21813,0.347432,0.550038,0.21621,0.351535,0.550627,0.214298,0.355619,0.551184,0.212395,0.359683,0.55171,0.210503,0.363727,0.552206,0.208623,0.367752,0.552675,0.206756,0.371758,0.553117,0.204903,0.375746,0.553533,0.203063,0.379716,0.553925,0.201239,0.38367,0.554294,0.19943,0.387607,0.554642,0.197636,0.391528,0.554969,0.19586,0.395433,0.555276,0.1941,0.399323,0.555565,0.192357,0.403199,0.555836,0.190631,0.407061,0.556089,0.188923,0.41091,0.556326,0.187231,0.414746,0.556547,0.185556,0.41857,0.556753,0.183898,0.422383,0.556944,0.182256,0.426184,0.55712,0.180629,0.429975,0.557282,0.179019,0.433756,0.55743,0.177423,0.437527,0.557565,0.175841,0.44129,0.557685,0.174274,0.445044,0.557792,0.172719,0.448791,0.557885,0.171176,0.45253,0.557965,0.169646,0.456262,0.55803,0.168126,0.459988,0.558082,0.166617,0.463708,0.558119,0.165117,0.467423,0.558141,0.163625,0.471133,0.558148,0.162142,0.474838,0.55814,0.160665,0.47854,0.558115,0.159194,0.482237,0.558073,0.157729,0.485932,0.558013,0.15627,0.489624,0.557936,0.154815,0.493313,0.55784,0.153364,0.497,0.557724,0.151918,0.500685,0.557587,0.150476,0.504369,0.55743,0.149039,0.508051,0.55725,0.147607,0.511733,0.557049,0.14618,0.515413,0.556823,0.144759,0.519093,0.556572,0.143343,0.522773,0.556295,0.141935,0.526453,0.555991,0.140536,0.530132,0.555659,0.139147,0.533812,0.555298,0.13777,0.537492,0.554906,0.136408,0.541173,0.554483,0.135066,0.544853,0.554029,0.133743,0.548535,0.553541,0.132444,0.552216,0.553018,0.131172,0.555899,0.552459,0.129933,0.559582,0.551864,0.128729,0.563265,0.551229,0.127568,0.566949,0.550556,0.126453,0.570633,0.549841,0.125394,0.574318,0.549086,0.124395,0.578002,0.548287,0.123463,0.581687,0.547445,0.122606,0.585371,0.546557,0.121831,0.589055,0.545623,0.121148,0.592739,0.544641,0.120565,0.596422,0.543611,0.120092,0.600104,0.54253,0.119738,0.603785,0.5414,0.119512,0.607464,0.540218,0.119423,0.611141,0.538982,0.119483,0.614817,0.537692,0.119699,0.61849,0.536347,0.120081,0.622161,0.534946,0.120638,0.625828,0.533488,0.12138,0.629492,0.531973,0.122312,0.633153,0.530398,0.123444,0.636809,0.528763,0.12478,0.640461,0.527068,0.126326,0.644107,0.525311,0.128087,0.647749,0.523491,0.130067,0.651384,0.521608,0.132268,0.655014,0.519661,0.134692,0.658636,0.517649,0.137339,0.662252,0.515571,0.14021,0.665859,0.513427,0.143303,0.669459,0.511215,0.146616,0.67305,0.508936,0.150148,0.676631,0.506589,0.153894,0.680203,0.504172,0.157851,0.683765,0.501686,0.162016,0.687316,0.499129,0.166383,0.690856,0.496502,0.170948,0.694384,0.493803,0.175707,0.6979,0.491033,0.180653,0.701402,0.488189,0.185783,0.704891,0.485273,0.19109,0.708366,0.482284,0.196571,0.711827,0.479221,0.202219,0.715272,0.476084,0.20803,0.718701,0.472873,0.214,0.722114,0.469588,0.220124,0.725509,0.466226,0.226397,0.728888,0.462789,0.232815,0.732247,0.459277,0.239374,0.735588,0.455688,0.24607,0.73891,0.452024,0.252899,0.742211,0.448284,0.259857,0.745492,0.444467,0.266941,0.748751,0.440573,0.274149,0.751988,0.436601,0.281477,0.755203,0.432552,0.288921,0.758394,0.428426,0.296479,0.761561,0.424223,0.304148,0.764704,0.419943,0.311925,0.767822,0.415586,0.319809,0.770914,0.411152,0.327796,0.77398,0.40664,0.335885,0.777018,0.402049,0.344074,0.780029,0.397381,0.35236,0.783011,0.392636,0.360741,0.785964,0.387814,0.369214,0.788888,0.382914,0.377779,0.791781,0.377939,0.386433,0.794644,0.372886,0.395174,0.797475,0.367757,0.404001,0.800275,0.362552,0.412913,0.803041,0.357269,0.421908,0.805774,0.35191,0.430983,0.808473,0.346476,0.440137,0.811138,0.340967,0.449368,0.813768,0.335384,0.458674,0.816363,0.329727,0.468053,0.818921,0.323998,0.477504,0.821444,0.318195,0.487026,0.823929,0.312321,0.496615,0.826376,0.306377,0.506271,0.828786,0.300362,0.515992,0.831158,0.294279,0.525776,0.833491,0.288127,0.535621,0.835785,0.281908,0.545524,0.838039,0.275626,0.555484,0.840254,0.269281,0.565498,0.84243,0.262877,0.575563,0.844566,0.256415,0.585678,0.846661,0.249897,0.595839,0.848717,0.243329,0.606045,0.850733,0.236712,0.616293,0.852709,0.230052,0.626579,0.854645,0.223353,0.636902,0.856542,0.21662,0.647257,0.8584,0.209861,0.657642,0.860219,0.203082,0.668054,0.861999,0.196293,0.678489,0.863742,0.189503,0.688944,0.865448,0.182725,0.699415,0.867117,0.175971,0.709898,0.868751,0.169257,0.720391,0.87035,0.162603,0.730889,0.871916,0.156029,0.741388,0.873449,0.149561,0.751884,0.874951,0.143228,0.762373,0.876424,0.137064,0.772852,0.877868,0.131109,0.783315,0.879285,0.125405,0.79376,0.880678,0.120005,0.804182,0.882046,0.114965,0.814576,0.883393,0.110347,0.82494,0.88472,0.106217,0.83527,0.886029,0.102646,0.845561,0.887322,0.099702,0.85581,0.888601,0.097452,0.866013,0.889868,0.095953,0.876168,0.891125,0.09525,0.886271,0.892374,0.095374,0.89632,0.893616,0.096335,0.906311,0.894855,0.098125,0.916242,0.896091,0.100717,0.926106,0.89733,0.104071,0.935904,0.89857,0.108131,0.945636,0.899815,0.112838,0.9553,0.901065,0.118128,0.964894,0.902323,0.123941,0.974417,0.90359,0.130215,0.983868,0.904867,0.136897,0.993248,0.906157,0.143936]]}]'),uo=N.auxiliaries.assert,Hg=[...Vg,...$g];class Yg{constructor(){this._intermediaries=new kg,this._labelsChanged=!1,this._bufferResolver=new jg(this._intermediaries.topology),this._geometry=new gt,this._renderer=new Pl(this),this._renderer.geometry=this._geometry}applyInnerNodeColorMapping(t){const m=t.geometry,y=t.altered.geometry;if(uo(this._geometry.innerNodeColors!==void 0||y.any,"expected any alteration when inner-node color mapping is yet to be defined"),!y.any&&!t.altered.topology)return;uo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)");const l=this._intermediaries.topology;(t.altered.topology||y.emphasis.any||this._geometry.innerNodeEmphases===void 0)&&(this._geometry.innerNodeEmphases=o_.innerNodes(l,m.emphasis?new Set(m.emphasis.outline):void 0,m.emphasis?new Set(m.emphasis.highlight):void 0)),(t.altered.topology||this._geometry.innerNodeColors===void 0)&&(this._geometry.innerNodeColors=Lg.innerNodes(l,this._colorLUT.innerNodeColorOffset,this._colorLUT.innerNodeColorCount))}applyLeafNodeColorMapping(t){const m=t.geometry,y=t.altered.geometry;if(!y.any&&!t.altered.topology)return;if(uo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)"),(t.altered.topology||y.emphasis.any||this._geometry.leafNodeEmphases===void 0)&&(this._geometry.leafNodeEmphases=o_.leafNodes(this._intermediaries.topology,m.emphasis?new Set(m.emphasis.outline):void 0,m.emphasis?new Set(m.emphasis.highlight):void 0)),!(m.leafLayer!==void 0)){this._geometry.leafNodeColors=mt.defaultLeafNodeColors(this._intermediaries.topology,this._colorLUT.leafColorOffset);return}if(!y.colors&&this._geometry.leafNodeColors!==void 0)return;const r=this._bufferResolver.resolve(m.leafLayer.colors,t,this._normalization,this._bufferResolver.constBufferCallback(0));this._intermediaries.aggregatedColors=r;const a=m.leafLayer.colorsNormalized?[0,1]:tt.leafRange(r,this._intermediaries.topology),n=this._colorLUT.leafColorCount,i=this._colorLUT.leafColorOffset;this._geometry.leafNodeColors=mt.createLeafNodeColors(this._intermediaries.topology,r,i,n,a),this._geometry.altered.alter("leafNodeColors")}createLayout(t,m,y,l,r,a){return xs.createLayout(t,m,y.layout,l,r,a)}updateLabels(){const t=this._intermediaries.innerNodeLabels,m=this._intermediaries.leafLabels;if(this._geometry===void 0||!this._geometry.valid||m===void 0||t===void 0)return;let y=!1;if(this._labelsChanged&&(this._renderer.updateLabels(t,m),this._renderer.updatePoints(m),y=!0),this._renderer.camera.altered||this._labelsChanged){const l=Dg.adaptPositionToPreventOverlapGreedy(m,this._renderer.camera);l.visibility||l.positioning?(this._renderer.updateLeafLabelBackgrounds(m),this._renderer.updateLeafLabelPass()):this._renderer.frameSizeAltered()?this._renderer.updateLeafLabelBackgrounds(m):y&&this._renderer.updateLeafLabelBackgrounds(m),l.visibility&&this._renderer.updatePoints(m)}this._labelsChanged&&(this._labelsChanged=!1)}update(){var u;if(this._configuration===void 0||this._configuration.topology===void 0)return this._geometry.initialized&&this._geometry.uninitialize(),!0;const t=this._configuration,m=t.altered;if(!m.any)return!1;uo(t.topology!==void 0,"Valid topology expected");let y=m.layout.sort;const l=this._intermediaries.topology;let r;m.topology&&(l.initialize(t.topology.format,t.topology.semantics,t.topology.edges),this._intermediaries.aggregatedWeights=void 0,this._intermediaries.aggregatedHeights=void 0,this._intermediaries.aggregatedColors=void 0,this._intermediaries.accessorySpaces=void 0,this._intermediaries.labelRects=void 0,this._intermediaries.labelPaddingSpaces=void 0,r=void 0,this._geometry.initialized&&this._geometry.uninitialize(),this._geometry.initialize(l),y=!0),this._normalization=tt.createNormalization(l,t);let a=this._intermediaries.aggregatedWeights;(a===void 0||m.layout.weight)&&(a=this._intermediaries.aggregatedWeights=this._bufferResolver.resolve(t.layout.weight,t,this._normalization),r=void 0,y=!0),y&&(Ss.sortNodes(l,this._normalization,a,t),r=void 0);let n=this._intermediaries.accessorySpaces,i=this._intermediaries.labelRects,h=this._intermediaries.labelPaddingSpaces;if((r===void 0||m.layout.any)&&(n=this._intermediaries.accessorySpaces=new Array(l.numberOfInnerNodes),i=this._intermediaries.labelRects=new Array(l.numberOfInnerNodes),h=this._intermediaries.labelPaddingSpaces=new Array(l.numberOfInnerNodes),r=this.createLayout(l,a,t,n,i,h),this._geometry.innerNodeLayouts=void 0,this._geometry.leafNodeLayouts=void 0),this._geometry.innerNodeIndices===void 0&&(this._geometry.innerNodeIndices=u_.innerNodes(l)),this._geometry.leafNodeIndices===void 0&&(this._geometry.leafNodeIndices=u_.leafNodes(l)),this._geometry.innerNodeLayouts===void 0&&(this._geometry.innerNodeLayouts=mt.createParentLayoutBuffer(l,r,this._configuration.geometry)),this._geometry.leafNodeLayouts===void 0&&(this._geometry.leafNodeLayouts=mt.createLeafLayoutBuffer(l,r,this._configuration.geometry)),this._geometry.leafNodeAreaScales===void 0){const b=this._bufferResolver.constBufferCallback(1);if(this._configuration.geometry.leafLayer){const v=this._bufferResolver.resolve(this._configuration.geometry.leafLayer.areaScale,t,this._normalization,b);this._geometry.leafNodeAreaScales=mt.createLeafAreaScalesBuffer(l,v)}else this._geometry.leafNodeAreaScales=mt.createLeafAreaScalesBuffer(l,b())}const p=(b,v)=>{switch(v){case N.Color.Space.CMYK:{const _=b.fill(1,b.length,5);return new N.Color().fromCMYK(_[0],_[1],_[2],_[3],_[4])}case N.Color.Space.LAB:{const _=b.fill(1,b.length,4);return new N.Color().fromLAB(_[0],_[1],_[2],_[3])}case N.Color.Space.HSL:{const _=b.fill(1,b.length,4);return new N.Color().fromHSL(_[0],_[1],_[2],_[3])}case"hex":return new N.Color().fromHex(b);default:case N.Color.Space.RGB:{const _=b.fill(1,b.length,4);return new N.Color().fromRGB(_[0],_[1],_[2],_[3])}}},d=(b,v)=>{const _=new Array(b.length);for(let g=0;g<_.length;++g)_[g]=p(b[g],v);return _},f=(b,v,_)=>{if(b===void 0||v===void 0)return _;const g=b.find(x=>x.identifier===v.split(":")[1]);if(g===void 0)return _;if($r.isColorArray(g))return g.value!==void 0?p(g.value,g.colorspace):d(g.values,g.colorspace);if($r.isColorPreset(g)){const x=Hg.find(A=>A.identifier==g.preset);if(!x)return _;const T=g.steps&&x.colors.find(A=>A.length===g.steps*3)||x.colors[0];return N.ColorScale.fromArray(T,x.format,T.length/3,void 0).colors}else return _};if(t.altered.colors||this._colorLUT===void 0){const b=f(t.colors,t.geometry.emphasis?t.geometry.emphasis.color:void 0,new N.Color([0,.27058823529411763,.39215686274509803])),v=f(t.colors,t.geometry.auxiliary,new N.Color([0/255,67/255,37/255])),_=t.geometry.parentLayer?f(t.colors,t.geometry.parentLayer.colorMap,[new N.Color([91/255,92/255,93/255]),new N.Color([93/255,94/255,96/255])]):[new N.Color([91/255,92/255,93/255]),new N.Color([93/255,94/255,96/255])],g=t.geometry.leafLayer?f(t.colors,t.geometry.leafLayer.colorMap,[new N.Color([0/255,0/255,0/255]),new N.Color([44/255,14/255,49/255])]):[new N.Color([0/255,0/255,0/255]),new N.Color([44/255,14/255,49/255])];this._colorLUT=new Ug(b,v,_,g),this._geometry.colorTable=void 0}(!this._geometry.colorTable||this._geometry.colorTable.length!==this._colorLUT.bits.length)&&(this._geometry.colorTable=this._colorLUT.bits,this._geometry.altered.alter("colorTableLength"),this._renderer.invalidate()),this.applyInnerNodeColorMapping(t),this.applyLeafNodeColorMapping(t);let s=this._geometry.heightScale;if(s===void 0||m.geometry.heightScale){const b=t.geometry.heightScale;b!==void 0&&b in ai.HeightScaleApproach?s=this._geometry.heightScale=ai.heightScale(l,b):b!==void 0?s=this._geometry.heightScale=b:s=this._geometry.heightScale=ai.heightScale(l,ai.HeightScaleApproach.SomethingInverseSqrt),this._geometry.altered.alter("heightScale")}t.altered.geometry.outlineWidth&&(this._geometry.outlineWidth=t.geometry.outlineWidth,this._geometry.altered.alter("outlineWidth")),t.geometry.emphasis&&t.altered.geometry.emphasis.outlineWidth&&(this._geometry.emphasisOutlineWidth=t.geometry.emphasis.outlineWidth,this._geometry.altered.alter("emphasisOutlineWidth")),this._geometry.showRoot=!!((u=t.geometry.parentLayer)!=null&&u.showRoot);let o;if(t.geometry.leafLayer!==void 0){if(m.geometry.heights||m.buffers||m.bufferViews||o===void 0){const b=t.geometry.leafLayer;o=this._bufferResolver.resolve(b.height!==void 0?b.height:"",t,this._normalization,this._bufferResolver.constBufferCallback()),this._intermediaries.aggregatedHeights=o;const v=mt.createLayerHeightBuffer(l,o,void 0,this._configuration.geometry);this._geometry.leafNodeHeights=v,this._geometry.altered.alter("leafNodeHeights")}}else o=void 0,this._geometry.leafNodeHeights=mt.createEmptyLayerHeightBuffer(l);if((this._intermediaries.leafLabels===void 0||this._intermediaries.innerNodeLabels===void 0||t.altered.labels)&&t.labels!==void 0&&t.labels.names!==void 0){let b=new Map;if(typeof t.labels.names=="string"){const _=tt.create(l,this._normalization,t.labels.names,t);Object.keys(_).forEach(g=>{const x=parseInt(g,10);b.set(x,_[x])})}else b=t.labels.names;let v=new Set;if(typeof t.labels.additionallyLabelSet=="string"?v=tt.create(l,this._normalization,t.labels.additionallyLabelSet,t):v=t.labels.additionallyLabelSet,b!==void 0&&this._intermediaries.aggregatedHeights&&this._intermediaries.aggregatedWeights&&this._intermediaries.aggregatedColors){const _=Ke.createLabelSelection(l,this._intermediaries.aggregatedWeights,this._intermediaries.aggregatedHeights,this._intermediaries.aggregatedColors,v,t.labels.innerNodeLayerRange,t.labels.numTopInnerNodes,t.labels.numTopWeightNodes,t.labels.numTopHeightNodes,t.labels.numTopColorNodes);this._intermediaries.leafLabels=Ke.fillLeafLabelArray(l,b,_,this._geometry.heightScale,this._geometry.leafNodeLayouts,this._geometry.leafNodeHeights),this._intermediaries.innerNodeLabels=Ke.fillInnerNodeLabelArrayOnAccessory(l,b,_,this._intermediaries.accessorySpaces),this._labelsChanged=!0,this._renderer.invalidate()}}return t.altered.reset(),!0}prepare(){this.updateLabels()}get renderer(){return this._renderer}get configuration(){return this._configuration}set configuration(t){this._configuration=t}}function Zg(E,t,m=new N.Color().fromHex("fafafa")){const y=E instanceof HTMLCanvasElement?E:document.getElementById(E),l=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);navigator.appVersion.indexOf("Mac")!==-1&&l&&(y.dataset.msqrdP="no-WEBGL_draw_buffers",console.warn("detected Chrome on MacOS, disabling WEBGL_draw_buffers"));const r=new N.Canvas(y,{alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});return new N.viewer.EventBlocker(r.element).block("contextmenu"),r.clearColor=m,r.framePrecision=N.Wizard.Precision.byte,r.controller.multiFrameNumber=64,r.context.gl.clearColor(m.r,m.g,m.b,m.a),r.context.gl.clear(r.context.gl.COLOR_BUFFER_BIT),r}typeof LOG_VERBOSITY_THRESHOLD<"u"&&N.auxiliaries.logVerbosity(LOG_VERBOSITY_THRESHOLD);typeof DISABLE_ASSERTIONS<"u"&&N.auxiliaries.assertions(!DISABLE_ASSERTIONS);class Kg extends N.Initializable{expose(){}}export{$r as C,Kg as E,Ss as N,Je as T,Yg as V,Xg as g,Zg as i,N as w};
