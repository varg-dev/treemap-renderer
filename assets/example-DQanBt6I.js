function Av(T,n){for(var g=0;g<n.length;g++){const y=n[g];if(typeof y!="string"&&!Array.isArray(y)){for(const p in y)if(p!=="default"&&!(p in T)){const t=Object.getOwnPropertyDescriptor(y,p);t&&Object.defineProperty(T,p,t.get?t:{enumerable:!0,get:()=>y[p]})}}}return Object.freeze(Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}))}var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sv(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var Xf={exports:{}},$l={},Ur={},Hl={},Gr={},Oc;function Ee(){if(Oc)return Gr;Oc=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.isFunction=void 0;function T(n){return typeof n=="function"}return Gr.isFunction=T,Gr}var Rt={},qr={},Wr={},Rc;function sr(){if(Rc)return Wr;Rc=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.createErrorClass=void 0;function T(n){var g=function(p){Error.call(p),p.stack=new Error().stack},y=n(g);return y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y}return Wr.createErrorClass=T,Wr}var Pc;function Yf(){if(Pc)return qr;Pc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.UnsubscriptionError=void 0;var T=sr();return qr.UnsubscriptionError=T.createErrorClass(function(n){return function(y){n(this),this.message=y?y.length+` errors occurred during unsubscription:
`+y.map(function(p,t){return t+1+") "+p.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=y}}),qr}var Vr={},wc;function Ft(){if(wc)return Vr;wc=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.arrRemove=void 0;function T(n,g){if(n){var y=n.indexOf(g);0<=y&&n.splice(y,1)}}return Vr.arrRemove=T,Vr}var Lc;function at(){if(Lc)return Rt;Lc=1;var T=$&&$.__values||function(h){var _=typeof Symbol=="function"&&Symbol.iterator,d=_&&h[_],c=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&c>=h.length&&(h=void 0),{value:h&&h[c++],done:!h}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")},n=$&&$.__read||function(h,_){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var c=d.call(h),s,o=[],l;try{for(;(_===void 0||_-- >0)&&!(s=c.next()).done;)o.push(s.value)}catch(m){l={error:m}}finally{try{s&&!s.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}}return o},g=$&&$.__spreadArray||function(h,_){for(var d=0,c=_.length,s=h.length;d<c;d++,s++)h[s]=_[d];return h};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.isSubscription=Rt.EMPTY_SUBSCRIPTION=Rt.Subscription=void 0;var y=Ee(),p=Yf(),t=Ft(),i=function(){function h(_){this.initialTeardown=_,this.closed=!1,this._parentage=null,this._finalizers=null}return h.prototype.unsubscribe=function(){var _,d,c,s,o;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var m=T(l),v=m.next();!v.done;v=m.next()){var f=v.value;f.remove(this)}}catch(w){_={error:w}}finally{try{v&&!v.done&&(d=m.return)&&d.call(m)}finally{if(_)throw _.error}}else l.remove(this);var b=this.initialTeardown;if(y.isFunction(b))try{b()}catch(w){o=w instanceof p.UnsubscriptionError?w.errors:[w]}var x=this._finalizers;if(x){this._finalizers=null;try{for(var E=T(x),O=E.next();!O.done;O=E.next()){var S=O.value;try{r(S)}catch(w){o=o??[],w instanceof p.UnsubscriptionError?o=g(g([],n(o)),n(w.errors)):o.push(w)}}}catch(w){c={error:w}}finally{try{O&&!O.done&&(s=E.return)&&s.call(E)}finally{if(c)throw c.error}}}if(o)throw new p.UnsubscriptionError(o)}},h.prototype.add=function(_){var d;if(_&&_!==this)if(this.closed)r(_);else{if(_ instanceof h){if(_.closed||_._hasParent(this))return;_._addParent(this)}(this._finalizers=(d=this._finalizers)!==null&&d!==void 0?d:[]).push(_)}},h.prototype._hasParent=function(_){var d=this._parentage;return d===_||Array.isArray(d)&&d.includes(_)},h.prototype._addParent=function(_){var d=this._parentage;this._parentage=Array.isArray(d)?(d.push(_),d):d?[d,_]:_},h.prototype._removeParent=function(_){var d=this._parentage;d===_?this._parentage=null:Array.isArray(d)&&t.arrRemove(d,_)},h.prototype.remove=function(_){var d=this._finalizers;d&&t.arrRemove(d,_),_ instanceof h&&_._removeParent(this)},h.EMPTY=function(){var _=new h;return _.closed=!0,_}(),h}();Rt.Subscription=i,Rt.EMPTY_SUBSCRIPTION=i.EMPTY;function a(h){return h instanceof i||h&&"closed"in h&&y.isFunction(h.remove)&&y.isFunction(h.add)&&y.isFunction(h.unsubscribe)}Rt.isSubscription=a;function r(h){y.isFunction(h)?h():h.unsubscribe()}return Rt}var $r={},Mc;function ys(){return Mc||(Mc=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.config=void 0,$r.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}),$r}var Hr={},Xl={},Ic;function Zf(){return Ic||(Ic=1,function(T){var n=$&&$.__read||function(y,p){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),a,r=[],h;try{for(;(p===void 0||p-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(_){h={error:_}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return r},g=$&&$.__spreadArray||function(y,p){for(var t=0,i=p.length,a=y.length;t<i;t++,a++)y[a]=p[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.timeoutProvider=void 0,T.timeoutProvider={setTimeout:function(y,p){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var a=T.timeoutProvider.delegate;return a!=null&&a.setTimeout?a.setTimeout.apply(a,g([y,p],n(t))):setTimeout.apply(void 0,g([y,p],n(t)))},clearTimeout:function(y){var p=T.timeoutProvider.delegate;return((p==null?void 0:p.clearTimeout)||clearTimeout)(y)},delegate:void 0}}(Xl)),Xl}var Fc;function Kf(){if(Fc)return Hr;Fc=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.reportUnhandledError=void 0;var T=ys(),n=Zf();function g(y){n.timeoutProvider.setTimeout(function(){var p=T.config.onUnhandledError;if(p)p(y);else throw y})}return Hr.reportUnhandledError=g,Hr}var Xr={},Cc;function He(){if(Cc)return Xr;Cc=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.noop=void 0;function T(){}return Xr.noop=T,Xr}var ft={},Nc;function Ov(){if(Nc)return ft;Nc=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.createNotification=ft.nextNotification=ft.errorNotification=ft.COMPLETE_NOTIFICATION=void 0,ft.COMPLETE_NOTIFICATION=function(){return g("C",void 0,void 0)}();function T(y){return g("E",void 0,y)}ft.errorNotification=T;function n(y){return g("N",y,void 0)}ft.nextNotification=n;function g(y,p,t){return{kind:y,value:p,error:t}}return ft.createNotification=g,ft}var kt={},zc;function mu(){if(zc)return kt;zc=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.captureError=kt.errorContext=void 0;var T=ys(),n=null;function g(p){if(T.config.useDeprecatedSynchronousErrorHandling){var t=!n;if(t&&(n={errorThrown:!1,error:null}),p(),t){var i=n,a=i.errorThrown,r=i.error;if(n=null,a)throw r}}else p()}kt.errorContext=g;function y(p){T.config.useDeprecatedSynchronousErrorHandling&&n&&(n.errorThrown=!0,n.error=p)}return kt.captureError=y,kt}var Bc;function Es(){return Bc||(Bc=1,function(T){var n=$&&$.__extends||function(){var f=function(b,x){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,O){E.__proto__=O}||function(E,O){for(var S in O)Object.prototype.hasOwnProperty.call(O,S)&&(E[S]=O[S])},f(b,x)};return function(b,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");f(b,x);function E(){this.constructor=b}b.prototype=x===null?Object.create(x):(E.prototype=x.prototype,new E)}}();Object.defineProperty(T,"__esModule",{value:!0}),T.EMPTY_OBSERVER=T.SafeSubscriber=T.Subscriber=void 0;var g=Ee(),y=at(),p=ys(),t=Kf(),i=He(),a=Ov(),r=Zf(),h=mu(),_=function(f){n(b,f);function b(x){var E=f.call(this)||this;return E.isStopped=!1,x?(E.destination=x,y.isSubscription(x)&&x.add(E)):E.destination=T.EMPTY_OBSERVER,E}return b.create=function(x,E,O){return new o(x,E,O)},b.prototype.next=function(x){this.isStopped?v(a.nextNotification(x),this):this._next(x)},b.prototype.error=function(x){this.isStopped?v(a.errorNotification(x),this):(this.isStopped=!0,this._error(x))},b.prototype.complete=function(){this.isStopped?v(a.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},b.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,f.prototype.unsubscribe.call(this),this.destination=null)},b.prototype._next=function(x){this.destination.next(x)},b.prototype._error=function(x){try{this.destination.error(x)}finally{this.unsubscribe()}},b.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},b}(y.Subscription);T.Subscriber=_;var d=Function.prototype.bind;function c(f,b){return d.call(f,b)}var s=function(){function f(b){this.partialObserver=b}return f.prototype.next=function(b){var x=this.partialObserver;if(x.next)try{x.next(b)}catch(E){l(E)}},f.prototype.error=function(b){var x=this.partialObserver;if(x.error)try{x.error(b)}catch(E){l(E)}else l(b)},f.prototype.complete=function(){var b=this.partialObserver;if(b.complete)try{b.complete()}catch(x){l(x)}},f}(),o=function(f){n(b,f);function b(x,E,O){var S=f.call(this)||this,w;if(g.isFunction(x)||!x)w={next:x??void 0,error:E??void 0,complete:O??void 0};else{var P;S&&p.config.useDeprecatedNextContext?(P=Object.create(x),P.unsubscribe=function(){return S.unsubscribe()},w={next:x.next&&c(x.next,P),error:x.error&&c(x.error,P),complete:x.complete&&c(x.complete,P)}):w=x}return S.destination=new s(w),S}return b}(_);T.SafeSubscriber=o;function l(f){p.config.useDeprecatedSynchronousErrorHandling?h.captureError(f):t.reportUnhandledError(f)}function m(f){throw f}function v(f,b){var x=p.config.onStoppedNotification;x&&r.timeoutProvider.setTimeout(function(){return x(f,b)})}T.EMPTY_OBSERVER={closed:!0,next:i.noop,error:m,complete:i.noop}}(Hl)),Hl}var Yr={},Dc;function io(){return Dc||(Dc=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.observable=void 0,Yr.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()),Yr}var Ut={},Zr={},jc;function Xe(){if(jc)return Zr;jc=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.identity=void 0;function T(n){return n}return Zr.identity=T,Zr}var kc;function no(){if(kc)return Ut;kc=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.pipeFromArray=Ut.pipe=void 0;var T=Xe();function n(){for(var y=[],p=0;p<arguments.length;p++)y[p]=arguments[p];return g(y)}Ut.pipe=n;function g(y){return y.length===0?T.identity:y.length===1?y[0]:function(t){return y.reduce(function(i,a){return a(i)},t)}}return Ut.pipeFromArray=g,Ut}var Uc;function xe(){if(Uc)return Ur;Uc=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Observable=void 0;var T=Es(),n=at(),g=io(),y=no(),p=ys(),t=Ee(),i=mu(),a=function(){function d(c){c&&(this._subscribe=c)}return d.prototype.lift=function(c){var s=new d;return s.source=this,s.operator=c,s},d.prototype.subscribe=function(c,s,o){var l=this,m=_(c)?c:new T.SafeSubscriber(c,s,o);return i.errorContext(function(){var v=l,f=v.operator,b=v.source;m.add(f?f.call(m,b):b?l._subscribe(m):l._trySubscribe(m))}),m},d.prototype._trySubscribe=function(c){try{return this._subscribe(c)}catch(s){c.error(s)}},d.prototype.forEach=function(c,s){var o=this;return s=r(s),new s(function(l,m){var v=new T.SafeSubscriber({next:function(f){try{c(f)}catch(b){m(b),v.unsubscribe()}},error:m,complete:l});o.subscribe(v)})},d.prototype._subscribe=function(c){var s;return(s=this.source)===null||s===void 0?void 0:s.subscribe(c)},d.prototype[g.observable]=function(){return this},d.prototype.pipe=function(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];return y.pipeFromArray(c)(this)},d.prototype.toPromise=function(c){var s=this;return c=r(c),new c(function(o,l){var m;s.subscribe(function(v){return m=v},function(v){return l(v)},function(){return o(m)})})},d.create=function(c){return new d(c)},d}();Ur.Observable=a;function r(d){var c;return(c=d??p.config.Promise)!==null&&c!==void 0?c:Promise}function h(d){return d&&t.isFunction(d.next)&&t.isFunction(d.error)&&t.isFunction(d.complete)}function _(d){return d&&d instanceof T.Subscriber||h(d)&&n.isSubscription(d)}return Ur}var Kr={},Qr={},Gt={},Gc;function te(){if(Gc)return Gt;Gc=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.operate=Gt.hasLift=void 0;var T=Ee();function n(y){return T.isFunction(y==null?void 0:y.lift)}Gt.hasLift=n;function g(y){return function(p){if(n(p))return p.lift(function(t){try{return y(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}return Gt.operate=g,Gt}var qt={},qc;function ie(){if(qc)return qt;qc=1;var T=$&&$.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(qt,"__esModule",{value:!0}),qt.OperatorSubscriber=qt.createOperatorSubscriber=void 0;var n=Es();function g(p,t,i,a,r){return new y(p,t,i,a,r)}qt.createOperatorSubscriber=g;var y=function(p){T(t,p);function t(i,a,r,h,_,d){var c=p.call(this,i)||this;return c.onFinalize=_,c.shouldUnsubscribe=d,c._next=a?function(s){try{a(s)}catch(o){i.error(o)}}:p.prototype._next,c._error=h?function(s){try{h(s)}catch(o){i.error(o)}finally{this.unsubscribe()}}:p.prototype._error,c._complete=r?function(){try{r()}catch(s){i.error(s)}finally{this.unsubscribe()}}:p.prototype._complete,c}return t.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var a=this.closed;p.prototype.unsubscribe.call(this),!a&&((i=this.onFinalize)===null||i===void 0||i.call(this))}},t}(n.Subscriber);return qt.OperatorSubscriber=y,qt}var Wc;function Qf(){if(Wc)return Qr;Wc=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.refCount=void 0;var T=te(),n=ie();function g(){return T.operate(function(y,p){var t=null;y._refCount++;var i=n.createOperatorSubscriber(p,void 0,void 0,void 0,function(){if(!y||y._refCount<=0||0<--y._refCount){t=null;return}var a=y._connection,r=t;t=null,a&&(!r||a===r)&&a.unsubscribe(),p.unsubscribe()});y.subscribe(i),i.closed||(t=y.connect())})}return Qr.refCount=g,Qr}var Vc;function ao(){if(Vc)return Kr;Vc=1;var T=$&&$.__extends||function(){var a=function(r,h){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,d){_.__proto__=d}||function(_,d){for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(_[c]=d[c])},a(r,h)};return function(r,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");a(r,h);function _(){this.constructor=r}r.prototype=h===null?Object.create(h):(_.prototype=h.prototype,new _)}}();Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.ConnectableObservable=void 0;var n=xe(),g=at(),y=Qf(),p=ie(),t=te(),i=function(a){T(r,a);function r(h,_){var d=a.call(this)||this;return d.source=h,d.subjectFactory=_,d._subject=null,d._refCount=0,d._connection=null,t.hasLift(h)&&(d.lift=h.lift),d}return r.prototype._subscribe=function(h){return this.getSubject().subscribe(h)},r.prototype.getSubject=function(){var h=this._subject;return(!h||h.isStopped)&&(this._subject=this.subjectFactory()),this._subject},r.prototype._teardown=function(){this._refCount=0;var h=this._connection;this._subject=this._connection=null,h==null||h.unsubscribe()},r.prototype.connect=function(){var h=this,_=this._connection;if(!_){_=this._connection=new g.Subscription;var d=this.getSubject();_.add(this.source.subscribe(p.createOperatorSubscriber(d,void 0,function(){h._teardown(),d.complete()},function(c){h._teardown(),d.error(c)},function(){return h._teardown()}))),_.closed&&(this._connection=null,_=g.Subscription.EMPTY)}return _},r.prototype.refCount=function(){return y.refCount()(this)},r}(n.Observable);return Kr.ConnectableObservable=i,Kr}var Jr={},Yl={},$c;function Rv(){return $c||($c=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.performanceTimestampProvider=void 0,T.performanceTimestampProvider={now:function(){return(T.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}}(Yl)),Yl}var Zl={},Hc;function Jf(){return Hc||(Hc=1,function(T){var n=$&&$.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,h=[],_;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)h.push(r.value)}catch(d){_={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(_)throw _.error}}return h},g=$&&$.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrameProvider=void 0;var y=at();T.animationFrameProvider={schedule:function(p){var t=requestAnimationFrame,i=cancelAnimationFrame,a=T.animationFrameProvider.delegate;a&&(t=a.requestAnimationFrame,i=a.cancelAnimationFrame);var r=t(function(h){i=void 0,p(h)});return new y.Subscription(function(){return i==null?void 0:i(r)})},requestAnimationFrame:function(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.requestAnimationFrame)||requestAnimationFrame).apply(void 0,g([],n(p)))},cancelAnimationFrame:function(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,g([],n(p)))},delegate:void 0}}(Zl)),Zl}var Xc;function Pv(){if(Xc)return Jr;Xc=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.animationFrames=void 0;var T=xe(),n=Rv(),g=Jf();function y(i){return i?p(i):t}Jr.animationFrames=y;function p(i){return new T.Observable(function(a){var r=i||n.performanceTimestampProvider,h=r.now(),_=0,d=function(){a.closed||(_=g.animationFrameProvider.requestAnimationFrame(function(c){_=0;var s=r.now();a.next({timestamp:i?s:c,elapsed:s-h}),d()}))};return d(),function(){_&&g.animationFrameProvider.cancelAnimationFrame(_)}})}var t=p();return Jr}var Wt={},ei={},Yc;function e_(){if(Yc)return ei;Yc=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.ObjectUnsubscribedError=void 0;var T=sr();return ei.ObjectUnsubscribedError=T.createErrorClass(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ei}var Zc;function Ye(){if(Zc)return Wt;Zc=1;var T=$&&$.__extends||function(){var h=function(_,d){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,s){c.__proto__=s}||function(c,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(c[o]=s[o])},h(_,d)};return function(_,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");h(_,d);function c(){this.constructor=_}_.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}}(),n=$&&$.__values||function(h){var _=typeof Symbol=="function"&&Symbol.iterator,d=_&&h[_],c=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&c>=h.length&&(h=void 0),{value:h&&h[c++],done:!h}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.AnonymousSubject=Wt.Subject=void 0;var g=xe(),y=at(),p=e_(),t=Ft(),i=mu(),a=function(h){T(_,h);function _(){var d=h.call(this)||this;return d.closed=!1,d.currentObservers=null,d.observers=[],d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return _.prototype.lift=function(d){var c=new r(this,this);return c.operator=d,c},_.prototype._throwIfClosed=function(){if(this.closed)throw new p.ObjectUnsubscribedError},_.prototype.next=function(d){var c=this;i.errorContext(function(){var s,o;if(c._throwIfClosed(),!c.isStopped){c.currentObservers||(c.currentObservers=Array.from(c.observers));try{for(var l=n(c.currentObservers),m=l.next();!m.done;m=l.next()){var v=m.value;v.next(d)}}catch(f){s={error:f}}finally{try{m&&!m.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}}})},_.prototype.error=function(d){var c=this;i.errorContext(function(){if(c._throwIfClosed(),!c.isStopped){c.hasError=c.isStopped=!0,c.thrownError=d;for(var s=c.observers;s.length;)s.shift().error(d)}})},_.prototype.complete=function(){var d=this;i.errorContext(function(){if(d._throwIfClosed(),!d.isStopped){d.isStopped=!0;for(var c=d.observers;c.length;)c.shift().complete()}})},_.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(_.prototype,"observed",{get:function(){var d;return((d=this.observers)===null||d===void 0?void 0:d.length)>0},enumerable:!1,configurable:!0}),_.prototype._trySubscribe=function(d){return this._throwIfClosed(),h.prototype._trySubscribe.call(this,d)},_.prototype._subscribe=function(d){return this._throwIfClosed(),this._checkFinalizedStatuses(d),this._innerSubscribe(d)},_.prototype._innerSubscribe=function(d){var c=this,s=this,o=s.hasError,l=s.isStopped,m=s.observers;return o||l?y.EMPTY_SUBSCRIPTION:(this.currentObservers=null,m.push(d),new y.Subscription(function(){c.currentObservers=null,t.arrRemove(m,d)}))},_.prototype._checkFinalizedStatuses=function(d){var c=this,s=c.hasError,o=c.thrownError,l=c.isStopped;s?d.error(o):l&&d.complete()},_.prototype.asObservable=function(){var d=new g.Observable;return d.source=this,d},_.create=function(d,c){return new r(d,c)},_}(g.Observable);Wt.Subject=a;var r=function(h){T(_,h);function _(d,c){var s=h.call(this)||this;return s.destination=d,s.source=c,s}return _.prototype.next=function(d){var c,s;(s=(c=this.destination)===null||c===void 0?void 0:c.next)===null||s===void 0||s.call(c,d)},_.prototype.error=function(d){var c,s;(s=(c=this.destination)===null||c===void 0?void 0:c.error)===null||s===void 0||s.call(c,d)},_.prototype.complete=function(){var d,c;(c=(d=this.destination)===null||d===void 0?void 0:d.complete)===null||c===void 0||c.call(d)},_.prototype._subscribe=function(d){var c,s;return(s=(c=this.source)===null||c===void 0?void 0:c.subscribe(d))!==null&&s!==void 0?s:y.EMPTY_SUBSCRIPTION},_}(a);return Wt.AnonymousSubject=r,Wt}var ti={},Kc;function t_(){if(Kc)return ti;Kc=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ti,"__esModule",{value:!0}),ti.BehaviorSubject=void 0;var n=Ye(),g=function(y){T(p,y);function p(t){var i=y.call(this)||this;return i._value=t,i}return Object.defineProperty(p.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),p.prototype._subscribe=function(t){var i=y.prototype._subscribe.call(this,t);return!i.closed&&t.next(this._value),i},p.prototype.getValue=function(){var t=this,i=t.hasError,a=t.thrownError,r=t._value;if(i)throw a;return this._throwIfClosed(),r},p.prototype.next=function(t){y.prototype.next.call(this,this._value=t)},p}(n.Subject);return ti.BehaviorSubject=g,ti}var ri={},Kl={},Qc;function bu(){return Qc||(Qc=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.dateTimestampProvider=void 0,T.dateTimestampProvider={now:function(){return(T.dateTimestampProvider.delegate||Date).now()},delegate:void 0}}(Kl)),Kl}var Jc;function gu(){if(Jc)return ri;Jc=1;var T=$&&$.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(ri,"__esModule",{value:!0}),ri.ReplaySubject=void 0;var n=Ye(),g=bu(),y=function(p){T(t,p);function t(i,a,r){i===void 0&&(i=1/0),a===void 0&&(a=1/0),r===void 0&&(r=g.dateTimestampProvider);var h=p.call(this)||this;return h._bufferSize=i,h._windowTime=a,h._timestampProvider=r,h._buffer=[],h._infiniteTimeWindow=!0,h._infiniteTimeWindow=a===1/0,h._bufferSize=Math.max(1,i),h._windowTime=Math.max(1,a),h}return t.prototype.next=function(i){var a=this,r=a.isStopped,h=a._buffer,_=a._infiniteTimeWindow,d=a._timestampProvider,c=a._windowTime;r||(h.push(i),!_&&h.push(d.now()+c)),this._trimBuffer(),p.prototype.next.call(this,i)},t.prototype._subscribe=function(i){this._throwIfClosed(),this._trimBuffer();for(var a=this._innerSubscribe(i),r=this,h=r._infiniteTimeWindow,_=r._buffer,d=_.slice(),c=0;c<d.length&&!i.closed;c+=h?1:2)i.next(d[c]);return this._checkFinalizedStatuses(i),a},t.prototype._trimBuffer=function(){var i=this,a=i._bufferSize,r=i._timestampProvider,h=i._buffer,_=i._infiniteTimeWindow,d=(_?1:2)*a;if(a<1/0&&d<h.length&&h.splice(0,h.length-d),!_){for(var c=r.now(),s=0,o=1;o<h.length&&h[o]<=c;o+=2)s=o;s&&h.splice(0,s+1)}},t}(n.Subject);return ri.ReplaySubject=y,ri}var ii={},eh;function yu(){if(eh)return ii;eh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ii,"__esModule",{value:!0}),ii.AsyncSubject=void 0;var n=Ye(),g=function(y){T(p,y);function p(){var t=y!==null&&y.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return p.prototype._checkFinalizedStatuses=function(t){var i=this,a=i.hasError,r=i._hasValue,h=i._value,_=i.thrownError,d=i.isStopped,c=i._isComplete;a?t.error(_):(d||c)&&(r&&t.next(h),t.complete())},p.prototype.next=function(t){this.isStopped||(this._value=t,this._hasValue=!0)},p.prototype.complete=function(){var t=this,i=t._hasValue,a=t._value,r=t._isComplete;r||(this._isComplete=!0,i&&y.prototype.next.call(this,a),y.prototype.complete.call(this))},p}(n.Subject);return ii.AsyncSubject=g,ii}var Ql={},ni={},ai={},si={},th;function wv(){if(th)return si;th=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(si,"__esModule",{value:!0}),si.Action=void 0;var n=at(),g=function(y){T(p,y);function p(t,i){return y.call(this)||this}return p.prototype.schedule=function(t,i){return this},p}(n.Subscription);return si.Action=g,si}var Jl={},rh;function Lv(){return rh||(rh=1,function(T){var n=$&&$.__read||function(y,p){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),a,r=[],h;try{for(;(p===void 0||p-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(_){h={error:_}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return r},g=$&&$.__spreadArray||function(y,p){for(var t=0,i=p.length,a=y.length;t<i;t++,a++)y[a]=p[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.intervalProvider=void 0,T.intervalProvider={setInterval:function(y,p){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var a=T.intervalProvider.delegate;return a!=null&&a.setInterval?a.setInterval.apply(a,g([y,p],n(t))):setInterval.apply(void 0,g([y,p],n(t)))},clearInterval:function(y){var p=T.intervalProvider.delegate;return((p==null?void 0:p.clearInterval)||clearInterval)(y)},delegate:void 0}}(Jl)),Jl}var ih;function Ts(){if(ih)return ai;ih=1;var T=$&&$.__extends||function(){var t=function(i,a){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,h){r.__proto__=h}||function(r,h){for(var _ in h)Object.prototype.hasOwnProperty.call(h,_)&&(r[_]=h[_])},t(i,a)};return function(i,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");t(i,a);function r(){this.constructor=i}i.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(ai,"__esModule",{value:!0}),ai.AsyncAction=void 0;var n=wv(),g=Lv(),y=Ft(),p=function(t){T(i,t);function i(a,r){var h=t.call(this,a,r)||this;return h.scheduler=a,h.work=r,h.pending=!1,h}return i.prototype.schedule=function(a,r){var h;if(r===void 0&&(r=0),this.closed)return this;this.state=a;var _=this.id,d=this.scheduler;return _!=null&&(this.id=this.recycleAsyncId(d,_,r)),this.pending=!0,this.delay=r,this.id=(h=this.id)!==null&&h!==void 0?h:this.requestAsyncId(d,this.id,r),this},i.prototype.requestAsyncId=function(a,r,h){return h===void 0&&(h=0),g.intervalProvider.setInterval(a.flush.bind(a,this),h)},i.prototype.recycleAsyncId=function(a,r,h){if(h===void 0&&(h=0),h!=null&&this.delay===h&&this.pending===!1)return r;r!=null&&g.intervalProvider.clearInterval(r)},i.prototype.execute=function(a,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var h=this._execute(a,r);if(h)return h;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(a,r){var h=!1,_;try{this.work(a)}catch(d){h=!0,_=d||new Error("Scheduled action threw falsy error")}if(h)return this.unsubscribe(),_},i.prototype.unsubscribe=function(){if(!this.closed){var a=this,r=a.id,h=a.scheduler,_=h.actions;this.work=this.state=this.scheduler=null,this.pending=!1,y.arrRemove(_,this),r!=null&&(this.id=this.recycleAsyncId(h,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},i}(n.Action);return ai.AsyncAction=p,ai}var eu={},Vt={},nh;function Mv(){if(nh)return Vt;nh=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.TestTools=Vt.Immediate=void 0;var T=1,n,g={};function y(p){return p in g?(delete g[p],!0):!1}return Vt.Immediate={setImmediate:function(p){var t=T++;return g[t]=!0,n||(n=Promise.resolve()),n.then(function(){return y(t)&&p()}),t},clearImmediate:function(p){y(p)}},Vt.TestTools={pending:function(){return Object.keys(g).length}},Vt}var ah;function Iv(){return ah||(ah=1,function(T){var n=$&&$.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var h=r.call(i),_,d=[],c;try{for(;(a===void 0||a-- >0)&&!(_=h.next()).done;)d.push(_.value)}catch(s){c={error:s}}finally{try{_&&!_.done&&(r=h.return)&&r.call(h)}finally{if(c)throw c.error}}return d},g=$&&$.__spreadArray||function(i,a){for(var r=0,h=a.length,_=i.length;r<h;r++,_++)i[_]=a[r];return i};Object.defineProperty(T,"__esModule",{value:!0}),T.immediateProvider=void 0;var y=Mv(),p=y.Immediate.setImmediate,t=y.Immediate.clearImmediate;T.immediateProvider={setImmediate:function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=T.immediateProvider.delegate;return((r==null?void 0:r.setImmediate)||p).apply(void 0,g([],n(i)))},clearImmediate:function(i){var a=T.immediateProvider.delegate;return((a==null?void 0:a.clearImmediate)||t)(i)},delegate:void 0}}(eu)),eu}var sh;function Fv(){if(sh)return ni;sh=1;var T=$&&$.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(ni,"__esModule",{value:!0}),ni.AsapAction=void 0;var n=Ts(),g=Iv(),y=function(p){T(t,p);function t(i,a){var r=p.call(this,i,a)||this;return r.scheduler=i,r.work=a,r}return t.prototype.requestAsyncId=function(i,a,r){return r===void 0&&(r=0),r!==null&&r>0?p.prototype.requestAsyncId.call(this,i,a,r):(i.actions.push(this),i._scheduled||(i._scheduled=g.immediateProvider.setImmediate(i.flush.bind(i,void 0))))},t.prototype.recycleAsyncId=function(i,a,r){var h;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return p.prototype.recycleAsyncId.call(this,i,a,r);var _=i.actions;a!=null&&((h=_[_.length-1])===null||h===void 0?void 0:h.id)!==a&&(g.immediateProvider.clearImmediate(a),i._scheduled===a&&(i._scheduled=void 0))},t}(n.AsyncAction);return ni.AsapAction=y,ni}var oi={},li={},ui={},oh;function r_(){if(oh)return ui;oh=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Scheduler=void 0;var T=bu(),n=function(){function g(y,p){p===void 0&&(p=g.now),this.schedulerActionCtor=y,this.now=p}return g.prototype.schedule=function(y,p,t){return p===void 0&&(p=0),new this.schedulerActionCtor(this,y).schedule(t,p)},g.now=T.dateTimestampProvider.now,g}();return ui.Scheduler=n,ui}var lh;function xs(){if(lh)return li;lh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(li,"__esModule",{value:!0}),li.AsyncScheduler=void 0;var n=r_(),g=function(y){T(p,y);function p(t,i){i===void 0&&(i=n.Scheduler.now);var a=y.call(this,t,i)||this;return a.actions=[],a._active=!1,a}return p.prototype.flush=function(t){var i=this.actions;if(this._active){i.push(t);return}var a;this._active=!0;do if(a=t.execute(t.state,t.delay))break;while(t=i.shift());if(this._active=!1,a){for(;t=i.shift();)t.unsubscribe();throw a}},p}(n.Scheduler);return li.AsyncScheduler=g,li}var uh;function Cv(){if(uh)return oi;uh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(oi,"__esModule",{value:!0}),oi.AsapScheduler=void 0;var n=xs(),g=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var a=this.actions,r;t=t||a.shift();do if(r=t.execute(t.state,t.delay))break;while((t=a[0])&&t.id===i&&a.shift());if(this._active=!1,r){for(;(t=a[0])&&t.id===i&&a.shift();)t.unsubscribe();throw r}},p}(n.AsyncScheduler);return oi.AsapScheduler=g,oi}var ch;function Nv(){return ch||(ch=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.asap=T.asapScheduler=void 0;var n=Fv(),g=Cv();T.asapScheduler=new g.AsapScheduler(n.AsapAction),T.asap=T.asapScheduler}(Ql)),Ql}var tu={},hh;function tt(){return hh||(hh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.async=T.asyncScheduler=void 0;var n=Ts(),g=xs();T.asyncScheduler=new g.AsyncScheduler(n.AsyncAction),T.async=T.asyncScheduler}(tu)),tu}var ru={},ci={},dh;function zv(){if(dh)return ci;dh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ci,"__esModule",{value:!0}),ci.QueueAction=void 0;var n=Ts(),g=function(y){T(p,y);function p(t,i){var a=y.call(this,t,i)||this;return a.scheduler=t,a.work=i,a}return p.prototype.schedule=function(t,i){return i===void 0&&(i=0),i>0?y.prototype.schedule.call(this,t,i):(this.delay=i,this.state=t,this.scheduler.flush(this),this)},p.prototype.execute=function(t,i){return i>0||this.closed?y.prototype.execute.call(this,t,i):this._execute(t,i)},p.prototype.requestAsyncId=function(t,i,a){return a===void 0&&(a=0),a!=null&&a>0||a==null&&this.delay>0?y.prototype.requestAsyncId.call(this,t,i,a):(t.flush(this),0)},p}(n.AsyncAction);return ci.QueueAction=g,ci}var hi={},fh;function Bv(){if(fh)return hi;fh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(hi,"__esModule",{value:!0}),hi.QueueScheduler=void 0;var n=xs(),g=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p}(n.AsyncScheduler);return hi.QueueScheduler=g,hi}var _h;function Dv(){return _h||(_h=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.queue=T.queueScheduler=void 0;var n=zv(),g=Bv();T.queueScheduler=new g.QueueScheduler(n.QueueAction),T.queue=T.queueScheduler}(ru)),ru}var iu={},di={},ph;function jv(){if(ph)return di;ph=1;var T=$&&$.__extends||function(){var p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},p(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(di,"__esModule",{value:!0}),di.AnimationFrameAction=void 0;var n=Ts(),g=Jf(),y=function(p){T(t,p);function t(i,a){var r=p.call(this,i,a)||this;return r.scheduler=i,r.work=a,r}return t.prototype.requestAsyncId=function(i,a,r){return r===void 0&&(r=0),r!==null&&r>0?p.prototype.requestAsyncId.call(this,i,a,r):(i.actions.push(this),i._scheduled||(i._scheduled=g.animationFrameProvider.requestAnimationFrame(function(){return i.flush(void 0)})))},t.prototype.recycleAsyncId=function(i,a,r){var h;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return p.prototype.recycleAsyncId.call(this,i,a,r);var _=i.actions;a!=null&&((h=_[_.length-1])===null||h===void 0?void 0:h.id)!==a&&(g.animationFrameProvider.cancelAnimationFrame(a),i._scheduled=void 0)},t}(n.AsyncAction);return di.AnimationFrameAction=y,di}var fi={},vh;function kv(){if(vh)return fi;vh=1;var T=$&&$.__extends||function(){var y=function(p,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},y(p,t)};return function(p,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(p,t);function i(){this.constructor=p}p.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(fi,"__esModule",{value:!0}),fi.AnimationFrameScheduler=void 0;var n=xs(),g=function(y){T(p,y);function p(){return y!==null&&y.apply(this,arguments)||this}return p.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var a=this.actions,r;t=t||a.shift();do if(r=t.execute(t.state,t.delay))break;while((t=a[0])&&t.id===i&&a.shift());if(this._active=!1,r){for(;(t=a[0])&&t.id===i&&a.shift();)t.unsubscribe();throw r}},p}(n.AsyncScheduler);return fi.AnimationFrameScheduler=g,fi}var mh;function Uv(){return mh||(mh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrame=T.animationFrameScheduler=void 0;var n=jv(),g=kv();T.animationFrameScheduler=new g.AnimationFrameScheduler(n.AnimationFrameAction),T.animationFrame=T.animationFrameScheduler}(iu)),iu}var $t={},bh;function Gv(){if(bh)return $t;bh=1;var T=$&&$.__extends||function(){var i=function(a,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,_){h.__proto__=_}||function(h,_){for(var d in _)Object.prototype.hasOwnProperty.call(_,d)&&(h[d]=_[d])},i(a,r)};return function(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");i(a,r);function h(){this.constructor=a}a.prototype=r===null?Object.create(r):(h.prototype=r.prototype,new h)}}();Object.defineProperty($t,"__esModule",{value:!0}),$t.VirtualAction=$t.VirtualTimeScheduler=void 0;var n=Ts(),g=at(),y=xs(),p=function(i){T(a,i);function a(r,h){r===void 0&&(r=t),h===void 0&&(h=1/0);var _=i.call(this,r,function(){return _.frame})||this;return _.maxFrames=h,_.frame=0,_.index=-1,_}return a.prototype.flush=function(){for(var r=this,h=r.actions,_=r.maxFrames,d,c;(c=h[0])&&c.delay<=_&&(h.shift(),this.frame=c.delay,!(d=c.execute(c.state,c.delay))););if(d){for(;c=h.shift();)c.unsubscribe();throw d}},a.frameTimeFactor=10,a}(y.AsyncScheduler);$t.VirtualTimeScheduler=p;var t=function(i){T(a,i);function a(r,h,_){_===void 0&&(_=r.index+=1);var d=i.call(this,r,h)||this;return d.scheduler=r,d.work=h,d.index=_,d.active=!0,d.index=r.index=_,d}return a.prototype.schedule=function(r,h){if(h===void 0&&(h=0),Number.isFinite(h)){if(!this.id)return i.prototype.schedule.call(this,r,h);this.active=!1;var _=new a(this.scheduler,this.work);return this.add(_),_.schedule(r,h)}else return g.Subscription.EMPTY},a.prototype.requestAsyncId=function(r,h,_){_===void 0&&(_=0),this.delay=r.frame+_;var d=r.actions;return d.push(this),d.sort(a.sortActions),1},a.prototype.recycleAsyncId=function(r,h,_){},a.prototype._execute=function(r,h){if(this.active===!0)return i.prototype._execute.call(this,r,h)},a.sortActions=function(r,h){return r.delay===h.delay?r.index===h.index?0:r.index>h.index?1:-1:r.delay>h.delay?1:-1},a}(n.AsyncAction);return $t.VirtualAction=t,$t}var nu={},au={},gh;function yt(){return gh||(gh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.empty=T.EMPTY=void 0;var n=xe();T.EMPTY=new n.Observable(function(p){return p.complete()});function g(p){return p?y(p):T.EMPTY}T.empty=g;function y(p){return new n.Observable(function(t){return p.schedule(function(){return t.complete()})})}}(au)),au}var _i={},Pt={},pi={},yh;function so(){if(yh)return pi;yh=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isScheduler=void 0;var T=Ee();function n(g){return g&&T.isFunction(g.schedule)}return pi.isScheduler=n,pi}var Eh;function rt(){if(Eh)return Pt;Eh=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.popNumber=Pt.popScheduler=Pt.popResultSelector=void 0;var T=Ee(),n=so();function g(i){return i[i.length-1]}function y(i){return T.isFunction(g(i))?i.pop():void 0}Pt.popResultSelector=y;function p(i){return n.isScheduler(g(i))?i.pop():void 0}Pt.popScheduler=p;function t(i,a){return typeof g(i)=="number"?i.pop():a}return Pt.popNumber=t,Pt}var vi={},mi={},bi={},qe={},gi={},Th;function Eu(){return Th||(Th=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isArrayLike=void 0,gi.isArrayLike=function(T){return T&&typeof T.length=="number"&&typeof T!="function"}),gi}var yi={},xh;function i_(){if(xh)return yi;xh=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.isPromise=void 0;var T=Ee();function n(g){return T.isFunction(g==null?void 0:g.then)}return yi.isPromise=n,yi}var Ei={},Ah;function n_(){if(Ah)return Ei;Ah=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.isInteropObservable=void 0;var T=io(),n=Ee();function g(y){return n.isFunction(y[T.observable])}return Ei.isInteropObservable=g,Ei}var Ti={},Sh;function a_(){if(Sh)return Ti;Sh=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.isAsyncIterable=void 0;var T=Ee();function n(g){return Symbol.asyncIterator&&T.isFunction(g==null?void 0:g[Symbol.asyncIterator])}return Ti.isAsyncIterable=n,Ti}var xi={},Oh;function s_(){if(Oh)return xi;Oh=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.createInvalidObservableTypeError=void 0;function T(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}return xi.createInvalidObservableTypeError=T,xi}var Ai={},Ht={},Rh;function o_(){if(Rh)return Ht;Rh=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.iterator=Ht.getSymbolIterator=void 0;function T(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}return Ht.getSymbolIterator=T,Ht.iterator=T(),Ht}var Ph;function l_(){if(Ph)return Ai;Ph=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.isIterable=void 0;var T=o_(),n=Ee();function g(y){return n.isFunction(y==null?void 0:y[T.iterator])}return Ai.isIterable=g,Ai}var Xt={},wh;function Tu(){if(wh)return Xt;wh=1;var T=$&&$.__generator||function(i,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,_,d,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(l){return function(m){return o([l,m])}}function o(l){if(h)throw new TypeError("Generator is already executing.");for(;r;)try{if(h=1,_&&(d=l[0]&2?_.return:l[0]?_.throw||((d=_.return)&&d.call(_),0):_.next)&&!(d=d.call(_,l[1])).done)return d;switch(_=0,d&&(l=[l[0]&2,d.value]),l[0]){case 0:case 1:d=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,_=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!d||l[1]>d[0]&&l[1]<d[3])){r.label=l[1];break}if(l[0]===6&&r.label<d[1]){r.label=d[1],d=l;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(l);break}d[2]&&r.ops.pop(),r.trys.pop();continue}l=a.call(i,r)}catch(m){l=[6,m],_=0}finally{h=d=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},n=$&&$.__await||function(i){return this instanceof n?(this.v=i,this):new n(i)},g=$&&$.__asyncGenerator||function(i,a,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=r.apply(i,a||[]),_,d=[];return _={},c("next"),c("throw"),c("return"),_[Symbol.asyncIterator]=function(){return this},_;function c(f){h[f]&&(_[f]=function(b){return new Promise(function(x,E){d.push([f,b,x,E])>1||s(f,b)})})}function s(f,b){try{o(h[f](b))}catch(x){v(d[0][3],x)}}function o(f){f.value instanceof n?Promise.resolve(f.value.v).then(l,m):v(d[0][2],f)}function l(f){s("next",f)}function m(f){s("throw",f)}function v(f,b){f(b),d.shift(),d.length&&s(d[0][0],d[0][1])}};Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.isReadableStreamLike=Xt.readableStreamLikeToAsyncGenerator=void 0;var y=Ee();function p(i){return g(this,arguments,function(){var r,h,_,d;return T(this,function(c){switch(c.label){case 0:r=i.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,n(r.read())];case 3:return h=c.sent(),_=h.value,d=h.done,d?[4,n(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,n(_)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}Xt.readableStreamLikeToAsyncGenerator=p;function t(i){return y.isFunction(i==null?void 0:i.getReader)}return Xt.isReadableStreamLike=t,Xt}var Lh;function _e(){if(Lh)return qe;Lh=1;var T=$&&$.__awaiter||function(S,w,P,N){function k(j){return j instanceof P?j:new P(function(U){U(j)})}return new(P||(P=Promise))(function(j,U){function H(ee){try{K(N.next(ee))}catch(re){U(re)}}function Z(ee){try{K(N.throw(ee))}catch(re){U(re)}}function K(ee){ee.done?j(ee.value):k(ee.value).then(H,Z)}K((N=N.apply(S,w||[])).next())})},n=$&&$.__generator||function(S,w){var P={label:0,sent:function(){if(j[0]&1)throw j[1];return j[1]},trys:[],ops:[]},N,k,j,U;return U={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(U[Symbol.iterator]=function(){return this}),U;function H(K){return function(ee){return Z([K,ee])}}function Z(K){if(N)throw new TypeError("Generator is already executing.");for(;P;)try{if(N=1,k&&(j=K[0]&2?k.return:K[0]?k.throw||((j=k.return)&&j.call(k),0):k.next)&&!(j=j.call(k,K[1])).done)return j;switch(k=0,j&&(K=[K[0]&2,j.value]),K[0]){case 0:case 1:j=K;break;case 4:return P.label++,{value:K[1],done:!1};case 5:P.label++,k=K[1],K=[0];continue;case 7:K=P.ops.pop(),P.trys.pop();continue;default:if(j=P.trys,!(j=j.length>0&&j[j.length-1])&&(K[0]===6||K[0]===2)){P=0;continue}if(K[0]===3&&(!j||K[1]>j[0]&&K[1]<j[3])){P.label=K[1];break}if(K[0]===6&&P.label<j[1]){P.label=j[1],j=K;break}if(j&&P.label<j[2]){P.label=j[2],P.ops.push(K);break}j[2]&&P.ops.pop(),P.trys.pop();continue}K=w.call(S,P)}catch(ee){K=[6,ee],k=0}finally{N=j=0}if(K[0]&5)throw K[1];return{value:K[0]?K[1]:void 0,done:!0}}},g=$&&$.__asyncValues||function(S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=S[Symbol.asyncIterator],P;return w?w.call(S):(S=typeof y=="function"?y(S):S[Symbol.iterator](),P={},N("next"),N("throw"),N("return"),P[Symbol.asyncIterator]=function(){return this},P);function N(j){P[j]=S[j]&&function(U){return new Promise(function(H,Z){U=S[j](U),k(H,Z,U.done,U.value)})}}function k(j,U,H,Z){Promise.resolve(Z).then(function(K){j({value:K,done:H})},U)}},y=$&&$.__values||function(S){var w=typeof Symbol=="function"&&Symbol.iterator,P=w&&S[w],N=0;if(P)return P.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&N>=S.length&&(S=void 0),{value:S&&S[N++],done:!S}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(qe,"__esModule",{value:!0}),qe.fromReadableStreamLike=qe.fromAsyncIterable=qe.fromIterable=qe.fromPromise=qe.fromArrayLike=qe.fromInteropObservable=qe.innerFrom=void 0;var p=Eu(),t=i_(),i=xe(),a=n_(),r=a_(),h=s_(),_=l_(),d=Tu(),c=Ee(),s=Kf(),o=io();function l(S){if(S instanceof i.Observable)return S;if(S!=null){if(a.isInteropObservable(S))return m(S);if(p.isArrayLike(S))return v(S);if(t.isPromise(S))return f(S);if(r.isAsyncIterable(S))return x(S);if(_.isIterable(S))return b(S);if(d.isReadableStreamLike(S))return E(S)}throw h.createInvalidObservableTypeError(S)}qe.innerFrom=l;function m(S){return new i.Observable(function(w){var P=S[o.observable]();if(c.isFunction(P.subscribe))return P.subscribe(w);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}qe.fromInteropObservable=m;function v(S){return new i.Observable(function(w){for(var P=0;P<S.length&&!w.closed;P++)w.next(S[P]);w.complete()})}qe.fromArrayLike=v;function f(S){return new i.Observable(function(w){S.then(function(P){w.closed||(w.next(P),w.complete())},function(P){return w.error(P)}).then(null,s.reportUnhandledError)})}qe.fromPromise=f;function b(S){return new i.Observable(function(w){var P,N;try{for(var k=y(S),j=k.next();!j.done;j=k.next()){var U=j.value;if(w.next(U),w.closed)return}}catch(H){P={error:H}}finally{try{j&&!j.done&&(N=k.return)&&N.call(k)}finally{if(P)throw P.error}}w.complete()})}qe.fromIterable=b;function x(S){return new i.Observable(function(w){O(S,w).catch(function(P){return w.error(P)})})}qe.fromAsyncIterable=x;function E(S){return x(d.readableStreamLikeToAsyncGenerator(S))}qe.fromReadableStreamLike=E;function O(S,w){var P,N,k,j;return T(this,void 0,void 0,function(){var U,H;return n(this,function(Z){switch(Z.label){case 0:Z.trys.push([0,5,6,11]),P=g(S),Z.label=1;case 1:return[4,P.next()];case 2:if(N=Z.sent(),!!N.done)return[3,4];if(U=N.value,w.next(U),w.closed)return[2];Z.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return H=Z.sent(),k={error:H},[3,11];case 6:return Z.trys.push([6,,9,10]),N&&!N.done&&(j=P.return)?[4,j.call(P)]:[3,8];case 7:Z.sent(),Z.label=8;case 8:return[3,10];case 9:if(k)throw k.error;return[7];case 10:return[7];case 11:return w.complete(),[2]}})})}return qe}var Si={},Oi={},Mh;function Ct(){if(Mh)return Oi;Mh=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.executeSchedule=void 0;function T(n,g,y,p,t){p===void 0&&(p=0),t===void 0&&(t=!1);var i=g.schedule(function(){y(),t?n.add(this.schedule(null,p)):this.unsubscribe()},p);if(n.add(i),!t)return i}return Oi.executeSchedule=T,Oi}var Ih;function oo(){if(Ih)return Si;Ih=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.observeOn=void 0;var T=Ct(),n=te(),g=ie();function y(p,t){return t===void 0&&(t=0),n.operate(function(i,a){i.subscribe(g.createOperatorSubscriber(a,function(r){return T.executeSchedule(a,p,function(){return a.next(r)},t)},function(){return T.executeSchedule(a,p,function(){return a.complete()},t)},function(r){return T.executeSchedule(a,p,function(){return a.error(r)},t)}))})}return Si.observeOn=y,Si}var Ri={},Fh;function lo(){if(Fh)return Ri;Fh=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.subscribeOn=void 0;var T=te();function n(g,y){return y===void 0&&(y=0),T.operate(function(p,t){t.add(g.schedule(function(){return p.subscribe(t)},y))})}return Ri.subscribeOn=n,Ri}var Ch;function qv(){if(Ch)return bi;Ch=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.scheduleObservable=void 0;var T=_e(),n=oo(),g=lo();function y(p,t){return T.innerFrom(p).pipe(g.subscribeOn(t),n.observeOn(t))}return bi.scheduleObservable=y,bi}var Pi={},Nh;function Wv(){if(Nh)return Pi;Nh=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.schedulePromise=void 0;var T=_e(),n=oo(),g=lo();function y(p,t){return T.innerFrom(p).pipe(g.subscribeOn(t),n.observeOn(t))}return Pi.schedulePromise=y,Pi}var wi={},zh;function Vv(){if(zh)return wi;zh=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.scheduleArray=void 0;var T=xe();function n(g,y){return new T.Observable(function(p){var t=0;return y.schedule(function(){t===g.length?p.complete():(p.next(g[t++]),p.closed||this.schedule())})})}return wi.scheduleArray=n,wi}var Li={},Bh;function u_(){if(Bh)return Li;Bh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.scheduleIterable=void 0;var T=xe(),n=o_(),g=Ee(),y=Ct();function p(t,i){return new T.Observable(function(a){var r;return y.executeSchedule(a,i,function(){r=t[n.iterator](),y.executeSchedule(a,i,function(){var h,_,d;try{h=r.next(),_=h.value,d=h.done}catch(c){a.error(c);return}d?a.complete():a.next(_)},0,!0)}),function(){return g.isFunction(r==null?void 0:r.return)&&r.return()}})}return Li.scheduleIterable=p,Li}var Mi={},Dh;function c_(){if(Dh)return Mi;Dh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.scheduleAsyncIterable=void 0;var T=xe(),n=Ct();function g(y,p){if(!y)throw new Error("Iterable cannot be null");return new T.Observable(function(t){n.executeSchedule(t,p,function(){var i=y[Symbol.asyncIterator]();n.executeSchedule(t,p,function(){i.next().then(function(a){a.done?t.complete():t.next(a.value)})},0,!0)})})}return Mi.scheduleAsyncIterable=g,Mi}var Ii={},jh;function $v(){if(jh)return Ii;jh=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.scheduleReadableStreamLike=void 0;var T=c_(),n=Tu();function g(y,p){return T.scheduleAsyncIterable(n.readableStreamLikeToAsyncGenerator(y),p)}return Ii.scheduleReadableStreamLike=g,Ii}var kh;function h_(){if(kh)return mi;kh=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.scheduled=void 0;var T=qv(),n=Wv(),g=Vv(),y=u_(),p=c_(),t=n_(),i=i_(),a=Eu(),r=l_(),h=a_(),_=s_(),d=Tu(),c=$v();function s(o,l){if(o!=null){if(t.isInteropObservable(o))return T.scheduleObservable(o,l);if(a.isArrayLike(o))return g.scheduleArray(o,l);if(i.isPromise(o))return n.schedulePromise(o,l);if(h.isAsyncIterable(o))return p.scheduleAsyncIterable(o,l);if(r.isIterable(o))return y.scheduleIterable(o,l);if(d.isReadableStreamLike(o))return c.scheduleReadableStreamLike(o,l)}throw _.createInvalidObservableTypeError(o)}return mi.scheduled=s,mi}var Uh;function Nt(){if(Uh)return vi;Uh=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.from=void 0;var T=h_(),n=_e();function g(y,p){return p?T.scheduled(y,p):n.innerFrom(y)}return vi.from=g,vi}var Gh;function xu(){if(Gh)return _i;Gh=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.of=void 0;var T=rt(),n=Nt();function g(){for(var y=[],p=0;p<arguments.length;p++)y[p]=arguments[p];var t=T.popScheduler(y);return n.from(y,t)}return _i.of=g,_i}var Fi={},qh;function d_(){if(qh)return Fi;qh=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.throwError=void 0;var T=xe(),n=Ee();function g(y,p){var t=n.isFunction(y)?y:function(){return y},i=function(a){return a.error(t())};return new T.Observable(p?function(a){return p.schedule(i,0,a)}:i)}return Fi.throwError=g,Fi}var Wh;function Au(){return Wh||(Wh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.observeNotification=T.Notification=T.NotificationKind=void 0;var n=yt(),g=xu(),y=d_(),p=Ee();(function(a){a.NEXT="N",a.ERROR="E",a.COMPLETE="C"})(T.NotificationKind||(T.NotificationKind={}));var t=function(){function a(r,h,_){this.kind=r,this.value=h,this.error=_,this.hasValue=r==="N"}return a.prototype.observe=function(r){return i(this,r)},a.prototype.do=function(r,h,_){var d=this,c=d.kind,s=d.value,o=d.error;return c==="N"?r==null?void 0:r(s):c==="E"?h==null?void 0:h(o):_==null?void 0:_()},a.prototype.accept=function(r,h,_){var d;return p.isFunction((d=r)===null||d===void 0?void 0:d.next)?this.observe(r):this.do(r,h,_)},a.prototype.toObservable=function(){var r=this,h=r.kind,_=r.value,d=r.error,c=h==="N"?g.of(_):h==="E"?y.throwError(function(){return d}):h==="C"?n.EMPTY:0;if(!c)throw new TypeError("Unexpected notification kind "+h);return c},a.createNext=function(r){return new a("N",r)},a.createError=function(r){return new a("E",void 0,r)},a.createComplete=function(){return a.completeNotification},a.completeNotification=new a("C"),a}();T.Notification=t;function i(a,r){var h,_,d,c=a,s=c.kind,o=c.value,l=c.error;if(typeof s!="string")throw new TypeError('Invalid notification, missing "kind"');s==="N"?(h=r.next)===null||h===void 0||h.call(r,o):s==="E"?(_=r.error)===null||_===void 0||_.call(r,l):(d=r.complete)===null||d===void 0||d.call(r)}T.observeNotification=i}(nu)),nu}var Ci={},Vh;function Hv(){if(Vh)return Ci;Vh=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.isObservable=void 0;var T=xe(),n=Ee();function g(y){return!!y&&(y instanceof T.Observable||n.isFunction(y.lift)&&n.isFunction(y.subscribe))}return Ci.isObservable=g,Ci}var Ni={},zi={},$h;function or(){if($h)return zi;$h=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.EmptyError=void 0;var T=sr();return zi.EmptyError=T.createErrorClass(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}}),zi}var Hh;function Xv(){if(Hh)return Ni;Hh=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.lastValueFrom=void 0;var T=or();function n(g,y){var p=typeof y=="object";return new Promise(function(t,i){var a=!1,r;g.subscribe({next:function(h){r=h,a=!0},error:i,complete:function(){a?t(r):p?t(y.defaultValue):i(new T.EmptyError)}})})}return Ni.lastValueFrom=n,Ni}var Bi={},Xh;function Yv(){if(Xh)return Bi;Xh=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.firstValueFrom=void 0;var T=or(),n=Es();function g(y,p){var t=typeof p=="object";return new Promise(function(i,a){var r=new n.SafeSubscriber({next:function(h){i(h),r.unsubscribe()},error:a,complete:function(){t?i(p.defaultValue):a(new T.EmptyError)}});y.subscribe(r)})}return Bi.firstValueFrom=g,Bi}var Di={},Yh;function f_(){if(Yh)return Di;Yh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.ArgumentOutOfRangeError=void 0;var T=sr();return Di.ArgumentOutOfRangeError=T.createErrorClass(function(n){return function(){n(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}),Di}var ji={},Zh;function __(){if(Zh)return ji;Zh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.NotFoundError=void 0;var T=sr();return ji.NotFoundError=T.createErrorClass(function(n){return function(y){n(this),this.name="NotFoundError",this.message=y}}),ji}var ki={},Kh;function p_(){if(Kh)return ki;Kh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.SequenceError=void 0;var T=sr();return ki.SequenceError=T.createErrorClass(function(n){return function(y){n(this),this.name="SequenceError",this.message=y}}),ki}var su={},Ui={},Qh;function Su(){if(Qh)return Ui;Qh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.isValidDate=void 0;function T(n){return n instanceof Date&&!isNaN(n)}return Ui.isValidDate=T,Ui}var Jh;function _u(){return Jh||(Jh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.timeout=T.TimeoutError=void 0;var n=tt(),g=Su(),y=te(),p=_e(),t=sr(),i=ie(),a=Ct();T.TimeoutError=t.createErrorClass(function(_){return function(c){c===void 0&&(c=null),_(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=c}});function r(_,d){var c=g.isValidDate(_)?{first:_}:typeof _=="number"?{each:_}:_,s=c.first,o=c.each,l=c.with,m=l===void 0?h:l,v=c.scheduler,f=v===void 0?d??n.asyncScheduler:v,b=c.meta,x=b===void 0?null:b;if(s==null&&o==null)throw new TypeError("No timeout provided.");return y.operate(function(E,O){var S,w,P=null,N=0,k=function(j){w=a.executeSchedule(O,f,function(){try{S.unsubscribe(),p.innerFrom(m({meta:x,lastValue:P,seen:N})).subscribe(O)}catch(U){O.error(U)}},j)};S=E.subscribe(i.createOperatorSubscriber(O,function(j){w==null||w.unsubscribe(),N++,O.next(P=j),o>0&&k(o)},void 0,void 0,function(){w!=null&&w.closed||w==null||w.unsubscribe(),P=null})),!N&&k(s!=null?typeof s=="number"?s:+s-f.now():o)})}T.timeout=r;function h(_){throw new T.TimeoutError(_)}}(su)),su}var Gi={},qi={},Wi={},Vi={},ed;function lr(){if(ed)return Vi;ed=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.map=void 0;var T=te(),n=ie();function g(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){i.next(y.call(p,r,a++))}))})}return Vi.map=g,Vi}var td;function ur(){if(td)return Wi;td=1;var T=$&&$.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var h=r.call(i),_,d=[],c;try{for(;(a===void 0||a-- >0)&&!(_=h.next()).done;)d.push(_.value)}catch(s){c={error:s}}finally{try{_&&!_.done&&(r=h.return)&&r.call(h)}finally{if(c)throw c.error}}return d},n=$&&$.__spreadArray||function(i,a){for(var r=0,h=a.length,_=i.length;r<h;r++,_++)i[_]=a[r];return i};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.mapOneOrManyArgs=void 0;var g=lr(),y=Array.isArray;function p(i,a){return y(a)?i.apply(void 0,n([],T(a))):i(a)}function t(i){return g.map(function(a){return p(i,a)})}return Wi.mapOneOrManyArgs=t,Wi}var rd;function v_(){if(rd)return qi;rd=1;var T=$&&$.__read||function(h,_){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var c=d.call(h),s,o=[],l;try{for(;(_===void 0||_-- >0)&&!(s=c.next()).done;)o.push(s.value)}catch(m){l={error:m}}finally{try{s&&!s.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}}return o},n=$&&$.__spreadArray||function(h,_){for(var d=0,c=_.length,s=h.length;d<c;d++,s++)h[s]=_[d];return h};Object.defineProperty(qi,"__esModule",{value:!0}),qi.bindCallbackInternals=void 0;var g=so(),y=xe(),p=lo(),t=ur(),i=oo(),a=yu();function r(h,_,d,c){if(d)if(g.isScheduler(d))c=d;else return function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return r(h,_,c).apply(this,s).pipe(t.mapOneOrManyArgs(d))};return c?function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return r(h,_).apply(this,s).pipe(p.subscribeOn(c),i.observeOn(c))}:function(){for(var s=this,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var m=new a.AsyncSubject,v=!0;return new y.Observable(function(f){var b=m.subscribe(f);if(v){v=!1;var x=!1,E=!1;_.apply(s,n(n([],T(o)),[function(){for(var O=[],S=0;S<arguments.length;S++)O[S]=arguments[S];if(h){var w=O.shift();if(w!=null){m.error(w);return}}m.next(1<O.length?O:O[0]),E=!0,x&&m.complete()}])),E&&m.complete(),x=!0}return b})}}return qi.bindCallbackInternals=r,qi}var id;function Zv(){if(id)return Gi;id=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.bindCallback=void 0;var T=v_();function n(g,y,p){return T.bindCallbackInternals(!1,g,y,p)}return Gi.bindCallback=n,Gi}var $i={},nd;function Kv(){if(nd)return $i;nd=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.bindNodeCallback=void 0;var T=v_();function n(g,y,p){return T.bindCallbackInternals(!0,g,y,p)}return $i.bindNodeCallback=n,$i}var Yt={},Hi={},ad;function m_(){if(ad)return Hi;ad=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.argsArgArrayOrObject=void 0;var T=Array.isArray,n=Object.getPrototypeOf,g=Object.prototype,y=Object.keys;function p(i){if(i.length===1){var a=i[0];if(T(a))return{args:a,keys:null};if(t(a)){var r=y(a);return{args:r.map(function(h){return a[h]}),keys:r}}}return{args:i,keys:null}}Hi.argsArgArrayOrObject=p;function t(i){return i&&typeof i=="object"&&n(i)===g}return Hi}var Xi={},sd;function b_(){if(sd)return Xi;sd=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.createObject=void 0;function T(n,g){return n.reduce(function(y,p,t){return y[p]=g[t],y},{})}return Xi.createObject=T,Xi}var od;function Ou(){if(od)return Yt;od=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.combineLatestInit=Yt.combineLatest=void 0;var T=xe(),n=m_(),g=Nt(),y=Xe(),p=ur(),t=rt(),i=b_(),a=ie(),r=Ct();function h(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];var o=t.popScheduler(c),l=t.popResultSelector(c),m=n.argsArgArrayOrObject(c),v=m.args,f=m.keys;if(v.length===0)return g.from([],o);var b=new T.Observable(_(v,o,f?function(x){return i.createObject(f,x)}:y.identity));return l?b.pipe(p.mapOneOrManyArgs(l)):b}Yt.combineLatest=h;function _(c,s,o){return o===void 0&&(o=y.identity),function(l){d(s,function(){for(var m=c.length,v=new Array(m),f=m,b=m,x=function(O){d(s,function(){var S=g.from(c[O],s),w=!1;S.subscribe(a.createOperatorSubscriber(l,function(P){v[O]=P,w||(w=!0,b--),b||l.next(o(v.slice()))},function(){--f||l.complete()}))},l)},E=0;E<m;E++)x(E)},l)}}Yt.combineLatestInit=_;function d(c,s,o){c?r.executeSchedule(o,c,s):s()}return Yt}var Yi={},Zi={},Ki={},Qi={},Ji={},ld;function Ru(){if(ld)return Ji;ld=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.mergeInternals=void 0;var T=_e(),n=Ct(),g=ie();function y(p,t,i,a,r,h,_,d){var c=[],s=0,o=0,l=!1,m=function(){l&&!c.length&&!s&&t.complete()},v=function(b){return s<a?f(b):c.push(b)},f=function(b){h&&t.next(b),s++;var x=!1;T.innerFrom(i(b,o++)).subscribe(g.createOperatorSubscriber(t,function(E){r==null||r(E),h?v(E):t.next(E)},function(){x=!0},void 0,function(){if(x)try{s--;for(var E=function(){var O=c.shift();_?n.executeSchedule(t,_,function(){return f(O)}):f(O)};c.length&&s<a;)E();m()}catch(O){t.error(O)}}))};return p.subscribe(g.createOperatorSubscriber(t,v,function(){l=!0,m()})),function(){d==null||d()}}return Ji.mergeInternals=y,Ji}var ud;function zt(){if(ud)return Qi;ud=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.mergeMap=void 0;var T=lr(),n=_e(),g=te(),y=Ru(),p=Ee();function t(i,a,r){return r===void 0&&(r=1/0),p.isFunction(a)?t(function(h,_){return T.map(function(d,c){return a(h,d,_,c)})(n.innerFrom(i(h,_)))},r):(typeof a=="number"&&(r=a),g.operate(function(h,_){return y.mergeInternals(h,_,i,r)}))}return Qi.mergeMap=t,Qi}var cd;function uo(){if(cd)return Ki;cd=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.mergeAll=void 0;var T=zt(),n=Xe();function g(y){return y===void 0&&(y=1/0),T.mergeMap(n.identity,y)}return Ki.mergeAll=g,Ki}var hd;function Pu(){if(hd)return Zi;hd=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.concatAll=void 0;var T=uo();function n(){return T.mergeAll(1)}return Zi.concatAll=n,Zi}var dd;function co(){if(dd)return Yi;dd=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.concat=void 0;var T=Pu(),n=rt(),g=Nt();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return T.concatAll()(g.from(p,n.popScheduler(p)))}return Yi.concat=y,Yi}var en={},tn={},fd;function ho(){if(fd)return tn;fd=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.defer=void 0;var T=xe(),n=_e();function g(y){return new T.Observable(function(p){n.innerFrom(y()).subscribe(p)})}return tn.defer=g,tn}var _d;function Qv(){if(_d)return en;_d=1,Object.defineProperty(en,"__esModule",{value:!0}),en.connectable=void 0;var T=Ye(),n=xe(),g=ho(),y={connector:function(){return new T.Subject},resetOnDisconnect:!0};function p(t,i){i===void 0&&(i=y);var a=null,r=i.connector,h=i.resetOnDisconnect,_=h===void 0?!0:h,d=r(),c=new n.Observable(function(s){return d.subscribe(s)});return c.connect=function(){return(!a||a.closed)&&(a=g.defer(function(){return t}).subscribe(d),_&&a.add(function(){return d=r()})),a},c}return en.connectable=p,en}var rn={},pd;function Jv(){if(pd)return rn;pd=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.forkJoin=void 0;var T=xe(),n=m_(),g=_e(),y=rt(),p=ie(),t=ur(),i=b_();function a(){for(var r=[],h=0;h<arguments.length;h++)r[h]=arguments[h];var _=y.popResultSelector(r),d=n.argsArgArrayOrObject(r),c=d.args,s=d.keys,o=new T.Observable(function(l){var m=c.length;if(!m){l.complete();return}for(var v=new Array(m),f=m,b=m,x=function(O){var S=!1;g.innerFrom(c[O]).subscribe(p.createOperatorSubscriber(l,function(w){S||(S=!0,b--),v[O]=w},function(){return f--},void 0,function(){(!f||!S)&&(b||l.next(s?i.createObject(s,v):v),l.complete())}))},E=0;E<m;E++)x(E)});return _?o.pipe(t.mapOneOrManyArgs(_)):o}return rn.forkJoin=a,rn}var nn={},vd;function em(){if(vd)return nn;vd=1;var T=$&&$.__read||function(l,m){var v=typeof Symbol=="function"&&l[Symbol.iterator];if(!v)return l;var f=v.call(l),b,x=[],E;try{for(;(m===void 0||m-- >0)&&!(b=f.next()).done;)x.push(b.value)}catch(O){E={error:O}}finally{try{b&&!b.done&&(v=f.return)&&v.call(f)}finally{if(E)throw E.error}}return x};Object.defineProperty(nn,"__esModule",{value:!0}),nn.fromEvent=void 0;var n=_e(),g=xe(),y=zt(),p=Eu(),t=Ee(),i=ur(),a=["addListener","removeListener"],r=["addEventListener","removeEventListener"],h=["on","off"];function _(l,m,v,f){if(t.isFunction(v)&&(f=v,v=void 0),f)return _(l,m,v).pipe(i.mapOneOrManyArgs(f));var b=T(o(l)?r.map(function(O){return function(S){return l[O](m,S,v)}}):c(l)?a.map(d(l,m)):s(l)?h.map(d(l,m)):[],2),x=b[0],E=b[1];if(!x&&p.isArrayLike(l))return y.mergeMap(function(O){return _(O,m,v)})(n.innerFrom(l));if(!x)throw new TypeError("Invalid event target");return new g.Observable(function(O){var S=function(){for(var w=[],P=0;P<arguments.length;P++)w[P]=arguments[P];return O.next(1<w.length?w:w[0])};return x(S),function(){return E(S)}})}nn.fromEvent=_;function d(l,m){return function(v){return function(f){return l[v](m,f)}}}function c(l){return t.isFunction(l.addListener)&&t.isFunction(l.removeListener)}function s(l){return t.isFunction(l.on)&&t.isFunction(l.off)}function o(l){return t.isFunction(l.addEventListener)&&t.isFunction(l.removeEventListener)}return nn}var an={},md;function tm(){if(md)return an;md=1,Object.defineProperty(an,"__esModule",{value:!0}),an.fromEventPattern=void 0;var T=xe(),n=Ee(),g=ur();function y(p,t,i){return i?y(p,t).pipe(g.mapOneOrManyArgs(i)):new T.Observable(function(a){var r=function(){for(var _=[],d=0;d<arguments.length;d++)_[d]=arguments[d];return a.next(_.length===1?_[0]:_)},h=p(r);return n.isFunction(t)?function(){return t(r,h)}:void 0})}return an.fromEventPattern=y,an}var sn={},bd;function rm(){if(bd)return sn;bd=1;var T=$&&$.__generator||function(i,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,_,d,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(l){return function(m){return o([l,m])}}function o(l){if(h)throw new TypeError("Generator is already executing.");for(;r;)try{if(h=1,_&&(d=l[0]&2?_.return:l[0]?_.throw||((d=_.return)&&d.call(_),0):_.next)&&!(d=d.call(_,l[1])).done)return d;switch(_=0,d&&(l=[l[0]&2,d.value]),l[0]){case 0:case 1:d=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,_=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!d||l[1]>d[0]&&l[1]<d[3])){r.label=l[1];break}if(l[0]===6&&r.label<d[1]){r.label=d[1],d=l;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(l);break}d[2]&&r.ops.pop(),r.trys.pop();continue}l=a.call(i,r)}catch(m){l=[6,m],_=0}finally{h=d=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(sn,"__esModule",{value:!0}),sn.generate=void 0;var n=Xe(),g=so(),y=ho(),p=u_();function t(i,a,r,h,_){var d,c,s,o;arguments.length===1?(d=i,o=d.initialState,a=d.condition,r=d.iterate,c=d.resultSelector,s=c===void 0?n.identity:c,_=d.scheduler):(o=i,!h||g.isScheduler(h)?(s=n.identity,_=h):s=h);function l(){var m;return T(this,function(v){switch(v.label){case 0:m=o,v.label=1;case 1:return!a||a(m)?[4,s(m)]:[3,4];case 2:v.sent(),v.label=3;case 3:return m=r(m),[3,1];case 4:return[2]}})}return y.defer(_?function(){return p.scheduleIterable(l(),_)}:l)}return sn.generate=t,sn}var on={},gd;function im(){if(gd)return on;gd=1,Object.defineProperty(on,"__esModule",{value:!0}),on.iif=void 0;var T=ho();function n(g,y,p){return T.defer(function(){return g()?y:p})}return on.iif=n,on}var ln={},un={},yd;function cr(){if(yd)return un;yd=1,Object.defineProperty(un,"__esModule",{value:!0}),un.timer=void 0;var T=xe(),n=tt(),g=so(),y=Su();function p(t,i,a){t===void 0&&(t=0),a===void 0&&(a=n.async);var r=-1;return i!=null&&(g.isScheduler(i)?a=i:r=i),new T.Observable(function(h){var _=y.isValidDate(t)?+t-a.now():t;_<0&&(_=0);var d=0;return a.schedule(function(){h.closed||(h.next(d++),0<=r?this.schedule(void 0,r):h.complete())},_)})}return un.timer=p,un}var Ed;function g_(){if(Ed)return ln;Ed=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.interval=void 0;var T=tt(),n=cr();function g(y,p){return y===void 0&&(y=0),p===void 0&&(p=T.asyncScheduler),y<0&&(y=0),n.timer(y,y,p)}return ln.interval=g,ln}var cn={},Td;function nm(){if(Td)return cn;Td=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.merge=void 0;var T=uo(),n=_e(),g=yt(),y=rt(),p=Nt();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=y.popScheduler(i),h=y.popNumber(i,1/0),_=i;return _.length?_.length===1?n.innerFrom(_[0]):T.mergeAll(h)(p.from(_,r)):g.EMPTY}return cn.merge=t,cn}var ou={},xd;function Ad(){return xd||(xd=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.never=T.NEVER=void 0;var n=xe(),g=He();T.NEVER=new n.Observable(g.noop);function y(){return T.NEVER}T.never=y}(ou)),ou}var hn={},dn={},Sd;function gr(){if(Sd)return dn;Sd=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.argsOrArgArray=void 0;var T=Array.isArray;function n(g){return g.length===1&&T(g[0])?g[0]:g}return dn.argsOrArgArray=n,dn}var Od;function y_(){if(Od)return hn;Od=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.onErrorResumeNext=void 0;var T=xe(),n=gr(),g=ie(),y=He(),p=_e();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r=n.argsOrArgArray(i);return new T.Observable(function(h){var _=0,d=function(){if(_<r.length){var c=void 0;try{c=p.innerFrom(r[_++])}catch{d();return}var s=new g.OperatorSubscriber(h,void 0,y.noop,y.noop);c.subscribe(s),s.add(d)}else h.complete()};d()})}return hn.onErrorResumeNext=t,hn}var fn={},Rd;function am(){if(Rd)return fn;Rd=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.pairs=void 0;var T=Nt();function n(g,y){return T.from(Object.entries(g),y)}return fn.pairs=n,fn}var _n={},pn={},Pd;function sm(){if(Pd)return pn;Pd=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.not=void 0;function T(n,g){return function(y,p){return!n.call(g,y,p)}}return pn.not=T,pn}var vn={},wd;function yr(){if(wd)return vn;wd=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.filter=void 0;var T=te(),n=ie();function g(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){return y.call(p,r,a++)&&i.next(r)}))})}return vn.filter=g,vn}var Ld;function om(){if(Ld)return _n;Ld=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.partition=void 0;var T=sm(),n=yr(),g=_e();function y(p,t,i){return[n.filter(t,i)(g.innerFrom(p)),n.filter(T.not(t,i))(g.innerFrom(p))]}return _n.partition=y,_n}var Zt={},Md;function E_(){if(Md)return Zt;Md=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.raceInit=Zt.race=void 0;var T=xe(),n=_e(),g=gr(),y=ie();function p(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return i=g.argsOrArgArray(i),i.length===1?n.innerFrom(i[0]):new T.Observable(t(i))}Zt.race=p;function t(i){return function(a){for(var r=[],h=function(d){r.push(n.innerFrom(i[d]).subscribe(y.createOperatorSubscriber(a,function(c){if(r){for(var s=0;s<r.length;s++)s!==d&&r[s].unsubscribe();r=null}a.next(c)})))},_=0;r&&!a.closed&&_<i.length;_++)h(_)}}return Zt.raceInit=t,Zt}var mn={},Id;function lm(){if(Id)return mn;Id=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.range=void 0;var T=xe(),n=yt();function g(y,p,t){if(p==null&&(p=y,y=0),p<=0)return n.EMPTY;var i=p+y;return new T.Observable(t?function(a){var r=y;return t.schedule(function(){r<i?(a.next(r++),this.schedule()):a.complete()})}:function(a){for(var r=y;r<i&&!a.closed;)a.next(r++);a.complete()})}return mn.range=g,mn}var bn={},Fd;function um(){if(Fd)return bn;Fd=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.using=void 0;var T=xe(),n=_e(),g=yt();function y(p,t){return new T.Observable(function(i){var a=p(),r=t(a),h=r?n.innerFrom(r):g.EMPTY;return h.subscribe(i),function(){a&&a.unsubscribe()}})}return bn.using=y,bn}var gn={},Cd;function wu(){if(Cd)return gn;Cd=1;var T=$&&$.__read||function(h,_){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var c=d.call(h),s,o=[],l;try{for(;(_===void 0||_-- >0)&&!(s=c.next()).done;)o.push(s.value)}catch(m){l={error:m}}finally{try{s&&!s.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}}return o},n=$&&$.__spreadArray||function(h,_){for(var d=0,c=_.length,s=h.length;d<c;d++,s++)h[s]=_[d];return h};Object.defineProperty(gn,"__esModule",{value:!0}),gn.zip=void 0;var g=xe(),y=_e(),p=gr(),t=yt(),i=ie(),a=rt();function r(){for(var h=[],_=0;_<arguments.length;_++)h[_]=arguments[_];var d=a.popResultSelector(h),c=p.argsOrArgArray(h);return c.length?new g.Observable(function(s){var o=c.map(function(){return[]}),l=c.map(function(){return!1});s.add(function(){o=l=null});for(var m=function(f){y.innerFrom(c[f]).subscribe(i.createOperatorSubscriber(s,function(b){if(o[f].push(b),o.every(function(E){return E.length})){var x=o.map(function(E){return E.shift()});s.next(d?d.apply(void 0,n([],T(x))):x),o.some(function(E,O){return!E.length&&l[O]})&&s.complete()}},function(){l[f]=!0,!o[f].length&&s.complete()}))},v=0;!s.closed&&v<c.length;v++)m(v);return function(){o=l=null}}):t.EMPTY}return gn.zip=r,gn}var lu={},Nd;function cm(){return Nd||(Nd=1,Object.defineProperty(lu,"__esModule",{value:!0})),lu}var yn={},zd;function T_(){if(zd)return yn;zd=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.audit=void 0;var T=te(),n=_e(),g=ie();function y(p){return T.operate(function(t,i){var a=!1,r=null,h=null,_=!1,d=function(){if(h==null||h.unsubscribe(),h=null,a){a=!1;var s=r;r=null,i.next(s)}_&&i.complete()},c=function(){h=null,_&&i.complete()};t.subscribe(g.createOperatorSubscriber(i,function(s){a=!0,r=s,h||n.innerFrom(p(s)).subscribe(h=g.createOperatorSubscriber(i,d,c))},function(){_=!0,(!a||!h||h.closed)&&i.complete()}))})}return yn.audit=y,yn}var En={},Bd;function hm(){if(Bd)return En;Bd=1,Object.defineProperty(En,"__esModule",{value:!0}),En.auditTime=void 0;var T=tt(),n=T_(),g=cr();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.audit(function(){return g.timer(p,t)})}return En.auditTime=y,En}var Tn={},Dd;function dm(){if(Dd)return Tn;Dd=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.buffer=void 0;var T=te(),n=He(),g=ie(),y=_e();function p(t){return T.operate(function(i,a){var r=[];return i.subscribe(g.createOperatorSubscriber(a,function(h){return r.push(h)},function(){a.next(r),a.complete()})),y.innerFrom(t).subscribe(g.createOperatorSubscriber(a,function(){var h=r;r=[],a.next(h)},n.noop)),function(){r=null}})}return Tn.buffer=p,Tn}var xn={},jd;function fm(){if(jd)return xn;jd=1;var T=$&&$.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(xn,"__esModule",{value:!0}),xn.bufferCount=void 0;var n=te(),g=ie(),y=Ft();function p(t,i){return i===void 0&&(i=null),i=i??t,n.operate(function(a,r){var h=[],_=0;a.subscribe(g.createOperatorSubscriber(r,function(d){var c,s,o,l,m=null;_++%i===0&&h.push([]);try{for(var v=T(h),f=v.next();!f.done;f=v.next()){var b=f.value;b.push(d),t<=b.length&&(m=m??[],m.push(b))}}catch(O){c={error:O}}finally{try{f&&!f.done&&(s=v.return)&&s.call(v)}finally{if(c)throw c.error}}if(m)try{for(var x=T(m),E=x.next();!E.done;E=x.next()){var b=E.value;y.arrRemove(h,b),r.next(b)}}catch(O){o={error:O}}finally{try{E&&!E.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}},function(){var d,c;try{for(var s=T(h),o=s.next();!o.done;o=s.next()){var l=o.value;r.next(l)}}catch(m){d={error:m}}finally{try{o&&!o.done&&(c=s.return)&&c.call(s)}finally{if(d)throw d.error}}r.complete()},void 0,function(){h=null}))})}return xn.bufferCount=p,xn}var An={},kd;function _m(){if(kd)return An;kd=1;var T=$&&$.__values||function(h){var _=typeof Symbol=="function"&&Symbol.iterator,d=_&&h[_],c=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&c>=h.length&&(h=void 0),{value:h&&h[c++],done:!h}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(An,"__esModule",{value:!0}),An.bufferTime=void 0;var n=at(),g=te(),y=ie(),p=Ft(),t=tt(),i=rt(),a=Ct();function r(h){for(var _,d,c=[],s=1;s<arguments.length;s++)c[s-1]=arguments[s];var o=(_=i.popScheduler(c))!==null&&_!==void 0?_:t.asyncScheduler,l=(d=c[0])!==null&&d!==void 0?d:null,m=c[1]||1/0;return g.operate(function(v,f){var b=[],x=!1,E=function(w){var P=w.buffer,N=w.subs;N.unsubscribe(),p.arrRemove(b,w),f.next(P),x&&O()},O=function(){if(b){var w=new n.Subscription;f.add(w);var P=[],N={buffer:P,subs:w};b.push(N),a.executeSchedule(w,o,function(){return E(N)},h)}};l!==null&&l>=0?a.executeSchedule(f,o,O,l,!0):x=!0,O();var S=y.createOperatorSubscriber(f,function(w){var P,N,k=b.slice();try{for(var j=T(k),U=j.next();!U.done;U=j.next()){var H=U.value,Z=H.buffer;Z.push(w),m<=Z.length&&E(H)}}catch(K){P={error:K}}finally{try{U&&!U.done&&(N=j.return)&&N.call(j)}finally{if(P)throw P.error}}},function(){for(;b!=null&&b.length;)f.next(b.shift().buffer);S==null||S.unsubscribe(),f.complete(),f.unsubscribe()},void 0,function(){return b=null});v.subscribe(S)})}return An.bufferTime=r,An}var Sn={},Ud;function pm(){if(Ud)return Sn;Ud=1;var T=$&&$.__values||function(r){var h=typeof Symbol=="function"&&Symbol.iterator,_=h&&r[h],d=0;if(_)return _.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&d>=r.length&&(r=void 0),{value:r&&r[d++],done:!r}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.bufferToggle=void 0;var n=at(),g=te(),y=_e(),p=ie(),t=He(),i=Ft();function a(r,h){return g.operate(function(_,d){var c=[];y.innerFrom(r).subscribe(p.createOperatorSubscriber(d,function(s){var o=[];c.push(o);var l=new n.Subscription,m=function(){i.arrRemove(c,o),d.next(o),l.unsubscribe()};l.add(y.innerFrom(h(s)).subscribe(p.createOperatorSubscriber(d,m,t.noop)))},t.noop)),_.subscribe(p.createOperatorSubscriber(d,function(s){var o,l;try{for(var m=T(c),v=m.next();!v.done;v=m.next()){var f=v.value;f.push(s)}}catch(b){o={error:b}}finally{try{v&&!v.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}},function(){for(;c.length>0;)d.next(c.shift());d.complete()}))})}return Sn.bufferToggle=a,Sn}var On={},Gd;function vm(){if(Gd)return On;Gd=1,Object.defineProperty(On,"__esModule",{value:!0}),On.bufferWhen=void 0;var T=te(),n=He(),g=ie(),y=_e();function p(t){return T.operate(function(i,a){var r=null,h=null,_=function(){h==null||h.unsubscribe();var d=r;r=[],d&&a.next(d),y.innerFrom(t()).subscribe(h=g.createOperatorSubscriber(a,_,n.noop))};_(),i.subscribe(g.createOperatorSubscriber(a,function(d){return r==null?void 0:r.push(d)},function(){r&&a.next(r),a.complete()},void 0,function(){return r=h=null}))})}return On.bufferWhen=p,On}var Rn={},qd;function mm(){if(qd)return Rn;qd=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.catchError=void 0;var T=_e(),n=ie(),g=te();function y(p){return g.operate(function(t,i){var a=null,r=!1,h;a=t.subscribe(n.createOperatorSubscriber(i,void 0,void 0,function(_){h=T.innerFrom(p(_,y(p)(t))),a?(a.unsubscribe(),a=null,h.subscribe(i)):r=!0})),r&&(a.unsubscribe(),a=null,h.subscribe(i))})}return Rn.catchError=y,Rn}var Pn={},wn={},Ln={},Mn={},In={},Fn={},Wd;function x_(){if(Wd)return Fn;Wd=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.scanInternals=void 0;var T=ie();function n(g,y,p,t,i){return function(a,r){var h=p,_=y,d=0;a.subscribe(T.createOperatorSubscriber(r,function(c){var s=d++;_=h?g(_,c,s):(h=!0,c),t&&r.next(_)},i&&function(){h&&r.next(_),r.complete()}))}}return Fn.scanInternals=n,Fn}var Vd;function As(){if(Vd)return In;Vd=1,Object.defineProperty(In,"__esModule",{value:!0}),In.reduce=void 0;var T=x_(),n=te();function g(y,p){return n.operate(T.scanInternals(y,p,arguments.length>=2,!1,!0))}return In.reduce=g,In}var $d;function A_(){if($d)return Mn;$d=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.toArray=void 0;var T=As(),n=te(),g=function(p,t){return p.push(t),p};function y(){return n.operate(function(p,t){T.reduce(g,[])(p).subscribe(t)})}return Mn.toArray=y,Mn}var Hd;function S_(){if(Hd)return Ln;Hd=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.joinAllInternals=void 0;var T=Xe(),n=ur(),g=no(),y=zt(),p=A_();function t(i,a){return g.pipe(p.toArray(),y.mergeMap(function(r){return i(r)}),a?n.mapOneOrManyArgs(a):T.identity)}return Ln.joinAllInternals=t,Ln}var Xd;function O_(){if(Xd)return wn;Xd=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.combineLatestAll=void 0;var T=Ou(),n=S_();function g(y){return n.joinAllInternals(T.combineLatest,y)}return wn.combineLatestAll=g,wn}var Yd;function bm(){if(Yd)return Pn;Yd=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.combineAll=void 0;var T=O_();return Pn.combineAll=T.combineLatestAll,Pn}var Cn={},Nn={},Zd;function gm(){if(Zd)return Nn;Zd=1;var T=$&&$.__read||function(h,_){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var c=d.call(h),s,o=[],l;try{for(;(_===void 0||_-- >0)&&!(s=c.next()).done;)o.push(s.value)}catch(m){l={error:m}}finally{try{s&&!s.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}}return o},n=$&&$.__spreadArray||function(h,_){for(var d=0,c=_.length,s=h.length;d<c;d++,s++)h[s]=_[d];return h};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.combineLatest=void 0;var g=Ou(),y=te(),p=gr(),t=ur(),i=no(),a=rt();function r(){for(var h=[],_=0;_<arguments.length;_++)h[_]=arguments[_];var d=a.popResultSelector(h);return d?i.pipe(r.apply(void 0,n([],T(h))),t.mapOneOrManyArgs(d)):y.operate(function(c,s){g.combineLatestInit(n([c],T(p.argsOrArgArray(h))))(s)})}return Nn.combineLatest=r,Nn}var Kd;function ym(){if(Kd)return Cn;Kd=1;var T=$&&$.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,h=[],_;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)h.push(r.value)}catch(d){_={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(_)throw _.error}}return h},n=$&&$.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.combineLatestWith=void 0;var g=gm();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return g.combineLatest.apply(void 0,n([],T(p)))}return Cn.combineLatestWith=y,Cn}var zn={},Qd;function R_(){if(Qd)return zn;Qd=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.concatMap=void 0;var T=zt(),n=Ee();function g(y,p){return n.isFunction(p)?T.mergeMap(y,p,1):T.mergeMap(y,1)}return zn.concatMap=g,zn}var Bn={},Jd;function Em(){if(Jd)return Bn;Jd=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.concatMapTo=void 0;var T=R_(),n=Ee();function g(y,p){return n.isFunction(p)?T.concatMap(function(){return y},p):T.concatMap(function(){return y})}return Bn.concatMapTo=g,Bn}var Dn={},jn={},e0;function Tm(){if(e0)return jn;e0=1;var T=$&&$.__read||function(a,r){var h=typeof Symbol=="function"&&a[Symbol.iterator];if(!h)return a;var _=h.call(a),d,c=[],s;try{for(;(r===void 0||r-- >0)&&!(d=_.next()).done;)c.push(d.value)}catch(o){s={error:o}}finally{try{d&&!d.done&&(h=_.return)&&h.call(_)}finally{if(s)throw s.error}}return c},n=$&&$.__spreadArray||function(a,r){for(var h=0,_=r.length,d=a.length;h<_;h++,d++)a[d]=r[h];return a};Object.defineProperty(jn,"__esModule",{value:!0}),jn.concat=void 0;var g=te(),y=Pu(),p=rt(),t=Nt();function i(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];var h=p.popScheduler(a);return g.operate(function(_,d){y.concatAll()(t.from(n([_],T(a)),h)).subscribe(d)})}return jn.concat=i,jn}var t0;function xm(){if(t0)return Dn;t0=1;var T=$&&$.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,h=[],_;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)h.push(r.value)}catch(d){_={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(_)throw _.error}}return h},n=$&&$.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.concatWith=void 0;var g=Tm();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return g.concat.apply(void 0,n([],T(p)))}return Dn.concatWith=y,Dn}var kn={},Un={},r0;function Am(){if(r0)return Un;r0=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.fromSubscribable=void 0;var T=xe();function n(g){return new T.Observable(function(y){return g.subscribe(y)})}return Un.fromSubscribable=n,Un}var i0;function Lu(){if(i0)return kn;i0=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.connect=void 0;var T=Ye(),n=_e(),g=te(),y=Am(),p={connector:function(){return new T.Subject}};function t(i,a){a===void 0&&(a=p);var r=a.connector;return g.operate(function(h,_){var d=r();n.innerFrom(i(y.fromSubscribable(d))).subscribe(_),_.add(h.subscribe(d))})}return kn.connect=t,kn}var Gn={},n0;function Sm(){if(n0)return Gn;n0=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.count=void 0;var T=As();function n(g){return T.reduce(function(y,p,t){return!g||g(p,t)?y+1:y},0)}return Gn.count=n,Gn}var qn={},a0;function Om(){if(a0)return qn;a0=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.debounce=void 0;var T=te(),n=He(),g=ie(),y=_e();function p(t){return T.operate(function(i,a){var r=!1,h=null,_=null,d=function(){if(_==null||_.unsubscribe(),_=null,r){r=!1;var c=h;h=null,a.next(c)}};i.subscribe(g.createOperatorSubscriber(a,function(c){_==null||_.unsubscribe(),r=!0,h=c,_=g.createOperatorSubscriber(a,d,n.noop),y.innerFrom(t(c)).subscribe(_)},function(){d(),a.complete()},void 0,function(){h=_=null}))})}return qn.debounce=p,qn}var Wn={},s0;function Rm(){if(s0)return Wn;s0=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.debounceTime=void 0;var T=tt(),n=te(),g=ie();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.operate(function(i,a){var r=null,h=null,_=null,d=function(){if(r){r.unsubscribe(),r=null;var s=h;h=null,a.next(s)}};function c(){var s=_+p,o=t.now();if(o<s){r=this.schedule(void 0,s-o),a.add(r);return}d()}i.subscribe(g.createOperatorSubscriber(a,function(s){h=s,_=t.now(),r||(r=t.schedule(c,p),a.add(r))},function(){d(),a.complete()},void 0,function(){h=r=null}))})}return Wn.debounceTime=y,Wn}var Vn={},o0;function fo(){if(o0)return Vn;o0=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.defaultIfEmpty=void 0;var T=te(),n=ie();function g(y){return T.operate(function(p,t){var i=!1;p.subscribe(n.createOperatorSubscriber(t,function(a){i=!0,t.next(a)},function(){i||t.next(y),t.complete()}))})}return Vn.defaultIfEmpty=g,Vn}var $n={},Hn={},Xn={},l0;function _o(){if(l0)return Xn;l0=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.take=void 0;var T=yt(),n=te(),g=ie();function y(p){return p<=0?function(){return T.EMPTY}:n.operate(function(t,i){var a=0;t.subscribe(g.createOperatorSubscriber(i,function(r){++a<=p&&(i.next(r),p<=a&&i.complete())}))})}return Xn.take=y,Xn}var Yn={},u0;function P_(){if(u0)return Yn;u0=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.ignoreElements=void 0;var T=te(),n=ie(),g=He();function y(){return T.operate(function(p,t){p.subscribe(n.createOperatorSubscriber(t,g.noop))})}return Yn.ignoreElements=y,Yn}var Zn={},c0;function w_(){if(c0)return Zn;c0=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.mapTo=void 0;var T=lr();function n(g){return T.map(function(){return g})}return Zn.mapTo=n,Zn}var h0;function L_(){if(h0)return Hn;h0=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.delayWhen=void 0;var T=co(),n=_o(),g=P_(),y=w_(),p=zt(),t=_e();function i(a,r){return r?function(h){return T.concat(r.pipe(n.take(1),g.ignoreElements()),h.pipe(i(a)))}:p.mergeMap(function(h,_){return t.innerFrom(a(h,_)).pipe(n.take(1),y.mapTo(h))})}return Hn.delayWhen=i,Hn}var d0;function Pm(){if(d0)return $n;d0=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.delay=void 0;var T=tt(),n=L_(),g=cr();function y(p,t){t===void 0&&(t=T.asyncScheduler);var i=g.timer(p,t);return n.delayWhen(function(){return i})}return $n.delay=y,$n}var Kn={},f0;function wm(){if(f0)return Kn;f0=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.dematerialize=void 0;var T=Au(),n=te(),g=ie();function y(){return n.operate(function(p,t){p.subscribe(g.createOperatorSubscriber(t,function(i){return T.observeNotification(i,t)}))})}return Kn.dematerialize=y,Kn}var Qn={},_0;function Lm(){if(_0)return Qn;_0=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.distinct=void 0;var T=te(),n=ie(),g=He(),y=_e();function p(t,i){return T.operate(function(a,r){var h=new Set;a.subscribe(n.createOperatorSubscriber(r,function(_){var d=t?t(_):_;h.has(d)||(h.add(d),r.next(_))})),i&&y.innerFrom(i).subscribe(n.createOperatorSubscriber(r,function(){return h.clear()},g.noop))})}return Qn.distinct=p,Qn}var Jn={},p0;function M_(){if(p0)return Jn;p0=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.distinctUntilChanged=void 0;var T=Xe(),n=te(),g=ie();function y(t,i){return i===void 0&&(i=T.identity),t=t??p,n.operate(function(a,r){var h,_=!0;a.subscribe(g.createOperatorSubscriber(r,function(d){var c=i(d);(_||!t(h,c))&&(_=!1,h=c,r.next(d))}))})}Jn.distinctUntilChanged=y;function p(t,i){return t===i}return Jn}var ea={},v0;function Mm(){if(v0)return ea;v0=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.distinctUntilKeyChanged=void 0;var T=M_();function n(g,y){return T.distinctUntilChanged(function(p,t){return y?y(p[g],t[g]):p[g]===t[g]})}return ea.distinctUntilKeyChanged=n,ea}var ta={},ra={},m0;function po(){if(m0)return ra;m0=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.throwIfEmpty=void 0;var T=or(),n=te(),g=ie();function y(t){return t===void 0&&(t=p),n.operate(function(i,a){var r=!1;i.subscribe(g.createOperatorSubscriber(a,function(h){r=!0,a.next(h)},function(){return r?a.complete():a.error(t())}))})}ra.throwIfEmpty=y;function p(){return new T.EmptyError}return ra}var b0;function Im(){if(b0)return ta;b0=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.elementAt=void 0;var T=f_(),n=yr(),g=po(),y=fo(),p=_o();function t(i,a){if(i<0)throw new T.ArgumentOutOfRangeError;var r=arguments.length>=2;return function(h){return h.pipe(n.filter(function(_,d){return d===i}),p.take(1),r?y.defaultIfEmpty(a):g.throwIfEmpty(function(){return new T.ArgumentOutOfRangeError}))}}return ta.elementAt=t,ta}var ia={},g0;function Fm(){if(g0)return ia;g0=1;var T=$&&$.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),h,_=[],d;try{for(;(i===void 0||i-- >0)&&!(h=r.next()).done;)_.push(h.value)}catch(c){d={error:c}}finally{try{h&&!h.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return _},n=$&&$.__spreadArray||function(t,i){for(var a=0,r=i.length,h=t.length;a<r;a++,h++)t[h]=i[a];return t};Object.defineProperty(ia,"__esModule",{value:!0}),ia.endWith=void 0;var g=co(),y=xu();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return function(a){return g.concat(a,y.of.apply(void 0,n([],T(t))))}}return ia.endWith=p,ia}var na={},y0;function Cm(){if(y0)return na;y0=1,Object.defineProperty(na,"__esModule",{value:!0}),na.every=void 0;var T=te(),n=ie();function g(y,p){return T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){y.call(p,r,a++,t)||(i.next(!1),i.complete())},function(){i.next(!0),i.complete()}))})}return na.every=g,na}var aa={},sa={},oa={},E0;function I_(){if(E0)return oa;E0=1,Object.defineProperty(oa,"__esModule",{value:!0}),oa.exhaustMap=void 0;var T=lr(),n=_e(),g=te(),y=ie();function p(t,i){return i?function(a){return a.pipe(p(function(r,h){return n.innerFrom(t(r,h)).pipe(T.map(function(_,d){return i(r,_,h,d)}))}))}:g.operate(function(a,r){var h=0,_=null,d=!1;a.subscribe(y.createOperatorSubscriber(r,function(c){_||(_=y.createOperatorSubscriber(r,void 0,function(){_=null,d&&r.complete()}),n.innerFrom(t(c,h++)).subscribe(_))},function(){d=!0,!_&&r.complete()}))})}return oa.exhaustMap=p,oa}var T0;function F_(){if(T0)return sa;T0=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.exhaustAll=void 0;var T=I_(),n=Xe();function g(){return T.exhaustMap(n.identity)}return sa.exhaustAll=g,sa}var x0;function Nm(){if(x0)return aa;x0=1,Object.defineProperty(aa,"__esModule",{value:!0}),aa.exhaust=void 0;var T=F_();return aa.exhaust=T.exhaustAll,aa}var la={},A0;function zm(){if(A0)return la;A0=1,Object.defineProperty(la,"__esModule",{value:!0}),la.expand=void 0;var T=te(),n=Ru();function g(y,p,t){return p===void 0&&(p=1/0),p=(p||0)<1?1/0:p,T.operate(function(i,a){return n.mergeInternals(i,a,y,p,void 0,!0,t)})}return la.expand=g,la}var ua={},S0;function Bm(){if(S0)return ua;S0=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.finalize=void 0;var T=te();function n(g){return T.operate(function(y,p){try{y.subscribe(p)}finally{p.add(g)}})}return ua.finalize=n,ua}var Kt={},O0;function C_(){if(O0)return Kt;O0=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.createFind=Kt.find=void 0;var T=te(),n=ie();function g(p,t){return T.operate(y(p,t,"value"))}Kt.find=g;function y(p,t,i){var a=i==="index";return function(r,h){var _=0;r.subscribe(n.createOperatorSubscriber(h,function(d){var c=_++;p.call(t,d,c,r)&&(h.next(a?c:d),h.complete())},function(){h.next(a?-1:void 0),h.complete()}))}}return Kt.createFind=y,Kt}var ca={},R0;function Dm(){if(R0)return ca;R0=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.findIndex=void 0;var T=te(),n=C_();function g(y,p){return T.operate(n.createFind(y,p,"index"))}return ca.findIndex=g,ca}var ha={},P0;function jm(){if(P0)return ha;P0=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.first=void 0;var T=or(),n=yr(),g=_o(),y=fo(),p=po(),t=Xe();function i(a,r){var h=arguments.length>=2;return function(_){return _.pipe(a?n.filter(function(d,c){return a(d,c,_)}):t.identity,g.take(1),h?y.defaultIfEmpty(r):p.throwIfEmpty(function(){return new T.EmptyError}))}}return ha.first=i,ha}var da={},w0;function km(){if(w0)return da;w0=1,Object.defineProperty(da,"__esModule",{value:!0}),da.groupBy=void 0;var T=xe(),n=_e(),g=Ye(),y=te(),p=ie();function t(i,a,r,h){return y.operate(function(_,d){var c;!a||typeof a=="function"?c=a:(r=a.duration,c=a.element,h=a.connector);var s=new Map,o=function(x){s.forEach(x),x(d)},l=function(x){return o(function(E){return E.error(x)})},m=0,v=!1,f=new p.OperatorSubscriber(d,function(x){try{var E=i(x),O=s.get(E);if(!O){s.set(E,O=h?h():new g.Subject);var S=b(E,O);if(d.next(S),r){var w=p.createOperatorSubscriber(O,function(){O.complete(),w==null||w.unsubscribe()},void 0,void 0,function(){return s.delete(E)});f.add(n.innerFrom(r(S)).subscribe(w))}}O.next(c?c(x):x)}catch(P){l(P)}},function(){return o(function(x){return x.complete()})},l,function(){return s.clear()},function(){return v=!0,m===0});_.subscribe(f);function b(x,E){var O=new T.Observable(function(S){m++;var w=E.subscribe(S);return function(){w.unsubscribe(),--m===0&&v&&f.unsubscribe()}});return O.key=x,O}})}return da.groupBy=t,da}var fa={},L0;function Um(){if(L0)return fa;L0=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.isEmpty=void 0;var T=te(),n=ie();function g(){return T.operate(function(y,p){y.subscribe(n.createOperatorSubscriber(p,function(){p.next(!1),p.complete()},function(){p.next(!0),p.complete()}))})}return fa.isEmpty=g,fa}var _a={},pa={},M0;function N_(){if(M0)return pa;M0=1;var T=$&&$.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(pa,"__esModule",{value:!0}),pa.takeLast=void 0;var n=yt(),g=te(),y=ie();function p(t){return t<=0?function(){return n.EMPTY}:g.operate(function(i,a){var r=[];i.subscribe(y.createOperatorSubscriber(a,function(h){r.push(h),t<r.length&&r.shift()},function(){var h,_;try{for(var d=T(r),c=d.next();!c.done;c=d.next()){var s=c.value;a.next(s)}}catch(o){h={error:o}}finally{try{c&&!c.done&&(_=d.return)&&_.call(d)}finally{if(h)throw h.error}}a.complete()},void 0,function(){r=null}))})}return pa.takeLast=p,pa}var I0;function Gm(){if(I0)return _a;I0=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.last=void 0;var T=or(),n=yr(),g=N_(),y=po(),p=fo(),t=Xe();function i(a,r){var h=arguments.length>=2;return function(_){return _.pipe(a?n.filter(function(d,c){return a(d,c,_)}):t.identity,g.takeLast(1),h?p.defaultIfEmpty(r):y.throwIfEmpty(function(){return new T.EmptyError}))}}return _a.last=i,_a}var va={},F0;function qm(){if(F0)return va;F0=1,Object.defineProperty(va,"__esModule",{value:!0}),va.materialize=void 0;var T=Au(),n=te(),g=ie();function y(){return n.operate(function(p,t){p.subscribe(g.createOperatorSubscriber(t,function(i){t.next(T.Notification.createNext(i))},function(){t.next(T.Notification.createComplete()),t.complete()},function(i){t.next(T.Notification.createError(i)),t.complete()}))})}return va.materialize=y,va}var ma={},C0;function Wm(){if(C0)return ma;C0=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.max=void 0;var T=As(),n=Ee();function g(y){return T.reduce(n.isFunction(y)?function(p,t){return y(p,t)>0?p:t}:function(p,t){return p>t?p:t})}return ma.max=g,ma}var ba={},N0;function Vm(){if(N0)return ba;N0=1,Object.defineProperty(ba,"__esModule",{value:!0}),ba.flatMap=void 0;var T=zt();return ba.flatMap=T.mergeMap,ba}var ga={},z0;function $m(){if(z0)return ga;z0=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.mergeMapTo=void 0;var T=zt(),n=Ee();function g(y,p,t){return t===void 0&&(t=1/0),n.isFunction(p)?T.mergeMap(function(){return y},p,t):(typeof p=="number"&&(t=p),T.mergeMap(function(){return y},t))}return ga.mergeMapTo=g,ga}var ya={},B0;function Hm(){if(B0)return ya;B0=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.mergeScan=void 0;var T=te(),n=Ru();function g(y,p,t){return t===void 0&&(t=1/0),T.operate(function(i,a){var r=p;return n.mergeInternals(i,a,function(h,_){return y(r,h,_)},t,function(h){r=h},!1,void 0,function(){return r=null})})}return ya.mergeScan=g,ya}var Ea={},Ta={},D0;function Xm(){if(D0)return Ta;D0=1;var T=$&&$.__read||function(r,h){var _=typeof Symbol=="function"&&r[Symbol.iterator];if(!_)return r;var d=_.call(r),c,s=[],o;try{for(;(h===void 0||h-- >0)&&!(c=d.next()).done;)s.push(c.value)}catch(l){o={error:l}}finally{try{c&&!c.done&&(_=d.return)&&_.call(d)}finally{if(o)throw o.error}}return s},n=$&&$.__spreadArray||function(r,h){for(var _=0,d=h.length,c=r.length;_<d;_++,c++)r[c]=h[_];return r};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.merge=void 0;var g=te(),y=gr(),p=uo(),t=rt(),i=Nt();function a(){for(var r=[],h=0;h<arguments.length;h++)r[h]=arguments[h];var _=t.popScheduler(r),d=t.popNumber(r,1/0);return r=y.argsOrArgArray(r),g.operate(function(c,s){p.mergeAll(d)(i.from(n([c],T(r)),_)).subscribe(s)})}return Ta.merge=a,Ta}var j0;function Ym(){if(j0)return Ea;j0=1;var T=$&&$.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,h=[],_;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)h.push(r.value)}catch(d){_={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(_)throw _.error}}return h},n=$&&$.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.mergeWith=void 0;var g=Xm();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return g.merge.apply(void 0,n([],T(p)))}return Ea.mergeWith=y,Ea}var xa={},k0;function Zm(){if(k0)return xa;k0=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.min=void 0;var T=As(),n=Ee();function g(y){return T.reduce(n.isFunction(y)?function(p,t){return y(p,t)<0?p:t}:function(p,t){return p<t?p:t})}return xa.min=g,xa}var Aa={},U0;function Mu(){if(U0)return Aa;U0=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.multicast=void 0;var T=ao(),n=Ee(),g=Lu();function y(p,t){var i=n.isFunction(p)?p:function(){return p};return n.isFunction(t)?g.connect(t,{connector:i}):function(a){return new T.ConnectableObservable(a,i)}}return Aa.multicast=y,Aa}var Qt={},G0;function Km(){if(G0)return Qt;G0=1;var T=$&&$.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),h,_=[],d;try{for(;(i===void 0||i-- >0)&&!(h=r.next()).done;)_.push(h.value)}catch(c){d={error:c}}finally{try{h&&!h.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return _},n=$&&$.__spreadArray||function(t,i){for(var a=0,r=i.length,h=t.length;a<r;a++,h++)t[h]=i[a];return t};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.onErrorResumeNext=Qt.onErrorResumeNextWith=void 0;var g=gr(),y=y_();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var a=g.argsOrArgArray(t);return function(r){return y.onErrorResumeNext.apply(void 0,n([r],T(a)))}}return Qt.onErrorResumeNextWith=p,Qt.onErrorResumeNext=p,Qt}var Sa={},q0;function Qm(){if(q0)return Sa;q0=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.pairwise=void 0;var T=te(),n=ie();function g(){return T.operate(function(y,p){var t,i=!1;y.subscribe(n.createOperatorSubscriber(p,function(a){var r=t;t=a,i&&p.next([r,a]),i=!0}))})}return Sa.pairwise=g,Sa}var Oa={},W0;function Jm(){if(W0)return Oa;W0=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.pluck=void 0;var T=lr();function n(){for(var g=[],y=0;y<arguments.length;y++)g[y]=arguments[y];var p=g.length;if(p===0)throw new Error("list of properties cannot be empty.");return T.map(function(t){for(var i=t,a=0;a<p;a++){var r=i==null?void 0:i[g[a]];if(typeof r<"u")i=r;else return}return i})}return Oa.pluck=n,Oa}var Ra={},V0;function e2(){if(V0)return Ra;V0=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.publish=void 0;var T=Ye(),n=Mu(),g=Lu();function y(p){return p?function(t){return g.connect(p)(t)}:function(t){return n.multicast(new T.Subject)(t)}}return Ra.publish=y,Ra}var Pa={},$0;function t2(){if($0)return Pa;$0=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.publishBehavior=void 0;var T=t_(),n=ao();function g(y){return function(p){var t=new T.BehaviorSubject(y);return new n.ConnectableObservable(p,function(){return t})}}return Pa.publishBehavior=g,Pa}var wa={},H0;function r2(){if(H0)return wa;H0=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.publishLast=void 0;var T=yu(),n=ao();function g(){return function(y){var p=new T.AsyncSubject;return new n.ConnectableObservable(y,function(){return p})}}return wa.publishLast=g,wa}var La={},X0;function i2(){if(X0)return La;X0=1,Object.defineProperty(La,"__esModule",{value:!0}),La.publishReplay=void 0;var T=gu(),n=Mu(),g=Ee();function y(p,t,i,a){i&&!g.isFunction(i)&&(a=i);var r=g.isFunction(i)?i:void 0;return function(h){return n.multicast(new T.ReplaySubject(p,t,a),r)(h)}}return La.publishReplay=y,La}var Ma={},Y0;function n2(){if(Y0)return Ma;Y0=1;var T=$&&$.__read||function(i,a){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var h=r.call(i),_,d=[],c;try{for(;(a===void 0||a-- >0)&&!(_=h.next()).done;)d.push(_.value)}catch(s){c={error:s}}finally{try{_&&!_.done&&(r=h.return)&&r.call(h)}finally{if(c)throw c.error}}return d},n=$&&$.__spreadArray||function(i,a){for(var r=0,h=a.length,_=i.length;r<h;r++,_++)i[_]=a[r];return i};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.raceWith=void 0;var g=E_(),y=te(),p=Xe();function t(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return i.length?y.operate(function(r,h){g.raceInit(n([r],T(i)))(h)}):p.identity}return Ma.raceWith=t,Ma}var Ia={},Z0;function a2(){if(Z0)return Ia;Z0=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.repeat=void 0;var T=yt(),n=te(),g=ie(),y=_e(),p=cr();function t(i){var a,r=1/0,h;return i!=null&&(typeof i=="object"?(a=i.count,r=a===void 0?1/0:a,h=i.delay):r=i),r<=0?function(){return T.EMPTY}:n.operate(function(_,d){var c=0,s,o=function(){if(s==null||s.unsubscribe(),s=null,h!=null){var m=typeof h=="number"?p.timer(h):y.innerFrom(h(c)),v=g.createOperatorSubscriber(d,function(){v.unsubscribe(),l()});m.subscribe(v)}else l()},l=function(){var m=!1;s=_.subscribe(g.createOperatorSubscriber(d,void 0,function(){++c<r?s?o():m=!0:d.complete()})),m&&o()};l()})}return Ia.repeat=t,Ia}var Fa={},K0;function s2(){if(K0)return Fa;K0=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.repeatWhen=void 0;var T=_e(),n=Ye(),g=te(),y=ie();function p(t){return g.operate(function(i,a){var r,h=!1,_,d=!1,c=!1,s=function(){return c&&d&&(a.complete(),!0)},o=function(){return _||(_=new n.Subject,T.innerFrom(t(_)).subscribe(y.createOperatorSubscriber(a,function(){r?l():h=!0},function(){d=!0,s()}))),_},l=function(){c=!1,r=i.subscribe(y.createOperatorSubscriber(a,void 0,function(){c=!0,!s()&&o().next()})),h&&(r.unsubscribe(),r=null,h=!1,l())};l()})}return Fa.repeatWhen=p,Fa}var Ca={},Q0;function o2(){if(Q0)return Ca;Q0=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.retry=void 0;var T=te(),n=ie(),g=Xe(),y=cr(),p=_e();function t(i){i===void 0&&(i=1/0);var a;i&&typeof i=="object"?a=i:a={count:i};var r=a.count,h=r===void 0?1/0:r,_=a.delay,d=a.resetOnSuccess,c=d===void 0?!1:d;return h<=0?g.identity:T.operate(function(s,o){var l=0,m,v=function(){var f=!1;m=s.subscribe(n.createOperatorSubscriber(o,function(b){c&&(l=0),o.next(b)},void 0,function(b){if(l++<h){var x=function(){m?(m.unsubscribe(),m=null,v()):f=!0};if(_!=null){var E=typeof _=="number"?y.timer(_):p.innerFrom(_(b,l)),O=n.createOperatorSubscriber(o,function(){O.unsubscribe(),x()},function(){o.complete()});E.subscribe(O)}else x()}else o.error(b)})),f&&(m.unsubscribe(),m=null,v())};v()})}return Ca.retry=t,Ca}var Na={},J0;function l2(){if(J0)return Na;J0=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.retryWhen=void 0;var T=_e(),n=Ye(),g=te(),y=ie();function p(t){return g.operate(function(i,a){var r,h=!1,_,d=function(){r=i.subscribe(y.createOperatorSubscriber(a,void 0,void 0,function(c){_||(_=new n.Subject,T.innerFrom(t(_)).subscribe(y.createOperatorSubscriber(a,function(){return r?d():h=!0}))),_&&_.next(c)})),h&&(r.unsubscribe(),r=null,h=!1,d())};d()})}return Na.retryWhen=p,Na}var za={},ef;function z_(){if(ef)return za;ef=1,Object.defineProperty(za,"__esModule",{value:!0}),za.sample=void 0;var T=_e(),n=te(),g=He(),y=ie();function p(t){return n.operate(function(i,a){var r=!1,h=null;i.subscribe(y.createOperatorSubscriber(a,function(_){r=!0,h=_})),T.innerFrom(t).subscribe(y.createOperatorSubscriber(a,function(){if(r){r=!1;var _=h;h=null,a.next(_)}},g.noop))})}return za.sample=p,za}var Ba={},tf;function u2(){if(tf)return Ba;tf=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.sampleTime=void 0;var T=tt(),n=z_(),g=g_();function y(p,t){return t===void 0&&(t=T.asyncScheduler),n.sample(g.interval(p,t))}return Ba.sampleTime=y,Ba}var Da={},rf;function c2(){if(rf)return Da;rf=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.scan=void 0;var T=te(),n=x_();function g(y,p){return T.operate(n.scanInternals(y,p,arguments.length>=2,!0))}return Da.scan=g,Da}var ja={},nf;function h2(){if(nf)return ja;nf=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.sequenceEqual=void 0;var T=te(),n=ie(),g=_e();function y(t,i){return i===void 0&&(i=function(a,r){return a===r}),T.operate(function(a,r){var h=p(),_=p(),d=function(s){r.next(s),r.complete()},c=function(s,o){var l=n.createOperatorSubscriber(r,function(m){var v=o.buffer,f=o.complete;v.length===0?f?d(!1):s.buffer.push(m):!i(m,v.shift())&&d(!1)},function(){s.complete=!0;var m=o.complete,v=o.buffer;m&&d(v.length===0),l==null||l.unsubscribe()});return l};a.subscribe(c(h,_)),g.innerFrom(t).subscribe(c(_,h))})}ja.sequenceEqual=y;function p(){return{buffer:[],complete:!1}}return ja}var ka={},af;function B_(){if(af)return ka;af=1;var T=$&&$.__read||function(r,h){var _=typeof Symbol=="function"&&r[Symbol.iterator];if(!_)return r;var d=_.call(r),c,s=[],o;try{for(;(h===void 0||h-- >0)&&!(c=d.next()).done;)s.push(c.value)}catch(l){o={error:l}}finally{try{c&&!c.done&&(_=d.return)&&_.call(d)}finally{if(o)throw o.error}}return s},n=$&&$.__spreadArray||function(r,h){for(var _=0,d=h.length,c=r.length;_<d;_++,c++)r[c]=h[_];return r};Object.defineProperty(ka,"__esModule",{value:!0}),ka.share=void 0;var g=_e(),y=Ye(),p=Es(),t=te();function i(r){r===void 0&&(r={});var h=r.connector,_=h===void 0?function(){return new y.Subject}:h,d=r.resetOnError,c=d===void 0?!0:d,s=r.resetOnComplete,o=s===void 0?!0:s,l=r.resetOnRefCountZero,m=l===void 0?!0:l;return function(v){var f,b,x,E=0,O=!1,S=!1,w=function(){b==null||b.unsubscribe(),b=void 0},P=function(){w(),f=x=void 0,O=S=!1},N=function(){var k=f;P(),k==null||k.unsubscribe()};return t.operate(function(k,j){E++,!S&&!O&&w();var U=x=x??_();j.add(function(){E--,E===0&&!S&&!O&&(b=a(N,m))}),U.subscribe(j),!f&&E>0&&(f=new p.SafeSubscriber({next:function(H){return U.next(H)},error:function(H){S=!0,w(),b=a(P,c,H),U.error(H)},complete:function(){O=!0,w(),b=a(P,o),U.complete()}}),g.innerFrom(k).subscribe(f))})(v)}}ka.share=i;function a(r,h){for(var _=[],d=2;d<arguments.length;d++)_[d-2]=arguments[d];if(h===!0){r();return}if(h!==!1){var c=new p.SafeSubscriber({next:function(){c.unsubscribe(),r()}});return g.innerFrom(h.apply(void 0,n([],T(_)))).subscribe(c)}}return ka}var Ua={},sf;function d2(){if(sf)return Ua;sf=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.shareReplay=void 0;var T=gu(),n=B_();function g(y,p,t){var i,a,r,h,_=!1;return y&&typeof y=="object"?(i=y.bufferSize,h=i===void 0?1/0:i,a=y.windowTime,p=a===void 0?1/0:a,r=y.refCount,_=r===void 0?!1:r,t=y.scheduler):h=y??1/0,n.share({connector:function(){return new T.ReplaySubject(h,p,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:_})}return Ua.shareReplay=g,Ua}var Ga={},of;function f2(){if(of)return Ga;of=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.single=void 0;var T=or(),n=p_(),g=__(),y=te(),p=ie();function t(i){return y.operate(function(a,r){var h=!1,_,d=!1,c=0;a.subscribe(p.createOperatorSubscriber(r,function(s){d=!0,(!i||i(s,c++,a))&&(h&&r.error(new n.SequenceError("Too many matching values")),h=!0,_=s)},function(){h?(r.next(_),r.complete()):r.error(d?new g.NotFoundError("No matching values"):new T.EmptyError)}))})}return Ga.single=t,Ga}var qa={},lf;function _2(){if(lf)return qa;lf=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.skip=void 0;var T=yr();function n(g){return T.filter(function(y,p){return g<=p})}return qa.skip=n,qa}var Wa={},uf;function p2(){if(uf)return Wa;uf=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.skipLast=void 0;var T=Xe(),n=te(),g=ie();function y(p){return p<=0?T.identity:n.operate(function(t,i){var a=new Array(p),r=0;return t.subscribe(g.createOperatorSubscriber(i,function(h){var _=r++;if(_<p)a[_]=h;else{var d=_%p,c=a[d];a[d]=h,i.next(c)}})),function(){a=null}})}return Wa.skipLast=y,Wa}var Va={},cf;function v2(){if(cf)return Va;cf=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.skipUntil=void 0;var T=te(),n=ie(),g=_e(),y=He();function p(t){return T.operate(function(i,a){var r=!1,h=n.createOperatorSubscriber(a,function(){h==null||h.unsubscribe(),r=!0},y.noop);g.innerFrom(t).subscribe(h),i.subscribe(n.createOperatorSubscriber(a,function(_){return r&&a.next(_)}))})}return Va.skipUntil=p,Va}var $a={},hf;function m2(){if(hf)return $a;hf=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.skipWhile=void 0;var T=te(),n=ie();function g(y){return T.operate(function(p,t){var i=!1,a=0;p.subscribe(n.createOperatorSubscriber(t,function(r){return(i||(i=!y(r,a++)))&&t.next(r)}))})}return $a.skipWhile=g,$a}var Ha={},df;function b2(){if(df)return Ha;df=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.startWith=void 0;var T=co(),n=rt(),g=te();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];var i=n.popScheduler(p);return g.operate(function(a,r){(i?T.concat(p,a,i):T.concat(p,a)).subscribe(r)})}return Ha.startWith=y,Ha}var Xa={},Ya={},ff;function vo(){if(ff)return Ya;ff=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.switchMap=void 0;var T=_e(),n=te(),g=ie();function y(p,t){return n.operate(function(i,a){var r=null,h=0,_=!1,d=function(){return _&&!r&&a.complete()};i.subscribe(g.createOperatorSubscriber(a,function(c){r==null||r.unsubscribe();var s=0,o=h++;T.innerFrom(p(c,o)).subscribe(r=g.createOperatorSubscriber(a,function(l){return a.next(t?t(c,l,o,s++):l)},function(){r=null,d()}))},function(){_=!0,d()}))})}return Ya.switchMap=y,Ya}var _f;function g2(){if(_f)return Xa;_f=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.switchAll=void 0;var T=vo(),n=Xe();function g(){return T.switchMap(n.identity)}return Xa.switchAll=g,Xa}var Za={},pf;function y2(){if(pf)return Za;pf=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.switchMapTo=void 0;var T=vo(),n=Ee();function g(y,p){return n.isFunction(p)?T.switchMap(function(){return y},p):T.switchMap(function(){return y})}return Za.switchMapTo=g,Za}var Ka={},vf;function E2(){if(vf)return Ka;vf=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.switchScan=void 0;var T=vo(),n=te();function g(y,p){return n.operate(function(t,i){var a=p;return T.switchMap(function(r,h){return y(a,r,h)},function(r,h){return a=h,h})(t).subscribe(i),function(){a=null}})}return Ka.switchScan=g,Ka}var Qa={},mf;function T2(){if(mf)return Qa;mf=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.takeUntil=void 0;var T=te(),n=ie(),g=_e(),y=He();function p(t){return T.operate(function(i,a){g.innerFrom(t).subscribe(n.createOperatorSubscriber(a,function(){return a.complete()},y.noop)),!a.closed&&i.subscribe(a)})}return Qa.takeUntil=p,Qa}var Ja={},bf;function x2(){if(bf)return Ja;bf=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.takeWhile=void 0;var T=te(),n=ie();function g(y,p){return p===void 0&&(p=!1),T.operate(function(t,i){var a=0;t.subscribe(n.createOperatorSubscriber(i,function(r){var h=y(r,a++);(h||p)&&i.next(r),!h&&i.complete()}))})}return Ja.takeWhile=g,Ja}var es={},gf;function A2(){if(gf)return es;gf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.tap=void 0;var T=Ee(),n=te(),g=ie(),y=Xe();function p(t,i,a){var r=T.isFunction(t)||i||a?{next:t,error:i,complete:a}:t;return r?n.operate(function(h,_){var d;(d=r.subscribe)===null||d===void 0||d.call(r);var c=!0;h.subscribe(g.createOperatorSubscriber(_,function(s){var o;(o=r.next)===null||o===void 0||o.call(r,s),_.next(s)},function(){var s;c=!1,(s=r.complete)===null||s===void 0||s.call(r),_.complete()},function(s){var o;c=!1,(o=r.error)===null||o===void 0||o.call(r,s),_.error(s)},function(){var s,o;c&&((s=r.unsubscribe)===null||s===void 0||s.call(r)),(o=r.finalize)===null||o===void 0||o.call(r)}))}):y.identity}return es.tap=p,es}var ts={},yf;function D_(){if(yf)return ts;yf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.throttle=void 0;var T=te(),n=ie(),g=_e();function y(p,t){return T.operate(function(i,a){var r=t??{},h=r.leading,_=h===void 0?!0:h,d=r.trailing,c=d===void 0?!1:d,s=!1,o=null,l=null,m=!1,v=function(){l==null||l.unsubscribe(),l=null,c&&(x(),m&&a.complete())},f=function(){l=null,m&&a.complete()},b=function(E){return l=g.innerFrom(p(E)).subscribe(n.createOperatorSubscriber(a,v,f))},x=function(){if(s){s=!1;var E=o;o=null,a.next(E),!m&&b(E)}};i.subscribe(n.createOperatorSubscriber(a,function(E){s=!0,o=E,!(l&&!l.closed)&&(_?x():b(E))},function(){m=!0,!(c&&s&&l&&!l.closed)&&a.complete()}))})}return ts.throttle=y,ts}var rs={},Ef;function S2(){if(Ef)return rs;Ef=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.throttleTime=void 0;var T=tt(),n=D_(),g=cr();function y(p,t,i){t===void 0&&(t=T.asyncScheduler);var a=g.timer(p,t);return n.throttle(function(){return a},i)}return rs.throttleTime=y,rs}var Jt={},Tf;function O2(){if(Tf)return Jt;Tf=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.TimeInterval=Jt.timeInterval=void 0;var T=tt(),n=te(),g=ie();function y(t){return t===void 0&&(t=T.asyncScheduler),n.operate(function(i,a){var r=t.now();i.subscribe(g.createOperatorSubscriber(a,function(h){var _=t.now(),d=_-r;r=_,a.next(new p(h,d))}))})}Jt.timeInterval=y;var p=function(){function t(i,a){this.value=i,this.interval=a}return t}();return Jt.TimeInterval=p,Jt}var is={},xf;function R2(){if(xf)return is;xf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.timeoutWith=void 0;var T=tt(),n=Su(),g=_u();function y(p,t,i){var a,r,h;if(i=i??T.async,n.isValidDate(p)?a=p:typeof p=="number"&&(r=p),t)h=function(){return t};else throw new TypeError("No observable provided to switch to");if(a==null&&r==null)throw new TypeError("No timeout provided.");return g.timeout({first:a,each:r,scheduler:i,with:h})}return is.timeoutWith=y,is}var ns={},Af;function P2(){if(Af)return ns;Af=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.timestamp=void 0;var T=bu(),n=lr();function g(y){return y===void 0&&(y=T.dateTimestampProvider),n.map(function(p){return{value:p,timestamp:y.now()}})}return ns.timestamp=g,ns}var as={},Sf;function w2(){if(Sf)return as;Sf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.window=void 0;var T=Ye(),n=te(),g=ie(),y=He(),p=_e();function t(i){return n.operate(function(a,r){var h=new T.Subject;r.next(h.asObservable());var _=function(d){h.error(d),r.error(d)};return a.subscribe(g.createOperatorSubscriber(r,function(d){return h==null?void 0:h.next(d)},function(){h.complete(),r.complete()},_)),p.innerFrom(i).subscribe(g.createOperatorSubscriber(r,function(){h.complete(),r.next(h=new T.Subject)},y.noop,_)),function(){h==null||h.unsubscribe(),h=null}})}return as.window=t,as}var ss={},Of;function L2(){if(Of)return ss;Of=1;var T=$&&$.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],r=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ss,"__esModule",{value:!0}),ss.windowCount=void 0;var n=Ye(),g=te(),y=ie();function p(t,i){i===void 0&&(i=0);var a=i>0?i:t;return g.operate(function(r,h){var _=[new n.Subject],d=0;h.next(_[0].asObservable()),r.subscribe(y.createOperatorSubscriber(h,function(c){var s,o;try{for(var l=T(_),m=l.next();!m.done;m=l.next()){var v=m.value;v.next(c)}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}var f=d-t+1;if(f>=0&&f%a===0&&_.shift().complete(),++d%a===0){var b=new n.Subject;_.push(b),h.next(b.asObservable())}},function(){for(;_.length>0;)_.shift().complete();h.complete()},function(c){for(;_.length>0;)_.shift().error(c);h.error(c)},function(){_=null}))})}return ss.windowCount=p,ss}var os={},Rf;function M2(){if(Rf)return os;Rf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.windowTime=void 0;var T=Ye(),n=tt(),g=at(),y=te(),p=ie(),t=Ft(),i=rt(),a=Ct();function r(h){for(var _,d,c=[],s=1;s<arguments.length;s++)c[s-1]=arguments[s];var o=(_=i.popScheduler(c))!==null&&_!==void 0?_:n.asyncScheduler,l=(d=c[0])!==null&&d!==void 0?d:null,m=c[1]||1/0;return y.operate(function(v,f){var b=[],x=!1,E=function(P){var N=P.window,k=P.subs;N.complete(),k.unsubscribe(),t.arrRemove(b,P),x&&O()},O=function(){if(b){var P=new g.Subscription;f.add(P);var N=new T.Subject,k={window:N,subs:P,seen:0};b.push(k),f.next(N.asObservable()),a.executeSchedule(P,o,function(){return E(k)},h)}};l!==null&&l>=0?a.executeSchedule(f,o,O,l,!0):x=!0,O();var S=function(P){return b.slice().forEach(P)},w=function(P){S(function(N){var k=N.window;return P(k)}),P(f),f.unsubscribe()};return v.subscribe(p.createOperatorSubscriber(f,function(P){S(function(N){N.window.next(P),m<=++N.seen&&E(N)})},function(){return w(function(P){return P.complete()})},function(P){return w(function(N){return N.error(P)})})),function(){b=null}})}return os.windowTime=r,os}var ls={},Pf;function I2(){if(Pf)return ls;Pf=1;var T=$&&$.__values||function(h){var _=typeof Symbol=="function"&&Symbol.iterator,d=_&&h[_],c=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&c>=h.length&&(h=void 0),{value:h&&h[c++],done:!h}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ls,"__esModule",{value:!0}),ls.windowToggle=void 0;var n=Ye(),g=at(),y=te(),p=_e(),t=ie(),i=He(),a=Ft();function r(h,_){return y.operate(function(d,c){var s=[],o=function(l){for(;0<s.length;)s.shift().error(l);c.error(l)};p.innerFrom(h).subscribe(t.createOperatorSubscriber(c,function(l){var m=new n.Subject;s.push(m);var v=new g.Subscription,f=function(){a.arrRemove(s,m),m.complete(),v.unsubscribe()},b;try{b=p.innerFrom(_(l))}catch(x){o(x);return}c.next(m.asObservable()),v.add(b.subscribe(t.createOperatorSubscriber(c,f,i.noop,o)))},i.noop)),d.subscribe(t.createOperatorSubscriber(c,function(l){var m,v,f=s.slice();try{for(var b=T(f),x=b.next();!x.done;x=b.next()){var E=x.value;E.next(l)}}catch(O){m={error:O}}finally{try{x&&!x.done&&(v=b.return)&&v.call(b)}finally{if(m)throw m.error}}},function(){for(;0<s.length;)s.shift().complete();c.complete()},o,function(){for(;0<s.length;)s.shift().unsubscribe()}))})}return ls.windowToggle=r,ls}var us={},wf;function F2(){if(wf)return us;wf=1,Object.defineProperty(us,"__esModule",{value:!0}),us.windowWhen=void 0;var T=Ye(),n=te(),g=ie(),y=_e();function p(t){return n.operate(function(i,a){var r,h,_=function(c){r.error(c),a.error(c)},d=function(){h==null||h.unsubscribe(),r==null||r.complete(),r=new T.Subject,a.next(r.asObservable());var c;try{c=y.innerFrom(t())}catch(s){_(s);return}c.subscribe(h=g.createOperatorSubscriber(a,d,d,_))};d(),i.subscribe(g.createOperatorSubscriber(a,function(c){return r.next(c)},function(){r.complete(),a.complete()},_,function(){h==null||h.unsubscribe(),r=null}))})}return us.windowWhen=p,us}var cs={},Lf;function C2(){if(Lf)return cs;Lf=1;var T=$&&$.__read||function(h,_){var d=typeof Symbol=="function"&&h[Symbol.iterator];if(!d)return h;var c=d.call(h),s,o=[],l;try{for(;(_===void 0||_-- >0)&&!(s=c.next()).done;)o.push(s.value)}catch(m){l={error:m}}finally{try{s&&!s.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}}return o},n=$&&$.__spreadArray||function(h,_){for(var d=0,c=_.length,s=h.length;d<c;d++,s++)h[s]=_[d];return h};Object.defineProperty(cs,"__esModule",{value:!0}),cs.withLatestFrom=void 0;var g=te(),y=ie(),p=_e(),t=Xe(),i=He(),a=rt();function r(){for(var h=[],_=0;_<arguments.length;_++)h[_]=arguments[_];var d=a.popResultSelector(h);return g.operate(function(c,s){for(var o=h.length,l=new Array(o),m=h.map(function(){return!1}),v=!1,f=function(x){p.innerFrom(h[x]).subscribe(y.createOperatorSubscriber(s,function(E){l[x]=E,!v&&!m[x]&&(m[x]=!0,(v=m.every(t.identity))&&(m=null))},i.noop))},b=0;b<o;b++)f(b);c.subscribe(y.createOperatorSubscriber(s,function(x){if(v){var E=n([x],T(l));s.next(d?d.apply(void 0,n([],T(E))):E)}}))})}return cs.withLatestFrom=r,cs}var hs={},Mf;function N2(){if(Mf)return hs;Mf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.zipAll=void 0;var T=wu(),n=S_();function g(y){return n.joinAllInternals(T.zip,y)}return hs.zipAll=g,hs}var ds={},fs={},If;function z2(){if(If)return fs;If=1;var T=$&&$.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var r=a.call(t),h,_=[],d;try{for(;(i===void 0||i-- >0)&&!(h=r.next()).done;)_.push(h.value)}catch(c){d={error:c}}finally{try{h&&!h.done&&(a=r.return)&&a.call(r)}finally{if(d)throw d.error}}return _},n=$&&$.__spreadArray||function(t,i){for(var a=0,r=i.length,h=t.length;a<r;a++,h++)t[h]=i[a];return t};Object.defineProperty(fs,"__esModule",{value:!0}),fs.zip=void 0;var g=wu(),y=te();function p(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return y.operate(function(a,r){g.zip.apply(void 0,n([a],T(t))).subscribe(r)})}return fs.zip=p,fs}var Ff;function B2(){if(Ff)return ds;Ff=1;var T=$&&$.__read||function(p,t){var i=typeof Symbol=="function"&&p[Symbol.iterator];if(!i)return p;var a=i.call(p),r,h=[],_;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)h.push(r.value)}catch(d){_={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(_)throw _.error}}return h},n=$&&$.__spreadArray||function(p,t){for(var i=0,a=t.length,r=p.length;i<a;i++,r++)p[r]=t[i];return p};Object.defineProperty(ds,"__esModule",{value:!0}),ds.zipWith=void 0;var g=z2();function y(){for(var p=[],t=0;t<arguments.length;t++)p[t]=arguments[t];return g.zip.apply(void 0,n([],T(p)))}return ds.zipWith=y,ds}var Cf;function j_(){return Cf||(Cf=1,function(T){var n=$&&$.__createBinding||(Object.create?function(Mt,It,ut,St){St===void 0&&(St=ut),Object.defineProperty(Mt,St,{enumerable:!0,get:function(){return It[ut]}})}:function(Mt,It,ut,St){St===void 0&&(St=ut),Mt[St]=It[ut]}),g=$&&$.__exportStar||function(Mt,It){for(var ut in Mt)ut!=="default"&&!Object.prototype.hasOwnProperty.call(It,ut)&&n(It,Mt,ut)};Object.defineProperty(T,"__esModule",{value:!0}),T.interval=T.iif=T.generate=T.fromEventPattern=T.fromEvent=T.from=T.forkJoin=T.empty=T.defer=T.connectable=T.concat=T.combineLatest=T.bindNodeCallback=T.bindCallback=T.UnsubscriptionError=T.TimeoutError=T.SequenceError=T.ObjectUnsubscribedError=T.NotFoundError=T.EmptyError=T.ArgumentOutOfRangeError=T.firstValueFrom=T.lastValueFrom=T.isObservable=T.identity=T.noop=T.pipe=T.NotificationKind=T.Notification=T.Subscriber=T.Subscription=T.Scheduler=T.VirtualAction=T.VirtualTimeScheduler=T.animationFrameScheduler=T.animationFrame=T.queueScheduler=T.queue=T.asyncScheduler=T.async=T.asapScheduler=T.asap=T.AsyncSubject=T.ReplaySubject=T.BehaviorSubject=T.Subject=T.animationFrames=T.observable=T.ConnectableObservable=T.Observable=void 0,T.filter=T.expand=T.exhaustMap=T.exhaustAll=T.exhaust=T.every=T.endWith=T.elementAt=T.distinctUntilKeyChanged=T.distinctUntilChanged=T.distinct=T.dematerialize=T.delayWhen=T.delay=T.defaultIfEmpty=T.debounceTime=T.debounce=T.count=T.connect=T.concatWith=T.concatMapTo=T.concatMap=T.concatAll=T.combineLatestWith=T.combineLatestAll=T.combineAll=T.catchError=T.bufferWhen=T.bufferToggle=T.bufferTime=T.bufferCount=T.buffer=T.auditTime=T.audit=T.config=T.NEVER=T.EMPTY=T.scheduled=T.zip=T.using=T.timer=T.throwError=T.range=T.race=T.partition=T.pairs=T.onErrorResumeNext=T.of=T.never=T.merge=void 0,T.switchMap=T.switchAll=T.subscribeOn=T.startWith=T.skipWhile=T.skipUntil=T.skipLast=T.skip=T.single=T.shareReplay=T.share=T.sequenceEqual=T.scan=T.sampleTime=T.sample=T.refCount=T.retryWhen=T.retry=T.repeatWhen=T.repeat=T.reduce=T.raceWith=T.publishReplay=T.publishLast=T.publishBehavior=T.publish=T.pluck=T.pairwise=T.onErrorResumeNextWith=T.observeOn=T.multicast=T.min=T.mergeWith=T.mergeScan=T.mergeMapTo=T.mergeMap=T.flatMap=T.mergeAll=T.max=T.materialize=T.mapTo=T.map=T.last=T.isEmpty=T.ignoreElements=T.groupBy=T.first=T.findIndex=T.find=T.finalize=void 0,T.zipWith=T.zipAll=T.withLatestFrom=T.windowWhen=T.windowToggle=T.windowTime=T.windowCount=T.window=T.toArray=T.timestamp=T.timeoutWith=T.timeout=T.timeInterval=T.throwIfEmpty=T.throttleTime=T.throttle=T.tap=T.takeWhile=T.takeUntil=T.takeLast=T.take=T.switchScan=T.switchMapTo=void 0;var y=xe();Object.defineProperty(T,"Observable",{enumerable:!0,get:function(){return y.Observable}});var p=ao();Object.defineProperty(T,"ConnectableObservable",{enumerable:!0,get:function(){return p.ConnectableObservable}});var t=io();Object.defineProperty(T,"observable",{enumerable:!0,get:function(){return t.observable}});var i=Pv();Object.defineProperty(T,"animationFrames",{enumerable:!0,get:function(){return i.animationFrames}});var a=Ye();Object.defineProperty(T,"Subject",{enumerable:!0,get:function(){return a.Subject}});var r=t_();Object.defineProperty(T,"BehaviorSubject",{enumerable:!0,get:function(){return r.BehaviorSubject}});var h=gu();Object.defineProperty(T,"ReplaySubject",{enumerable:!0,get:function(){return h.ReplaySubject}});var _=yu();Object.defineProperty(T,"AsyncSubject",{enumerable:!0,get:function(){return _.AsyncSubject}});var d=Nv();Object.defineProperty(T,"asap",{enumerable:!0,get:function(){return d.asap}}),Object.defineProperty(T,"asapScheduler",{enumerable:!0,get:function(){return d.asapScheduler}});var c=tt();Object.defineProperty(T,"async",{enumerable:!0,get:function(){return c.async}}),Object.defineProperty(T,"asyncScheduler",{enumerable:!0,get:function(){return c.asyncScheduler}});var s=Dv();Object.defineProperty(T,"queue",{enumerable:!0,get:function(){return s.queue}}),Object.defineProperty(T,"queueScheduler",{enumerable:!0,get:function(){return s.queueScheduler}});var o=Uv();Object.defineProperty(T,"animationFrame",{enumerable:!0,get:function(){return o.animationFrame}}),Object.defineProperty(T,"animationFrameScheduler",{enumerable:!0,get:function(){return o.animationFrameScheduler}});var l=Gv();Object.defineProperty(T,"VirtualTimeScheduler",{enumerable:!0,get:function(){return l.VirtualTimeScheduler}}),Object.defineProperty(T,"VirtualAction",{enumerable:!0,get:function(){return l.VirtualAction}});var m=r_();Object.defineProperty(T,"Scheduler",{enumerable:!0,get:function(){return m.Scheduler}});var v=at();Object.defineProperty(T,"Subscription",{enumerable:!0,get:function(){return v.Subscription}});var f=Es();Object.defineProperty(T,"Subscriber",{enumerable:!0,get:function(){return f.Subscriber}});var b=Au();Object.defineProperty(T,"Notification",{enumerable:!0,get:function(){return b.Notification}}),Object.defineProperty(T,"NotificationKind",{enumerable:!0,get:function(){return b.NotificationKind}});var x=no();Object.defineProperty(T,"pipe",{enumerable:!0,get:function(){return x.pipe}});var E=He();Object.defineProperty(T,"noop",{enumerable:!0,get:function(){return E.noop}});var O=Xe();Object.defineProperty(T,"identity",{enumerable:!0,get:function(){return O.identity}});var S=Hv();Object.defineProperty(T,"isObservable",{enumerable:!0,get:function(){return S.isObservable}});var w=Xv();Object.defineProperty(T,"lastValueFrom",{enumerable:!0,get:function(){return w.lastValueFrom}});var P=Yv();Object.defineProperty(T,"firstValueFrom",{enumerable:!0,get:function(){return P.firstValueFrom}});var N=f_();Object.defineProperty(T,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return N.ArgumentOutOfRangeError}});var k=or();Object.defineProperty(T,"EmptyError",{enumerable:!0,get:function(){return k.EmptyError}});var j=__();Object.defineProperty(T,"NotFoundError",{enumerable:!0,get:function(){return j.NotFoundError}});var U=e_();Object.defineProperty(T,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return U.ObjectUnsubscribedError}});var H=p_();Object.defineProperty(T,"SequenceError",{enumerable:!0,get:function(){return H.SequenceError}});var Z=_u();Object.defineProperty(T,"TimeoutError",{enumerable:!0,get:function(){return Z.TimeoutError}});var K=Yf();Object.defineProperty(T,"UnsubscriptionError",{enumerable:!0,get:function(){return K.UnsubscriptionError}});var ee=Zv();Object.defineProperty(T,"bindCallback",{enumerable:!0,get:function(){return ee.bindCallback}});var re=Kv();Object.defineProperty(T,"bindNodeCallback",{enumerable:!0,get:function(){return re.bindNodeCallback}});var J=Ou();Object.defineProperty(T,"combineLatest",{enumerable:!0,get:function(){return J.combineLatest}});var ne=co();Object.defineProperty(T,"concat",{enumerable:!0,get:function(){return ne.concat}});var he=Qv();Object.defineProperty(T,"connectable",{enumerable:!0,get:function(){return he.connectable}});var fe=ho();Object.defineProperty(T,"defer",{enumerable:!0,get:function(){return fe.defer}});var be=yt();Object.defineProperty(T,"empty",{enumerable:!0,get:function(){return be.empty}});var Ae=Jv();Object.defineProperty(T,"forkJoin",{enumerable:!0,get:function(){return Ae.forkJoin}});var Ce=Nt();Object.defineProperty(T,"from",{enumerable:!0,get:function(){return Ce.from}});var oe=em();Object.defineProperty(T,"fromEvent",{enumerable:!0,get:function(){return oe.fromEvent}});var Re=tm();Object.defineProperty(T,"fromEventPattern",{enumerable:!0,get:function(){return Re.fromEventPattern}});var Be=rm();Object.defineProperty(T,"generate",{enumerable:!0,get:function(){return Be.generate}});var st=im();Object.defineProperty(T,"iif",{enumerable:!0,get:function(){return st.iif}});var Je=g_();Object.defineProperty(T,"interval",{enumerable:!0,get:function(){return Je.interval}});var Ve=nm();Object.defineProperty(T,"merge",{enumerable:!0,get:function(){return Ve.merge}});var $e=Ad();Object.defineProperty(T,"never",{enumerable:!0,get:function(){return $e.never}});var it=xu();Object.defineProperty(T,"of",{enumerable:!0,get:function(){return it.of}});var Bt=y_();Object.defineProperty(T,"onErrorResumeNext",{enumerable:!0,get:function(){return Bt.onErrorResumeNext}});var ot=am();Object.defineProperty(T,"pairs",{enumerable:!0,get:function(){return ot.pairs}});var Tt=om();Object.defineProperty(T,"partition",{enumerable:!0,get:function(){return Tt.partition}});var xt=E_();Object.defineProperty(T,"race",{enumerable:!0,get:function(){return xt.race}});var mt=lm();Object.defineProperty(T,"range",{enumerable:!0,get:function(){return mt.range}});var Dt=d_();Object.defineProperty(T,"throwError",{enumerable:!0,get:function(){return Dt.throwError}});var Sr=cr();Object.defineProperty(T,"timer",{enumerable:!0,get:function(){return Sr.timer}});var At=um();Object.defineProperty(T,"using",{enumerable:!0,get:function(){return At.using}});var dr=wu();Object.defineProperty(T,"zip",{enumerable:!0,get:function(){return dr.zip}});var Or=h_();Object.defineProperty(T,"scheduled",{enumerable:!0,get:function(){return Or.scheduled}});var Rr=yt();Object.defineProperty(T,"EMPTY",{enumerable:!0,get:function(){return Rr.EMPTY}});var fr=Ad();Object.defineProperty(T,"NEVER",{enumerable:!0,get:function(){return fr.NEVER}}),g(cm(),T);var Pr=ys();Object.defineProperty(T,"config",{enumerable:!0,get:function(){return Pr.config}});var wr=T_();Object.defineProperty(T,"audit",{enumerable:!0,get:function(){return wr.audit}});var Lr=hm();Object.defineProperty(T,"auditTime",{enumerable:!0,get:function(){return Lr.auditTime}});var _r=dm();Object.defineProperty(T,"buffer",{enumerable:!0,get:function(){return _r.buffer}});var Mr=fm();Object.defineProperty(T,"bufferCount",{enumerable:!0,get:function(){return Mr.bufferCount}});var Ir=_m();Object.defineProperty(T,"bufferTime",{enumerable:!0,get:function(){return Ir.bufferTime}});var pr=pm();Object.defineProperty(T,"bufferToggle",{enumerable:!0,get:function(){return pr.bufferToggle}});var Fr=vm();Object.defineProperty(T,"bufferWhen",{enumerable:!0,get:function(){return Fr.bufferWhen}});var jt=mm();Object.defineProperty(T,"catchError",{enumerable:!0,get:function(){return jt.catchError}});var Lt=bm();Object.defineProperty(T,"combineAll",{enumerable:!0,get:function(){return Lt.combineAll}});var Cr=O_();Object.defineProperty(T,"combineLatestAll",{enumerable:!0,get:function(){return Cr.combineLatestAll}});var Nr=ym();Object.defineProperty(T,"combineLatestWith",{enumerable:!0,get:function(){return Nr.combineLatestWith}});var zr=Pu();Object.defineProperty(T,"concatAll",{enumerable:!0,get:function(){return zr.concatAll}});var Pe=R_();Object.defineProperty(T,"concatMap",{enumerable:!0,get:function(){return Pe.concatMap}});var De=Em();Object.defineProperty(T,"concatMapTo",{enumerable:!0,get:function(){return De.concatMapTo}});var ke=xm();Object.defineProperty(T,"concatWith",{enumerable:!0,get:function(){return ke.concatWith}});var lt=Lu();Object.defineProperty(T,"connect",{enumerable:!0,get:function(){return lt.connect}});var bt=Sm();Object.defineProperty(T,"count",{enumerable:!0,get:function(){return bt.count}});var mo=Om();Object.defineProperty(T,"debounce",{enumerable:!0,get:function(){return mo.debounce}});var bo=Rm();Object.defineProperty(T,"debounceTime",{enumerable:!0,get:function(){return bo.debounceTime}});var go=fo();Object.defineProperty(T,"defaultIfEmpty",{enumerable:!0,get:function(){return go.defaultIfEmpty}});var yo=Pm();Object.defineProperty(T,"delay",{enumerable:!0,get:function(){return yo.delay}});var Eo=L_();Object.defineProperty(T,"delayWhen",{enumerable:!0,get:function(){return Eo.delayWhen}});var To=wm();Object.defineProperty(T,"dematerialize",{enumerable:!0,get:function(){return To.dematerialize}});var Ps=Lm();Object.defineProperty(T,"distinct",{enumerable:!0,get:function(){return Ps.distinct}});var xo=M_();Object.defineProperty(T,"distinctUntilChanged",{enumerable:!0,get:function(){return xo.distinctUntilChanged}});var Ao=Mm();Object.defineProperty(T,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Ao.distinctUntilKeyChanged}});var So=Im();Object.defineProperty(T,"elementAt",{enumerable:!0,get:function(){return So.elementAt}});var Oo=Fm();Object.defineProperty(T,"endWith",{enumerable:!0,get:function(){return Oo.endWith}});var Ro=Cm();Object.defineProperty(T,"every",{enumerable:!0,get:function(){return Ro.every}});var Po=Nm();Object.defineProperty(T,"exhaust",{enumerable:!0,get:function(){return Po.exhaust}});var wo=F_();Object.defineProperty(T,"exhaustAll",{enumerable:!0,get:function(){return wo.exhaustAll}});var Lo=I_();Object.defineProperty(T,"exhaustMap",{enumerable:!0,get:function(){return Lo.exhaustMap}});var Mo=zm();Object.defineProperty(T,"expand",{enumerable:!0,get:function(){return Mo.expand}});var Io=yr();Object.defineProperty(T,"filter",{enumerable:!0,get:function(){return Io.filter}});var Fo=Bm();Object.defineProperty(T,"finalize",{enumerable:!0,get:function(){return Fo.finalize}});var Co=C_();Object.defineProperty(T,"find",{enumerable:!0,get:function(){return Co.find}});var No=Dm();Object.defineProperty(T,"findIndex",{enumerable:!0,get:function(){return No.findIndex}});var ws=jm();Object.defineProperty(T,"first",{enumerable:!0,get:function(){return ws.first}});var zo=km();Object.defineProperty(T,"groupBy",{enumerable:!0,get:function(){return zo.groupBy}});var Bo=P_();Object.defineProperty(T,"ignoreElements",{enumerable:!0,get:function(){return Bo.ignoreElements}});var Do=Um();Object.defineProperty(T,"isEmpty",{enumerable:!0,get:function(){return Do.isEmpty}});var jo=Gm();Object.defineProperty(T,"last",{enumerable:!0,get:function(){return jo.last}});var ko=lr();Object.defineProperty(T,"map",{enumerable:!0,get:function(){return ko.map}});var Uo=w_();Object.defineProperty(T,"mapTo",{enumerable:!0,get:function(){return Uo.mapTo}});var Go=qm();Object.defineProperty(T,"materialize",{enumerable:!0,get:function(){return Go.materialize}});var qo=Wm();Object.defineProperty(T,"max",{enumerable:!0,get:function(){return qo.max}});var Wo=uo();Object.defineProperty(T,"mergeAll",{enumerable:!0,get:function(){return Wo.mergeAll}});var Vo=Vm();Object.defineProperty(T,"flatMap",{enumerable:!0,get:function(){return Vo.flatMap}});var $o=zt();Object.defineProperty(T,"mergeMap",{enumerable:!0,get:function(){return $o.mergeMap}});var Ls=$m();Object.defineProperty(T,"mergeMapTo",{enumerable:!0,get:function(){return Ls.mergeMapTo}});var Ho=Hm();Object.defineProperty(T,"mergeScan",{enumerable:!0,get:function(){return Ho.mergeScan}});var Xo=Ym();Object.defineProperty(T,"mergeWith",{enumerable:!0,get:function(){return Xo.mergeWith}});var Yo=Zm();Object.defineProperty(T,"min",{enumerable:!0,get:function(){return Yo.min}});var Zo=Mu();Object.defineProperty(T,"multicast",{enumerable:!0,get:function(){return Zo.multicast}});var Ms=oo();Object.defineProperty(T,"observeOn",{enumerable:!0,get:function(){return Ms.observeOn}});var Ko=Km();Object.defineProperty(T,"onErrorResumeNextWith",{enumerable:!0,get:function(){return Ko.onErrorResumeNextWith}});var Qo=Qm();Object.defineProperty(T,"pairwise",{enumerable:!0,get:function(){return Qo.pairwise}});var Jo=Jm();Object.defineProperty(T,"pluck",{enumerable:!0,get:function(){return Jo.pluck}});var el=e2();Object.defineProperty(T,"publish",{enumerable:!0,get:function(){return el.publish}});var tl=t2();Object.defineProperty(T,"publishBehavior",{enumerable:!0,get:function(){return tl.publishBehavior}});var rl=r2();Object.defineProperty(T,"publishLast",{enumerable:!0,get:function(){return rl.publishLast}});var il=i2();Object.defineProperty(T,"publishReplay",{enumerable:!0,get:function(){return il.publishReplay}});var nl=n2();Object.defineProperty(T,"raceWith",{enumerable:!0,get:function(){return nl.raceWith}});var al=As();Object.defineProperty(T,"reduce",{enumerable:!0,get:function(){return al.reduce}});var sl=a2();Object.defineProperty(T,"repeat",{enumerable:!0,get:function(){return sl.repeat}});var ol=s2();Object.defineProperty(T,"repeatWhen",{enumerable:!0,get:function(){return ol.repeatWhen}});var ll=o2();Object.defineProperty(T,"retry",{enumerable:!0,get:function(){return ll.retry}});var Is=l2();Object.defineProperty(T,"retryWhen",{enumerable:!0,get:function(){return Is.retryWhen}});var ul=Qf();Object.defineProperty(T,"refCount",{enumerable:!0,get:function(){return ul.refCount}});var Fs=z_();Object.defineProperty(T,"sample",{enumerable:!0,get:function(){return Fs.sample}});var Cs=u2();Object.defineProperty(T,"sampleTime",{enumerable:!0,get:function(){return Cs.sampleTime}});var Ns=c2();Object.defineProperty(T,"scan",{enumerable:!0,get:function(){return Ns.scan}});var cl=h2();Object.defineProperty(T,"sequenceEqual",{enumerable:!0,get:function(){return cl.sequenceEqual}});var hl=B_();Object.defineProperty(T,"share",{enumerable:!0,get:function(){return hl.share}});var dl=d2();Object.defineProperty(T,"shareReplay",{enumerable:!0,get:function(){return dl.shareReplay}});var fl=f2();Object.defineProperty(T,"single",{enumerable:!0,get:function(){return fl.single}});var zs=_2();Object.defineProperty(T,"skip",{enumerable:!0,get:function(){return zs.skip}});var _l=p2();Object.defineProperty(T,"skipLast",{enumerable:!0,get:function(){return _l.skipLast}});var pl=v2();Object.defineProperty(T,"skipUntil",{enumerable:!0,get:function(){return pl.skipUntil}});var vl=m2();Object.defineProperty(T,"skipWhile",{enumerable:!0,get:function(){return vl.skipWhile}});var Bs=b2();Object.defineProperty(T,"startWith",{enumerable:!0,get:function(){return Bs.startWith}});var ml=lo();Object.defineProperty(T,"subscribeOn",{enumerable:!0,get:function(){return ml.subscribeOn}});var bl=g2();Object.defineProperty(T,"switchAll",{enumerable:!0,get:function(){return bl.switchAll}});var gl=vo();Object.defineProperty(T,"switchMap",{enumerable:!0,get:function(){return gl.switchMap}});var yl=y2();Object.defineProperty(T,"switchMapTo",{enumerable:!0,get:function(){return yl.switchMapTo}});var El=E2();Object.defineProperty(T,"switchScan",{enumerable:!0,get:function(){return El.switchScan}});var Tl=_o();Object.defineProperty(T,"take",{enumerable:!0,get:function(){return Tl.take}});var xl=N_();Object.defineProperty(T,"takeLast",{enumerable:!0,get:function(){return xl.takeLast}});var Ds=T2();Object.defineProperty(T,"takeUntil",{enumerable:!0,get:function(){return Ds.takeUntil}});var Al=x2();Object.defineProperty(T,"takeWhile",{enumerable:!0,get:function(){return Al.takeWhile}});var Sl=A2();Object.defineProperty(T,"tap",{enumerable:!0,get:function(){return Sl.tap}});var Ol=D_();Object.defineProperty(T,"throttle",{enumerable:!0,get:function(){return Ol.throttle}});var Rl=S2();Object.defineProperty(T,"throttleTime",{enumerable:!0,get:function(){return Rl.throttleTime}});var Pl=po();Object.defineProperty(T,"throwIfEmpty",{enumerable:!0,get:function(){return Pl.throwIfEmpty}});var wl=O2();Object.defineProperty(T,"timeInterval",{enumerable:!0,get:function(){return wl.timeInterval}});var Br=_u();Object.defineProperty(T,"timeout",{enumerable:!0,get:function(){return Br.timeout}});var Ll=R2();Object.defineProperty(T,"timeoutWith",{enumerable:!0,get:function(){return Ll.timeoutWith}});var js=P2();Object.defineProperty(T,"timestamp",{enumerable:!0,get:function(){return js.timestamp}});var Dr=A_();Object.defineProperty(T,"toArray",{enumerable:!0,get:function(){return Dr.toArray}});var Ml=w2();Object.defineProperty(T,"window",{enumerable:!0,get:function(){return Ml.window}});var Il=L2();Object.defineProperty(T,"windowCount",{enumerable:!0,get:function(){return Il.windowCount}});var Fl=M2();Object.defineProperty(T,"windowTime",{enumerable:!0,get:function(){return Fl.windowTime}});var ks=I2();Object.defineProperty(T,"windowToggle",{enumerable:!0,get:function(){return ks.windowToggle}});var Us=F2();Object.defineProperty(T,"windowWhen",{enumerable:!0,get:function(){return Us.windowWhen}});var Gs=C2();Object.defineProperty(T,"withLatestFrom",{enumerable:!0,get:function(){return Gs.withLatestFrom}});var Cl=N2();Object.defineProperty(T,"zipAll",{enumerable:!0,get:function(){return Cl.zipAll}});var Nl=B2();Object.defineProperty(T,"zipWith",{enumerable:!0,get:function(){return Nl.zipWith}})}($l)),$l}(()=>{var T={3557:(p,t,i)=>{i.r(t),i.d(t,{glMatrix:()=>a,mat2:()=>r,mat2d:()=>h,mat3:()=>_,mat4:()=>d,quat:()=>o,quat2:()=>l,vec2:()=>m,vec3:()=>c,vec4:()=>s});var a={};i.r(a),i.d(a,{ARRAY_TYPE:()=>f,EPSILON:()=>v,RANDOM:()=>b,equals:()=>S,setMatrixArrayType:()=>x,toRadian:()=>O});var r={};i.r(r),i.d(r,{LDU:()=>Ce,add:()=>oe,adjoint:()=>K,clone:()=>P,copy:()=>N,create:()=>w,determinant:()=>ee,equals:()=>st,exactEquals:()=>Be,frob:()=>Ae,fromRotation:()=>he,fromScaling:()=>fe,fromValues:()=>j,identity:()=>k,invert:()=>Z,mul:()=>$e,multiply:()=>re,multiplyScalar:()=>Je,multiplyScalarAndAdd:()=>Ve,rotate:()=>J,scale:()=>ne,set:()=>U,str:()=>be,sub:()=>it,subtract:()=>Re,transpose:()=>H});var h={};i.r(h),i.d(h,{add:()=>Ir,clone:()=>ot,copy:()=>Tt,create:()=>Bt,determinant:()=>At,equals:()=>Cr,exactEquals:()=>Lt,frob:()=>Mr,fromRotation:()=>Pr,fromScaling:()=>wr,fromTranslation:()=>Lr,fromValues:()=>mt,identity:()=>xt,invert:()=>Sr,mul:()=>Nr,multiply:()=>dr,multiplyScalar:()=>Fr,multiplyScalarAndAdd:()=>jt,rotate:()=>Or,scale:()=>Rr,set:()=>Dt,str:()=>_r,sub:()=>zr,subtract:()=>pr,translate:()=>fr});var _={};i.r(_),i.d(_,{add:()=>No,adjoint:()=>Eo,clone:()=>ke,copy:()=>lt,create:()=>Pe,determinant:()=>To,equals:()=>jo,exactEquals:()=>Do,frob:()=>Co,fromMat2d:()=>wo,fromMat4:()=>De,fromQuat:()=>Lo,fromRotation:()=>Ro,fromScaling:()=>Po,fromTranslation:()=>Oo,fromValues:()=>bt,identity:()=>bo,invert:()=>yo,mul:()=>ko,multiply:()=>Ps,multiplyScalar:()=>zo,multiplyScalarAndAdd:()=>Bo,normalFromMat4:()=>Mo,projection:()=>Io,rotate:()=>Ao,scale:()=>So,set:()=>mo,str:()=>Fo,sub:()=>Uo,subtract:()=>ws,translate:()=>xo,transpose:()=>go});var d={};i.r(d),i.d(d,{add:()=>xl,adjoint:()=>Yo,clone:()=>qo,copy:()=>Wo,create:()=>Go,determinant:()=>Zo,equals:()=>Rl,exactEquals:()=>Ol,frob:()=>Tl,fromQuat:()=>dl,fromQuat2:()=>ul,fromRotation:()=>al,fromRotationTranslation:()=>Is,fromRotationTranslationScale:()=>cl,fromRotationTranslationScaleOrigin:()=>hl,fromScaling:()=>nl,fromTranslation:()=>il,fromValues:()=>Vo,fromXRotation:()=>sl,fromYRotation:()=>ol,fromZRotation:()=>ll,frustum:()=>fl,getRotation:()=>Ns,getScaling:()=>Cs,getTranslation:()=>Fs,identity:()=>Ls,invert:()=>Xo,lookAt:()=>gl,mul:()=>Pl,multiply:()=>Ms,multiplyScalar:()=>Al,multiplyScalarAndAdd:()=>Sl,ortho:()=>ml,orthoNO:()=>Bs,orthoZO:()=>bl,perspective:()=>_l,perspectiveFromFieldOfView:()=>vl,perspectiveNO:()=>zs,perspectiveZO:()=>pl,rotate:()=>Jo,rotateX:()=>el,rotateY:()=>tl,rotateZ:()=>rl,scale:()=>Qo,set:()=>$o,str:()=>El,sub:()=>wl,subtract:()=>Ds,targetTo:()=>yl,translate:()=>Ko,transpose:()=>Ho});var c={};i.r(c),i.d(c,{add:()=>Fl,angle:()=>a1,bezier:()=>K_,ceil:()=>Cl,clone:()=>Ll,copy:()=>Ml,create:()=>Br,cross:()=>qs,dist:()=>f1,distance:()=>Iu,div:()=>d1,divide:()=>Gs,dot:()=>zl,equals:()=>u1,exactEquals:()=>l1,floor:()=>Nl,forEach:()=>v1,fromValues:()=>Dr,hermite:()=>Z_,inverse:()=>X_,len:()=>zu,length:()=>js,lerp:()=>Y_,max:()=>It,min:()=>Mt,mul:()=>h1,multiply:()=>Us,negate:()=>H_,normalize:()=>Nu,random:()=>Q_,rotateX:()=>r1,rotateY:()=>i1,rotateZ:()=>n1,round:()=>ut,scale:()=>St,scaleAndAdd:()=>$_,set:()=>Il,sqrDist:()=>_1,sqrLen:()=>p1,squaredDistance:()=>Fu,squaredLength:()=>Cu,str:()=>o1,sub:()=>c1,subtract:()=>ks,transformMat3:()=>e1,transformMat4:()=>J_,transformQuat:()=>t1,zero:()=>s1});var s={};i.r(s),i.d(s,{add:()=>Gu,ceil:()=>m1,clone:()=>Du,copy:()=>ku,create:()=>Bu,cross:()=>S1,dist:()=>C1,distance:()=>Hu,div:()=>F1,divide:()=>Vu,dot:()=>Zu,equals:()=>Ju,exactEquals:()=>Qu,floor:()=>b1,forEach:()=>D1,fromValues:()=>ju,inverse:()=>A1,len:()=>z1,length:()=>Bl,lerp:()=>Ku,max:()=>y1,min:()=>g1,mul:()=>I1,multiply:()=>Wu,negate:()=>x1,normalize:()=>Yu,random:()=>O1,round:()=>E1,scale:()=>$u,scaleAndAdd:()=>T1,set:()=>Uu,sqrDist:()=>N1,sqrLen:()=>B1,squaredDistance:()=>Xu,squaredLength:()=>Dl,str:()=>L1,sub:()=>M1,subtract:()=>qu,transformMat4:()=>R1,transformQuat:()=>P1,zero:()=>w1});var o={};i.r(o),i.d(o,{add:()=>Q1,calculateW:()=>G1,clone:()=>Y1,conjugate:()=>$1,copy:()=>Ul,create:()=>Ws,dot:()=>Gl,equals:()=>np,exactEquals:()=>ip,exp:()=>ac,fromEuler:()=>H1,fromMat3:()=>oc,fromValues:()=>Z1,getAngle:()=>U1,getAxisAngle:()=>k1,identity:()=>j1,invert:()=>V1,len:()=>tp,length:()=>ql,lerp:()=>ep,ln:()=>sc,mul:()=>J1,multiply:()=>tc,normalize:()=>Vl,pow:()=>q1,random:()=>W1,rotateX:()=>rc,rotateY:()=>ic,rotateZ:()=>nc,rotationTo:()=>ap,scale:()=>cc,set:()=>K1,setAxes:()=>op,setAxisAngle:()=>ec,slerp:()=>Vs,sqlerp:()=>sp,sqrLen:()=>rp,squaredLength:()=>Wl,str:()=>X1});var l={};i.r(l),i.d(l,{add:()=>wp,clone:()=>up,conjugate:()=>Cp,copy:()=>dc,create:()=>lp,dot:()=>_c,equals:()=>kp,exactEquals:()=>jp,fromMat4:()=>_p,fromRotation:()=>fp,fromRotationTranslation:()=>hc,fromRotationTranslationValues:()=>hp,fromTranslation:()=>dp,fromValues:()=>cp,getDual:()=>bp,getReal:()=>mp,getTranslation:()=>Ep,identity:()=>pp,invert:()=>Fp,len:()=>Np,length:()=>pc,lerp:()=>Ip,mul:()=>Lp,multiply:()=>fc,normalize:()=>Bp,rotateAroundAxis:()=>Pp,rotateByQuatAppend:()=>Op,rotateByQuatPrepend:()=>Rp,rotateX:()=>xp,rotateY:()=>Ap,rotateZ:()=>Sp,scale:()=>Mp,set:()=>vp,setDual:()=>yp,setReal:()=>gp,sqrLen:()=>zp,squaredLength:()=>$s,str:()=>Dp,translate:()=>Tp});var m={};i.r(m),i.d(m,{add:()=>Vp,angle:()=>hv,ceil:()=>$p,clone:()=>Up,copy:()=>qp,create:()=>vc,cross:()=>iv,dist:()=>yv,distance:()=>yc,div:()=>gv,divide:()=>gc,dot:()=>rv,equals:()=>pv,exactEquals:()=>_v,floor:()=>Hp,forEach:()=>xv,fromValues:()=>Gp,inverse:()=>ev,len:()=>vv,length:()=>Tc,lerp:()=>nv,max:()=>Yp,min:()=>Xp,mul:()=>bv,multiply:()=>bc,negate:()=>Jp,normalize:()=>tv,random:()=>av,rotate:()=>cv,round:()=>Zp,scale:()=>Kp,scaleAndAdd:()=>Qp,set:()=>Wp,sqrDist:()=>Ev,sqrLen:()=>Tv,squaredDistance:()=>Ec,squaredLength:()=>xc,str:()=>fv,sub:()=>mv,subtract:()=>mc,transformMat2:()=>sv,transformMat2d:()=>ov,transformMat3:()=>lv,transformMat4:()=>uv,zero:()=>dv});var v=1e-6,f=typeof Float32Array<"u"?Float32Array:Array,b=Math.random;function x(e){f=e}var E=Math.PI/180;function O(e){return e*E}function S(e,u){return Math.abs(e-u)<=v*Math.max(1,Math.abs(e),Math.abs(u))}function w(){var e=new f(4);return f!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function P(e){var u=new f(4);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u}function N(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e}function k(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function j(e,u,A,R){var L=new f(4);return L[0]=e,L[1]=u,L[2]=A,L[3]=R,L}function U(e,u,A,R,L){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e}function H(e,u){if(e===u){var A=u[1];e[1]=u[2],e[2]=A}else e[0]=u[0],e[1]=u[2],e[2]=u[1],e[3]=u[3];return e}function Z(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=A*M-L*R;return I?(I=1/I,e[0]=M*I,e[1]=-R*I,e[2]=-L*I,e[3]=A*I,e):null}function K(e,u){var A=u[0];return e[0]=u[3],e[1]=-u[1],e[2]=-u[2],e[3]=A,e}function ee(e){return e[0]*e[3]-e[2]*e[1]}function re(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=A[0],z=A[1],B=A[2],D=A[3];return e[0]=R*F+M*z,e[1]=L*F+I*z,e[2]=R*B+M*D,e[3]=L*B+I*D,e}function J(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=Math.sin(A),z=Math.cos(A);return e[0]=R*z+M*F,e[1]=L*z+I*F,e[2]=R*-F+M*z,e[3]=L*-F+I*z,e}function ne(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=A[0],z=A[1];return e[0]=R*F,e[1]=L*F,e[2]=M*z,e[3]=I*z,e}function he(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=R,e[1]=A,e[2]=-A,e[3]=R,e}function fe(e,u){return e[0]=u[0],e[1]=0,e[2]=0,e[3]=u[1],e}function be(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ae(e){return Math.hypot(e[0],e[1],e[2],e[3])}function Ce(e,u,A,R){return e[2]=R[2]/R[0],A[0]=R[0],A[1]=R[1],A[3]=R[3]-e[2]*A[1],[e,u,A]}function oe(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e}function Re(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e[3]=u[3]-A[3],e}function Be(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]}function st(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=u[0],F=u[1],z=u[2],B=u[3];return Math.abs(A-I)<=v*Math.max(1,Math.abs(A),Math.abs(I))&&Math.abs(R-F)<=v*Math.max(1,Math.abs(R),Math.abs(F))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}function Je(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e}function Ve(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e[3]=u[3]+A[3]*R,e}Math.hypot||(Math.hypot=function(){for(var e=0,u=arguments.length;u--;)e+=arguments[u]*arguments[u];return Math.sqrt(e)});var $e=re,it=Re;function Bt(){var e=new f(6);return f!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function ot(e){var u=new f(6);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u[4]=e[4],u[5]=e[5],u}function Tt(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[4]=u[4],e[5]=u[5],e}function xt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function mt(e,u,A,R,L,M){var I=new f(6);return I[0]=e,I[1]=u,I[2]=A,I[3]=R,I[4]=L,I[5]=M,I}function Dt(e,u,A,R,L,M,I){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e[4]=M,e[5]=I,e}function Sr(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=A*M-R*L;return z?(z=1/z,e[0]=M*z,e[1]=-R*z,e[2]=-L*z,e[3]=A*z,e[4]=(L*F-M*I)*z,e[5]=(R*I-A*F)*z,e):null}function At(e){return e[0]*e[3]-e[1]*e[2]}function dr(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=A[0],D=A[1],G=A[2],q=A[3],W=A[4],X=A[5];return e[0]=R*B+M*D,e[1]=L*B+I*D,e[2]=R*G+M*q,e[3]=L*G+I*q,e[4]=R*W+M*X+F,e[5]=L*W+I*X+z,e}function Or(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=Math.sin(A),D=Math.cos(A);return e[0]=R*D+M*B,e[1]=L*D+I*B,e[2]=R*-B+M*D,e[3]=L*-B+I*D,e[4]=F,e[5]=z,e}function Rr(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=A[0],D=A[1];return e[0]=R*B,e[1]=L*B,e[2]=M*D,e[3]=I*D,e[4]=F,e[5]=z,e}function fr(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=A[0],D=A[1];return e[0]=R,e[1]=L,e[2]=M,e[3]=I,e[4]=R*B+M*D+F,e[5]=L*B+I*D+z,e}function Pr(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=R,e[1]=A,e[2]=-A,e[3]=R,e[4]=0,e[5]=0,e}function wr(e,u){return e[0]=u[0],e[1]=0,e[2]=0,e[3]=u[1],e[4]=0,e[5]=0,e}function Lr(e,u){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=u[0],e[5]=u[1],e}function _r(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function Mr(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function Ir(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e[4]=u[4]+A[4],e[5]=u[5]+A[5],e}function pr(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e[3]=u[3]-A[3],e[4]=u[4]-A[4],e[5]=u[5]-A[5],e}function Fr(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e[4]=u[4]*A,e[5]=u[5]*A,e}function jt(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e[3]=u[3]+A[3]*R,e[4]=u[4]+A[4]*R,e[5]=u[5]+A[5]*R,e}function Lt(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]&&e[4]===u[4]&&e[5]===u[5]}function Cr(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=u[0],B=u[1],D=u[2],G=u[3],q=u[4],W=u[5];return Math.abs(A-z)<=v*Math.max(1,Math.abs(A),Math.abs(z))&&Math.abs(R-B)<=v*Math.max(1,Math.abs(R),Math.abs(B))&&Math.abs(L-D)<=v*Math.max(1,Math.abs(L),Math.abs(D))&&Math.abs(M-G)<=v*Math.max(1,Math.abs(M),Math.abs(G))&&Math.abs(I-q)<=v*Math.max(1,Math.abs(I),Math.abs(q))&&Math.abs(F-W)<=v*Math.max(1,Math.abs(F),Math.abs(W))}var Nr=dr,zr=pr;function Pe(){var e=new f(9);return f!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function De(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[4],e[4]=u[5],e[5]=u[6],e[6]=u[8],e[7]=u[9],e[8]=u[10],e}function ke(e){var u=new f(9);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u[4]=e[4],u[5]=e[5],u[6]=e[6],u[7]=e[7],u[8]=e[8],u}function lt(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[4]=u[4],e[5]=u[5],e[6]=u[6],e[7]=u[7],e[8]=u[8],e}function bt(e,u,A,R,L,M,I,F,z){var B=new f(9);return B[0]=e,B[1]=u,B[2]=A,B[3]=R,B[4]=L,B[5]=M,B[6]=I,B[7]=F,B[8]=z,B}function mo(e,u,A,R,L,M,I,F,z,B){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e[8]=B,e}function bo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function go(e,u){if(e===u){var A=u[1],R=u[2],L=u[5];e[1]=u[3],e[2]=u[6],e[3]=A,e[5]=u[7],e[6]=R,e[7]=L}else e[0]=u[0],e[1]=u[3],e[2]=u[6],e[3]=u[1],e[4]=u[4],e[5]=u[7],e[6]=u[2],e[7]=u[5],e[8]=u[8];return e}function yo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=u[6],B=u[7],D=u[8],G=D*I-F*B,q=-D*M+F*z,W=B*M-I*z,X=A*G+R*q+L*W;return X?(X=1/X,e[0]=G*X,e[1]=(-D*R+L*B)*X,e[2]=(F*R-L*I)*X,e[3]=q*X,e[4]=(D*A-L*z)*X,e[5]=(-F*A+L*M)*X,e[6]=W*X,e[7]=(-B*A+R*z)*X,e[8]=(I*A-R*M)*X,e):null}function Eo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=u[6],B=u[7],D=u[8];return e[0]=I*D-F*B,e[1]=L*B-R*D,e[2]=R*F-L*I,e[3]=F*z-M*D,e[4]=A*D-L*z,e[5]=L*M-A*F,e[6]=M*B-I*z,e[7]=R*z-A*B,e[8]=A*I-R*M,e}function To(e){var u=e[0],A=e[1],R=e[2],L=e[3],M=e[4],I=e[5],F=e[6],z=e[7],B=e[8];return u*(B*M-I*z)+A*(-B*L+I*F)+R*(z*L-M*F)}function Ps(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=u[8],q=A[0],W=A[1],X=A[2],Y=A[3],V=A[4],Q=A[5],le=A[6],ae=A[7],se=A[8];return e[0]=q*R+W*I+X*B,e[1]=q*L+W*F+X*D,e[2]=q*M+W*z+X*G,e[3]=Y*R+V*I+Q*B,e[4]=Y*L+V*F+Q*D,e[5]=Y*M+V*z+Q*G,e[6]=le*R+ae*I+se*B,e[7]=le*L+ae*F+se*D,e[8]=le*M+ae*z+se*G,e}function xo(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=u[8],q=A[0],W=A[1];return e[0]=R,e[1]=L,e[2]=M,e[3]=I,e[4]=F,e[5]=z,e[6]=q*R+W*I+B,e[7]=q*L+W*F+D,e[8]=q*M+W*z+G,e}function Ao(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=u[8],q=Math.sin(A),W=Math.cos(A);return e[0]=W*R+q*I,e[1]=W*L+q*F,e[2]=W*M+q*z,e[3]=W*I-q*R,e[4]=W*F-q*L,e[5]=W*z-q*M,e[6]=B,e[7]=D,e[8]=G,e}function So(e,u,A){var R=A[0],L=A[1];return e[0]=R*u[0],e[1]=R*u[1],e[2]=R*u[2],e[3]=L*u[3],e[4]=L*u[4],e[5]=L*u[5],e[6]=u[6],e[7]=u[7],e[8]=u[8],e}function Oo(e,u){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=u[0],e[7]=u[1],e[8]=1,e}function Ro(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=R,e[1]=A,e[2]=0,e[3]=-A,e[4]=R,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Po(e,u){return e[0]=u[0],e[1]=0,e[2]=0,e[3]=0,e[4]=u[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function wo(e,u){return e[0]=u[0],e[1]=u[1],e[2]=0,e[3]=u[2],e[4]=u[3],e[5]=0,e[6]=u[4],e[7]=u[5],e[8]=1,e}function Lo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=A+A,F=R+R,z=L+L,B=A*I,D=R*I,G=R*F,q=L*I,W=L*F,X=L*z,Y=M*I,V=M*F,Q=M*z;return e[0]=1-G-X,e[3]=D-Q,e[6]=q+V,e[1]=D+Q,e[4]=1-B-X,e[7]=W-Y,e[2]=q-V,e[5]=W+Y,e[8]=1-B-G,e}function Mo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=u[6],B=u[7],D=u[8],G=u[9],q=u[10],W=u[11],X=u[12],Y=u[13],V=u[14],Q=u[15],le=A*F-R*I,ae=A*z-L*I,se=A*B-M*I,de=R*z-L*F,ue=R*B-M*F,Ie=L*B-M*z,Le=D*Y-G*X,Me=D*V-q*X,Se=D*Q-W*X,Ne=G*V-q*Y,ge=G*Q-W*Y,ye=q*Q-W*V,ce=le*ye-ae*ge+se*Ne+de*Se-ue*Me+Ie*Le;return ce?(ce=1/ce,e[0]=(F*ye-z*ge+B*Ne)*ce,e[1]=(z*Se-I*ye-B*Me)*ce,e[2]=(I*ge-F*Se+B*Le)*ce,e[3]=(L*ge-R*ye-M*Ne)*ce,e[4]=(A*ye-L*Se+M*Me)*ce,e[5]=(R*Se-A*ge-M*Le)*ce,e[6]=(Y*Ie-V*ue+Q*de)*ce,e[7]=(V*se-X*Ie-Q*ae)*ce,e[8]=(X*ue-Y*se+Q*le)*ce,e):null}function Io(e,u,A){return e[0]=2/u,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/A,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Fo(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Co(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function No(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e[4]=u[4]+A[4],e[5]=u[5]+A[5],e[6]=u[6]+A[6],e[7]=u[7]+A[7],e[8]=u[8]+A[8],e}function ws(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e[3]=u[3]-A[3],e[4]=u[4]-A[4],e[5]=u[5]-A[5],e[6]=u[6]-A[6],e[7]=u[7]-A[7],e[8]=u[8]-A[8],e}function zo(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e[4]=u[4]*A,e[5]=u[5]*A,e[6]=u[6]*A,e[7]=u[7]*A,e[8]=u[8]*A,e}function Bo(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e[3]=u[3]+A[3]*R,e[4]=u[4]+A[4]*R,e[5]=u[5]+A[5]*R,e[6]=u[6]+A[6]*R,e[7]=u[7]+A[7]*R,e[8]=u[8]+A[8]*R,e}function Do(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]&&e[4]===u[4]&&e[5]===u[5]&&e[6]===u[6]&&e[7]===u[7]&&e[8]===u[8]}function jo(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=e[8],G=u[0],q=u[1],W=u[2],X=u[3],Y=u[4],V=u[5],Q=u[6],le=u[7],ae=u[8];return Math.abs(A-G)<=v*Math.max(1,Math.abs(A),Math.abs(G))&&Math.abs(R-q)<=v*Math.max(1,Math.abs(R),Math.abs(q))&&Math.abs(L-W)<=v*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(M-X)<=v*Math.max(1,Math.abs(M),Math.abs(X))&&Math.abs(I-Y)<=v*Math.max(1,Math.abs(I),Math.abs(Y))&&Math.abs(F-V)<=v*Math.max(1,Math.abs(F),Math.abs(V))&&Math.abs(z-Q)<=v*Math.max(1,Math.abs(z),Math.abs(Q))&&Math.abs(B-le)<=v*Math.max(1,Math.abs(B),Math.abs(le))&&Math.abs(D-ae)<=v*Math.max(1,Math.abs(D),Math.abs(ae))}var ko=Ps,Uo=ws;function Go(){var e=new f(16);return f!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function qo(e){var u=new f(16);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u[4]=e[4],u[5]=e[5],u[6]=e[6],u[7]=e[7],u[8]=e[8],u[9]=e[9],u[10]=e[10],u[11]=e[11],u[12]=e[12],u[13]=e[13],u[14]=e[14],u[15]=e[15],u}function Wo(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[4]=u[4],e[5]=u[5],e[6]=u[6],e[7]=u[7],e[8]=u[8],e[9]=u[9],e[10]=u[10],e[11]=u[11],e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15],e}function Vo(e,u,A,R,L,M,I,F,z,B,D,G,q,W,X,Y){var V=new f(16);return V[0]=e,V[1]=u,V[2]=A,V[3]=R,V[4]=L,V[5]=M,V[6]=I,V[7]=F,V[8]=z,V[9]=B,V[10]=D,V[11]=G,V[12]=q,V[13]=W,V[14]=X,V[15]=Y,V}function $o(e,u,A,R,L,M,I,F,z,B,D,G,q,W,X,Y,V){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e[8]=B,e[9]=D,e[10]=G,e[11]=q,e[12]=W,e[13]=X,e[14]=Y,e[15]=V,e}function Ls(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ho(e,u){if(e===u){var A=u[1],R=u[2],L=u[3],M=u[6],I=u[7],F=u[11];e[1]=u[4],e[2]=u[8],e[3]=u[12],e[4]=A,e[6]=u[9],e[7]=u[13],e[8]=R,e[9]=M,e[11]=u[14],e[12]=L,e[13]=I,e[14]=F}else e[0]=u[0],e[1]=u[4],e[2]=u[8],e[3]=u[12],e[4]=u[1],e[5]=u[5],e[6]=u[9],e[7]=u[13],e[8]=u[2],e[9]=u[6],e[10]=u[10],e[11]=u[14],e[12]=u[3],e[13]=u[7],e[14]=u[11],e[15]=u[15];return e}function Xo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=u[6],B=u[7],D=u[8],G=u[9],q=u[10],W=u[11],X=u[12],Y=u[13],V=u[14],Q=u[15],le=A*F-R*I,ae=A*z-L*I,se=A*B-M*I,de=R*z-L*F,ue=R*B-M*F,Ie=L*B-M*z,Le=D*Y-G*X,Me=D*V-q*X,Se=D*Q-W*X,Ne=G*V-q*Y,ge=G*Q-W*Y,ye=q*Q-W*V,ce=le*ye-ae*ge+se*Ne+de*Se-ue*Me+Ie*Le;return ce?(ce=1/ce,e[0]=(F*ye-z*ge+B*Ne)*ce,e[1]=(L*ge-R*ye-M*Ne)*ce,e[2]=(Y*Ie-V*ue+Q*de)*ce,e[3]=(q*ue-G*Ie-W*de)*ce,e[4]=(z*Se-I*ye-B*Me)*ce,e[5]=(A*ye-L*Se+M*Me)*ce,e[6]=(V*se-X*Ie-Q*ae)*ce,e[7]=(D*Ie-q*se+W*ae)*ce,e[8]=(I*ge-F*Se+B*Le)*ce,e[9]=(R*Se-A*ge-M*Le)*ce,e[10]=(X*ue-Y*se+Q*le)*ce,e[11]=(G*se-D*ue-W*le)*ce,e[12]=(F*Me-I*Ne-z*Le)*ce,e[13]=(A*Ne-R*Me+L*Le)*ce,e[14]=(Y*ae-X*de-V*le)*ce,e[15]=(D*de-G*ae+q*le)*ce,e):null}function Yo(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=u[4],F=u[5],z=u[6],B=u[7],D=u[8],G=u[9],q=u[10],W=u[11],X=u[12],Y=u[13],V=u[14],Q=u[15];return e[0]=F*(q*Q-W*V)-G*(z*Q-B*V)+Y*(z*W-B*q),e[1]=-(R*(q*Q-W*V)-G*(L*Q-M*V)+Y*(L*W-M*q)),e[2]=R*(z*Q-B*V)-F*(L*Q-M*V)+Y*(L*B-M*z),e[3]=-(R*(z*W-B*q)-F*(L*W-M*q)+G*(L*B-M*z)),e[4]=-(I*(q*Q-W*V)-D*(z*Q-B*V)+X*(z*W-B*q)),e[5]=A*(q*Q-W*V)-D*(L*Q-M*V)+X*(L*W-M*q),e[6]=-(A*(z*Q-B*V)-I*(L*Q-M*V)+X*(L*B-M*z)),e[7]=A*(z*W-B*q)-I*(L*W-M*q)+D*(L*B-M*z),e[8]=I*(G*Q-W*Y)-D*(F*Q-B*Y)+X*(F*W-B*G),e[9]=-(A*(G*Q-W*Y)-D*(R*Q-M*Y)+X*(R*W-M*G)),e[10]=A*(F*Q-B*Y)-I*(R*Q-M*Y)+X*(R*B-M*F),e[11]=-(A*(F*W-B*G)-I*(R*W-M*G)+D*(R*B-M*F)),e[12]=-(I*(G*V-q*Y)-D*(F*V-z*Y)+X*(F*q-z*G)),e[13]=A*(G*V-q*Y)-D*(R*V-L*Y)+X*(R*q-L*G),e[14]=-(A*(F*V-z*Y)-I*(R*V-L*Y)+X*(R*z-L*F)),e[15]=A*(F*q-z*G)-I*(R*q-L*G)+D*(R*z-L*F),e}function Zo(e){var u=e[0],A=e[1],R=e[2],L=e[3],M=e[4],I=e[5],F=e[6],z=e[7],B=e[8],D=e[9],G=e[10],q=e[11],W=e[12],X=e[13],Y=e[14],V=e[15];return(u*I-A*M)*(G*V-q*Y)-(u*F-R*M)*(D*V-q*X)+(u*z-L*M)*(D*Y-G*X)+(A*F-R*I)*(B*V-q*W)-(A*z-L*I)*(B*Y-G*W)+(R*z-L*F)*(B*X-D*W)}function Ms(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=u[8],q=u[9],W=u[10],X=u[11],Y=u[12],V=u[13],Q=u[14],le=u[15],ae=A[0],se=A[1],de=A[2],ue=A[3];return e[0]=ae*R+se*F+de*G+ue*Y,e[1]=ae*L+se*z+de*q+ue*V,e[2]=ae*M+se*B+de*W+ue*Q,e[3]=ae*I+se*D+de*X+ue*le,ae=A[4],se=A[5],de=A[6],ue=A[7],e[4]=ae*R+se*F+de*G+ue*Y,e[5]=ae*L+se*z+de*q+ue*V,e[6]=ae*M+se*B+de*W+ue*Q,e[7]=ae*I+se*D+de*X+ue*le,ae=A[8],se=A[9],de=A[10],ue=A[11],e[8]=ae*R+se*F+de*G+ue*Y,e[9]=ae*L+se*z+de*q+ue*V,e[10]=ae*M+se*B+de*W+ue*Q,e[11]=ae*I+se*D+de*X+ue*le,ae=A[12],se=A[13],de=A[14],ue=A[15],e[12]=ae*R+se*F+de*G+ue*Y,e[13]=ae*L+se*z+de*q+ue*V,e[14]=ae*M+se*B+de*W+ue*Q,e[15]=ae*I+se*D+de*X+ue*le,e}function Ko(e,u,A){var R,L,M,I,F,z,B,D,G,q,W,X,Y=A[0],V=A[1],Q=A[2];return u===e?(e[12]=u[0]*Y+u[4]*V+u[8]*Q+u[12],e[13]=u[1]*Y+u[5]*V+u[9]*Q+u[13],e[14]=u[2]*Y+u[6]*V+u[10]*Q+u[14],e[15]=u[3]*Y+u[7]*V+u[11]*Q+u[15]):(R=u[0],L=u[1],M=u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=u[8],q=u[9],W=u[10],X=u[11],e[0]=R,e[1]=L,e[2]=M,e[3]=I,e[4]=F,e[5]=z,e[6]=B,e[7]=D,e[8]=G,e[9]=q,e[10]=W,e[11]=X,e[12]=R*Y+F*V+G*Q+u[12],e[13]=L*Y+z*V+q*Q+u[13],e[14]=M*Y+B*V+W*Q+u[14],e[15]=I*Y+D*V+X*Q+u[15]),e}function Qo(e,u,A){var R=A[0],L=A[1],M=A[2];return e[0]=u[0]*R,e[1]=u[1]*R,e[2]=u[2]*R,e[3]=u[3]*R,e[4]=u[4]*L,e[5]=u[5]*L,e[6]=u[6]*L,e[7]=u[7]*L,e[8]=u[8]*M,e[9]=u[9]*M,e[10]=u[10]*M,e[11]=u[11]*M,e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15],e}function Jo(e,u,A,R){var L,M,I,F,z,B,D,G,q,W,X,Y,V,Q,le,ae,se,de,ue,Ie,Le,Me,Se,Ne,ge=R[0],ye=R[1],ce=R[2],dt=Math.hypot(ge,ye,ce);return dt<v?null:(ge*=dt=1/dt,ye*=dt,ce*=dt,L=Math.sin(A),I=1-(M=Math.cos(A)),F=u[0],z=u[1],B=u[2],D=u[3],G=u[4],q=u[5],W=u[6],X=u[7],Y=u[8],V=u[9],Q=u[10],le=u[11],ae=ge*ge*I+M,se=ye*ge*I+ce*L,de=ce*ge*I-ye*L,ue=ge*ye*I-ce*L,Ie=ye*ye*I+M,Le=ce*ye*I+ge*L,Me=ge*ce*I+ye*L,Se=ye*ce*I-ge*L,Ne=ce*ce*I+M,e[0]=F*ae+G*se+Y*de,e[1]=z*ae+q*se+V*de,e[2]=B*ae+W*se+Q*de,e[3]=D*ae+X*se+le*de,e[4]=F*ue+G*Ie+Y*Le,e[5]=z*ue+q*Ie+V*Le,e[6]=B*ue+W*Ie+Q*Le,e[7]=D*ue+X*Ie+le*Le,e[8]=F*Me+G*Se+Y*Ne,e[9]=z*Me+q*Se+V*Ne,e[10]=B*Me+W*Se+Q*Ne,e[11]=D*Me+X*Se+le*Ne,u!==e&&(e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15]),e)}function el(e,u,A){var R=Math.sin(A),L=Math.cos(A),M=u[4],I=u[5],F=u[6],z=u[7],B=u[8],D=u[9],G=u[10],q=u[11];return u!==e&&(e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15]),e[4]=M*L+B*R,e[5]=I*L+D*R,e[6]=F*L+G*R,e[7]=z*L+q*R,e[8]=B*L-M*R,e[9]=D*L-I*R,e[10]=G*L-F*R,e[11]=q*L-z*R,e}function tl(e,u,A){var R=Math.sin(A),L=Math.cos(A),M=u[0],I=u[1],F=u[2],z=u[3],B=u[8],D=u[9],G=u[10],q=u[11];return u!==e&&(e[4]=u[4],e[5]=u[5],e[6]=u[6],e[7]=u[7],e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15]),e[0]=M*L-B*R,e[1]=I*L-D*R,e[2]=F*L-G*R,e[3]=z*L-q*R,e[8]=M*R+B*L,e[9]=I*R+D*L,e[10]=F*R+G*L,e[11]=z*R+q*L,e}function rl(e,u,A){var R=Math.sin(A),L=Math.cos(A),M=u[0],I=u[1],F=u[2],z=u[3],B=u[4],D=u[5],G=u[6],q=u[7];return u!==e&&(e[8]=u[8],e[9]=u[9],e[10]=u[10],e[11]=u[11],e[12]=u[12],e[13]=u[13],e[14]=u[14],e[15]=u[15]),e[0]=M*L+B*R,e[1]=I*L+D*R,e[2]=F*L+G*R,e[3]=z*L+q*R,e[4]=B*L-M*R,e[5]=D*L-I*R,e[6]=G*L-F*R,e[7]=q*L-z*R,e}function il(e,u){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=u[0],e[13]=u[1],e[14]=u[2],e[15]=1,e}function nl(e,u){return e[0]=u[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function al(e,u,A){var R,L,M,I=A[0],F=A[1],z=A[2],B=Math.hypot(I,F,z);return B<v?null:(I*=B=1/B,F*=B,z*=B,R=Math.sin(u),M=1-(L=Math.cos(u)),e[0]=I*I*M+L,e[1]=F*I*M+z*R,e[2]=z*I*M-F*R,e[3]=0,e[4]=I*F*M-z*R,e[5]=F*F*M+L,e[6]=z*F*M+I*R,e[7]=0,e[8]=I*z*M+F*R,e[9]=F*z*M-I*R,e[10]=z*z*M+L,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function sl(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=R,e[6]=A,e[7]=0,e[8]=0,e[9]=-A,e[10]=R,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ol(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=R,e[1]=0,e[2]=-A,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=A,e[9]=0,e[10]=R,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ll(e,u){var A=Math.sin(u),R=Math.cos(u);return e[0]=R,e[1]=A,e[2]=0,e[3]=0,e[4]=-A,e[5]=R,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Is(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=R+R,z=L+L,B=M+M,D=R*F,G=R*z,q=R*B,W=L*z,X=L*B,Y=M*B,V=I*F,Q=I*z,le=I*B;return e[0]=1-(W+Y),e[1]=G+le,e[2]=q-Q,e[3]=0,e[4]=G-le,e[5]=1-(D+Y),e[6]=X+V,e[7]=0,e[8]=q+Q,e[9]=X-V,e[10]=1-(D+W),e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function ul(e,u){var A=new f(3),R=-u[0],L=-u[1],M=-u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=R*R+L*L+M*M+I*I;return G>0?(A[0]=2*(F*I+D*R+z*M-B*L)/G,A[1]=2*(z*I+D*L+B*R-F*M)/G,A[2]=2*(B*I+D*M+F*L-z*R)/G):(A[0]=2*(F*I+D*R+z*M-B*L),A[1]=2*(z*I+D*L+B*R-F*M),A[2]=2*(B*I+D*M+F*L-z*R)),Is(e,u,A),e}function Fs(e,u){return e[0]=u[12],e[1]=u[13],e[2]=u[14],e}function Cs(e,u){var A=u[0],R=u[1],L=u[2],M=u[4],I=u[5],F=u[6],z=u[8],B=u[9],D=u[10];return e[0]=Math.hypot(A,R,L),e[1]=Math.hypot(M,I,F),e[2]=Math.hypot(z,B,D),e}function Ns(e,u){var A=new f(3);Cs(A,u);var R=1/A[0],L=1/A[1],M=1/A[2],I=u[0]*R,F=u[1]*L,z=u[2]*M,B=u[4]*R,D=u[5]*L,G=u[6]*M,q=u[8]*R,W=u[9]*L,X=u[10]*M,Y=I+D+X,V=0;return Y>0?(V=2*Math.sqrt(Y+1),e[3]=.25*V,e[0]=(G-W)/V,e[1]=(q-z)/V,e[2]=(F-B)/V):I>D&&I>X?(V=2*Math.sqrt(1+I-D-X),e[3]=(G-W)/V,e[0]=.25*V,e[1]=(F+B)/V,e[2]=(q+z)/V):D>X?(V=2*Math.sqrt(1+D-I-X),e[3]=(q-z)/V,e[0]=(F+B)/V,e[1]=.25*V,e[2]=(G+W)/V):(V=2*Math.sqrt(1+X-I-D),e[3]=(F-B)/V,e[0]=(q+z)/V,e[1]=(G+W)/V,e[2]=.25*V),e}function cl(e,u,A,R){var L=u[0],M=u[1],I=u[2],F=u[3],z=L+L,B=M+M,D=I+I,G=L*z,q=L*B,W=L*D,X=M*B,Y=M*D,V=I*D,Q=F*z,le=F*B,ae=F*D,se=R[0],de=R[1],ue=R[2];return e[0]=(1-(X+V))*se,e[1]=(q+ae)*se,e[2]=(W-le)*se,e[3]=0,e[4]=(q-ae)*de,e[5]=(1-(G+V))*de,e[6]=(Y+Q)*de,e[7]=0,e[8]=(W+le)*ue,e[9]=(Y-Q)*ue,e[10]=(1-(G+X))*ue,e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function hl(e,u,A,R,L){var M=u[0],I=u[1],F=u[2],z=u[3],B=M+M,D=I+I,G=F+F,q=M*B,W=M*D,X=M*G,Y=I*D,V=I*G,Q=F*G,le=z*B,ae=z*D,se=z*G,de=R[0],ue=R[1],Ie=R[2],Le=L[0],Me=L[1],Se=L[2],Ne=(1-(Y+Q))*de,ge=(W+se)*de,ye=(X-ae)*de,ce=(W-se)*ue,dt=(1-(q+Q))*ue,jr=(V+le)*ue,kr=(X+ae)*Ie,Ac=(V-le)*Ie,Sc=(1-(q+Y))*Ie;return e[0]=Ne,e[1]=ge,e[2]=ye,e[3]=0,e[4]=ce,e[5]=dt,e[6]=jr,e[7]=0,e[8]=kr,e[9]=Ac,e[10]=Sc,e[11]=0,e[12]=A[0]+Le-(Ne*Le+ce*Me+kr*Se),e[13]=A[1]+Me-(ge*Le+dt*Me+Ac*Se),e[14]=A[2]+Se-(ye*Le+jr*Me+Sc*Se),e[15]=1,e}function dl(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=A+A,F=R+R,z=L+L,B=A*I,D=R*I,G=R*F,q=L*I,W=L*F,X=L*z,Y=M*I,V=M*F,Q=M*z;return e[0]=1-G-X,e[1]=D+Q,e[2]=q-V,e[3]=0,e[4]=D-Q,e[5]=1-B-X,e[6]=W+Y,e[7]=0,e[8]=q+V,e[9]=W-Y,e[10]=1-B-G,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fl(e,u,A,R,L,M,I){var F=1/(A-u),z=1/(L-R),B=1/(M-I);return e[0]=2*M*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*M*z,e[6]=0,e[7]=0,e[8]=(A+u)*F,e[9]=(L+R)*z,e[10]=(I+M)*B,e[11]=-1,e[12]=0,e[13]=0,e[14]=I*M*2*B,e[15]=0,e}function zs(e,u,A,R,L){var M,I=1/Math.tan(u/2);return e[0]=I/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(R-L),e[10]=(L+R)*M,e[14]=2*L*R*M):(e[10]=-1,e[14]=-2*R),e}var _l=zs;function pl(e,u,A,R,L){var M,I=1/Math.tan(u/2);return e[0]=I/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(R-L),e[10]=L*M,e[14]=L*R*M):(e[10]=-1,e[14]=-R),e}function vl(e,u,A,R){var L=Math.tan(u.upDegrees*Math.PI/180),M=Math.tan(u.downDegrees*Math.PI/180),I=Math.tan(u.leftDegrees*Math.PI/180),F=Math.tan(u.rightDegrees*Math.PI/180),z=2/(I+F),B=2/(L+M);return e[0]=z,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=B,e[6]=0,e[7]=0,e[8]=-(I-F)*z*.5,e[9]=(L-M)*B*.5,e[10]=R/(A-R),e[11]=-1,e[12]=0,e[13]=0,e[14]=R*A/(A-R),e[15]=0,e}function Bs(e,u,A,R,L,M,I){var F=1/(u-A),z=1/(R-L),B=1/(M-I);return e[0]=-2*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*B,e[11]=0,e[12]=(u+A)*F,e[13]=(L+R)*z,e[14]=(I+M)*B,e[15]=1,e}var ml=Bs;function bl(e,u,A,R,L,M,I){var F=1/(u-A),z=1/(R-L),B=1/(M-I);return e[0]=-2*F,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=B,e[11]=0,e[12]=(u+A)*F,e[13]=(L+R)*z,e[14]=M*B,e[15]=1,e}function gl(e,u,A,R){var L,M,I,F,z,B,D,G,q,W,X=u[0],Y=u[1],V=u[2],Q=R[0],le=R[1],ae=R[2],se=A[0],de=A[1],ue=A[2];return Math.abs(X-se)<v&&Math.abs(Y-de)<v&&Math.abs(V-ue)<v?Ls(e):(D=X-se,G=Y-de,q=V-ue,L=le*(q*=W=1/Math.hypot(D,G,q))-ae*(G*=W),M=ae*(D*=W)-Q*q,I=Q*G-le*D,(W=Math.hypot(L,M,I))?(L*=W=1/W,M*=W,I*=W):(L=0,M=0,I=0),F=G*I-q*M,z=q*L-D*I,B=D*M-G*L,(W=Math.hypot(F,z,B))?(F*=W=1/W,z*=W,B*=W):(F=0,z=0,B=0),e[0]=L,e[1]=F,e[2]=D,e[3]=0,e[4]=M,e[5]=z,e[6]=G,e[7]=0,e[8]=I,e[9]=B,e[10]=q,e[11]=0,e[12]=-(L*X+M*Y+I*V),e[13]=-(F*X+z*Y+B*V),e[14]=-(D*X+G*Y+q*V),e[15]=1,e)}function yl(e,u,A,R){var L=u[0],M=u[1],I=u[2],F=R[0],z=R[1],B=R[2],D=L-A[0],G=M-A[1],q=I-A[2],W=D*D+G*G+q*q;W>0&&(D*=W=1/Math.sqrt(W),G*=W,q*=W);var X=z*q-B*G,Y=B*D-F*q,V=F*G-z*D;return(W=X*X+Y*Y+V*V)>0&&(X*=W=1/Math.sqrt(W),Y*=W,V*=W),e[0]=X,e[1]=Y,e[2]=V,e[3]=0,e[4]=G*V-q*Y,e[5]=q*X-D*V,e[6]=D*Y-G*X,e[7]=0,e[8]=D,e[9]=G,e[10]=q,e[11]=0,e[12]=L,e[13]=M,e[14]=I,e[15]=1,e}function El(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Tl(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xl(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e[4]=u[4]+A[4],e[5]=u[5]+A[5],e[6]=u[6]+A[6],e[7]=u[7]+A[7],e[8]=u[8]+A[8],e[9]=u[9]+A[9],e[10]=u[10]+A[10],e[11]=u[11]+A[11],e[12]=u[12]+A[12],e[13]=u[13]+A[13],e[14]=u[14]+A[14],e[15]=u[15]+A[15],e}function Ds(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e[3]=u[3]-A[3],e[4]=u[4]-A[4],e[5]=u[5]-A[5],e[6]=u[6]-A[6],e[7]=u[7]-A[7],e[8]=u[8]-A[8],e[9]=u[9]-A[9],e[10]=u[10]-A[10],e[11]=u[11]-A[11],e[12]=u[12]-A[12],e[13]=u[13]-A[13],e[14]=u[14]-A[14],e[15]=u[15]-A[15],e}function Al(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e[4]=u[4]*A,e[5]=u[5]*A,e[6]=u[6]*A,e[7]=u[7]*A,e[8]=u[8]*A,e[9]=u[9]*A,e[10]=u[10]*A,e[11]=u[11]*A,e[12]=u[12]*A,e[13]=u[13]*A,e[14]=u[14]*A,e[15]=u[15]*A,e}function Sl(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e[3]=u[3]+A[3]*R,e[4]=u[4]+A[4]*R,e[5]=u[5]+A[5]*R,e[6]=u[6]+A[6]*R,e[7]=u[7]+A[7]*R,e[8]=u[8]+A[8]*R,e[9]=u[9]+A[9]*R,e[10]=u[10]+A[10]*R,e[11]=u[11]+A[11]*R,e[12]=u[12]+A[12]*R,e[13]=u[13]+A[13]*R,e[14]=u[14]+A[14]*R,e[15]=u[15]+A[15]*R,e}function Ol(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]&&e[4]===u[4]&&e[5]===u[5]&&e[6]===u[6]&&e[7]===u[7]&&e[8]===u[8]&&e[9]===u[9]&&e[10]===u[10]&&e[11]===u[11]&&e[12]===u[12]&&e[13]===u[13]&&e[14]===u[14]&&e[15]===u[15]}function Rl(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=e[8],G=e[9],q=e[10],W=e[11],X=e[12],Y=e[13],V=e[14],Q=e[15],le=u[0],ae=u[1],se=u[2],de=u[3],ue=u[4],Ie=u[5],Le=u[6],Me=u[7],Se=u[8],Ne=u[9],ge=u[10],ye=u[11],ce=u[12],dt=u[13],jr=u[14],kr=u[15];return Math.abs(A-le)<=v*Math.max(1,Math.abs(A),Math.abs(le))&&Math.abs(R-ae)<=v*Math.max(1,Math.abs(R),Math.abs(ae))&&Math.abs(L-se)<=v*Math.max(1,Math.abs(L),Math.abs(se))&&Math.abs(M-de)<=v*Math.max(1,Math.abs(M),Math.abs(de))&&Math.abs(I-ue)<=v*Math.max(1,Math.abs(I),Math.abs(ue))&&Math.abs(F-Ie)<=v*Math.max(1,Math.abs(F),Math.abs(Ie))&&Math.abs(z-Le)<=v*Math.max(1,Math.abs(z),Math.abs(Le))&&Math.abs(B-Me)<=v*Math.max(1,Math.abs(B),Math.abs(Me))&&Math.abs(D-Se)<=v*Math.max(1,Math.abs(D),Math.abs(Se))&&Math.abs(G-Ne)<=v*Math.max(1,Math.abs(G),Math.abs(Ne))&&Math.abs(q-ge)<=v*Math.max(1,Math.abs(q),Math.abs(ge))&&Math.abs(W-ye)<=v*Math.max(1,Math.abs(W),Math.abs(ye))&&Math.abs(X-ce)<=v*Math.max(1,Math.abs(X),Math.abs(ce))&&Math.abs(Y-dt)<=v*Math.max(1,Math.abs(Y),Math.abs(dt))&&Math.abs(V-jr)<=v*Math.max(1,Math.abs(V),Math.abs(jr))&&Math.abs(Q-kr)<=v*Math.max(1,Math.abs(Q),Math.abs(kr))}var Pl=Ms,wl=Ds;function Br(){var e=new f(3);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ll(e){var u=new f(3);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u}function js(e){var u=e[0],A=e[1],R=e[2];return Math.hypot(u,A,R)}function Dr(e,u,A){var R=new f(3);return R[0]=e,R[1]=u,R[2]=A,R}function Ml(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e}function Il(e,u,A,R){return e[0]=u,e[1]=A,e[2]=R,e}function Fl(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e}function ks(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e}function Us(e,u,A){return e[0]=u[0]*A[0],e[1]=u[1]*A[1],e[2]=u[2]*A[2],e}function Gs(e,u,A){return e[0]=u[0]/A[0],e[1]=u[1]/A[1],e[2]=u[2]/A[2],e}function Cl(e,u){return e[0]=Math.ceil(u[0]),e[1]=Math.ceil(u[1]),e[2]=Math.ceil(u[2]),e}function Nl(e,u){return e[0]=Math.floor(u[0]),e[1]=Math.floor(u[1]),e[2]=Math.floor(u[2]),e}function Mt(e,u,A){return e[0]=Math.min(u[0],A[0]),e[1]=Math.min(u[1],A[1]),e[2]=Math.min(u[2],A[2]),e}function It(e,u,A){return e[0]=Math.max(u[0],A[0]),e[1]=Math.max(u[1],A[1]),e[2]=Math.max(u[2],A[2]),e}function ut(e,u){return e[0]=Math.round(u[0]),e[1]=Math.round(u[1]),e[2]=Math.round(u[2]),e}function St(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e}function $_(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e}function Iu(e,u){var A=u[0]-e[0],R=u[1]-e[1],L=u[2]-e[2];return Math.hypot(A,R,L)}function Fu(e,u){var A=u[0]-e[0],R=u[1]-e[1],L=u[2]-e[2];return A*A+R*R+L*L}function Cu(e){var u=e[0],A=e[1],R=e[2];return u*u+A*A+R*R}function H_(e,u){return e[0]=-u[0],e[1]=-u[1],e[2]=-u[2],e}function X_(e,u){return e[0]=1/u[0],e[1]=1/u[1],e[2]=1/u[2],e}function Nu(e,u){var A=u[0],R=u[1],L=u[2],M=A*A+R*R+L*L;return M>0&&(M=1/Math.sqrt(M)),e[0]=u[0]*M,e[1]=u[1]*M,e[2]=u[2]*M,e}function zl(e,u){return e[0]*u[0]+e[1]*u[1]+e[2]*u[2]}function qs(e,u,A){var R=u[0],L=u[1],M=u[2],I=A[0],F=A[1],z=A[2];return e[0]=L*z-M*F,e[1]=M*I-R*z,e[2]=R*F-L*I,e}function Y_(e,u,A,R){var L=u[0],M=u[1],I=u[2];return e[0]=L+R*(A[0]-L),e[1]=M+R*(A[1]-M),e[2]=I+R*(A[2]-I),e}function Z_(e,u,A,R,L,M){var I=M*M,F=I*(2*M-3)+1,z=I*(M-2)+M,B=I*(M-1),D=I*(3-2*M);return e[0]=u[0]*F+A[0]*z+R[0]*B+L[0]*D,e[1]=u[1]*F+A[1]*z+R[1]*B+L[1]*D,e[2]=u[2]*F+A[2]*z+R[2]*B+L[2]*D,e}function K_(e,u,A,R,L,M){var I=1-M,F=I*I,z=M*M,B=F*I,D=3*M*F,G=3*z*I,q=z*M;return e[0]=u[0]*B+A[0]*D+R[0]*G+L[0]*q,e[1]=u[1]*B+A[1]*D+R[1]*G+L[1]*q,e[2]=u[2]*B+A[2]*D+R[2]*G+L[2]*q,e}function Q_(e,u){u=u||1;var A=2*b()*Math.PI,R=2*b()-1,L=Math.sqrt(1-R*R)*u;return e[0]=Math.cos(A)*L,e[1]=Math.sin(A)*L,e[2]=R*u,e}function J_(e,u,A){var R=u[0],L=u[1],M=u[2],I=A[3]*R+A[7]*L+A[11]*M+A[15];return I=I||1,e[0]=(A[0]*R+A[4]*L+A[8]*M+A[12])/I,e[1]=(A[1]*R+A[5]*L+A[9]*M+A[13])/I,e[2]=(A[2]*R+A[6]*L+A[10]*M+A[14])/I,e}function e1(e,u,A){var R=u[0],L=u[1],M=u[2];return e[0]=R*A[0]+L*A[3]+M*A[6],e[1]=R*A[1]+L*A[4]+M*A[7],e[2]=R*A[2]+L*A[5]+M*A[8],e}function t1(e,u,A){var R=A[0],L=A[1],M=A[2],I=A[3],F=u[0],z=u[1],B=u[2],D=L*B-M*z,G=M*F-R*B,q=R*z-L*F,W=L*q-M*G,X=M*D-R*q,Y=R*G-L*D,V=2*I;return D*=V,G*=V,q*=V,W*=2,X*=2,Y*=2,e[0]=F+D+W,e[1]=z+G+X,e[2]=B+q+Y,e}function r1(e,u,A,R){var L=[],M=[];return L[0]=u[0]-A[0],L[1]=u[1]-A[1],L[2]=u[2]-A[2],M[0]=L[0],M[1]=L[1]*Math.cos(R)-L[2]*Math.sin(R),M[2]=L[1]*Math.sin(R)+L[2]*Math.cos(R),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function i1(e,u,A,R){var L=[],M=[];return L[0]=u[0]-A[0],L[1]=u[1]-A[1],L[2]=u[2]-A[2],M[0]=L[2]*Math.sin(R)+L[0]*Math.cos(R),M[1]=L[1],M[2]=L[2]*Math.cos(R)-L[0]*Math.sin(R),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function n1(e,u,A,R){var L=[],M=[];return L[0]=u[0]-A[0],L[1]=u[1]-A[1],L[2]=u[2]-A[2],M[0]=L[0]*Math.cos(R)-L[1]*Math.sin(R),M[1]=L[0]*Math.sin(R)+L[1]*Math.cos(R),M[2]=L[2],e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function a1(e,u){var A=e[0],R=e[1],L=e[2],M=u[0],I=u[1],F=u[2],z=Math.sqrt(A*A+R*R+L*L)*Math.sqrt(M*M+I*I+F*F),B=z&&zl(e,u)/z;return Math.acos(Math.min(Math.max(B,-1),1))}function s1(e){return e[0]=0,e[1]=0,e[2]=0,e}function o1(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function l1(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]}function u1(e,u){var A=e[0],R=e[1],L=e[2],M=u[0],I=u[1],F=u[2];return Math.abs(A-M)<=v*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(R-I)<=v*Math.max(1,Math.abs(R),Math.abs(I))&&Math.abs(L-F)<=v*Math.max(1,Math.abs(L),Math.abs(F))}var Ot,c1=ks,h1=Us,d1=Gs,f1=Iu,_1=Fu,zu=js,p1=Cu,v1=(Ot=Br(),function(e,u,A,R,L,M){var I,F;for(u||(u=3),A||(A=0),F=R?Math.min(R*u+A,e.length):e.length,I=A;I<F;I+=u)Ot[0]=e[I],Ot[1]=e[I+1],Ot[2]=e[I+2],L(Ot,Ot,M),e[I]=Ot[0],e[I+1]=Ot[1],e[I+2]=Ot[2];return e});function Bu(){var e=new f(4);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Du(e){var u=new f(4);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u}function ju(e,u,A,R){var L=new f(4);return L[0]=e,L[1]=u,L[2]=A,L[3]=R,L}function ku(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e}function Uu(e,u,A,R,L){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e}function Gu(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e}function qu(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e[2]=u[2]-A[2],e[3]=u[3]-A[3],e}function Wu(e,u,A){return e[0]=u[0]*A[0],e[1]=u[1]*A[1],e[2]=u[2]*A[2],e[3]=u[3]*A[3],e}function Vu(e,u,A){return e[0]=u[0]/A[0],e[1]=u[1]/A[1],e[2]=u[2]/A[2],e[3]=u[3]/A[3],e}function m1(e,u){return e[0]=Math.ceil(u[0]),e[1]=Math.ceil(u[1]),e[2]=Math.ceil(u[2]),e[3]=Math.ceil(u[3]),e}function b1(e,u){return e[0]=Math.floor(u[0]),e[1]=Math.floor(u[1]),e[2]=Math.floor(u[2]),e[3]=Math.floor(u[3]),e}function g1(e,u,A){return e[0]=Math.min(u[0],A[0]),e[1]=Math.min(u[1],A[1]),e[2]=Math.min(u[2],A[2]),e[3]=Math.min(u[3],A[3]),e}function y1(e,u,A){return e[0]=Math.max(u[0],A[0]),e[1]=Math.max(u[1],A[1]),e[2]=Math.max(u[2],A[2]),e[3]=Math.max(u[3],A[3]),e}function E1(e,u){return e[0]=Math.round(u[0]),e[1]=Math.round(u[1]),e[2]=Math.round(u[2]),e[3]=Math.round(u[3]),e}function $u(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e}function T1(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e[2]=u[2]+A[2]*R,e[3]=u[3]+A[3]*R,e}function Hu(e,u){var A=u[0]-e[0],R=u[1]-e[1],L=u[2]-e[2],M=u[3]-e[3];return Math.hypot(A,R,L,M)}function Xu(e,u){var A=u[0]-e[0],R=u[1]-e[1],L=u[2]-e[2],M=u[3]-e[3];return A*A+R*R+L*L+M*M}function Bl(e){var u=e[0],A=e[1],R=e[2],L=e[3];return Math.hypot(u,A,R,L)}function Dl(e){var u=e[0],A=e[1],R=e[2],L=e[3];return u*u+A*A+R*R+L*L}function x1(e,u){return e[0]=-u[0],e[1]=-u[1],e[2]=-u[2],e[3]=-u[3],e}function A1(e,u){return e[0]=1/u[0],e[1]=1/u[1],e[2]=1/u[2],e[3]=1/u[3],e}function Yu(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=A*A+R*R+L*L+M*M;return I>0&&(I=1/Math.sqrt(I)),e[0]=A*I,e[1]=R*I,e[2]=L*I,e[3]=M*I,e}function Zu(e,u){return e[0]*u[0]+e[1]*u[1]+e[2]*u[2]+e[3]*u[3]}function S1(e,u,A,R){var L=A[0]*R[1]-A[1]*R[0],M=A[0]*R[2]-A[2]*R[0],I=A[0]*R[3]-A[3]*R[0],F=A[1]*R[2]-A[2]*R[1],z=A[1]*R[3]-A[3]*R[1],B=A[2]*R[3]-A[3]*R[2],D=u[0],G=u[1],q=u[2],W=u[3];return e[0]=G*B-q*z+W*F,e[1]=-D*B+q*I-W*M,e[2]=D*z-G*I+W*L,e[3]=-D*F+G*M-q*L,e}function Ku(e,u,A,R){var L=u[0],M=u[1],I=u[2],F=u[3];return e[0]=L+R*(A[0]-L),e[1]=M+R*(A[1]-M),e[2]=I+R*(A[2]-I),e[3]=F+R*(A[3]-F),e}function O1(e,u){var A,R,L,M,I,F;u=u||1;do I=(A=2*b()-1)*A+(R=2*b()-1)*R;while(I>=1);do F=(L=2*b()-1)*L+(M=2*b()-1)*M;while(F>=1);var z=Math.sqrt((1-I)/F);return e[0]=u*A,e[1]=u*R,e[2]=u*L*z,e[3]=u*M*z,e}function R1(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3];return e[0]=A[0]*R+A[4]*L+A[8]*M+A[12]*I,e[1]=A[1]*R+A[5]*L+A[9]*M+A[13]*I,e[2]=A[2]*R+A[6]*L+A[10]*M+A[14]*I,e[3]=A[3]*R+A[7]*L+A[11]*M+A[15]*I,e}function P1(e,u,A){var R=u[0],L=u[1],M=u[2],I=A[0],F=A[1],z=A[2],B=A[3],D=B*R+F*M-z*L,G=B*L+z*R-I*M,q=B*M+I*L-F*R,W=-I*R-F*L-z*M;return e[0]=D*B+W*-I+G*-z-q*-F,e[1]=G*B+W*-F+q*-I-D*-z,e[2]=q*B+W*-z+D*-F-G*-I,e[3]=u[3],e}function w1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function L1(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Qu(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]}function Ju(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=u[0],F=u[1],z=u[2],B=u[3];return Math.abs(A-I)<=v*Math.max(1,Math.abs(A),Math.abs(I))&&Math.abs(R-F)<=v*Math.max(1,Math.abs(R),Math.abs(F))&&Math.abs(L-z)<=v*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=v*Math.max(1,Math.abs(M),Math.abs(B))}var M1=qu,I1=Wu,F1=Vu,C1=Hu,N1=Xu,z1=Bl,B1=Dl,D1=function(){var e=Bu();return function(u,A,R,L,M,I){var F,z;for(A||(A=4),R||(R=0),z=L?Math.min(L*A+R,u.length):u.length,F=R;F<z;F+=A)e[0]=u[F],e[1]=u[F+1],e[2]=u[F+2],e[3]=u[F+3],M(e,e,I),u[F]=e[0],u[F+1]=e[1],u[F+2]=e[2],u[F+3]=e[3];return u}}();function Ws(){var e=new f(4);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function j1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ec(e,u,A){A*=.5;var R=Math.sin(A);return e[0]=R*u[0],e[1]=R*u[1],e[2]=R*u[2],e[3]=Math.cos(A),e}function k1(e,u){var A=2*Math.acos(u[3]),R=Math.sin(A/2);return R>v?(e[0]=u[0]/R,e[1]=u[1]/R,e[2]=u[2]/R):(e[0]=1,e[1]=0,e[2]=0),A}function U1(e,u){var A=Gl(e,u);return Math.acos(2*A*A-1)}function tc(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=A[0],z=A[1],B=A[2],D=A[3];return e[0]=R*D+I*F+L*B-M*z,e[1]=L*D+I*z+M*F-R*B,e[2]=M*D+I*B+R*z-L*F,e[3]=I*D-R*F-L*z-M*B,e}function rc(e,u,A){A*=.5;var R=u[0],L=u[1],M=u[2],I=u[3],F=Math.sin(A),z=Math.cos(A);return e[0]=R*z+I*F,e[1]=L*z+M*F,e[2]=M*z-L*F,e[3]=I*z-R*F,e}function ic(e,u,A){A*=.5;var R=u[0],L=u[1],M=u[2],I=u[3],F=Math.sin(A),z=Math.cos(A);return e[0]=R*z-M*F,e[1]=L*z+I*F,e[2]=M*z+R*F,e[3]=I*z-L*F,e}function nc(e,u,A){A*=.5;var R=u[0],L=u[1],M=u[2],I=u[3],F=Math.sin(A),z=Math.cos(A);return e[0]=R*z+L*F,e[1]=L*z-R*F,e[2]=M*z+I*F,e[3]=I*z-M*F,e}function G1(e,u){var A=u[0],R=u[1],L=u[2];return e[0]=A,e[1]=R,e[2]=L,e[3]=Math.sqrt(Math.abs(1-A*A-R*R-L*L)),e}function ac(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=Math.sqrt(A*A+R*R+L*L),F=Math.exp(M),z=I>0?F*Math.sin(I)/I:0;return e[0]=A*z,e[1]=R*z,e[2]=L*z,e[3]=F*Math.cos(I),e}function sc(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=Math.sqrt(A*A+R*R+L*L),F=I>0?Math.atan2(I,M)/I:0;return e[0]=A*F,e[1]=R*F,e[2]=L*F,e[3]=.5*Math.log(A*A+R*R+L*L+M*M),e}function q1(e,u,A){return sc(e,u),cc(e,e,A),ac(e,e),e}function Vs(e,u,A,R){var L,M,I,F,z,B=u[0],D=u[1],G=u[2],q=u[3],W=A[0],X=A[1],Y=A[2],V=A[3];return(M=B*W+D*X+G*Y+q*V)<0&&(M=-M,W=-W,X=-X,Y=-Y,V=-V),1-M>v?(L=Math.acos(M),I=Math.sin(L),F=Math.sin((1-R)*L)/I,z=Math.sin(R*L)/I):(F=1-R,z=R),e[0]=F*B+z*W,e[1]=F*D+z*X,e[2]=F*G+z*Y,e[3]=F*q+z*V,e}function W1(e){var u=b(),A=b(),R=b(),L=Math.sqrt(1-u),M=Math.sqrt(u);return e[0]=L*Math.sin(2*Math.PI*A),e[1]=L*Math.cos(2*Math.PI*A),e[2]=M*Math.sin(2*Math.PI*R),e[3]=M*Math.cos(2*Math.PI*R),e}function V1(e,u){var A=u[0],R=u[1],L=u[2],M=u[3],I=A*A+R*R+L*L+M*M,F=I?1/I:0;return e[0]=-A*F,e[1]=-R*F,e[2]=-L*F,e[3]=M*F,e}function $1(e,u){return e[0]=-u[0],e[1]=-u[1],e[2]=-u[2],e[3]=u[3],e}function oc(e,u){var A,R=u[0]+u[4]+u[8];if(R>0)A=Math.sqrt(R+1),e[3]=.5*A,A=.5/A,e[0]=(u[5]-u[7])*A,e[1]=(u[6]-u[2])*A,e[2]=(u[1]-u[3])*A;else{var L=0;u[4]>u[0]&&(L=1),u[8]>u[3*L+L]&&(L=2);var M=(L+1)%3,I=(L+2)%3;A=Math.sqrt(u[3*L+L]-u[3*M+M]-u[3*I+I]+1),e[L]=.5*A,A=.5/A,e[3]=(u[3*M+I]-u[3*I+M])*A,e[M]=(u[3*M+L]+u[3*L+M])*A,e[I]=(u[3*I+L]+u[3*L+I])*A}return e}function H1(e,u,A,R){var L=.5*Math.PI/180;u*=L,A*=L,R*=L;var M=Math.sin(u),I=Math.cos(u),F=Math.sin(A),z=Math.cos(A),B=Math.sin(R),D=Math.cos(R);return e[0]=M*z*D-I*F*B,e[1]=I*F*D+M*z*B,e[2]=I*z*B-M*F*D,e[3]=I*z*D+M*F*B,e}function X1(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var ct,lc,uc,jl,kl,ht,Y1=Du,Z1=ju,Ul=ku,K1=Uu,Q1=Gu,J1=tc,cc=$u,Gl=Zu,ep=Ku,ql=Bl,tp=ql,Wl=Dl,rp=Wl,Vl=Yu,ip=Qu,np=Ju,ap=(ct=Br(),lc=Dr(1,0,0),uc=Dr(0,1,0),function(e,u,A){var R=zl(u,A);return R<-.999999?(qs(ct,lc,u),zu(ct)<1e-6&&qs(ct,uc,u),Nu(ct,ct),ec(e,ct,Math.PI),e):R>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(qs(ct,u,A),e[0]=ct[0],e[1]=ct[1],e[2]=ct[2],e[3]=1+R,Vl(e,e))}),sp=(jl=Ws(),kl=Ws(),function(e,u,A,R,L,M){return Vs(jl,u,L,M),Vs(kl,A,R,M),Vs(e,jl,kl,2*M*(1-M)),e}),op=(ht=Pe(),function(e,u,A,R){return ht[0]=A[0],ht[3]=A[1],ht[6]=A[2],ht[1]=R[0],ht[4]=R[1],ht[7]=R[2],ht[2]=-u[0],ht[5]=-u[1],ht[8]=-u[2],Vl(e,oc(e,ht))});function lp(){var e=new f(8);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function up(e){var u=new f(8);return u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=e[3],u[4]=e[4],u[5]=e[5],u[6]=e[6],u[7]=e[7],u}function cp(e,u,A,R,L,M,I,F){var z=new f(8);return z[0]=e,z[1]=u,z[2]=A,z[3]=R,z[4]=L,z[5]=M,z[6]=I,z[7]=F,z}function hp(e,u,A,R,L,M,I){var F=new f(8);F[0]=e,F[1]=u,F[2]=A,F[3]=R;var z=.5*L,B=.5*M,D=.5*I;return F[4]=z*R+B*A-D*u,F[5]=B*R+D*e-z*A,F[6]=D*R+z*u-B*e,F[7]=-z*e-B*u-D*A,F}function hc(e,u,A){var R=.5*A[0],L=.5*A[1],M=.5*A[2],I=u[0],F=u[1],z=u[2],B=u[3];return e[0]=I,e[1]=F,e[2]=z,e[3]=B,e[4]=R*B+L*z-M*F,e[5]=L*B+M*I-R*z,e[6]=M*B+R*F-L*I,e[7]=-R*I-L*F-M*z,e}function dp(e,u){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*u[0],e[5]=.5*u[1],e[6]=.5*u[2],e[7]=0,e}function fp(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function _p(e,u){var A=Ws();Ns(A,u);var R=new f(3);return Fs(R,u),hc(e,A,R),e}function dc(e,u){return e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=u[3],e[4]=u[4],e[5]=u[5],e[6]=u[6],e[7]=u[7],e}function pp(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function vp(e,u,A,R,L,M,I,F,z){return e[0]=u,e[1]=A,e[2]=R,e[3]=L,e[4]=M,e[5]=I,e[6]=F,e[7]=z,e}var mp=Ul;function bp(e,u){return e[0]=u[4],e[1]=u[5],e[2]=u[6],e[3]=u[7],e}var gp=Ul;function yp(e,u){return e[4]=u[0],e[5]=u[1],e[6]=u[2],e[7]=u[3],e}function Ep(e,u){var A=u[4],R=u[5],L=u[6],M=u[7],I=-u[0],F=-u[1],z=-u[2],B=u[3];return e[0]=2*(A*B+M*I+R*z-L*F),e[1]=2*(R*B+M*F+L*I-A*z),e[2]=2*(L*B+M*z+A*F-R*I),e}function Tp(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=.5*A[0],z=.5*A[1],B=.5*A[2],D=u[4],G=u[5],q=u[6],W=u[7];return e[0]=R,e[1]=L,e[2]=M,e[3]=I,e[4]=I*F+L*B-M*z+D,e[5]=I*z+M*F-R*B+G,e[6]=I*B+R*z-L*F+q,e[7]=-R*F-L*z-M*B+W,e}function xp(e,u,A){var R=-u[0],L=-u[1],M=-u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=F*I+D*R+z*M-B*L,q=z*I+D*L+B*R-F*M,W=B*I+D*M+F*L-z*R,X=D*I-F*R-z*L-B*M;return rc(e,u,A),R=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+X*R+q*M-W*L,e[5]=q*I+X*L+W*R-G*M,e[6]=W*I+X*M+G*L-q*R,e[7]=X*I-G*R-q*L-W*M,e}function Ap(e,u,A){var R=-u[0],L=-u[1],M=-u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=F*I+D*R+z*M-B*L,q=z*I+D*L+B*R-F*M,W=B*I+D*M+F*L-z*R,X=D*I-F*R-z*L-B*M;return ic(e,u,A),R=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+X*R+q*M-W*L,e[5]=q*I+X*L+W*R-G*M,e[6]=W*I+X*M+G*L-q*R,e[7]=X*I-G*R-q*L-W*M,e}function Sp(e,u,A){var R=-u[0],L=-u[1],M=-u[2],I=u[3],F=u[4],z=u[5],B=u[6],D=u[7],G=F*I+D*R+z*M-B*L,q=z*I+D*L+B*R-F*M,W=B*I+D*M+F*L-z*R,X=D*I-F*R-z*L-B*M;return nc(e,u,A),R=e[0],L=e[1],M=e[2],I=e[3],e[4]=G*I+X*R+q*M-W*L,e[5]=q*I+X*L+W*R-G*M,e[6]=W*I+X*M+G*L-q*R,e[7]=X*I-G*R-q*L-W*M,e}function Op(e,u,A){var R=A[0],L=A[1],M=A[2],I=A[3],F=u[0],z=u[1],B=u[2],D=u[3];return e[0]=F*I+D*R+z*M-B*L,e[1]=z*I+D*L+B*R-F*M,e[2]=B*I+D*M+F*L-z*R,e[3]=D*I-F*R-z*L-B*M,F=u[4],z=u[5],B=u[6],D=u[7],e[4]=F*I+D*R+z*M-B*L,e[5]=z*I+D*L+B*R-F*M,e[6]=B*I+D*M+F*L-z*R,e[7]=D*I-F*R-z*L-B*M,e}function Rp(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=A[0],z=A[1],B=A[2],D=A[3];return e[0]=R*D+I*F+L*B-M*z,e[1]=L*D+I*z+M*F-R*B,e[2]=M*D+I*B+R*z-L*F,e[3]=I*D-R*F-L*z-M*B,F=A[4],z=A[5],B=A[6],D=A[7],e[4]=R*D+I*F+L*B-M*z,e[5]=L*D+I*z+M*F-R*B,e[6]=M*D+I*B+R*z-L*F,e[7]=I*D-R*F-L*z-M*B,e}function Pp(e,u,A,R){if(Math.abs(R)<v)return dc(e,u);var L=Math.hypot(A[0],A[1],A[2]);R*=.5;var M=Math.sin(R),I=M*A[0]/L,F=M*A[1]/L,z=M*A[2]/L,B=Math.cos(R),D=u[0],G=u[1],q=u[2],W=u[3];e[0]=D*B+W*I+G*z-q*F,e[1]=G*B+W*F+q*I-D*z,e[2]=q*B+W*z+D*F-G*I,e[3]=W*B-D*I-G*F-q*z;var X=u[4],Y=u[5],V=u[6],Q=u[7];return e[4]=X*B+Q*I+Y*z-V*F,e[5]=Y*B+Q*F+V*I-X*z,e[6]=V*B+Q*z+X*F-Y*I,e[7]=Q*B-X*I-Y*F-V*z,e}function wp(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e[2]=u[2]+A[2],e[3]=u[3]+A[3],e[4]=u[4]+A[4],e[5]=u[5]+A[5],e[6]=u[6]+A[6],e[7]=u[7]+A[7],e}function fc(e,u,A){var R=u[0],L=u[1],M=u[2],I=u[3],F=A[4],z=A[5],B=A[6],D=A[7],G=u[4],q=u[5],W=u[6],X=u[7],Y=A[0],V=A[1],Q=A[2],le=A[3];return e[0]=R*le+I*Y+L*Q-M*V,e[1]=L*le+I*V+M*Y-R*Q,e[2]=M*le+I*Q+R*V-L*Y,e[3]=I*le-R*Y-L*V-M*Q,e[4]=R*D+I*F+L*B-M*z+G*le+X*Y+q*Q-W*V,e[5]=L*D+I*z+M*F-R*B+q*le+X*V+W*Y-G*Q,e[6]=M*D+I*B+R*z-L*F+W*le+X*Q+G*V-q*Y,e[7]=I*D-R*F-L*z-M*B+X*le-G*Y-q*V-W*Q,e}var Lp=fc;function Mp(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e[2]=u[2]*A,e[3]=u[3]*A,e[4]=u[4]*A,e[5]=u[5]*A,e[6]=u[6]*A,e[7]=u[7]*A,e}var _c=Gl;function Ip(e,u,A,R){var L=1-R;return _c(u,A)<0&&(R=-R),e[0]=u[0]*L+A[0]*R,e[1]=u[1]*L+A[1]*R,e[2]=u[2]*L+A[2]*R,e[3]=u[3]*L+A[3]*R,e[4]=u[4]*L+A[4]*R,e[5]=u[5]*L+A[5]*R,e[6]=u[6]*L+A[6]*R,e[7]=u[7]*L+A[7]*R,e}function Fp(e,u){var A=$s(u);return e[0]=-u[0]/A,e[1]=-u[1]/A,e[2]=-u[2]/A,e[3]=u[3]/A,e[4]=-u[4]/A,e[5]=-u[5]/A,e[6]=-u[6]/A,e[7]=u[7]/A,e}function Cp(e,u){return e[0]=-u[0],e[1]=-u[1],e[2]=-u[2],e[3]=u[3],e[4]=-u[4],e[5]=-u[5],e[6]=-u[6],e[7]=u[7],e}var pc=ql,Np=pc,$s=Wl,zp=$s;function Bp(e,u){var A=$s(u);if(A>0){A=Math.sqrt(A);var R=u[0]/A,L=u[1]/A,M=u[2]/A,I=u[3]/A,F=u[4],z=u[5],B=u[6],D=u[7],G=R*F+L*z+M*B+I*D;e[0]=R,e[1]=L,e[2]=M,e[3]=I,e[4]=(F-R*G)/A,e[5]=(z-L*G)/A,e[6]=(B-M*G)/A,e[7]=(D-I*G)/A}return e}function Dp(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function jp(e,u){return e[0]===u[0]&&e[1]===u[1]&&e[2]===u[2]&&e[3]===u[3]&&e[4]===u[4]&&e[5]===u[5]&&e[6]===u[6]&&e[7]===u[7]}function kp(e,u){var A=e[0],R=e[1],L=e[2],M=e[3],I=e[4],F=e[5],z=e[6],B=e[7],D=u[0],G=u[1],q=u[2],W=u[3],X=u[4],Y=u[5],V=u[6],Q=u[7];return Math.abs(A-D)<=v*Math.max(1,Math.abs(A),Math.abs(D))&&Math.abs(R-G)<=v*Math.max(1,Math.abs(R),Math.abs(G))&&Math.abs(L-q)<=v*Math.max(1,Math.abs(L),Math.abs(q))&&Math.abs(M-W)<=v*Math.max(1,Math.abs(M),Math.abs(W))&&Math.abs(I-X)<=v*Math.max(1,Math.abs(I),Math.abs(X))&&Math.abs(F-Y)<=v*Math.max(1,Math.abs(F),Math.abs(Y))&&Math.abs(z-V)<=v*Math.max(1,Math.abs(z),Math.abs(V))&&Math.abs(B-Q)<=v*Math.max(1,Math.abs(B),Math.abs(Q))}function vc(){var e=new f(2);return f!=Float32Array&&(e[0]=0,e[1]=0),e}function Up(e){var u=new f(2);return u[0]=e[0],u[1]=e[1],u}function Gp(e,u){var A=new f(2);return A[0]=e,A[1]=u,A}function qp(e,u){return e[0]=u[0],e[1]=u[1],e}function Wp(e,u,A){return e[0]=u,e[1]=A,e}function Vp(e,u,A){return e[0]=u[0]+A[0],e[1]=u[1]+A[1],e}function mc(e,u,A){return e[0]=u[0]-A[0],e[1]=u[1]-A[1],e}function bc(e,u,A){return e[0]=u[0]*A[0],e[1]=u[1]*A[1],e}function gc(e,u,A){return e[0]=u[0]/A[0],e[1]=u[1]/A[1],e}function $p(e,u){return e[0]=Math.ceil(u[0]),e[1]=Math.ceil(u[1]),e}function Hp(e,u){return e[0]=Math.floor(u[0]),e[1]=Math.floor(u[1]),e}function Xp(e,u,A){return e[0]=Math.min(u[0],A[0]),e[1]=Math.min(u[1],A[1]),e}function Yp(e,u,A){return e[0]=Math.max(u[0],A[0]),e[1]=Math.max(u[1],A[1]),e}function Zp(e,u){return e[0]=Math.round(u[0]),e[1]=Math.round(u[1]),e}function Kp(e,u,A){return e[0]=u[0]*A,e[1]=u[1]*A,e}function Qp(e,u,A,R){return e[0]=u[0]+A[0]*R,e[1]=u[1]+A[1]*R,e}function yc(e,u){var A=u[0]-e[0],R=u[1]-e[1];return Math.hypot(A,R)}function Ec(e,u){var A=u[0]-e[0],R=u[1]-e[1];return A*A+R*R}function Tc(e){var u=e[0],A=e[1];return Math.hypot(u,A)}function xc(e){var u=e[0],A=e[1];return u*u+A*A}function Jp(e,u){return e[0]=-u[0],e[1]=-u[1],e}function ev(e,u){return e[0]=1/u[0],e[1]=1/u[1],e}function tv(e,u){var A=u[0],R=u[1],L=A*A+R*R;return L>0&&(L=1/Math.sqrt(L)),e[0]=u[0]*L,e[1]=u[1]*L,e}function rv(e,u){return e[0]*u[0]+e[1]*u[1]}function iv(e,u,A){var R=u[0]*A[1]-u[1]*A[0];return e[0]=e[1]=0,e[2]=R,e}function nv(e,u,A,R){var L=u[0],M=u[1];return e[0]=L+R*(A[0]-L),e[1]=M+R*(A[1]-M),e}function av(e,u){u=u||1;var A=2*b()*Math.PI;return e[0]=Math.cos(A)*u,e[1]=Math.sin(A)*u,e}function sv(e,u,A){var R=u[0],L=u[1];return e[0]=A[0]*R+A[2]*L,e[1]=A[1]*R+A[3]*L,e}function ov(e,u,A){var R=u[0],L=u[1];return e[0]=A[0]*R+A[2]*L+A[4],e[1]=A[1]*R+A[3]*L+A[5],e}function lv(e,u,A){var R=u[0],L=u[1];return e[0]=A[0]*R+A[3]*L+A[6],e[1]=A[1]*R+A[4]*L+A[7],e}function uv(e,u,A){var R=u[0],L=u[1];return e[0]=A[0]*R+A[4]*L+A[12],e[1]=A[1]*R+A[5]*L+A[13],e}function cv(e,u,A,R){var L=u[0]-A[0],M=u[1]-A[1],I=Math.sin(R),F=Math.cos(R);return e[0]=L*F-M*I+A[0],e[1]=L*I+M*F+A[1],e}function hv(e,u){var A=e[0],R=e[1],L=u[0],M=u[1],I=Math.sqrt(A*A+R*R)*Math.sqrt(L*L+M*M),F=I&&(A*L+R*M)/I;return Math.acos(Math.min(Math.max(F,-1),1))}function dv(e){return e[0]=0,e[1]=0,e}function fv(e){return"vec2("+e[0]+", "+e[1]+")"}function _v(e,u){return e[0]===u[0]&&e[1]===u[1]}function pv(e,u){var A=e[0],R=e[1],L=u[0],M=u[1];return Math.abs(A-L)<=v*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(R-M)<=v*Math.max(1,Math.abs(R),Math.abs(M))}var vv=Tc,mv=mc,bv=bc,gv=gc,yv=yc,Ev=Ec,Tv=xc,xv=function(){var e=vc();return function(u,A,R,L,M,I){var F,z;for(A||(A=2),R||(R=0),z=L?Math.min(L*A+R,u.length):u.length,F=R;F<z;F+=A)e[0]=u[F],e[1]=u[F+1],M(e,e,I),u[F]=e[0],u[F+1]=e[1];return u}}()},4613:p=>{p.exports=function(t){var i={};function a(r){if(i[r])return i[r].exports;var h=i[r]={i:r,l:!1,exports:{}};return t[r].call(h.exports,h,h.exports,a),h.l=!0,h.exports}return a.m=t,a.c=i,a.d=function(r,h,_){a.o(r,h)||Object.defineProperty(r,h,{enumerable:!0,get:_})},a.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},a.t=function(r,h){if(1&h&&(r=a(r)),8&h||4&h&&typeof r=="object"&&r&&r.__esModule)return r;var _=Object.create(null);if(a.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:r}),2&h&&typeof r!="string")for(var d in r)a.d(_,d,(function(c){return r[c]}).bind(null,d));return _},a.n=function(r){var h=r&&r.__esModule?function(){return r.default}:function(){return r};return a.d(h,"a",h),h},a.o=function(r,h){return Object.prototype.hasOwnProperty.call(r,h)},a.p="",a(a.s=7)}([function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(r){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(r,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(r){this.itemsLoaded++,this.onProgress&&this.onProgress(r,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(r){this.onError&&this.onError(r)}resolveURL(r){return this.urlModifier?this.urlModifier(r):r}}},function(t,i,a){var r=this&&this.__awaiter||function(o,l,m,v){return new(m||(m=Promise))(function(f,b){function x(S){try{O(v.next(S))}catch(w){b(w)}}function E(S){try{O(v.throw(S))}catch(w){b(w)}}function O(S){S.done?f(S.value):new m(function(w){w(S.value)}).then(x,E)}O((v=v.apply(o,l||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const h=a(3),_=a(0);i.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},i.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i.GltfAsset=class{constructor(o,l,m,v=new _.LoadingManager){this.gltf=o,this.glbData=m,this.bufferData=new d(this,l,v),this.imageData=new c(this,l,v)}bufferViewData(o){return r(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const l=this.gltf.bufferViews[o],m=yield this.bufferData.get(l.buffer),v=l.byteLength||0,f=l.byteOffset||0,b=m.buffer,x=m.byteOffset;return new Uint8Array(b,x+f,v)})}accessorData(o){return r(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const l=this.gltf.accessors[o],m=i.GLTF_ELEMENTS_PER_TYPE[l.type];let v;if(l.bufferView!==void 0)v=yield this.bufferViewData(l.bufferView);else{const f=i.GLTF_COMPONENT_TYPE_ARRAYS[l.componentType].BYTES_PER_ELEMENT*m*l.count;v=new Uint8Array(f)}if(l.sparse){const{count:f,indices:b,values:x}=l.sparse;let E=i.GLTF_COMPONENT_TYPE_ARRAYS[b.componentType],O=yield this.bufferViewData(b.bufferView);const S=new E(O.buffer,O.byteOffset+(b.byteOffset||0),f);E=i.GLTF_COMPONENT_TYPE_ARRAYS[l.componentType],O=yield this.bufferViewData(x.bufferView);const w=new E((yield this.bufferViewData(x.bufferView)).buffer,O.byteOffset+(x.byteOffset||0),f*m);l.bufferView&&(v=new Uint8Array(v));const P=new i.GLTF_COMPONENT_TYPE_ARRAYS[l.componentType](v.buffer);for(let N=0;N<f;N++)for(let k=0;k<m;k++)P[m*S[N]+k]=w[m*N+k]}return v})}preFetchAll(){return r(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class d{constructor(l,m,v){this.bufferCache=[],this.asset=l,this.baseUri=m,this.manager=v,this.loader=new h.FileLoader(v),this.loader.responseType="arraybuffer"}get(l){return r(this,void 0,void 0,function*(){if(this.bufferCache[l]!==void 0)return this.bufferCache[l];const m=this.asset.gltf;if(!m.buffers)throw new Error("No buffers found.");const v=m.buffers[l];if(v.uri===void 0){if(l!==0)throw new Error("GLB container is required to be the first buffer");if(this.asset.glbData===void 0)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const f=s(v.uri,this.baseUri),b=yield this.loader.load(f),x=new Uint8Array(b);return this.bufferCache[l]=x,x})}preFetchAll(){return r(this,void 0,void 0,function*(){const l=this.asset.gltf.buffers;return l?Promise.all(l.map((m,v)=>this.get(v))):[]})}}i.BufferData=d;class c{constructor(l,m,v){this.crossOrigin="anonymous",this.imageCache=[],this.asset=l,this.baseUri=m,this.manager=v}get(l){return r(this,void 0,void 0,function*(){if(this.imageCache[l]!==void 0)return this.imageCache[l];const m=this.asset.gltf;if(!m.images)throw new Error("No images found.");const v=m.images[l];let f,b=!1;if(v.bufferView!==void 0){const E=yield this.asset.bufferViewData(v.bufferView);b=!0;const O=new Blob([E],{type:v.mimeType});f=URL.createObjectURL(O)}else{if(v.uri===void 0)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");f=this.manager.resolveURL(s(v.uri,this.baseUri))}const x=new Image;return x.crossOrigin=this.crossOrigin,new Promise((E,O)=>{x.onerror=()=>{O(`Failed to load ${f}`),this.manager.itemEnd(f),this.manager.itemError(f)},x.onload=()=>{b&&URL.revokeObjectURL(f),this.imageCache[l]=x,E(x),this.manager.itemEnd(f)},x.src=f,this.manager.itemStart(f)})})}preFetchAll(){return r(this,void 0,void 0,function*(){const l=this.asset.gltf.images;return l?Promise.all(l.map((m,v)=>this.get(v))):[]})}}function s(o,l){return typeof o!="string"||o===""?"":/^(https?:)?\/\//i.test(o)||/^data:.*,.*$/i.test(o)||/^blob:.*$/i.test(o)?o:l+o}i.ImageData=c,i.resolveURL=s},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.LoaderUtils=class{static decodeText(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let h="";for(const _ of r)h+=String.fromCharCode(_);return decodeURIComponent(escape(h))}static extractUrlBase(r){const h=r.split("/");return h.length===1?"./":(h.pop(),h.join("/")+"/")}}},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0}),i.FileLoader=class{constructor(r){this.runningRequests={},this.manager=r}load(r,h){if(this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r),this.runningRequests[r])return this.runningRequests[r];const _=new Promise((d,c)=>{const s=new XMLHttpRequest;s.open("GET",r,!0);const o=this;s.onload=function(l){const m=this.response;this.status===0?(console.warn("FileLoader: HTTP Status 0 received."),d(m),o.manager.itemEnd(r)):this.status===200?(d(m),o.manager.itemEnd(r)):(c({url:r,status:this.status,statusText:s.statusText}),o.manager.itemEnd(r),o.manager.itemError(r)),delete o.runningRequests[r]},s.onprogress=l=>{h&&h(l)},s.onerror=function(l){c({url:r,status:this.status,statusText:s.statusText}),o.manager.itemEnd(r),o.manager.itemError(r),delete o.runningRequests[r]},this.responseType&&(s.responseType=this.responseType),this.withCredentials&&(s.withCredentials=this.withCredentials),this.mimeType&&s.overrideMimeType&&s.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const l in this.requestHeaders)s.setRequestHeader(l,this.requestHeaders[l]);s.send(null),this.manager.itemStart(r)});return this.runningRequests[r]=_,_}setRequestHeader(r,h){return this.requestHeaders[r]=h,this}}},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0})},function(t,i,a){Object.defineProperty(i,"__esModule",{value:!0});const r=a(2);i.BINARY_HEADER_MAGIC="glTF",i.GLTFBinaryData=class{constructor(h){const _=new DataView(h,0,12),d=r.LoaderUtils.decodeText(new Uint8Array(h,0,4)),c=_.getUint32(4,!0);if(_.getUint32(8,!0),d!==i.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(c<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(h,12);let o=0;for(;o<s.byteLength;){const l=s.getUint32(o,!0);o+=4;const m=s.getUint32(o,!0);if(o+=4,m===1313821514){const v=new Uint8Array(h,12+o,l);this.json=r.LoaderUtils.decodeText(v)}else if(m===5130562){const v=12+o;this.binaryChunk=new Uint8Array(h,v,l)}o+=l}if(this.json===null)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,i,a){var r=this&&this.__awaiter||function(m,v,f,b){return new(f||(f=Promise))(function(x,E){function O(P){try{w(b.next(P))}catch(N){E(N)}}function S(P){try{w(b.throw(P))}catch(N){E(N)}}function w(P){P.done?x(P.value):new f(function(N){N(P.value)}).then(O,S)}w((b=b.apply(m,v||[])).next())})};function h(m){for(var v in m)i.hasOwnProperty(v)||(i[v]=m[v])}Object.defineProperty(i,"__esModule",{value:!0});const _=a(3),d=a(5),c=a(1),s=a(2),o=a(0),l=a(4);i.gltf=l,h(a(1)),h(a(0)),i.GltfLoader=class{constructor(m){this.manager=m||new o.LoadingManager}load(m,v){return r(this,void 0,void 0,function*(){const f=s.LoaderUtils.extractUrlBase(m),b=new _.FileLoader(this.manager);b.responseType="arraybuffer";const x=yield b.load(m,v);return yield this.parse(x,f)})}loadFromFiles(m){return r(this,void 0,void 0,function*(){let v,f;for(const[S,w]of m)w.name.match(/\.(gltf|glb)$/)&&(v=w,f=S.replace(w.name,""));if(!v)throw new Error("No .gltf or .glb asset found.");const b=typeof v=="string"?v:URL.createObjectURL(v),x=s.LoaderUtils.extractUrlBase(b),E=[];this.manager.urlModifier=S=>{const w=f+S.replace(x,"").replace(/^(\.?\/)/,"");if(m.has(w)){const P=m.get(w),N=URL.createObjectURL(P);return E.push(N),N}return S};const O=yield this.load(b);return yield O.preFetchAll(),URL.revokeObjectURL(b),E.forEach(URL.revokeObjectURL),O})}parse(m,v){return r(this,void 0,void 0,function*(){let f,b;f=typeof m=="string"?m:s.LoaderUtils.decodeText(new Uint8Array(m,0,4))===d.BINARY_HEADER_MAGIC?(b=new d.GLTFBinaryData(m)).json:s.LoaderUtils.decodeText(new Uint8Array(m));const x=JSON.parse(f);if(x.asset===void 0||x.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new c.GltfAsset(x,v,b,this.manager)})}}},function(t,i,a){t.exports=a(6)}])},7648:(p,t,i)=>{var a=i(6433),r=a.ValidatorResult,h=a.SchemaError,_={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},d=_.validators={};function c(v,f,b,x,E){var O=f.throwError,S=f.throwAll;f.throwError=!1,f.throwAll=!1;var w=this.validateSchema(v,E,f,b);return f.throwError=O,f.throwAll=S,!w.valid&&x instanceof Function&&x(w),w.valid}function s(v,f){if(Object.hasOwnProperty.call(v,f))return v[f];if(f in v){for(;v=Object.getPrototypeOf(v);)if(Object.propertyIsEnumerable.call(v,f))return v[f]}}function o(v,f,b,x,E,O){if(this.types.object(v)&&(!f.properties||f.properties[E]===void 0))if(f.additionalProperties===!1)O.addError({name:"additionalProperties",argument:E,message:"is not allowed to have the additional property "+JSON.stringify(E)});else{var S=f.additionalProperties||{};typeof b.preValidateProperty=="function"&&b.preValidateProperty(v,E,S,b,x);var w=this.validateSchema(v[E],S,b,x.makeChild(S,E));w.instance!==O.instance[E]&&(O.instance[E]=w.instance),O.importErrors(w)}}d.type=function(v,f,b,x){if(v===void 0)return null;var E=new r(v,f,b,x),O=Array.isArray(f.type)?f.type:[f.type];if(!O.some(this.testType.bind(this,v,f,b,x))){var S=O.map(function(w){if(w){var P=w.$id||w.id;return P?"<"+P+">":w+""}});E.addError({name:"type",argument:S,message:"is not of a type(s) "+S})}return E},d.anyOf=function(v,f,b,x){if(v===void 0)return null;var E=new r(v,f,b,x),O=new r(v,f,b,x);if(!Array.isArray(f.anyOf))throw new h("anyOf must be an array");if(!f.anyOf.some(c.bind(this,v,b,x,function(w){O.importErrors(w)}))){var S=f.anyOf.map(function(w,P){var N=w.$id||w.id;return N?"<"+N+">":w.title&&JSON.stringify(w.title)||w.$ref&&"<"+w.$ref+">"||"[subschema "+P+"]"});b.nestedErrors&&E.importErrors(O),E.addError({name:"anyOf",argument:S,message:"is not any of "+S.join(",")})}return E},d.allOf=function(v,f,b,x){if(v===void 0)return null;if(!Array.isArray(f.allOf))throw new h("allOf must be an array");var E=new r(v,f,b,x),O=this;return f.allOf.forEach(function(S,w){var P=O.validateSchema(v,S,b,x);if(!P.valid){var N=S.$id||S.id||S.title&&JSON.stringify(S.title)||S.$ref&&"<"+S.$ref+">"||"[subschema "+w+"]";E.addError({name:"allOf",argument:{id:N,length:P.errors.length,valid:P},message:"does not match allOf schema "+N+" with "+P.errors.length+" error[s]:"}),E.importErrors(P)}}),E},d.oneOf=function(v,f,b,x){if(v===void 0)return null;if(!Array.isArray(f.oneOf))throw new h("oneOf must be an array");var E=new r(v,f,b,x),O=new r(v,f,b,x),S=f.oneOf.filter(c.bind(this,v,b,x,function(P){O.importErrors(P)})).length,w=f.oneOf.map(function(P,N){return P.$id||P.id||P.title&&JSON.stringify(P.title)||P.$ref&&"<"+P.$ref+">"||"[subschema "+N+"]"});return S!==1&&(b.nestedErrors&&E.importErrors(O),E.addError({name:"oneOf",argument:w,message:"is not exactly one from "+w.join(",")})),E},d.if=function(v,f,b,x){if(v===void 0)return null;if(!a.isSchema(f.if))throw new Error('Expected "if" keyword to be a schema');var E,O=c.call(this,v,b,x,null,f.if),S=new r(v,f,b,x);if(O){if(f.then===void 0)return;if(!a.isSchema(f.then))throw new Error('Expected "then" keyword to be a schema');E=this.validateSchema(v,f.then,b,x.makeChild(f.then)),S.importErrors(E)}else{if(f.else===void 0)return;if(!a.isSchema(f.else))throw new Error('Expected "else" keyword to be a schema');E=this.validateSchema(v,f.else,b,x.makeChild(f.else)),S.importErrors(E)}return S},d.propertyNames=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x),O=f.propertyNames!==void 0?f.propertyNames:{};if(!a.isSchema(O))throw new h('Expected "propertyNames" to be a schema (object or boolean)');for(var S in v)if(s(v,S)!==void 0){var w=this.validateSchema(S,O,b,x.makeChild(O));E.importErrors(w)}return E}},d.properties=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x),O=f.properties||{};for(var S in O){var w=O[S];if(w!==void 0){if(w===null)throw new h('Unexpected null, expected schema in "properties"');typeof b.preValidateProperty=="function"&&b.preValidateProperty(v,S,w,b,x);var P=s(v,S),N=this.validateSchema(P,w,b,x.makeChild(w,S));N.instance!==E.instance[S]&&(E.instance[S]=N.instance),E.importErrors(N)}}return E}},d.patternProperties=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x),O=f.patternProperties||{};for(var S in v){var w=!0;for(var P in O){var N=O[P];if(N!==void 0){if(N===null)throw new h('Unexpected null, expected schema in "patternProperties"');try{var k=new RegExp(P,"u")}catch{k=new RegExp(P)}if(k.test(S)){w=!1,typeof b.preValidateProperty=="function"&&b.preValidateProperty(v,S,N,b,x);var j=this.validateSchema(v[S],N,b,x.makeChild(N,S));j.instance!==E.instance[S]&&(E.instance[S]=j.instance),E.importErrors(j)}}}w&&o.call(this,v,f,b,x,S,E)}return E}},d.additionalProperties=function(v,f,b,x){if(this.types.object(v)){if(f.patternProperties)return null;var E=new r(v,f,b,x);for(var O in v)o.call(this,v,f,b,x,O,E);return E}},d.minProperties=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x);return Object.keys(v).length>=f.minProperties||E.addError({name:"minProperties",argument:f.minProperties,message:"does not meet minimum property length of "+f.minProperties}),E}},d.maxProperties=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x);return Object.keys(v).length<=f.maxProperties||E.addError({name:"maxProperties",argument:f.maxProperties,message:"does not meet maximum property length of "+f.maxProperties}),E}},d.items=function(v,f,b,x){var E=this;if(this.types.array(v)&&f.items!==void 0){var O=new r(v,f,b,x);return v.every(function(S,w){if(Array.isArray(f.items))var P=f.items[w]===void 0?f.additionalItems:f.items[w];else P=f.items;if(P===void 0)return!0;if(P===!1)return O.addError({name:"items",message:"additionalItems not permitted"}),!1;var N=E.validateSchema(S,P,b,x.makeChild(P,w));return N.instance!==O.instance[w]&&(O.instance[w]=N.instance),O.importErrors(N),!0}),O}},d.contains=function(v,f,b,x){var E=this;if(this.types.array(v)&&f.contains!==void 0){if(!a.isSchema(f.contains))throw new Error('Expected "contains" keyword to be a schema');var O=new r(v,f,b,x);return v.some(function(S,w){return E.validateSchema(S,f.contains,b,x.makeChild(f.contains,w)).errors.length===0})===!1&&O.addError({name:"contains",argument:f.contains,message:"must contain an item matching given schema"}),O}},d.minimum=function(v,f,b,x){if(this.types.number(v)){var E=new r(v,f,b,x);return f.exclusiveMinimum&&f.exclusiveMinimum===!0?v>f.minimum||E.addError({name:"minimum",argument:f.minimum,message:"must be greater than "+f.minimum}):v>=f.minimum||E.addError({name:"minimum",argument:f.minimum,message:"must be greater than or equal to "+f.minimum}),E}},d.maximum=function(v,f,b,x){if(this.types.number(v)){var E=new r(v,f,b,x);return f.exclusiveMaximum&&f.exclusiveMaximum===!0?v<f.maximum||E.addError({name:"maximum",argument:f.maximum,message:"must be less than "+f.maximum}):v<=f.maximum||E.addError({name:"maximum",argument:f.maximum,message:"must be less than or equal to "+f.maximum}),E}},d.exclusiveMinimum=function(v,f,b,x){if(typeof f.exclusiveMinimum!="boolean"&&this.types.number(v)){var E=new r(v,f,b,x);return v>f.exclusiveMinimum||E.addError({name:"exclusiveMinimum",argument:f.exclusiveMinimum,message:"must be strictly greater than "+f.exclusiveMinimum}),E}},d.exclusiveMaximum=function(v,f,b,x){if(typeof f.exclusiveMaximum!="boolean"&&this.types.number(v)){var E=new r(v,f,b,x);return v<f.exclusiveMaximum||E.addError({name:"exclusiveMaximum",argument:f.exclusiveMaximum,message:"must be strictly less than "+f.exclusiveMaximum}),E}};var l=function(v,f,b,x,E,O){if(this.types.number(v)){var S=f[E];if(S==0)throw new h(E+" cannot be zero");var w=new r(v,f,b,x),P=a.getDecimalPlaces(v),N=a.getDecimalPlaces(S),k=Math.max(P,N),j=Math.pow(10,k);return Math.round(v*j)%Math.round(S*j)!=0&&w.addError({name:E,argument:S,message:O+JSON.stringify(S)}),w}};function m(v,f,b){var x,E=b.length;for(x=f+1;x<E;x++)if(a.deepCompareStrict(v,b[x]))return!1;return!0}d.multipleOf=function(v,f,b,x){return l.call(this,v,f,b,x,"multipleOf","is not a multiple of (divisible by) ")},d.divisibleBy=function(v,f,b,x){return l.call(this,v,f,b,x,"divisibleBy","is not divisible by (multiple of) ")},d.required=function(v,f,b,x){var E=new r(v,f,b,x);return v===void 0&&f.required===!0?E.addError({name:"required",message:"is required"}):this.types.object(v)&&Array.isArray(f.required)&&f.required.forEach(function(O){s(v,O)===void 0&&E.addError({name:"required",argument:O,message:"requires property "+JSON.stringify(O)})}),E},d.pattern=function(v,f,b,x){if(this.types.string(v)){var E=new r(v,f,b,x),O=f.pattern;try{var S=new RegExp(O,"u")}catch{S=new RegExp(O)}return v.match(S)||E.addError({name:"pattern",argument:f.pattern,message:"does not match pattern "+JSON.stringify(f.pattern.toString())}),E}},d.format=function(v,f,b,x){if(v!==void 0){var E=new r(v,f,b,x);return E.disableFormat||a.isFormat(v,f.format,this)||E.addError({name:"format",argument:f.format,message:"does not conform to the "+JSON.stringify(f.format)+" format"}),E}},d.minLength=function(v,f,b,x){if(this.types.string(v)){var E=new r(v,f,b,x),O=v.match(/[\uDC00-\uDFFF]/g);return v.length-(O?O.length:0)>=f.minLength||E.addError({name:"minLength",argument:f.minLength,message:"does not meet minimum length of "+f.minLength}),E}},d.maxLength=function(v,f,b,x){if(this.types.string(v)){var E=new r(v,f,b,x),O=v.match(/[\uDC00-\uDFFF]/g);return v.length-(O?O.length:0)<=f.maxLength||E.addError({name:"maxLength",argument:f.maxLength,message:"does not meet maximum length of "+f.maxLength}),E}},d.minItems=function(v,f,b,x){if(this.types.array(v)){var E=new r(v,f,b,x);return v.length>=f.minItems||E.addError({name:"minItems",argument:f.minItems,message:"does not meet minimum length of "+f.minItems}),E}},d.maxItems=function(v,f,b,x){if(this.types.array(v)){var E=new r(v,f,b,x);return v.length<=f.maxItems||E.addError({name:"maxItems",argument:f.maxItems,message:"does not meet maximum length of "+f.maxItems}),E}},d.uniqueItems=function(v,f,b,x){if(f.uniqueItems===!0&&this.types.array(v)){var E=new r(v,f,b,x);return v.every(m)||E.addError({name:"uniqueItems",message:"contains duplicate item"}),E}},d.dependencies=function(v,f,b,x){if(this.types.object(v)){var E=new r(v,f,b,x);for(var O in f.dependencies)if(v[O]!==void 0){var S=f.dependencies[O],w=x.makeChild(S,O);if(typeof S=="string"&&(S=[S]),Array.isArray(S))S.forEach(function(N){v[N]===void 0&&E.addError({name:"dependencies",argument:w.propertyPath,message:"property "+N+" not found, required by "+w.propertyPath})});else{var P=this.validateSchema(v,S,b,w);E.instance!==P.instance&&(E.instance=P.instance),P&&P.errors.length&&(E.addError({name:"dependencies",argument:w.propertyPath,message:"does not meet dependency required by "+w.propertyPath}),E.importErrors(P))}}return E}},d.enum=function(v,f,b,x){if(v===void 0)return null;if(!Array.isArray(f.enum))throw new h("enum expects an array",f);var E=new r(v,f,b,x);return f.enum.some(a.deepCompareStrict.bind(null,v))||E.addError({name:"enum",argument:f.enum,message:"is not one of enum values: "+f.enum.map(String).join(",")}),E},d.const=function(v,f,b,x){if(v===void 0)return null;var E=new r(v,f,b,x);return a.deepCompareStrict(f.const,v)||E.addError({name:"const",argument:f.const,message:"does not exactly match expected constant: "+f.const}),E},d.not=d.disallow=function(v,f,b,x){var E=this;if(v===void 0)return null;var O=new r(v,f,b,x),S=f.not||f.disallow;return S?(Array.isArray(S)||(S=[S]),S.forEach(function(w){if(E.testType(v,f,b,x,w)){var P=w&&(w.$id||w.id)||w;O.addError({name:"not",argument:P,message:"is of prohibited type "+P})}}),O):null},p.exports=_},6433:(p,t,i)=>{var a=i(9983),r=t.ValidationError=function(E,O,S,w,P,N){if(Array.isArray(w)?(this.path=w,this.property=w.reduce(function(j,U){return j+l(U)},"instance")):w!==void 0&&(this.property=w),E&&(this.message=E),S){var k=S.$id||S.id;this.schema=k||S}O!==void 0&&(this.instance=O),this.name=P,this.argument=N,this.stack=this.toString()};r.prototype.toString=function(){return this.property+" "+this.message};var h=t.ValidatorResult=function(E,O,S,w){this.instance=E,this.schema=O,this.options=S,this.path=w.path,this.propertyPath=w.propertyPath,this.errors=[],this.throwError=S&&S.throwError,this.throwFirst=S&&S.throwFirst,this.throwAll=S&&S.throwAll,this.disableFormat=S&&S.disableFormat===!0};function _(E,O){return O+": "+E.toString()+`
`}function d(E){Error.captureStackTrace&&Error.captureStackTrace(this,d),this.instance=E.instance,this.schema=E.schema,this.options=E.options,this.errors=E.errors}h.prototype.addError=function(E){var O;if(typeof E=="string")O=new r(E,this.instance,this.schema,this.path);else{if(!E)throw new Error("Missing error detail");if(!E.message)throw new Error("Missing error message");if(!E.name)throw new Error("Missing validator type");O=new r(E.message,this.instance,this.schema,this.path,E.name,E.argument)}if(this.errors.push(O),this.throwFirst)throw new d(this);if(this.throwError)throw O;return O},h.prototype.importErrors=function(E){typeof E=="string"||E&&E.validatorType?this.addError(E):E&&E.errors&&(this.errors=this.errors.concat(E.errors))},h.prototype.toString=function(E){return this.errors.map(_).join("")},Object.defineProperty(h.prototype,"valid",{get:function(){return!this.errors.length}}),p.exports.ValidatorResultError=d,d.prototype=new Error,d.prototype.constructor=d,d.prototype.name="Validation Error";var c=t.SchemaError=function E(O,S){this.message=O,this.schema=S,Error.call(this,O),Error.captureStackTrace(this,E)};c.prototype=Object.create(Error.prototype,{constructor:{value:c,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var s=t.SchemaContext=function(E,O,S,w,P){this.schema=E,this.options=O,Array.isArray(S)?(this.path=S,this.propertyPath=S.reduce(function(N,k){return N+l(k)},"instance")):this.propertyPath=S,this.base=w,this.schemas=P};s.prototype.resolve=function(E){return a.resolve(this.base,E)},s.prototype.makeChild=function(E,O){var S=O===void 0?this.path:this.path.concat([O]),w=E.$id||E.id,P=a.resolve(this.base,w||""),N=new s(E,this.options,S,P,Object.create(this.schemas));return w&&!N.schemas[P]&&(N.schemas[P]=E),N};var o=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(E){return typeof E=="string"&&parseFloat(E)===parseInt(E,10)&&!isNaN(E)},regex:function(E){var O=!0;try{new RegExp(E)}catch{O=!1}return O},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};o.regexp=o.regex,o.pattern=o.regex,o.ipv4=o["ip-address"],t.isFormat=function(E,O,S){if(typeof E=="string"&&o[O]!==void 0){if(o[O]instanceof RegExp)return o[O].test(E);if(typeof o[O]=="function")return o[O](E)}else if(S&&S.customFormats&&typeof S.customFormats[O]=="function")return S.customFormats[O](E);return!0};var l=t.makeSuffix=function(E){return(E=E.toString()).match(/[.\s\[\]]/)||E.match(/^[\d]/)?E.match(/^\d+$/)?"["+E+"]":"["+JSON.stringify(E)+"]":"."+E};function m(E,O,S,w){typeof S=="object"?O[w]=b(E[w],S):E.indexOf(S)===-1&&O.push(S)}function v(E,O,S){O[S]=E[S]}function f(E,O,S,w){typeof O[w]=="object"&&O[w]&&E[w]?S[w]=b(E[w],O[w]):S[w]=O[w]}function b(E,O){var S=Array.isArray(O),w=S&&[]||{};return S?(E=E||[],w=w.concat(E),O.forEach(m.bind(null,E,w))):(E&&typeof E=="object"&&Object.keys(E).forEach(v.bind(null,E,w)),Object.keys(O).forEach(f.bind(null,E,O,w))),w}function x(E){return"/"+encodeURIComponent(E).replace(/~/g,"%7E")}t.deepCompareStrict=function E(O,S){if(typeof O!=typeof S)return!1;if(Array.isArray(O))return!!Array.isArray(S)&&O.length===S.length&&O.every(function(N,k){return E(O[k],S[k])});if(typeof O=="object"){if(!O||!S)return O===S;var w=Object.keys(O),P=Object.keys(S);return w.length===P.length&&w.every(function(N){return E(O[N],S[N])})}return O===S},p.exports.deepMerge=b,t.objectGetPath=function(E,O){for(var S,w=O.split("/").slice(1);typeof(S=w.shift())=="string";){var P=decodeURIComponent(S.replace(/~0/,"~").replace(/~1/g,"/"));if(!(P in E))return;E=E[P]}return E},t.encodePath=function(E){return E.map(x).join("")},t.getDecimalPlaces=function(E){var O=0;if(isNaN(E))return O;typeof E!="number"&&(E=Number(E));var S=E.toString().split("e");if(S.length===2){if(S[1][0]!=="-")return O;O=Number(S[1].slice(1))}var w=S[0].split(".");return w.length===2&&(O+=w[1].length),O},t.isSchema=function(E){return typeof E=="object"&&E||typeof E=="boolean"}},3780:(p,t,i)=>{var a=p.exports.Validator=i(4622);p.exports.ValidatorResult=i(6433).ValidatorResult,p.exports.ValidatorResultError=i(6433).ValidatorResultError,p.exports.ValidationError=i(6433).ValidationError,p.exports.SchemaError=i(6433).SchemaError,p.exports.SchemaScanResult=i(8075).SchemaScanResult,p.exports.scan=i(8075).scan,p.exports.validate=function(r,h,_){return new a().validate(r,h,_)}},8075:(p,t,i)=>{var a=i(9983),r=i(6433);function h(_,d){this.id=_,this.ref=d}p.exports.SchemaScanResult=h,p.exports.scan=function(_,d){function c(v,f){if(f&&typeof f=="object")if(f.$ref){var b=a.resolve(v,f.$ref);m[b]=m[b]?m[b]+1:0}else{var x=f.$id||f.id,E=x?a.resolve(v,x):v;if(E){if(E.indexOf("#")<0&&(E+="#"),l[E]){if(!r.deepCompareStrict(l[E],f))throw new Error("Schema <"+E+"> already exists with different definition");return l[E]}l[E]=f,E[E.length-1]=="#"&&(l[E.substring(0,E.length-1)]=f)}s(E+"/items",Array.isArray(f.items)?f.items:[f.items]),s(E+"/extends",Array.isArray(f.extends)?f.extends:[f.extends]),c(E+"/additionalItems",f.additionalItems),o(E+"/properties",f.properties),c(E+"/additionalProperties",f.additionalProperties),o(E+"/definitions",f.definitions),o(E+"/patternProperties",f.patternProperties),o(E+"/dependencies",f.dependencies),s(E+"/disallow",f.disallow),s(E+"/allOf",f.allOf),s(E+"/anyOf",f.anyOf),s(E+"/oneOf",f.oneOf),c(E+"/not",f.not)}}function s(v,f){if(Array.isArray(f))for(var b=0;b<f.length;b++)c(v+"/"+b,f[b])}function o(v,f){if(f&&typeof f=="object")for(var b in f)c(v+"/"+b,f[b])}var l={},m={};return c(_,d),new h(l,m)}},4622:(p,t,i)=>{var a=i(9983),r=i(7648),h=i(6433),_=i(8075).scan,d=h.ValidatorResult,c=h.ValidatorResultError,s=h.SchemaError,o=h.SchemaContext,l=function f(){this.customFormats=Object.create(f.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(v),this.attributes=Object.create(r.validators)};function m(f){var b=typeof f=="string"?f:f.$ref;return typeof b=="string"&&b}l.prototype.customFormats={},l.prototype.schemas=null,l.prototype.types=null,l.prototype.attributes=null,l.prototype.unresolvedRefs=null,l.prototype.addSchema=function(f,b){var x=this;if(!f)return null;var E=_(b||"/",f),O=b||f.$id||f.id;for(var S in E.id)this.schemas[S]=E.id[S];for(var S in E.ref)this.unresolvedRefs.push(S);return this.unresolvedRefs=this.unresolvedRefs.filter(function(w){return x.schemas[w]===void 0}),this.schemas[O]},l.prototype.addSubSchemaArray=function(f,b){if(Array.isArray(b))for(var x=0;x<b.length;x++)this.addSubSchema(f,b[x])},l.prototype.addSubSchemaObject=function(f,b){if(b&&typeof b=="object")for(var x in b)this.addSubSchema(f,b[x])},l.prototype.setSchemas=function(f){this.schemas=f},l.prototype.getSchema=function(f){return this.schemas[f]},l.prototype.validate=function(f,b,x,E){if(typeof b!="boolean"&&typeof b!="object"||b===null)throw new s("Expected `schema` to be an object or boolean");x||(x={});var O,S=b.$id||b.id,w=a.resolve(x.base||"/",S||"");if(!E){(E=new o(b,x,[],w,Object.create(this.schemas))).schemas[w]||(E.schemas[w]=b);var P=_(w,b);for(var N in P.id){var k=P.id[N];E.schemas[N]=k}}if(x.required&&f===void 0)return(O=new d(f,b,x,E)).addError("is required, but is undefined"),O;if(!(O=this.validateSchema(f,b,x,E)))throw new Error("Result undefined");if(x.throwAll&&O.errors.length)throw new c(O);return O},l.prototype.validateSchema=function(f,b,x,E){var O=new d(f,b,x,E);if(typeof b=="boolean")b===!0?b={}:b===!1&&(b={type:[]});else if(!b)throw new Error("schema is undefined");if(b.extends)if(Array.isArray(b.extends)){var S={schema:b,ctx:E};b.extends.forEach(this.schemaTraverser.bind(this,S)),b=S.schema,S.schema=null,S.ctx=null,S=null}else b=h.deepMerge(b,this.superResolve(b.extends,E));var w=m(b);if(w){var P=this.resolve(b,w,E),N=new o(P.subschema,x,E.path,P.switchSchema,E.schemas);return this.validateSchema(f,P.subschema,x,N)}var k=x&&x.skipAttributes||[];for(var j in b)if(!r.ignoreProperties[j]&&k.indexOf(j)<0){var U=null,H=this.attributes[j];if(H)U=H.call(this,f,b,x,E);else if(x.allowUnknownAttributes===!1)throw new s("Unsupported attribute: "+j,b);U&&O.importErrors(U)}if(typeof x.rewrite=="function"){var Z=x.rewrite.call(this,f,b,x,E);O.instance=Z}return O},l.prototype.schemaTraverser=function(f,b){f.schema=h.deepMerge(f.schema,this.superResolve(b,f.ctx))},l.prototype.superResolve=function(f,b){var x=m(f);return x?this.resolve(f,x,b).subschema:f},l.prototype.resolve=function(f,b,x){if(b=x.resolve(b),x.schemas[b])return{subschema:x.schemas[b],switchSchema:b};var E=a.parse(b),O=E&&E.hash,S=O&&O.length&&b.substr(0,b.length-O.length);if(!S||!x.schemas[S])throw new s("no such schema <"+b+">",f);var w=h.objectGetPath(x.schemas[S],O.substr(1));if(w===void 0)throw new s("no such schema "+O+" located in <"+S+">",f);return{subschema:w,switchSchema:b}},l.prototype.testType=function(f,b,x,E,O){if(O!==void 0){if(O===null)throw new s('Unexpected null in "type" keyword');if(typeof this.types[O]=="function")return this.types[O].call(this,f);if(O&&typeof O=="object"){var S=this.validateSchema(f,O,x,E);return S===void 0||!(S&&S.errors.length)}return!0}};var v=l.prototype.types={};v.string=function(f){return typeof f=="string"},v.number=function(f){return typeof f=="number"&&isFinite(f)},v.integer=function(f){return typeof f=="number"&&f%1==0},v.boolean=function(f){return typeof f=="boolean"},v.array=function(f){return Array.isArray(f)},v.null=function(f){return f===null},v.date=function(f){return f instanceof Date},v.any=function(f){return!0},v.object=function(f){return f&&typeof f=="object"&&!Array.isArray(f)&&!(f instanceof Date)},p.exports=l},6751:(p,t,i)=>{i.r(t),i.d(t,{decode:()=>E,default:()=>P,encode:()=>O,toASCII:()=>w,toUnicode:()=>S,ucs2decode:()=>v,ucs2encode:()=>f});const a=2147483647,r=36,h=/^xn--/,_=/[^\0-\x7F]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},s=Math.floor,o=String.fromCharCode;function l(N){throw new RangeError(c[N])}function m(N,k){const j=N.split("@");let U="";j.length>1&&(U=j[0]+"@",N=j[1]);const H=function(Z,K){const ee=[];let re=Z.length;for(;re--;)ee[re]=K(Z[re]);return ee}((N=N.replace(d,".")).split("."),k).join(".");return U+H}function v(N){const k=[];let j=0;const U=N.length;for(;j<U;){const H=N.charCodeAt(j++);if(H>=55296&&H<=56319&&j<U){const Z=N.charCodeAt(j++);(64512&Z)==56320?k.push(((1023&H)<<10)+(1023&Z)+65536):(k.push(H),j--)}else k.push(H)}return k}const f=N=>String.fromCodePoint(...N),b=function(N,k){return N+22+75*(N<26)-((k!=0)<<5)},x=function(N,k,j){let U=0;for(N=j?s(N/700):N>>1,N+=s(N/k);N>455;U+=r)N=s(N/35);return s(U+36*N/(N+38))},E=function(N){const k=[],j=N.length;let U=0,H=128,Z=72,K=N.lastIndexOf("-");K<0&&(K=0);for(let re=0;re<K;++re)N.charCodeAt(re)>=128&&l("not-basic"),k.push(N.charCodeAt(re));for(let re=K>0?K+1:0;re<j;){const J=U;for(let he=1,fe=r;;fe+=r){re>=j&&l("invalid-input");const be=(ee=N.charCodeAt(re++))>=48&&ee<58?ee-48+26:ee>=65&&ee<91?ee-65:ee>=97&&ee<123?ee-97:r;be>=r&&l("invalid-input"),be>s((a-U)/he)&&l("overflow"),U+=be*he;const Ae=fe<=Z?1:fe>=Z+26?26:fe-Z;if(be<Ae)break;const Ce=r-Ae;he>s(a/Ce)&&l("overflow"),he*=Ce}const ne=k.length+1;Z=x(U-J,ne,J==0),s(U/ne)>a-H&&l("overflow"),H+=s(U/ne),U%=ne,k.splice(U++,0,H)}var ee;return String.fromCodePoint(...k)},O=function(N){const k=[],j=(N=v(N)).length;let U=128,H=0,Z=72;for(const re of N)re<128&&k.push(o(re));const K=k.length;let ee=K;for(K&&k.push("-");ee<j;){let re=a;for(const ne of N)ne>=U&&ne<re&&(re=ne);const J=ee+1;re-U>s((a-H)/J)&&l("overflow"),H+=(re-U)*J,U=re;for(const ne of N)if(ne<U&&++H>a&&l("overflow"),ne===U){let he=H;for(let fe=r;;fe+=r){const be=fe<=Z?1:fe>=Z+26?26:fe-Z;if(he<be)break;const Ae=he-be,Ce=r-be;k.push(o(b(be+Ae%Ce,0))),he=s(Ae/Ce)}k.push(o(b(he,0))),Z=x(H,J,ee===K),H=0,++ee}++H,++U}return k.join("")},S=function(N){return m(N,function(k){return h.test(k)?E(k.slice(4).toLowerCase()):k})},w=function(N){return m(N,function(k){return _.test(k)?"xn--"+O(k):k})},P={version:"2.3.1",ucs2:{decode:v,encode:f},decode:E,encode:O,toASCII:w,toUnicode:S}},769:p=>{var t=String.prototype.replace,i=/%20/g;p.exports={default:"RFC3986",formatters:{RFC1738:function(a){return t.call(a,i,"+")},RFC3986:function(a){return String(a)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},8985:(p,t,i)=>{var a=i(1088),r=i(2286),h=i(769);p.exports={formats:h,parse:r,stringify:a}},2286:(p,t,i)=>{var a=i(5364),r=Object.prototype.hasOwnProperty,h={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:a.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},_=function(d,c,s){if(d){var o=s.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,l=/(\[[^[\]]*])/g,m=/(\[[^[\]]*])/.exec(o),v=m?o.slice(0,m.index):o,f=[];if(v){if(!s.plainObjects&&r.call(Object.prototype,v)&&!s.allowPrototypes)return;f.push(v)}for(var b=0;(m=l.exec(o))!==null&&b<s.depth;){if(b+=1,!s.plainObjects&&r.call(Object.prototype,m[1].slice(1,-1))&&!s.allowPrototypes)return;f.push(m[1])}return m&&f.push("["+o.slice(m.index)+"]"),function(x,E,O){for(var S=E,w=x.length-1;w>=0;--w){var P,N=x[w];if(N==="[]"&&O.parseArrays)P=[].concat(S);else{P=O.plainObjects?Object.create(null):{};var k=N.charAt(0)==="["&&N.charAt(N.length-1)==="]"?N.slice(1,-1):N,j=parseInt(k,10);O.parseArrays||k!==""?!isNaN(j)&&N!==k&&String(j)===k&&j>=0&&O.parseArrays&&j<=O.arrayLimit?(P=[])[j]=S:k!=="__proto__"&&(P[k]=S):P={0:S}}S=P}return S}(f,c,s)}};p.exports=function(d,c){var s=c?a.assign({},c):{};if(s.decoder!==null&&s.decoder!==void 0&&typeof s.decoder!="function")throw new TypeError("Decoder has to be a function.");if(s.ignoreQueryPrefix=s.ignoreQueryPrefix===!0,s.delimiter=typeof s.delimiter=="string"||a.isRegExp(s.delimiter)?s.delimiter:h.delimiter,s.depth=typeof s.depth=="number"?s.depth:h.depth,s.arrayLimit=typeof s.arrayLimit=="number"?s.arrayLimit:h.arrayLimit,s.parseArrays=s.parseArrays!==!1,s.decoder=typeof s.decoder=="function"?s.decoder:h.decoder,s.allowDots=typeof s.allowDots=="boolean"?s.allowDots:h.allowDots,s.plainObjects=typeof s.plainObjects=="boolean"?s.plainObjects:h.plainObjects,s.allowPrototypes=typeof s.allowPrototypes=="boolean"?s.allowPrototypes:h.allowPrototypes,s.parameterLimit=typeof s.parameterLimit=="number"?s.parameterLimit:h.parameterLimit,s.strictNullHandling=typeof s.strictNullHandling=="boolean"?s.strictNullHandling:h.strictNullHandling,d===""||d==null)return s.plainObjects?Object.create(null):{};for(var o=typeof d=="string"?function(x,E){for(var O={},S=E.ignoreQueryPrefix?x.replace(/^\?/,""):x,w=E.parameterLimit===1/0?void 0:E.parameterLimit,P=S.split(E.delimiter,w),N=0;N<P.length;++N){var k,j,U=P[N],H=U.indexOf("]="),Z=H===-1?U.indexOf("="):H+1;Z===-1?(k=E.decoder(U,h.decoder),j=E.strictNullHandling?null:""):(k=E.decoder(U.slice(0,Z),h.decoder),j=E.decoder(U.slice(Z+1),h.decoder)),r.call(O,k)?O[k]=[].concat(O[k]).concat(j):O[k]=j}return O}(d,s):d,l=s.plainObjects?Object.create(null):{},m=Object.keys(o),v=0;v<m.length;++v){var f=m[v],b=_(f,o[f],s);l=a.merge(l,b,s)}return a.compact(l)}},1088:(p,t,i)=>{var a=i(5364),r=i(769),h={brackets:function(m){return m+"[]"},indices:function(m,v){return m+"["+v+"]"},repeat:function(m){return m}},_=Array.isArray,d=Array.prototype.push,c=function(m,v){d.apply(m,_(v)?v:[v])},s=Date.prototype.toISOString,o={delimiter:"&",encode:!0,encoder:a.encode,encodeValuesOnly:!1,serializeDate:function(m){return s.call(m)},skipNulls:!1,strictNullHandling:!1},l=function m(v,f,b,x,E,O,S,w,P,N,k,j){var U=v;if(typeof S=="function"?U=S(f,U):U instanceof Date&&(U=N(U)),U===null){if(x)return O&&!j?O(f,o.encoder):f;U=""}if(typeof U=="string"||typeof U=="number"||typeof U=="boolean"||a.isBuffer(U))return O?[k(j?f:O(f,o.encoder))+"="+k(O(U,o.encoder))]:[k(f)+"="+k(String(U))];var H,Z=[];if(U===void 0)return Z;if(_(S))H=S;else{var K=Object.keys(U);H=w?K.sort(w):K}for(var ee=0;ee<H.length;++ee){var re=H[ee];E&&U[re]===null||(_(U)?c(Z,m(U[re],b(f,re),b,x,E,O,S,w,P,N,k,j)):c(Z,m(U[re],f+(P?"."+re:"["+re+"]"),b,x,E,O,S,w,P,N,k,j)))}return Z};p.exports=function(m,v){var f=m,b=v?a.assign({},v):{};if(b.encoder!==null&&b.encoder!==void 0&&typeof b.encoder!="function")throw new TypeError("Encoder has to be a function.");var x=b.delimiter===void 0?o.delimiter:b.delimiter,E=typeof b.strictNullHandling=="boolean"?b.strictNullHandling:o.strictNullHandling,O=typeof b.skipNulls=="boolean"?b.skipNulls:o.skipNulls,S=typeof b.encode=="boolean"?b.encode:o.encode,w=typeof b.encoder=="function"?b.encoder:o.encoder,P=typeof b.sort=="function"?b.sort:null,N=b.allowDots!==void 0&&b.allowDots,k=typeof b.serializeDate=="function"?b.serializeDate:o.serializeDate,j=typeof b.encodeValuesOnly=="boolean"?b.encodeValuesOnly:o.encodeValuesOnly;if(b.format===void 0)b.format=r.default;else if(!Object.prototype.hasOwnProperty.call(r.formatters,b.format))throw new TypeError("Unknown format option provided.");var U,H,Z=r.formatters[b.format];typeof b.filter=="function"?f=(H=b.filter)("",f):_(b.filter)&&(U=H=b.filter);var K,ee=[];if(typeof f!="object"||f===null)return"";K=b.arrayFormat in h?b.arrayFormat:"indices"in b?b.indices?"indices":"repeat":"indices";var re=h[K];U||(U=Object.keys(f)),P&&U.sort(P);for(var J=0;J<U.length;++J){var ne=U[J];O&&f[ne]===null||c(ee,l(f[ne],ne,re,E,O,S?w:null,H,P,N,k,Z,j))}var he=ee.join(x),fe=b.addQueryPrefix===!0?"?":"";return he.length>0?fe+he:""}},5364:p=>{var t=Object.prototype.hasOwnProperty,i=function(){for(var r=[],h=0;h<256;++h)r.push("%"+((h<16?"0":"")+h.toString(16)).toUpperCase());return r}(),a=function(r,h){for(var _=h&&h.plainObjects?Object.create(null):{},d=0;d<r.length;++d)r[d]!==void 0&&(_[d]=r[d]);return _};p.exports={arrayToObject:a,assign:function(r,h){return Object.keys(h).reduce(function(_,d){return _[d]=h[d],_},r)},compact:function(r){for(var h=[{obj:{o:r},prop:"o"}],_=[],d=0;d<h.length;++d)for(var c=h[d],s=c.obj[c.prop],o=Object.keys(s),l=0;l<o.length;++l){var m=o[l],v=s[m];typeof v=="object"&&v!==null&&_.indexOf(v)===-1&&(h.push({obj:s,prop:m}),_.push(v))}return function(f){for(var b;f.length;){var x=f.pop();if(b=x.obj[x.prop],Array.isArray(b)){for(var E=[],O=0;O<b.length;++O)b[O]!==void 0&&E.push(b[O]);x.obj[x.prop]=E}}return b}(h)},decode:function(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch{return r}},encode:function(r){if(r.length===0)return r;for(var h=typeof r=="string"?r:String(r),_="",d=0;d<h.length;++d){var c=h.charCodeAt(d);c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122?_+=h.charAt(d):c<128?_+=i[c]:c<2048?_+=i[192|c>>6]+i[128|63&c]:c<55296||c>=57344?_+=i[224|c>>12]+i[128|c>>6&63]+i[128|63&c]:(d+=1,c=65536+((1023&c)<<10|1023&h.charCodeAt(d)),_+=i[240|c>>18]+i[128|c>>12&63]+i[128|c>>6&63]+i[128|63&c])}return _},isBuffer:function(r){return r!=null&&!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))},isRegExp:function(r){return Object.prototype.toString.call(r)==="[object RegExp]"},merge:function r(h,_,d){if(!_)return h;if(typeof _!="object"){if(Array.isArray(h))h.push(_);else{if(!h||typeof h!="object")return[h,_];(d&&(d.plainObjects||d.allowPrototypes)||!t.call(Object.prototype,_))&&(h[_]=!0)}return h}if(!h||typeof h!="object")return[h].concat(_);var c=h;return Array.isArray(h)&&!Array.isArray(_)&&(c=a(h,d)),Array.isArray(h)&&Array.isArray(_)?(_.forEach(function(s,o){if(t.call(h,o)){var l=h[o];l&&typeof l=="object"&&s&&typeof s=="object"?h[o]=r(l,s,d):h.push(s)}else h[o]=s}),h):Object.keys(_).reduce(function(s,o){var l=_[o];return t.call(s,o)?s[o]=r(s[o],l,d):s[o]=l,s},c)}}},9017:function(p,t,i){var a=this&&this.__decorate||function(f,b,x,E){var O,S=arguments.length,w=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(f,b,x,E);else for(var P=f.length-1;P>=0;P--)(O=f[P])&&(w=(S<3?O(w):S>3?O(b,x,w):O(b,x))||w);return S>3&&w&&Object.defineProperty(b,x,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.AccumulatePass=void 0;const r=i(9504),h=i(7564),_=i(8215),d=i(4127),c=i(1896),s=i(4168),o=i(771),l=i(8593),m=i(9217);class v extends d.Initializable{constructor(b){super(),this._altered=Object.assign(new h.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=m.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=b}initialize(b){const x=this._context.gl;this._accumulationFBOs=[new _.Framebuffer(this._context,"AccumPingFBO"),new _.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new l.Texture2D(this._context,"AccumPingTexture"),new l.Texture2D(this._context,"AccumPongTexture")],b===void 0?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=b,this._ndcTriangleShared=!0);const E=new o.Shader(this._context,x.VERTEX_SHADER,"ndcvertices.vert (accumulate)");E.initialize(i(9657));const O=new o.Shader(this._context,x.FRAGMENT_SHADER,"accumulate.frag");return O.initialize(i(8058)),this._program=new s.Program(this._context,"AccumulateProgram"),this._program.initialize([E,O],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),x.uniform1f(this._uWeight,0),x.uniform1i(this._program.uniform("u_accumulationTexture"),0),x.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void(0,r.log)(r.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const b=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!b)return void(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const x=this._context.gl,E=this._context.gl2facade,O=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||b)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].reformat(S[0],x.RGBA,S[1]),this._accumulationTextures[1].reformat(S[0],x.RGBA,S[1])}}else{const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].initialize(O[0],O[1],S[0],x.RGBA,S[1]),this._accumulationTextures[1].initialize(O[0],O[1],S[0],x.RGBA,S[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(b,x){if((0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||this._texture===void 0)return;(0,r.logIf)(!this._texture||!this._texture.valid,r.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const E=this._context.gl;x!==void 0&&E.viewport(0,0,x[0],x[1]);const O=b%2,S=this._write=1-O,w=this._accumulationTextures[O],P=this._texture;w.bind(E.TEXTURE0),P.bind(E.TEXTURE1),this._program.bind(),E.uniform1f(this._uWeight,1/(b+1)),this._accumulationFBOs[S].bind(E.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[S].unbind(E.DRAW_FRAMEBUFFER),w.unbind(E.TEXTURE0),P.unbind(E.TEXTURE1)}set texture(b){this.assertInitialized(),this._texture!==b&&(this._texture=b,this._altered.alter("texture"))}set precision(b){this.assertInitialized(),this._precision!==b&&(this._precision=b,this._altered.alter("precision"))}set passThrough(b){this.assertInitialized(),this._passThrough!==b&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=b,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}t.AccumulatePass=v,a([d.Initializable.initialize()],v.prototype,"initialize",null),a([d.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],v.prototype,"update",null),a([d.Initializable.assert_initialized()],v.prototype,"frame",null)},7501:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AllocationRegister=void 0;const a=i(7032),r=i(9504);t.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new a.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(h){(0,r.assert)(this._bytesByIdentifier.has(h),"allocation identifier unknown")}createUniqueIdentifier(h){let _=h,d=2;for(;this._bytesByIdentifier.has(_);)_=`${h}-${d}`,++d;return this._bytesByIdentifier.set(_,0),_}deleteUniqueIdentifier(h){(0,r.assert)(this._bytesByIdentifier.has(h),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(h)}allocate(h,_){if(this.assertIdentifier(h),(0,r.assert)(_>=0,`positive number of bytes expected for allocation, given ${_}`),_===0)return;const d=this._bytesByIdentifier.get(h)+_;this._bytesByIdentifier.set(h,d),this._bytes=this._bytes+_,this.bytesNext()}deallocate(h,_){this.assertIdentifier(h);const d=this._bytesByIdentifier.get(h);(0,r.assert)(_>=0,`positive number of bytes expected for deallocation, given ${_}`),(0,r.assert)(_<=d,`deallocation cannot exceed previous allocations of ${d}, given ${_}`),_!==0&&(this._bytesByIdentifier.set(h,d-_),this._bytes=this._bytes-_,this.bytesNext())}reallocate(h,_){this.assertIdentifier(h),(0,r.assert)(_>=0,`positive number of bytes expected for reallocation, given ${_}`);const d=this._bytesByIdentifier.get(h);d!==_&&(this._bytes=this._bytes-d,this._bytesByIdentifier.set(h,_),this._bytes=this._bytes+_,this.bytesNext())}allocated(h){return h===void 0?this._bytes:(this.assertIdentifier(h),this._bytesByIdentifier.get(h))}toString(){const h=new Array;return this._bytesByIdentifier.forEach((_,d)=>{h.push(`${d}: ${(0,r.prettyPrintBytes)(_)}`)}),h.join(", ")}bytesToString(h){return(0,r.prettyPrintBytes)(this.allocated(h))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},2419:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiAliasingKernel=void 0;const a=i(3039);class r extends a.RandomSquareKernel{constructor(_){super(_)}generate(){switch(this._width){case 8:this.fromJSON(i(3058));break;case 64:this.fromJSON(i(9148));break;case 128:this.fromJSON(i(6399));break;default:super.generate()}}}t.AntiAliasingKernel=r},9504:(p,t,i)=>{const a=i(5150);var r;(function(h){let _,d=2;h.logVerbosity=function(E){return E!==void 0&&(d=Math.max(-1,E)),d},function(E){E[E.Debug=3]="Debug",E[E.Info=2]="Info",E[E.Warning=1]="Warning",E[E.Error=0]="Error"}(_=h.LogLevel||(h.LogLevel={}));const c=(E,O)=>{if(!E)throw new EvalError(O)},s=(E,O)=>{};function o(E,...O){E>d||console.log(`[${E}]`,...O)}function l(E){const O=`${E}-start`;h.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),h.assert(performance.getEntriesByName(O).length===0,`expected mark identifier to not already exists, given ${O}`),performance.mark(O)}function m(E,O,S=0){const w=`${E}-start`,P=`${E}-end`;h.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),h.assert(performance.getEntriesByName(P).length===0,`expected mark identifier to not already exists, given ${P}`),performance.mark(P),performance.measure(E,w,P);const N=performance.getEntriesByName(E)[0];performance.clearMarks(w),performance.clearMarks(P),performance.clearMeasures(E);const k=O===void 0||O.length===0?0:2,j=Math.max(k,S-E.length-(O?O.length:0)-1),U=x(N.duration);o(_.Debug,`${E}${" ".repeat(j)}${O||""} | ${U}`)}h.assert=c,h.assertions=function(E){return E!==void 0&&(h.assert=E?c:s),h.assert!==s},h.log=o,h.logIf=function(E,O,...S){E&&o(O,...S)},h.logPerformanceStart=l,h.logPerformanceStartIf=function(E,O){E&&l(O)},h.logPerformanceStop=m,h.logPerformanceStopIf=function(E,O,S,w=0){E&&m(O,S,w)},h.rand=function(E=0,O=1){return Math.random()*(O-E)+E},h.isPowerOfTwo=function(E){return Number.isInteger(E)&&Number.isInteger(Math.log2(E))},h.upperPowerOfTwo=function(E){return--E,E|=E>>1,E|=E>>2,E|=E>>4,E|=E>>8,E|=E>>16,++E};const v=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];h.prettyPrintBytes=function(E){const O=E>0?Math.floor(Math.log(E)/Math.log(1024)):0,S=E/Math.pow(1024,O);return`${O>0?S.toFixed(3):S}${v[O]}B`};const f=["ms","ns","μs","ms","s"],b=[0,1e6,1e3,1,.001];function x(E){let O=E>0?Math.max(1,Math.floor(Math.log(10*E)/Math.log(1e3))+3):0;return O=(0,a.clamp)(O,0,4),`${(E*b[O]).toFixed(3)}${f[O]}`}h.prettyPrintMilliseconds=x,h.bitInBitfield=function(E,O){return O!==void 0&&(E&O)===O},h.RAD2DEG=57.29577951308232,h.DEG2RAD=.017453292519943295,h.GETsearch=function(){var O,S;let E=window.location.search;return E||(E=((S=(O=window.top)==null?void 0:O.location)==null?void 0:S.search)||""),E},h.GETparameter=function(E){var w,P;const O=new RegExp(`${E}=([^&]+)`);let S=window.location.search.match(O);if(S||(S=((P=(w=window.top)==null?void 0:w.location)==null?void 0:P.search.match(O))||null),S)return S[1]},h.PATH_SEPARATOR="/",h.dirname=function(E){return E.includes(h.PATH_SEPARATOR)===!1?"":E.substr(0,E.lastIndexOf(h.PATH_SEPARATOR)).trimLeft()},h.basename=function(E){return E.includes(h.PATH_SEPARATOR)===!1?E:E.substr(E.lastIndexOf(h.PATH_SEPARATOR)+1).trimRight()}})(r||(r={})),p.exports=r},8263:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Benchmark=void 0,t.Benchmark=class{constructor(){this._running=!1,this._results=new Array,this._framePrepare=void 0,this._runsFinished=void 0}initialize(i,a,r,h,_){this._running?console.log("benchmark already in progress"):(this._framePrepare=h,this._runsFinished=_,this._running=!0,this._frames=0,this._runs=Math.max(0,i),this._framesForWarmup=Math.max(0,a),this._framesPerCycle=Math.max(1,r),this._results.length=this._runs,this._results.fill(0))}frame(){if(this._running===!1)return;++this._frames;const i=this._frames-this._framesForWarmup,a=i<0?i:i%this._framesPerCycle,r=i>=0?Math.floor(i/this._framesPerCycle):-1;i===1-this._framesForWarmup&&console.log("---- benchmark warmup ------"),i===0&&console.log("---- benchmark started -----"),i%this._framesPerCycle==0&&r>0&&(this._results[r-1]=(performance.now()-this._results[r-1])/this._framesPerCycle,console.log(" --  cycle: "+r.toString().padStart(2,"0")+", tpf: "+this._results[r-1].toFixed(4).padStart(9,"0")+", fps: "+(1e3/this._results[r-1]).toFixed(4).padStart(9,"0"))),i%this._framesPerCycle==0&&r>=0&&r<this._runs&&(this._results[r]=performance.now()),r>=this._runs?(this._running=!1,console.log("---- benchmark stopped -----"),this._framePrepare=void 0,this._runsFinished(this._runs,this._framesForWarmup,this._framesPerCycle,this._results),this._runsFinished=void 0):this._framePrepare(a,this._framesForWarmup,this._framesPerCycle,r)}get running(){return this._running}}},8196:function(p,t,i){var a=this&&this.__decorate||function(m,v,f,b){var x,E=arguments.length,O=E<3?v:b===null?b=Object.getOwnPropertyDescriptor(v,f):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(m,v,f,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(O=(E<3?x(O):E>3?x(v,f,O):x(v,f))||O);return E>3&&O&&Object.defineProperty(v,f,O),O};Object.defineProperty(t,"__esModule",{value:!0}),t.BlitPass=void 0;const r=i(3557),h=i(9504),_=i(5150),d=i(4127),c=i(1896),s=i(4168),o=i(771);class l extends d.Initializable{constructor(v){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=v}functionBlit(){const v=this._context.gl;if(this._target.bind(v.DRAW_FRAMEBUFFER),this._framebuffer.bind(v.READ_FRAMEBUFFER),v.readBuffer(this._readBuffer),this._drawBuffer>=v.COLOR_ATTACHMENT1&&this._drawBuffer<=v.COLOR_ATTACHMENT15){const x=this._drawBuffer-v.COLOR_ATTACHMENT0,E=new Array(x+1).fill(v.NONE);E[x]=this._drawBuffer,v.drawBuffers(E)}else v.drawBuffers([this._drawBuffer]);v.enable(v.SCISSOR_TEST),v.scissor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),v.disable(v.SCISSOR_TEST);const f=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],b=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];v.blitFramebuffer(f[0],f[1],f[2],f[3],b[0],b[1],b[2],b[3],v.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(v.READ_FRAMEBUFFER),this._target.unbind(v.DRAW_FRAMEBUFFER)}programBlit(){this._program===void 0&&this.createProgram(),(0,h.assert)(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const v=this._context.gl,f=this._srcBounds?this._srcBounds:r.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),b=this._dstBounds?this._dstBounds:r.vec4.fromValues(0,0,this._target.width,this._target.height),x=r.vec4.div((0,_.v4)(),f,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),E=r.vec4.div((0,_.v4)(),b,[this._target.width,this._target.height,this._target.width,this._target.height]);v.viewport(b[0],b[1],b[2]-b[0],b[3]-b[1]),v.disable(v.DEPTH_TEST),v.depthMask(!1),this._program.bind(),v.uniform4fv(this._uSrcBounds,x),v.uniform4fv(this._uDstBounds,E),v.uniform1i(this._uNearest,this.filter===v.nearest);const O=this._framebuffer.texture(this._readBuffer);O.bind(v.TEXTURE0);const S=this._context.isWebGL2?v.DRAW_FRAMEBUFFER:v.FRAMEBUFFER;this._target.bind(S),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(S),O.unbind(),v.enable(v.DEPTH_TEST),v.depthMask(!0)}createProgram(){(0,h.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const v=this._context.gl,f=new o.Shader(this._context,v.VERTEX_SHADER,"blit.vert (blit)");f.initialize(i(3354));const b=new o.Shader(this._context,v.FRAGMENT_SHADER,"blit.frag (blit)");return b.initialize(i(6523)),this._program=new s.Program(this._context,"BlitProgram"),this._program.initialize([f,b],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),v.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(v){const f=this._context.gl;return v===void 0?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._filter=f.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){(0,h.logIf)(!this._target||!this._target.valid,h.LogLevel.Warning,`valid target expected, given ${this._target}`),(0,h.logIf)(!this._framebuffer||!this._framebuffer.valid,h.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const v=this._context.gl;switch(this._readBuffer){case v.DEPTH_ATTACHMENT:case v.STENCIL_ATTACHMENT:case v.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&this._enforceProgramBlit===!1)return this.functionBlit();this.programBlit()}set framebuffer(v){this.assertInitialized(),this._framebuffer=v}set readBuffer(v){this.assertInitialized(),this._readBuffer=v}set drawBuffer(v){this.assertInitialized(),this._drawBuffer=v}set target(v){this.assertInitialized(),this._target=v}set filter(v){this._filter=v}set srcBounds(v){this._srcBounds=v?r.vec4.clone(v):void 0}set dstBounds(v){this._dstBounds=v?r.vec4.clone(v):void 0}set enforceProgramBlit(v){this._enforceProgramBlit=v}}t.BlitPass=l,a([d.Initializable.initialize()],l.prototype,"initialize",null),a([d.Initializable.uninitialize()],l.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],l.prototype,"frame",null)},7340:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;const r=i(9504),h=i(4127),_=i(9965);class d extends _.AbstractObject{constructor(){super(...arguments),this._target=d.DEFAULT_BUFFER}create(s){const o=this._context.gl;return this._object=o.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&((0,r.assert)(s===o.ARRAY_BUFFER||s===o.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=s),this._object}delete(){(0,r.assert)(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=d.DEFAULT_BUFFER}bind(){(0,r.assert)(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,d.DEFAULT_BUFFER)}data(s,o,l=!0,m=!0){const v=this.context.gl;l&&this.bind(),v.bufferData(this._target,s,o),m&&this.unbind(),this._valid=v.isBuffer(this._object)&&v.getError()===v.NO_ERROR;const f=typeof s=="number"?s:s.byteLength,b=this._valid?f:0;this.context.allocationRegister.reallocate(this._identifier,b)}subData(s,o,l=0,m=0,v=!0,f=!0){const b=this.context.gl;v&&this.bind(),this.context.gl2facade.bufferSubData(this._target,s,o,l,m),f&&this.unbind(),this._valid=b.getError()===b.NO_ERROR}attribEnable(s,o,l,m=!1,v=0,f=0,b=!0,x=!0){const E=this.context.gl;b&&this.bind(),E.vertexAttribPointer(s,o,l,m,v,f),E.enableVertexAttribArray(s),x&&this.unbind()}attribEnableInt(s,o,l,m=0,v=0,f=!0,b=!0){const x=this.context.gl;f&&this.bind(),x.vertexAttribIPointer(s,o,l,m,v),x.enableVertexAttribArray(s),b&&this.unbind()}attribDisable(s,o=!0,l=!0){const m=this.context.gl;o&&this.bind(),m.disableVertexAttribArray(s),l&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}t.Buffer=d,d.DEFAULT_BUFFER=void 0,a([h.Initializable.assert_initialized()],d.prototype,"bind",null),a([h.Initializable.assert_initialized()],d.prototype,"unbind",null),a([h.Initializable.assert_initialized()],d.prototype,"data",null),a([h.Initializable.assert_initialized()],d.prototype,"attribEnable",null),a([h.Initializable.assert_initialized()],d.prototype,"attribEnableInt",null),a([h.Initializable.assert_initialized()],d.prototype,"attribDisable",null)},3025:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const a=i(3557),r=i(5150),h=i(9504),_=i(2813);class d{static calculateFovY(s,o){return 2*Math.atan(.5*s/o)}constructor(s,o,l){this._fovy=d.DEFAULT_FOVY,this._near=d.DEFAULT_NEAR,this._far=d.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=s?a.vec3.clone(s):a.vec3.clone(d.DEFAULT_EYE),this._center=o?a.vec3.clone(o):a.vec3.clone(d.DEFAULT_CENTER),this._up=l?a.vec3.clone(l):a.vec3.clone(d.DEFAULT_UP)}invalidate(s,o,l=!1){s&&(this._view=void 0,this._viewInverse=void 0),o&&(this._projection=void 0,this._projectionInverse=void 0),(s||o||l)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(s){a.vec3.equals(this._eye,s)||(this._eye=a.vec3.clone(s),this.invalidate(!0,!1))}get center(){return this._center}set center(s){a.vec3.equals(this._center,s)||(this._center=a.vec3.clone(s),this.invalidate(!0,!1))}get up(){return this._up}set up(s){a.vec3.equals(this._up,s)||(this._up=a.vec3.clone(s),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(s){this._fovy!==s&&(this._fovy=s,this.invalidate(!1,!0))}set fovx(s){const o=s*h.DEG2RAD,l=2*Math.atan(Math.tan(o/2)*(1/this.aspect))*h.RAD2DEG;this._fovy!==l&&(this._fovy=l,this.invalidate(!1,!0))}fovFromLens(s,o){const l=2*Math.atan(s/(2*o));this.fovx=l*h.RAD2DEG}get near(){return this._near}set near(s){this._near!==s&&(s>=this._far&&(0,h.log)(h.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${s}`),this._near=s,this.invalidate(!1,!0))}get far(){return this._far}set far(s){this._far!==s&&(this._near>=s&&(0,h.log)(h.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${s}`),this._far=s,this.invalidate(!1,!0))}set viewport(s){this._viewport[0]===s[0]&&this._viewport[1]===s[1]||(this._viewport=(0,_.duplicate2)(s),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(s){this._aspect!==s&&(this._aspect=s)}get aspect(){return this._aspect}get view(){return this._view||(this._view=a.mat4.lookAt((0,r.m4)(),this._eye,this._center,this._up)),this._view}get viewInverse(){return this._viewInverse!==void 0||(this._viewInverse=a.mat4.invert((0,r.m4)(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=a.mat4.perspective((0,r.m4)(),this.fovy*h.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return this._projectionInverse!==void 0||(this._projectionInverse=a.mat4.invert((0,r.m4)(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=a.mat4.multiply((0,r.m4)(),this.projection,this.view),this._viewProjection=a.mat4.multiply((0,r.m4)(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return this._viewProjectionInverse!==void 0||(this._viewProjectionInverse=a.mat4.invert((0,r.m4)(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:a.mat4.identity((0,r.m4)())}set postViewProjection(s){this._postViewProjection=s,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(s){this._altered=s}}t.Camera=d,d.DEFAULT_EYE=a.vec3.fromValues(0,0,1),d.DEFAULT_CENTER=a.vec3.fromValues(0,0,0),d.DEFAULT_UP=a.vec3.fromValues(0,1,0),d.DEFAULT_FOVY=45,d.DEFAULT_NEAR=2,d.DEFAULT_FAR=8},7344:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CameraModifier=void 0;const a=i(3025);t.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new a.Camera}set camera(r){this._camera!==r&&(this._camera=r,r!==void 0&&(Object.assign(this._reference,r),this.update()))}}},7858:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;const a=i(7032),r=i(3557),h=i(5150),_=i(9504),d=i(2813),c=i(3847),s=i(2527),o=i(8234),l=i(3975),m=i(4602),v=i(8216),f=i(9137),b=i(8870),x=i(5678),E=i(9217);class O extends f.Resizable{constructor(w,P){super(),this._framePrecisionSubject=new a.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new a.ReplaySubject(1),this._frameScaleSubject=new a.ReplaySubject(1),this._frameSizeSubject=new a.ReplaySubject(1),this._element=w instanceof HTMLCanvasElement?w:document.getElementById(w),this._element.addEventListener("webglcontextcreationerror",U=>{console.log(U.statusMessage||"Unknown error")},!1),this.observe(this._element),this._mouseEventProvider=new m.MouseEventProvider(this._element,200),this._touchEventProvider=new b.TouchEventProvider(this._element,200),this._pointerEventProvider=new v.PointerEventProvider(this._element,200),this._keyboardEventProvider=new x.KeyboardEventProvider(this._element,200),this._element.style.touchAction="none";const N=this._element.dataset;let k;this._context=s.Context.request(this._element,P),this.configureController(N),this.configureSizeAndScale(N),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),N.clearColor&&(k=(0,h.parseVec4)(N.clearColor),(0,_.logIf)(k===void 0,_.LogLevel.Warning,`data-clear-color could not be parsed, given '${N.clearColor}'`)),this._clearColor=k?new c.Color((0,d.tuple4)(k)):O.DEFAULT_CLEAR_COLOR;let j=N.accumulationFormat?N.accumulationFormat:O.DEFAULT_FRAME_PRECISION;j in E.Wizard.Precision||(j=O.DEFAULT_FRAME_PRECISION,(0,_.log)(_.LogLevel.Warning,`unknown frame precision '${N.accumulationFormat}' changed to '${j}'`)),this._framePrecision=j,this.framePrecisionNext()}configureController(w){let P,N;this._controller=new o.Controller,this._controller.block(),w.multiFrameNumber&&(P=parseInt(w.multiFrameNumber,10),(0,_.logIf)(isNaN(P),_.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${w.multiFrameNumber}'`)),w.debugFrameNumber&&(N=parseInt(w.debugFrameNumber,10),(0,_.logIf)(isNaN(N),_.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${w.debugFrameNumber}'`)),this._controller.multiFrameNumber=P||O.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=N||0;const k=!!P&&P!==this._controller.multiFrameNumber;(0,_.logIf)(k,_.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${w.multiFrameNumber}'`);const j=!!N&&N!==this._controller.debugFrameNumber;(0,_.logIf)(j,_.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${w.debugFrameNumber}'`)}configureSizeAndScale(w){let P,N;w.frameScale&&(P=(0,h.parseVec2)(w.frameScale),(0,_.logIf)(w.frameScale!==void 0&&P===void 0,_.LogLevel.Warning,`data-frame-scale could not be parsed, given '${w.frameScale}'`)),this._frameScale=P?(0,d.tuple2)(P):[1,1],w.frameSize&&(N=(0,h.parseVec2)(w.frameSize),(0,_.logIf)(w.frameSize!==void 0&&N===void 0,_.LogLevel.Warning,`data-frame-size could not be parsed, given '${w.frameSize}'`)),this._favorSizeOverScale=N!==void 0,this._frameSize=N?(0,d.tuple2)(N):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",w=>{w.preventDefault(),this.onContextLost()},!1),this._element.addEventListener("webglcontextrestored",()=>{this.onContextRestore()},!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){(0,_.log)(_.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){(0,_.log)(_.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const w=this._renderer;this.unbind(),this.bind(w),this._controller.unblock();const P=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=P}retrieveSize(){const w=f.Resizable.elementSize(this._element);w!==void 0?(this._size=[w[0],w[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),this._size[0]===0||this._size[1]===0)return(0,_.log)(_.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(w){this._renderer!==w&&(this.unbind(),w!==void 0&&((0,_.assert)(this._controller.blocked,"expected controller to be blocked"),this._renderer=w,this._renderer.initialize(this.context,P=>this._controller.update(P),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider,keyboardEventProvider:this._keyboardEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){this._renderer!==void 0&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(w){this.bind(w)}get frameScale(){return this._frameScale}set frameScale(w){if(!isFinite(w[0])||!isFinite(w[1]))return void(0,_.log)(_.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${w}]`);(0,_.logIf)(w[0]<0||w[0]>8,_.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${w[0]}`),(0,_.logIf)(w[1]<0||w[1]>8,_.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${w[0]}`);const P=r.vec2.create();(0,h.clamp2)(P,w,[0,0],[8,8]);const N=r.vec2.create();r.vec2.mul(N,this._size,P),r.vec2.max(N,[1,1],N),r.vec2.round(N,N),r.vec2.div(P,N,this._size),(0,_.logIf)(!r.vec2.exactEquals(P,w),2,`frame scale was adjusted to ${P.toString()}, given ${w.toString()}`),this._frameScale=(0,d.tuple2)(P),this._frameSize=(0,d.tuple2)(N),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(w){if(!isFinite(w[0])||!isFinite(w[1]))return void(0,_.log)(_.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${w}]`);(0,_.logIf)(w[0]<1||w[0]>8*this._size[0],_.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${w[0]}`),(0,_.logIf)(w[1]<1||w[1]>8*this._size[1],_.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${w[1]}`);const P=r.vec2.create();(0,h.clamp2)(P,w,[1,1],[8*this._size[0],8*this._size[1]]),r.vec2.round(P,P),(0,_.logIf)(!r.vec2.exactEquals(P,w),_.LogLevel.Warning,`frame size was adjusted to ${P.toString()}, given ${w.toString()}`);const N=r.vec2.create();r.vec2.div(N,P,this._size),this._frameScale=(0,d.tuple2)(N),this._frameSize=(0,d.tuple2)(P),this._favorSizeOverScale=!r.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(w){this._clearColor=w,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(w){this._framePrecision=w,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}get keyboardEventProvider(){return this._keyboardEventProvider}testLoseContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.loseContext()}testRestoreContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(w,P){this._eyeGazeEventProvider=new l.EyeGazeEventProvider(w,P)}}t.Canvas=O,O.DEFAULT_CLEAR_COLOR=new c.Color([.203,.227,.25,1]),O.DEFAULT_FRAME_PRECISION=E.Wizard.Precision.auto,O.DEFAULT_MULTI_FRAME_NUMBER=0},8596:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRecorder=void 0;const a=i(9504);class r{static isSupported(){return window.MediaRecorder!==void 0}static isMIMETypeSupported(_){return MediaRecorder.isTypeSupported(_)}constructor(_){(0,a.assert)(r.isSupported(),"Recording the canvas is not supported."),this._canvas=_,this._state=r.State.INACTIVE,this._images=new Array}start(_,d="video/webm",c=4194304){(0,a.assert)(_>=0,"FPS has to be positive"),(0,a.assert)(this._state===r.State.INACTIVE,"Recorder has to be inactive."),(0,a.assert)(r.isMIMETypeSupported(d),`MIME type: ${d} is not supported.`),this._stream=this._canvas.element.captureStream(_),this._recorder=new MediaRecorder(this._stream,{mimeType:d,bitsPerSecond:c}),this._images.length=0,this._mimeType=d,this._recorder.ondataavailable=s=>this._images.push(s.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=r.State.RECORDING}stop(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive.");const _=this._stream.getTracks();(0,a.assert)(_.length===1,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),_[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=r.State.INACTIVE}pause(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=r.State.PAUSED}resume(){(0,a.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=r.State.RECORDING}frame(){(0,a.assert)(this._state===r.State.RECORDING,"Recorder has to be recording.");const _=this._stream.getTracks();(0,a.assert)(_.length===1,"CanvasRecorder uses unknown implementation of MediaStream API."),(0,a.assert)(this._stream.requestFrame||_[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():_[0].requestFrame()}download(_){const d=URL.createObjectURL(this.blob),c=document.createElement("a");c.style.display="none",c.setAttribute("href",d),c.setAttribute("download",_),document.body.appendChild(c),c.click(),setTimeout(()=>{document.body.removeChild(c),window.URL.revokeObjectURL(d)},256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(_){this._onImagesAvailable=_}}t.CanvasRecorder=r,function(h){(function(_){_[_.INACTIVE=0]="INACTIVE",_[_.RECORDING=1]="RECORDING",_[_.PAUSED=2]="PAUSED"})(h.State||(h.State={}))}(r||(t.CanvasRecorder=r={}))},7564:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeLookup=void 0;const a=i(9504);class r{static alter(_,d){(0,a.assert)(d.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),d.any=!0;const c=_.split("."),s=c.shift();if((0,a.assert)(s===""||d.hasOwnProperty(s),`expected object to have key '${s}' in order to capture alterations`),s!==""&&typeof d[s]!="object")return void(d[s]=!0);if(s!==""&&c.length>0)return void r.alter(c.join("."),d[s]);const o=s!==""?d[s]:d;for(const l of Object.getOwnPropertyNames(o))l!=="any"&&r.alter(l,o)}static reset(_){for(const d of Object.getOwnPropertyNames(_))typeof _[d]!="object"?_[d]=!1:r.reset(_[d])}alter(_){return r.alter(_,this)}reset(){return r.reset(this)}}t.ChangeLookup=r},3847:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const a=i(3557),r=i(5150),h=i(9504),_=i(2813);class d{static hue2rgb(s,o,l){return(0,h.assert)(l>=-1&&l<=2,"t is expected to be between -1 and 2"),l<0?l+=1:l>1&&(l-=1),6*l<1?s+6*(o-s)*l:2*l<1?o:3*l<2?s+6*(o-s)*(.6666666666666666-l):s}static to2CharHexCode(s){return(s<.060784313725490195?"0":"")+Math.round(255*s).toString(16)}static hsl2rgb(s){const o=(0,_.clampf3)(s,"HSL input");if(o[1]===0)return[o[2],o[2],o[2]];const l=o[2]<.5?o[2]*(1+o[1]):o[2]+o[1]-o[1]*o[2],m=2*o[2]-l;return[d.hue2rgb(m,l,o[0]+.3333333333333333),d.hue2rgb(m,l,o[0]),d.hue2rgb(m,l,o[0]-.3333333333333333)]}static rgb2hsl(s){const o=(0,_.clampf3)(s,"RGB input"),l=[0,0,0],m=Math.min(o[0],o[1],o[2]),v=Math.max(o[0],o[1],o[2]),f=v-m;if(l[2]=.5*(v+m),f===0)return l;l[1]=l[2]<.5?f/(v+m):f/(2-v-m);const b=((v-o[0])/6+f/2)/f,x=((v-o[1])/6+f/2)/f,E=((v-o[2])/6+f/2)/f;return o[0]===v?l[0]=E-x:o[1]===v?l[0]=b-E+.3333333333333333:l[0]=x-b+.6666666666666666,l}static lab2xyz(s){const o=(0,_.clampf3)(s,"LAB input"),l=(100*o[0]+16)/116,m=(256*o[1]-128)/500+l,v=l-(256*o[2]-128)/200,f=Math.pow(m,3),b=Math.pow(l,3),x=Math.pow(v,3);return[.95047*(f>.008856?f:(m-.13793103448275862)/7.787),1*(b>.008856?b:(l-.13793103448275862)/7.787),1.08883*(x>.008856?x:(v-.13793103448275862)/7.787)]}static xyz2lab(s){const o=[s[0]/.95047,s[1]/1,s[2]/1.08883],l=o[0]>.008856?Math.cbrt(o[0]):7.787*o[0]+16/116,m=o[1]>.008856?Math.cbrt(o[1]):7.787*o[1]+16/116,v=o[2]>.008856?Math.cbrt(o[2]):7.787*o[2]+16/116;return(0,_.clampf3)([(116*m-16)/100,(500*(l-m)+128)/256,(200*(m-v)+128)/256])}static xyz2rgb(s){const o=2.04137*s[0]+-.56495*s[1]+-.34469*s[2],l=-.96927*s[0]+1.87601*s[1]+.04156*s[2],m=.01345*s[0]+-.11839*s[1]+1.01541*s[2];return(0,_.clampf3)([o>0?Math.pow(o,.4547069271758437):0,l>0?Math.pow(l,.4547069271758437):0,m>0?Math.pow(m,.4547069271758437):0])}static rgb2xyz(s){const o=(0,_.clampf3)(s,"RGB input"),l=Math.pow(o[0],2.19921875),m=Math.pow(o[1],2.19921875),v=Math.pow(o[2],2.19921875);return[.57667*l+.18555*m+.18819*v,.29738*l+.62735*m+.07527*v,.02703*l+.07069*m+.9911*v]}static lab2rgb(s){return d.xyz2rgb(d.lab2xyz(s))}static rgb2lab(s){return d.xyz2lab(d.rgb2xyz(s))}static cmyk2rgb(s){const o=(0,_.clampf4)(s,"CMYK input"),l=1-o[3];return[(1-o[0])*l,(1-o[1])*l,(1-o[2])*l]}static rgb2cmyk(s){const o=(0,_.clampf3)(s,"RGB input"),l=1-Math.max(o[0],o[1],o[2]),m=1-l,v=m===0?0:1/m;return[(m-o[0])*v,(m-o[1])*v,(m-o[2])*v,l]}static hex2rgba(s){const o=[0,0,0,d.DEFAULT_ALPHA];if(!d.HEX_FORMAT_REGEX.test(s))return(0,h.log)(h.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${s}'`),o;const l=s.startsWith("0x")?2:s.startsWith("#")?1:0,m=Math.floor((s.length-l)/3),v=m-1;return o[0]=parseInt(s[l+0*m]+s[l+0*m+v],16)/255,o[1]=parseInt(s[l+1*m]+s[l+1*m+v],16)/255,o[2]=parseInt(s[l+2*m]+s[l+2*m+v],16)/255,s.length-l!=4&&s.length-l!=8||(o[3]=parseInt(s[l+3*m]+s[l+3*m+v],16)/255),(0,h.assert)(!(isNaN(o[0])||isNaN(o[1])||isNaN(o[2])||isNaN(o[3])),`expected well formated hexadecimal RGBA string, given '${s}'`),o}static rgb2hex(s){const o=(0,_.clampf3)(s,"RGB input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])}static rgba2hex(s){const o=(0,_.clampf4)(s,"RGBA input");return"#"+d.to2CharHexCode(o[0])+d.to2CharHexCode(o[1])+d.to2CharHexCode(o[2])+d.to2CharHexCode(o[3])}static lerp(s,o,l,m=d.Space.LAB){if(l<=0)return new d(s.rgba);if(l>=1)return new d(o.rgba);const v=a.vec4.create();switch(m){case d.Space.CMYK:a.vec4.lerp(v,s.cmyk,o.cmyk,l);const f=(0,r.mix)(s.a,o.a,l);return new d().fromCMYK(v[0],v[1],v[2],v[3],f);case d.Space.LAB:return a.vec4.lerp(v,s.laba,o.laba,l),new d().fromLAB(v[0],v[1],v[2],v[3]);case d.Space.HSL:return a.vec4.lerp(v,s.hsla,o.hsla,l),new d().fromHSL(v[0],v[1],v[2],v[3]);case d.Space.RGB:return a.vec4.lerp(v,s.rgba,o.rgba,l),new d().fromRGB(v[0],v[1],v[2],v[3])}}constructor(s,o){this._rgba=[0,0,0,d.DEFAULT_ALPHA],this._altered=!1,s!==void 0&&(s.length===3&&o!==void 0?this.fromF32(s[0],s[1],s[2],o):s.length===4?(this.fromF32(s[0],s[1],s[2],s[3]),(0,h.assert)(o===void 0,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(s[0],s[1],s[2]))}equals(s){return(0,_.equals4)(this._rgba,s._rgba)}fromF32(s,o,l,m=d.DEFAULT_ALPHA){const v=(0,_.duplicate4)(this._rgba);return this._rgba[0]=(0,_.clampf)(s,"red value"),this._rgba[1]=(0,_.clampf)(o,"green value"),this._rgba[2]=(0,_.clampf)(l,"blue value"),this._rgba[3]=(0,_.clampf)(m,"alpha value"),this._altered=!(0,_.equals4)(this._rgba,v),this}fromUI8(s,o,l,m=Math.floor(255*d.DEFAULT_ALPHA)){const v=(0,_.duplicate4)(this._rgba);return this._rgba[0]=(0,r.clamp)(s,0,255)/255,this._rgba[1]=(0,r.clamp)(o,0,255)/255,this._rgba[2]=(0,r.clamp)(l,0,255)/255,this._rgba[3]=(0,r.clamp)(m,0,255)/255,this._altered=!(0,_.equals4)(this._rgba,v),this}fromRGB(s,o,l,m=d.DEFAULT_ALPHA){const v=(0,_.duplicate4)(this._rgba);return this._rgba=(0,_.clampf4)([s,o,l,m],"RGBA input"),this._altered=!(0,_.equals4)(this._rgba,v),this}fromHSL(s,o,l,m=d.DEFAULT_ALPHA){const v=(0,_.duplicate4)(this._rgba),f=d.hsl2rgb([s,o,l]),b=(0,_.clampf)(m,"ALPHA input");return this._rgba=[f[0],f[1],f[2],b],this._altered=!(0,_.equals4)(this._rgba,v),this}fromLAB(s,o,l,m=d.DEFAULT_ALPHA){const v=(0,_.duplicate4)(this._rgba),f=d.lab2rgb([s,o,l]),b=(0,_.clampf)(m,"ALPHA input");return this._rgba=[f[0],f[1],f[2],b],this._altered=!(0,_.equals4)(this._rgba,v),this}fromCMYK(s,o,l,m,v=d.DEFAULT_ALPHA){const f=(0,_.duplicate4)(this._rgba),b=d.cmyk2rgb([s,o,l,m]),x=(0,_.clampf)(v,"ALPHA input");return this._rgba=[b[0],b[1],b[2],x],this._altered=!(0,_.equals4)(this._rgba,f),this}fromHex(s){const o=(0,_.duplicate4)(this._rgba);return this._rgba=d.hex2rgba(s),this._altered=!(0,_.equals4)(this._rgba,o),this}gray(s=d.GrayscaleAlgorithm.LinearLuminance){switch(s){case d.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case d.GrayscaleAlgorithm.LeastSaturatedVariant:return .5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case d.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.LinearLuminance:return .2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(s,o=!0){switch(s){case d.Space.RGB:return o?this.rgba:this.rgb;case d.Space.LAB:return o?this.laba:this.lab;case d.Space.CMYK:return o?this.cmyka:this.cmyk;case d.Space.HSL:return o?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const s=new Uint8Array(3);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s}get rgbF32(){const s=new Float32Array(3);return s[0]=this._rgba[0],s[1]=this._rgba[1],s[2]=this._rgba[2],s}get rgba(){return this._rgba}get rgbaUI8(){const s=new Uint8Array(4);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s[3]=Math.round(255*this._rgba[3]),s}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return d.rgb2hex(this.rgb)}get hexRGBA(){return d.rgba2hex(this._rgba)}get hsl(){return d.rgb2hsl(this.rgb)}get hsla(){const s=d.rgb2hsl(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get lab(){return d.rgb2lab(this.rgb)}get laba(){const s=d.rgb2lab(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get cmyk(){return d.rgb2cmyk(this.rgb)}get cmyka(){const s=d.rgb2cmyk(this.rgb);return[s[0],s[1],s[2],s[3],this._rgba[3]]}get altered(){return this._altered}set altered(s){this._altered=s}}t.Color=d,d.DEFAULT_ALPHA=1,d.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(c){(function(s){s.Average="average",s.LinearLuminance="linear-luminance",s.LeastSaturatedVariant="least-saturated-variant",s.MinimumDecomposition="minimum-decomposition",s.MaximumDecomposition="maximum-decomposition"})(c.GrayscaleAlgorithm||(c.GrayscaleAlgorithm={})),function(s){s.RGB="rgb",s.HSL="hsl",s.LAB="lab",s.CMYK="cmyk"}(c.Space||(c.Space={}))}(d||(t.Color=d={}))},5837:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScale=void 0;const a=i(5150),r=i(9504),h=i(3847),_=i(64);class d{constructor(){this._hint=d.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(s){switch(s){case d.ArrayType.RGBA:case d.ArrayType.RGBAf:return 4;case d.ArrayType.RGB:case d.ArrayType.RGBf:default:return 3}}static fromPreset(s,o,l){return(0,_.fetchJsonAsync)(s,m=>{let v;for(const P of m)if(P.identifier===o){v=P;break}if(v===void 0)return;const f=v.format,b=d.stride(f),x=v.colors;let E=x.length-1;for(let P=0;P<x.length;++P)if(x[P].length===l*b){E=P;break}const O=x[E],S=v.positions;if(S===void 0)return d.fromArray(O,f,l,void 0);let w;for(let P=0;P<S.length;++P)S[P].length===O.length&&(w=S[P]);return d.fromArray(O,f,l,w)},d.SCHEMA.properties)}static fromArray(s,o,l,m){if(l===0||s.length===0)return new d;const v=s,f=d.stride(o),b=v.length/f,x=new Array(b);for(let P=0;P<v.length;P+=f){const N=new h.Color;switch(o){case d.ArrayType.RGB:N.fromUI8(v[P+0],v[P+1],v[P+2]);break;case d.ArrayType.RGBA:N.fromUI8(v[P+0],v[P+1],v[P+2],v[P+3]);break;case d.ArrayType.RGBf:N.fromF32(v[P+0],v[P+1],v[P+2]);break;case d.ArrayType.RGBAf:N.fromF32(v[P+0],v[P+1],v[P+2],v[P+3])}x[P/f]=N}const E=new d;if(m===void 0&&l===b)return E._colors=x,E;if(l===1&&E._colors.push(x[0]),m===void 0){(m=new Array(b))[0]=0;for(let P=1;P<b;++P)m[P]=P/(b-1)}(0,r.assert)(m.length===x.length,`expected number of positions (${m.length}) to match number of colors (${x.length})`);let O=0,S=O+1;const w=b-1;for(let P=0;P<l;++P){const N=P===0?0:P/(l-1);if(N<=m[O]){E._colors.push(x[O]);continue}if(m[w]<=N){E._colors.push(x[w]);continue}for(let j=O+1;j<b;++j)if(!(m[j]<N)){S=j,O=j-1;break}const k=(N-m[O])/(m[S]-m[O]);E._colors.push(h.Color.lerp(x[O],x[S],k,h.Color.Space.LAB))}return E}lerp(s,o=h.Color.Space.LAB){if(this._colors.length===0)return;if(this._colors.length===1)return this._colors[0];const l=(0,a.clamp)(s,0,1);if(l<=0)return this._colors[0];if(l>=1)return this._colors[this._colors.length-1];const m=s*this._colors.length,v=Math.floor(m),f=v+1;return f>=this._colors.length?this._colors[this._colors.length-1]:((0,r.assert)(f<this._colors.length,`expected upper not exceed maximum color index: ${f} < ${this._colors.length}`),this._hint===d.InterpolationHint.Nearest?this._colors[m-v<=f-m?v:f]:h.Color.lerp(this._colors[v],this._colors[f],m-v,o))}color(s){if(!(s<0||s>=this._colors.length))return this._colors[s]}get colors(){return this._colors}set colors(s){this._colors=s}set hint(s){this._hint=s}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(s=h.Color.Space.RGB,o=!0){const l=this._colors.length,m=o?4:3,v=new Uint8Array(l*m);for(let f=0;f<l;++f){const b=this._colors[f].tuple(s,o);v[f*m+0]=255*b[0],v[f*m+1]=255*b[1],v[f*m+2]=255*b[2],o&&b.length===4&&(v[f*m+3]=255*b[3])}return v}bitsF32(s=h.Color.Space.RGB,o=!0){const l=this._colors.length,m=o?4:3,v=new Float32Array(l*m);for(let f=0;f<l;++f){const b=this._colors[f].tuple(s,o);v[f*m+0]=b[0],v[f*m+1]=b[1],v[f*m+2]=b[2],o&&b.length===4&&(v[f*m+3]=b[3])}return v}}t.ColorScale=d,d.SCHEMA=i(421),function(c){(function(s){s.Linear="linear",s.Nearest="nearest"})(c.InterpolationHint||(c.InterpolationHint={})),function(s){s.sequential="sequential",s.diverging="diverging",s.qualitative="qualitative"}(c.ScaleType||(c.ScaleType={})),function(s){s.RGB="rgb",s.RGBf="rgbf",s.RGBA="rgba",s.RGBAf="rgbaf"}(c.ArrayType||(c.ArrayType={}))}(d||(t.ColorScale=d={}))},2527:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const a=i(9504),r=i(3513),h=i(7501),_=i(5557),d=i(5304),c=i(5060),s=i(829);class o{static createMasqueradeFromGETorDataAttribute(m){return _.ContextMasquerade.fromGET()||(m.msqrdH?_.ContextMasquerade.fromHash(m.msqrdH):m.msqrdP?_.ContextMasquerade.fromPreset(m.msqrdP):void 0)}static request(m,v=o.DEFAULT_ATTRIBUTES){const f=m.dataset,b=o.createMasqueradeFromGETorDataAttribute(f);let x,E=b?b.backend:f.backend?f.backend.toLowerCase():"auto";switch(E in o.BackendRequestType||((0,a.log)(a.LogLevel.Warning,`unknown backend '${f.backend}' changed to '${o.BackendRequestType.auto}'`),E="auto"),E){case o.BackendRequestType.webgl:break;case o.BackendRequestType.experimental:case o.BackendRequestType.webgl1:case o.BackendRequestType.experimental1:E=o.BackendRequestType.webgl;break;case o.BackendRequestType.webgl2:case o.BackendRequestType.experimental2:E=o.BackendRequestType.webgl2;break;default:E=o.BackendRequestType.auto}return E!==o.BackendRequestType.webgl&&(x=this.requestWebGL2(m,v)),x||(x=this.requestWebGL1(m,v),(0,a.logIf)(x!==void 0&&E===o.BackendRequestType.webgl2,a.LogLevel.Info,`backend changed to '${o.BackendRequestType.webgl}', given '${E}'`)),(0,a.assert)(!!x,"creating a context failed"),new o(x,b)}static requestWebGL1(m,v=o.DEFAULT_ATTRIBUTES){let f=m.getContext(o.BackendRequestType.webgl,v);return f||(f=m.getContext(o.BackendRequestType.experimental,v),f===null?void 0:f)}static requestWebGL2(m,v=o.DEFAULT_ATTRIBUTES){let f=m.getContext(o.BackendRequestType.webgl2,v);return f||(f=m.getContext(o.BackendRequestType.experimental2,v),f===null?void 0:f)}queryAttributes(){const m=this._context.getContextAttributes();m!==null?this._attributes=m:(0,a.log)(a.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(m){if(this._mask&&this._mask.extensionsConceal.indexOf(m)>-1)return!1;switch(this._backend){case o.BackendType.WebGL1:(0,a.assert)(d.WEBGL1_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL1`);break;case o.BackendType.WebGL2:(0,a.assert)(d.WEBGL2_DEFAULT_EXTENSIONS.indexOf(m)===-1,`extension ${m} supported by default in WebGL2`),(0,a.assert)(d.WEBGL2_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL2`)}return this._extensions.indexOf(m)>-1}enable(m){for(const v of m)this.isWebGL1&&d.WEBGL1_EXTENSIONS.indexOf(v)===-1||this.isWebGL2&&d.WEBGL2_EXTENSIONS.indexOf(v)===-1||this.supports(v)!==!1&&this.extension(void 0,v)}queryExtensionSupport(){const m=this._context.getSupportedExtensions();if(m!==null){for(const v of m)this._mask&&this._mask.extensionsConceal.indexOf(v)>-1||this._extensions.push(v);this._backend===o.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===o.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else(0,a.log)(a.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(m,v){return m===void 0&&((0,a.assert)(this.supports(v),`extension ${v} expected to be supported`),m=this._context.getExtension(v)),m}constructor(m,v){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new h.AllocationRegister,this._context=m,this._mask=v;const f=m.toString();{const b=/WebGLRenderingContext/.test(f)||/CaptureContext/.test(f),x=/WebGL2RenderingContext/.test(f);this._backend=b?o.BackendType.WebGL1:x?o.BackendType.WebGL2:void 0}if((0,a.assert)(this._backend!==void 0&&this._backend.valueOf()!==o.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${f}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const b in this._mask.functionsUndefine)this._context[b]=void 0;this._gl2=new s.GL2Facade(this)}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case o.BackendType.WebGL1:return"WebGL";case o.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===o.BackendType.WebGL1}get isWebGL2(){return this._backend===o.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case o.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case o.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case o.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return this._context.blitFramebuffer!==void 0}get supportsReadBuffer(){return this._context.readBuffer!==void 0}get supportsTexImage3D(){return this._context.texImage3D!==void 0}param(m){return(0,a.assert)(!!this._context,"expected context to be valid"),this._context.getParameter(m)}hash(){return c.ExtensionsHash.encode(this._backend,this._extensions)}about(){const m="ok",v="na";if(this._backend===o.BackendType.Invalid)return new Array;(0,a.assert)(!!this._context,"expected context to be valid");const f=this._context,b=new Array;b.push(["BACKEND (GLOPERATE)",this.backend]),b.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),b.push(["RENDERER",this.param(f.RENDERER)]),b.push(["VENDOR",this.param(f.VENDOR)]),b.push(["VERSION",this.param(f.VERSION)]),b.push(["SHADING_LANGUAGE_VERSION",this.param(f.SHADING_LANGUAGE_VERSION)]),b.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):v]),b.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):v]),b.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),b.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),b.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),b.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),b.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),b.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),b.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),b.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),b.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),b.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),b.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),b.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),b.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),b.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),b.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),b.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(f.MAX_CUBE_MAP_TEXTURE_SIZE)]),b.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(f.MAX_FRAGMENT_UNIFORM_VECTORS)]),b.push(["MAX_RENDERBUFFER_SIZE",this.param(f.MAX_RENDERBUFFER_SIZE)]),b.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(f.MAX_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_TEXTURE_SIZE",this.param(f.MAX_TEXTURE_SIZE)]),b.push(["MAX_VARYING_VECTORS",this.param(f.MAX_VARYING_VECTORS)]),b.push(["MAX_VERTEX_ATTRIBS",this.param(f.MAX_VERTEX_ATTRIBS)]),b.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(f.MAX_VERTEX_UNIFORM_VECTORS)]);const x=this.param(f.MAX_VIEWPORT_DIMS);if(b.push(["MAX_VIEWPORT_DIMS (WIDTH)",x?x[0]:null]),b.push(["MAX_VIEWPORT_DIMS (HEIGHT)",x?x[1]:null]),this.isWebGL2){const E=this._context;b.push(["MAX_3D_TEXTURE_SIZE",this.param(E.MAX_3D_TEXTURE_SIZE)]),b.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(E.MAX_ARRAY_TEXTURE_LAYERS)]),b.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(E.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),b.push(["MAX_COLOR_ATTACHMENTS",this.param(E.MAX_COLOR_ATTACHMENTS)]),b.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),b.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(E.MAX_COMBINED_UNIFORM_BLOCKS)]),b.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),b.push(["MAX_DRAW_BUFFERS",this.param(E.MAX_DRAW_BUFFERS)]),b.push(["MAX_ELEMENT_INDEX",this.param(E.MAX_ELEMENT_INDEX)]),b.push(["MAX_ELEMENTS_INDICES",this.param(E.MAX_ELEMENTS_INDICES)]),b.push(["MAX_ELEMENTS_VERTICES",this.param(E.MAX_ELEMENTS_VERTICES)]),b.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(E.MAX_FRAGMENT_INPUT_COMPONENTS)]),b.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(E.MAX_FRAGMENT_UNIFORM_BLOCKS)]),b.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),b.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(E.MAX_PROGRAM_TEXEL_OFFSET)]),b.push(["MAX_SAMPLES",this.param(E.MAX_SAMPLES)]),b.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(E.MAX_SERVER_WAIT_TIMEOUT)]),b.push(["MAX_TEXTURE_LOD_BIAS",this.param(E.MAX_TEXTURE_LOD_BIAS)]),b.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),b.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),b.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),b.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(E.MAX_UNIFORM_BLOCK_SIZE)]),b.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(E.MAX_UNIFORM_BUFFER_BINDINGS)]),b.push(["MAX_VARYING_COMPONENTS",this.param(E.MAX_VARYING_COMPONENTS)]),b.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(E.MAX_VERTEX_OUTPUT_COMPONENTS)]),b.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(E.MAX_VERTEX_UNIFORM_BLOCKS)]),b.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_VERTEX_UNIFORM_COMPONENTS)]),b.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(E.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const E of d.WEBGL1_EXTENSIONS)b.push([E,this.supports(E)?m:v]);else if(this.isWebGL2){for(const E of d.WEBGL2_DEFAULT_EXTENSIONS)b.push([`${E} (default)`,m]);for(const E of d.WEBGL2_EXTENSIONS)b.push([E,this.supports(E)?m:v])}return b}aboutString(){const m=this.about();let v=0;for(const E of m)v=Math.max(E[0].length,v);let f=0,b="";const x=this.isWebGL2?63+d.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const E of m){switch(f){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case x:b+=`
`}b+=`  ${E[0]} ${"-".repeat(v-E[0].length)}-- ${E[1]}
`,++f}return b+=`
`,b}logAbout(m=a.LogLevel.Info){(0,a.log)(m,`context.about

`+this.aboutString())}logAboutIf(m,v=a.LogLevel.Info){(0,a.logIf)(m,v,`context.about

`+this.aboutString())}byteSizeOfFormat(m){return(0,r.byteSizeOfFormat)(this,m)}}t.Context=o,o.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(l){(function(m){m.Invalid="invalid",m.WebGL1="webgl1",m.WebGL2="webgl2"})(l.BackendType||(l.BackendType={})),function(m){m.auto="auto",m.webgl="webgl",m.experimental="experimental-webgl",m.webgl1="webgl1",m.experimental1="experimental-webgl1",m.webgl2="webgl2",m.experimental2="experimental-webgl2"}(l.BackendRequestType||(l.BackendRequestType={}))}(o||(t.Context=o={}))},5557:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMasquerade=void 0;const a=i(9504),r=i(5060);class h{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(d){const c=new h,s=r.ExtensionsHash.decode(d);return c._backend=s[0],c._extensionsStrive=s[1],c._extensionsConceal=r.ExtensionsHash.complement(c._backend,c._extensionsStrive),c}static fromPreset(d){const c=new h,s=new Array;let o;for(const l of h.presets())if(s.push(l.identifier),l.identifier===d){o=l;break}if(o===void 0&&(0,a.assert)(!1,`expected valid identifier, available ['${s.join("', '")}'], given '${d}'`),o.extensions_hash!==void 0){const l=r.ExtensionsHash.decode(o.extensions_hash);c._backend=l[0],c._extensionsStrive=l[1]}else c._backend=o.backend;return(0,a.assert)(c._backend!==void 0,"expected backend to be included in preset"),o.extensions_strive===void 0?(c._extensionsStrive=[],c._extensionsConceal=o.extensions_conceal?o.extensions_conceal:[]):(c._extensionsStrive=o.extensions_strive,c._extensionsConceal=r.ExtensionsHash.complement(c._backend,o.extensions_strive)),c._functionsUndefine=o.functions_undefine?o.functions_undefine:[],c}static fromGET(){const d=(0,a.GETparameter)("msqrd_h");if(d!==void 0)return h.fromHash(d);const c=(0,a.GETparameter)("msqrd_p");return c!==void 0?h.fromPreset(c):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}t.ContextMasquerade=h,h.MASQUERADE_JSON=i(7857)},8234:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;const a=i(7032),r=i(9504),h=i(5150);class _{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new a.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new a.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new a.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new a.Subject,this._postSwapEventSubject=new a.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(c){c&&(0,r.logVerbosity)()<r.LogLevel.Debug&&((0,r.logVerbosity)(r.LogLevel.Debug),(0,r.log)(r.LogLevel.Debug,`changed log verbosity to ${r.LogLevel.Debug} (debug)`)),_._debug=c}set batch(c){(0,r.log)(r.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,c)}request(c=_.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame(()=>this.invoke(c))}invoke(c){if(this._animationFrameID!==0){if((0,r.assert)(this._controllable!==void 0,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),c===_.RequestType.Frame&&this._frameNumber===1)return this._timeoutID===void 0&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return(0,r.logIf)(_._debug,r.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){(0,r.logIf)(_._debug,r.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const c=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=c,this._updateFrameTime=c}invokeFrameAndSwap(){(0,r.logIf)(_._debug,r.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const c=this._debugFrameNumber>0;(0,r.assert)(!c||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const s=performance.now();let o=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(o=Math.min(o,this._debugFrameNumber));this._frameNumber<o;++this._frameNumber)(0,r.logIf)(_._debug,r.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;(0,r.logIf)(_._debug,r.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const l=this._multiTime[1]-s;this._multiFrameTime+=l,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],l),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],l),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout(()=>{this.request(_.RequestType.MultiFrame),this._timeoutID=void 0},this._multiFrameDelay)}cancelWaitMultiFrame(){this._timeoutID!==void 0&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(c=!1){this._invalidated=!0,this._force=this._force||c,this._animationFrameID===0&&this.request()}block(){(0,r.logIf)(_._debug,r.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){(0,r.logIf)(_._debug,r.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){this._animationFrameID!==0&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(c){c!==this._controllable&&(this._controllable=c,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(c){const s=Math.max(1,isNaN(c)?1:c);s!==this._multiFrameNumber&&(this._multiFrameNumber=s,this.multiFrameNumberNext(),(0,r.logIf)(s!==c,r.LogLevel.Debug,`multi-frame number adjusted to ${s}, given ${c}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(c){const s=(0,h.clamp)(isNaN(c)?0:c,0,this.multiFrameNumber);s!==this._debugFrameNumber&&(this._debugFrameNumber=s,this.debugFrameNumberNext(),(0,r.logIf)(s!==c,r.LogLevel.Debug,`debug-frame number adjusted to ${s}, given ${c}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(c){const s=Math.max(0,c);s!==this._multiFrameDelay&&(this._multiFrameDelay=s)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return this._frameNumber===0?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return this._frameNumber===0?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return this._frameNumber===0?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}t.Controller=_,_._debug=!1,function(d){(function(c){c[c.Frame=0]="Frame",c[c.MultiFrame=1]="MultiFrame"})(d.RequestType||(d.RequestType={}))}(_||(t.Controller=_={}))},6710:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CuboidGeometry=void 0;const a=i(3557),r=i(7340),h=i(638);class _ extends h.Geometry{constructor(c,s,o=!1,l=[1,1,1]){super(c,s),this._vertexLocation=0,this._extent=a.vec3.fromValues(1,1,1),this._uvCoordinates=!1,s=s!==void 0&&s!==""?s:this.constructor.name;const m=new r.Buffer(c,s+"VBO");this._buffers.push(m);const v=new r.Buffer(c,`${s}IndicesVBO`);this._buffers.push(v),this._extent=a.vec3.clone(l),this._uvCoordinates=o}bindBuffers(){this._uvCoordinates===!1?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(c=0,s=1){this._vertexLocation=c,this._uvCoordLocation=s;const o=this.context.gl,l=super.initialize([o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[c,s]),m=this._uvCoordinates;let v=m?_.VERTICES_UV:_.VERTICES;return v=v.map((f,b)=>f*(m===!1?.5*this._extent[b%3]:b%5<3?.5*this._extent[b%5]:1)),this._buffers[0].data(v,o.STATIC_DRAW),this._buffers[1].data(m?_.INDICES_UV:_.INDICES,o.STATIC_DRAW),this._count=m?_.INDICES_UV.length:_.INDICES.length,l}draw(){const c=this.context.gl;c.drawElements(c.TRIANGLE_STRIP,this._count,c.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}get count(){return this._count}}t.CuboidGeometry=_,_.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),_.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),_.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),_.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},4890:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeosphereGeometry=void 0;const a=i(9504),r=i(7340),h=i(638),_=i(5431);class d extends h.Geometry{constructor(s,o,l=1,m=!0){super(s,o),this._diameter=1,this._textured=!1,this._size=0,o=o!==void 0&&o!==""?o:this.constructor.name,this._diameter=l,this._textured=m;const v=new r.Buffer(s,o+"IndexBuffer");this._buffers.push(v);const f=new r.Buffer(s,o+"VBO");if(this._buffers.push(f),this._textured){const b=new r.Buffer(s,o+"UV");this._buffers.push(b)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(s=0,o=1){const l=this.context.gl;this._vertexLocation=s,this._texCoordLocation=o;const m=super.initialize([l.ELEMENT_ARRAY_BUFFER,l.ARRAY_BUFFER,l.ARRAY_BUFFER],[8,s,o]);(0,a.assert)(this._buffers[0]!==void 0&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),(0,a.assert)(this._buffers[1]!==void 0&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&(0,a.assert)(this._buffers[2]!==void 0&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const v=new _.Icosahedron;v.generateGeometry(3),this._textured&&v.generateTextureCoordinates();const f=v.faces,b=new Uint16Array(3*f.length);let x=0;for(const S of f)b[x+0]=S[0],b[x+1]=S[1],b[x+2]=S[2],x+=3;this._buffers[0].data(b,l.STATIC_DRAW),this._size=3*f.length;const E=v.vertices,O=new Float32Array(3*E.length);x=0;for(const S of E)O[x+0]=S[0]*this._diameter,O[x+1]=S[1]*this._diameter,O[x+2]=S[2]*this._diameter,x+=3;if(this._buffers[1].data(O,l.STATIC_DRAW),this._textured){const S=v.texcoords,w=new Float32Array(2*S.length);if(S&&S.length>0){x=0;for(const P of S)w[x+0]=P[0],w[x+1]=P[1],x+=2}this._buffers[2].data(w,l.STATIC_DRAW)}return m}draw(){const s=this.context.gl;s.drawElements(s.TRIANGLES,this._size,s.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.GeosphereGeometry=d},5431:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Icosahedron=void 0;const a=i(3557),r=i(5150);t.Icosahedron=class{constructor(){}baseVertices(){const h=.5*(1+Math.sqrt(5)),_=1/Math.sqrt(h*h+1),d=h*_;return[a.vec3.fromValues(-_,+d,0),a.vec3.fromValues(+_,+d,0),a.vec3.fromValues(-_,-d,0),a.vec3.fromValues(+_,-d,0),a.vec3.fromValues(0,-_,+d),a.vec3.fromValues(0,+_,+d),a.vec3.fromValues(0,-_,-d),a.vec3.fromValues(0,+_,-d),a.vec3.fromValues(+d,0,-_),a.vec3.fromValues(+d,0,+_),a.vec3.fromValues(-d,0,-_),a.vec3.fromValues(-d,0,+_)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(h,_,d){const c=new Map;for(let s=0;s<d;s++){const o=_.length;for(let l=0;l<o;l++){const m=_[l],v=m[0],f=m[1],b=m[2],x=this.split(v,f,h,c),E=this.split(f,b,h,c),O=this.split(b,v,h,c);_[l]=[x,E,O],_.push([v,x,O]),_.push([f,E,x]),_.push([b,O,E])}}}split(h,_,d,c){const s=h<_,o=((s?h:_)<<16)+(s?_:h);if(c.has(o))return c.get(o);const l=a.vec3.add((0,r.v3)(),d[h],d[_]);a.vec3.normalize(l,l),d.push(l);const m=d.length-1;return c.set(o,m),m}generateGeometry(h){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),h>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(h,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const h of this._vertices){const _=a.vec3.normalize((0,r.v3)(),h),d=a.vec2.fromValues(.5-Math.atan2(_[2],_[0])/(2*Math.PI),Math.asin(_[1])/Math.PI+.5);this._texcoords.push(d)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},1854:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=t.PlaneGeometry=t.GeosphereGeometry=t.Icosahedron=t.CuboidGeometry=void 0;var a=i(6710);Object.defineProperty(t,"CuboidGeometry",{enumerable:!0,get:function(){return a.CuboidGeometry}});var r=i(5431);Object.defineProperty(t,"Icosahedron",{enumerable:!0,get:function(){return r.Icosahedron}});var h=i(4890);Object.defineProperty(t,"GeosphereGeometry",{enumerable:!0,get:function(){return h.GeosphereGeometry}});var _=i(8500);Object.defineProperty(t,"PlaneGeometry",{enumerable:!0,get:function(){return _.PlaneGeometry}});var d=i(6449);Object.defineProperty(t,"ResourceManager",{enumerable:!0,get:function(){return d.ResourceManager}})},8500:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneGeometry=void 0;const a=i(3557),r=i(7340),h=i(638);class _ extends h.Geometry{constructor(c,s){super(c,s),this._vertexLocation=0,this._texCoordLocation=1,this._translation=a.vec3.fromValues(0,0,0),this._scale=a.vec3.fromValues(1,1,1),this._rotation=a.quat.create(),s=s!==void 0&&s!==""?s:this.constructor.name;const o=new r.Buffer(c,s+"VertexVBO"),l=new r.Buffer(c,s+"TexCoordVBO"),m=new r.Buffer(c,s+"IndexBuffer");this._buffers.push(o),this._buffers.push(l),this._buffers.push(m)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(c=0,s=1){const o=this.context.gl;this._vertexLocation=c,this._texCoordLocation=s;const l=super.initialize([o.ARRAY_BUFFER,o.ARRAY_BUFFER,o.ELEMENT_ARRAY_BUFFER],[c,s,8]);return this._buffers[0].data(_.VERTICES,o.STATIC_DRAW),this._buffers[1].data(_.UV,o.STATIC_DRAW),this._buffers[2].data(_.INDICES,o.STATIC_DRAW),l}draw(){const c=this.context.gl;c.drawElements(c.TRIANGLE_STRIP,_.INDICES.length,c.UNSIGNED_BYTE,0)}set translation(c){this._translation=c}set scale(c){this._scale=a.vec3.fromValues(c[0],1,c[1])}set rotation(c){this._rotation=c}get transformation(){const c=a.mat4.create();return a.mat4.fromRotationTranslationScale(c,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.PlaneGeometry=_,_.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),_.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),_.INDICES=new Uint8Array([0,1,2,3])},6449:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=void 0;const a=i(9504),r=i(7340),h=i(638),_=i(5315),d=i(8593);t.ResourceManager=class{constructor(c){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=c}fetchTexture2D(c,s,o=!1){if(this._texture2Ds.has(c))return;const l=new d.Texture2D(this._context,c);return(0,a.assert)(l.identifier===c,"expected object identifier to be unchanged"),this._texture2Ds.set(c,l),l.fetch(s,o)}add(c,s){const o=new Array;if(c instanceof d.Texture2D){const l=c;for(const m of s)this._texture2Ds.has(m)||(this._texture2Ds.set(m,l),o.push(m))}if(c instanceof _.Material){const l=c;for(const m of s)this._materials.has(m)||(this._materials.set(m,l),o.push(m))}if(c instanceof h.Geometry){const l=c;for(const m of s)this._geometries.has(m)||(this._geometries.set(m,l),o.push(m))}if(c instanceof r.Buffer){const l=c;for(const m of s)this._buffers.has(m)||(this._buffers.set(m,l),o.push(m))}return o}get(c){return this._texture2Ds.has(c)?this._texture2Ds.get(c):this._materials.has(c)?this._materials.get(c):this._geometries.has(c)?this._geometries.get(c):this._buffers.has(c)?this._buffers.get(c):void 0}uninitialize(){for(const c of Array.from(this._geometries.values()))c.initialized&&c.uninitialize();this._geometries.clear();for(const c of Array.from(this._texture2Ds.values()))c.initialized&&c.uninitialize();this._texture2Ds.clear();for(const c of Array.from(this._buffers.values()))c.initialized&&c.uninitialize();this._buffers.clear(),this._materials.clear()}}},2016:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(s,o,l,m){m===void 0&&(m=l);var v=Object.getOwnPropertyDescriptor(o,l);v&&!("get"in v?!o.__esModule:v.writable||v.configurable)||(v={enumerable:!0,get:function(){return o[l]}}),Object.defineProperty(s,m,v)}:function(s,o,l,m){m===void 0&&(m=l),s[m]=o[l]}),r=this&&this.__setModuleDefault||(Object.create?function(s,o){Object.defineProperty(s,"default",{enumerable:!0,value:o})}:function(s,o){s.default=o}),h=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var o={};if(s!=null)for(var l in s)l!=="default"&&Object.prototype.hasOwnProperty.call(s,l)&&a(o,s,l);return r(o,s),o};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const _=h(i(1728)),d=h(i(5657));var c;(function(s){s.TestRenderer=d.TestRenderer,s.TestNavigation=_.TestNavigation})(c||(t.debug=c={}))},1728:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TestNavigation=void 0;const a=i(2);t.TestNavigation=class{constructor(r,h){this._altered=!1,this._eventHandler=new a.EventHandler(r,h),this._eventHandler.pushMouseEnterHandler((_,d)=>this.onMouseEnter(_,d)),this._eventHandler.pushMouseLeaveHandler((_,d)=>this.onMouseLeave(_,d))}onMouseEnter(r,h){this._altered=!1}onMouseLeave(r,h){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},5657:(p,t,i)=>{const a=i(9504),r=i(9017),h=i(2419),_=i(8196),d=i(8386),c=i(8215),s=i(1896),o=i(4168),l=i(8400),m=i(3105),v=i(771),f=i(8593),b=i(1728);var x;(function(E){class O extends m.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(w,P,N){const k=this._context.gl,j=this._context.gl2facade;this._extensions===!1&&this._context.isWebGL1&&((0,a.assert)(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const U=new v.Shader(this._context,k.VERTEX_SHADER,"testrenderer.vert");U.initialize(i(5077));const H=new v.Shader(this._context,k.FRAGMENT_SHADER,"testrenderer.frag");H.initialize(i(6296)),this._program=new o.Program(this._context),this._program.initialize([U,H]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new s.NdcFillingTriangle(this._context);const Z=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(Z),this._ndcOffsetKernel=new h.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new d.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new f.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new l.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new c.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new r.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new _.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=j.COLOR_ATTACHMENT0,this._blit.drawBuffer=k.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new b.TestNavigation(()=>this.invalidate(),N),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const w=this._testNavigation.altered;return this._testNavigation.reset(),!(!w&&!this._altered.any)&&w}onPrepare(){const w=this._context.gl,P=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?w.RGBA8:w.RGBA,w.RGBA,w.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],w.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[P.COLOR_ATTACHMENT0,this._colorRenderTexture],[w.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(w){const P=this._context.gl;P.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const N=this._ndcOffsetKernel.get(w);N[0]=2*N[0]/this._frameSize[0],N[1]=2*N[1]/this._frameSize[1],P.uniform2fv(this._uNdcOffset,N),P.uniform1i(this._uFrameNumber,w),this._intermediateFBO.clear(P.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(w)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}E.TestRenderer=O})(x||(x={})),p.exports=x},3334:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPass=void 0;const a=i(9504),r=i(4168),h=i(771),_=i(8196);class d extends _.BlitPass{constructor(){super(...arguments),this._debug=d.Mode.Depth,this._near=0,this._far=0}createProgram(){(0,a.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const s=this._context.gl,o=new h.Shader(this._context,s.VERTEX_SHADER,"blit.vert (debug)");o.initialize(i(3354));const l=new h.Shader(this._context,s.FRAGMENT_SHADER,"blit_debug.frag (debug)");return l.initialize(i(8359)),this._program=new r.Program(this._context,"DebugProgram"),this._program.initialize([o,l]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),s.uniform1i(this._program.uniform("u_source"),0),s.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(s){const o=super.initialize(s);return this.enforceProgramBlit=!0,o&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(s){this.assertInitialized(),this._debug!==s&&(this._debug=s,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(s){this._near=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(s){this._far=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}t.DebugPass=d,function(c){(function(s){s[s.None=0]="None",s[s.Depth=1]="Depth",s[s.DepthLinear=2]="DepthLinear",s[s.DepthPacked=3]="DepthPacked",s[s.DepthLinearPacked=4]="DepthLinearPacked"})(c.Mode||(c.Mode={}))}(d||(t.DebugPass=d={}))},8386:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFramebuffer=void 0;const r=i(9504),h=i(8215),_=i(4127);class d extends h.Framebuffer{create(){return this._object=h.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(s){return!1}bind(s=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(s,this._object)}clearColor(s){super.clearColor(s)}resize(){(0,r.assert)(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}t.DefaultFramebuffer=d,a([_.Initializable.assert_initialized()],d.prototype,"bind",null)},6464:function(p,t,i){var a=this&&this.__decorate||function(v,f,b,x){var E,O=arguments.length,S=O<3?f:x===null?x=Object.getOwnPropertyDescriptor(f,b):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(v,f,b,x);else for(var w=v.length-1;w>=0;w--)(E=v[w])&&(S=(O<3?E(S):O>3?E(f,b,S):E(f,b))||S);return O>3&&S&&Object.defineProperty(f,b,S),S};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentTextureType=t.EnvironmentRenderingPass=void 0;const r=i(9504),h=i(4127),_=i(1896),d=i(4168),c=i(771),s=i(8593),o=i(5186);class l extends h.Initializable{constructor(f){super(),this._skipCubeLod=!1,this._altered=!0,this._context=f,this._cubeMapProgram=new d.Program(f,"CubemapEnvironmentProgram"),this._equiMapProgram=new d.Program(f,"EquimapEnvironmentProgram"),this._polarMapProgram=new d.Program(f,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new d.Program(f,"SpheremapEnvironmentProgram"),this._ndcTriangle=new _.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const f=this._context.gl;this._ndcTriangle.initialize();const b=new c.Shader(this._context,f.VERTEX_SHADER,"env-projections.vert");b.initialize(i(3761));const x=new c.Shader(this._context,f.FRAGMENT_SHADER,"env-projections.frag");x.initialize(i(9196),!1),x.replace("PROJECTION_TYPE","CUBE_MAP"),x.compile(),this._cubeMapProgram.initialize([b,x],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),f.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const E=new c.Shader(this._context,f.FRAGMENT_SHADER,"env-projections.frag");E.initialize(i(9196),!1),E.replace("PROJECTION_TYPE","EQUI_MAP"),E.compile(),this._equiMapProgram.initialize([b,E],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),f.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const O=new c.Shader(this._context,f.FRAGMENT_SHADER,"env-projections.frag");O.initialize(i(9196),!1),O.replace("PROJECTION_TYPE","SPHERE_MAP"),O.compile(),this._sphereMapProgram.initialize([b,O],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),f.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const S=new c.Shader(this._context,f.FRAGMENT_SHADER,"env-projections.frag");return S.initialize(i(9196),!1),S.replace("PROJECTION_TYPE","POLAR_MAP"),S.compile(),this._polarMapProgram.initialize([b,S],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),f.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(this._altered===!1)return;const f=this._context.gl;this._cubeMapProgram.bind(),f.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const f=this._context.gl;(0,r.assert)(this._camera!==void 0,"Camera is undefined in environment rendering pass."),(0,r.assert)(this._environmentTexture!==void 0,"Environment texture is undefined in environment rendering pass.");let b=this._cubeMapProgram;this._envTextureType===m.EquirectangularMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(f.TEXTURE0),b=this._equiMapProgram):this._envTextureType===m.SphereMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(f.TEXTURE0),b=this._sphereMapProgram):this._envTextureType===m.CubeMap?((0,r.assert)(this._environmentTexture instanceof o.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(f.TEXTURE0),b=this._cubeMapProgram):this._envTextureType===m.PolarMap&&((0,r.assert)(this._environmentTexture2!==void 0,"Two input textures expected for polar mapping."),(0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),(0,r.assert)(this._environmentTexture2 instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(f.TEXTURE0),this._environmentTexture2.bind(f.TEXTURE1),b=this._polarMapProgram),b.bind(),f.uniformMatrix4fv(b.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),b.unbind()}set environmentTextureType(f){this._envTextureType=f}set environmentTexture(f){this._environmentTexture=f}set environmentTexture2(f){this._environmentTexture2=f}set camera(f){this._camera=f}set skipCubeLod(f){this._skipCubeLod!==f&&(this._skipCubeLod=f,this._altered=!0)}}var m;t.EnvironmentRenderingPass=l,a([h.Initializable.initialize()],l.prototype,"initialize",null),a([h.Initializable.uninitialize()],l.prototype,"uninitialize",null),function(v){v[v.CubeMap=0]="CubeMap",v[v.EquirectangularMap=1]="EquirectangularMap",v[v.SphereMap=2]="SphereMap",v[v.PolarMap=3]="PolarMap"}(m||(t.EnvironmentTextureType=m={}))},2:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventHandler=void 0;const a=i(3557),r=i(9504),h=i(3975),_=i(4602),d=i(8216),c=i(8870),s=i(5678);t.EventHandler=class{constructor(o,l){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._latestKeyboardEventsByType=new Map,this._previousKeyboardEventsByType=new Map,this._keyboardEventHandlerByType=new Map,this._invalidate=o,this._mouseEventProvider=l.mouseEventProvider,this._mouseEventProvider.preventDefault(_.MouseEventProvider.Type.Wheel),this._pointerEventProvider=l.pointerEventProvider,this._eyeGazeEventProvider=l.eyeGazeEventProvider,this._keyboardEventProvider=l.keyboardEventProvider}invalidate(o=!1){this._invalidate&&this._invalidate(o)}pushMouseEventHandler(o,l){if(this._mouseEventHandlerByType.has(o))return void this._mouseEventHandlerByType.get(o).push(l);this._mouseEventHandlerByType.set(o,new Array),this._previousMouseEventsByType.set(o,new Array);const m=new Array;this._latestMouseEventsByType.set(o,m),(0,r.assert)(this._mouseEventProvider!==void 0,"expected valid mouse event provider");const v=this._mouseEventProvider.observable(o);_.MouseEventProvider.Type.Wheel,this._subscriptions.push(v.subscribe(f=>{m.push(f),this.invalidate()})),this._mouseEventHandlerByType.get(o).push(l)}invokeMouseEventHandler(o){const l=this._mouseEventHandlerByType.get(o);if(l===void 0||l.length===0)return;const m=this._latestMouseEventsByType.get(o);if(m.length===0)return;const v=this._previousMouseEventsByType.get(o);l.forEach(f=>f(m,v)),Object.assign(v,m),m.length=0}pushTouchEventHandler(o,l){if(this._touchEventHandlerByType.has(o))return void this._touchEventHandlerByType.get(o).push(l);this._touchEventHandlerByType.set(o,new Array),this._previousTouchEventsByType.set(o,new Array);const m=new Array;this._latestTouchEventsByType.set(o,m),(0,r.assert)(this._touchEventProvider!==void 0,"expected valid touch event provider");const v=this._touchEventProvider.observable(o);this._subscriptions.push(v.subscribe(f=>{m.push(f),this.invalidate()})),this._touchEventHandlerByType.get(o).push(l)}invokeTouchEventHandler(o){const l=this._touchEventHandlerByType.get(o);if(l===void 0||l.length===0)return;const m=this._latestTouchEventsByType.get(o);if(m.length===0)return;const v=this._previousTouchEventsByType.get(o);l.forEach(f=>f(m,v)),Object.assign(v,m),m.length=0}pushPointerEventHandler(o,l){if(this._pointerEventHandlerByType.has(o))return void this._pointerEventHandlerByType.get(o).push(l);this._pointerEventHandlerByType.set(o,new Array),this._previousPointerEventsByType.set(o,new Array);const m=new Array;this._latestPointerEventsByType.set(o,m),(0,r.assert)(this._pointerEventProvider!==void 0,"expected valid pointer event provider");const v=this._pointerEventProvider.observable(o);this._subscriptions.push(v.subscribe(f=>{m.push(f),this.invalidate()})),this._pointerEventHandlerByType.get(o).push(l)}invokePointerEventHandler(o){const l=this._pointerEventHandlerByType.get(o);if(l===void 0||l.length===0)return;const m=this._latestPointerEventsByType.get(o);if(m.length===0)return;const v=this._previousPointerEventsByType.get(o);l.forEach(f=>f(m,v)),Object.assign(v,m),m.length=0}pushEyeGazeEventHandler(o,l){if(this._eyeGazeEventHandlerByType.has(o))return void this._eyeGazeEventHandlerByType.get(o).push(l);this._eyeGazeEventHandlerByType.set(o,new Array),this._previousEyeGazeEventsByType.set(o,new Array);const m=new Array;this._latestEyeGazeEventsByType.set(o,m),(0,r.assert)(this._eyeGazeEventProvider!==void 0,"expected valid eye gaze event provider");const v=this._eyeGazeEventProvider.observable(o);this._subscriptions.push(v.subscribe(f=>{m.push(f),this.invalidate()})),this._eyeGazeEventHandlerByType.get(o).push(l)}invokeEyeGazeEventHandler(o){const l=this._eyeGazeEventHandlerByType.get(o);if(l===void 0||l.length===0)return;const m=this._latestEyeGazeEventsByType.get(o);if(m.length===0)return;const v=this._previousEyeGazeEventsByType.get(o);l.forEach(f=>f(m,v)),Object.assign(v,m),m.length=0}pushKeyboardEventHandler(o,l){if(this._keyboardEventHandlerByType.has(o))return void this._keyboardEventHandlerByType.get(o).push(l);this._keyboardEventHandlerByType.set(o,new Array),this._previousKeyboardEventsByType.set(o,new Array);const m=new Array;this._latestKeyboardEventsByType.set(o,m),(0,r.assert)(this._keyboardEventProvider!==void 0,"expected valid keyboard event provider");const v=this._keyboardEventProvider.observable(o);this._subscriptions.push(v.subscribe(f=>{m.push(f),this.invalidate()})),this._keyboardEventHandlerByType.get(o).push(l)}invokeKeyboardEventHandler(o){const l=this._keyboardEventHandlerByType.get(o);if(l===void 0||l.length===0)return;const m=this._latestKeyboardEventsByType.get(o);if(m.length===0)return;const v=this._previousKeyboardEventsByType.get(o);l.forEach(f=>f(m,v)),Object.assign(v,m),m.length=0}dispose(){this._latestMouseEventsByType.forEach(o=>o.length=0),this._previousMouseEventsByType.forEach(o=>o.length=0),this._latestTouchEventsByType.forEach(o=>o.length=0),this._previousTouchEventsByType.forEach(o=>o.length=0),this._latestPointerEventsByType.forEach(o=>o.length=0),this._previousPointerEventsByType.forEach(o=>o.length=0),this._previousEyeGazeEventsByType.forEach(o=>o.length=0),this._latestEyeGazeEventsByType.forEach(o=>o.length=0),this._latestKeyboardEventsByType.forEach(o=>o.length=0),this._previousKeyboardEventsByType.forEach(o=>o.length=0);for(const o of this._subscriptions)o.unsubscribe()}update(){this.invokeMouseEventHandler(_.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(_.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(c.TouchEventProvider.Type.End),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(d.PointerEventProvider.Type.Move),this.invokePointerEventHandler(d.PointerEventProvider.Type.Down),this.invokePointerEventHandler(d.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(d.PointerEventProvider.Type.Up),this.invokePointerEventHandler(d.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(d.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(h.EyeGazeEventProvider.Type.BinaryMessageParsingError),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyDown),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyPress),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyUp)}offsets(o,l=!0){const m=new Array;let v=!1;if(o instanceof MouseEvent){const b=o;v=b.offsetX!==0&&b.offsetY!==0,m.push(v?a.vec2.fromValues(b.offsetX,b.offsetY):a.vec2.fromValues(b.clientX,b.clientY))}else if(o instanceof WheelEvent){const b=o;v=b.offsetX!==0&&b.offsetY!==0,m.push(v?a.vec2.fromValues(b.offsetX,b.offsetY):a.vec2.fromValues(b.clientX,b.clientY))}else if(o instanceof TouchEvent){const b=o;for(let x=0;x<b.touches.length;++x){const E=b.touches.item(x);m.push(a.vec2.fromValues(E.clientX,E.clientY))}}if(v){if(l)for(const b of m)a.vec2.scale(b,b,window.devicePixelRatio);return m}const f=(o.target||o.currentTarget||o.srcElement).getBoundingClientRect();for(const b of m)b[0]=Math.floor(b[0]-f.left),b[1]=Math.floor(b[1]-f.top),l&&a.vec2.scale(b,b,window.devicePixelRatio);return m}pushClickHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Click,o)}pushMouseEnterHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Enter,o)}pushMouseLeaveHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Leave,o)}pushMouseDownHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Down,o)}pushMouseUpHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Up,o)}pushMouseMoveHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Move,o)}pushMouseWheelHandler(o){this.pushMouseEventHandler(_.MouseEventProvider.Type.Wheel,o)}pushTouchStartHandler(o){this.pushTouchEventHandler(c.TouchEventProvider.Type.Start,o)}pushTouchEndHandler(o){this.pushTouchEventHandler(c.TouchEventProvider.Type.End,o)}pushTouchMoveHandler(o){this.pushTouchEventHandler(c.TouchEventProvider.Type.Move,o)}pushTouchCancelHandler(o){this.pushTouchEventHandler(c.TouchEventProvider.Type.Cancel,o)}pushPointerUpHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Up,o)}pushPointerDownHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Down,o)}pushPointerEnterHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Enter,o)}pushPointerLeaveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Leave,o)}pushPointerMoveHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Move,o)}pushPointerCancelHandler(o){this.pushPointerEventHandler(d.PointerEventProvider.Type.Cancel,o)}pushEyeGazeDataHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.EyeGazeData,o)}pushEyeGazeServerMessageHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.NewServerMessage,o)}pushEyeGazeConnectionStatusHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.ConnectionStatus,o)}pushEyeGazeBinaryMessageParsingErrorHandler(o){this.pushEyeGazeEventHandler(h.EyeGazeEventProvider.Type.BinaryMessageParsingError,o)}pushKeyDownHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyDown,o)}pushKeyPressHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyPress,o)}pushKeyUpHandler(o){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyUp,o)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},5304:p=>{var t;(function(i){i.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],i.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],i.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]})(t||(t={})),p.exports=t},5060:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsHash=void 0;const a=i(9504),r=i(5304);class h{static encode64(d){return(0,a.assert)(d>=0&&d<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${d}`),h.BASE64_ALPHABET[d]}static decode64(d){(0,a.assert)(d.length===1,`expected single base64 character, given '${d}'`);const c=h.BASE64_ALPHABET.indexOf(d);return(0,a.assert)(c>-1,`unknown base64 character, given '${d}'`),c}static encode(d,c){const s=h.LATEST_VERSION,o=h.EXTENSIONS_BY_VERSION.get(s),l=h.WEBGL_BACKENDS.indexOf(d);(0,a.assert)(l>-1,`expected valid backend ${h.WEBGL_BACKENDS}, given ${d} `);let m=h.encode64(s<<3|l+1);if(c.length===0)return m;let v=0;for(let f=0;f<o.length;++f)v|=c.indexOf(o[f])>-1?32>>f%6:0,f%6<5&&f<o.length-1||(m+=h.encode64(v),v=0);return m}static decode(d){const c=h.decode64(d[0]),s=c>>3,o=(7&c)-1;(0,a.assert)(o<h.WEBGL_BACKENDS.length,`expected valid backend index, given ${o}`);const l=h.WEBGL_BACKENDS[o];(0,a.assert)(h.EXTENSIONS_BY_VERSION.has(s),`expected valid hash version, given ${s}`);const m=h.EXTENSIONS_BY_VERSION.get(s),v=Math.ceil(m.length/6)+1;(0,a.assert)(d.length===v,`expected hash of version ${s} to have a length of ${v}, given ${d}`);const f=new Array;for(let b=1;b<d.length;++b){const x=h.decode64(d[b]),E=6*(b-1);32&x&&f.push(m[E+0]),16&x&&f.push(m[E+1]),8&x&&f.push(m[E+2]),4&x&&f.push(m[E+3]),2&x&&f.push(m[E+4]),1&x&&f.push(m[E+5])}return[l,f]}static complement(d,c){const s=h.WEBGL_BACKENDS.indexOf(d);return(0,a.assert)(s>-1,`expected valid backend ${h.WEBGL_BACKENDS}, given ${d} `),h.WEBGL_EXTENSIONS_BY_BACKEND.get(s).filter(o=>c.indexOf(o)<0)}}t.ExtensionsHash=h,h.WEBGL_BACKENDS=["webgl1","webgl2"],h.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,r.WEBGL1_EXTENSIONS],[1,r.WEBGL2_EXTENSIONS]]),h.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),h.LATEST_VERSION=0,h.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},3404:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeDataStreams=t.EyeGazeDataStream=t.EyeGazeEventTarget=void 0;const a=i(6662);class r extends EventTarget{}t.EyeGazeEventTarget=r;class h{constructor(){this._eyeGazeDataStreams=new _,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const c=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(c[0]=1|c[0]),this._eyeGazeDataStreams.gazeOrigin&&(c[0]=2|c[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(c[0]=4|c[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(c[0]=8|c[0]),this._eyeGazeDataStreams.userPresence&&(c[0]=16|c[0]),c}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const c=this.generateStreamConfigByte();this._webSocket.send(c)}parseEyeTrackingData(c){if(c.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(h.BINARY_MESSAGE_PARSING_ERROR);let s=0;const o=new a.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(o.gazePositionXY[0]=c[s++],o.gazePositionXY[1]=c[s++]),this._eyeGazeDataStreams.gazeOrigin&&(o.gazeOriginRightXYZ[0]=c[s++],o.gazeOriginRightXYZ[1]=c[s++],o.gazeOriginRightXYZ[2]=c[s++],o.gazeOriginLeftXYZ[0]=c[s++],o.gazeOriginLeftXYZ[1]=c[s++],o.gazeOriginLeftXYZ[2]=c[s++]),this._eyeGazeDataStreams.eyePositionNormalized&&(o.eyePositionRightNormalizedXYZ[0]=c[s++],o.eyePositionRightNormalizedXYZ[1]=c[s++],o.eyePositionRightNormalizedXYZ[2]=c[s++],o.eyePositionLeftNormalizedXYZ[0]=c[s++],o.eyePositionLeftNormalizedXYZ[1]=c[s++],o.eyePositionLeftNormalizedXYZ[2]=c[s++]),this._eyeGazeDataStreams.headPositionAndRotation&&(o.headPositionXYZ[0]=c[s++],o.headPositionXYZ[1]=c[s++],o.headPositionXYZ[2]=c[s++],o.headRotationXYZ[0]=c[s++],o.headRotationXYZ[1]=c[s++],o.headRotationXYZ[2]=c[s++]),this._eyeGazeDataStreams.userPresence&&(o.userPresence=c[s]!==0),new CustomEvent(h.EYE_GAZE_DATA,{detail:{eyeGazeData:o}})}onOpen(c){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.SUCCESSFULLY_CONNECTED_TO_SERVER,event:c}})),this.performHandshake()}onClose(c){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.DISCONNECTED_TO_SERVER,event:c}}))}onError(c){this.dispatchEvent(new CustomEvent(h.CONNECTION_STATUS,{detail:{message:h.CONNECTION_ERROR,event:c}}))}async onMessage(c){if(typeof c.data!="string"){const s=await c.data.arrayBuffer(),o=new Float32Array(s);this.dispatchEvent(this.parseEyeTrackingData(o))}else this.dispatchEvent(new CustomEvent(h.NEW_SERVER_MESSAGE,{detail:{message:c.data}}))}connect(c){this._webSocket=new WebSocket(c),this._webSocket.onopen=s=>{this.onOpen(s)},this._webSocket.onclose=s=>{this.onClose(s)},this._webSocket.onerror=s=>{this.onError(s)},this._webSocket.onmessage=s=>{this.onMessage(s)}}addEventListener(c,s,o){this._eyeGazeEventTarget.addEventListener(c,s||null,o)}dispatchEvent(c){return this._eyeGazeEventTarget.dispatchEvent(c)}removeEventListener(c,s,o){this._eyeGazeEventTarget.removeEventListener(c,s||null,o)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(c){this._eyeGazeDataStreams!==c&&(this._eyeGazeDataStreams=c)}}t.EyeGazeDataStream=h,h.EYE_GAZE_DATA="eyegazedata",h.NEW_SERVER_MESSAGE="newservermessage",h.CONNECTION_STATUS="connectionstatus",h.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",h.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",h.DISCONNECTED_TO_SERVER="disconnected to server",h.CONNECTION_ERROR="connection error with server";class _{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let c=0;this.gazePosition&&(c+=2),this.gazeOrigin&&(c+=6),this.eyePositionNormalized&&(c+=6),this.headPositionAndRotation&&(c+=6),this.userPresence&&(c+=1),this.expectedNumberOfFloats=c}}t.EyeGazeDataStreams=_},6662:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeData=void 0,t.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let i="";return i+=`Gaze Position: ${this.gazePositionXY}
`,i+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}
`,i+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}
`,i+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}
`,i+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}
`,i+=`Head Position: ${this.headPositionXYZ}
`,i+=`Head Rotation: ${this.headRotationXYZ}
`,i+=`User Presence: ${this.userPresence}
`,i}}},3975:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeEventProvider=void 0;const a=i(7032),r=i(9504),h=i(3404);class _{constructor(c,s){(0,r.assert)(c!==void 0,`expected a valid eye gaze data streams object on initialization, given ${c}.`),this._eyeGazeDataStream=new h.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=c,this._eyeGazeDataStream.connect(s)}preventDefaultOnEvent(c,s){(0,r.bitInBitfield)(this._preventDefaultMask,c)&&s.preventDefault()}allowDefault(...c){for(const s of c)(0,r.bitInBitfield)(this._preventDefaultMask,s)&&(this._preventDefaultMask&=~s)}preventDefault(...c){for(const s of c)(0,r.bitInBitfield)(this._preventDefaultMask,s)||(this._preventDefaultMask|=s)}observable(c){switch(c){case _.Type.EyeGazeData:return this.EyeGazeData$;case _.Type.NewServerMessage:return this.NewServerMessage$;case _.Type.ConnectionStatus:return this.ConnectionStatus$;case _.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return this._eyeGazeDataSubject===void 0&&(this._eyeGazeDataSubject=new a.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=c=>{this.preventDefaultOnEvent(_.Type.EyeGazeData,c),this._eyeGazeDataSubject.next(c)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return this._newServerMessageSubject===void 0&&(this._newServerMessageSubject=new a.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=c=>{this.preventDefaultOnEvent(_.Type.NewServerMessage,c),this._newServerMessageSubject.next(c)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return this._connectionStatusSubject===void 0&&(this._connectionStatusSubject=new a.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=c=>{this.preventDefaultOnEvent(_.Type.ConnectionStatus,c),this._connectionStatusSubject.next(c)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return this._binaryMessageParsingErrorSubject===void 0&&(this._binaryMessageParsingErrorSubject=new a.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=c=>{this.preventDefaultOnEvent(_.Type.BinaryMessageParsingError,c),this._binaryMessageParsingErrorSubject.next(c)},this._eyeGazeDataStream.addEventListener(h.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}t.EyeGazeEventProvider=_,function(d){(function(c){c[c.EyeGazeData=1]="EyeGazeData",c[c.NewServerMessage=2]="NewServerMessage",c[c.ConnectionStatus=4]="ConnectionStatus",c[c.BinaryMessageParsingError=8]="BinaryMessageParsingError"})(d.Type||(d.Type={}))}(_||(t.EyeGazeEventProvider=_={}))},64:(p,t,i)=>{const a=i(1407);var r;(function(h){const _=(d,c)=>`fetching '${d}' failed (${c.status}): ${c.statusText}`;h.fetchAsync=function(d,c){return new Promise((s,o)=>{const l=new XMLHttpRequest;l.open("GET",d,!0),l.responseType=c,l.onload=()=>{l.status<200||l.status>=300?o(_(d,l)):s(l.response)},l.onerror=()=>o(_(d,l)),l.ontimeout=()=>o(_(d,l)),l.send()})},h.fetchJsonAsync=function(d,c,s){return new Promise((o,l)=>{const m=new XMLHttpRequest;m.open("GET",d,!0),m.onload=()=>{if(m.status<200||m.status>=300)return void l(_(d,m));const v=m.responseText;if(s!==void 0&&!(0,a.validate)(v,s))return;let f;try{f=JSON.parse(v)}catch(x){return void l(`fetching '${d}' failed (${x.name}): ${x.message}`)}const b=c(f);b!==void 0?o(b):l(`fetching '${d}' failed (TransformError): transforming the object failed.`)},m.onerror=()=>l(_(d,m)),m.ontimeout=()=>l(_(d,m)),m.send()})}})(r||(r={})),p.exports=r},4850:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPersonModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._rotation=a.mat4.create(),this._sensitivity=_.DEFAULT_SENSITIVITY}initiate(c){Object.assign(this._reference,this._camera),this._initialPoint=c}process(c,s){this._currentPoint=c;const o=a.vec2.create();s===void 0?a.vec2.subtract(o,this._initialPoint,this._currentPoint):a.vec2.copy(o,s),a.vec2.scale(o,o,window.devicePixelRatio*this._sensitivity),a.vec2.copy(this._initialPoint,this._currentPoint);const l=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(l,l);const m=a.vec3.cross((0,r.v3)(),l,this._reference.up),v=a.mat4.fromRotation((0,r.m4)(),-o[0],this._reference.up),f=a.mat4.fromRotation((0,r.m4)(),o[1],m);a.mat4.mul(this._rotation,f,v),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._reference.eye);a.mat4.multiply(c,c,this._rotation),a.mat4.translate(c,c,a.vec3.negate((0,r.v3)(),this._reference.eye));const s=a.vec3.transformMat4((0,r.v3)(),this._reference.center,c);this._camera.center=s,Object.assign(this._reference,this._camera)}set sensitivity(c){this._sensitivity=c}get sensitivity(){return this._sensitivity}}t.FirstPersonModifier=_,_.DEFAULT_SENSITIVITY=8e-4},3513:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.byteSizeOfFormat=function(_,d){const c=_.gl;if(d===void 0)return(0,a.assert)(!1,"expected given format to be defined"),0;if(function(o,l){const m=o.gl,v=o.gl2facade;if(l===void 0)return!1;if(r===void 0){const f=o.supportsDepthTexture?o.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;r=new Array(m.UNSIGNED_BYTE,m.UNSIGNED_SHORT_5_6_5,m.UNSIGNED_SHORT_4_4_4_4,m.UNSIGNED_SHORT_5_5_5_1,m.UNSIGNED_SHORT,m.UNSIGNED_INT,f,m.FLOAT,v.HALF_FLOAT,m.BYTE,m.SHORT,m.INT,m.HALF_FLOAT,m.UNSIGNED_INT_2_10_10_10_REV,m.UNSIGNED_INT_10F_11F_11F_REV,m.UNSIGNED_INT_5_9_9_9_REV,m.UNSIGNED_INT_24_8,m.FLOAT_32_UNSIGNED_INT_24_8_REV)}return r.indexOf(l)>-1}(_,d))return(0,a.assert)(!1,`expected format instead of type ${d}`),0;if(d===c.DEPTH_COMPONENT||d===c.DEPTH_STENCIL)return(0,a.assert)(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const s=function(o){if(h.has(o))return h.get(o);const l=o.gl,m=new Map([[l.ALPHA,1],[l.LUMINANCE,1],[l.R8,1],[l.R8I,1],[l.R8UI,1],[l.STENCIL_INDEX8,1],[l.DEPTH_COMPONENT16,2],[l.LUMINANCE_ALPHA,2],[l.R16F,2],[l.R16I,2],[l.R16UI,2],[l.RG8,2],[l.RG8I,2],[l.RG8UI,2],[l.RGB565,2],[l.RGB5_A1,2],[l.RGBA4,2],[l.DEPTH_COMPONENT24,3],[l.RGB,3],[l.RGB8,3],[l.RGB8UI,3],[l.SRGB,3],[l.SRGB8,3],[l.DEPTH24_STENCIL8,4],[l.DEPTH_COMPONENT32F,4],[l.R11F_G11F_B10F,4],[l.R32F,4],[l.R32I,4],[l.R32UI,4],[l.RG16F,4],[l.RG16I,4],[l.RG16UI,4],[l.RGB10_A2,4],[l.RGB10_A2UI,4],[l.RGB9_E5,4],[l.RGBA,4],[l.RGBA8,4],[l.RGBA8I,4],[l.RGBA8UI,4],[l.SRGB8_ALPHA8,4],[l.SRGB_ALPHA,4],[l.SRGB_ALPHA8,4],[l.SRGB_APLHA8,4],[l.DEPTH32F_STENCIL8,5],[l.RGB16F,6],[l.RG32F,8],[l.RG32I,8],[l.RG32UI,8],[l.RGBA16F,8],[l.RGBA16I,8],[l.RGBA16UI,8],[l.RGB32F,12],[l.RGBA32F,16],[l.RGBA32I,16],[l.RGBA32UI,16]]);return o.isWebGL1&&o.supportsSRGB&&(m.set(o.sRGB.SRGB_EXT,3),m.set(o.sRGB.SRGB_ALPHA_EXT,4),m.set(o.sRGB.SRGB8_ALPHA8_EXT,4)),o.supportsColorBufferFloat&&(m.set(o.colorBufferFloat.RGB32F_EXT,12),m.set(o.colorBufferFloat.RGBA32F_EXT,16)),h.set(o,m),m}(_).get(d);return(0,a.assert)(s!==void 0,`size of format ${d} is unknown`),s||0};const a=i(9504);let r;const h=new Map},8215:function(p,t,i){var a=this&&this.__decorate||function(o,l,m,v){var f,b=arguments.length,x=b<3?l:v===null?v=Object.getOwnPropertyDescriptor(l,m):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,l,m,v);else for(var E=o.length-1;E>=0;E--)(f=o[E])&&(x=(b<3?f(x):b>3?f(l,m,x):f(l,m))||x);return b>3&&x&&Object.defineProperty(l,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.Framebuffer=void 0;const r=i(9504),h=i(4127),_=i(9965),d=i(8400),c=i(8593);class s extends _.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(l,m){const v=l.gl;switch(m){case v.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case v.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case v.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return(0,r.assert)(!1,`expected known framebuffer status, given ${m}`),""}}create(l){const m=this._context.gl,v=this.context.gl2facade;this._object=m.createFramebuffer(),this._clearColors=new Array(v.COLOR_ATTACHMENT_MAX-v.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const b of l){const x=b[0],E=b[1];if(E instanceof d.Renderbuffer?this._buffersByAttachment.set(x,E):E instanceof c.Texture2D&&this._texturesByAttachment.set(x,E),x<v.COLOR_ATTACHMENT_MIN||x>v.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(x);const O=x-m.COLOR_ATTACHMENT0;this._colorClearQueue.push(O),this._clearColors[O]=[0,0,0,0]}this._drawBuffersChanged=!0,m.bindFramebuffer(m.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach((b,x)=>{m.framebufferRenderbuffer(m.FRAMEBUFFER,x,m.RENDERBUFFER,b.object)}),this._texturesByAttachment.forEach((b,x)=>{m.framebufferTexture2D(m.FRAMEBUFFER,x,m.TEXTURE_2D,b.object,0)});const f=m.checkFramebufferStatus(m.FRAMEBUFFER);return this._valid=m.isFramebuffer(this._object)&&f===m.FRAMEBUFFER_COMPLETE,(0,r.logIf)(!this._valid,r.LogLevel.Warning,s.statusString(this.context,f)),v.drawBuffers&&v.drawBuffers(this._drawBuffers),m.bindFramebuffer(m.FRAMEBUFFER,s.DEFAULT_FRAMEBUFFER),this._object}delete(){(0,r.assert)(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(l,m=!0,v=!0){const f=this.context.gl,b=(0,r.bitInBitfield)(l,f.DEPTH_BUFFER_BIT),x=(0,r.bitInBitfield)(l,f.STENCIL_BUFFER_BIT),E=(0,r.bitInBitfield)(l,f.COLOR_BUFFER_BIT);if(E||b||x){if(m&&this.bind(),E&&this._clearColors[0]!==void 0){const O=this._clearColors[0];f.clearColor(O[0],O[1],O[2],O[3])}b&&this._clearDepth!==void 0&&f.clearDepth(this._clearDepth),x&&this._clearStencil!==void 0&&f.clearStencil(this._clearStencil),f.clear(l),v&&this.unbind()}}es3Clear(l,m=!0,v=!0,f){const b=this.context.gl,x=(0,r.bitInBitfield)(l,b.DEPTH_BUFFER_BIT),E=(0,r.bitInBitfield)(l,b.STENCIL_BUFFER_BIT),O=(0,r.bitInBitfield)(l,b.COLOR_BUFFER_BIT);if(O||x||E){if(m&&this.bind(),O){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const S=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];b.clearColor(S[0],S[1],S[2],S[3]),b.clear(b.COLOR_BUFFER_BIT)}for(const S of f||this._colorClearQueue)b.clearBufferfv(b.COLOR,S,this._clearColors[S])}x&&E?(b.clearStencil(this._clearStencil),b.clearDepth(this._clearDepth),b.clear(b.STENCIL_BUFFER_BIT|b.DEPTH_BUFFER_BIT)):x?b.clearBufferfv(b.DEPTH,0,[this._clearDepth]):E&&(b.clearStencil(this._clearStencil),b.clear(b.STENCIL_BUFFER_BIT)),v&&this.unbind()}}hasAttachment(l){return this._texturesByAttachment.has(l)||this._buffersByAttachment.has(l)}bind(l=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(l,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(l=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(l,s.DEFAULT_FRAMEBUFFER)}clearColor(l,m){(0,r.assert)(m===void 0||m===0||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const v=l[3]<1&&!this.context.alpha;(0,r.logIf)(v,r.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const f=[l[0],l[1],l[2],v?1:l[3]];if(this.context.premultipliedAlpha&&!v&&(f[0]*=f[3],f[1]*=f[3],f[2]*=f[3]),m!==void 0)this._clearColors[m]=f;else for(let b=0;b<this._clearColors.length;++b)this._clearColors[b]=f}clearDepth(l){this._clearDepth=l}clearStencil(l){this._clearStencil=l}texture(l){return this._texturesByAttachment.get(l)}resize(l,m,v=!0,f=!0){this._buffersByAttachment.forEach(b=>{b.resize(l,m,v,f)}),this._texturesByAttachment.forEach(b=>{b.resize(l,m,v,f)})}get width(){this.assertInitialized();let l=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(l)||m.width<l)&&(l=m.width)}),this._texturesByAttachment.forEach(m=>{(isNaN(l)||m.width<l)&&(l=m.width)}),l}get height(){this.assertInitialized();let l=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(l)||m.height<l)&&(l=m.height)}),this._texturesByAttachment.forEach(m=>{(isNaN(l)||m.height<l)&&(l=m.height)}),l}get size(){return[this.width,this.height]}set drawBuffers(l){this.assertInitialized();const m=this.context.gl2facade;for(const v of l)(0,r.assert)(this.hasAttachment(v),`valid attachment expected for draw buffer, given ${v}`),(0,r.assert)(v>=m.COLOR_ATTACHMENT_MIN&&v<=m.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${v}`),this._drawBuffersChanged=this._drawBuffersChanged||this._drawBuffers.indexOf(v)===-1;this._drawBuffersChanged=this._drawBuffersChanged||l.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=l)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}t.Framebuffer=s,s.DEFAULT_FRAMEBUFFER=void 0,a([h.Initializable.assert_initialized()],s.prototype,"es2Clear",null),a([h.Initializable.assert_initialized()],s.prototype,"es3Clear",null),a([h.Initializable.assert_initialized()],s.prototype,"bind",null),a([h.Initializable.assert_initialized()],s.prototype,"unbind",null),a([h.Initializable.assert_initialized()],s.prototype,"clearColor",null),a([h.Initializable.assert_initialized()],s.prototype,"clearDepth",null),a([h.Initializable.assert_initialized()],s.prototype,"clearStencil",null),a([h.Initializable.assert_initialized()],s.prototype,"texture",null),a([h.Initializable.assert_initialized()],s.prototype,"resize",null)},1215:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FrameCapture=void 0;const a=i(9504),r=i(8215),h=i(8386);class _{static createDataURL(c,s,o){const l=document.createElement("canvas"),m=l.getContext("2d");return l.width=c.width,l.height=c.height,m.putImageData(c,0,0),l.toDataURL(s,o)}static captureDefaultFramebuffer(c,s,o){const l=c.context.gl;c.bind(),l.readPixels(s.x,s.y,s.width,s.height,l.RGBA,l.UNSIGNED_BYTE,o),c.unbind()}static captureFramebuffer(c,s,o,l){const m=c.context.gl,v=c.texture(s);if((0,a.assert)(v!==void 0,`Framebuffer does not have given attachment ${s}.`),(0,a.assert)(v.format===m.RGBA,`Unsupported texture format ${v.format}.`),(0,a.assert)(v.type===m.UNSIGNED_BYTE||v.type===m.FLOAT||v.type===m.HALF_FLOAT,`Unsupported texture type ${v.type}.`),m.readBuffer(s),v.type===m.FLOAT||v.type===m.HALF_FLOAT){const f=new Float32Array(o.width*o.height*4);m.readPixels(o.x,o.y,o.width,o.height,m.RGBA,m.FLOAT,f),f.forEach((b,x)=>{l[x]=255*b})}else v.type===m.UNSIGNED_BYTE&&m.readPixels(o.x,o.y,o.width,o.height,m.RGBA,m.UNSIGNED_BYTE,l)}static flipImageDataVertically(c){const s=c.height,o=c.data.length/s,l=Math.floor(s/2);for(let m=0;m<l;++m){const v=c.data.slice(m*o,(m+1)*o);c.data.copyWithin(m*o,(s-m-1)*o,(s-m)*o),c.data.set(v,(s-m-1)*o)}}static capture(c,s,o){const l=c.context.gl,m=c.size;o===void 0&&(o={x:0,y:0,width:m[0],height:m[1]}),s===void 0&&(s=l.COLOR_ATTACHMENT0);const v=new ImageData(o.width,o.height),f=new Uint8Array(v.data.buffer);return c.bind(l.READ_FRAMEBUFFER),c instanceof h.DefaultFramebuffer?_.captureDefaultFramebuffer(c,o,f):c instanceof r.Framebuffer&&_.captureFramebuffer(c,s,o,f),c.unbind(l.READ_FRAMEBUFFER),_.flipImageDataVertically(v),v}}t.FrameCapture=_},3395:function(p,t,i){var a=this&&this.__decorate||function(m,v,f,b){var x,E=arguments.length,O=E<3?v:b===null?b=Object.getOwnPropertyDescriptor(v,f):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(m,v,f,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(O=(E<3?x(O):E>3?x(v,f,O):x(v,f))||O);return E>3&&O&&Object.defineProperty(v,f,O),O};Object.defineProperty(t,"__esModule",{value:!0}),t.GaussFilter=void 0;const r=i(3557),h=i(9504),_=i(5150),d=i(4127),c=i(1896),s=i(4168),o=i(771);class l extends d.Initializable{constructor(v){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=v}recalculateWeights(){if(this._weights)return!1;const v=1/Math.sqrt(2*Math.PI)*this._standardDeviation,f=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let b=0;for(let x=0;x<=Math.floor(this._kernelSize/2);x++)this._weights[x]=v*Math.pow(Math.E,-Math.pow(x,2)/f),b+=x>0?2*this._weights[x]:this._weights[x];if(this._redistribute){const x=1-b;for(let E=0;E<=Math.floor(this._kernelSize/2);E++)this._weights[E]+=this._weights[E]/b*x}return!0}get kernelSize(){return this._kernelSize}set kernelSize(v){(0,h.assert)(v>0,"Kernel size has to be positive."),(0,h.assert)(v<=2*(l._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(l._MAXKERNELSIZEHALF-1)+2)+"."),(0,h.assert)(Number.isInteger(v),"Kernel size has to be an integer."),(0,h.assert)(v%2==1,"Kernel size has to be odd."),this._kernelSize=v,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(v){(0,h.assert)(v>0,"Standard deviation has to be positive."),this._standardDeviation=v,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(v){this._redistribute=v,this._weights=void 0}initialize(v){const f=this._context.gl,b=new o.Shader(this._context,f.VERTEX_SHADER,"gauss.vert");b.initialize(i(9214)),this._fragmentShader=new o.Shader(this._context,f.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(i(1687)),this._program=new s.Program(this._context),this._program.initialize([b,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const x=this._program.attribute("a_vertex",0);return v===void 0?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=v,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(x),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(v,f){const b=this._context.gl,x=[r.vec2.fromValues(1,0),r.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),b.uniform1fv(this._uWeights,this._weights)),this._program.bind(),v.bind(b.TEXTURE0),b.uniform2fv(this._uDelta,r.vec2.divide((0,_.v2)(),x[f],v.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),v.unbind(b.TEXTURE0),this._program.unbind()}}t.GaussFilter=l,l._MAXKERNELSIZEHALF=32,a([d.Initializable.initialize()],l.prototype,"initialize",null),a([d.Initializable.uninitialize()],l.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],l.prototype,"filter",null),function(m){(function(v){v[v.Horizontal=0]="Horizontal",v[v.Vertical=1]="Vertical"})(m.Direction||(m.Direction={}))}(l||(t.GaussFilter=l={}))},638:function(p,t,i){var a=this&&this.__decorate||function(d,c,s,o){var l,m=arguments.length,v=m<3?c:o===null?o=Object.getOwnPropertyDescriptor(c,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,c,s,o);else for(var f=d.length-1;f>=0;f--)(l=d[f])&&(v=(m<3?l(v):m>3?l(c,s,v):l(c,s))||v);return m>3&&v&&Object.defineProperty(c,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.Geometry=void 0;const r=i(4127),h=i(5507);class _ extends r.Initializable{constructor(c,s){super(),this._buffers=new Array,s=s!==void 0&&s!==""?s:this.constructor.name,this._vertexArray=new h.VertexArray(c,`${s}VAO`)}initialize(...c){const s=c[0],o=c[1];let l=!0;for(let m=0;m<this._buffers.length;++m)l=this._buffers[m].initialize(s[m])&&l;return this._vertexArray.initialize(()=>this.bindBuffers(o),()=>this.unbindBuffers(o)),this._vertexArray.valid&&l}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach(c=>c.uninitialize())}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}t.Geometry=_,a([r.Initializable.initialize()],_.prototype,"initialize",null),a([r.Initializable.uninitialize()],_.prototype,"uninitialize",null),a([r.Initializable.assert_initialized()],_.prototype,"bind",null),a([r.Initializable.assert_initialized()],_.prototype,"unbind",null)},5150:(p,t,i)=>{const a=i(3557);var r;(function(h){function _(c){return c>0?c-Math.floor(c):c-Math.ceil(c)}h.sign=function(c){return c>0?1:c<0?-1:0},h.clamp=function(c,s,o){return Math.max(s,Math.min(o,c))},h.fract=_,h.v2=function(){return a.vec2.create()},h.clamp2=function(c,s,o,l){return c[0]=Math.max(o[0],Math.min(l[0],s[0])),c[1]=Math.max(o[1],Math.min(l[1],s[1])),c},h.abs2=function(c,s){return c[0]=Math.abs(s[0]),c[1]=Math.abs(s[1]),c},h.v3=function(){return a.vec3.create()},h.clamp3=function(c,s,o,l){return c[0]=Math.max(o[0],Math.min(l[0],s[0])),c[1]=Math.max(o[1],Math.min(l[1],s[1])),c[2]=Math.max(o[2],Math.min(l[2],s[2])),c},h.abs3=function(c,s){return c[0]=Math.abs(s[0]),c[1]=Math.abs(s[1]),c[2]=Math.abs(s[2]),c};const d=1/256;h.encode_float24x1_to_uint8x3=function(c,s){return c[0]=Math.floor(256*s),c[1]=Math.floor(256*_(256*s)),c[2]=Math.floor(256*_(65536*s)),c},h.decode_float24x1_from_uint8x3=function(c){return(c[0]+(c[1]+c[2]*d)*d)*d},h.encode_uint24_to_rgb8=function(c,s){return c[0]=s>>>0&255,c[1]=s>>>8&255,c[2]=s>>>16&255,c},h.encode_uint32_to_rgba8=function(c,s){return c[0]=s>>>0&255,c[1]=s>>>8&255,c[2]=s>>>16&255,c[3]=s>>>24&255,c},h.decode_uint24_from_rgb8=function(c){return c[0]+(c[1]<<8)+(c[2]<<16)},h.decode_uint32_from_rgba8=function(c){return c[0]+(c[1]<<8)+(c[2]<<16)+(c[3]<<24)>>>0},h.fromVec4=function(c){return c[3]===0?a.vec3.fromValues(c[0],c[1],c[2]):a.vec3.fromValues(c[0]/c[3],c[1]/c[3],c[2]/c[3])},h.v4=function(){return a.vec4.create()},h.clamp4=function(c,s,o,l){return c[0]=Math.max(o[0],Math.min(l[0],s[0])),c[1]=Math.max(o[1],Math.min(l[1],s[1])),c[2]=Math.max(o[2],Math.min(l[2],s[2])),c[3]=Math.max(o[3],Math.min(l[3],s[3])),c},h.abs4=function(c,s){return c[0]=Math.abs(s[0]),c[1]=Math.abs(s[1]),c[2]=Math.abs(s[2]),c[3]=Math.abs(s[3]),c},h.fromVec3=function(c){return a.vec4.fromValues(c[0],c[1],c[2],1)},h.parseVec2=function(c){if(c===void 0||c==="")return;let s=[];try{s=JSON.parse(`[${c}]`)}catch{return}return s.length!==2||isNaN(s[0])||isNaN(s[1])?void 0:a.vec2.clone(s)},h.parseVec3=function(c){if(c===void 0||c==="")return;let s=[];try{s=JSON.parse(`[${c}]`)}catch{return}return s.length!==3||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?void 0:a.vec3.clone(s)},h.parseVec4=function(c){if(c===void 0||c==="")return;let s=[];try{s=JSON.parse(`[${c}]`)}catch{return}return s.length!==4||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?void 0:a.vec4.clone(s)},h.mix=function(c,s,o){return c*(1-o)+s*o},h.m2=function(){return a.mat2.create()},h.m3=function(){return a.mat3.create()},h.m4=function(){return a.mat4.create()}})(r||(r={})),p.exports=r},829:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GL2Facade=void 0;const a=i(9504),r=i(2527);t.GL2Facade=class{constructor(h){this.drawBuffers=void 0,(0,a.assert)(h!==void 0,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(h),this.queryColorAttachments(h),this.queryInstancedArraySupport(h),this.queryDrawBuffersSupport(h),this.queryVertexArrayObjectSupport(h),this.queryMaxUniformVec3Components(h),this.queryBufferSubDataInterface(h),this.queryTexImageInterface(h)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(h){switch(h.backend){case r.Context.BackendType.WebGL1:this._halfFloat=h.supportsTextureHalfFloat&&h.textureHalfFloat?h.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case r.Context.BackendType.WebGL2:default:this._halfFloat=h.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(h){const _=h.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=_.COLOR_ATTACHMENT0,h.backend){case r.Context.BackendType.WebGL1:const d=h.supportsDrawBuffers?h.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(d?_.getParameter(d.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=d?d.COLOR_ATTACHMENT0_WEBGL:_.COLOR_ATTACHMENT0,!d)break;for(let c=1;c<16;++c)this._colorAttachments[c]=d.COLOR_ATTACHMENT0_WEBGL+c;break;case r.Context.BackendType.WebGL2:default:this._colorAttachmentMin=h.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=h.gl.COLOR_ATTACHMENT0+_.getParameter(_.MAX_COLOR_ATTACHMENTS);for(let c=0;c<16;++c)this._colorAttachments[c]=_.COLOR_ATTACHMENT0+c}}queryInstancedArraySupport(h){(h.isWebGL2||h.supportsInstancedArrays)&&(this.drawArraysInstanced=h.isWebGL2?(_,d,c,s)=>h.gl.drawArraysInstanced(_,d,c,s):(_,d,c,s)=>h.instancedArrays.drawArraysInstancedANGLE(_,d,c,s),this.drawElementsInstanced=h.isWebGL2?(_,d,c,s,o)=>h.gl.drawElementsInstanced(_,d,c,s,o):(_,d,c,s,o)=>h.instancedArrays.drawElementsInstancedANGLE(_,d,c,s,o),this.vertexAttribDivisor=h.isWebGL2?(_,d)=>h.gl.vertexAttribDivisor(_,d):(_,d)=>h.instancedArrays.vertexAttribDivisorANGLE(_,d))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(h){(h.isWebGL2||h.supportsDrawBuffers)&&(this.drawBuffers=h.isWebGL2?_=>h.gl.drawBuffers(_):_=>h.drawBuffers.drawBuffersWEBGL(_),this._maxDrawBuffers=h.isWebGL2?h.gl.MAX_DRAW_BUFFERS:h.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(h){(h.isWebGL2||h.supportsVertexArrayObject)&&(this.createVertexArray=h.isWebGL2?()=>h.gl.createVertexArray():()=>h.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=h.isWebGL2?_=>h.gl.deleteVertexArray(_):_=>h.vertexArrayObject.deleteVertexArrayOES(_),this.isVertexArray=h.isWebGL2?_=>h.gl.isVertexArray(_):_=>h.vertexArrayObject.isVertexArrayOES(_),this.bindVertexArray=h.isWebGL2?_=>h.gl.bindVertexArray(_):_=>h.vertexArrayObject.bindVertexArrayOES(_))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(h){const _=h.gl;this._maxUniformVec3Components=h.isWebGL2?_.getParameter(_.MAX_VERTEX_UNIFORM_COMPONENTS):3*_.getParameter(_.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(h){const _=h.gl;h.isWebGL2?this.bufferSubData=(d,c,s,o,l=0)=>_.bufferSubData(d,c,s,o,l):this.bufferSubData=(d,c,s,o=0,l=0)=>((0,a.logIf)(o!==0,a.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),(0,a.logIf)(l!==0,a.LogLevel.Warning,"length ignored (not supported in WebGL)"),_.bufferSubData(d,c,s))}queryTexImageInterface(h){const _=h.gl;h.isWebGL2?this.texImage2D=(d,c,s,o,l,m,v,f,b,x)=>b instanceof ArrayBuffer?_.texImage2D(d,c,s,o,l,m,v,f,b===void 0?null:b,x):((0,a.assert)(x===void 0,"offset expected to be undefined for non ArrayBuffer source"),_.texImage2D(d,c,s,o,l,m,v,f,b===void 0?null:b)):this.texImage2D=(d,c,s,o,l,m,v,f,b,x)=>b===void 0?_.texImage2D(d,c,s,o,l,m,v,f,null):b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array||b instanceof DataView?_.texImage2D(d,c,s,o,l,m,v,f,b):_.texImage2D(d,c,s,v,f,b),h.supportsTexImage3D?this.texImage3D=(d,c,s,o,l,m,v,f,b,x,E)=>x instanceof ArrayBuffer?_.texImage3D(d,c,s,o,l,m,v,f,b,x===void 0?null:x,E):((0,a.assert)(E===void 0,"offset expected to be undefined for non ArrayBuffer source"),_.texImage3D(d,c,s,o,l,m,v,f,b,x===void 0?null:x)):this.texImage3D=(d,c,s,o,l,m,v,f,b,x,E)=>(0,a.assert)(!1,"texImage3D not supported on this context")}}},6119:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFHelper=void 0;const a=i(9504);t.GLTFHelper=class{static modeToEnum(r,h){return(h<0||h>6)&&(0,a.log)(a.LogLevel.Error,`Specified draw mode is ${h} but is required to be between 0 and 6`),h===0?r.POINTS:h===1?r.LINES:h===2?r.LINE_LOOP:h===3?r.LINE_STRIP:h===4?r.TRIANGLES:h===5?r.TRIANGLE_STRIP:h===6?r.TRIANGLE_FAN:r.TRIANGLES}static nameToAttributeIndex(r){return r==="POSITION"?0:r==="NORMAL"?1:r==="TANGENT"?2:r==="TEXCOORD_0"?3:r==="TEXCOORD_1"?4:r==="TEXCOORD_2"?5:r==="JOINTS_0"?6:r==="WEIGHTS_0"?7:r==="COLOR_0"?8:((0,a.log)(a.LogLevel.Warning,`Unknown attribute name '${r}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},2604:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFLoader=void 0;const a=i(3557),r=i(9504),h=i(4613),_=i(6119),d=i(122),c=i(9806),s=i(2078),o=i(7340),l=i(1854),m=i(4168),v=i(5315),f=i(651),b=i(771),x=i(8593);t.GLTFLoader=class{constructor(E){this._context=E;const O=this._context.gl;this._resourceManager=new l.ResourceManager(this._context),this._scenes=new Array;const S=new b.Shader(this._context,O.VERTEX_SHADER,"gltf_default.vert");S.initialize(i(6626));const w=new b.Shader(this._context,O.FRAGMENT_SHADER,"gltf_default.frag");w.initialize(i(5347)),this._pbrProgram=new m.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([S,w])}async loadTextures(E){const O=this._context.gl;this._uriTextureMap=new Map;const S=E.gltf.textures,w=E.gltf.images,P=E.gltf.samplers;if(!S||!w)return;let N=0;for(const k of S){if(k.source===void 0){(0,r.log)(r.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),N++;continue}const j=k.source,U=w[j],H=this._sceneName+"_texture_"+N,Z=U.name===void 0?U.uri:U.name;let K=await E.imageData.get(j);if(!(0,r.isPowerOfTwo)(K.width)||!(0,r.isPowerOfTwo)(K.height)){const J=document.createElement("canvas");J.width=(0,r.upperPowerOfTwo)(K.width),J.height=(0,r.upperPowerOfTwo)(K.height);const ne=J.getContext("2d");ne===void 0&&(0,r.log)(r.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),ne.drawImage(K,0,0,J.width,J.height),K=J}const ee=new x.Texture2D(this._context,Z);if(ee.initialize(K.width,K.height,O.RGBA8,O.RGBA,O.UNSIGNED_BYTE),ee.data(K),P===void 0||k.sampler===void 0)ee.wrap(O.REPEAT,O.REPEAT),ee.filter(O.LINEAR,O.LINEAR);else{const J=P[k.sampler];ee.wrap(J.wrapS||O.REPEAT,J.wrapT||O.REPEAT),ee.filter(J.magFilter||O.LINEAR,J.minFilter||O.LINEAR),J.minFilter!==O.NEAREST_MIPMAP_NEAREST&&J.minFilter!==O.LINEAR_MIPMAP_NEAREST&&J.minFilter!==O.NEAREST_MIPMAP_LINEAR&&J.minFilter!==O.LINEAR_MIPMAP_LINEAR||ee.generateMipMap()}this._resourceManager.add(ee,[Z,H]);const re=U.uri?U.uri:H;this._uriTextureMap.set(re,ee),N++}}getTexture(E){const O=this._sceneName+"_texture_"+E,S=this._resourceManager.get(O);if(S!==void 0)return S;(0,r.log)(r.LogLevel.Warning,`Texture with index ${E} could not be located.`)}async loadMaterials(E){this._pbrDefaultMaterial=new c.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const O=E.gltf.materials;if(!O)return;let S=0;for(const w of O){const P=this._sceneName+"_material_"+S,N=new c.GLTFPbrMaterial(this._context,w.name),k=w.normalTexture;k!==void 0&&(N.normalTexture=this.getTexture(k.index),N.normalTexCoord=k.texCoord||0,N.normalScale=k.scale||1);const j=w.occlusionTexture;j!==void 0&&(N.occlusionTexture=this.getTexture(j.index),N.occlusionTexCoord=j.texCoord||0);const U=w.emissiveTexture;U!==void 0&&(N.emissiveTexture=this.getTexture(U.index),N.emissiveTexCoord=U.texCoord||0),N.emissiveFactor=a.vec3.fromValues(0,0,0),w.emissiveFactor!==void 0&&(N.emissiveFactor=a.vec3.fromValues.apply(void 0,w.emissiveFactor)),N.alphaMode=c.GLTFAlphaMode.OPAQUE,w.alphaMode==="MASK"?(N.alphaMode=c.GLTFAlphaMode.MASK,w.alphaCutoff===void 0?N.alphaCutoff=.5:N.alphaCutoff=w.alphaCutoff):w.alphaMode==="BLEND"&&(N.alphaMode=c.GLTFAlphaMode.BLEND,N.isTransparent=!0),N.isDoubleSided=w.doubleSided||!1;const H=w.pbrMetallicRoughness;H===void 0&&(0,r.log)(r.LogLevel.Warning,"Model contains a material without PBR information");const Z=H.baseColorTexture;Z!==void 0&&(N.baseColorTexture=this.getTexture(Z.index),N.baseColorTexCoord=Z.texCoord||0);const K=H.metallicRoughnessTexture;K!==void 0&&(N.metallicRoughnessTexture=this.getTexture(K.index),N.metallicRoughnessTexCoord=K.texCoord||0),N.baseColorFactor=a.vec4.fromValues(1,1,1,1),H.baseColorFactor!==void 0&&(N.baseColorFactor=a.vec4.fromValues.apply(void 0,H.baseColorFactor)),N.metallicFactor=1,H.metallicFactor!==void 0&&(N.metallicFactor=H.metallicFactor),N.roughnessFactor=1,H.roughnessFactor!==void 0&&(N.roughnessFactor=H.roughnessFactor),this._resourceManager.add(N,[w.name,P]),S++}}inferBufferUsage(E,O){const S=this._context.gl,w=E.gltf.meshes,P=E.gltf.accessors;if(w===void 0||P===void 0)return(0,r.log)(r.LogLevel.Error,"Asset does not include any meshes or accessors"),S.ARRAY_BUFFER;for(const N of w)for(const k of N.primitives){const j=k.indices;if(j===void 0)continue;const U=P[j].bufferView;if(U!==void 0&&U===O)return S.ELEMENT_ARRAY_BUFFER}return S.ARRAY_BUFFER}async loadBuffers(E){const O=this._context.gl,S=E.gltf.bufferViews,w=E.gltf.accessors;if(!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any buffer view information.");if(!w)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any accessor information.");let P=0;for(const k of S){const j=this._sceneName+"_bufferView_"+P,U=await E.bufferViewData(P);let H=k.target;H===void 0&&(H=this.inferBufferUsage(E,P));const Z=new o.Buffer(this._context,j);Z.initialize(H),Z.data(U,O.STATIC_DRAW),this._resourceManager.add(Z,[j]),P++}let N=0;for(const k of w){const j=k.bufferView,U=k.sparse;if(j===void 0||U!==void 0){const H=this._sceneName+"_accessor_"+N,Z=new o.Buffer(this._context,H),K=await E.accessorData(N);Z.initialize(O.ARRAY_BUFFER),Z.data(K,O.STATIC_DRAW),this._resourceManager.add(Z,[H])}N++}}async loadMeshes(E){this._meshes=new Array,this._nameMeshMap=new Map;const O=E.gltf.meshes;if(O===void 0)return(0,r.log)(r.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let S=0;for(const w of O){const P=new d.GLTFMesh(w.name);for(const N of w.primitives){const k=await this.loadPrimitive(E,N,S);k!==void 0&&P.addPrimitive(k),S++}w.name&&this._nameMeshMap.set(w.name,P),this._meshes.push(P)}return this._meshes}async loadPrimitive(E,O,S){const w=this._context.gl,P=E.gltf.accessors,N=E.gltf.bufferViews;if(P===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any accessors.");if(N===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any buffer views.");let k=O.mode;const j=this._sceneName+"_primitive_"+S;k||(k=4);const U=_.GLTFHelper.modeToEnum(w,k),H=new Array;let Z=this._pbrDefaultMaterial;if(O.material!==void 0){const J=this._sceneName+"_material_"+O.material,ne=this._resourceManager.get(J);ne!==void 0?Z=ne:(0,r.log)(r.LogLevel.Warning,`Material ${J} could not be found.`)}let K,ee=0;for(const J in O.attributes){const ne=_.GLTFHelper.nameToAttributeIndex(J);J==="NORMAL"&&(ee|=c.GLTFShaderFlags.HAS_NORMALS),J==="TANGENT"&&(ee|=c.GLTFShaderFlags.HAS_TANGENTS),J==="COLOR_0"&&(ee|=c.GLTFShaderFlags.HAS_COLORS),J!=="TEXCOORD_0"&&J!=="TEXCOORD_1"&&J!=="TEXCOORD_2"||(ee|=c.GLTFShaderFlags.HAS_UV);const he=O.attributes[J],fe=P[he],be=fe.bufferView,Ae=fe.sparse;let Ce,oe=0;if(be===void 0||Ae!==void 0){const Be=this._sceneName+"_accessor_"+he;Ce=this._resourceManager.get(Be)}else{const Be=N[be],st=this._sceneName+"_bufferView_"+be;Ce=this._resourceManager.get(st),oe=Be.byteStride||0}const Re=new s.VertexBinding;Re.buffer=Ce,Re.attributeIndex=ne,Re.numVertices=fe.count,Re.normalized=fe.normalized||!1,Re.size=h.GLTF_ELEMENTS_PER_TYPE[fe.type],Re.offset=fe.byteOffset||0,Re.stride=oe,Re.type=fe.componentType,H.push(Re)}if(O.indices!==void 0){const J=P[O.indices],ne=J.bufferView;!ne===void 0&&(0,r.log)(r.LogLevel.Error,"Accessor does not reference a BufferView.");const he=this._sceneName+"_bufferView_"+ne,fe=this._resourceManager.get(he);K=new s.IndexBinding,K.buffer=fe,K.numIndices=J.count,K.offset=J.byteOffset||0,K.type=J.componentType}const re=new s.GLTFPrimitive(this._context,H,K,U,Z,ee);return re.initialize(),this._resourceManager.add(re,[j]),re}async generateScenes(E){const O=E.gltf.nodes,S=E.gltf.scenes;if(!O||!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const w=new Map;let P=0;for(const j of O){const U=j.name||"node_"+P,H=new f.SceneNode(U);if(w.set(P,H),j.matrix){const Z=a.mat4.fromValues.apply(void 0,j.matrix),K=new v.TransformComponent(Z);H.addComponent(K)}else if(j.translation||j.rotation||j.scale){let Z=a.quat.create();j.rotation&&(Z=a.quat.fromValues.apply(void 0,j.rotation));let K=a.vec3.create();j.translation&&(K=a.vec3.fromValues.apply(void 0,j.translation));let ee=a.vec3.fromValues(1,1,1);j.scale&&(ee=a.vec3.fromValues.apply(void 0,j.scale));const re=a.mat4.fromRotationTranslationScale(a.mat4.create(),Z,K,ee),J=new v.TransformComponent(re);H.addComponent(J)}if(j.mesh!==void 0){const Z=this._meshes[j.mesh];for(const K of Z.primitives){const ee=new v.GeometryComponent;ee.material=K.material,ee.geometry=K,H.addComponent(ee)}}(j.skin||j.weights)&&(0,r.log)(r.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),P++}P=0;for(const j of O){const U=w.get(P);if((0,r.assert)(U!==void 0,"Scene node could not be found."),j.children)for(const H of j.children){const Z=w.get(H);Z||(0,r.log)(r.LogLevel.Error,"Model references a node that does not exist."),U.addNode(Z)}P++}let N=0;for(const j of S){const U=j.name||"scene_"+N,H=new f.SceneNode(U);if(j.nodes)for(const Z of j.nodes){const K=w.get(Z);K||(0,r.log)(r.LogLevel.Error,"Scene references a node that does not exist."),H.addNode(K)}else(0,r.log)(r.LogLevel.Warning,`Scene ${U} does not contain any nodes.`);this._scenes.push(H),N++}const k=E.gltf.scene;k!==void 0&&(this._defaultScene=this._scenes[k])}async loadAsset(E){const O=new h.GltfLoader,S=await O.load(E),w=S.gltf;this._sceneName="scene",w.scenes&&w.scene&&w.scenes[w.scene].name&&(this._sceneName=w.scenes[w.scene].name),await this.loadTextures(S).then(()=>this.loadMaterials(S)).then(()=>this.loadBuffers(S)).then(()=>this.loadMeshes(S)).then(()=>this.generateScenes(S))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(E){return this._nameMeshMap.get(E)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return this._defaultScene!==void 0?this._defaultScene:this._scenes!==void 0&&this._scenes.length>0?this._scenes[0]:((0,r.log)(r.LogLevel.Warning,"Default scene was requested, but none is available."),new f.SceneNode("EmptyScene"))}}},122:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=void 0,t.GLTFMesh=class{constructor(i){this._name=i,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(i){this._primitives.push(i)}}},9806:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFShaderFlags=void 0;const a=i(3557),r=i(5315);var h,_;(function(c){c[c.HAS_NORMALS=1]="HAS_NORMALS",c[c.HAS_TANGENTS=2]="HAS_TANGENTS",c[c.HAS_UV=4]="HAS_UV",c[c.HAS_COLORS=8]="HAS_COLORS",c[c.USE_IBL=16]="USE_IBL",c[c.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",c[c.HAS_NORMALMAP=64]="HAS_NORMALMAP",c[c.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",c[c.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",c[c.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",c[c.USE_TEX_LOD=1024]="USE_TEX_LOD"})(h||(t.GLTFShaderFlags=h={})),function(c){c[c.OPAQUE=0]="OPAQUE",c[c.MASK=1]="MASK",c[c.BLEND=2]="BLEND"}(_||(t.GLTFAlphaMode=_={}));class d extends r.Material{constructor(s,o){super(s,o),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=_.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=a.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=a.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(s){this._baseColorTexture=s}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(s){this._metallicRoughnessTexture=s}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(s){this._normalTexture=s}get normalTexture(){return this._normalTexture}set occlusionTexture(s){this._occlusionTexture=s}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(s){this._emissiveTexture=s}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(s){this._emissiveFactor=s}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(s){this._baseColorFactor=s}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(s){this._metallicFactor=s}get metallicFactor(){return this._metallicFactor}set roughnessFactor(s){this._roughnessFactor=s}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(s){this._normalScale=s}set isDoubleSided(s){this._isDoubleSided=s}get isDoubleSided(){return this._isDoubleSided}set alphaMode(s){this._alphaMode=s}get alphaMode(){return this._alphaMode}set alphaCutoff(s){this._alphaCutoff=s}get alphaCutoff(){return this._alphaCutoff}get flags(){let s=0;return this.baseColorTexture!==void 0&&(s|=h.HAS_BASECOLORMAP),this.metallicRoughnessTexture!==void 0&&(s|=h.HAS_METALROUGHNESSMAP),this.normalTexture!==void 0&&(s|=h.HAS_NORMALMAP),this.occlusionTexture!==void 0&&(s|=h.HAS_OCCLUSIONMAP),this.emissiveTexture!==void 0&&(s|=h.HAS_EMISSIVEMAP),s}}t.GLTFPbrMaterial=d},2078:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPrimitive=t.VertexBinding=t.IndexBinding=void 0;const a=i(638),r=i(6119);t.IndexBinding=class{},t.VertexBinding=class{};class h extends a.Geometry{constructor(d,c,s,o,l,m,v){super(d,v),this._bindings=c,this._indexBinding=s,this._material=l,this._geometryFlags=m,this._drawMode=o}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const d of this._bindings)d.buffer.attribEnable(d.attributeIndex,d.size,d.type,d.normalized,d.stride,d.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const d of this._bindings)d.buffer.attribDisable(d.attributeIndex,!0,!0)}draw(){const d=this.context.gl;this._indexBinding?d.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):d.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(d){const c=r.GLTFHelper.nameToAttributeIndex(d);for(const s of this._bindings)if(s.attributeIndex===c)return s}}t.GLTFPrimitive=h},8892:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=t.GLTFPrimitive=t.GLTFShaderFlags=t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFLoader=void 0;var a=i(2604);Object.defineProperty(t,"GLTFLoader",{enumerable:!0,get:function(){return a.GLTFLoader}});var r=i(9806);Object.defineProperty(t,"GLTFAlphaMode",{enumerable:!0,get:function(){return r.GLTFAlphaMode}}),Object.defineProperty(t,"GLTFPbrMaterial",{enumerable:!0,get:function(){return r.GLTFPbrMaterial}}),Object.defineProperty(t,"GLTFShaderFlags",{enumerable:!0,get:function(){return r.GLTFShaderFlags}});var h=i(2078);Object.defineProperty(t,"GLTFPrimitive",{enumerable:!0,get:function(){return h.GLTFPrimitive}});var _=i(122);Object.defineProperty(t,"GLTFMesh",{enumerable:!0,get:function(){return _.GLTFMesh}})},4127:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Initializable=void 0;const a=i(9504);class r{constructor(){this._initialized=!1,this.assertInitialized=()=>r.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(_,d,c)=>{const s=c.value;return c.value=function(){return(0,a.assert)(this._initialized===!1,"re-initialization of initialized object not anticipated"),this._initialized=s.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>r.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)),this._initialized},c}}static uninitialize(){return(_,d,c)=>{const s=c.value;return c.value=function(){(0,a.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},c}}static discard(){return(_,d,c)=>{const s=c.value;return c.value=function(){(0,a.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},c}}static assert_initialized(){return(_,d,c)=>{const s=c.value;return c.value=function(){return this.assertInitialized(),s.apply(this,arguments)},c}}static assert_uninitialized(){return(_,d,c)=>{const s=c.value;return c.value=function(){this.assertUninitialized(),s.apply(this,arguments)},c}}get initialized(){return this._initialized}}t.Initializable=r,r.assertInitializedFalse=h=>(0,a.assert)(!1,`instance of ${h.constructor.name} expected to be initialized`),r.assertUninitializedFalse=h=>(0,a.assert)(!1,`instance of ${h.constructor.name} not expected to be initialized`)},4287:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KernelI8=t.KernelUI8=t.KernelI32=t.KernelUI32=t.KernelF32=t.AbstractKernel=void 0;const a=i(9504);class r{constructor(_,d,c=1,s=1){this._components=_,this._width=isNaN(d)?1:Math.max(1,d),this._height=Math.max(1,c),this._depth=Math.max(1,s),this.resize()}get(_,d,c){let s;switch(s=d===void 0&&c===void 0?this._components*_:this.index(_,d,c||0),(0,a.assert)(s<this.length,`index expected to be in range [0, ${this.length-1}], given ${s}`),this._components){case 1:return[this._samples[s]];case 2:return[this._samples[s],this._samples[s+1]];case 3:return[this._samples[s],this._samples[s+1],this._samples[s+2]];case 4:return[this._samples[s],this._samples[s+1],this._samples[s+2],this._samples[s+3]]}}set(_,d,c,s){let o;switch((0,a.assert)(_.length===this._components,`number of components expected to be ${this._components}, given ${_.length}`),o=c===void 0&&s===void 0?this._components*Math.min(this.elements,Math.max(0,d)):this._components*this.index(d,c,s||0),(0,a.assert)(o<this.length,`index expected to be in range [0, ${this.length-1}], given ${o}`),this._components){case 4:this._samples[o+3]=_[3];case 3:this._samples[o+2]=_[2];case 2:this._samples[o+1]=_[1];case 1:this._samples[o+0]=_[0]}}fromJSON(_){(0,a.assert)(_.size&&_.size.width!==void 0&&_.size.height!==void 0&&_.size.depth!==void 0,`expected kernel width, height, and depth to be set, given '${_.size}'`);const d=s=>s.reduce((o,l)=>o.concat(Array.isArray(l)?d(l):l),[]);this._width=Math.max(1,_.size.width),this._height=Math.max(1,_.size.height),this._depth=Math.max(1,_.size.depth);const c=d(_.kernel);this._components=Math.floor(c.length/this.elements),this.resize(),this.fromArray(c)}index(_,d=0,c=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,c))+Math.min(this._height,Math.max(0,d)))+Math.min(this._width,Math.max(0,_))}position(_){let d=Math.min(this.elements,Math.max(0,_));const c=Math.floor(d/(this._width*this._height));d-=c*this._width*this._height;const s=Math.floor(d/this._width);return d-=s*this._width,[d,s,c]}sort(_){if(this.elements<2)return;const d=Array(this.elements);for(let s=0;s<this.elements;++s){let o=0;r.SortApproach.BySquaredLength;for(let l=0;l<this._components;++l){const m=this._samples[s*this._components+l];o+=m*m}d[s]=[s,o]}r.SortApproach.BySquaredLength,d.sort((s,o)=>s[1]-o[1]);const c=this._samples.slice();for(let s=0;s<d.length;++s)for(let o=0;o<this._components;++o){const l=d[s][0]*this._components+o,m=s*this._components+o;this._samples[m]=c[l]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const _=this._width*this._height*this._depth;return isNaN(_)?0:_}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}t.AbstractKernel=r,function(h){(function(_){_[_.BySquaredLength=0]="BySquaredLength"})(h.SortApproach||(h.SortApproach={}))}(r||(t.AbstractKernel=r={})),t.KernelF32=class extends r{resize(){this._samples=new Float32Array(this.length)}fromArray(h){(0,a.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(h))}get bytesPerComponent(){return 4}},t.KernelUI32=class extends r{resize(){this._samples=new Uint32Array(this.length)}fromArray(h){(0,a.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(h))}get bytesPerComponent(){return 4}},t.KernelI32=class extends r{resize(){this._samples=new Int32Array(this.length)}fromArray(h){(0,a.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(h))}get bytesPerComponent(){return 4}},t.KernelUI8=class extends r{resize(){this._samples=new Uint8Array(this.length)}fromArray(h){(0,a.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(h))}get bytesPerComponent(){return 4}},t.KernelI8=class extends r{resize(){this._samples=new Int8Array(this.length)}fromArray(h){(0,a.assert)(h.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(h))}get bytesPerComponent(){return 4}}},5678:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardEventType=t.KeyboardEventProvider=void 0;const a=i(7032),r=i(9504);var h;t.KeyboardEventProvider=class{constructor(_,d){(0,r.assert)(_!==void 0,`expected valid canvas element on initialization, given ${_}`),this._element=_,this._timeframe=d}preventDefaultOnEvent(_,d){(0,r.bitInBitfield)(this._preventDefaultMask,_)&&d.preventDefault()}preventDefault(..._){for(const d of _)(0,r.bitInBitfield)(this._preventDefaultMask,d)||(this._preventDefaultMask|=d)}allowDefault(..._){for(const d of _)(0,r.bitInBitfield)(this._preventDefaultMask,d)&&(this._preventDefaultMask&=~d)}observable(_){switch(_){case h.KeyDown:return this.keyDown$;case h.KeyPress:return this.keyPress$;case h.KeyUp:return this.keyUp$;default:return}}get keyDown$(){return this._keyDownSubject===void 0&&(this._keyDownSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyDownListener=_=>{this.preventDefaultOnEvent(h.KeyDown,_),this._keyDownSubject.next(_)},this._element.addEventListener("keydown",this._keyDownListener)),this._keyDownSubject.asObservable()}get keyPress$(){return this._keyPressSubject===void 0&&(this._keyPressSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyPressListener=_=>{this.preventDefaultOnEvent(h.KeyPress,_),this._keyPressSubject.next(_)},this._element.addEventListener("keypress",this._keyPressListener)),this._keyPressSubject.asObservable()}get keyUp$(){return this._keyUpSubject===void 0&&(this._keyUpSubject=new a.ReplaySubject(void 0,this._timeframe),this._keyUpListener=_=>{this.preventDefaultOnEvent(h.KeyUp,_),this._keyUpSubject.next(_)},this._element.addEventListener("keyup",this._keyUpListener)),this._keyUpSubject.asObservable()}},function(_){_[_.KeyDown=1]="KeyDown",_[_.KeyPress=2]="KeyPress",_[_.KeyUp=4]="KeyUp"}(h||(t.KeyboardEventType=h={}))},4602:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MouseEventProvider=void 0;const a=i(7032),r=i(9504),h=i(8853),_=i(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(h.IS_EDGE||h.IS_IE11)&&this._element.addEventListener("dragstart",l=>l.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&_.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Click:return this.click$;case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Wheel:return this.wheel$;case d.Type.Drag:return this.drag$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,_.PointerLock.exit())}get pointerLock(){return _.PointerLock.active(this._element)}get click$(){return this._clickSubject===void 0&&(this._clickSubject=new a.ReplaySubject(void 0,this._timeframe),this._clickListener=s=>{this.preventDefaultOnEvent(d.Type.Click,s),this._clickSubject.next(s)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new a.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new a.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new a.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new a.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return this._wheelSubject===void 0&&(this._wheelSubject=new a.ReplaySubject(void 0,this._timeframe),this._wheelListener=s=>{this.preventDefaultOnEvent(d.Type.Wheel,s),this._wheelSubject.next(s)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return this._dragSubject===void 0&&(this._dragSubject=new a.ReplaySubject(void 0,this._timeframe),this._dragListener=s=>{this.preventDefaultOnEvent(d.Type.Drag,s),this._dragSubject.next(s)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}t.MouseEventProvider=d,function(c){(function(s){s[s.Click=1]="Click",s[s.Wheel=2]="Wheel",s[s.Enter=4]="Enter",s[s.Leave=8]="Leave",s[s.Move=16]="Move",s[s.Down=32]="Down",s[s.Up=64]="Up",s[s.Drag=128]="Drag"})(c.Type||(c.Type={}))}(d||(t.MouseEventProvider=d={}))},8853:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IS_EDGE=t.IS_IE11=void 0,t.IS_IE11=typeof navigator>"u"?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),t.IS_EDGE=typeof navigator>"u"?void 0:/Edge\/\d./i.test(navigator.userAgent)},4264:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Navigation=void 0;const a=i(3557),r=i(2),h=i(2010),_=i(9504),d=i(4850),c=i(506),s=i(5222),o=i(3151),l=i(9184),m=i(7137);class v{constructor(b,x){this._alwaysRotateOnMove=!1,this._invalidate=b,this._eventHandler=new r.EventHandler(b,x),this._eventHandler.pushPointerDownHandler((E,O)=>this.onPointerDown(E,O)),this._eventHandler.pushPointerUpHandler((E,O)=>this.onPointerUp(E,O)),this._eventHandler.pushPointerEnterHandler((E,O)=>this.onPointerEnter(E,O)),this._eventHandler.pushPointerLeaveHandler((E,O)=>this.onPointerLeave(E,O)),this._eventHandler.pushPointerMoveHandler((E,O)=>this.onPointerMove(E,O)),this._eventHandler.pushPointerCancelHandler((E,O)=>this.onPointerCancel(E,O)),this._eventHandler.pushMouseWheelHandler((E,O)=>this.onWheel(E,O)),this.rotationMetaphor=v.RotationMetaphor.Turntable,this._pan=new c.PanModifier,this._pinch=new s.PinchZoomModifier,this._wheelZoom=new m.WheelZoomModifier,this._activeEvents=new Map}mode(){const b=Array.from(this._activeEvents.values()),x=this.getPrimaryEvent(b);if(x===void 0)return void(0,_.log)(_.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const E=x.pointerType==="mouse",O=x.pointerType==="touch"||x.pointerType==="pen",S=1&x.buttons,w=x.shiftKey,P=h.PointerLock.active()&&this._alwaysRotateOnMove,N=this._activeEvents.size;return P?v.Modes.Rotate:E&&S&&w&&N===1?v.Modes.Pan:O&&N===2?v.Modes.MultiTouch:E&&S&&N===1||O&&N===1?v.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void(0,_.log)(_.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const b=Array.from(this._activeEvents.values()),x=a.vec2.fromValues(b[0].movementX,b[0].movementY),E=a.vec2.fromValues(b[1].movementX,b[1].movementY);return a.vec2.length(x)===0||a.vec2.length(E)===0?v.Modes.Zoom:(a.vec2.normalize(x,x),a.vec2.normalize(E,E),a.vec2.dot(x,E)>.2?v.Modes.Pan:v.Modes.Zoom)}rotate(b){if(this._activeEvents.size!==1)return void(0,_.log)(_.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0];switch(this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:const O=this._firstPerson;let S;h.PointerLock.active()&&event instanceof MouseEvent&&(S=a.vec2.fromValues(event.movementX,event.movementY)),b?O.initiate(E):O.process(E,S);break;case v.RotationMetaphor.Trackball:const w=this._trackball;b?w.initiate(E):w.process(E);break;case v.RotationMetaphor.Turntable:const P=this._turntable;b?P.initiate(E):P.process(E)}}pan(b){const x=Array.from(this._activeEvents.values()),E=this.getPrimaryEvent(x);if(E===void 0)return void(0,_.log)(_.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const O=this._eventHandler.offsets(E)[0],S=this._pan;b?S.initiate(O):S.process(O)}pinch(b){if(this._activeEvents.size!==2)return void(0,_.log)(_.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0],O=this._eventHandler.offsets(x[1])[0],S=this._pinch;b?S.initiate(E,O):S.process(E,O)}getPrimaryEvent(b){for(const x of b)if(x.isPrimary)return x}onPointerDown(b,x){for(const E of b)this._activeEvents.set(E.pointerId,E);switch(this._mode=this.mode(),this._mode){case v.Modes.Rotate:this.rotate(!0);break;case v.Modes.Pan:this.pan(!0);break;case v.Modes.Zoom:this.pinch(!0)}}onPointerUp(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerEnter(b,x){}onPointerLeave(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerCancel(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerMove(b,x){for(const w of b)this._activeEvents.set(w.pointerId,w);if(this._mode===void 0)return;const E=Array.from(this._activeEvents.values()),O=this.getPrimaryEvent(E);O&&O.pointerType==="mouse"&&(this._mode=this.mode());let S=!1;switch(this._mode===v.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),S=!0),this._mode){case v.Modes.Rotate:this.rotate(S);break;case v.Modes.Pan:this.pan(S);break;case v.Modes.Zoom:this.pinch(S)}this._lastInteractionTime=performance.now()}onWheel(b,x){const E=b[0];this._wheelZoom.process(E.deltaY)}update(){this._eventHandler.update()}set camera(b){this._camera=b,this._firstPerson&&(this._firstPerson.camera=b),this._trackball&&(this._trackball.camera=b),this._turntable&&(this._turntable.camera=b),this._pan&&(this._pan.camera=b),this._pinch&&(this._pinch.camera=b),this._wheelZoom&&(this._wheelZoom.camera=b)}set rotationMetaphor(b){if(this._rotationMetaphor!==b){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=b,this._rotationMetaphor){case v.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new d.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case v.RotationMetaphor.Trackball:this._trackball=new o.TrackballModifier,this._trackball.camera=this._camera;break;case v.RotationMetaphor.Turntable:this._turntable=new l.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}t.Navigation=v,function(f){(function(b){b[b.Move=0]="Move",b[b.Pan=1]="Pan",b[b.MultiTouch=2]="MultiTouch",b[b.Rotate=3]="Rotate",b[b.Zoom=4]="Zoom",b[b.ZoomStep=5]="ZoomStep"})(f.Modes||(f.Modes={})),function(b){b.FirstPerson="firstperson",b.Flight="flight",b.Trackball="trackball",b.Turntable="turntable"}(f.RotationMetaphor||(f.RotationMetaphor={}))}(v||(t.Navigation=v={}))},5491:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingRectangle=void 0;const r=i(7340),h=i(638),_=i(4127);class d extends h.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const l=new r.Buffer(s,`${o}VBO`);this._buffers.push(l)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,l=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),l}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingRectangle=d,d.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),a([_.Initializable.assert_initialized()],d.prototype,"draw",null)},1896:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingTriangle=void 0;const r=i(7340),h=i(638),_=i(4127);class d extends h.Geometry{constructor(s,o){super(s,o),o=o!==void 0&&o!==""?o:this.constructor.name;const l=new r.Buffer(s,`${o}VBO`);this._buffers.push(l)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const o=this.context.gl,l=super.initialize([o.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,o.STATIC_DRAW),l}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingTriangle=d,d.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),a([_.Initializable.assert_initialized()],d.prototype,"draw",null)},9965:function(p,t,i){var a=this&&this.__decorate||function(d,c,s,o){var l,m=arguments.length,v=m<3?c:o===null?o=Object.getOwnPropertyDescriptor(c,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,c,s,o);else for(var f=d.length-1;f>=0;f--)(l=d[f])&&(v=(m<3?l(v):m>3?l(c,s,v):l(c,s))||v);return m>3&&v&&Object.defineProperty(c,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractObject=void 0;const r=i(9504),h=i(4127);class _ extends h.Initializable{constructor(c,s){super(),this._valid=!1,this._referenceCount=0,this._context=c,this._identifier=s!==void 0&&s!==""?s:"Object"}initialize(...c){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...c),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),(0,r.log)(r.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),(0,r.assert)(this._object===void 0,`expected object '${this._identifier}' to be undefined after delete`),(0,r.assert)(this._valid===!1,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return(0,r.assert)(this._object!==void 0,"access to undefined object"),this._object}get valid(){return this._valid}ref(){(0,r.assert)(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){(0,r.assert)(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}t.AbstractObject=_,a([h.Initializable.initialize()],_.prototype,"initialize",null),a([h.Initializable.uninitialize()],_.prototype,"uninitialize",null)},506:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PanModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=_.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(c){Object.assign(this._reference,this._camera),this._initialPoint=c}process(c){this._currentPoint=c;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity);const o=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(o,o);const l=this._reference.up;a.vec3.normalize(l,l);const m=a.vec3.cross((0,r.v3)(),l,o),v=a.vec3.scale((0,r.v3)(),m,s[0]),f=a.vec3.scale((0,r.v3)(),l,s[1]);a.vec3.negate(f,f),this._translation=a.vec3.add((0,r.v3)(),f,v),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,c),o=a.vec3.transformMat4((0,r.v3)(),this._reference.center,c);this._camera.eye=s,this._camera.center=o}}t.PanModifier=_,_.DEFAULT_SENSITIVITY=.002},5222:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PinchZoomModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=_.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(c,s){Object.assign(this._reference,this._camera);const o=a.vec2.subtract((0,r.v2)(),c,s);this._initialDistance=a.vec2.length(o)}process(c,s){const o=a.vec2.subtract((0,r.v2)(),c,s);this._currentDistance=a.vec2.length(o);const l=(this._currentDistance/this._initialDistance-1)*_.DEFAULT_SENSITIVITY,m=a.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);a.vec3.normalize(m,m),this._translation=a.vec3.scale((0,r.v3)(),m,l),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,c);this._camera.eye=s}}t.PinchZoomModifier=_,_.DEFAULT_SENSITIVITY=2},8216:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerEventProvider=void 0;const a=i(7032),r=i(9504),h=i(8853),_=i(2010);class d{constructor(s,o){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=o,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(h.IS_EDGE||h.IS_IE11)&&this._element.addEventListener("dragstart",l=>l.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&_.PointerLock.request(this._element)}preventDefaultOnEvent(s,o){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&o.preventDefault()}preventDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...s){for(const o of s)(0,r.bitInBitfield)(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(s){switch(s){case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Cancel:return this.cancel$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,_.PointerLock.exit())}get pointerLock(){return _.PointerLock.active(this._element)}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new a.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new a.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new a.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new a.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new a.ReplaySubject(void 0,this._timeframe),this._cancelListener=s=>{this.preventDefaultOnEvent(d.Type.Cancel,s),this._cancelSubject.next(s)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.PointerEventProvider=d,function(c){(function(s){s[s.Enter=1]="Enter",s[s.Leave=2]="Leave",s[s.Move=4]="Move",s[s.Down=8]="Down",s[s.Up=16]="Up",s[s.Cancel=32]="Cancel"})(c.Type||(c.Type={}))}(d||(t.PointerEventProvider=d={}))},2010:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerLock=void 0;const a=i(9504);class r{static queryAndCacheAPI(){if(r._exit!==void 0)return;const _=window.document,d=[_.exitPointerLock,_.mozExitPointerLock,_.webkitExitPointerLock,void 0];let c=0;for(;c<d.length&&d[c]===void 0;++c);switch(c){case 0:r._exit=()=>_.exitPointerLock(),r._request=s=>s.requestPointerLock(),r._element=()=>_.pointerLockElement;break;case 1:r._exit=()=>_.mozCancelPointerLock(),r._request=s=>s.mozRequestPointerLock(),r._element=()=>_.mozPointerLockElement;break;case 2:r._exit=()=>_.webkitExitPointerLock(),r._request=s=>s.webkitRequestPointerLock(),r._element=()=>_.webkitPointerLockElement;break;default:(0,a.assert)(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(_){return this._element!==void 0&&(_!==void 0&&r._element()===_||_===void 0&&r._element()!==void 0&&r._element()!==null)}static request(_,d){_!==void 0&&(r.queryAndCacheAPI(),r.active()&&r._element()!==_&&r._exit(),r.active()||r._request(_))}static exit(){r._exit&&r._exit()}}t.PointerLock=r},4985:function(){String.prototype.repeat===void 0&&(String.prototype.repeat=function(p){if(this===null)throw new TypeError("can't convert "+this+" to object");const t=""+this;if((p=+p)!=p&&(p=0),p<0)throw new RangeError("repeat count must be non-negative");if(p===1/0)throw new RangeError("repeat count must be less than infinity");if(p=Math.floor(p),t.length===0||p===0)return"";if(t.length*p>=268435456)throw new RangeError("repeat count must not overflow maximum string size");let i="";for(let a=0;a<p;a++)i+=t;return i}),String.prototype.startsWith===void 0&&(String.prototype.startsWith=function(p,t){return t=t||0,this.indexOf(p,t)===t}),String.prototype.endsWith===void 0&&(String.prototype.endsWith=function(p,t){return(t===void 0||t>this.length)&&(t=this.length),this.substring(t-p.length,t)===p}),String.prototype.includes===void 0&&(String.prototype.includes=function(p,t){return typeof t!="number"&&(t=0),!(t+p.length>this.length)&&this.indexOf(p,t)!==-1}),String.prototype.trimLeft===void 0&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight===void 0&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Array.prototype.forEach===void 0&&(Array.prototype.forEach=(p,t)=>{const i=this.length;for(let a=0;a<i;a++)a in this&&p.call(t,this[a],a,this)}),Array.prototype.fill===void 0&&(Array.prototype.fill=(p,t,i)=>{if(this===null)throw new TypeError("this is null or not defined");const a=Object(this),r=a.length>>>0,h=0|t;let _=h<0?Math.max(r+h,0):Math.min(h,r);const d=i===void 0?r:0|i,c=d<0?Math.max(r+d,0):Math.min(d,r);for(;_<c;)a[_]=p,++_;return a}),Math.log10===void 0&&(Math.log10=p=>Math.log(p)*Math.LOG10E),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach(p=>{p.prototype.slice||Object.defineProperty(p.prototype,"slice",{value:Array.prototype.slice}),p.prototype.reduce||Object.defineProperty(p.prototype,"reduce",{value:Array.prototype.reduce}),p.prototype.filter||Object.defineProperty(p.prototype,"filter",{value:Array.prototype.filter}),p.prototype.map||Object.defineProperty(p.prototype,"map",{value:Array.prototype.map}),p.prototype.indexOf||Object.defineProperty(p.prototype,"indexOf",{value:Array.prototype.indexOf})}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{value(p,t){if(p===void 0&&p===null)throw new TypeError("Cannot convert undefined or null to object");const i=Object(p);for(let a=1;a<arguments.length;a++){const r=arguments[a];if(r!=null)for(const h in r)Object.prototype.hasOwnProperty.call(r,h)&&(i[h]=r[h])}return i},configurable:!0,writable:!0})},4168:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const r=i(9504),h=i(4127),_=i(9965);class d extends _.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(s=new Array,o=!0){const l=this._context.gl;let m=0,v=0;for(const f of s)switch(f.type){case l.VERTEX_SHADER:++m;break;case l.FRAGMENT_SHADER:++v;break;default:(0,r.assert)(!1,"Unknown shader type detected.")}if((0,r.logIf)(m<1,r.LogLevel.Error,"at least one vertex shader is expected"),(0,r.logIf)(v<1,r.LogLevel.Error,"at least one fragment shader is expected"),!(m<1||v<1))return this._object=l.createProgram(),this._valid=l.isProgram(this._object),(0,r.assert)(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),s.length>0&&this.attach(s,o),this._object}delete(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(s,o=!1){(0,r.assert)(this._object!==void 0,"expected a WebGLProgram object");const l=this._context.gl;for(const m of s instanceof Array?s:[s])this._shaders.indexOf(m)>-1||(this._shaders.push(m),m.initialized?(l.attachShader(this._object,m.object),m.ref()):(0,r.log)(r.LogLevel.Error,`shader '${m.identifier}' not initialized.`));return o&&this.link(),!0}detach(s){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const o=this._context.gl;for(const l of s instanceof Array?s:[s]){const m=this._shaders.indexOf(l);m>-1&&this._shaders.splice(m),(0,r.assert)(l.initialized,`expected shader '${l.identifier}' to be initialized`),o.detachShader(this._object,l.object),l.unref()}}link(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const s=this._context.gl;if(s.linkProgram(this._object),s.getProgramParameter(this._object,s.LINK_STATUS))this._linked=!0;else{const o=s.getProgramInfoLog(this._object);(0,r.log)(r.LogLevel.Error,`linking of program '${this._identifier}' failed: '${o}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(d.DEFAULT_PROGRAM)}uniform(s){return this._context.gl.getUniformLocation(this._object,s)}attribute(s,o){return o!==void 0?((0,r.logIf)(this._linked,r.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${s} -> ${o} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,o,s),o):this._context.gl.getAttribLocation(this._object,s)}get shaders(){return this._shaders}get linked(){return this._linked}}t.Program=d,d.DEFAULT_PROGRAM=void 0,a([h.Initializable.assert_initialized()],d.prototype,"bind",null),a([h.Initializable.assert_initialized()],d.prototype,"unbind",null),a([h.Initializable.assert_initialized()],d.prototype,"uniform",null),a([h.Initializable.assert_initialized()],d.prototype,"attribute",null)},1407:(p,t,i)=>{const a=i(3780),r=i(9504);function h(c,s){const o=s.properties,l=Object.getOwnPropertyNames(o);for(const m of l){const v=o[m],f=v.type==="object",b=c.hasOwnProperty(m),x=v.hasOwnProperty("properties"),E=v.hasOwnProperty("default");(0,r.assert)(x&&f||!x&&!f,`expected property '${m}' to be of type 'object', given '${v.type}'`),b&&x?d.complement(c[m],v):!b&&E&&Object.defineProperty(c,m,{value:v.default,writable:!0})}}function _(c,s){const o=s.items;if(o.type==="object")for(const l of Object.getOwnPropertyNames(c))l!=="length"&&d.complement(c[l],o)}var d;(function(c){c.validate=function(s,o,l){const m=new a.Validator;if(l!==void 0)for(const f of l)m.addSchema(f[0],f[1]);const v=m.validate(s,o);return(0,r.logIf)(!v.valid,r.LogLevel.Warning,`schema expected to be valid:
${v.toString()}`),v.valid},c.complement=function(s,o){if(s!==void 0)switch((0,r.assert)(o.hasOwnProperty("properties")&&o.type==="object"||o.hasOwnProperty("items")&&o.type==="array",`expected schema to have 'properties' or 'items', given ${o}`),o.type){case"object":h(s,o);break;case"array":_(s,o)}},c.compare=function s(o,l,m,v=""){const f=m!==void 0;if((0,r.assert)(!f||m.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),o===void 0&&l!==void 0||o!==void 0&&l===void 0)return f&&m.alter(v),!0;let b=!0,x=[typeof o,typeof l];const E=[o instanceof Array,l instanceof Array];if(!(E[0]&&E[1]||x[0]==="object"&&x[1]==="object"))return b=o===l,!b&&f&&m.alter(`${v}`),!b;const O=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(o),Object.getOwnPropertyNames(l))).values());for(const S of O){if(S==="length")continue;const w=[o[S],l[S]];x=[typeof w[0],typeof w[1]];const P=`${v}${v.length>0&&!E[0]?".":""}${E[0]?"":S}`;if(w[0]instanceof Array&&w[1]instanceof Array||x[0]==="object"&&x[1]==="object")b=b&&!s(w[0],w[1],m,P);else{if(x[0]===x[1]&&w[0]===w[1])continue;b=!1,f&&m.alter(P)}}return!b}})(d||(d={})),p.exports=d},3039:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSquareKernel=void 0;const a=i(9504),r=i(4287);class h extends r.KernelF32{constructor(d){super(2,d),this.generate()}generate(){(0,a.assert)(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let d=1;d<this.width;++d)this.set([(0,a.rand)(-.5,.5),(0,a.rand)(-.5,.5)],d)}get width(){return this._width}set width(d){this._width!==d&&(this._width=d,this.resize(),this.generate())}}t.RandomSquareKernel=h},8962:(p,t,i)=>{const a=i(3557),r=i(5150),h=i(9504);var _;(function(d){function c(m,v,f=1){const b=a.vec2.subtract((0,r.v2)(),v,m);if(a.vec2.equals(b,a.vec2.fromValues(0,0)))return;const x=a.vec2.squaredLength(b),E=2*a.vec2.dot(b,m),O=E*E-4*x*(a.vec2.squaredLength(m)-f*f);if(O<0)return;const S=Math.sqrt(O),w=Math.min((-E+S)/(2*x),(-E-S)/(2*x)),P=a.vec2.scale((0,r.v2)(),b,w);return a.vec2.add(P,P,m)}function s(m,v,f,b){const x=m,E=a.vec2.sub((0,r.v2)(),v,m),O=f,S=a.vec2.sub((0,r.v2)(),b,f),w=a.vec2.cross((0,r.v3)(),E,S)[2];if(w===0)return;const P=a.vec2.sub((0,r.v2)(),O,x),N=a.vec2.cross((0,r.v3)(),P,a.vec2.scale((0,r.v2)(),E,1/w))[2],k=a.vec2.cross((0,r.v3)(),P,a.vec2.scale((0,r.v2)(),S,1/w))[2];return N<0||N>1||k<0?void 0:[a.vec2.add((0,r.v2)(),O,a.vec2.scale((0,r.v2)(),S,N)),k]}function o(m,v,f=a.vec3.fromValues(0,0,0),b=a.vec3.fromValues(0,1,0)){const x=a.vec3.normalize((0,r.v3)(),a.vec3.subtract((0,r.v3)(),v,m)),E=a.vec3.dot(x,b);if(a.vec3.equals(x,[0,0,0])||E>=0)return;const O=a.vec3.dot(a.vec3.subtract((0,r.v3)(),f,m),b)/E;return a.vec3.add((0,r.v3)(),a.vec3.scale((0,r.v3)(),x,O),m)}function l(m,v,f){const b=a.vec3.subtract((0,r.v3)(),v,m),x=a.vec3.squaredLength(b);if(x===0)return 0;const E=a.vec3.subtract((0,r.v3)(),f,m);return a.vec3.dot(E,b)/x}d.rayCircleIntersection=c,d.pointSquareIntersection=function(m,v=1){const f=(0,r.abs2)((0,r.v2)(),m);return f[0]>=f[1]?a.vec2.fromValues((0,r.sign)(m[0])*v,m[1]/f[0]*v):a.vec2.fromValues(m[0]/f[1]*v,(0,r.sign)(m[1])*v)},d.raySquareIntersection=function(m,v,f=1){const b=[a.vec2.fromValues(-f,+f),a.vec2.fromValues(-f,-f),a.vec2.fromValues(+f,-f),a.vec2.fromValues(+f,+f)],x=new Array;for(let E=0;E<4;++E){const O=s(m,v,b[E],b[(E+1)%4]);O&&x.push(O[1])}return x},d.rayLineIntersection=s,d.rayPlaneIntersection=o,d.raySphereIntersection=function(m,v,f=a.vec3.fromValues(0,0,0),b=1){const x=a.vec3.subtract((0,r.v3)(),m,f),E=a.vec3.normalize((0,r.v3)(),a.vec3.subtract((0,r.v3)(),v,m)),O=a.vec3.dot(E,x),S=O*O-a.vec3.squaredLength(x)+b*b;if(!(S<=0))return a.vec3.add((0,r.v3)(),m,a.vec3.scale((0,r.v3)(),E,-O-Math.sqrt(S)))},d.rayPlaneIntersection_tube=function(m,v,f=1){const b=o(m,v);if(b!==void 0&&a.vec3.length(b)<f)return b;const x=c(a.vec2.fromValues(m[0],m[2]),a.vec2.fromValues(v[0],v[2]),f);return x?a.vec3.fromValues(x[0],0,x[1]):void 0},d.isPointWithinSquare=function(m,v=1){const f=(0,r.abs2)((0,r.v2)(),m);return f[0]<=v&&f[1]<=v},d.isPointWithinNDC=function(m,v){const f=a.vec3.transformMat4((0,r.v3)(),v,m),b=(0,r.abs3)((0,r.v3)(),f);return b[0]<=1&&b[1]<=1&&f[2]>=0&&f[2]<=1},d.distancePointToRay=l,d.eyeWithPointInView=function(m,v){const f=a.vec3.subtract((0,r.v3)(),m.center,m.eye),b=a.vec3.normalize((0,r.v3)(),f),x=a.vec3.normalize((0,r.v3)(),a.vec3.cross((0,r.v3)(),b,m.up)),E=a.vec3.normalize((0,r.v3)(),a.vec3.cross((0,r.v3)(),x,b)),O=l(m.eye,m.center,v),S=a.vec3.add((0,r.v3)(),m.eye,a.vec3.scale((0,r.v3)(),f,O)),w=a.vec3.subtract((0,r.v3)(),v,S),P=Math.abs(a.vec3.dot(w,x))/m.aspect,N=Math.abs(a.vec3.dot(w,E)),k=Math.max(P,N)/Math.tan(m.fovy*h.DEG2RAD*.5);return a.vec3.subtract((0,r.v3)(),S,a.vec3.scale((0,r.v3)(),b,k))}})(_||(_={})),p.exports=_},1900:function(p,t,i){var a=this&&this.__decorate||function(f,b,x,E){var O,S=arguments.length,w=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(f,b,x,E);else for(var P=f.length-1;P>=0;P--)(O=f[P])&&(w=(S<3?O(w):S>3?O(b,x,w):O(b,x))||w);return S>3&&w&&Object.defineProperty(b,x,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.ReadbackPass=void 0;const r=i(3557),h=i(9504),_=i(5150),d=i(8215),c=i(4127),s=i(1896),o=i(4168),l=i(771),m=i(8593);class v extends c.Initializable{static maxClearDepth(){return(0,_.decode_float24x1_from_uint8x3)(r.vec3.fromValues(255,255,255))}constructor(b){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=b}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(b,x){return 65535*x+b}directReadDepthAt(b,x){(0,h.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),O=this._context.gl,S=E.size;this._depthFBO.bind();const w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&O.readBuffer(this._depthAttachment),O.readPixels(b*w[0],S[1]-x*w[1],1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(b,x){(0,h.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),O=this._context.gl,S=E.size,w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return O.viewport(0,0,1,1),this._program.bind(),O.uniform2f(this._uOffset,b*w[0]/S[0],(S[1]-x*w[1])/S[1]),O.uniform2f(this._uScale,1/S[0],1/S[1]),E.bind(O.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),E.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&O.readBuffer&&O.readBuffer(O.COLOR_ATTACHMENT0),O.readPixels(0,0,1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(b,x){const E=this._context.gl,O=this._context.gl2facade;if(x)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const S=new l.Shader(this._context,E.VERTEX_SHADER,"ndcvertices.vert (readback)");S.initialize(i(9657));const w=new l.Shader(this._context,E.FRAGMENT_SHADER,"readbackdepth.frag");return w.initialize(i(688)),this._program=new o.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([S,w],!1),b===void 0?this._ndcTriangle=new s.NdcFillingTriangle(this._context):(this._ndcTriangle=b,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),E.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new m.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,E.RGBA,E.RGBA,E.UNSIGNED_BYTE),this._framebuffer=new d.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[O.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(b,x){const E=this.hash(b,x);if(this._cache&&this._cachedDepths.has(E))return this._cachedDepths.get(E);const O=this.readDepthAt(b,x),S=O[0]===255&&O[1]===255&&O[2]===255?void 0:(0,_.decode_float24x1_from_uint8x3)(r.vec3.fromValues(O[0],O[1],O[2]));return this._cache&&this._cachedDepths.set(E,S),S}coordsAt(b,x,E,O){const S=this._depthFBO.texture(this._depthAttachment).size,w=E===void 0?this.depthAt(b,x):E;if(w===void 0)return;const P=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]],N=r.vec3.fromValues(b*P[0]*2/S[0]-1,1-x*P[1]*2/S[1],2*w-1);return r.vec3.transformMat4(r.vec3.create(),N,O)}idAt(b,x){const E=this.hash(b,x);if(this._cache&&this._cachedIDs.has(E))return this._cachedIDs.get(E);const O=this._context.gl,S=this._idFBO.texture(this._idAttachment).size,w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&O.readBuffer(this._idAttachment),O.readPixels(b*w[0],S[1]-x*w[1],1,1,O.RGBA,O.UNSIGNED_BYTE,this._buffer);const P=(0,_.decode_uint32_from_rgba8)(r.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(E,P),P}frame(){this.onFrame()}set cache(b){this._cache=b}set depthFBO(b){this._depthFBO=b}set depthAttachment(b){this._depthAttachment=b}set idFBO(b){this._idFBO=b}set idAttachment(b){this._idAttachment=b}set coordinateReferenceSize(b){this._referenceSize=b}}t.ReadbackPass=v,a([c.Initializable.assert_initialized()],v.prototype,"directReadDepthAt",null),a([c.Initializable.assert_initialized()],v.prototype,"renderThenReadDepthAt",null),a([c.Initializable.initialize()],v.prototype,"initialize",null),a([c.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([c.Initializable.assert_initialized()],v.prototype,"depthAt",null),a([c.Initializable.assert_initialized()],v.prototype,"coordsAt",null),a([c.Initializable.assert_initialized()],v.prototype,"idAt",null)},8400:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderbuffer=void 0;const r=i(9504),h=i(3513),_=i(4127),d=i(9965);class c extends d.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(o,l,m,v=1){(0,r.assert)(o>0&&l>0,"renderbuffer object requires valid width and height greater than zero");const f=this.context.gl;this._object=f.createRenderbuffer(),this._width=o,this._height=l,this._internalFormat=m,this._samples=v,f.bindRenderbuffer(f.RENDERBUFFER,this._object),this._samples>1?f.renderbufferStorageMultisample(f.RENDERBUFFER,this._samples,m,o,l):f.renderbufferStorage(f.RENDERBUFFER,m,o,l),this._valid=f.isRenderbuffer(this._object),f.bindRenderbuffer(f.RENDERBUFFER,c.DEFAULT_RENDER_BUFFER);const b=o*l*(0,h.byteSizeOfFormat)(this.context,m);return this.context.allocationRegister.reallocate(this._identifier,b),this._object}delete(){(0,r.assert)(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,c.DEFAULT_RENDER_BUFFER)}resize(o,l,m=!1,v=!1){if(o===this._width&&l===this._height)return;this._width=o,this._height=l;const f=this.context.gl;m&&this.bind(),this._samples>1?f.renderbufferStorageMultisample(f.RENDERBUFFER,this._samples,this._internalFormat,o,l):f.renderbufferStorage(f.RENDERBUFFER,this._internalFormat,o,l),v&&this.unbind();const b=o*l*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,b)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}t.Renderbuffer=c,c.DEFAULT_RENDER_BUFFER=void 0,a([_.Initializable.assert_initialized()],c.prototype,"bind",null),a([_.Initializable.assert_initialized()],c.prototype,"unbind",null),a([_.Initializable.assert_initialized()],c.prototype,"resize",null)},3105:function(p,t,i){var a=this&&this.__decorate||function(f,b,x,E){var O,S=arguments.length,w=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(f,b,x,E);else for(var P=f.length-1;P>=0;P--)(O=f[P])&&(w=(S<3?O(w):S>3?O(b,x,w):O(b,x))||w);return S>3&&w&&Object.defineProperty(b,x,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.LoadingStatus=void 0;const r=i(7032),h=i(3557),_=i(9504),d=i(5150),c=i(7564),s=i(4127),o=i(2813),l=i(9217);var m;(function(f){f[f.Started=0]="Started",f[f.Finished=1]="Finished"})(m||(t.LoadingStatus=m={}));class v extends s.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new c.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=l.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new r.ReplaySubject(1)}invalidate(b=!1){this._invalidate(b)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(m.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(m.Finished)}initialize(b,x,E){return(0,_.assert)(b!==void 0,"valid webgl context required"),this._context=b,(0,_.assert)(x!==void 0,"valid multi-frame update callback required"),this._invalidate=x,this._isLoading=!0,this._loadingStatusSubscription=new r.ReplaySubject,this.onInitialize(b,x,E)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(b){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==b&&(this._multiFrameNumber=b,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(b){this.onFrame(b)}swap(){this.onSwap()}frameCoords(b,x){const E=h.vec2.divide((0,d.v2)(),this._frameSize,this.canvasSize);return h.vec2.floor(E,h.vec2.multiply(E,[b+.5,x+.5],E)),h.vec2.add(E,E,[.5,.5]),(0,o.tuple2)(E)}set frameSize(b){this.assertInitialized(),h.vec2.equals(this._frameSize,b)||(Object.assign(this._frameSize,b),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(b){this.assertInitialized(),this._framePrecision!==b&&(this._framePrecision=b,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(b){this.assertInitialized(),h.vec4.equals(this._clearColor,b)||(Object.assign(this._clearColor,b),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(b){this.assertInitialized(),this._debugTexture!==b&&((0,_.logIf)(b>=this._debugTextures.length,_.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${b} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=b<this._debugTextures.length?(0,d.clamp)(b,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}t.Renderer=v,a([s.Initializable.assert_initialized()],v.prototype,"invalidate",null),a([s.Initializable.initialize()],v.prototype,"initialize",null),a([s.Initializable.uninitialize()],v.prototype,"uninitialize",null),a([s.Initializable.discard()],v.prototype,"discard",null),a([s.Initializable.assert_initialized()],v.prototype,"update",null),a([s.Initializable.assert_initialized()],v.prototype,"prepare",null),a([s.Initializable.assert_initialized()],v.prototype,"frame",null),a([s.Initializable.assert_initialized()],v.prototype,"swap",null)},9137:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resizable=void 0;const a=i(9504);class r{static resize(){(0,a.assert)(r.instances.length>0,"resize event received without a single resizable registered"),r.instances.forEach(_=>_.onResize())}static elementSize(_){if(_===void 0||window===void 0||typeof window.devicePixelRatio!="number")return[0,0];const d=window.devicePixelRatio,c=getComputedStyle(_);if(c.width===null||!c.width.endsWith("px")||c.height===null||!c.height.endsWith("px"))return void(0,a.log)(a.LogLevel.Debug,`computed element size expected in 'px', given ${c.width} ${c.height}`);const s=[parseFloat(c.width),parseFloat(c.height)];return[Math.round(s[0]*d),Math.round(s[1]*d)]}constructor(){if(this._resizeEventListener=()=>r.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),r.resize()},r.instances.length===0){const _=`on${r.EVENT_IDENTIFIER}`;r.eventSupported=document&&(_ in document.documentElement||_ in document.body),(0,a.logIf)(!r.eventSupported,a.LogLevel.Warning,"resize event not supported")}r.instances.length===0&&r.eventSupported&&window.addEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),r.instances.push(this)}observe(_){_!==void 0&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(_,r.MUTATION_OBSERVER_CONFIG)}dispose(){const _=r.instances.indexOf(this);(0,a.assert)(_!==-1,"invalid reference counting of resizable instances"),r.instances.splice(_,1),r.instances.length===0&&r.eventSupported&&window.removeEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}t.Resizable=r,r.EVENT_IDENTIFIER="resize",r.instances=[],r.eventSupported=!1,r.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},6197:function(p,t,i){var a=this&&this.__decorate||function(o,l,m,v){var f,b=arguments.length,x=b<3?l:v===null?v=Object.getOwnPropertyDescriptor(l,m):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,l,m,v);else for(var E=o.length-1;E>=0;E--)(f=o[E])&&(x=(b<3?f(x):b>3?f(l,m,x):f(l,m))||x);return b>3&&x&&Object.defineProperty(l,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardSceneRenderPass=void 0;const r=i(3557),h=i(9504),_=i(7564),d=i(4127),c=i(5138);class s extends c.SceneRenderPass{constructor(l){super(),this._altered=Object.assign(new _.ChangeLookup,{any:!1,camera:!1}),this._context=l,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){(0,h.assert)(this._scene!==void 0,"Scene was undefined during preprocessing."),this._scene!==void 0&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,r.mat4.create()))}preprocessNode(l,m){const v=r.mat4.clone(m),f=l.componentsOfType("TransformComponent");if((0,h.assert)(f.length<=1,"SceneNode can not have more than one transform component"),f.length===1){const x=f[0];r.mat4.mul(v,v,x.transform)}const b=l.componentsOfType("GeometryComponent");for(const x of b){const E=x,O=E.material,S=E.geometry;if(O.isTransparent){let w=this._transparentGeometryMap.get(O);w===void 0&&(w=[]),w.push([S,v]),this._transparentGeometryMap.set(O,w)}else{let w=this._opaqueGeometryMap.get(O);w===void 0&&(w=[]),w.push([S,v]),this._opaqueGeometryMap.set(O,w)}}if(l.nodes!==void 0)for(const x of l.nodes)this.preprocessNode(x,v)}renderGeometryMap(l){for(const m of Array.from(l.keys())){this.bindMaterial(m);const v=l.get(m);for(const[f,b]of v)f.bind(),this.bindGeometry!==void 0&&this.bindGeometry(f),this.updateModelTransform(b),f.draw(),f.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(l=!1){}frame(){if((0,h.assert)(this._target&&this._target.valid,"valid target expected"),(0,h.assert)(this._program&&this._program.valid,"valid program expected"),(0,h.assert)(this.updateModelTransform!==void 0,"Model transform function needs to be initialized."),(0,h.assert)(this.updateViewProjectionTransform!==void 0,"View Projection transform function needs to be initialized."),(0,h.assert)(this.bindMaterial!==void 0,"Material binding function needs to be initialized."),this._scene===void 0)return;const l=this._context.gl;l.enable(l.DEPTH_TEST);const m=this._target.size;l.viewport(0,0,m[0],m[1]),this._program.bind(),this.bindUniforms!==void 0&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),l.disable(l.BLEND)}drawCalls(l=!0){this._scene!==void 0&&(this.renderGeometryMap(this._opaqueGeometryMap),l&&this.renderGeometryMap(this._transparentGeometryMap))}set target(l){this.assertInitialized(),this._target=l}set ndcOffset(l){this.assertInitialized(),this._ndcOffset=l}set camera(l){this.assertInitialized(),this._camera!==l&&(this._camera=l,this._altered.alter("camera"))}set clearColor(l){this._clearColor=l}set program(l){this._program=l}}t.ForwardSceneRenderPass=s,a([d.Initializable.initialize()],s.prototype,"initialize",null),a([d.Initializable.uninitialize()],s.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],s.prototype,"update",null),a([d.Initializable.assert_initialized()],s.prototype,"frame",null),a([d.Initializable.assert_initialized()],s.prototype,"drawCalls",null)},2384:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryComponent=void 0;const a=i(6344);class r extends a.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(_){this._geometry=_}get geometry(){return this._geometry}set material(_){this._material=_}get material(){return this._material}}t.GeometryComponent=r},5315:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=t.Material=t.GeometryComponent=t.TransformComponent=t.SceneNodeComponent=t.SceneNode=t.ForwardSceneRenderPass=void 0;var a=i(6197);Object.defineProperty(t,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return a.ForwardSceneRenderPass}});var r=i(651);Object.defineProperty(t,"SceneNode",{enumerable:!0,get:function(){return r.SceneNode}});var h=i(6344);Object.defineProperty(t,"SceneNodeComponent",{enumerable:!0,get:function(){return h.SceneNodeComponent}});var _=i(6244);Object.defineProperty(t,"TransformComponent",{enumerable:!0,get:function(){return _.TransformComponent}});var d=i(2384);Object.defineProperty(t,"GeometryComponent",{enumerable:!0,get:function(){return d.GeometryComponent}});var c=i(7874);Object.defineProperty(t,"Material",{enumerable:!0,get:function(){return c.Material}});var s=i(5138);Object.defineProperty(t,"SceneRenderPass",{enumerable:!0,get:function(){return s.SceneRenderPass}})},7874:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0,t.Material=class{constructor(i,a){this._context=i,this._name=a,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(i){this._isTransparent=i}}},651:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=void 0,t.SceneNode=class{constructor(i){this._nodes=new Array,this._components=new Array,this._name=i,this._parent=void 0}traverse(i){i(this);for(const a of this._nodes)a.traverse(i)}addNode(i){return i._parent=this,this._nodes.push(i),i}addComponent(i){return this._components.push(i),i}componentsOfType(i){return this._components.filter(a=>i===a.type)}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return this._nodes.length===0}get isRoot(){return this._parent===void 0}}},6344:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNodeComponent=void 0,t.SceneNodeComponent=class{constructor(i){this._type=i}get type(){return this._type}}},5138:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=void 0;const a=i(4127);class r extends a.Initializable{set scene(_){this._scene=_,this._scene!==void 0&&this.preprocessScene()}get scene(){return this._scene}}t.SceneRenderPass=r},6244:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformComponent=void 0;const a=i(6344);class r extends a.SceneNodeComponent{constructor(_){super("TransformComponent"),this._transform=_}get transform(){return this._transform}}t.TransformComponent=r},771:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;const a=i(9504),r=i(9965);class h extends r.AbstractObject{constructor(d,c,s){super(d,s),this._compiled=!1;const o=d.gl;if(s===void 0)switch(c){case d.gl.FRAGMENT_SHADER:s="FragmentShader";break;case d.gl.VERTEX_SHADER:s="VertexShader";break;default:(0,a.assert)(!1,`expected either a FRAGMENT_SHADER (${o.FRAGMENT_SHADER}) or a VERTEX_SHADER (${o.VERTEX_SHADER}), given ${c}`)}this._type=c}create(d,c=!0){const s=this._context.gl;return this._object=s.createShader(this._type),this._valid=s.isShader(this._object),this._compiled=!1,(0,a.assert)(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),d&&(this.source=d),d&&c&&this.compile(),this._object}delete(){(0,a.assert)(this._object!==void 0,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const d=this._context.gl;let c=this.sourceWithReplacements;if(this._context.isWebGL2&&(c=`#version 300 es
${c}`),d.shaderSource(this._object,c),d.compileShader(this._object),this._compiled=d.getShaderParameter(this._object,d.COMPILE_STATUS),!this._compiled){const s=d.getShaderInfoLog(this._object);(0,a.log)(a.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${s}`)}}replace(d,c){this._replacements===void 0&&(this._replacements=new Map),this._replacements.set(d,c)}get type(){return this.assertInitialized(),this._type}set source(d){this._source!==d&&(this._source=d)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(this._replacements===void 0)return this._source;let d=this._source;return this._replacements.forEach((c,s)=>{const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");d=d.replace(new RegExp(o,"g"),c)}),d}get compiled(){return this.assertInitialized(),this._compiled}}t.Shader=h},9011:function(p,t,i){var a=this&&this.__decorate||function(m,v,f,b){var x,E=arguments.length,O=E<3?v:b===null?b=Object.getOwnPropertyDescriptor(v,f):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(m,v,f,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(O=(E<3?x(O):E>3?x(v,f,O):x(v,f))||O);return E>3&&O&&Object.defineProperty(v,f,O),O};Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowPass=void 0;const r=i(9504),h=i(8215),_=i(3395),d=i(4127),c=i(8400),s=i(8593),o=i(9217);class l extends d.Initializable{constructor(v){super(),this._gaussFilterKernelSize=21,this._context=v}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==l.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(v){v!==this._gaussFilterKernelSize&&(this._gaussFilter!==void 0&&(this._gaussFilter.kernelSize=v,this._gaussFilter.standardDeviation=v/6),this._gaussFilterKernelSize=v)}resize(v,f=!0,b=!0){(0,r.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._shadowMapSize=v,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],f,b)}resizeBlurTexture(v,f=!0,b=!0){(0,r.assert)(v[0]>0&&v[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=v,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],f,b),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],f,b)}initialize(v,f,b){(0,r.assert)(f[0]>0&&f[1]>0,"Size has to be > 0."),this._shadowType=v,this._shadowMapSize=f,this._blurredShadowMapSize=b!==void 0?b:this._shadowMapSize;const x=this._context.gl,E=this._context.gl2facade;let O=x.RGBA;if(this._context.isWebGL2){const N=this._context.gl;switch(this._shadowType){case l.ShadowMappingType.HardLinear:case l.ShadowMappingType.HardExponential:O=N.RED;break;case l.ShadowMappingType.SoftLinear:O=N.RG;break;case l.ShadowMappingType.SoftExponential:O=N.RGBA;break;default:(0,r.assert)(!1,"Unexpected value for shadowType")}}const[S,w]=o.Wizard.queryInternalTextureFormat(this._context,O,o.Wizard.Precision.float);this._shadowType!==l.ShadowMappingType.HardLinear&&w!==x.FLOAT&&((0,r.log)(r.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=l.ShadowMappingType.HardLinear);let P=x.LINEAR;return w!==x.FLOAT||this._context.supportsTextureFloatLinear||(P=x.NEAREST),w!==E.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(P=x.NEAREST),this._shadowMapTexture=new s.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],S,O,x.FLOAT),this._shadowMapTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._shadowMapTexture.filter(P,P),this._shadowMapRenderbuffer=new c.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],x.DEPTH_COMPONENT16),this._shadowMapFBO=new h.Framebuffer(this._context),this._shadowMapFBO.initialize([[E.COLOR_ATTACHMENT0,this._shadowMapTexture],[x.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new _.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new s.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,O,x.FLOAT),this._intermediateBlurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(P,P),this._intermediateBlurFBO=new h.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[E.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new s.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,O,x.FLOAT),this._blurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._blurTexture.filter(P,P),this._blurFBO=new h.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[E.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(v){const f=this._context.gl;f.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),f.enable(f.DEPTH_TEST),f.depthFunc(f.LEQUAL),this._shadowMapFBO.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT,!0,!1),v(),f.disable(f.DEPTH_TEST),f.depthFunc(f.LESS),this.hasBlur&&(f.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,_.GaussFilter.Direction.Horizontal),f.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,_.GaussFilter.Direction.Vertical))}}t.ShadowPass=l,a([d.Initializable.assert_initialized()],l.prototype,"resize",null),a([d.Initializable.assert_initialized()],l.prototype,"resizeBlurTexture",null),a([d.Initializable.initialize()],l.prototype,"initialize",null),a([d.Initializable.uninitialize()],l.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],l.prototype,"frame",null),function(m){(function(v){v[v.HardLinear=0]="HardLinear",v[v.SoftLinear=1]="SoftLinear",v[v.HardExponential=2]="HardExponential",v[v.SoftExponential=3]="SoftExponential"})(m.ShadowMappingType||(m.ShadowMappingType={}))}(l||(t.ShadowPass=l={}))},8296:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFace=void 0;const a=i(9504),r=i(8593),h=i(9217),_=i(64),d=i(1575),c=i(2668);class s{static fromFile(l,m,v=!1,f){return(0,_.fetchAsync)(l,"text").then(b=>{const x=new s(m,f);return d.FontFaceLoader.process(x,b,l,void 0,v).then(E=>E).catch(E=>Promise.reject(`processing font face data failed: ${E}`))})}static fromFiles(l,m,v,f=!1,b){return(0,_.fetchAsync)(l,"text").then(x=>{const E=new s(v,b);return d.FontFaceLoader.process(E,x,l,m,f).then(O=>O).catch(O=>Promise.reject(`processing font face data failed: ${O}`))})}constructor(l,m){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=l;const v=l.gl;m=m!==void 0&&m!==""?m:this.constructor.name,this._glyphTexture=new r.Texture2D(l,`${m}GlyphAtlas`);const f=h.Wizard.queryInternalTextureFormat(l,v.RGBA,h.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,f[0],v.RGBA,f[1]),this._glyphTexture.filter(v.LINEAR,v.LINEAR)}hasGlyph(l){return!!this._glyphs.get(l)}glyph(l){const m=this._glyphs.get(l);if(m)return m;const v=new c.Glyph;return v.index=l,v}addGlyph(l){(0,a.assert)(!this._glyphs.get(l.index),"expected glyph to not already exist"),this._glyphs.set(l.index,l)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(l){return this.glyph(l).depictable()}kerning(l,m){const v=this._glyphs.get(l);return v?v.kerning(m):0}setKerning(l,m,v){const f=this._glyphs.get(l);f&&this.hasGlyph(m)?f.setKerning(m,v):(0,a.assert)(!1,`expected glyph or glyph of subsequent index to exist,                 given ${l} and ${m} respectively`)}set size(l){(0,a.assert)(l>0,`expected size to be greater than 0.0, given ${l}`),this._size=l}get size(){return this._size}set base(l){(0,a.assert)(l>0,`expected base to be greater than 0.0, given ${l}`),this._base=l}get base(){return this._base}set ascent(l){(0,a.assert)(l>0,`expected ascent to be greater than 0.0, given ${l}`),this._ascent=l}get ascent(){return this._ascent}set descent(l){this._descent=l}get descent(){return this._descent}set lineGap(l){this._lineGap=l}get lineGap(){return this._lineGap}set lineHeight(l){(0,a.assert)(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=l-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(l){this._lineGap=this.size*(l-1)}get lineSpace(){return this.lineHeight===0?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(l){(0,a.assert)(l[0]>0,`expected extent.x to be greater than 0.0, given ${l[0]}`),(0,a.assert)(l[1]>0,`expected extent.y to be greater than 0.0, given ${l[1]}`),this._glyphTextureExtent=l}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(l){(0,a.assert)(l[0]>=0,`expected padding[0] to be greater than 0.0, given ${l[0]}`),(0,a.assert)(l[1]>=0,`expected padding[1] to be greater than 0.0, given ${l[1]}`),(0,a.assert)(l[2]>=0,`expected padding[2] to be greater than 0.0, given ${l[2]}`),(0,a.assert)(l[3]>=0,`expected padding[3] to be greater than 0.0, given ${l[3]}`),this._glyphTexturePadding=l}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(l){this._glyphTexture=l}get glyphTexture(){return this._glyphTexture}}t.FontFace=s},1575:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFaceLoader=void 0;const a=i(9504),r=i(2668);class h{static processInfo(d,c){const s=new Map;if(!this.readKeyValuePairs(d,["size","padding"],s))return!1;c.size=parseFloat(s.get("size"));const o=s.get("padding").split(",");if(o.length!==4)return(0,a.log)(a.LogLevel.Warning,`expected 4 values for padding, given ${o} (${o.length})`),!1;const l=[parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])];return c.glyphTexturePadding=l,!0}static processCommon(d,c){const s=new Map;return!!this.readKeyValuePairs(d,["lineHeight","base","scaleW","scaleH"],s)&&(c.base=parseFloat(s.get("base")),s.has("ascent")&&(c.ascent=parseFloat(s.get("ascent"))),s.has("descent")&&(c.descent=parseFloat(s.get("descent"))),c.lineHeight=parseFloat(s.get("lineHeight")),c.glyphTextureExtent=[parseFloat(s.get("scaleW")),parseFloat(s.get("scaleH"))],!0)}static processPage(d,c,s){const o=new Map;if(!this.readKeyValuePairs(d,["file"],o))return;const l=(0,a.dirname)(s);let m=o.get("file");return m=m.replace(/['"]+/g,""),c.glyphTexture.fetch(`${l}/${m}`,!0,!0).catch(()=>Promise.reject(`page '${m}' referenced in font file '${s}' was not found`))}static processPages(d,c){(0,a.logIf)(c.size!==1,a.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),(0,a.assert)(c.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const s=c.get(0);if(s)return d.glyphTexture.fetch(`${s}`,!0,!0).catch(()=>Promise.reject(`fetching page '0' from '${s}' failed`))}static processChar(d,c){const s=new Map;if(!this.readKeyValuePairs(d,["id","x","y","width","height","xoffset","yoffset","xadvance"],s))return!1;const o=parseInt(s.get("id"),10);(0,a.logIf)(o<=0,a.LogLevel.Warning,`expected glyph index to be greater than 0, given ${o}`);const l=new r.Glyph;l.index=o;const m=[1/c.glyphTextureExtent[0],1/c.glyphTextureExtent[1]],v=[parseFloat(s.get("width")),parseFloat(s.get("height"))];return l.subTextureOrigin=[parseFloat(s.get("x"))*m[0],1-(parseFloat(s.get("y"))+v[1])*m[1]],l.extent=v,l.subTextureExtent[0]=v[0]*m[0],l.subTextureExtent[1]=v[1]*m[1],l.bearingFromFontBaseAndOffset(c.base,parseFloat(s.get("xoffset")),parseFloat(s.get("yoffset"))),l.advance=parseFloat(s.get("xadvance")),c.addGlyph(l),!0}static processKerning(d,c){const s=new Map;if(!this.readKeyValuePairs(d,["first","second","amount"],s))return!1;const o=parseInt(s.get("first"),10);if(o<=0)return(0,a.log)(a.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${o}`),!1;const l=parseInt(s.get("second"),10);if(l<=0)return(0,a.log)(a.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${l}`),!1;const m=parseFloat(s.get("amount"));return c.setKerning(o,l,m),!0}static readKeyValuePairs(d,c,s){let o,l;for(const v of d){const f=v.split("=");o=f[0],l=f[1],s.set(o,l)}let m=!0;return c.forEach(v=>m=m&&s.has(v)),m||(0,a.log)(a.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${c}`),m}static findAscentAndDescentIfNoneProvided(d,c){if(d.ascent>0&&d.descent<0)return;d.ascent>0&&(d.descent=d.ascent-c),d.descent<0&&(d.ascent=d.descent-c);let s=Number.MIN_VALUE;for(const o of d.arrayOfGlyphIndices())d.glyph(o).extent[1]!==0&&(s=Math.max(d.glyph(o).bearing[1],s));d.ascent=s,d.descent=d.ascent-c,(0,a.log)(a.LogLevel.Debug,`ascent not specified, derived ${d.ascent} from maximum y-offset`)}static process(d,c,s,o,l=!1){const m=c.split(`
`),v=new Array;let f=!0;if(!l&&o){const b=this.processPages(d,o);b!==void 0&&v.push(b)}for(const b of m){let x=b.split(" ");const E=x[0];switch(x=x.slice(1),E){case"info":f=this.processInfo(x,d);break;case"common":f=this.processCommon(x,d);break;case"page":if(l||o)break;const O=this.processPage(x,d,s);O!==void 0&&v.push(O);break;case"char":f=this.processChar(x,d);break;case"kerning":this.processKerning(x,d)}if(f===!1)break}return h.findAscentAndDescentIfNoneProvided(d,d.size),d.size<=0&&(0,a.log)(a.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${d.size}`),Promise.all(v).then(()=>d)}}t.FontFaceLoader=h},2668:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Glyph=void 0;const a=i(2813);t.Glyph=class{constructor(r=0,h=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=r,this._advance=h}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(r){const h=this._kernings.get(r);return h!==void 0?h:0}setKerning(r,h){this._kernings.set(r,h)}set index(r){this._index=r}get index(){return this._index}set subTextureOrigin(r){this._subTextureOrigin=(0,a.clampf2)(r,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(r){this._subTextureExtent=(0,a.clampf2)(r,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(r){this._bearing=r}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(r,h,_){this._bearing[0]=h,this._bearing[1]=r-_}set extent(r){this._extent=r}get extent(){return this._extent}set advance(r){this._advance=r}get advance(){return this._advance}}},9495:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphVertices=void 0;class i{static concat(r){let h=0;r.forEach(c=>h+=c?c.length:0);const _=new i(h);let d=0;for(let c=0;c<r.length;++c){const s=r[c];s!==void 0&&s.length!==0&&(_._texCoords.set(s._texCoords,d*i.FLOATS_PER_TEXCOORD),_._origins.set(s._origins,d*i.FLOATS_PER_ORIGIN),_._tangents.set(s._tangents,d*i.FLOATS_PER_TANGENT),_._ups.set(s._ups,d*i.FLOATS_PER_UP),d+=s.length)}return _}constructor(r){const h=Math.max(0,r);this._texCoords=new Float32Array(h*i.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(h*i.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(h*i.FLOATS_PER_TANGENT),this._ups=new Float32Array(h*i.FLOATS_PER_UP)}shrink(r){const h=Math.max(0,r);if(this.length===h)return;const _=(d,c,s)=>new Float32Array(d.buffer.slice(0,c*d.BYTES_PER_ELEMENT*s),0,c*s);_(this._texCoords,h,i.FLOATS_PER_TEXCOORD),_(this._origins,h,i.FLOATS_PER_ORIGIN),_(this._ups,h,i.FLOATS_PER_TANGENT),_(this._tangents,h,i.FLOATS_PER_UP)}uvLowerLeft(r){const h=r*i.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(h,h+2)}uvUpperRight(r){const h=r*i.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(h,h+2)}origin(r){const h=r*i.FLOATS_PER_ORIGIN;return this._origins.subarray(h,h+i.FLOATS_PER_ORIGIN)}tangent(r){const h=r*i.FLOATS_PER_TANGENT;return this._tangents.subarray(h,h+i.FLOATS_PER_TANGENT)}up(r){const h=r*i.FLOATS_PER_UP;return this._ups.subarray(h,h+i.FLOATS_PER_UP)}get length(){return this._origins.length/i.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}t.GlyphVertices=i,i.FLOATS_PER_TEXCOORD=4,i.FLOATS_PER_ORIGIN=3,i.FLOATS_PER_TANGENT=3,i.FLOATS_PER_UP=3},1058:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=t.Text=t.Projected3DLabel=t.Position3DLabel=t.Position2DLabel=t.LabelRenderPass=t.LabelGeometry=t.Label=t.GlyphVertices=t.FontFace=void 0;var a=i(8296);Object.defineProperty(t,"FontFace",{enumerable:!0,get:function(){return a.FontFace}});var r=i(9495);Object.defineProperty(t,"GlyphVertices",{enumerable:!0,get:function(){return r.GlyphVertices}});var h=i(7188);Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return h.Label}});var _=i(4128);Object.defineProperty(t,"LabelGeometry",{enumerable:!0,get:function(){return _.LabelGeometry}});var d=i(265);Object.defineProperty(t,"LabelRenderPass",{enumerable:!0,get:function(){return d.LabelRenderPass}});var c=i(5035);Object.defineProperty(t,"Position2DLabel",{enumerable:!0,get:function(){return c.Position2DLabel}});var s=i(5036);Object.defineProperty(t,"Position3DLabel",{enumerable:!0,get:function(){return s.Position3DLabel}});var o=i(135);Object.defineProperty(t,"Projected3DLabel",{enumerable:!0,get:function(){return o.Projected3DLabel}});var l=i(7623);Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return l.Text}});var m=i(967);Object.defineProperty(t,"Typesetter",{enumerable:!0,get:function(){return m.Typesetter}})},7188:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;const a=i(3557),r=i(7564),h=i(3847),_=i(9495),d=i(7623);class c{static devicePixelRatio(){return window===void 0||typeof window.devicePixelRatio!="number"?1:window.devicePixelRatio}constructor(o,l,m){this._alignment=c.Alignment.Left,this._lineAnchor=c.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=c.Unit.World,this._color=new h.Color(c.DEFAULT_COLOR),this._altered=Object.assign(new r.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=c.Elide.None,this._ellipsis=c.DEFAULT_ELLIPSIS,this._text=o,this._type=l,this._staticTransform=a.mat4.create(),this._dynamicTransform=a.mat4.create(),this._extent=[0,0],m&&(this._fontFace=m)}vertices(){return new _.GlyphVertices(this.length+this.ellipsis.length)}charAt(o){return this._text.charAt(o)}charCodeAt(o){return this._text.charCodeAt(o)}lineFeedAt(o){return this.charAt(o)===this.lineFeed}kerningBefore(o){return o<1||o>this.length?NaN:this._fontFace.kerning(this.charCodeAt(o-1),this.charCodeAt(o))}kerningAfter(o){return o<0||o>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(o),this.charCodeAt(o+1))}advance(o){return o<0||o>this.length?NaN:this._fontFace.glyph(this.charCodeAt(o)).advance}toString(){return this._text instanceof d.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(o){this._altered.alter("text"),this._text=o}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof d.Text?this._text.lineFeed:d.Text.DEFAULT_LINE_FEED}set wrap(o){this._wrap=o}get wrap(){return this._wrap}set elide(o){this._elide=o}get elide(){return this._elide}set ellipsis(o){this._ellipsis!==o&&(this._ellipsis=o,this._elide!==c.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(o){this._lineWidth!==o&&(this._lineWidth=o,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(o){this._alignment!==o&&(this._alignment=o,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(o){this._lineAnchor!==o&&(this._lineAnchor=o,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(o){this._fontSize!==o&&(this._fontSize=o,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(o){this._fontSizeUnit!==o&&(this._fontSizeUnit=o,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(o){this._fontFace!==o&&(this._fontFace=o,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(o){this._color.equals(o)||(this._color=o,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(o){this._backgroundColor.equals(o)||(this._backgroundColor=o,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(o){a.mat4.equals(this._staticTransform,o)||(this._staticTransform=o,this._altered.alter("static"))}get staticTransform(){const o=this.fontSize/this._fontFace.size,l=a.mat4.create();return a.mat4.scale(l,this._staticTransform,a.vec3.fromValues(o,o,o)),l}set dynamicTransform(o){this._altered.alter("dynamic"),this._dynamicTransform=o}get dynamicTransform(){return this._dynamicTransform}set extent(o){this._extent=o}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return this._fontFace!==void 0&&this._fontFace.glyphTexture.valid&&this._text.length>0}}t.Label=c,c.DEFAULT_COLOR=[.1098,.4588,.7373,1],c.DEFAULT_ELLIPSIS="...",function(s){(function(o){o.Static="static",o.Dynamic="dynamic"})(s.Type||(s.Type={})),function(o){o.None="none",o.Left="left",o.Middle="middle",o.Right="right"}(s.Elide||(s.Elide={})),function(o){o.Left="left",o.Center="center",o.Right="right"}(s.Alignment||(s.Alignment={})),function(o){o.Top="top",o.Ascent="ascent",o.Center="center",o.Baseline="baseline",o.Descent="descent",o.Bottom="bottom"}(s.LineAnchor||(s.LineAnchor={})),function(o){o.World="world",o.Pixel="pixel",o.Mixed="mixed"}(s.Unit||(s.Unit={}))}(c||(t.Label=c={}))},4128:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelGeometry=void 0;const r=i(9504),h=i(7340),_=i(638),d=i(4127);class c extends _.Geometry{constructor(o,l){super(o,l),this._numberOfGlyphs=0,(0,r.assert)(o.isWebGL2||o.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),l=l!==void 0&&l!==""?l:this.constructor.name,this._vertices=new h.Buffer(o,`${l}VBO`),this._buffers.push(this._vertices),this._texCoords=new h.Buffer(o,`${l}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new h.Buffer(o,`${l}OriginVBO`),this._buffers.push(this._origins),this._tangents=new h.Buffer(o,`${l}TangentVBO`),this._buffers.push(this._tangents),this._ups=new h.Buffer(o,`${l}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const o=this.context.gl,l=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,o.FLOAT,!1,8,0,!0,!1),l.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,o.FLOAT,!1,16,0,!0,!1),l.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,o.FLOAT,!1,12,0,!0,!1),l.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,o.FLOAT,!1,12,0,!0,!1),l.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,o.FLOAT,!1,12,0,!0,!1),l.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(o=0,l=1,m=2,v=3,f=4){this._vertexLocation=o,this._texCoordLocation=l,this._originLocation=m,this._tangentLocation=v,this._upLocation=f;const b=this.context.gl,x=super.initialize([b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER]);return this._vertices.data(c.VERTICES,b.STATIC_DRAW),x}update(o,l,m,v){this._numberOfGlyphs=o.length/3;const f=this.context.gl;this._texCoords.data(v,f.STATIC_DRAW),this._origins.data(o,f.STATIC_DRAW),this._tangents.data(l,f.STATIC_DRAW),this._ups.data(m,f.STATIC_DRAW)}draw(o=0,l=0){const m=this.context.gl,v=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,m.FLOAT,!1,16,16*o,!0,!1),this._origins.attribEnable(this._originLocation,3,m.FLOAT,!1,12,12*o,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,m.FLOAT,!1,12,12*o,!0,!1),this._ups.attribEnable(this._upLocation,3,m.FLOAT,!1,12,12*o,!0,!1),v.drawArraysInstanced(m.TRIANGLE_STRIP,0,4,l)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const o=this._vertices&&this._vertices.valid,l=this._texCoords&&this._texCoords.valid,m=this._origins&&this._origins.valid,v=this._tangents&&this._tangents.valid,f=this._ups&&this._ups.valid;return this.initialized&&o&&l&&m&&v&&f}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}t.LabelGeometry=c,c.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),a([d.Initializable.assert_initialized()],c.prototype,"draw",null)},265:function(p,t,i){var a=this&&this.__decorate||function(O,S,w,P){var N,k=arguments.length,j=k<3?S:P===null?P=Object.getOwnPropertyDescriptor(S,w):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(O,S,w,P);else for(var U=O.length-1;U>=0;U--)(N=O[U])&&(j=(k<3?N(j):k>3?N(S,w,j):N(S,w))||j);return k>3&&j&&Object.defineProperty(S,w,j),j};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelRenderPass=void 0;const r=i(3557),h=i(9504),_=i(7564),d=i(4127),c=i(4168),s=i(771),o=i(8593),l=i(9495),m=i(7188),v=i(4128),f=i(5035),b=i(5036),x=i(135);class E extends d.Initializable{constructor(S){super(),this._altered=Object.assign(new _.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=E.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=S,this._depthFunc=S.gl.LESS,this._program=new c.Program(S,"LabelRenderProgram"),this._geometry=new v.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=E.DEFAULT_AA_STEP_SCALE}prepare(){const S=this._camera.viewport;for(let P=0;P<this._labels.length;++P){const N=this._labels[P];let k;const j=this._altered.labels&&this._verticesPerLabel[P]===void 0;N instanceof f.Position2DLabel?(N.frameSize=S,k=N.typeset(j)):N instanceof x.Projected3DLabel?(N.camera=this._camera,k=N.typeset(j)):N instanceof b.Position3DLabel&&(k=N.typeset(j)),k===void 0?k=this._verticesPerLabel[P]:this._verticesPerLabel[P]=k;const U=P>0?this._ranges[P-1][1]:0,H=U+(k===void 0?0:k.length);this._ranges[P]=[U,H]}const w=l.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(w.origins,w.tangents,w.ups,w.texCoords)}draw(){const S=this._context.gl,w=[0,0];let P,N;const k=r.mat4.create();for(let j=0;j<this._labels.length;++j){const U=this._labels[j];if(w[1]=this._ranges[j][1],w[0]===w[1]||j<this._labels.length-1&&!U.valid)continue;const H=j<this._labels.length-1?this._labels[j+1]:void 0,Z=H&&U.type===m.Label.Type.Static&&H.type===m.Label.Type.Static,K=H&&U.color.equals(H.color),ee=H&&U.fontFace===H.fontFace,re=H&&U.fontSizeUnit===H.fontSizeUnit;if(H&&(this._ranges[j+1][0]===this._ranges[j+1][1]||Z&&K&&ee&&re))continue;const J=U.type===m.Label.Type.Dynamic;switch(S.uniform1i(this._uDynamic,J),J&&S.uniformMatrix4fv(this._uTransform,!1,U.dynamicTransform),P!==void 0&&P.equals(U.color)||(S.uniform4fv(this._uColor,U.color.rgbaF32),P=U.color),N!==U.fontFace&&(U.fontFace.glyphTexture.bind(S.TEXTURE0),N=U.fontFace),U.fontSizeUnit){case m.Label.Unit.Pixel:S.uniformMatrix4fv(this._uViewProjection,!1,k);break;case m.Label.Unit.World:case m.Label.Unit.Mixed:default:S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(w[0],w[1]-w[0]),w[0]=w[1]}}initialize(){const S=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const w=new s.Shader(this._context,S.VERTEX_SHADER,"glyph.vert");w.initialize(i(1616));const P=new s.Shader(this._context,S.FRAGMENT_SHADER,"glyph.frag");return P.initialize(i(5389)),this._program.initialize([w,P],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),S.uniform1i(this._program.uniform("u_glyphs"),0),S.uniform1f(this._uAAStepScale,this._aaStepScale),S.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(S=!1){const w=this._context.gl;this._program.bind(),(S||this._altered.camera||this._camera.altered)&&w.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(S||this._altered.aaStepScale)&&w.uniform1f(this._uAAStepScale,this._aaStepScale),(S||this._altered.aaSampling)&&w.uniform1i(this._uAASampling,this._aaSampling);let P=S||this._altered.labels||this._altered.camera||this._camera.altered,N=0;for(;P===!1&&N<this._labels.length;)P=this._labels[N].altered,++N;P&&this.prepare(),this._altered.reset()}frame(){if(this._geometry.numGlyphs===0||this._labels.length===0)return;(0,h.assert)(this._target&&this._target.valid,"valid target expected");const S=this._context.gl,w=this._target.size;S.viewport(0,0,w[0],w[1]),S.enable(S.DEPTH_TEST),S.depthFunc(this._depthFunc),this._depthMask===!1&&S.depthMask(this._depthMask),S.enable(S.BLEND),S.blendFuncSeparate(S.SRC_ALPHA,S.ONE_MINUS_SRC_ALPHA,S.ONE,S.ONE_MINUS_SRC_ALPHA),this._program.bind(),S.uniform2fv(this._uNdcOffset,this._ndcOffset),S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),S.bindTexture(S.TEXTURE_2D,o.Texture2D.DEFAULT_TEXTURE),this._depthMask===!1&&S.depthMask(!0),S.depthFunc(S.LESS),S.disable(S.DEPTH_TEST),S.disable(S.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(S){this.assertInitialized(),this._target=S}set ndcOffset(S){this.assertInitialized(),this._ndcOffset=S}set camera(S){this.assertInitialized(),this._camera!==S&&(this._camera=S,this._altered.alter("camera"))}set depthMask(S){this._depthMask=S}get depthMask(){return this._depthMask}set depthFunc(S){this._depthFunc=S}get depthFunc(){return this._depthFunc}set labels(S){this._labels=S,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(S){this._aaStepScale!==S&&(this._aaStepScale=S,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(S){this._aaSampling!==S&&(this._aaSampling=S,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}t.LabelRenderPass=E,E.DEFAULT_AA_STEP_SCALE=.6666,a([d.Initializable.initialize()],E.prototype,"initialize",null),a([d.Initializable.uninitialize()],E.prototype,"uninitialize",null),a([d.Initializable.assert_initialized()],E.prototype,"update",null),a([d.Initializable.assert_initialized()],E.prototype,"frame",null),a([d.Initializable.assert_initialized()],E.prototype,"unbind",null),function(O){(function(S){S[S.None=0]="None",S[S.Smooth1=1]="Smooth1",S[S.Horizontal3=2]="Horizontal3",S[S.Vertical3=3]="Vertical3",S[S.Grid3x3=4]="Grid3x3",S[S.Grid4x4=5]="Grid4x4"})(O.Sampling||(O.Sampling={}))}(E||(t.LabelRenderPass=E={}))},5035:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position2DLabel=void 0;const a=i(3557),r=i(9504),h=i(5150),_=i(9495),d=i(7188),c=i(967);class s extends d.Label{constructor(l,m,v){super(l,m,v),this._position=a.vec2.fromValues(0,0),this._direction=a.vec2.fromValues(1,0),this._frameSize=a.vec2.create(),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Pixel}typeset(l=!1){const m=l||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!l)return;if(!this.valid)return new _.GlyphVertices(0);const v=a.vec4.create(),f=a.mat4.create();a.mat4.translate(f,(0,h.m4)(),a.vec3.fromValues(-1,-1,0)),a.mat4.scale(f,f,a.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const b=a.vec2.sub((0,h.v2)(),a.vec2.fromValues(this._frameSize[0],this._frameSize[1]),a.vec2.fromValues(v[3]+v[1],v[2]+v[0])),x=a.vec3.fromValues(.5*b[0],.5*b[1],0);a.vec3.add(x,x,a.vec3.fromValues(v[3],v[2],0)),a.mat4.translate(f,f,x),a.mat4.translate(f,f,a.vec3.fromValues(this._position[0],this._position[1],0));const E=a.vec2.fromValues(1,0);let O=a.vec2.angle(E,this._direction);switch(E[0]*this._direction[1]-E[1]*this._direction[0]<0&&(O=-O),a.mat4.rotateZ(f,f,O),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(f),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=a.mat4.clone(f)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const S=this.vertices();return c.Typesetter.typeset(this,S),S}set frameSize(l){a.vec2.equals(this._frameSize,l)||(a.vec2.max(this._frameSize,l,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(l){a.vec2.equals(this._position,l)||(this._position=a.vec2.clone(l),this._altered.alter(this._type))}get position(){return this._position}set direction(l){a.vec2.normalize(this._direction,l),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(l){(0,r.logIf)(l!==d.Label.Unit.Pixel,r.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${l}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position2DLabel=s,s.DEFAULT_FONTSIZE_PX=20},5036:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position3DLabel=void 0;const a=i(3557),r=i(9504),h=i(5150),_=i(9495),d=i(7188),c=i(967);class s extends d.Label{constructor(l,m,v){super(l,m,v),this._position=a.vec3.fromValues(0,0,0),this._direction=a.vec3.fromValues(1,0,0),this._up=a.vec3.fromValues(0,1,0),this._fontSize=s.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=d.Label.Unit.World}typeset(l=!1){const m=l||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!l)return;if(!this.valid)return new _.GlyphVertices(0);const v=a.mat4.create();a.mat4.translate(v,(0,h.m4)(),this._position);const f=a.vec3.cross((0,h.v3)(),this._direction,this._up),b=a.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,f[0],f[1],f[2],0,0,0,0,1);switch(a.mat4.mul(v,v,b),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(v),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=a.mat4.clone(v)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const x=this.vertices();return c.Typesetter.typeset(this,x),x}set position(l){this._position=a.vec3.clone(l),this._altered.alter(this._type)}get position(){return this._position}set direction(l){a.vec3.normalize(this._direction,l),this._altered.alter(this._type)}get direction(){return this._direction}set up(l){this._up=a.vec3.normalize(this._up,l),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(l){(0,r.logIf)(l!==d.Label.Unit.World,r.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${l}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position3DLabel=s,s.DEFAULT_FONTSIZE_WORLD=.05},135:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Projected3DLabel=void 0;const a=i(3557),r=i(9504),h=i(5150),_=i(9495),d=i(7188),c=i(967);class s extends d.Label{constructor(l,m,v){super(l,m,v),this._position=a.vec3.fromValues(0,0,0),this._direction=a.vec2.fromValues(1,0),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Mixed}typeset(l=!1){const m=l||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!l)return;if(!this.valid||this._camera===void 0)return new _.GlyphVertices(0);const v=a.vec4.create(),f=a.mat4.create();a.mat4.translate(f,f,a.vec3.fromValues(-1,-1,0)),a.mat4.scale(f,f,a.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),a.mat4.scale(f,f,a.vec3.fromValues(1,1,1));const b=a.vec2.create();a.vec2.sub(b,a.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),a.vec2.fromValues(v[3]+v[1],v[2]+v[0]));const x=a.vec3.fromValues(.5*b[0],.5*b[1],0);a.vec3.add(x,x,a.vec3.fromValues(v[3],v[2],0)),a.mat4.translate(f,f,x);const E=a.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);a.vec4.transformMat4(E,E,this._camera.viewProjection);const O=a.mat4.create(),S=E[3];a.mat4.translate(O,O,a.vec3.fromValues(E[0]/S,E[1]/S,E[2]/S)),a.mat4.mul(f,O,f);const w=a.vec2.fromValues(1,0);let P=a.vec2.angle(w,this._direction);switch(w[0]*this._direction[1]-w[1]*this._direction[0]<0&&(P=-P),a.mat4.rotateZ(f,f,P),this._camera.viewProjectionInverse?a.mat4.mul(f,this._camera.viewProjectionInverse,f):(0,r.log)(r.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case d.Label.Type.Static:this.staticTransform=a.mat4.clone(f),this.dynamicTransform=(0,h.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,h.m4)(),this.dynamicTransform=a.mat4.clone(f)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const N=this.vertices();return c.Typesetter.typeset(this,N),N}set camera(l){this._camera=l,this._altered.alter(this._type)}get camera(){return this._camera}set position(l){this._position=a.vec3.clone(l),this._altered.alter(this._type)}get position(){return this._position}set direction(l){a.vec2.normalize(this._direction,l),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(l){(0,r.logIf)(l!==d.Label.Unit.Mixed,r.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${l}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Projected3DLabel=s,s.DEFAULT_FONTSIZE_PX=20},7623:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;class i{constructor(r,h){this._lineFeed=i.DEFAULT_LINE_FEED,this._altered=!1,this._text=r||"",this._lineFeed=h!==void 0?h:this._lineFeed}get length(){return this._text.length}charAt(r){return this._text.charAt(r)}charCodeAt(r){return this._text.charCodeAt(r)}set text(r){this._text!==r&&(this._altered=!0,this._text=r)}get text(){return this._text}set lineFeed(r){this._lineFeed!==r&&(this._altered=!0,this._lineFeed=r)}get lineFeed(){return this._lineFeed}set altered(r){this._altered=r}get altered(){return this._altered}}t.Text=i,i.DEFAULT_LINE_FEED=`
`},967:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=void 0;const a=i(3557),r=i(9504),h=i(5150),_=i(7188);class d{static writeVertex(s,o,l,m,v){if(m===void 0||l.depictable()===!1)return;const f=s.glyphTexturePadding,b=m.origin(v);a.vec3.set(b,o[0],o[1],0),b[0]+=l.bearing[0]-f[3],b[1]+=l.bearing[1]-l.extent[1],a.vec3.set(m.tangent(v),l.extent[0],0,0),a.vec3.set(m.up(v),0,l.extent[1],0);const x=m.uvLowerLeft(v);a.vec2.copy(x,l.subTextureOrigin);const E=m.uvUpperRight(v);a.vec2.add(E,l.subTextureOrigin,l.subTextureExtent)}static lineAnchorOffset(s){let o=0;const l=s.fontFace.glyphTexturePadding,m=s.fontFace;switch(s.lineAnchor){case _.Label.LineAnchor.Ascent:o=m.ascent-l[0];break;case _.Label.LineAnchor.Descent:o=m.descent*(1+l[0]/m.ascent);break;case _.Label.LineAnchor.Center:o=m.ascent-l[0]-.5*m.size;break;case _.Label.LineAnchor.Top:o=m.ascent-l[0]+.5*m.lineGap;break;case _.Label.LineAnchor.Bottom:o=m.ascent-l[0]+.5*m.lineGap-m.lineHeight;break;case _.Label.LineAnchor.Baseline:default:o=-l[0]}return o}static advances(s,o){(0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve advances"),o===void 0&&(o=s.text.text);const l=new Float32Array(o.length);for(let m=0;m<o.length;++m){const v=o.charCodeAt(m);l[m]=s.fontFace.glyph(v).advance}return l}static kernings(s,o){if((0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve kernings"),o===void 0){const v=new Float32Array(s.length);for(let f=0;f<s.length;++f){const b=s.kerningAfter(f);v[f]=isNaN(b)?0:b}return v}const l=new Float32Array(o.length);for(let v=0;v<o.length;++v){const f=(m=v)<0||m>o.length-1?NaN:s.fontFace.kerning(o.charCodeAt(m),o.charCodeAt(m+1));l[v]=isNaN(f)?0:f}var m;return l}static fragments(s){const o=new Array;let l,m=0;for(let v=0;v<s.length;++v){if(l=d.DELIMITERS.indexOf(s.charAt(v))>-1,!l)continue;m<v&&o.push([m,v,d.FragmentType.Word]);const f=s.lineFeedAt(v)?d.FragmentType.LineFeed:d.FragmentType.Delimiter;o.push([v,v+1,f]),m=v+1}return l||o.push([m,s.length,d.FragmentType.Word]),o}static fragmentWidths(s,o,l){const m=new Float32Array(s.length);for(let v=0;v<s.length;++v){const f=s[v];m[v]=o.subarray(f[0],f[1]).reduce((b,x,E)=>b+x+(E<f[1]?l[E+f[0]]:0),0)}return m}static elideThresholds(s,o){switch(s.elide){case _.Label.Elide.Right:return[s.lineWidth-o,0];case _.Label.Elide.Middle:const l=s.lineWidth/2-o/2;return[l,l];case _.Label.Elide.Left:return[0,s.lineWidth-o];default:return[0,0]}}static elideFragments(s,o,l,m,v,f){const b=new Array,x=new Array;let E=0,O=0;for(let S=f?o.length-1:0;f?S>-1:S<o.length;f?--S:++S){const w=o[S];if(w[2]!==d.FragmentType.LineFeed){if(!(E+l[S]<s)){if(w[2]===d.FragmentType.Delimiter||E+m[f?w[1]-1:w[0]]>s)break;for(let P=f?w[1]-1:w[0];f?P>=w[0]:P<w[1];f?--P:++P){if(!(E+O+m[P]+v[P]<s)){b.push([f?P+1:w[0],f?w[1]:P,w[2]]),x.push(O);break}O+=m[P]+v[P]}break}E+=l[S],b.push(w),x.push(l[S])}}return[b,x,E+O]}static transformVertices(s,o,l,m){if(o!==void 0&&!a.mat4.equals(s,a.mat4.create()))for(let v=l;v<m;++v){const f=o.origin(v),b=(0,h.v3)();a.vec3.transformMat4(b,f,s);const x=(0,h.v3)();a.vec3.transformMat4(x,a.vec3.add(x,f,o.tangent(v)),s);const E=(0,h.v3)();a.vec3.transformMat4(E,a.vec3.add(E,f,o.up(v)),s),a.vec3.copy(o.origin(v),b),a.vec3.sub(o.tangent(v),x,b),a.vec3.sub(o.up(v),E,b)}}static updateRectangleMinMax(s,o){(0,r.assert)(s.length===6&&o.length===6,"expected the rectangles to have 6 values!");let l=0;for(;l<3;l++)s[l]=Math.min(s[l],o[l]);for(;l<6;l++)s[l]=Math.max(s[l],o[l])}static minMax(s,o,l){const m=Math.min(s,...l),v=Math.max(o,...l);return a.vec2.fromValues(m,v)}static getMinMaxVertices(s,o,l){let m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(let O=o;O<l;++O){const S=d.minMax(m,v,[s.origin(O)[0],s.origin(O)[0]+s.up(O)[0],s.origin(O)[0]+s.tangent(O)[0]]);m=S[0],v=S[1];const w=d.minMax(f,b,[s.origin(O)[1],s.origin(O)[1]+s.up(O)[1],s.origin(O)[1]+s.tangent(O)[1]]);f=w[0],b=w[1];const P=d.minMax(x,E,[s.origin(O)[2],s.origin(O)[2]+s.up(O)[2],s.origin(O)[2]+s.tangent(O)[2]]);x=P[0],E=P[1]}return[m,f,x,v,b,E]}static transformAlignment(s,o,l,m,v){if(l===void 0||o===_.Label.Alignment.Left)return;let f=-s;o===_.Label.Alignment.Center&&(f*=.5);for(let b=m;b<v;++b)l.origin(b)[0]+=f}static transform(s,o,l){const m=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const S of l)d.transformAlignment(S[2],s.alignment,o,S[0],S[1]),d.updateRectangleMinMax(m,d.getMinMaxVertices(o,S[0],S[1])),d.transformVertices(s.staticTransform,o,S[0],S[1]);const v=m[3]-m[0],f=m[4]-m[1],b=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(0,0,0,1),s.staticTransform),x=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(v,0,0,1),s.staticTransform),E=a.vec4.transformMat4(a.vec4.create(),a.vec4.fromValues(0,f,0,1),s.staticTransform),O=a.vec2.fromValues(a.vec4.distance(x,b),a.vec4.distance(E,b));s.extent=[O[0],O[1]]}static typeset(s,o){if(s.length===0)return 0;(0,r.assert)(s.fontFace!==void 0,"expected a font face for label before typesetting");const l=s.fontFace,m=k=>k<s.length?l.glyph(s.charCodeAt(k)):l.glyph(s.ellipsis.charCodeAt(k-s.length)),v=d.advances(s),f=d.kernings(s),b=d.fragments(s),x=d.fragmentWidths(b,v,f),E=a.vec2.fromValues(0,-d.lineAnchorOffset(s)),O=new Array;let S=0;const w=s.elide!==_.Label.Elide.None,P=(k,j,U=NaN,H=v,Z=f,K=0)=>{let ee=S;for(let re=0;re<k.length;++re){const J=k[re];if(J[0]>=J[1])continue;const ne=!w&&J[2]===d.FragmentType.LineFeed;let he=!1;if(!w&&!ne&&s.wrap){const fe=J[2]!==d.FragmentType.Delimiter||m(J[0]).depictable(),be=J[2]===d.FragmentType.Word&&re<k.length-1&&k[re+1][2]===d.FragmentType.Delimiter&&m(k[re+1][0]).depictable();he=E[0]+(fe?j[re]:0)+(be?j[re+1]:0)>s.lineWidth}if(!ne&&!he||(O.push([ee,S,E[0]]),ee=S,E[0]=0,E[1]-=l.lineHeight,!ne))for(let fe=J[0];fe<J[1];++fe)m(fe).depictable()&&(d.writeVertex(l,E,m(fe),o,S),++S),E[0]+=H[fe-K]+Z[fe-K]}ee<S&&O.push([ee,S,E[0]])},N=x.reduce((k,j)=>k+j,0);if(w&&N>s.lineWidth){const k=[[s.length,s.length+s.ellipsis.length,d.FragmentType.Word]],j=d.advances(s,s.ellipsis),U=d.kernings(s,s.ellipsis),H=d.fragmentWidths([[0,s.ellipsis.length,d.FragmentType.Word]],j,U),Z=H[0];if(s.lineWidth<Z)return 0;const K=d.elideThresholds(s,Z),[ee,re,J]=d.elideFragments(K[0],b,x,v,f,!1);s.elide===_.Label.Elide.Middle&&(K[1]+=K[0]-J);const[ne,he]=d.elideFragments(K[1],b,x,v,f,!0);P(ee,new Float32Array(re)),P(k,H,NaN,j,U,s.length),P(ne.reverse(),new Float32Array(he.reverse())),(0,r.assert)(O.length<4,`expected at most 3-line-yield from advance, given ${O}`),O[0][1]=O[O.length-1][1],O[0][2]=E[0],O.length=1}else P(b,x,s.lineWidth);return d.transform(s,o,O),o.shrink(S),S}}t.Typesetter=d,d.DELIMITERS=`
 ,.-/()[]<>`,function(c){(function(s){s[s.Word=0]="Word",s[s.Delimiter=1]="Delimiter",s[s.LineFeed=2]="LineFeed"})(c.FragmentType||(c.FragmentType={}))}(d||(t.Typesetter=d={}))},8593:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2D=void 0;const r=i(9504),h=i(3513),_=i(4127),d=i(9965);class c extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(o,l,m,v,f){(0,r.assert)(o>0&&l>0,"texture requires valid width and height of greater than zero");const b=this._context.gl,x=this._context.gl2facade;if(this._object=b.createTexture(),this._width=o,this._height=l,this._internalFormat=m,this._format=v,this._type=f,b.bindTexture(b.TEXTURE_2D,this._object),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),c.MAX_ANISOTROPY===void 0)if(this._context.supportsTextureFilterAnisotropic){const E=this._context.textureFilterAnisotropic;c.MAX_ANISOTROPY=b.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else c.MAX_ANISOTROPY=0;return x.texImage2D(b.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),b.bindTexture(b.TEXTURE_2D,c.DEFAULT_TEXTURE),this._valid=b.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const o=this.context.gl,l=this._context.gl2facade;let m=this._width*this._height*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===l.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_2D,this._object)}unbind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_2D,c.DEFAULT_TEXTURE)}fetch(o,l=!1,m=!1){const v=this.context.gl;return new Promise((f,b)=>{const x=new Image;x.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${x.src}' failed`),b()},x.onload=()=>{this.resize(x.width,x.height),m||v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data(x),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),f()},l&&(x.crossOrigin="anonymous"),x.src=o})}data(o,l=!0,m=!0){const v=this.context.gl,f=this._context.gl2facade;l&&this.bind(),f.texImage2D(v.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,o),this._anisotropy!==void 0&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),m&&this.unbind(),this.reallocate()}filter(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),(0,r.logIf)(o===f.LINEAR_MIPMAP_LINEAR||o===f.LINEAR_MIPMAP_NEAREST,r.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,l),this._mipmap=l===f.LINEAR_MIPMAP_LINEAR||l===f.LINEAR_MIPMAP_NEAREST,this._mipmap&&f.generateMipmap(f.TEXTURE_2D),v&&this.unbind()}wrap(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,l),v&&this.unbind()}reformat(o,l,m,v=!0,f=!0){(o!==this._internalFormat||l!==void 0&&l!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,l&&(this._format=l),m&&(this._type=m),this.data(void 0,v,f))}resize(o,l,m=!0,v=!0){o===this._width&&l===this._height||(this._width=o,this._height=l,this.data(void 0,m,v))}generateMipMap(o=!0,l=!0){const m=this.context.gl;o&&this.bind(),m.generateMipmap(m.TEXTURE_2D),l&&this.unbind(),this._mipmap=!0}maxAnisotropy(o,l=!0,m=!0){if(this._context.supportsTextureFilterAnisotropic===!1)return void(0,r.log)(r.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const v=this.context.gl,f=this._context.textureFilterAnisotropic;return this._anisotropy=o===void 0?void 0:Math.max(0,Math.min(c.MAX_ANISOTROPY,o)),(0,r.logIf)(o!==this._anisotropy,r.LogLevel.Debug,`value clamped to max supported anisotropy of ${c.MAX_ANISOTROPY}, given ${o}`),l&&this.bind(),v.texParameterf(v.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy===void 0?0:this._anisotropy),this.generateMipMap(!1,m),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}t.Texture2D=c,c.DEFAULT_TEXTURE=void 0,c.MAX_ANISOTROPY=void 0,a([_.Initializable.assert_initialized()],c.prototype,"bind",null),a([_.Initializable.assert_initialized()],c.prototype,"unbind",null),a([_.Initializable.assert_initialized()],c.prototype,"fetch",null),a([_.Initializable.assert_initialized()],c.prototype,"data",null),a([_.Initializable.assert_initialized()],c.prototype,"filter",null),a([_.Initializable.assert_initialized()],c.prototype,"wrap",null),a([_.Initializable.assert_initialized()],c.prototype,"reformat",null),a([_.Initializable.assert_initialized()],c.prototype,"resize",null)},7380:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2DArray=void 0;const r=i(9504),h=i(3513),_=i(4127),d=i(9965);class c extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,l,m,v,f,b){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(o>0&&l>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=l,this._depth=m,this._internalFormat=v,this._format=f,this._type=b,x.bindTexture(x.TEXTURE_2D_ARRAY,this._object),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_2D_ARRAY,c.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,l=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===l.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_2D_ARRAY,this._object)}unbind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_2D_ARRAY,c.DEFAULT_TEXTURE)}fetch(o,l,m=!1){return new Promise((v,f)=>{const b=new Image;b.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${b.src}' failed`),f()},b.onload=()=>{this.resize(b.width,b.height/l,l),this.data(b),v()},m&&(b.crossOrigin="anonymous"),b.src=o})}data(o,l=!0,m=!0){const v=this.context.gl,f=this._context.gl2facade;l&&this.bind(),f.texImage3D(v.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),m&&this.unbind(),this.reallocate()}filter(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_2D_ARRAY,f.TEXTURE_MAG_FILTER,o),f.texParameteri(f.TEXTURE_2D_ARRAY,f.TEXTURE_MIN_FILTER,l),v&&this.unbind()}wrap(o,l,m,v=!0,f=!0){const b=this.context.gl;v&&this.bind(),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_S,o),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_T,l),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_R,m),f&&this.unbind()}reformat(o,l,m,v=!0,f=!0){(o!==this._internalFormat||l!==void 0&&l!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,l&&(this._format=l),m&&(this._type=m),this.data(void 0,v,f))}resize(o,l,m,v=!0,f=!0){o===this._width&&l===this._height&&m===this._depth||(this._width=o,this._height=l,this._depth=m,this.data(void 0,v,f))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture2DArray=c,c.DEFAULT_TEXTURE=void 0,a([_.Initializable.assert_initialized()],c.prototype,"bind",null),a([_.Initializable.assert_initialized()],c.prototype,"unbind",null),a([_.Initializable.assert_initialized()],c.prototype,"fetch",null),a([_.Initializable.assert_initialized()],c.prototype,"data",null),a([_.Initializable.assert_initialized()],c.prototype,"filter",null),a([_.Initializable.assert_initialized()],c.prototype,"wrap",null),a([_.Initializable.assert_initialized()],c.prototype,"reformat",null),a([_.Initializable.assert_initialized()],c.prototype,"resize",null)},9584:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture3D=void 0;const r=i(9504),h=i(3513),_=i(4127),d=i(9965);class c extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(o,l,m,v,f,b){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(o>0&&l>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=o,this._height=l,this._depth=m,this._internalFormat=v,this._format=f,this._type=b,x.bindTexture(x.TEXTURE_3D,this._object),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_3D,c.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const o=this.context.gl,l=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);this._type===l.HALF_FLOAT&&this._internalFormat!==o.RGBA16F?m*=2:this._type===o.FLOAT&&this._internalFormat!==o.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_3D,this._object)}unbind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_3D,c.DEFAULT_TEXTURE)}load(o,l,m=!1,v=!1){return new Promise((f,b)=>{const x=new Image;x.onerror=()=>b(),x.onload=()=>{const E=document.createElement("canvas"),O=E.getContext("2d");let S,w,P,N;if((0,r.assert)(O!==void 0,"expected auxiliary 2D context for temporary slicing"),v===!1){(0,r.assert)(x.height%l==0&&x.height/l>=1,"expected height to be a multitude of number of slices"),S=x.width,w=Math.floor(x.height/l),P=l,E.width=S,E.height=w,N=new Uint8Array(S*w*P);const k=S*w;for(let j=0;j<l;++j){O.drawImage(x,0,w*j,S,w,0,0,S,w);const U=O.getImageData(0,0,S,w).data;for(let H=0;H<k;++H)N[k*j+H]=U[4*H]}}else{(0,r.assert)(x.width%l==0&&x.width/l>=1,"expected width to be a multitude of number of slices"),S=Math.floor(x.width/l),w=x.height,P=l,E.width=S,E.height=w,N=new Uint8Array(S*w*P);const k=S*w;for(let j=0;j<l;++j){O.drawImage(x,S*j,0,S,w,0,0,S,w);const U=O.getImageData(0,0,S,w).data;for(let H=0;H<k;++H)N[k*j+H]=U[4*H]}}this.resize(S,w,P),this.data(N),f()},m&&(x.crossOrigin="anonymous"),x.src=o})}loadFromSingleImages(o,l,m=!1,v=!1){return new Promise((f,b)=>{const x=document.createElement("canvas"),E=x.getContext("2d"),O=[];let S,w;for(let P=0;P<o.length;P++){const N=new Image;N.onerror=()=>b();const k=new Promise((j,U)=>{try{N.onload=()=>{const H=N.width,Z=N.height;v===!1?(S===void 0?(S=H*o.length,x.width=S):(0,r.assert)(H*o.length===S,"The single images do not have the same width"),w===void 0?(w=Z,x.height=w):(0,r.assert)(Z===w,"The single images do not have the same height"),E.drawImage(N,H*P,0)):(S===void 0?(S=H,x.width=S):(0,r.assert)(H===S,"The single images do not have the same width"),w===void 0?(w=Z*o.length,x.height=w):(0,r.assert)(Z*o.length===w,"The single images do not have the same height"),E.drawImage(N,0,Z*P)),j()}}catch(H){U(H)}});O.push(k),m&&(N.crossOrigin="anonymous"),N.src=o[P]}Promise.all(O).then(()=>{const P=x.toDataURL("image/png",1);return this.load(P,l,m,v).then(()=>{f()})})})}data(o,l=!0,m=!0){const v=this.context.gl,f=this._context.gl2facade;l&&this.bind(),f.texImage3D(v.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,o),m&&this.unbind(),this.reallocate()}filter(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,o),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,l),v&&this.unbind()}wrap(o,l,m,v=!0,f=!0){const b=this.context.gl;v&&this.bind(),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_S,o),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_T,l),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_R,m),f&&this.unbind()}reformat(o,l,m,v=!0,f=!0){(o!==this._internalFormat||l!==void 0&&l!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,l&&(this._format=l),m&&(this._type=m),this.data(void 0,v,f))}resize(o,l,m,v=!0,f=!0){o===this._width&&l===this._height&&m===this._depth||(this._width=o,this._height=l,this._depth=m,this.data(void 0,v,f))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture3D=c,c.DEFAULT_TEXTURE=void 0,a([_.Initializable.assert_initialized()],c.prototype,"bind",null),a([_.Initializable.assert_initialized()],c.prototype,"unbind",null),a([_.Initializable.assert_initialized()],c.prototype,"load",null),a([_.Initializable.assert_initialized()],c.prototype,"loadFromSingleImages",null),a([_.Initializable.assert_initialized()],c.prototype,"data",null),a([_.Initializable.assert_initialized()],c.prototype,"filter",null),a([_.Initializable.assert_initialized()],c.prototype,"wrap",null),a([_.Initializable.assert_initialized()],c.prototype,"reformat",null),a([_.Initializable.assert_initialized()],c.prototype,"resize",null)},5186:function(p,t,i){var a=this&&this.__decorate||function(s,o,l,m){var v,f=arguments.length,b=f<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,l):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,o,l,m);else for(var x=s.length-1;x>=0;x--)(v=s[x])&&(b=(f<3?v(b):f>3?v(o,l,b):v(o,l))||b);return f>3&&b&&Object.defineProperty(o,l,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureCube=void 0;const r=i(9504),h=i(3513),_=i(4127),d=i(9965);class c extends d.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(o){const l=this._context.gl;switch(o){case l.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case l.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case l.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case l.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case l.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case l.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return(0,r.assert)(!1,`expected texture cube map identifier (${l.TEXTURE_CUBE_MAP_POSITIVE_X}, ${l.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${l.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${l.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${l.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${l.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${o}`),-1}}create(o,l,m,v){(0,r.assert)(o>0,"texture cube requires valid size (width/height) of greater than zero");const f=this._context.gl,b=this._context.gl2facade;return this._object=f.createTexture(),this._size=o,this._internalFormat=l,this._format=m,this._type=v,f.bindTexture(f.TEXTURE_CUBE_MAP,this._object),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),f.bindTexture(f.TEXTURE_CUBE_MAP,c.DEFAULT_TEXTURE),this._valid=f.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(o,l,m,v,f){const b=document.createElement("canvas");b.width=v,b.height=f;const x=b.getContext("2d");return x?(x.drawImage(o,l,m,v,f,0,0,v,f),x.getImageData(0,0,v,f)):(console.log(r.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(o,l){const m=this.context.gl,v=o.height/2*Math.pow(.5,l),f=[0,0],b=[o.width,o.height];for(let N=0;N<l;++N)b[0]/=2,b[1]/=2,f[0]+=b[0],f[1]+=b[1];m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!0);const x=this.cropImage(o,f[0],f[1],v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_X,x],l);const E=this.cropImage(o,f[0]+v,f[1],v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Z,E],l);const O=this.cropImage(o,f[0]+2*v,f[1],v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_X,O],l);const S=this.cropImage(o,f[0]+3*v,f[1],v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Z,S],l);const w=this.cropImage(o,f[0],f[1]+v,v,v);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Y,w],l);const P=this.cropImage(o,f[0]+v,f[1]+v,v,v);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Y,P],l),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1)}bind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_CUBE_MAP,this._object)}unbind(o){const l=this.context.gl;o&&l.activeTexture(o),l.bindTexture(l.TEXTURE_CUBE_MAP,c.DEFAULT_TEXTURE)}fetch(o,l=!1,m=0){const v=this.context.gl;return new Promise((f,b)=>{const x=new Array;o.positiveX&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_X,o.positiveX]),o.negativeX&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_X,o.negativeX]),o.positiveY&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Y,o.positiveY]),o.negativeY&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Y,o.negativeY]),o.positiveZ&&x.push([v.TEXTURE_CUBE_MAP_POSITIVE_Z,o.positiveZ]),o.negativeZ&&x.push([v.TEXTURE_CUBE_MAP_NEGATIVE_Z,o.negativeZ]);let E=x.length;for(const O of x){const S=new Image;S.crossOrigin="anonymous",S.onerror=()=>b(),S.onload=()=>{const w=this.calculateMipLevelSize(m);S.width===S.height?S.width===w?(v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),this.data([O[0],S],m),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),E-=1,E===0&&f()):(0,r.log)(r.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${w}, given ${S.width}`):(0,r.log)(r.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},l&&(S.crossOrigin="anonymous"),S.src=O[1]}})}fetchMipmapAtlas(o,l=!1){return new Promise((m,v)=>{const f=new Image;f.onerror=()=>v(),f.onload=()=>{if(f.width!==2*f.height)return void(0,r.log)(r.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const b=f.height/2,x=Math.log2(b);for(let E=0;E<x;++E)this.extractMipLevelFromAtlas(f,E);m()},l&&(f.crossOrigin="anonymous"),f.src=o})}calculateMipLevelSize(o){return this._size*Math.pow(.5,o)}data(o,l=0,m=!0,v=!0){const f=this.context.gl,b=this.context.gl2facade,x=this.calculateMipLevelSize(l);let E=x*x*(0,h.byteSizeOfFormat)(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?E*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(E*=4),m&&this.bind(),o instanceof Array&&o.length===2){b.texImage2D(o[0],l,this._internalFormat,x,x,0,this._format,this._type,o[1]);const O=this.faceID(o[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[O]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[O]=E}else{const O=o;O.positiveX!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X,l,this._internalFormat,x,x,0,this._format,this._type,O.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[0]=E),O.negativeX!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_X,l,this._internalFormat,x,x,0,this._format,this._type,O.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[1]=E),O.positiveY!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Y,l,this._internalFormat,x,x,0,this._format,this._type,O.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[2]=E),O.negativeY!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,this._internalFormat,x,x,0,this._format,this._type,O.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[3]=E),O.positiveZ!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Z,l,this._internalFormat,x,x,0,this._format,this._type,O.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[4]=E),O.negativeZ!==void 0&&(b.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,this._internalFormat,x,x,0,this._format,this._type,O.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[5]=E)}v&&this.unbind()}filter(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,o),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,l),v&&this.unbind()}wrap(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_T,l),v&&this.unbind()}levels(o,l,m=!0,v=!0){const f=this.context.gl;m&&this.bind(),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_BASE_LEVEL,o),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAX_LEVEL,l),v&&this.unbind()}reformat(o,l,m,v=!0,f=!0){(o!==this._internalFormat||l!==void 0&&l!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(o!==void 0,"valid internal format expected"),this._internalFormat=o,l&&(this._format=l),m&&(this._type=m),this.data({clearOnUndefined:!0},0,v,f))}resize(o,l=!0,m=!0){o!==this._size&&(this._size=o,this.data({clearOnUndefined:!0},0,l,m))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}t.TextureCube=c,c.DEFAULT_TEXTURE=void 0,a([_.Initializable.assert_initialized()],c.prototype,"bind",null),a([_.Initializable.assert_initialized()],c.prototype,"unbind",null),a([_.Initializable.assert_initialized()],c.prototype,"fetch",null),a([_.Initializable.assert_initialized()],c.prototype,"fetchMipmapAtlas",null),a([_.Initializable.assert_initialized()],c.prototype,"data",null),a([_.Initializable.assert_initialized()],c.prototype,"filter",null),a([_.Initializable.assert_initialized()],c.prototype,"wrap",null),a([_.Initializable.assert_initialized()],c.prototype,"levels",null),a([_.Initializable.assert_initialized()],c.prototype,"reformat",null),a([_.Initializable.assert_initialized()],c.prototype,"resize",null)},5608:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TileCameraGenerator=void 0;const a=i(3557),r=i(5150),h=i(9504);class _{constructor(){this._tileSize=[0,0],this._padding=a.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=_.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(c,s,o,l,m,v,f,b,x,E,O){if(E>0)return O=this.hilbertIndices(c,s,o,l,m,b/2,x/2,v/2,f/2,E-1,O),O=this.hilbertIndices(c,s,o,l+v/2,m+f/2,v/2,f/2,b/2,x/2,E-1,O),O=this.hilbertIndices(c,s,o,l+v/2+b/2,m+f/2+x/2,v/2,f/2,b/2,x/2,E-1,O),this.hilbertIndices(c,s,o,l+v/2+b,m+f/2+x,-b/2,-x/2,-v/2,-f/2,E-1,O);if(m+=(f+x-1)/2,(l+=(v+b-1)/2)<s&&m<o){const S=2*O;c[S+0]=l,c[S+1]=m,++O}return O}static generateHilbertIndices(c,s,o){(0,h.assert)(c.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${c.length}`);const l=Math.max(s,o),m=Math.ceil(Math.log2(l)),v=(0,h.upperPowerOfTwo)(l);this.hilbertIndices(c,s,o,0,0,v,0,0,v,m,0)}static generateScanLineIndices(c,s,o){(0,h.assert)(c.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${c.length}`);for(let l=0;l<o;++l)for(let m=0;m<s;++m){const v=2*(m+l*s);c[v+0]=m,c[v+1]=l}}static generateZCurveIndices(c,s,o){(0,h.assert)(c.length===2*s*o,`expected interleaved indices-array of length ${2*s*o}, given ${c.length}`);const l=Math.max(s,o),m=2*Math.floor(Math.log2(l));let v=0;for(let f=0;f<s*o;++v){let b=0,x=0;for(let E=0;E<m;++E)b+=(v>>2*E&1)<<E,x+=(v>>2*E+1&1)<<E;if(b<s&&x<o){const E=2*f;c[E+0]=b,c[E+1]=x,++f}}}invalidate(c){c&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case _.Algorithm.ScanLine:_.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case _.Algorithm.HilbertCurve:_.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case _.Algorithm.ZCurve:_.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:_.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const c=2*this.tile;return[this._indices[c+0],this._indices[c+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){(0,h.assert)(this._sourceCamera!==void 0,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return(0,h.log)(h.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;(0,h.assert)(this._sourceViewport!==void 0&&this._sourceCamera!==void 0,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const c=this.tableIndices(),s=this.sourceViewport,o=this.getPaddedTileSize(),l=[0,0];l[0]=c[0]*this.tileSize[0]+o[0]/2,l[1]=c[1]*this.tileSize[1]+o[1]/2;const m=[0,0];m[0]=c[0]*this.tileSize[0],m[1]=c[1]*this.tileSize[1];const v=[2*l[0]/s[0]-1,2*l[1]/s[1]-1],f=a.vec3.fromValues(s[0]/o[0],s[1]/o[1],1),b=a.vec3.fromValues(-v[0],-v[1],0),x=a.mat4.scale((0,r.m4)(),a.mat4.identity((0,r.m4)()),f),E=a.mat4.translate((0,r.m4)(),x,b);return this._camera.postViewProjection=E,this._offset=m,m}get valid(){return this._camera!==void 0&&this._sourceCamera!==void 0&&this._valid}get numXTiles(){return(0,h.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return(0,h.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(c){c!==void 0?(this._sourceCamera=c,this._camera=Object.create(c),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(c){this._tile!==c&&(this._tile=c,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(c){this._sourceViewport!==void 0&&c!==void 0&&this._sourceViewport[0]===c[0]&&this._sourceViewport[1]===c[1]||(this._sourceViewport=c,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(c){this._tileSize[0]===c[0]&&this._tileSize[1]===c[1]||(this._tileSize=c,this.invalidate(!0))}get padding(){return this._padding}set padding(c){a.vec4.equals(this._padding,c)||(this._padding=a.vec4.clone(c),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(c){this._algorithm!==c&&(this._algorithm=c,this.invalidate(!0))}}t.TileCameraGenerator=_,function(d){(function(c){c.ScanLine="scanline",c.HilbertCurve="hilbertcurve",c.ZCurve="zcurve"})(d.Algorithm||(d.Algorithm={}))}(_||(t.TileCameraGenerator=_={}))},8870:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TouchEventProvider=void 0;const a=i(7032),r=i(9504);class h{constructor(d,c){(0,r.assert)(d!==void 0,`expected valid canvas element on initialization, given ${d}`),this._element=d,this._timeframe=c}preventDefaultOnEvent(d,c){(0,r.bitInBitfield)(this._preventDefaultMask,d)&&c.preventDefault()}preventDefault(...d){for(const c of d)(0,r.bitInBitfield)(this._preventDefaultMask,c)||(this._preventDefaultMask|=c)}allowDefault(...d){for(const c of d)(0,r.bitInBitfield)(this._preventDefaultMask,c)&&(this._preventDefaultMask&=~c)}observable(d){switch(d){case h.Type.Start:return this.start$;case h.Type.End:return this.end$;case h.Type.Move:return this.move$;case h.Type.Cancel:return this.cancel$}return(0,r.assert)(!1,"Encountered unknown touch event."),new a.Observable}get start$(){return this._startSubject===void 0&&(this._startSubject=new a.ReplaySubject(void 0,this._timeframe),this._startListener=d=>{this.preventDefaultOnEvent(h.Type.Start,d),this._startSubject.next(d)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return this._endSubject===void 0&&(this._endSubject=new a.ReplaySubject(void 0,this._timeframe),this._endListener=d=>{this.preventDefaultOnEvent(h.Type.End,d),this._endSubject.next(d)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new a.ReplaySubject(void 0,this._timeframe),this._moveListener=d=>{this.preventDefaultOnEvent(h.Type.Move,d),this._moveSubject.next(d)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new a.ReplaySubject(void 0,this._timeframe),this._cancelListener=d=>{this.preventDefaultOnEvent(h.Type.Cancel,d),this._cancelSubject.next(d)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.TouchEventProvider=h,function(_){(function(d){d[d.Start=1]="Start",d[d.End=2]="End",d[d.Move=4]="Move",d[d.Cancel=8]="Cancel"})(_.Type||(_.Type={}))}(h||(t.TouchEventProvider=h={}))},3151:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrackballModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._rotation=a.mat4.create(),this._sensitivity=_.DEFAULT_SENSITIVITY}initiate(c){this._initialPoint=c}process(c){this._currentPoint=c;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),a.vec2.copy(this._initialPoint,this._currentPoint);const o=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(o,o);const l=a.vec3.normalize((0,r.v3)(),this._reference.up),m=a.vec3.cross((0,r.v3)(),o,l);a.vec3.scale(l,l,s[1]),a.vec3.scale(m,m,s[0]);const v=a.vec3.cross((0,r.v3)(),a.vec3.add((0,r.v3)(),l,m),o);a.vec3.normalize(v,v);const f=a.quat.setAxisAngle(a.quat.create(),v,a.vec2.len(s));a.mat4.multiply(this._rotation,this._rotation,a.mat4.fromQuat((0,r.m4)(),f)),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._reference.center);a.mat4.multiply(c,c,this._rotation),a.mat4.translate(c,c,a.vec3.negate((0,r.v3)(),this._reference.center));const s=a.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),o=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,c);this._camera.up=s,this._camera.eye=o}set sensitivity(c){this._sensitivity=c}get sensitivity(){return this._sensitivity}}t.TrackballModifier=_,_.DEFAULT_SENSITIVITY=.002},2813:(p,t,i)=>{const a=i(3557),r=i(5150),h=i(9504);var _;(function(d){function c(l){return(0,h.assert)(l.length===2,`expected length of buffer to be 2, given ${l.length}`),[l[0],l[1]]}function s(l){return(0,h.assert)(l.length===3,`expected length of buffer to be 3, given ${l.length}`),[l[0],l[1],l[2]]}function o(l){return(0,h.assert)(l.length===4,`expected length of buffer to be 4, given ${l.length}`),[l[0],l[1],l[2],l[3]]}d.tuple2=c,d.tuple3=s,d.tuple4=o,d.clampf=function(l,m){const v=(0,r.clamp)(l,0,1);return(0,h.logIf)(m!==void 0&&l<0||l>1,h.LogLevel.Info,`${m} clamped to [${v}], given [${l}]`),v},d.clampf2=function(l,m){const v=a.vec2.fromValues(l[0],l[1]);return(l[0]<0||l[0]>1||l[1]<0||l[1]>1)&&((0,r.clamp2)(v,v,a.vec2.fromValues(0,0),a.vec2.fromValues(1,1)),(0,h.logIf)(m!==void 0,h.LogLevel.Info,`${m} clamped to [${v}], given [${l}]`)),c(v)},d.clampf3=function(l,m){const v=a.vec3.fromValues(l[0],l[1],l[2]);return(l[0]<0||l[0]>1||l[1]<0||l[1]>1||l[2]<0||l[2]>1)&&((0,r.clamp3)(v,v,a.vec3.fromValues(0,0,0),a.vec3.fromValues(1,1,1)),(0,h.logIf)(m!==void 0,h.LogLevel.Info,`${m} clamped to [${v}], given [${l}]`)),s(v)},d.clampf4=function(l,m){const v=a.vec4.fromValues(l[0],l[1],l[2],l[3]);return(l[0]<0||l[0]>1||l[1]<0||l[1]>1||l[2]<0||l[2]>1||l[3]<0||l[3]>1)&&((0,r.clamp4)(v,v,a.vec4.fromValues(0,0,0,0),a.vec4.fromValues(1,1,1,1)),(0,h.logIf)(m!==void 0,h.LogLevel.Info,`${m} clamped to [${v}], given [${l}]`)),o(v)},d.duplicate2=function(l){return[l[0],l[1]]},d.duplicate3=function(l){return[l[0],l[1],l[2]]},d.duplicate4=function(l){return[l[0],l[1],l[2],l[3]]},d.equals2=function(l,m){return l[0]===m[0]&&l[1]===m[1]},d.equals3=function(l,m){return l[0]===m[0]&&l[1]===m[1]&&l[2]===m[2]},d.equals4=function(l,m){return l[0]===m[0]&&l[1]===m[1]&&l[2]===m[2]&&l[3]===m[3]}})(_||(_={})),p.exports=_},9184:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TurntableModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._rotation=(0,r.m4)(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=(0,r.v3)(),this._sensitivity=_.DEFAULT_SENSITIVITY}initiate(c){Object.assign(this._reference,this._camera),this._initialPoint=c;const s=a.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);a.vec3.normalize(s,s),this._xAxisScreenSpace=a.vec3.cross((0,r.v3)(),[0,1,0],s),this._azimuth=Math.acos(a.vec3.dot(s,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(c){this._currentPoint=c;const s=a.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);a.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),Number.isFinite(this._minAzimuth)&&(s[1]=Math.min(this._azimuth-this._minAzimuth,s[1])),Number.isFinite(this._maxAzimuth)&&(s[1]=Math.max(this._azimuth-this._maxAzimuth,s[1])),a.mat4.rotateY(this._rotation,(0,r.m4)(),s[0]),a.mat4.rotate(this._rotation,this._rotation,s[1],this._xAxisScreenSpace),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._reference.center);a.mat4.multiply(c,c,this._rotation),a.mat4.translate(c,c,a.vec3.negate((0,r.v3)(),this._reference.center));const s=a.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),o=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,c);this._camera.up=s,this._camera.eye=o}set sensitivity(c){this._sensitivity=c}get sensitivity(){return this._sensitivity}}t.TurntableModifier=_,_.DEFAULT_SENSITIVITY=.002},216:function(p,t,i){var a=this&&this.__decorate||function(d,c,s,o){var l,m=arguments.length,v=m<3?c:o===null?o=Object.getOwnPropertyDescriptor(c,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(d,c,s,o);else for(var f=d.length-1;f>=0;f--)(l=d[f])&&(v=(m<3?l(v):m>3?l(c,s,v):l(c,s))||v);return m>3&&v&&Object.defineProperty(c,s,v),v};Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedBuffer=void 0;const r=i(7340),h=i(4127);class _ extends h.Initializable{static updatesNeedMerge(c,s,o){return s.begin-c.end<o||o===-1}constructor(c,s,o,l=0,m){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(s),this._gpuBuffer=new r.Buffer(c,m),this._usage=o,this._mergeThreshold=l}mergeUpdatesLeft(c){let s=0;const o=this._updates[c];for(let l=c-1;l>=0;l--){const m=this._updates[l];if(!_.updatesNeedMerge(m,o,this._mergeThreshold))break;o.begin=Math.min(o.begin,m.begin),o.end=Math.max(o.end,m.end),s++}return this._updates.splice(c-s,s),s+1}mergeUpdatesRight(c){let s=0;const o=this._updates[c];for(let l=c+1;l<this._updates.length;l++){const m=this._updates[l];if(!_.updatesNeedMerge(o,m,this._mergeThreshold))break;o.begin=Math.min(o.begin,m.begin),o.end=Math.max(o.end,m.end),s++}return this._updates.splice(c+1,s),s+1}addUpdate(c){const s=this._updates.findIndex(o=>c.begin<o.begin);s===-1?(this._updates.push(c),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(s,0,c),this.mergeUpdatesRight(s),this.mergeUpdatesLeft(s))}initialize(c){return this._gpuBuffer.initialize(c)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(c,s,o,l=!1,m=0,v=0,f=!0,b=!0){this._gpuBuffer.attribEnable(c,s,o,l,m,v,f,b)}attribDisable(c,s=!0,o=!0){this._gpuBuffer.attribDisable(c,s,o)}mergeSubDataRanges(){let c=0;for(;c<this._updates.length;)c+=this.mergeUpdatesRight(c)}subData(c,s){let o;o=s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),new Uint8Array(this._cpuBuffer).set(o,c),this.addUpdate({begin:c,end:c+o.byteLength})}update(c=!1,s=!1){if(c&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const o=new Uint8Array(this._cpuBuffer);for(const l of this._updates){const m=o.subarray(l.begin,l.end);this._gpuBuffer.subData(l.begin,m)}}s&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(c){const s=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(c);const o=new Uint8Array(s).slice(0,c);new Uint8Array(this._cpuBuffer).set(o)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(c){this._usage=c}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(c){this._mergeThreshold=c}}t.UnifiedBuffer=_,a([h.Initializable.initialize()],_.prototype,"initialize",null),a([h.Initializable.uninitialize()],_.prototype,"uninitialize",null),a([h.Initializable.assert_initialized()],_.prototype,"bind",null),a([h.Initializable.assert_initialized()],_.prototype,"unbind",null),a([h.Initializable.assert_initialized()],_.prototype,"attribEnable",null),a([h.Initializable.assert_initialized()],_.prototype,"attribDisable",null),a([h.Initializable.assert_initialized()],_.prototype,"update",null)},4536:(p,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.commit=t.branch=void 0,t.branch="master",t.commit="08005ba3cdde715e0e81bf865bd6014b95d74922",t.version="v0.9.0"},5507:function(p,t,i){var a=this&&this.__decorate||function(c,s,o,l){var m,v=arguments.length,f=v<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,o):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(c,s,o,l);else for(var b=c.length-1;b>=0;b--)(m=c[b])&&(f=(v<3?m(f):v>3?m(s,o,f):m(s,o))||f);return v>3&&f&&Object.defineProperty(s,o,f),f};Object.defineProperty(t,"__esModule",{value:!0}),t.VertexArray=void 0;const r=i(9504),h=i(4127),_=i(9965);class d extends _.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(s,o){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const l=this.context.gl2facade;this._object=l.createVertexArray(),this._valid=this._object!==void 0,this._bind=()=>{l.bindVertexArray(this.object),this._buffersBound||(s(),this._buffersBound=!0)},this._unbind=()=>l.bindVertexArray(d.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>s(),this._unbind=()=>o(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?((0,r.assert)(this._object!==void 0,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}t.VertexArray=d,d.DEFAULT_VERTEX_ARRAY=void 0,a([h.Initializable.assert_initialized()],d.prototype,"bind",null),a([h.Initializable.assert_initialized()],d.prototype,"unbind",null)},7645:p=>{var t;(function(i){i.EventBlocker=class{constructor(a,r){if(this._blockListenerByEvent=new Map,this._element=a,r!==void 0)for(const h of r)this.block(h)}block(a){this._blockListenerByEvent.has(a)||(this._blockListenerByEvent.set(a,r=>(r.preventDefault(),r.stopPropagation(),!1)),this._element.addEventListener(a,this._blockListenerByEvent.get(a)))}unblock(a){this._blockListenerByEvent.has(a)&&(this._element.removeEventListener(a,this._blockListenerByEvent.get(a)),this._blockListenerByEvent.delete(a))}}})(t||(t={})),p.exports=t},6378:(p,t,i)=>{const a=i(9504);var r;(function(h){class _{static queryAndCacheAPI(){if(_._exit!==void 0)return;const c=window.document,s=[c.exitFullScreen,c.msExitFullscreen,c.mozCancelFullScreen,c.webkitExitFullscreen,void 0];let o=0;for(;o<s.length&&s[o]===void 0;++o);switch(o){case 0:_._exit=()=>c.exitFullScreen(),_._request=l=>l.requestFullscreen(),_._element=()=>c.fullscreenElement,_._event="fullscreenchange";break;case 1:_._exit=()=>c.msExitFullscreen(),_._request=l=>l.msRequestFullscreen(),_._element=()=>c.msFullscreenElement,_._event="msfullscreenchange";break;case 2:_._exit=()=>c.mozCancelFullScreen(),_._request=l=>l.mozRequestFullScreen(),_._element=()=>c.mozFullScreenElement,_._event="mozfullscreenchange";break;case 3:_._exit=()=>c.webkitExitFullscreen(),_._request=l=>l.webkitRequestFullscreen(),_._element=()=>c.webkitFullscreenElement,_._event="webkitfullscreenchange";break;default:(0,a.assert)(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return _._element()!==void 0&&_._element()!==null}static toggle(c,s){if(c===void 0)return;_.queryAndCacheAPI();const o=_.active();if(!o){const l=getComputedStyle(c);_._size[0]=l.width,_._size[1]=l.height}s&&s(),o?(_._callback=void 0,window.removeEventListener(_._event,_.removeEventListener),c.style.width=_._size[0],c.style.height=_._size[1]):(_._callback=s,window.addEventListener(_._event,_.addEventListener)),o?_._exit():_._request(c)}}_._size=["0","0"],_.addEventListener=()=>{window.removeEventListener(_._event,_.addEventListener),window.addEventListener(_._event,_.removeEventListener)},_.removeEventListener=()=>{_._callback&&(_._callback(),_._callback=void 0),window.removeEventListener(_._event,_.removeEventListener)},h.Fullscreen=_})(r||(r={})),p.exports=r},5109:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(Pe,De,ke,lt){lt===void 0&&(lt=ke);var bt=Object.getOwnPropertyDescriptor(De,ke);bt&&!("get"in bt?!De.__esModule:bt.writable||bt.configurable)||(bt={enumerable:!0,get:function(){return De[ke]}}),Object.defineProperty(Pe,lt,bt)}:function(Pe,De,ke,lt){lt===void 0&&(lt=ke),Pe[lt]=De[ke]}),r=this&&this.__setModuleDefault||(Object.create?function(Pe,De){Object.defineProperty(Pe,"default",{enumerable:!0,value:De})}:function(Pe,De){Pe.default=De}),h=this&&this.__exportStar||function(Pe,De){for(var ke in Pe)ke==="default"||Object.prototype.hasOwnProperty.call(De,ke)||a(De,Pe,ke)},_=this&&this.__importStar||function(Pe){if(Pe&&Pe.__esModule)return Pe;var De={};if(Pe!=null)for(var ke in Pe)ke!=="default"&&Object.prototype.hasOwnProperty.call(Pe,ke)&&a(De,Pe,ke);return r(De,Pe),De};Object.defineProperty(t,"__esModule",{value:!0}),t.KernelF32=t.RandomSquareKernel=t.AntiAliasingKernel=t.AbstractKernel=t.NdcFillingTriangle=t.NdcFillingRectangle=t.CanvasRecorder=t.WheelZoomModifier=t.PinchZoomModifier=t.TurntableModifier=t.TrackballModifier=t.PointerLock=t.PanModifier=t.FirstPersonModifier=t.Navigation=t.CameraModifier=t.TileCameraGenerator=t.Camera=t.Wizard=t.VertexArray=t.UnifiedBuffer=t.TextureCube=t.Texture2DArray=t.Texture3D=t.Texture2D=t.Shader=t.LoadingStatus=t.Renderer=t.Renderbuffer=t.Program=t.Geometry=t.Framebuffer=t.DefaultFramebuffer=t.ColorScale=t.Color=t.Buffer=t.EventHandler=t.PointerEventProvider=t.TouchEventProvider=t.MouseEventProvider=t.ChangeLookup=t.ExtensionsHash=t.ContextMasquerade=t.Initializable=t.Controller=t.Canvas=t.Context=t.version=t.commit=t.branch=void 0,t.tuples=t.gl_matrix_extensions=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.vec4=t.vec3=t.vec2=t.auxiliaries=t.FrameCapture=t.EyeGazeData=t.EyeGazeEventProvider=t.EyeGazeDataStreams=t.EyeGazeDataStream=t.ShadowPass=t.GaussFilter=t.ReadbackPass=t.EnvironmentTextureType=t.EnvironmentRenderingPass=t.DebugPass=t.BlitPass=t.AccumulatePass=t.KernelUI8=t.KernelUI32=t.KernelI8=t.KernelI32=void 0;var d=i(4536);Object.defineProperty(t,"branch",{enumerable:!0,get:function(){return d.branch}}),Object.defineProperty(t,"commit",{enumerable:!0,get:function(){return d.commit}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return d.version}});var c=i(2527);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return c.Context}});var s=i(7858);Object.defineProperty(t,"Canvas",{enumerable:!0,get:function(){return s.Canvas}});var o=i(8234);Object.defineProperty(t,"Controller",{enumerable:!0,get:function(){return o.Controller}});var l=i(4127);Object.defineProperty(t,"Initializable",{enumerable:!0,get:function(){return l.Initializable}});var m=i(5557);Object.defineProperty(t,"ContextMasquerade",{enumerable:!0,get:function(){return m.ContextMasquerade}});var v=i(5060);Object.defineProperty(t,"ExtensionsHash",{enumerable:!0,get:function(){return v.ExtensionsHash}});var f=i(7564);Object.defineProperty(t,"ChangeLookup",{enumerable:!0,get:function(){return f.ChangeLookup}});var b=i(4602);Object.defineProperty(t,"MouseEventProvider",{enumerable:!0,get:function(){return b.MouseEventProvider}});var x=i(8870);Object.defineProperty(t,"TouchEventProvider",{enumerable:!0,get:function(){return x.TouchEventProvider}});var E=i(8216);Object.defineProperty(t,"PointerEventProvider",{enumerable:!0,get:function(){return E.PointerEventProvider}});var O=i(2);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return O.EventHandler}});var S=i(7340);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return S.Buffer}});var w=i(3847);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return w.Color}});var P=i(5837);Object.defineProperty(t,"ColorScale",{enumerable:!0,get:function(){return P.ColorScale}});var N=i(8386);Object.defineProperty(t,"DefaultFramebuffer",{enumerable:!0,get:function(){return N.DefaultFramebuffer}});var k=i(8215);Object.defineProperty(t,"Framebuffer",{enumerable:!0,get:function(){return k.Framebuffer}});var j=i(638);Object.defineProperty(t,"Geometry",{enumerable:!0,get:function(){return j.Geometry}});var U=i(4168);Object.defineProperty(t,"Program",{enumerable:!0,get:function(){return U.Program}});var H=i(8400);Object.defineProperty(t,"Renderbuffer",{enumerable:!0,get:function(){return H.Renderbuffer}});var Z=i(3105);Object.defineProperty(t,"Renderer",{enumerable:!0,get:function(){return Z.Renderer}}),Object.defineProperty(t,"LoadingStatus",{enumerable:!0,get:function(){return Z.LoadingStatus}});var K=i(771);Object.defineProperty(t,"Shader",{enumerable:!0,get:function(){return K.Shader}});var ee=i(8593);Object.defineProperty(t,"Texture2D",{enumerable:!0,get:function(){return ee.Texture2D}});var re=i(9584);Object.defineProperty(t,"Texture3D",{enumerable:!0,get:function(){return re.Texture3D}});var J=i(7380);Object.defineProperty(t,"Texture2DArray",{enumerable:!0,get:function(){return J.Texture2DArray}});var ne=i(5186);Object.defineProperty(t,"TextureCube",{enumerable:!0,get:function(){return ne.TextureCube}});var he=i(216);Object.defineProperty(t,"UnifiedBuffer",{enumerable:!0,get:function(){return he.UnifiedBuffer}});var fe=i(5507);Object.defineProperty(t,"VertexArray",{enumerable:!0,get:function(){return fe.VertexArray}});var be=i(9217);Object.defineProperty(t,"Wizard",{enumerable:!0,get:function(){return be.Wizard}});var Ae=i(3025);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return Ae.Camera}});var Ce=i(5608);Object.defineProperty(t,"TileCameraGenerator",{enumerable:!0,get:function(){return Ce.TileCameraGenerator}});var oe=i(7344);Object.defineProperty(t,"CameraModifier",{enumerable:!0,get:function(){return oe.CameraModifier}});var Re=i(4264);Object.defineProperty(t,"Navigation",{enumerable:!0,get:function(){return Re.Navigation}});var Be=i(4850);Object.defineProperty(t,"FirstPersonModifier",{enumerable:!0,get:function(){return Be.FirstPersonModifier}});var st=i(506);Object.defineProperty(t,"PanModifier",{enumerable:!0,get:function(){return st.PanModifier}});var Je=i(2010);Object.defineProperty(t,"PointerLock",{enumerable:!0,get:function(){return Je.PointerLock}});var Ve=i(3151);Object.defineProperty(t,"TrackballModifier",{enumerable:!0,get:function(){return Ve.TrackballModifier}});var $e=i(9184);Object.defineProperty(t,"TurntableModifier",{enumerable:!0,get:function(){return $e.TurntableModifier}});var it=i(5222);Object.defineProperty(t,"PinchZoomModifier",{enumerable:!0,get:function(){return it.PinchZoomModifier}});var Bt=i(7137);Object.defineProperty(t,"WheelZoomModifier",{enumerable:!0,get:function(){return Bt.WheelZoomModifier}});var ot=i(8596);Object.defineProperty(t,"CanvasRecorder",{enumerable:!0,get:function(){return ot.CanvasRecorder}});var Tt=i(5491);Object.defineProperty(t,"NdcFillingRectangle",{enumerable:!0,get:function(){return Tt.NdcFillingRectangle}});var xt=i(1896);Object.defineProperty(t,"NdcFillingTriangle",{enumerable:!0,get:function(){return xt.NdcFillingTriangle}});var mt=i(4287);Object.defineProperty(t,"AbstractKernel",{enumerable:!0,get:function(){return mt.AbstractKernel}});var Dt=i(2419);Object.defineProperty(t,"AntiAliasingKernel",{enumerable:!0,get:function(){return Dt.AntiAliasingKernel}});var Sr=i(3039);Object.defineProperty(t,"RandomSquareKernel",{enumerable:!0,get:function(){return Sr.RandomSquareKernel}});var At=i(4287);Object.defineProperty(t,"KernelF32",{enumerable:!0,get:function(){return At.KernelF32}}),Object.defineProperty(t,"KernelI32",{enumerable:!0,get:function(){return At.KernelI32}}),Object.defineProperty(t,"KernelI8",{enumerable:!0,get:function(){return At.KernelI8}}),Object.defineProperty(t,"KernelUI32",{enumerable:!0,get:function(){return At.KernelUI32}}),Object.defineProperty(t,"KernelUI8",{enumerable:!0,get:function(){return At.KernelUI8}});var dr=i(9017);Object.defineProperty(t,"AccumulatePass",{enumerable:!0,get:function(){return dr.AccumulatePass}});var Or=i(8196);Object.defineProperty(t,"BlitPass",{enumerable:!0,get:function(){return Or.BlitPass}});var Rr=i(3334);Object.defineProperty(t,"DebugPass",{enumerable:!0,get:function(){return Rr.DebugPass}});var fr=i(6464);Object.defineProperty(t,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return fr.EnvironmentRenderingPass}}),Object.defineProperty(t,"EnvironmentTextureType",{enumerable:!0,get:function(){return fr.EnvironmentTextureType}});var Pr=i(1900);Object.defineProperty(t,"ReadbackPass",{enumerable:!0,get:function(){return Pr.ReadbackPass}});var wr=i(3395);Object.defineProperty(t,"GaussFilter",{enumerable:!0,get:function(){return wr.GaussFilter}});var Lr=i(9011);Object.defineProperty(t,"ShadowPass",{enumerable:!0,get:function(){return Lr.ShadowPass}});var _r=i(3404);Object.defineProperty(t,"EyeGazeDataStream",{enumerable:!0,get:function(){return _r.EyeGazeDataStream}}),Object.defineProperty(t,"EyeGazeDataStreams",{enumerable:!0,get:function(){return _r.EyeGazeDataStreams}});var Mr=i(3975);Object.defineProperty(t,"EyeGazeEventProvider",{enumerable:!0,get:function(){return Mr.EyeGazeEventProvider}});var Ir=i(6662);Object.defineProperty(t,"EyeGazeData",{enumerable:!0,get:function(){return Ir.EyeGazeData}});var pr=i(1215);Object.defineProperty(t,"FrameCapture",{enumerable:!0,get:function(){return pr.FrameCapture}}),h(i(1854),t),h(i(5315),t),h(i(1058),t);const Fr=_(i(9504));t.auxiliaries=Fr;var jt=i(3557);Object.defineProperty(t,"vec2",{enumerable:!0,get:function(){return jt.vec2}}),Object.defineProperty(t,"vec3",{enumerable:!0,get:function(){return jt.vec3}}),Object.defineProperty(t,"vec4",{enumerable:!0,get:function(){return jt.vec4}});var Lt=i(3557);Object.defineProperty(t,"mat2",{enumerable:!0,get:function(){return Lt.mat2}}),Object.defineProperty(t,"mat2d",{enumerable:!0,get:function(){return Lt.mat2d}}),Object.defineProperty(t,"mat3",{enumerable:!0,get:function(){return Lt.mat3}}),Object.defineProperty(t,"mat4",{enumerable:!0,get:function(){return Lt.mat4}});var Cr=i(3557);Object.defineProperty(t,"quat",{enumerable:!0,get:function(){return Cr.quat}});const Nr=_(i(5150));t.gl_matrix_extensions=Nr;const zr=_(i(2813));t.tuples=zr},8184:function(p,t,i){var a=this&&this.__createBinding||(Object.create?function(f,b,x,E){E===void 0&&(E=x);var O=Object.getOwnPropertyDescriptor(b,x);O&&!("get"in O?!b.__esModule:O.writable||O.configurable)||(O={enumerable:!0,get:function(){return b[x]}}),Object.defineProperty(f,E,O)}:function(f,b,x,E){E===void 0&&(E=x),f[E]=b[x]}),r=this&&this.__setModuleDefault||(Object.create?function(f,b){Object.defineProperty(f,"default",{enumerable:!0,value:b})}:function(f,b){f.default=b}),h=this&&this.__exportStar||function(f,b){for(var x in f)x==="default"||Object.prototype.hasOwnProperty.call(b,x)||a(b,f,x)},_=this&&this.__importStar||function(f){if(f&&f.__esModule)return f;var b={};if(f!=null)for(var x in f)x!=="default"&&Object.prototype.hasOwnProperty.call(f,x)&&a(b,f,x);return r(b,f),b};Object.defineProperty(t,"__esModule",{value:!0}),t.viewer=t.Benchmark=t.ray_math=t.fetch=t.properties=void 0,h(i(5109),t),h(i(8892),t);const d=_(i(1407));t.properties=d;const c=_(i(64));t.fetch=c;const s=_(i(8962));t.ray_math=s;var o=i(8263);Object.defineProperty(t,"Benchmark",{enumerable:!0,get:function(){return o.Benchmark}}),h(i(2016),t);const l=_(i(7645)),m=_(i(6378));var v;(function(f){f.EventBlocker=l.EventBlocker,f.Fullscreen=m.Fullscreen})(v||(t.viewer=v={}))},7137:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WheelZoomModifier=void 0;const a=i(3557),r=i(5150),h=i(7344);class _ extends h.CameraModifier{constructor(){super(...arguments),this._sensitivity=_.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}process(c){Object.assign(this._reference,this._camera);const s=c*this._sensitivity,o=a.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);a.vec3.normalize(o,o),this._translation=a.vec3.scale((0,r.v3)(),o,s),this.update()}update(){if(this._camera===void 0)return;const c=a.mat4.fromTranslation((0,r.m4)(),this._translation),s=a.vec3.transformMat4((0,r.v3)(),this._reference.eye,c);this._camera.eye=s}}t.WheelZoomModifier=_,_.DEFAULT_SENSITIVITY=.002},9217:(p,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wizard=void 0;const a=i(9504);class r{static queryPrecisionSupport(_,d){const c=_.gl,s=_.gl2facade,o=_.isWebGL1&&_.supportsTextureFloat||_.isWebGL2&&_.supportsColorBufferFloat,l=_.isWebGL1&&_.supportsTextureHalfFloat||_.isWebGL2&&_.supportsColorBufferFloat;let m=d;return d in r.Precision||((0,a.log)(a.LogLevel.Warning,`unknown precision '${m}' changed to '${r.Precision.auto}'`),d=r.Precision.auto),d===r.Precision.auto&&(m=o?r.Precision.float:l?r.Precision.half:r.Precision.byte),m===r.Precision.half&&l?(_.isWebGL2?_.colorBufferFloat:_.textureHalfFloat,[m,s.HALF_FLOAT,1]):m!==r.Precision.float&&m!==r.Precision.half||!o?[m,c.UNSIGNED_BYTE,2]:(_.isWebGL2?_.colorBufferFloat:_.textureFloat,[m,c.FLOAT,0])}static queryInternalTextureFormat(_,d,c=r.Precision.auto){const[s,o,l]=this.queryPrecisionSupport(_,c),m=_.gl;if(_.isWebGL1)return(0,a.assert)([m.RGB,m.RGBA].includes(d),"target must be gl.RGB or gl.RGBA in WebGL 1"),[d,o,s];switch(d){case m.RGBA:return[[m.RGBA32F,m.RGBA16F,m.RGBA8][l],o,s];case m.RGB:return[[m.RGB32F,m.RGB16F,m.RGB8][l],o,s];case m.RG:return[[m.RG32F,m.RG16F,m.RG8][l],o,s];case m.RED:return[[m.R32F,m.R16F,m.R8][l],o,s];default:(0,a.assert)(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[m.NONE,m.NONE,s]}}t.Wizard=r,function(h){(function(_){_.float="float",_.half="half",_.byte="byte",_.auto="auto"})(h.Precision||(h.Precision={}))}(r||(t.Wizard=r={}))},9983:(p,t,i)=>{var a=i(6751);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var h=/^([a-z0-9.+-]+:)/i,_=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),s=["'"].concat(c),o=["%","/","?",";","#"].concat(s),l=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,v=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=i(8985);function O(S,w,P){if(S&&typeof S=="object"&&S instanceof r)return S;var N=new r;return N.parse(S,w,P),N}r.prototype.parse=function(S,w,P){if(typeof S!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof S);var N=S.indexOf("?"),k=N!==-1&&N<S.indexOf("#")?"?":"#",j=S.split(k);j[0]=j[0].replace(/\\/g,"/");var U=S=j.join(k);if(U=U.trim(),!P&&S.split("#").length===1){var H=d.exec(U);if(H)return this.path=U,this.href=U,this.pathname=H[1],H[2]?(this.search=H[2],this.query=w?E.parse(this.search.substr(1)):this.search.substr(1)):w&&(this.search="",this.query={}),this}var Z=h.exec(U);if(Z){var K=(Z=Z[0]).toLowerCase();this.protocol=K,U=U.substr(Z.length)}if(P||Z||U.match(/^\/\/[^@/]+@[^@/]+/)){var ee=U.substr(0,2)==="//";!ee||Z&&b[Z]||(U=U.substr(2),this.slashes=!0)}if(!b[Z]&&(ee||Z&&!x[Z])){for(var re,J,ne=-1,he=0;he<l.length;he++)(fe=U.indexOf(l[he]))!==-1&&(ne===-1||fe<ne)&&(ne=fe);for((J=ne===-1?U.lastIndexOf("@"):U.lastIndexOf("@",ne))!==-1&&(re=U.slice(0,J),U=U.slice(J+1),this.auth=decodeURIComponent(re)),ne=-1,he=0;he<o.length;he++){var fe;(fe=U.indexOf(o[he]))!==-1&&(ne===-1||fe<ne)&&(ne=fe)}ne===-1&&(ne=U.length),this.host=U.slice(0,ne),U=U.slice(ne),this.parseHost(),this.hostname=this.hostname||"";var be=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!be)for(var Ae=this.hostname.split(/\./),Ce=(he=0,Ae.length);he<Ce;he++){var oe=Ae[he];if(oe&&!oe.match(m)){for(var Re="",Be=0,st=oe.length;Be<st;Be++)oe.charCodeAt(Be)>127?Re+="x":Re+=oe[Be];if(!Re.match(m)){var Je=Ae.slice(0,he),Ve=Ae.slice(he+1),$e=oe.match(v);$e&&(Je.push($e[1]),Ve.unshift($e[2])),Ve.length&&(U="/"+Ve.join(".")+U),this.hostname=Je.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),be||(this.hostname=a.toASCII(this.hostname));var it=this.port?":"+this.port:"",Bt=this.hostname||"";this.host=Bt+it,this.href+=this.host,be&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),U[0]!=="/"&&(U="/"+U))}if(!f[K])for(he=0,Ce=s.length;he<Ce;he++){var ot=s[he];if(U.indexOf(ot)!==-1){var Tt=encodeURIComponent(ot);Tt===ot&&(Tt=escape(ot)),U=U.split(ot).join(Tt)}}var xt=U.indexOf("#");xt!==-1&&(this.hash=U.substr(xt),U=U.slice(0,xt));var mt=U.indexOf("?");if(mt!==-1?(this.search=U.substr(mt),this.query=U.substr(mt+1),w&&(this.query=E.parse(this.query)),U=U.slice(0,mt)):w&&(this.search="",this.query={}),U&&(this.pathname=U),x[K]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){it=this.pathname||"";var Dt=this.search||"";this.path=it+Dt}return this.href=this.format(),this},r.prototype.format=function(){var S=this.auth||"";S&&(S=(S=encodeURIComponent(S)).replace(/%3A/i,":"),S+="@");var w=this.protocol||"",P=this.pathname||"",N=this.hash||"",k=!1,j="";this.host?k=S+this.host:this.hostname&&(k=S+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(k+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(j=E.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var U=this.search||j&&"?"+j||"";return w&&w.substr(-1)!==":"&&(w+=":"),this.slashes||(!w||x[w])&&k!==!1?(k="//"+(k||""),P&&P.charAt(0)!=="/"&&(P="/"+P)):k||(k=""),N&&N.charAt(0)!=="#"&&(N="#"+N),U&&U.charAt(0)!=="?"&&(U="?"+U),w+k+(P=P.replace(/[?#]/g,function(H){return encodeURIComponent(H)}))+(U=U.replace("#","%23"))+N},r.prototype.resolve=function(S){return this.resolveObject(O(S,!1,!0)).format()},r.prototype.resolveObject=function(S){if(typeof S=="string"){var w=new r;w.parse(S,!1,!0),S=w}for(var P=new r,N=Object.keys(this),k=0;k<N.length;k++){var j=N[k];P[j]=this[j]}if(P.hash=S.hash,S.href==="")return P.href=P.format(),P;if(S.slashes&&!S.protocol){for(var U=Object.keys(S),H=0;H<U.length;H++){var Z=U[H];Z!=="protocol"&&(P[Z]=S[Z])}return x[P.protocol]&&P.hostname&&!P.pathname&&(P.pathname="/",P.path=P.pathname),P.href=P.format(),P}if(S.protocol&&S.protocol!==P.protocol){if(!x[S.protocol]){for(var K=Object.keys(S),ee=0;ee<K.length;ee++){var re=K[ee];P[re]=S[re]}return P.href=P.format(),P}if(P.protocol=S.protocol,S.host||b[S.protocol])P.pathname=S.pathname;else{for(var J=(S.pathname||"").split("/");J.length&&!(S.host=J.shift()););S.host||(S.host=""),S.hostname||(S.hostname=""),J[0]!==""&&J.unshift(""),J.length<2&&J.unshift(""),P.pathname=J.join("/")}if(P.search=S.search,P.query=S.query,P.host=S.host||"",P.auth=S.auth,P.hostname=S.hostname||S.host,P.port=S.port,P.pathname||P.search){var ne=P.pathname||"",he=P.search||"";P.path=ne+he}return P.slashes=P.slashes||S.slashes,P.href=P.format(),P}var fe=P.pathname&&P.pathname.charAt(0)==="/",be=S.host||S.pathname&&S.pathname.charAt(0)==="/",Ae=be||fe||P.host&&S.pathname,Ce=Ae,oe=P.pathname&&P.pathname.split("/")||[],Re=(J=S.pathname&&S.pathname.split("/")||[],P.protocol&&!x[P.protocol]);if(Re&&(P.hostname="",P.port=null,P.host&&(oe[0]===""?oe[0]=P.host:oe.unshift(P.host)),P.host="",S.protocol&&(S.hostname=null,S.port=null,S.host&&(J[0]===""?J[0]=S.host:J.unshift(S.host)),S.host=null),Ae=Ae&&(J[0]===""||oe[0]==="")),be)P.host=S.host||S.host===""?S.host:P.host,P.hostname=S.hostname||S.hostname===""?S.hostname:P.hostname,P.search=S.search,P.query=S.query,oe=J;else if(J.length)oe||(oe=[]),oe.pop(),oe=oe.concat(J),P.search=S.search,P.query=S.query;else if(S.search!=null)return Re&&(P.host=oe.shift(),P.hostname=P.host,($e=!!(P.host&&P.host.indexOf("@")>0)&&P.host.split("@"))&&(P.auth=$e.shift(),P.hostname=$e.shift(),P.host=P.hostname)),P.search=S.search,P.query=S.query,P.pathname===null&&P.search===null||(P.path=(P.pathname?P.pathname:"")+(P.search?P.search:"")),P.href=P.format(),P;if(!oe.length)return P.pathname=null,P.search?P.path="/"+P.search:P.path=null,P.href=P.format(),P;for(var Be=oe.slice(-1)[0],st=(P.host||S.host||oe.length>1)&&(Be==="."||Be==="..")||Be==="",Je=0,Ve=oe.length;Ve>=0;Ve--)(Be=oe[Ve])==="."?oe.splice(Ve,1):Be===".."?(oe.splice(Ve,1),Je++):Je&&(oe.splice(Ve,1),Je--);if(!Ae&&!Ce)for(;Je--;Je)oe.unshift("..");!Ae||oe[0]===""||oe[0]&&oe[0].charAt(0)==="/"||oe.unshift(""),st&&oe.join("/").substr(-1)!=="/"&&oe.push("");var $e,it=oe[0]===""||oe[0]&&oe[0].charAt(0)==="/";return Re&&(P.hostname=it?"":oe.length?oe.shift():"",P.host=P.hostname,($e=!!(P.host&&P.host.indexOf("@")>0)&&P.host.split("@"))&&(P.auth=$e.shift(),P.hostname=$e.shift(),P.host=P.hostname)),(Ae=Ae||P.host&&oe.length)&&!it&&oe.unshift(""),oe.length>0?P.pathname=oe.join("/"):(P.pathname=null,P.path=null),P.pathname===null&&P.search===null||(P.path=(P.pathname?P.pathname:"")+(P.search?P.search:"")),P.auth=S.auth||P.auth,P.slashes=P.slashes||S.slashes,P.href=P.format(),P},r.prototype.parseHost=function(){var S=this.host,w=_.exec(S);w&&((w=w[0])!==":"&&(this.port=w.substr(1)),S=S.substr(0,S.length-w.length)),S&&(this.hostname=S)},t.parse=O,t.resolve=function(S,w){return O(S,!1,!0).resolve(w)},t.resolveObject=function(S,w){return S?O(S,!1,!0).resolveObject(w):w},t.format=function(S){return typeof S=="string"&&(S=O(S)),S instanceof r?S.format():r.prototype.format.call(S)},t.Url=r},6296:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
    #extension GL_OES_standard_derivatives : enable\r
#else \r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
uniform int u_frameNumber;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r
    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r
\r
    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r
    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r
    if(!any(bvec2(cstep))) {\r
        discard;\r
    }\r
    fragColor = vec4(color, 1.0); \r
}\r
`},5077:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else \r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec2 u_ndcOffset;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex.xy * 0.5 + 0.5;\r
\r
    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r
    ndcOffset(vertex, u_ndcOffset);\r
\r
    gl_Position = vertex;\r
}\r
`},5347:p=>{p.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
// References:\r
// [1] Real Shading in Unreal Engine 4\r
//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r
// [2] Physically Based Shading at Disney\r
//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r
// [3] README.md - Environment Maps\r
//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r
// [4] "An Inexpensive BRDF Model for Physically based Rendering" by Christophe Schlick\r
//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
const int USE_IBL               = 1 << 4;\r
const int HAS_BASECOLORMAP      = 1 << 5;\r
const int HAS_NORMALMAP         = 1 << 6;\r
const int HAS_EMISSIVEMAP       = 1 << 7;\r
const int HAS_METALROUGHNESSMAP = 1 << 8;\r
const int HAS_OCCLUSIONMAP      = 1 << 9;\r
const int USE_TEX_LOD           = 1 << 10;\r
\r
const vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\r
const vec3 u_LightColor = vec3(1, 1, 1);\r
\r
const float M_PI = 3.141592653589793;\r
const float c_MinRoughness = 0.04;\r
\r
uniform sampler2D u_baseColor;\r
uniform sampler2D u_metallicRoughness;\r
uniform sampler2D u_normal;\r
uniform sampler2D u_emissive;\r
uniform sampler2D u_occlusion;\r
\r
uniform samplerCube u_specularEnvironment;\r
uniform sampler2D u_brdfLUT;\r
\r
uniform int u_baseColorTexCoord;\r
uniform int u_normalTexCoord;\r
uniform int u_metallicRoughnessTexCoord;\r
uniform int u_occlusionTexCoord;\r
uniform int u_emissiveTexCoord;\r
\r
uniform vec4 u_baseColorFactor;\r
uniform float u_metallicFactor;\r
uniform float u_roughnessFactor;\r
uniform vec3 u_emissiveFactor;\r
uniform float u_normalScale;\r
uniform int u_blendMode;\r
uniform float u_blendCutoff;\r
\r
uniform mediump int u_geometryFlags;\r
uniform mediump int u_pbrFlags;\r
uniform vec3 u_eye;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
// Encapsulate the various inputs used by the various functions in the shading equation\r
// We store values in this struct to simplify the integration of alternative implementations\r
// of the shading terms, outlined in the Readme.MD Appendix.\r
struct PBRInfo\r
{\r
    float NdotL;                  // cos angle between normal and light direction\r
    float NdotV;                  // cos angle between normal and view direction\r
    float NdotH;                  // cos angle between normal and half vector\r
    float LdotH;                  // cos angle between light direction and half vector\r
    float VdotH;                  // cos angle between view direction and half vector\r
    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r
    float metalness;              // metallic value at the surface\r
    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r
    vec3 reflectance90;           // reflectance color at grazing angle\r
    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r
    vec3 diffuseColor;            // color contribution from diffuse lighting\r
    vec3 specularColor;           // color contribution from specular lighting\r
};\r
\r
bool checkGeometryFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
bool checkFlag(int flag) {\r
    return (u_pbrFlags & flag) == flag;\r
}\r
\r
vec4 SRGBtoLINEAR(vec4 srgbIn)\r
{\r
    #ifdef MANUAL_SRGB\r
    #ifdef SRGB_FAST_APPROXIMATION\r
    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r
    #else //SRGB_FAST_APPROXIMATION\r
    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r
    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r
    #endif //SRGB_FAST_APPROXIMATION\r
    return vec4(linOut,srgbIn.w);;\r
    #else //MANUAL_SRGB\r
    return srgbIn;\r
    #endif //MANUAL_SRGB\r
}\r
\r
// Find the normal for this fragment, pulling either from a predefined normal map\r
// or from the interpolated mesh normal and tangent attributes.\r
vec3 getNormal()\r
{\r
    // Retrieve the tangent space matrix\r
    mat3 tbn;\r
    if (!checkGeometryFlag(HAS_TANGENTS)) {\r
        vec3 pos_dx = dFdx(v_position);\r
        vec3 pos_dy = dFdy(v_position);\r
        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\r
        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\r
        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r
\r
        vec3 ng;\r
        if (checkGeometryFlag(HAS_NORMALS))\r
            ng = normalize(v_normal);\r
        else\r
            ng = cross(pos_dx, pos_dy);\r
\r
            t = normalize(t - ng * dot(ng, t));\r
            vec3 b = normalize(cross(ng, t));\r
            tbn = mat3(t, b, ng);\r
        }\r
    else { // HAS_TANGENTS\r
        tbn = v_TBN;\r
    }\r
\r
    vec3 n;\r
    if (checkFlag(HAS_NORMALMAP)) {\r
        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\r
        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\r
    } else {\r
        // The tbn matrix is linearly interpolated, so we need to re-normalize\r
        n = normalize(tbn[2].xyz);\r
    }\r
\r
    // reverse backface normals\r
    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r
\r
    return n;\r
}\r
\r
// Basic Lambertian diffuse\r
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r
// See also [1], Equation 1\r
vec3 diffuse(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.diffuseColor / M_PI;\r
}\r
\r
 // The following equation models the Fresnel reflectance term of the spec equation (aka F())\r
// Implementation of fresnel from [4], Equation 15\r
vec3 specularReflection(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r
}\r
\r
 // This calculates the specular geometric attenuation (aka G()),\r
// where rougher material will reflect less light back to the viewer.\r
// This implementation is based on [1] Equation 4, and we adopt their modifications to\r
// alphaRoughness as input as originally proposed in [2].\r
float geometricOcclusion(PBRInfo pbrInputs)\r
{\r
    float NdotL = pbrInputs.NdotL;\r
    float NdotV = pbrInputs.NdotV;\r
    float r = pbrInputs.alphaRoughness;\r
\r
    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r
    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r
    return attenuationL * attenuationV;\r
}\r
\r
 // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r
// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\r
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r
float microfacetDistribution(PBRInfo pbrInputs)\r
{\r
    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r
    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r
    return roughnessSq / (M_PI * f * f);\r
}\r
\r
vec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\r
{\r
    float NdotV = clamp(dot(n, v), 0.0, 1.0);\r
\r
    // TODO: pass uniform for mip count\r
    const float MIP_COUNT = 8.0;\r
    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\r
    vec3 reflection = normalize(reflect(-v, n));\r
\r
    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\r
    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\r
\r
    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\r
    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\r
\r
    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\r
    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\r
\r
    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\r
    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\r
\r
    return specular;\r
    // return diffuse + specular;\r
}\r
\r
void main(void)\r
{\r
    float perceptualRoughness = u_roughnessFactor;\r
    float metallic = u_metallicFactor;\r
    if (checkFlag(HAS_METALROUGHNESSMAP)) {\r
        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r
        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r
        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\r
        perceptualRoughness = mrSample.g * perceptualRoughness;\r
        metallic = mrSample.b * metallic;\r
    }\r
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r
    metallic = clamp(metallic, 0.0, 1.0);\r
    // Roughness is authored as perceptual roughness; as is convention,\r
    // convert to material roughness by squaring the perceptual roughness [2].\r
    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r
\r
     // The albedo may be defined from a base texture or a flat color\r
    vec4 baseColor;\r
    if (checkFlag(HAS_BASECOLORMAP)) {\r
        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\r
    } else {\r
        baseColor = u_baseColorFactor;\r
    }\r
\r
    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r
    // TODO!: distinguish vec3/vec4 colors...\r
    baseColor *= vec4(v_color.rgb, 1.0);\r
\r
    vec3 f0 = vec3(0.04);\r
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r
    diffuseColor *= 1.0 - metallic;\r
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r
\r
    // Compute reflectance.\r
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r
\r
    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r
    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r
    vec3 specularEnvironmentR0 = specularColor.rgb;\r
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r
\r
    vec3 n = getNormal();                         // normal at surface point\r
    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\r
    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\r
    vec3 h = normalize(l+v);                       // Half vector between both l and v\r
    vec3 reflection = -normalize(reflect(v, n));\r
\r
    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r
    float NdotV = abs(dot(n, v)) + 0.001;\r
    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r
    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r
    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r
\r
    PBRInfo pbrInputs = PBRInfo(\r
        NdotL,\r
        NdotV,\r
        NdotH,\r
        LdotH,\r
        VdotH,\r
        perceptualRoughness,\r
        metallic,\r
        specularEnvironmentR0,\r
        specularEnvironmentR90,\r
        alphaRoughness,\r
        diffuseColor,\r
        specularColor\r
    );\r
\r
     // Calculate the shading terms for the microfacet specular shading model\r
    vec3 F = specularReflection(pbrInputs);\r
    float G = geometricOcclusion(pbrInputs);\r
    float D = microfacetDistribution(pbrInputs);\r
\r
     // Calculation of analytical lighting contribution\r
    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r
    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r
    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r
    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r
\r
    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\r
    color += environmentLight;\r
\r
    if (checkFlag(HAS_EMISSIVEMAP)) {\r
        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\r
        color += emissive;\r
    }\r
\r
    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r
    float alpha = 1.0;\r
    if (u_blendMode == 1) {\r
        if (baseColor.a < u_blendCutoff) {\r
            discard;\r
        }\r
    }\r
    else if (u_blendMode == 2) {\r
        alpha = baseColor.a;\r
    }\r
\r
    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\r
}\r
`},6626:p=>{p.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
\r
#if __VERSION__ == 100\r
    attribute vec4 a_position;\r
    attribute vec4 a_normal;\r
    attribute vec4 a_tangent;\r
    attribute vec2 a_texcoord_0;\r
    attribute vec2 a_texcoord_1;\r
    attribute vec2 a_texcoord_2;\r
    attribute vec4 a_joints;\r
    attribute vec4 a_weights;\r
    attribute vec4 a_color;\r
#else\r
    layout (location = 0) in vec4 a_position;\r
    layout (location = 1) in vec3 a_normal;\r
    layout (location = 2) in vec4 a_tangent;\r
    layout (location = 3) in vec2 a_texcoord_0;\r
    layout (location = 4) in vec2 a_texcoord_1;\r
    layout (location = 5) in vec2 a_texcoord_2;\r
    layout (location = 6) in vec4 a_joints;\r
    layout (location = 7) in vec4 a_weights;\r
    layout (location = 8) in vec4 a_color;\r
#endif\r
\r
uniform mat4 u_model;\r
uniform mat4 u_viewProjection;\r
uniform mat3 u_normalMatrix;\r
\r
uniform mediump int u_geometryFlags;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
bool checkFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
void main(void)\r
{\r
    vec4 pos = u_model * a_position;\r
    v_position = vec3(pos.xyz) / pos.w;\r
\r
    if (checkFlag(HAS_NORMALS)) {\r
        if (checkFlag(HAS_TANGENTS)) {\r
            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\r
            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\r
            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r
            v_TBN = mat3(tangentW, bitangentW, normalW);\r
        } else { // HAS_TANGENTS != 1\r
            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\r
        }\r
    }\r
\r
    if (checkFlag(HAS_UV)) {\r
        v_uv[0] = a_texcoord_0;\r
        v_uv[1] = a_texcoord_1;\r
        v_uv[2] = a_texcoord_2;\r
    } else {\r
        v_uv[0] = vec2(0., 0.);\r
        v_uv[1] = vec2(0., 0.);\r
        v_uv[2] = vec2(0., 0.);\r
    }\r
\r
    if (checkFlag(HAS_COLORS)) {\r
        v_color = a_color;\r
    } else {\r
        v_color = vec4(1.0);\r
    }\r
\r
    gl_Position = u_viewProjection * u_model * a_position;\r
}\r
`},8058:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weight;\r
uniform sampler2D u_accumulationTexture;\r
uniform sampler2D u_currentFrameTexture;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r
    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r
    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r
}\r
`},6523:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    fragColor = texture(u_source, v_uv);\r
}\r
`},3354:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec4 u_srcBounds; // normalized\r
uniform vec4 u_dstBounds; // normalized\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = a_vertex * 0.5 + 0.5;\r
\r
    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\r
    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\r
}\r
`},8359:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
float linearizeDepth(float zInNDC, float near, float far) {\r
    float zLinear = 2.0 * near;\r
    zLinear /= far + near - zInNDC * (far - near);\r
    return zLinear;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
uniform int u_mode; /* Debug mode. */\r
uniform vec2 u_linearize; /* [ zNear, zFar ] */\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 source = texture(u_source, v_uv);\r
\r
    /* u_mode == 0                 None */\r
\r
    if(u_mode == 1) {           /* Depth */\r
        source.rgb = vec3(source[0]);\r
\r
    } else if (u_mode == 2) {   /* DepthLinear */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = vec3(zLinear);\r
\r
    } else if(u_mode == 3) {    /* DepthPacked */\r
        source.rgb = float24x1_to_uint8x3(source[0]);\r
\r
    } else if (u_mode == 4) {   /* DepthLinearPacked */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = float24x1_to_uint8x3(zLinear);\r
    }\r
\r
    fragColor = source;\r
}\r
`},9196:p=>{p.exports=`precision highp float;\r
precision highp int;\r
\r
/**\r
  To be replaced via Shader.replace();\r
 */\r
#define PROJECTION_TYPE\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform int u_mode;\r
uniform bool u_skipLod;\r
\r
#if defined(CUBE_MAP)\r
    uniform samplerCube u_cubemap;\r
#elif defined(EQUI_MAP)\r
    uniform sampler2D u_equirectmap;\r
#elif defined(SPHERE_MAP)\r
    uniform sampler2D u_spheremap;\r
#elif defined(POLAR_MAP)\r
    uniform sampler2D u_polarmap[2];\r
#endif\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
const float PI = 3.141592653589793;\r
const float OneOver2PI = 0.1591549430918953357688837633725;\r
const float OneOverPI  = 0.3183098861837906715377675267450;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = v_uv;\r
    vec3 ray = normalize(v_ray.xyz);\r
\r
    #if defined(CUBE_MAP)\r
        #if __VERSION__ == 100\r
            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\r
        #else\r
            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\r
        #endif\r
    #endif\r
\r
    #if defined(EQUI_MAP)\r
        float v = acos(-ray.y) * OneOverPI;\r
        float m = atan(-ray.x, ray.z);\r
        uv = vec2(m * OneOver2PI + 0.5, v);\r
\r
        fragColor = texture(u_equirectmap, uv);\r
    #endif\r
\r
    #if defined(SPHERE_MAP)\r
        ray = -ray.xzy;\r
        ray.y *= -1.0;\r
        ray.z += +1.0;\r
        uv = 0.5 + 0.5 * ray.xy / length(ray);\r
\r
        fragColor = texture(u_spheremap, uv);\r
    #endif\r
\r
    #if defined(POLAR_MAP)\r
        ray.xz /= abs(ray.y) + 1.0;\r
        ray.xz = ray.xz * 0.5 + 0.5;\r
        ray.x *= -1.0;\r
\r
        fragColor = mix(texture(u_polarmap[1], ray.xz),\r
                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\r
                        step(0.0, ray.y));\r
    #endif\r
}\r
`},3761:p=>{p.exports=`precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    in vec2 a_vertex;\r
#endif\r
\r
\r
uniform mat4 u_viewProjectionInverse;\r
\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\r
\r
    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\r
}\r
`},1687:p=>{p.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  #define fragColor gl_FragColor\r
#else\r
  layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weights[32];\r
uniform vec2 u_delta;\r
\r
uniform sampler2D u_texture;\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\r
    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\r
    {\r
        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\r
        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\r
    }\r
\r
    fragColor = result;\r
}\r
`},9214:p=>{p.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  attribute vec2 a_vertex;\r
#else\r
  layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    v_texCoords = a_vertex * 0.5 + 0.5;\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},9657:p=>{p.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},688:p=>{p.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragDepth gl_FragColor\r
#else \r
    layout(location = 0) out vec4 fragDepth;\r
#endif\r
\r
\r
uniform sampler2D u_texture;\r
uniform vec2 u_offset;\r
uniform vec2 u_scale;\r
\r
varying vec2 v_uv;\r
\r
\r
\r
void main(void)\r
{\r
    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r
    float depth = texture(u_texture, uv).r;\r
\r
    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r
}\r
`},5389:p=>{p.exports=`precision mediump float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
\r
    #ifdef GL_OES_standard_derivatives\r
        #extension GL_OES_standard_derivatives : enable\r
        #define AASTEP\r
    #endif\r
\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
\r
    #define AASTEP\r
\r
#endif\r
\r
\r
uniform sampler2D u_glyphs;\r
uniform vec4 u_color;\r
uniform float u_aaStepScale;\r
uniform int u_aaSampling;\r
\r
varying vec2 v_uv;\r
\r
const int channel = 0;\r
\r
\r
float aastep(float t, float value)\r
{\r
#ifdef AASTEP\r
    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\r
    float afwidth = fwidth(value) * u_aaStepScale;\r
    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\r
     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\r
     */\r
\r
    return smoothstep(t - afwidth, t + afwidth, value);\r
#else\r
    return step(t, value);\r
#endif\r
}\r
\r
float texStep(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return step(t, distanceValue);\r
}\r
\r
float texSmooth(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return aastep(t, distanceValue);\r
}\r
\r
#ifdef AASTEP\r
\r
float aastep3h(float t, vec2 uv)\r
{\r
    float x = dFdy(uv.x) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( -x, 0.0))\r
            + texSmooth(t, uv + vec2(0.0, 0.0))\r
            + texSmooth(t, uv + vec2( +x, 0.0));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3v(float t, vec2 uv)\r
{\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( 0.0,  -y))\r
            + texSmooth(t, uv + vec2( 0.0, 0.0))\r
            + texSmooth(t, uv + vec2( 0.0,  +y));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3x3(float t, vec2 uv)\r
{\r
    float x = dFdx(uv.x) * 1.0 / 3.0;\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\r
            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\r
            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\r
\r
    return v / 9.0;\r
}\r
\r
float aastep4x4(float t, vec2 uv)\r
{\r
    float x0 = dFdx(uv.x);\r
    float y0 = dFdx(uv.y);\r
    float x1 = x0 * 1.0 / 8.0;\r
    float y1 = y0 * 1.0 / 8.0;\r
    float x2 = x0 * 3.0 / 8.0;\r
    float y2 = y0 * 3.0 / 8.0;\r
\r
    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\r
            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\r
\r
            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\r
            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\r
            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\r
            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\r
\r
    return v / 16.0;\r
}\r
\r
// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\r
// {\r
//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\r
// }\r
\r
#endif\r
\r
void main(void)\r
{\r
    /** @todo mipmap access? */\r
\r
    float a = 0.0;\r
    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\r
#ifdef AASTEP\r
    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\r
#endif\r
\r
        a = texStep(0.5, v_uv);\r
\r
#ifdef AASTEP\r
    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\r
        a = texSmooth(0.5, v_uv);\r
    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\r
        a = aastep3h(0.5, v_uv);\r
    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\r
        a = aastep3v(0.5, v_uv);\r
    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\r
        a = aastep3x3(0.5, v_uv);\r
    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\r
        a = aastep4x4(0.5, v_uv);\r
    }\r
#endif\r
\r
    /**\r
     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\r
     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\r
     * it's bad for IMR, TBR, TBDR and early-Z optimization\r
     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\r
     */\r
    if(a <= 0.0) {\r
        discard;\r
    }\r
    fragColor = vec4(u_color.rgb, u_color.a * a);\r
\r
    /* use when pre-multiplied color is required. */\r
    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\r
}\r
`},1616:p=>{p.exports=`precision mediump float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
\r
#extension GL_EXT_draw_buffers : enable\r
attribute vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ] */\r
attribute vec4 a_texCoord;\r
attribute vec3 a_origin;\r
attribute vec3 a_tangent;\r
attribute vec3 a_up;\r
\r
#else\r
\r
in vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ]*/\r
in vec4 a_texCoord;\r
in vec3 a_origin;\r
in vec3 a_tangent;\r
in vec3 a_up;\r
\r
#endif\r
\r
\r
uniform mat4 u_viewProjection;\r
uniform vec2 u_ndcOffset;\r
uniform mat4 u_transform;\r
uniform bool u_dynamic;\r
\r
varying vec2 v_uv;\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
void main(void)\r
{\r
    /* TEXTURE COORDS */\r
\r
    /* flip y-coordinates */\r
    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\r
\r
    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\r
\r
    /* POSITIONING */\r
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\r
     * 2-------4\r
     * |  \\    |\r
     * |    \\  |\r
     * 1-------3\r
     * The current vertex is calculated based on the current quad corners and the tangent attributes.\r
     * The following lines are optimized for MAD optimization.\r
     */\r
    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\r
    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\r
\r
    if(u_dynamic) {\r
        vertex = u_transform * vertex;\r
    }\r
    vertex = u_viewProjection * vertex;\r
\r
    ndcOffset(vertex, u_ndcOffset);\r
    gl_Position = vertex;\r
}\r
`},7032:p=>{p.exports=j_()},421:p=>{p.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},3058:p=>{p.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},6399:p=>{p.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},9148:p=>{p.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},7857:p=>{p.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')}},n={};function g(p){var t=n[p];if(t!==void 0)return t.exports;var i=n[p]={exports:{}};return T[p].call(i.exports,i,i.exports,g),i.exports}g.d=(p,t)=>{for(var i in t)g.o(t,i)&&!g.o(p,i)&&Object.defineProperty(p,i,{enumerable:!0,get:t[i]})},g.o=(p,t)=>Object.prototype.hasOwnProperty.call(p,t),g.r=p=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},g(4985);var y=g(8184);Xf.exports=y})();var C=Xf.exports;const D2=Sv(C),dg=Av({__proto__:null,default:D2},[C]),Ue=class Ue{constructor(n,g,y){this._lastChild=Ue.INVALID_INDEX,this.index=Ue.INVALID_INDEX,this.id=Ue.INVALID_ID,this.depth=Ue.INVALID_DEPTH,this.parent=Ue.INVALID_INDEX,this.firstChild=Ue.INVALID_INDEX,this.initialFirstChild=Ue.INVALID_INDEX,this.nextSibling=Ue.INVALID_INDEX,this.initialNextSibling=Ue.INVALID_INDEX,this.id=n,this.index=g,y!==void 0?(this.depth=y.depth+1,this.parent=y.index,y.initialFirstChild===Ue.INVALID_INDEX&&(y.initialFirstChild=g,y.firstChild=g),y._lastChild=g):this.depth=0}get lastChild(){return this._lastChild}get isLeaf(){return this.firstChild===Ue.INVALID_INDEX}get isRoot(){return this.parent===Ue.INVALID_INDEX}};Ue.INVALID_ID=-1,Ue.INVALID_INDEX=-1,Ue.INVALID_DEPTH=-1,Ue.INVALID_HEIGHT=-1;let Fe=Ue;class j2{constructor(){this._slices=[]}clear(){this._slices=[]}slice(n){if(!(n<0||n>=this._slices.length))return this._slices[n]}startSlice(n){this._slices.push([n,n])}endSlice(n){this._slices[this._slices.length-1][1]=n}nextSlice(n){this.endSlice(n-1),this.startSlice(n)}addSliceByRange(n,g){this._slices.push([n,g])}addSliceByLength(n){if(this.length===0){this._slices.push([0,n-1]);return}const g=this._slices[this._slices.length-1][1];this._slices.push([g+1,g+n])}sliceDo(n,g){if(n<0||n>=this._slices.length)return;const y=this._slices[n];g(y[0],y[1])}slicesDo(n){for(const g of this._slices)n(g[0],g[1])}get slices(){return this._slices}get numberOfInnerNodes(){return this._slices[this._slices.length-1][0]}get numberOfLeafNodes(){return this.numberOfNodes-this.numberOfInnerNodes}get numberOfNodes(){return this._slices[this._slices.length-1][1]+1}get length(){return this._slices.length}}const wt=C.auxiliaries.assert;class et{constructor(){this._linearization=new j2,this._nodes=new Array,this._innerNodeIndicesById=new Map,this._leafNodeIndicesById=new Map,this._edgeIndexToTopologyIndexMap=new Array,this._topologyIndexToEdgeIndexMap=new Array}fromInterleavedEdgesIdById(n){wt(n.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const g=new Array,y=new Map,p=new Array;g.push(new Fe(n[0],0)),y.set(g[0].id,g[0]),p.push(new Array),p[0].push(g[0]);let t=g[0];for(let i=0;i<n.length;i+=2){const a=[n[i+0],n[i+1]],r=i+2<n.length?[n[i+2],n[i+3]]:[Fe.INVALID_ID,Fe.INVALID_ID];if(t.lastChild!==Fe.INVALID_INDEX){const _=g[t.lastChild];wt(_.nextSibling===Fe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),_.initialNextSibling=g.length,_.nextSibling=g.length}const h=new Fe(a[1],g.length,t);for(g.push(h);p.length<=h.depth;)p.push(new Array);p[h.depth].push(h),y.set(h.id,h),!(r[0]===Fe.INVALID_ID&&r[1]===Fe.INVALID_ID)&&(r[0]===a[1]?t=h:r[0]!==a[0]&&(wt(y.has(r[0]),`expected next parent to be already created, given ${r[0]}`),t=y.get(r[0])))}this.fromNodes(g,p)}fromInterleavedEdgesIndexById(n){wt(n.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const g=new Array,y=new Array;let p=0;for(g.push(new Fe(0,0)),y.push(new Array),y[0].push(g[0]),n[0]===-1&&(p+=2);p<n.length;p+=2){const t=[n[p+0],n[p+1]];let i;if(t[0]<g.length&&n[0]===-1?i=g[t[0]]:(wt(t[0]<g.length,"expected parent to be processed before child"),i=g[t[0]<0?0:t[0]+1]),i.lastChild!==Fe.INVALID_INDEX){const r=g[i.lastChild];wt(r.nextSibling===Fe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),r.initialNextSibling=g.length,r.nextSibling=g.length}const a=new Fe(t[1],g.length,i);g.push(a),y.length===a.depth&&y.push(new Array),y[a.depth].push(a)}this.fromNodes(g,y)}fromNodes(n,g){this._linearization.clear(),this._innerNodeIndicesById.clear(),this._leafNodeIndicesById.clear(),this._edgeIndexToTopologyIndexMap.length=n.length,this._topologyIndexToEdgeIndexMap.length=n.length,this._edgeIndexToTopologyIndexMap.fill(-1),this._topologyIndexToEdgeIndexMap.fill(-1);const y=new Array,p=new Array;for(const a of g){const r=a.filter(_=>_.isLeaf);for(const _ of r)y.push(_);const h=a.filter(_=>!_.isLeaf);h.length>0&&p.push(h)}p.push(y);for(const a of p)this._linearization.addSliceByLength(a.length);const t=new Map;this._nodes.length=n.length,t.set(-1,-1);let i=0;for(const a of p)for(const r of a)this._nodes[i]=r,(r.isLeaf?this._leafNodeIndicesById:this._innerNodeIndicesById).set(r.id,i),t.set(r.index,i),this._edgeIndexToTopologyIndexMap[r.index]=i,this._topologyIndexToEdgeIndexMap[i]=r.index,++i;for(const a of this._nodes)a.index=t.get(a.index),a.parent=t.get(a.parent),a.initialNextSibling=t.get(a.initialNextSibling),a.initialFirstChild=t.get(a.initialFirstChild),a.nextSibling=a.initialNextSibling,a.firstChild=a.initialFirstChild}sliceDo(n,g){const y=(p,t)=>{for(let i=p;i<=t;++i)g(this._nodes[i])};this.sliceRangeDo(n,y)}sliceRangeDo(n,g){this._linearization.sliceDo(n,g)}initialize(n,g,y){switch(g){case et.InputSemantics.ParentIdId:switch(n){case et.InputFormat.Tupled:this.fromInterleavedEdgesIdById([].concat(...y));break;case et.InputFormat.Interleaved:default:wt(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIdById(y);break}break;case et.InputSemantics.ParentIndexId:switch(n){case et.InputFormat.Tupled:this.fromInterleavedEdgesIndexById([].concat(...y));break;case et.InputFormat.Interleaved:default:wt(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIndexById(y);break}break}return!0}node(n){if(!(this._nodes.length<=n))return this._nodes[n]}innerNodeIndexById(n){return this._innerNodeIndicesById.get(n)}leafNodeIndexById(n){return this._leafNodeIndicesById.get(n)}innerNodeById(n){const g=this.innerNodeIndexById(n);if(g!==void 0)return this.node(g)}leafNodeById(n){const g=this.leafNodeIndexById(n);if(g!==void 0)return this.node(g)}forEachInnerNode(n){for(let g=0;g<this.depth-1;++g)this.sliceDo(g,n)}parentsDoUntilDepth(n,g){const y=Math.min(Math.max(n,0),this.depth-1);for(let p=0;p<y;++p)this.sliceDo(p,g)}forEachLeafNode(n){this.sliceDo(this.depth-1,n)}nodesDo(n){this.forEachInnerNode(n),this.forEachLeafNode(n)}reverseNodesDo(n){this.forEachLeafNode(n),this.reverseParentsDo(n)}depthFirstDo(n){n(this.root)}childrenDo(n,g){wt(n!==void 0,"Parent is expected to be valid."),n.firstChild!==Fe.INVALID_INDEX&&this.siblingsDo(this.node(n.firstChild),g)}siblingsDo(n,g){let y=n;for(g(y);y.nextSibling!==Fe.INVALID_INDEX;)y=this.node(y.nextSibling),g(y)}siblingsRangeDo(n,g,y){if(g===void 0)return this.siblingsDo(n,y);for(let p=n;p!==void 0&&p!==g;p=this.node(p.nextSibling))y(p)}reverseParentsDo(n){for(let g=this.depth-2;g>=0;--g)this.sliceDo(g,n)}get linearization(){return this._linearization}get numberOfNodes(){return this._linearization.numberOfNodes}get numberOfInnerNodes(){return this._linearization.numberOfInnerNodes}get numberOfLeafNodes(){return this._linearization.numberOfLeafNodes}get depth(){return this._linearization.length}get root(){return this._nodes[0]}get nodes(){return this._nodes}get edgeIndexToTopologyIndexMap(){return this._edgeIndexToTopologyIndexMap}get topologyIndexToEdgeIndexMap(){return this._topologyIndexToEdgeIndexMap}}(T=>{(n=>{n.Interleaved="interleaved",n.Tupled="tupled"})(T.InputFormat||(T.InputFormat={})),(n=>{n.ParentIdId="parent-id-id",n.ParentIndexId="parent-index-id"})(T.InputSemantics||(T.InputSemantics={})),(n=>{n.TopDown="top-down",n.BottomUp="bottom-up",n.DepthFirst="depth-first"})(T.IterationDirection||(T.IterationDirection={}))})(et||(et={}));const gt=C.auxiliaries.assert,k2=C.auxiliaries.log,uu=C.auxiliaries.logIf,Hs=C.auxiliaries.LogLevel;var vs;(T=>{function n(m,v){const f=new Array(m.numberOfNodes);let b;if(v.topology.format===et.InputFormat.Interleaved){const x=v.topology.edges,E=2*(m.numberOfNodes-1);uu(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),b=O=>{const S=2*(O-1);return gt(S<x.length,`expected an index within the ranges of edges but got ${O}`),S<x.length?[x[S+0],x[S+1]]:[Fe.INVALID_INDEX,Fe.INVALID_INDEX]}}else{const x=v.topology.edges,E=m.numberOfNodes-1;uu(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),b=O=>(gt(O-1<x.length,`expected an index within the ranges of edges but got${O}`),O-1<x.length?x[O-1]:[Fe.INVALID_INDEX,Fe.INVALID_INDEX])}f[0]=0;for(let x=1;x<m.numberOfNodes;x++){let E;const O=b(x);x+1<m.numberOfNodes&&b(x+1)[0]===O[1]?E=m.innerNodeIndexById(O[1]):E=m.leafNodeIndexById(O[1]),gt(E!==void 0,`expected a valid index, given ${E} for ${O[1]}`),f[x]=E}return f}T.normalization_backup=n;function g(m,v){const f=new Float32Array(v.length);uu(v.length!==m.length,Hs.Warning,`expected value buffer to be sized with the number of nodes but got ${m.length} instead of ${v.length}`);for(let b=0;b<f.length;++b)f[v[b]]=m[b];return f}T.renormalize=g;function y(m,v,f){const b=new Float32Array(f.length);switch(b.fill(NaN),v.type){case nt.LinearizationMapping.IdMapping:gt(!1,"Id-Mapping not yet implemented");break;case nt.LinearizationMapping.IndexMapping:for(let x=0;x<m.length;++x){let E=v.mapping[x];E!==void 0&&(b[f[E]]=m[x])}break}return b}T.renormalize_using_intermediate_linearization=y;function p(m,v,f,b,x){for(const E of b)switch(E.type){case"normalize":T.applyNormalization(m,f,E);break;case"range-transform":T.applyRangeTransform(m,f,E);break;case"propagate-up":T.applyPropagation(m,f,E);break;case"fill-invalid":T.applyFill(m,f,E);break;case"mask":T.applyMask(m,f,E);break;case"clamp":T.applyClamp(m,f,E);break;case"threshold":T.applyThreshold(m,f,E);break;case"compare":T.applyCompare(m,f,E);break;case"transform":T.applyTransform(m,v,f,E,x);break;case"discretize":T.applyDiscretization(m,f,E);break;case"callback":T.applyCallback(m,f,E);break}return f}T.applyTransformations=p;function t(m,v,f){if(m.numberOfLeafNodes===0)return;let b=0,x=1;switch(f.operation){case"zero-to-max":{let E;m.forEachLeafNode(O=>{const S=v[O.index];E=E===void 0?S:Math.max(E,S)}),gt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),b=0,x=1/E}break;case"min-to-max":{let E,O;m.forEachLeafNode(S=>{const w=v[S.index];E=E===void 0?w:Math.max(E,w),O=O===void 0?w:Math.min(O,w)}),gt(E!==void 0,"Valid max expected"),gt(O!==void 0,"Valid min expected"),O===void 0&&(O=0),E===void 0&&(E=1),b=-O,x=1/(E-O)}break;case"sign-agnostic-max":{let E;m.forEachLeafNode(O=>{const S=Math.abs(v[O.index]);E=E===void 0?S:Math.max(E,S)}),gt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),b=0,x=1/E}break}v.forEach((E,O)=>{v[O]=(v[O]+b)*x})}T.applyNormalization=t;function i(m,v,f){if(m.numberOfLeafNodes===0||f.sourceRange===void 0||f.targetRange===void 0)return;const b=f.sourceRange,x=f.targetRange,E=-b[0],O=x[0],S=b[1]===b[0]?0:(x[1]-x[0])/(b[1]-b[0]);for(let w=0;w<v.length;w++)v[w]<b[0]?v[w]=-1:v[w]=O+(v[w]+E)*S}T.applyRangeTransform=i;function a(m,v,f){if(m.numberOfLeafNodes!==0)switch(f.operation){case"average":m.reverseParentsDo(b=>{let x=0,E=0;m.childrenDo(b,O=>{const S=v[O.index];x+=S,++E}),v[b.index]=E===0?0:x/E});break;case"sum":m.reverseParentsDo(b=>{let x=0;m.childrenDo(b,E=>{const O=v[E.index];x+=O}),v[b.index]=x});break;case"min":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const O=v[E.index];x=x===void 0?O:Math.min(O,x)}),x===void 0&&(x=0),v[b.index]=x});break;case"max":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const O=v[E.index];x=x===void 0?O:Math.max(O,x)}),x===void 0&&(x=0),v[b.index]=x});break;case"median":m.reverseParentsDo(b=>{const x=new Array;m.childrenDo(b,E=>{const O=v[E.index];x.push(O)}),x.sort(),x.length%2===0?v[b.index]=(x[x.length/2]+x[x.length/2])/2:v[b.index]=x[x.length/2]});break;case"closest-to-zero":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const O=v[E.index];(x===void 0||Math.abs(O)<Math.abs(x))&&(x=O)}),x===void 0&&(x=0),v[b.index]=x});break;case"closest-to-infinity":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const O=v[E.index];(x===void 0||Math.abs(O)>Math.abs(x))&&(x=O)}),x===void 0&&(x=0),v[b.index]=x});break;default:k2(Hs.Warning,"Transformation type not recognized.");break}}T.applyPropagation=a;function r(m,v,f){const b=f.value,x="invalidValue"in f?f.invalidValue:void 0;m.nodesDo(E=>{v[E.index]===x&&(v[E.index]=b)})}T.applyFill=r;function h(m,v,f){let b,x;"range"in f?(b=f.range[0],x=f.range[0]):(b=f.min,x=f.max),gt(b<=x,"Require valid min-max range."),m.nodesDo(E=>{const O=v[E.index];O!==void 0&&(v[E.index]=Math.min(x,Math.max(b,O)))})}T.applyClamp=h;function _(m,v,f){const b=f.value;m.nodesDo(x=>{v[x.index]=v[x.index]===b?1:0})}T.applyMask=_;function d(m,v,f){const b=f.value;m.nodesDo(x=>{v[x.index]=v[x.index]>=b?1:0})}T.applyThreshold=d;function c(m,v,f){const b=f.value;m.nodesDo(x=>{v[x.index]=v[x.index]>b?1:v[x.index]<b?-1:0})}T.applyCompare=c;function s(m,v,f,b,x){const E=b.operation,O=b.parameter,S=b.buffer;let w=P=>O;if(S!==void 0){const P=nt.create(m,v,S,x);P!==void 0&&(w=N=>P[N.index])}switch(E){case"min":m.nodesDo(P=>{f[P.index]=Math.min(f[P.index],w(P))});break;case"max":m.nodesDo(P=>{f[P.index]=Math.max(f[P.index],w(P))});break;case"add":m.nodesDo(P=>{f[P.index]=f[P.index]+w(P)});break;case"subtract":m.nodesDo(P=>{f[P.index]=f[P.index]-w(P)});break;case"multiply":m.nodesDo(P=>{f[P.index]=f[P.index]*w(P)});break;case"divide":m.nodesDo(P=>{f[P.index]=f[P.index]/w(P)});break;case"inverse":m.nodesDo(P=>{f[P.index]=1/f[P.index]});break;case"pow":m.nodesDo(P=>{f[P.index]=Math.pow(f[P.index],w(P))});break;case"nth-root":m.nodesDo(P=>{const N=1/w(P);f[P.index]=Math.pow(f[P.index],N)});break;case"log":O!==void 0&&O!==0?m.nodesDo(P=>{const N=Math.log(w(P));f[P.index]=Math.log(f[P.index])/N}):m.nodesDo(P=>{f[P.index]=Math.log(f[P.index])});break;case"square":m.nodesDo(P=>{f[P.index]=Math.pow(f[P.index],2)});break;case"square-root":m.nodesDo(P=>{f[P.index]=Math.sqrt(f[P.index])});break;case"as-multiplier":m.nodesDo(P=>{f[P.index]=Math.abs(f[P.index])});break;case"as-remainder":m.nodesDo(P=>{f[P.index]=1-Math.abs(f[P.index])});break;case"abs":m.nodesDo(P=>{f[P.index]=Math.abs(f[P.index])});break;case"compare":m.nodesDo(P=>{const N=f[P.index],k=w(P);N<k?f[P.index]=-1:N>k?f[P.index]=1:f[P.index]=0});break;default:return}}T.applyTransform=s;function o(m,v,f){gt(!1,"Implementation missing")}T.applyDiscretization=o;function l(m,v,f){const b=f.operation;switch(f.iteration){case et.IterationDirection.TopDown:m.nodesDo(E=>{v[E.index]=b(v[E.index],E,v,m)});break;case et.IterationDirection.DepthFirst:m.reverseNodesDo(E=>{v[E.index]=b(v[E.index],E,v,m)});break;case et.IterationDirection.BottomUp:default:m.depthFirstDo(E=>{v[E.index]=b(v[E.index],E,v,m)});break}}T.applyCallback=l})(vs||(vs={}));const Nf=C.auxiliaries.assert,zf=C.auxiliaries.log,Bf=C.auxiliaries.LogLevel;var nt;(T=>{(i=>{i.String="string",i.Numbers="numbers",i.Uint8="uint8",i.Int8="int8",i.Uint16="uint16",i.Int16="int16",i.Uint32="uint32",i.Int32="int32",i.Float32="float32",i.Float64="float64"})(T.DataType||(T.DataType={})),(i=>{i.Native="native"})(T.Encoding||(T.Encoding={})),(i=>{i.Topology="topology",i.Identity="identity"})(T.Linearization||(T.Linearization={})),(i=>{i.IdMapping="id-mapping",i.IndexMapping="index-mapping"})(T.LinearizationMapping||(T.LinearizationMapping={}));function n(i,a){return i.edgeIndexToTopologyIndexMap}T.createNormalization=n;function g(i,a,r,h){const _=r.indexOf(":");if(_===void 0||_<0){zf(Bf.Error,"Buffer type not recognized.");return}switch(r.substr(0,_)){case"buffer":return T.createSourceBuffer(a,r.substr(_+1),h);case"bufferView":return T.createView(i,a,r.substr(_+1),h);default:zf(Bf.Error,"Buffer type not recognized.");break}}T.create=g;function y(i){if(i.length!==0)return Array.prototype.reduce.apply(i,[(a,r)=>[Math.min(r,a[0]),Math.max(r,a[1])],[1/0,-1/0]])}T.range=y;function p(i,a,r){const h=r.buffers.find(_=>_.identifier===a);if(!(!h||h.encoding!=="native"))return Nf(h.linearization!=="identity","Expect linearization to be of type topology or mapping. Identity is currently unsupported"),ar.isLinearizationMapping(h.linearization)?vs.renormalize_using_intermediate_linearization(h.data,h.linearization,i):(Nf(h.linearization==="topology","Expect linearization to be of type topology or identity."),vs.renormalize(h.data,i))}T.createSourceBuffer=p;function t(i,a,r,h){const _=h.bufferViews.find(c=>c.identifier===r);if(_===void 0)return;const d=T.create(i,a,_.source,h);if(d!==void 0)return _.transformations===void 0||_.transformations.length===0?d:vs.applyTransformations(i,a,d,_.transformations,h)}T.createView=t})(nt||(nt={}));const U2="http://json-schema.org/draft-06/schema#",G2="Treemap Configuration Schema",q2="JSON schema for a treemap configuration object, targeting the treemap renderer module.",W2="object",V2={topology:{type:"object",properties:{format:{type:"string",enum:["interleaved","tupled"],default:"interleaved"},semantics:{type:"string",enum:["parent-id-id","parent-index-id"],default:"parent-id-id"},edges:{type:"array",items:{anyOf:[{type:"integer",minimum:-1},{type:"array",items:{type:"integer",minimum:-1},minItems:2,maxItems:2,uniqueItems:!0}],minItems:0}}},required:["edges"],additionalProperties:!1},buffers:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},type:{type:"string",enum:["numbers","uint8","uint16","int16","uint32","int32","float32","float64"]},encoding:{type:"string",enum:["base64","native"],default:"native"},data:{anyOf:[{type:"array",items:{type:"number"}},{type:"Uint8Array"},{type:"Uint16Array"},{type:"Int16Array"},{type:"Uint32Array"},{type:"Int32Array"},{type:"Float32Array"},{type:"Float64Array"}]},linearization:{anyOf:[{type:"string",enum:["topology","identity"]},{type:"object",properties:{type:{type:"string",enum:["id-mapping","index-mapping"]},mapping:{type:"array",items:{type:"integer"}}},required:["type","mapping"],additionalProperties:!1}],default:"topology"}},required:["identifier","type","data"],additionalProperties:!1}},bufferViews:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},source:{$ref:"/BufferReference"},transformations:{type:"array",items:{anyOf:[{type:"object",properties:{type:{type:"string",enum:["propagate-up"]},operation:{type:"string",enum:["average","sum","min","max","median","closest-to-zero","closest-to-infinity"]},weight:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["fill-invalid"]},value:{type:"number"},invalidValue:{anyOf:[{type:"number"},{type:"null"}]}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["mask"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},min:{type:"number"},max:{type:"number"}},required:["type","min","max"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},range:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","range"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["range-transform"]},sourceRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2},targetRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","sourceRange","targetRange"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["normalize"]},operation:{type:"string",enum:["zero-to-max","min-to-max","sign-agnostic-max"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["threshold"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["compare"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["transform"]},operation:{type:"string",enum:["add","subtract","multiply","divide","inverse","pow","nth-root","log","square","square-root","as-multiplier","as-remainder","abs"]},parameter:{type:"number",default:0},buffer:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},operation:{type:"string",enum:["quantiles","quartiles"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},percentiles:{type:"array",items:{type:"number"}}},required:["type","percentiles"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["callback"]}},required:["type","operation"],additionalProperties:!0}]}}},required:["identifier","source"],additionalProperties:!1}},colors:{type:"array",items:{oneOf:[{type:"object",properties:{identifier:{type:"string"},colorspace:{type:"string",enum:["rgb","hsl","lab","cmyk","hex"],description:"The color space is based on supported webgl-operate color spaces.",default:"hex"},value:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]},values:{type:"array",minItems:2,items:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]}}},required:["identifier","colorspace"],oneOf:[{type:"object",required:["value"]},{type:"object",required:["values"]}],additionalProperties:!1},{type:"object",properties:{identifier:{type:"string"},preset:{type:"string",description:"The preset from a webgl-operate Color Scheme Preset file."},steps:{type:"number",minimum:3,maximum:12,default:5}},required:["identifier","preset"],additionalProperties:!1}]}},layout:{type:"object",properties:{algorithm:{type:"string",enum:["strip","snake","codecity"]},weight:{$ref:"/BufferReference"},aspectRatio:{type:"number",exclusiveMinimum:0,default:1},sort:{type:"object",properties:{algorithm:{type:"string",enum:["ascending","descending","keep"],default:"keep"},key:{anyOf:[{type:"string",enum:["identity","weight"]},{$ref:"/BufferReference"}],default:"identity"}},required:["algorithm"],additionalProperties:!1},siblingMargin:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0}],default:0}},required:["type","value"],additionalProperties:!1},parentPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute","mixed"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0}},required:["type","value"],additionalProperties:!1},accessoryPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"absolute"},direction:{type:"string",enum:["top","left","bottom","right"],default:"bottom"},value:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}]},relativeAreaThreshold:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0},targetAspectRatio:{anyOf:[{type:"number",minimum:0},{type:"null"}],default:null}},required:["value"],additionalProperties:!1}},required:["algorithm","weight"],additionalProperties:!1},geometry:{type:"object",properties:{parentLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:inner"},showRoot:{type:"boolean",default:!1}},additionalProperties:!1},leafLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:leaf"},height:{$ref:"/BufferReference"},colors:{$ref:"/BufferReference"}},additionalProperties:!1},auxiliary:{$ref:"/ColorReference",default:"color:auxiliary"},emphasis:{type:"object",properties:{outline:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},highlight:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},color:{$ref:"/ColorReference",default:"color:emphasis"},outlineWidth:{type:"number",minimum:0,description:"unit: device-independent pixel",default:1.6}},additionalProperties:!1},heightScale:{anyOf:[{type:"string",enum:["SomethingInverseSqrt"]},{type:"number"}],default:.125},outlineWidth:{type:"number",minimum:0,description:"unit: native pixel",default:.8}},required:[],additionalProperties:!1},labels:{type:"object",properties:{names:{anyOf:[{$ref:"/BufferReference"},{type:"object",additionalProperties:{type:"number"}}]},additionallyLabelSet:{type:"array",items:{type:"number",minimum:0}},innerNodeLayerRange:{type:"array",items:{type:"number",minimum:0},minItems:2,maxItems:2,default:[1,2]},numTopInnerNodes:{type:"number",minimum:0,default:0},numTopWeightNodes:{type:"number",minimum:0,default:0},numTopHeightNodes:{type:"number",minimum:0,default:0},numTopColorNodes:{type:"number",minimum:0,default:0}},required:[]}},$2=["topology","layout"],H2=!1,X2={$schema:U2,title:G2,description:q2,type:W2,properties:V2,required:$2,additionalProperties:H2},Y2="/BufferReference",Z2="string",K2="^(buffer|bufferView):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",Q2="Named identifier used to reference a buffer or buffer view throughout the treemap configuration.",J2={id:Y2,type:Z2,pattern:K2,description:Q2},eb="/ColorReference",tb="string",rb="^(color):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",ib="Named identifier used to reference a color throughout the treemap configuration.",nb={id:eb,type:tb,pattern:rb,description:ib},ab="/ColorScheme",sb="object",ob={inverted:{type:"boolean",default:!1},classBounds:{type:"array",items:{type:"number"}}},lb={id:ab,type:sb,properties:ob},je=class je{constructor(){this._altered=Object.assign(new C.ChangeLookup,{any:!1,topology:!1,buffers:!1,bufferViews:!1,colors:!1,layout:{any:!1,weight:!1,sort:!1,algorithm:!1,siblingMargin:!1,parentPadding:!1,accessoryPadding:!1},geometry:{any:!1,aggregation:!1,outlineWidth:!1,emphasis:{any:!1,outline:!1,highlight:!1,outlineWidth:!1},areaScale:!1,heights:!1,heightScale:!1,colors:!1,parentLayer:!1},labels:!1}),this._buffers=[],this._bufferViews=[],this._colors=[]}get altered(){return this._altered}set topology(n){const g=je.TREEMAP_SCHEMA.properties.topology;C.properties.validate(n,g,[])&&(C.properties.complement(n,g),C.properties.compare(n,this._topology,this._altered,"topology"),this._topology=n)}get topology(){return this._topology}set buffers(n){const g=je.TREEMAP_SCHEMA.properties.buffers;C.properties.validate(n,g,[])&&(C.properties.complement(n,g),C.properties.compare(n,this._buffers,this._altered,"buffers"),this._buffers=n)}get buffers(){return this._buffers}set bufferViews(n){const g=je.TREEMAP_SCHEMA.properties.bufferViews;C.properties.validate(n,g,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(C.properties.complement(n,g),C.properties.compare(n,this._bufferViews,this._altered,"bufferViews"),this._bufferViews=n)}get bufferViews(){return this._bufferViews}set colors(n){const g=je.TREEMAP_SCHEMA.properties.colors;C.properties.validate(n,g,[[je.COLOR_REFERENCE_SCHEMA,"/ColorReference"]])&&(C.properties.complement(n,g),C.properties.compare(n,this._colors,this._altered,"colors"),this._colors=n)}get colors(){return this._colors}set layout(n){const g=je.TREEMAP_SCHEMA.properties.layout;C.properties.validate(n,g,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(C.properties.complement(n,g),C.properties.compare(n,this._layout,this._altered,"layout"),this._layout=n)}get layout(){return this._layout}set geometry(n){const g=je.TREEMAP_SCHEMA.properties.geometry;C.properties.validate(n,g,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"],[je.COLOR_REFERENCE_SCHEMA,"/ColorReference"],[je.COLOR_SCHEMA_SCHEMA,"/ColorScheme"]])&&(C.properties.complement(n,g),C.properties.compare(n,this._geometry,this._altered,"geometry"),this._geometry=n)}get geometry(){return this._geometry}set labels(n){const g=je.TREEMAP_SCHEMA.properties.labels;C.properties.validate(n,g,[[je.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(C.properties.complement(n,g),C.properties.compare(n,this._labels,this._altered,"labels"),this._labels=n)}get labels(){return this._labels}labelsToJSON(){const n=Object.assign({},this._labels);return n.names&&typeof n.names!="string"&&(n.names=Object.fromEntries(this._labels.names)),n}toJSON(){return{topology:this.topology,buffers:this.buffers,bufferViews:this.bufferViews,colors:this.colors,layout:this.layout,geometry:this.geometry,labels:this.labelsToJSON()}}};je.TREEMAP_SCHEMA=X2,je.BUFFER_REFERENCE_SCHEMA=J2,je.COLOR_REFERENCE_SCHEMA=nb,je.COLOR_SCHEMA_SCHEMA=lb;let ar=je;(T=>{function n(p){return typeof p=="string"||p instanceof String||p in nt.Linearization?!1:"type"in p&&p.type in nt.LinearizationMapping&&"mapping"in p}T.isLinearizationMapping=n;function g(p){return typeof p!="object"?!1:"identifier"in p&&"colorspace"in p}T.isColorArray=g;function y(p){return typeof p!="object"?!1:"identifier"in p&&"preset"in p}T.isColorPreset=y})(ar||(ar={}));var br;(T=>{function n(p,t="SomethingInverseSqrt"){switch(t){default:case"SomethingInverseSqrt":return C.gl_matrix_extensions.clamp(100/Math.sqrt(p.numberOfNodes)+.0125,.0625,.3333)}}T.heightScale=n,(p=>{p.SomethingInverseSqrt="SomethingInverseSqrt"})(T.HeightScaleApproach||(T.HeightScaleApproach={}));function g(p,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .04+(1-Math.log10(p.numberOfNodes+1)/6)*.12}}T.parentMargin=g;function y(p,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .01+(1-Math.log10(p.numberOfNodes+1)/6)*.12}}T.siblingMargin=y,(p=>{p.SomethingLog10="SomethingLog10"})(T.MarginApproach||(T.MarginApproach={}))})(br||(br={}));var ub=Object.defineProperty,cb=Object.getOwnPropertyDescriptor,hb=(T,n,g,y)=>{for(var p=cb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&ub(n,g,p),p},Oe;const k_=(Oe=class extends C.Geometry{static referenceVerticesVBO(n){let g;Oe.VERTICES_BY_CONTEXT.has(n)?g=Oe.VERTICES_BY_CONTEXT.get(n):(g=new C.Buffer(n,"CuboidVertexVBO"),Oe.VERTICES_BY_CONTEXT.set(n,g),Oe.REFCOUNT_BY_TEMPLATE.set(g,0));const y=Oe.REFCOUNT_BY_TEMPLATE.get(g)+1;return Oe.REFCOUNT_BY_TEMPLATE.set(g,y),g}static unreferenceTemplateVBO(n){if(!Oe.VERTICES_BY_CONTEXT.has(n))return;const g=Oe.VERTICES_BY_CONTEXT.get(n),y=Oe.REFCOUNT_BY_TEMPLATE.get(g)-1;Oe.REFCOUNT_BY_TEMPLATE.set(g,y),!(y>0)&&(g.uninitialize(),Oe.VERTICES_BY_CONTEXT.delete(n),Oe.REFCOUNT_BY_TEMPLATE.delete(g))}constructor(n,g){super(n,g),g=g!==void 0&&g!==""?g:"CuboidGeometry",this._vertices=Oe.referenceVerticesVBO(n),this._buffers.push(this._vertices),this._layout=new C.Buffer(n,`${g}LayoutVBO`),this._buffers.push(this._layout),this._ids=new C.Buffer(n,`${g}IdVBO`),this._buffers.push(this._ids),this._emphases=new C.Buffer(n,`${g}EmphasisVBO`),this._buffers.push(this._emphases),this._areaScales=new C.Buffer(n,`${g}AreaScaleVBO`),this._buffers.push(this._areaScales),this._colors=new C.Buffer(n,`${g}ColorVBO`),this._buffers.push(this._colors),this._heights=new C.Buffer(n,`${g}HeightVBO`),this._buffers.push(this._heights)}bindBuffers(n){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,20,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._vertices.attribEnable(this._texCoordLocation,2,g.FLOAT,!1,20,12,!0,!1),y.vertexAttribDivisor(this._texCoordLocation,0),this._layout.attribEnable(this._layoutLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._areaScales.attribEnable(this._areaScaleLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._areaScaleLocation,1),this._colors.attribEnable(this._colorLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1),this._heights.attribEnable(this._heightLocation,2,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._heightLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._vertices.attribDisable(this._texCoordLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._areaScales.attribDisable(this._areaScaleLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1),this._heights.attribDisable(this._heightLocation,!1,!1)}initialize(n=0,g=1,y=2,p=3,t=4,i=5,a=6,r=7){this._vertexLocation=n,this._texCoordLocation=g,this._idLocation=p,this._layoutLocation=y,this._emphasisLocation=t,this._areaScaleLocation=i,this._colorLocation=a,this._heightLocation=r;const h=this.context.gl,_=super.initialize([h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER]);return this._vertices.data(Oe.DATA,h.STATIC_DRAW),_&&this._vertices.valid}uninitialize(){Oe.unreferenceTemplateVBO(this.context),this._layout.uninitialize(),this._ids.uninitialize(),this._emphases.uninitialize(),this._areaScales.uninitialize(),this._colors.uninitialize(),this._heights.uninitialize(),super.uninitialize()}update(){this.bind()}draw(n=0,g=0,y=0){const p=this.context.gl,t=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,p.FLOAT,!1,20,g,!0,!1),this._vertices.attribEnable(this._texCoordLocation,2,p.FLOAT,!1,20,12+g,!0,!1),this._ids.attribEnable(this._idLocation,4,p.UNSIGNED_BYTE,!1,4,n*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,p.FLOAT,!1,16,n*16,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._areaScales.attribEnable(this._areaScaleLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._colors.attribEnable(this._colorLocation,1,p.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._heights.attribEnable(this._heightLocation,2,p.UNSIGNED_BYTE,!1,2,n*2,!0,!1),t.drawArraysInstanced(p.TRIANGLE_STRIP,0,4,y)}set layout(n){const g=this.context.gl;this._layout.data(n,g.STATIC_DRAW)}set ids(n){const g=this.context.gl;this._ids.data(n,g.STATIC_DRAW)}set areaScales(n){const g=this.context.gl;this._areaScales.data(n,g.STATIC_DRAW)}set colors(n){const g=this.context.gl;this._colors.data(n,g.STATIC_DRAW)}set emphases(n){const g=this.context.gl;this._emphases.data(n,g.STATIC_DRAW)}set heights(n){const g=this.context.gl;this._heights.data(n,g.STATIC_DRAW)}get valid(){const n=this._layout&&this._layout.valid,g=this._ids&&this._ids.valid,y=this._areaScales&&this._areaScales.valid,p=this._colors&&this._colors.valid,t=this._emphases&&this._emphases.valid,i=this._heights&&this._heights.valid;return this.initialized&&this._vertices.valid&&n&&g&&y&&p&&t&&i}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get areaScaleLocation(){return this._areaScaleLocation}get colorLocation(){return this._colorLocation}get heightLocation(){return this._heightLocation}},Oe.VERTICES_BY_CONTEXT=new Map,Oe.REFCOUNT_BY_TEMPLATE=new Map,Oe.DATA=new Float32Array([0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,0,0,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,1,1,1,1]),Oe.BYTES_PER_VERTEX=Oe.DATA.length/6,Oe);hb([C.Initializable.assert_initialized()],k_.prototype,"draw");let Df=k_;var db=Object.defineProperty,fb=Object.getOwnPropertyDescriptor,U_=(T,n,g,y)=>{for(var p=fb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&db(n,g,p),p};const er=C.auxiliaries.assert;class Et extends C.Initializable{constructor(n){super(),this._context=n}initializeES2_basic(n,g){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!0,this._colorRenderTexture.initialize(n,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,g,y.RGB,y.RGB,y.UNSIGNED_BYTE),this._depthStencilRenderbuffer.initialize(n,g,y.DEPTH_STENCIL),this._depthFBO=new C.Framebuffer(this._context,"DepthFBO"),this._idFBO=new C.Framebuffer(this._context,"IdFBO"),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.initialize([[p.COLOR_ATTACHMENT0,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.clearColor([1,1,1,1],0),this._depthFBO.initialize([[p.COLOR_ATTACHMENT0,this._depthStencilRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._depthFBO.clearColor([1,1,1,1],0)}initializeES2_extensions(n,g){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!1,this._context.isWebGL1&&(er(this._context.supportsDrawBuffers,"expected WEBGL_draw_buffers to be supported"),er(this._context.supportsDepthTexture,"expected WEBGL_depth_texture to be supported")),this._colorRenderTexture.initialize(n,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,g,y.DEPTH_STENCIL,y.DEPTH_STENCIL,this._context.depthTexture.UNSIGNED_INT_24_8_WEBGL),this._depthStencilRenderbuffer.initialize(n,g,y.DEPTH_STENCIL),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[p.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO=new C.Framebuffer(this._context,"IdFBO"),this._idFBO.initialize([[p.COLOR_ATTACHMENT0,this._idRenderTexture]])}initializeES3(n,g){const y=this._context.gl,p=this._context.gl2facade;this._drawRestricted=!1,er(this._context.isWebGL2,"expected a webgl2 context"),this._colorRenderTexture.initialize(n,g,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(n,g,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(n,g,y.DEPTH24_STENCIL8,y.DEPTH_STENCIL,y.UNSIGNED_INT_24_8),this._depthStencilRenderbuffer.initialize(n,g,y.DEPTH24_STENCIL8),this._primaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[p.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[p.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]])}initialize(){this._defaultFBO=new C.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new C.Texture2D(this._context,"ColorRenderTexture"),this._idRenderTexture=new C.Texture2D(this._context,"IdRenderTexture"),this._depthStencilRenderTexture=new C.Texture2D(this._context,"DepthStencilRenderTexture"),this._depthStencilRenderbuffer=new C.Renderbuffer(this._context,"DepthStencilRenderbuffer"),this._primaryFBO=new C.Framebuffer(this._context,"PrimaryFBO"),this._secondaryFBO=new C.Framebuffer(this._context,"SecondaryFBO");const n=this._defaultFBO.width,g=this._defaultFBO.height;return this._context.isWebGL2?this.initializeES3(n,g):this._context.supportsDepthTexture&&this._context.supportsDrawBuffers&&this._context.gl.getParameter(this._context.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)>=2?this.initializeES2_extensions(n,g):this.initializeES2_basic(n,g),this._primaryFBO.clearColor([0,0,0,1],0),this._secondaryFBO.clearColor([0,0,0,1],0),this._primaryFBO.clearDepth(C.ReadbackPass.maxClearDepth()),this._primaryFBO.clearStencil(0),this._secondaryFBO.clearDepth(C.ReadbackPass.maxClearDepth()),this._secondaryFBO.clearStencil(0),er(this._primaryFBO.valid,`${this._primaryFBO.identifier} expected to be valid for rendering`),er(this._secondaryFBO.valid,`${this._secondaryFBO.identifier} expected to be valid for rendering`),er(this._idFBO===void 0||this._idFBO.valid,`${this._idFBO?this._idFBO.identifier:""} expected to be valid for rendering`),er(this._depthFBO===void 0||this._depthFBO.valid,`${this._depthFBO?this._depthFBO.identifier:""} expected to be valid for rendering`),!0}uninitialize(){this._defaultFBO.uninitialize(),this._primaryFBO.uninitialize(),this._idFBO&&this._idFBO.uninitialize(),this._depthFBO&&this._depthFBO.uninitialize(),this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.uninitialize(),this._colorRenderTexture.uninitialize(),this._idRenderTexture.uninitialize(),this._depthStencilRenderTexture.uninitialize()}setClearColor(n){this._primaryFBO.clearColor(n,0),this._secondaryFBO.clearColor(n,0)}resize(n,g){this._primaryFBO.resize(n,g),this._secondaryFBO.resize(n,g),this._idFBO&&this._idFBO.resize(n,g),this._depthFBO&&this._depthFBO.resize(n,g)}get drawRestricted(){return this._drawRestricted}get primaryFBO(){return this._primaryFBO}get secondaryFBO(){return this._secondaryFBO}get defaultFBO(){return this._defaultFBO}get depthFBO(){return this._drawRestricted?this._depthFBO:void 0}get idFBO(){return this._drawRestricted?this._idFBO:void 0}get readBackIdFBO(){return this._idFBO}get colorRenderTexture(){return this._colorRenderTexture}get idRenderTexture(){return this._idRenderTexture}}U_([C.Initializable.initialize()],Et.prototype,"initialize");U_([C.Initializable.uninitialize()],Et.prototype,"uninitialize");(T=>{(n=>{n[n.Undefined=-1]="Undefined",n[n.Color=0]="Color",n[n.Id=1]="Id",n[n.Depth=2]="Depth"})(T.Attachment||(T.Attachment={}))})(Et||(Et={}));var _b=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec3  a_vertex;
attribute vec4  a_layout; 
attribute vec4  a_id; /* encoded uint32 id in byte4 */
attribute float a_areaScale;
attribute float a_color;
attribute float a_emphasis;
attribute vec2  a_heights; /* [ bottom: float, top: float ] */
attribute vec2  a_texCoord;

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec3  a_vertex;
in vec4  a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4  a_id; /* encoded uint32 id in byte4 */
in float a_areaScale;
in float a_color;
in float a_emphasis;
in vec2  a_heights; /* [ bottom: float, top: float ] */
in vec2  a_texCoord;

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform int u_face;
uniform vec4 u_normalAndLambert;

uniform float u_heightScale;
uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec4 v_uv;

const float ONE_OVER_255 = 1.0 / 255.0;
const int FACE_INDEX_TOP = 1; /* see CuboidRenderPass.FaceIndex.Top */

const vec3 AMBIENT = vec3(0.0, 0.0, 0.0); /* @todo expose to API */
const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

/**
 * Transforms the cuboid vertices based on the associated face and height mapping. An earlier implementation of this
 * used the same geometry template and transformed it to either orientation. The current implementation uses a pre-set
 * vertex sequence/orientation and has to adjust the height only.
 * Appart from that, each cuboid face is moved to its position and adjusted to the provided height values. ID, color,
 * and extent along the y-axis are encoded per vertex (or even per face/cuboid) to reduce per-fragment processing.
 */
void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    float height = (a_heights[1] - a_heights[0]) * u_heightScale;

    /* Compute the position and extend of the cuboid based on the face. */
    vec4 pos = vec4(a_layout[0], u_face == FACE_INDEX_TOP ?
        a_heights[1] * u_heightScale : a_heights[0] * u_heightScale, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], height, a_layout[3], 1.0);

    /* Area scaling */
    float shrinkage = 1.0 - a_areaScale * ONE_OVER_255;
    pos.x += ext.x * shrinkage * 0.5;
    pos.z += ext.z * shrinkage * 0.5;
    ext.x -= ext.x * shrinkage;
    ext.z -= ext.z * shrinkage;

    /* Compute the final vertex position and pass through texture coordinates and layout data. */
    vec4 vertex = vec4(a_vertex, 1.0) * ext + pos;

    v_uv.st = a_texCoord.st;
    v_id = a_id * ONE_OVER_255;

    /* The y-extent provides world-space height of the cuboid that can be used for fragment-processing. */
    v_uv[2] = 1.0; 
    v_uv[3] = height / mix(a_layout[2], a_layout[3], step(5.0, float(u_face)));

    /* REVIEW AND SIMPLIFY THE FOLLOWING COLOR COMPUTATION (probably to many states) */

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    int colorIndex = int(abs(a_color - 32.0));
    v_baseColor = mix(u_colorTable[colorIndex], emphasisColor, step(2.0, a_emphasis));

    vertex = u_viewProjection * vertex;

    v_uv[2] *= (a_texCoord.x - 0.5);
    v_uv[3] *= 1.0 - a_texCoord.y;

    v_baseColor = u_colorTable[colorIndex];
    v_baseColor = mix(v_baseColor, emphasisColor, step(2.0, a_emphasis));

    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline should be darkened based on the face orientation. */
    v_outlineColor.rgb = mix(AMBIENT, v_outlineColor.rgb, u_normalAndLambert[3]);
    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    v_baseColor = mix(vec4(AMBIENT, 1.0), v_baseColor, u_normalAndLambert[3]);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,pb=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

uniform int u_face;

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;

varying vec4 v_id;
varying vec4 v_uv;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];
    vec2 awidth2 = fwidth(v_uv.zw);

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step(v_uv.st - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(1.0), v_uv.st + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,vb=Object.defineProperty,mb=Object.getOwnPropertyDescriptor,Er=(T,n,g,y)=>{for(var p=mb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&vb(n,g,p),p};const bb=C.auxiliaries.log,gb=C.auxiliaries.LogLevel;var pe;const hr=(pe=class extends C.Initializable{constructor(n){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new C.ChangeLookup,{any:!0,camera:!0,geometry:!0,colorTable:!0,colorTableLength:!0,emphases:!0,heightScale:!0,outlineWidth:!0,emphasisOutlineWidth:!0}),this._outlineWidth=pe.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=pe.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Et.Attachment.Undefined,this._faceSequence=new Array,this._faceData=new Map,this._context=n,this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._program=new C.Program(n,"CuboidRenderProgram"),this._geometry=pe.referenceGeometry(n)}static referenceGeometry(n){let g;pe.GEOMETRY_BY_CONTEXT.has(n)?g=pe.GEOMETRY_BY_CONTEXT.get(n):(g=new Df(n,"CuboidGeometry"),g.initialize(),pe.GEOMETRY_BY_CONTEXT.set(n,g),pe.REFCOUNT_BY_GEOMETRY.set(g,0));const y=pe.REFCOUNT_BY_GEOMETRY.get(g)+1;return pe.REFCOUNT_BY_GEOMETRY.set(g,y),g}static unreferenceGeometry(n){if(!pe.GEOMETRY_BY_CONTEXT.has(n))return;const g=pe.GEOMETRY_BY_CONTEXT.get(n),y=pe.REFCOUNT_BY_GEOMETRY.get(g)-1;pe.REFCOUNT_BY_GEOMETRY.set(g,y),!(y>0)&&(g.uninitialize(),pe.GEOMETRY_BY_CONTEXT.delete(n),pe.REFCOUNT_BY_GEOMETRY.delete(g))}relink(){if(this._colorTable===void 0){bb(gb.Warning,"Color table is not defined. Could not compile shaders.");return}for(const n of this._program.shaders)n.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_areaScale",this._geometry.areaScaleLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation),this._program.attribute("a_heights",this._geometry.heightLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation);for(const n of this._program.shaders)n.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uFace=this._program.uniform("u_face"),this._uNormalAndLambert=this._program.uniform("u_normalAndLambert"),this._uHeightScale=this._program.uniform("u_heightScale"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}optimizeFaceSequence(){const n=this._camera.eye,g=this._camera.center;let y=new Array;const p=C.vec3.create();C.vec3.sub(p,n,g),C.vec3.normalize(p,p),n[1]>0&&y.push([pe.Face.Top,Math.abs(C.vec3.dot(C.vec3.fromValues(0,1,0),p))]),n[2]>-1&&y.push([pe.Face.Front,Math.abs(C.vec3.dot(C.vec3.fromValues(0,0,1),p))]),n[2]<1&&y.push([pe.Face.Back,Math.abs(C.vec3.dot(C.vec3.fromValues(0,0,-1),p))]),n[0]>-1&&y.push([pe.Face.Left,Math.abs(C.vec3.dot(C.vec3.fromValues(1,0,0),p))]),n[0]<1&&y.push([pe.Face.Right,Math.abs(C.vec3.dot(C.vec3.fromValues(-1,0,0),p))]),y=y.sort((t,i)=>i[1]-t[1]),this._faceSequence=y.map(t=>t[0])}initialize(){const n=this._context.gl;this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const g=new C.Shader(this._context,n.VERTEX_SHADER,"cuboid.vert");g.initialize(_b,!1);const y=new C.Shader(this._context,n.FRAGMENT_SHADER,"cuboid.frag");return y.initialize(pb,!1),this._program.initialize([g,y],!1),this._faceData.set(pe.Face.Top,[0,1,0,1]),this._faceData.set(pe.Face.Bottom,[0,-1,0,.68]),this._faceData.set(pe.Face.Front,[0,0,1,.88]),this._faceData.set(pe.Face.Back,[0,0,-1,.88]),this._faceData.set(pe.Face.Left,[1,0,0,.84]),this._faceData.set(pe.Face.Right,[-1,0,0,.84]),!0}uninitialize(){pe.unreferenceGeometry(this._context),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uFace=void 0,this._uNormalAndLambert=void 0,this._uHeightScale=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const n=this._context.gl;let g=!1;if(!this._program.initialized||!this._program.linked||this._altered.colorTableLength){if(this.relink(),!this._program.linked)return;g=!0}if(this._program.bind(),(g||this._altered.camera||this._camera.altered)&&(n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this.optimizeFaceSequence()),(g||this._colorTable)&&n.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),(g||this._altered.heightScale)&&n.uniform1f(this._uHeightScale,this._heightScale/255),(g||this._altered.outlineWidth)&&n.uniform1f(this._uOutlineWidth,this._outlineWidth),g||this._altered.emphasisOutlineWidth){const y=window.devicePixelRatio;n.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*y)}this._altered.reset()}frame(){if(C.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0||this._geometry.valid===void 0)return;const n=this._context.gl,g=this._target.size;n.viewport(0,0,g[0],g[1]),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,2,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),this._drawRestricted&&n.uniform1i(this._uAttachment,this._attachment),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind();for(const y of this._faceSequence){n.uniform1i(this._uFace,y),n.uniform4fv(this._uNormalAndLambert,this._faceData.get(y));const p=(y-1)*Df.BYTES_PER_VERTEX*4;this._topology.sliceRangeDo(this._topology.depth-1,(t,i)=>{const a=t-this._topology.numberOfInnerNodes,r=i-t+1;this._geometry.draw(a,p,r)})}this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.STENCIL_TEST),n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE)}colorTableLengthAltered(){this._altered.alter("colorTableLength")}set target(n){this.assertInitialized(),this._target=n}set topology(n){this._topology=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set layoutData(n){this.assertInitialized(),this._geometry.layout=n,this._altered.alter("geometry")}set ids(n){this.assertInitialized(),this._geometry.ids=n,this._altered.alter("geometry")}set areaScales(n){this.assertInitialized(),this._geometry.areaScales=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set emphases(n){this.assertInitialized(),this._geometry.emphases=n,this._altered.alter("emphases")}set heights(n){this.assertInitialized(),this._geometry.heights=n,this._altered.alter("geometry")}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}set outlineWidth(n){this.assertInitialized(),this._outlineWidth!==n&&(this._outlineWidth=n===void 0?pe.OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth!==n&&(this._emphasisOutlineWidth=n===void 0?pe.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("emphasisOutlineWidth"))}set heightScale(n){this.assertInitialized(),this._heightScale!==n&&(this._heightScale=n===void 0?0:C.gl_matrix_extensions.clamp(n,0,1),this._altered.alter("heightScale"))}set attachment(n){C.auxiliaries.logIf(n!==Et.Attachment.Undefined&&!this._drawRestricted,C.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=n}set depthMask(n){this._depthMask=n}},pe.GEOMETRY_BY_CONTEXT=new Map,pe.REFCOUNT_BY_GEOMETRY=new Map,pe.OUTLINE_WIDTH_DEFAULT=.8,pe.EMPHASIS_OUTLINE_WIDTH_DEFAULT=1.6,pe);Er([C.Initializable.assert_initialized()],hr.prototype,"relink");Er([C.Initializable.assert_initialized()],hr.prototype,"optimizeFaceSequence");Er([C.Initializable.initialize()],hr.prototype,"initialize");Er([C.Initializable.uninitialize()],hr.prototype,"uninitialize");Er([C.Initializable.assert_initialized()],hr.prototype,"update");Er([C.Initializable.assert_initialized()],hr.prototype,"frame");let rr=hr;(T=>{(n=>{n[n.Top=1]="Top",n[n.Bottom=2]="Bottom",n[n.Front=3]="Front",n[n.Back=4]="Back",n[n.Left=5]="Left",n[n.Right=6]="Right"})(T.Face||(T.Face={}))})(rr||(rr={}));var _s=j_();const ps=C.gl_matrix_extensions.v2,ze=C.gl_matrix_extensions.v3,jf=C.gl_matrix_extensions.sign,kf=C.gl_matrix_extensions.clamp,cu=C.gl_matrix_extensions.clamp3,vr=C.auxiliaries.DEG2RAD,hu=C.auxiliaries.assert;class Xs{constructor(){this.screen=C.vec2.create(),this.world=C.vec3.create()}}const Ke=class Ke extends C.CameraModifier{constructor(){super(...arguments),this.initialPoints=[new Xs,new Xs],this.currentPoints=[new Xs,new Xs],this.initialEye=C.vec3.create(),this.initialCenter=C.vec3.create(),this.initialViewProjectionInverse=C.mat4.create(),this._xAxisScreenSpace=C.vec3.create(),this._maxAngles=[+Math.PI*.6666-Math.PI,60*vr-Math.PI],this._minAngles=[-Math.PI*.6666-Math.PI,-Math.PI+1*vr],this.referencePlane=[C.vec3.create(),C.vec3.create(),0]}get valid(){return this.initialPoints[0].world!==void 0}set camera(n){this._camera=n}needStart(){return this._maxAngles===void 0||this._minAngles===void 0}set coordsAccess(n){this._coordsAccess=n}static rayY0SquareIntersection(n,g){const y=C.ray_math.rayPlaneIntersection(n,g);if(y===void 0)return;const p=C.vec2.fromValues(y[0],y[2]);return C.ray_math.isPointWithinSquare(p,Ke.HALF_SQUARE_LENGTH)?y:void 0}assert_valid(){}invalidate(){this.initialPoints[0].world=void 0,this.currentPoints[0].world=void 0,this.initialPoints[1].world=void 0,this.currentPoints[1].world=void 0}initiateTranslateConstraints(n){if(n){this._maxNegativeTranslate=void 0,this._maxPositiveTranslate=void 0;return}const g=C.vec3.fromValues(-1,0,-1),y=C.vec3.fromValues(1,0,1);this._maxNegativeTranslate=C.vec3.sub(ze(),g,this.initialCenter),this._maxPositiveTranslate=C.vec3.sub(ze(),y,this.initialCenter)}initiateScaleConstraints(n){const g=C.vec3.sub(ze(),this.initialEye,this.initialCenter),y=1/C.vec3.length(g);if(n){this._minScale=this._camera.near*y-1,this._maxScale=this._camera.far*y-1;return}C.ray_math.rayPlaneIntersection(this.initialEye,this.initialCenter,[0,0,0],[0,1,0])&&(this._minScale=this._camera.near*Ke.MIN_NEAR_PLANE_FACTOR*y-1,this._maxScale=Ke.MAX_DISTANCE_TO_SQUARE*y-1)}initiateRotateConstraints(n){const g=C.vec3.normalize(ze(),C.vec3.sub(ze(),this.initialEye,this.initialCenter));this._xAxisScreenSpace=C.vec3.cross(ze(),[0,1,0],g);const y=Math.acos(C.vec3.dot(g,[0,1,0]));if(this._maxAngles=[void 0,(90-.01)*vr-y],this._minAngles=[void 0,-y+.01*vr],n)return;const p=C.vec2.normalize(ps(),[g[0],g[2]]);let t=Math.asin(C.vec2.dot(p,[1,0]));p[1]<0&&(t=jf(t)*Math.PI-t),this._maxAngles=[+Math.PI*.6666-t,60*vr-y],this._minAngles=[-Math.PI*.6666-t,-y+1*vr]}initiate(n,g,y=[!1,!1,!1],p=!1){this._override=p;const t=this._camera.viewProjectionInverse;return t?(C.mat4.copy(this.initialViewProjectionInverse,t),C.vec3.copy(this.initialEye,this._camera.eye),C.vec3.copy(this.initialCenter,this._camera.center),C.vec2.copy(this.initialPoints[0].screen,n),this.initialPoints[0].world=this.coordsAt(n,!1),this.initialPoints[0].world===void 0?(this.invalidate(),!1):(this.initialPoints[1].screen=g===void 0?void 0:C.vec2.copy(ps(),g),this.initialPoints[1].world=this.coordsAt(g,!1),this.referencePlane[0]=this.initialPoints[0].world,this.referencePlane[1]=C.vec3.fromValues(0,1,0),this.referencePlane[2]=C.vec3.length(this.initialPoints[0].world),hu(this.initialCenter[1]===0,"camera center is expected to be on y = 0 (ground plane)"),y[0]&&this.initiateTranslateConstraints(p),y[1]&&this.initiateScaleConstraints(p),y[2]&&this.initiateRotateConstraints(p),!0)):!1}update_positions(n,g){return this.assert_valid(),this.currentPoints[0].world=this.coordsAt(n),this._override&&this.currentPoints[0].world===void 0?(this.invalidate(),!1):(C.vec2.copy(this.currentPoints[0].screen,n),g===void 0?!0:(this.currentPoints[1].world=this.coordsAt(g),this._override&&this.currentPoints[1].world===void 0?(this.invalidate(),!1):(this.currentPoints[1].screen=g===void 0?void 0:C.vec2.copy(ps(),g),!0)))}translate(){this.assert_valid();const n=this.initialPoints[0].world,g=this.currentPoints[0].world;if(!n||!g)return;const y=C.vec3.subtract(ze(),n,g);this._maxNegativeTranslate&&this._maxPositiveTranslate&&cu(y,y,this._maxNegativeTranslate,this._maxPositiveTranslate),this._camera.eye=C.vec3.add(ze(),this.initialEye,y);const p=C.vec3.add(ze(),this.initialCenter,y),t=C.ray_math.rayPlaneIntersection(this._camera.eye,p);t&&(this._camera.center=t)}scale(n){this.assert_valid(),hu(this._minScale!==void 0&&this._maxScale!==void 0,"valid scale constraints expected");let g;if(n===void 0){const h=this.currentPoints[0].screen,_=this.initialPoints[0].screen;if(!_||!h)return;g=C.vec2.subtract(ps(),_,h)[1]/window.devicePixelRatio}else g=-jf(n)*Ke.SCALE_STEP_FACTOR;g=kf(g*Ke.SCALE_FACTOR,this._minScale,this._maxScale);const y=this.initialPoints[0].world;if(!y)return;const p=C.vec3.sub(ze(),this.initialEye,y),t=C.vec3.sub(ze(),this.initialCenter,y),i=C.vec3.add(ze(),this.initialEye,C.vec3.scale(ze(),p,g)),a=C.vec3.add(ze(),this.initialCenter,C.vec3.scale(ze(),t,g)),r=C.ray_math.rayPlaneIntersection(this._camera.eye,a);r&&(this._camera.center=this._override?r:cu(ze(),r,[-1,0,-1],[1,0,1]),this._camera.eye=C.vec3.add(ze(),i,C.vec3.sub(ze(),this._camera.center,r)))}rotate(){this.assert_valid();const n=this.currentPoints[0].screen,g=this.initialPoints[0].screen;if(!g||!n)return;const y=C.vec2.subtract(ps(),g,n);C.vec2.scale(y,y,window.devicePixelRatio*Ke.ROTATE_FACTOR),this._minAngles[1]&&this._maxAngles[1]&&(y[1]=kf(y[1],this._minAngles[1],this._maxAngles[1]));const p=this._override?this.initialCenter:cu(ze(),this.initialCenter,[-1,0,-1],[1,0,1]),t=C.mat4.translate(C.mat4.create(),C.mat4.create(),p);C.mat4.rotateY(t,t,y[0]),C.mat4.rotate(t,t,y[1],this._xAxisScreenSpace),C.mat4.translate(t,t,C.vec3.negate(ze(),p)),this._camera.center=p;const i=C.vec3.transformMat4(ze(),this.initialEye,t);i&&(this._camera.eye=i)}coordsAt(n,g=!0){if(n===void 0)return;const y=g?this.initialViewProjectionInverse:this._camera.viewProjectionInverse;if(g){hu(this.referencePlane[0]!==void 0&&this.referencePlane[1]!==void 0,"valid reference plane expected for reference coordinate retrieval");const a=this._coordsAccess(n[0],n[1],0,y),r=this._coordsAccess(n[0],n[1],1,y);return C.ray_math.rayPlaneIntersection(a,r,this.referencePlane[0],this.referencePlane[1])}const p=this._coordsAccess(n[0],n[1],void 0,y);if(p!==void 0)return p;const t=this._coordsAccess(n[0],n[1],0,y),i=this._coordsAccess(n[0],n[1],1,y);return Ke.rayY0SquareIntersection(t,i)}update(){}};Ke.HALF_SQUARE_LENGTH=2,Ke.SCALE_FACTOR=.004,Ke.SCALE_STEP_FACTOR=16,Ke.ROTATE_FACTOR=.002,Ke.MAX_DISTANCE_TO_SQUARE=4,Ke.MIN_NEAR_PLANE_FACTOR=4;let pu=Ke;const Uf=C.auxiliaries.assert,Gf=C.gl_matrix_extensions.v2;class Ge{constructor(n,g){this._mouseMovedSinceDown=!1,this._cameraModifier=new pu,this._nodeEnterSubject=new _s.ReplaySubject(1),this._nodeMoveSubject=new _s.ReplaySubject(1),this._nodeLeaveSubject=new _s.ReplaySubject(1),this._nodeSelectSubject=new _s.ReplaySubject(1),this._navigationStartSubject=new _s.ReplaySubject(1),this._invalidate=n;const y="ontouchstart";this._touchSupported=document.documentElement&&y in document.documentElement||y in document.body,g.mouseEventProvider.preventDefault(C.MouseEventProvider.Type.Wheel,C.MouseEventProvider.Type.Click),g.pointerEventProvider.preventDefault(C.PointerEventProvider.Type.Down,C.PointerEventProvider.Type.Move,C.PointerEventProvider.Type.Up),this._eventHandler=new C.EventHandler(n,g),this._eventHandler.pushMouseDownHandler((p,t)=>this.onMouseDown(p,t)),this._eventHandler.pushMouseUpHandler((p,t)=>this.onMouseUp(p,t)),this._eventHandler.pushMouseMoveHandler((p,t)=>this.onMouseMove(p,t)),this._eventHandler.pushMouseWheelHandler((p,t)=>this.onMouseWheel(p,t)),this._eventHandler.pushClickHandler((p,t)=>this.onClick(p,t)),this._touchSupported&&(this._eventHandler.pushTouchStartHandler((p,t)=>this.onTouchStart(p,t)),this._eventHandler.pushTouchEndHandler((p,t)=>this.onTouchEnd(p,t)),this._eventHandler.pushTouchMoveHandler((p,t)=>this.onTouchMove(p,t)),this._eventHandler.pushTouchCancelHandler((p,t)=>this.onTouchCancel(p,t)))}mode(n){const g=n.type==="mousedown"||n.type==="mousemove",y=n.type==="wheel";if(g&&this.isPrimaryButtonDown(n))return Ge.Mode.Rotate;if(g&&this.isSecondaryButtonDown(n))return Ge.Mode.Pan;if(g&&this.isAuxiliaryButtonDown(n))return Ge.Mode.Zoom;if(y)return Ge.Mode.ZoomStep;if(this._touchSupported&&n instanceof TouchEvent&&n.touches.length===1)return Ge.Mode.Pan}rotate(n,g){const y=C.vec2.fromValues(n.clientX,n.clientY);g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!1,!0],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.rotate())}pan(n,g){const y=this._eventHandler.offsets(n)[0];g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!0,!1,!1],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.translate())}zoom(n,g){const y=this._eventHandler.offsets(n)[0];g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!0,!1],n.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.scale())}emitNodeMovementEvents(n){if(this._idAccess===void 0)return;const g=this._eventHandler.offsets(n,!1)[0],y=C.vec2.scale(Gf(),g,window.devicePixelRatio),p=this._idAccess.idAt(y[0],y[1]);this._lastNode===p&&p!==void 0&&this._nodeMoveSubject.next({node:p,point:g}),this._lastNode!==p&&this._lastNode!==void 0&&this._nodeLeaveSubject.next({node:this._lastNode,point:g}),this._lastNode!==p&&p!==void 0&&this._nodeEnterSubject.next({node:p,point:g}),this._lastNode=p}emitNodeClick(n){if(this._idAccess===void 0)return;const g=this._eventHandler.offsets(n,!1)[0],y=C.vec2.scale(Gf(),g,window.devicePixelRatio),p=this._idAccess.idAt(y[0],y[1]);p!==void 0&&this._nodeSelectSubject.next({node:p,point:g})}applyZoomStep(n){const g=this._eventHandler.offsets(n)[0];this._cameraModifier.initiate(g,void 0,[!1,!0,!1],n.shiftKey),n.preventDefault(),this._cameraModifier.scale(n.deltaY)}onMouseDown(n,g){this._mouseMovedSinceDown=!1}onMouseUp(n,g){}onMouseMove(n,g){const y=n[n.length-1];this._mouseMovedSinceDown=!0;const p=this._mode===void 0;switch(this._mode=this.mode(y),this._mode){case Ge.Mode.Rotate:this.rotate(y,p),p&&this._navigationStartSubject.next();return;case Ge.Mode.Pan:this.pan(y,p),p&&this._navigationStartSubject.next();return;case Ge.Mode.Zoom:this.zoom(y,p),p&&this._navigationStartSubject.next();return;default:this.emitNodeMovementEvents(y);break}}onClick(n,g){const y=n[n.length-1];switch(this._mode){case Ge.Mode.Rotate:case Ge.Mode.Pan:case Ge.Mode.Zoom:return;default:this.emitNodeClick(y);break}}onMouseWheel(n,g){const y=n[n.length-1];switch(this._mode=this.mode(y),this._mode){case Ge.Mode.ZoomStep:this.applyZoomStep(y),this._navigationStartSubject.next();break}}onTouchStart(n,g){const y=n[n.length-1];if(this._mode=this.mode(y),this._mode===Ge.Mode.Pan){this.pan(y,!0);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchMove(n,g){const y=n[n.length-1],p=this._mode===void 0;if(this._mode=this.mode(y),this._mode===Ge.Mode.Pan){this.pan(y,p);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchEnd(n,g){}onTouchCancel(n,g){}isPrimaryButtonDown(n){return(n.buttons===void 0?n.which:n.buttons)===1}isSecondaryButtonDown(n){return n.buttons===void 0?n.which===3:n.buttons===2}isAuxiliaryButtonDown(n){return n.buttons===void 0?n.which===2:n.buttons===4}update(){this._eventHandler.update()}set camera(n){this._camera=n,this._cameraModifier.camera=n}set coordsAccess(n){this._coordsAccess=n,this._cameraModifier.coordsAccess=this._coordsAccess.coordsAt}set idAccess(n){this._idAccess=n}get nodeEnter$(){return this._nodeEnterSubject.asObservable()}get nodeMove$(){return this._nodeMoveSubject.asObservable()}get nodeLeave$(){return this._nodeLeaveSubject.asObservable()}get nodeSelect$(){return this._nodeSelectSubject.asObservable()}get navigationStart$(){return this._navigationStartSubject.asObservable()}}(T=>{(n=>{n[n.Move=0]="Move",n[n.Pan=1]="Pan",n[n.Rotate=2]="Rotate",n[n.Zoom=3]="Zoom",n[n.ZoomStep=4]="ZoomStep"})(T.Mode||(T.Mode={}))})(Ge||(Ge={}));var yb=Object.defineProperty,Eb=Object.getOwnPropertyDescriptor,Tb=(T,n,g,y)=>{for(var p=Eb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&yb(n,g,p),p};class G_ extends C.Geometry{constructor(n,g){super(n,g),g=g!==void 0&&g!==""?g:"PointGeometry",this._vertices=new C.Buffer(n,`${g}VertexVBO`),this._buffers.push(this._vertices),this._colors=new C.Buffer(n,`${g}ColorVBO`),this._buffers.push(this._colors)}bindBuffers(n){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._colors.attribEnable(this._colorLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,0)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(n=0,g=1){this._vertexLocation=n,this._colorLocation=g;const y=this.context.gl;return super.initialize([y.ARRAY_BUFFER,y.ARRAY_BUFFER])&&this._vertices.valid}update(){this.bind()}draw(n=0){if(!this._count)return;const g=this.context.gl;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,0,n*4,!0,!1),this._colors.attribEnable(this._colorLocation,4,g.FLOAT,!1,0,n*4,!0,!1),g.drawArrays(g.POINTS,0,this._count)}set vertices(n){this._count=n.length/3,this._vertices.data(n,this.context.gl.STATIC_DRAW)}set colors(n){this._colors.data(n,this.context.gl.STATIC_DRAW)}get valid(){return this.initialized&&this._vertices.valid&&this._colors&&this._colors.valid}get vertexLocation(){return this._vertexLocation}get colorLocation(){return this._colorLocation}}Tb([C.Initializable.assert_initialized()],G_.prototype,"draw");var xb=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100
attribute vec3 a_vertex;
attribute vec4 a_color;
#else

in vec3 a_vertex;
in vec4 a_color;
#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;
uniform float u_pointSize;

varying vec4 v_color;

void main(void)
{
    vec4 vertex = u_viewProjection * vec4(a_vertex, 1.0);

    v_color = a_color;

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
    gl_PointSize = u_pointSize;
}`,Ab=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
    #endif
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying vec4 v_color;

void main(void)
{
    
    
    

    float dist = distance(gl_PointCoord, vec2(0.5, 0.5));
    float alpha = v_color.a - step(0.5, dist);

    fragColor = vec4(v_color.xyz, alpha);
}`,Sb=Object.defineProperty,Ob=Object.getOwnPropertyDescriptor,Ss=(T,n,g,y)=>{for(var p=Ob(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Sb(n,g,p),p};class Tr extends C.Initializable{constructor(n){super(),this._altered=Object.assign(new C.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=n,this._program=new C.Program(n,"PointRenderProgram"),this._geometry=new G_(this._context,"Point")}relink(){for(const n of this._program.shaders)n.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uPointSize=this._program.uniform("u_pointSize"))}initialize(){const n=this._context.gl,g=new C.Shader(this._context,n.VERTEX_SHADER,"point.vert");g.initialize(xb,!1);const y=new C.Shader(this._context,n.FRAGMENT_SHADER,"point.frag");return y.initialize(Ab,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uPointSize=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){C.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const n=this._context.gl,g=this._target.size;n.viewport(0,0,g[0],g[1]),n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),n.uniform2fv(this._uNdcOffset,this._ndcOffset),n.uniform1f(this._uPointSize,this._pointSize*window.devicePixelRatio),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.BLEND)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set pointSize(n){this._pointSize=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set positions(n){this._geometry.vertices=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set depthMask(n){this._depthMask=n}}Ss([C.Initializable.assert_initialized()],Tr.prototype,"relink");Ss([C.Initializable.initialize()],Tr.prototype,"initialize");Ss([C.Initializable.uninitialize()],Tr.prototype,"uninitialize");Ss([C.Initializable.assert_initialized()],Tr.prototype,"update");Ss([C.Initializable.assert_initialized()],Tr.prototype,"frame");var Rb=Object.defineProperty,Pb=Object.getOwnPropertyDescriptor,wb=(T,n,g,y)=>{for(var p=Pb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Rb(n,g,p),p},ir;const q_=(ir=class extends C.Geometry{constructor(n,g){super(n,g),g=g!==void 0&&g!==""?g:"QuadGeometry",this._vertices=new C.Buffer(n,g+"VertexVBO"),this._buffers.push(this._vertices),this._layout=new C.Buffer(n,g+"LayoutVBO"),this._buffers.push(this._layout),this._ids=new C.Buffer(n,g+"IdVBO"),this._buffers.push(this._ids),this._emphases=new C.Buffer(n,g+"EmphasisVBO"),this._buffers.push(this._emphases),this._colors=new C.Buffer(n,g+"ColorVBO"),this._buffers.push(this._colors)}bindBuffers(n){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._layout.attribEnable(this._layoutLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._colors.attribEnable(this._colorLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this.vertexLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(n=0,g=2,y=3,p=4,t=5){this._vertexLocation=n,this._idLocation=y,this._layoutLocation=g,this._colorLocation=t,this._emphasisLocation=p;const i=this.context.gl,a=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(ir.DATA,i.STATIC_DRAW),a&&this._vertices.valid}update(){this.bind()}draw(n=0,g=0){const y=this.context.gl,p=this.context.gl2facade;this._ids.attribEnable(this._idLocation,4,y.UNSIGNED_BYTE,!1,4,n*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,y.FLOAT,!1,16,n*16,!0,!1),this._colors.attribEnable(this._colorLocation,1,y.UNSIGNED_BYTE,!1,1,n*1,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,y.UNSIGNED_BYTE,!1,1,n*1,!0,!1),p.drawArraysInstanced(y.TRIANGLE_STRIP,0,4,g)}set layout(n){this._layout.data(n,this.context.gl.STATIC_DRAW)}set ids(n){this._ids.data(n,this.context.gl.STATIC_DRAW)}set colors(n){this._colors.data(n,this.context.gl.STATIC_DRAW)}set emphases(n){this._emphases.data(n,this.context.gl.STATIC_DRAW)}get valid(){const n=this._layout&&this._layout.valid,g=this._ids&&this._ids.valid,y=this._colors&&this._colors.valid,p=this._emphases&&this._emphases.valid;return this.initialized&&this._vertices.valid&&n&&g&&y&&p}get vertexLocation(){return this._vertexLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get colorLocation(){return this._colorLocation}},ir.DATA=new Float32Array([0,0,0,1,1,0,1,1]),ir);wb([C.Initializable.assert_initialized()],q_.prototype,"draw");let Lb=q_;var Mb=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec2 a_vertex;
attribute vec4 a_layout; 
attribute vec4 a_id; /* encoded uint32 id in byte4 */
attribute float a_color; /* color index as unsigned byte */
attribute float a_emphasis; /* emphasis mode as unsigned byte */

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec2 a_vertex;
in vec4 a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4 a_id; /* encoded uint32 id in byte4 */
in float a_color; /* color index as unsigned byte */
in float a_emphasis; /* emphasis mode as unsigned byte */

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec2 v_uv;
varying vec4 v_layout;

const float ONE_OVER_255 = 1.0 / 255.0;

const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    vec4 pos = vec4(a_layout[0], 0.0, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], 0.0, a_layout[3], 1.0);

    vec4 vertex = vec4(a_vertex.x, 0.0, a_vertex.y, 1.0) * ext + pos;

    v_uv = vertex.xz;
    v_layout = a_layout;
    v_id = a_id * ONE_OVER_255;

    vertex = u_viewProjection * vertex;

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    v_baseColor = mix(u_colorTable[int(a_color)], emphasisColor, step(2.0, a_emphasis));
    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,Ib=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying mediump vec2 v_uv;
varying mediump vec4 v_layout;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step((v_uv.st - v_layout.xy) - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(0.0), (v_uv.st - v_layout.xy) - v_layout.zw + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,Fb=Object.defineProperty,Cb=Object.getOwnPropertyDescriptor,Os=(T,n,g,y)=>{for(var p=Cb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Fb(n,g,p),p};class xr extends C.Initializable{constructor(n){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new C.ChangeLookup,{any:!1,camera:!1,geometry:!1,colorTable:!1,emphases:!1,outlineWidth:!0,emphasisOutlineWidth:!0}),this._showRoot=!1,this._outlineWidth=rr.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=rr.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Et.Attachment.Undefined,this._context=n,this._program=new C.Program(n,"QuadRenderProgram"),this._geometry=new Lb(this._context,"Quad")}relink(){if(this._colorTable!==void 0){for(const n of this._program.shaders)n.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation);for(const n of this._program.shaders)n.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}}initialize(){const n=this._context.gl;this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const g=new C.Shader(this._context,n.VERTEX_SHADER,"quad.vert");g.initialize(Mb,!1);const y=new C.Shader(this._context,n.FRAGMENT_SHADER,"quad.frag");return y.initialize(Ib,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._colorTable&&n.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.outlineWidth&&n.uniform1f(this._uOutlineWidth,this._outlineWidth),this._target&&this._target.valid&&n.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*window.devicePixelRatio),this._altered.reset())}frame(){if(C.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0)return;const n=this._context.gl,g=this._target.size;if(n.viewport(0,0,g[0],g[1]),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilFunc(n.GREATER,1,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),this._drawRestricted&&n.uniform1i(this._uAttachment,this._attachment),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid){const y=this._topology.linearization.slices,p=this._showRoot===!1?1:0;for(let t=y.length-2;t>=p;--t){const i=y[t][0],a=y[t][1]-y[t][0]+1;this._geometry.draw(i,a)}}this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.STENCIL_TEST),n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}set layout(n){this.assertInitialized(),this._geometry.layout=n,this._altered.alter("geometry")}set ids(n){this.assertInitialized(),this._geometry.ids=n,this._altered.alter("geometry")}set colors(n){this.assertInitialized(),this._geometry.colors=n,this._altered.alter("geometry")}set emphases(n){this.assertInitialized(),this._geometry.emphases=n,this._altered.alter("emphases")}set showRoot(n){this._showRoot=!!n}set topology(n){this._topology=n}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}set outlineWidth(n){this.assertInitialized(),this._outlineWidth!==n&&(this._outlineWidth=n===void 0?rr.OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth!==n&&(this._emphasisOutlineWidth=n===void 0?rr.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,n),this._altered.alter("emphasisOutlineWidth"))}set attachment(n){C.auxiliaries.logIf(n!==Et.Attachment.Undefined&&!this._drawRestricted,C.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=n}set depthMask(n){this._depthMask=n}}Os([C.Initializable.assert_initialized()],xr.prototype,"relink");Os([C.Initializable.initialize()],xr.prototype,"initialize");Os([C.Initializable.uninitialize()],xr.prototype,"uninitialize");Os([C.Initializable.assert_initialized()],xr.prototype,"update");Os([C.Initializable.assert_initialized()],xr.prototype,"frame");var Nb=Object.defineProperty,zb=Object.getOwnPropertyDescriptor,Bb=(T,n,g,y)=>{for(var p=zb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Nb(n,g,p),p};const Db=C.auxiliaries.assert;var nr;const W_=(nr=class extends C.Geometry{constructor(n,g){super(n,g),Db(n.isWebGL2||n.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),g=g!==void 0&&g!==""?g:"ScreenAlignedQuadGeometry",this._vertices=new C.Buffer(n,`${g}VertexVBO`),this._buffers.push(this._vertices),this._origins=new C.Buffer(n,`${g}OriginVBO`),this._buffers.push(this._origins),this._extents=new C.Buffer(n,`${g}ExtentVBO`),this._buffers.push(this._extents),this._offsets=new C.Buffer(n,`${g}OffsetVBO`),this._buffers.push(this._offsets),this._pointyCorners=new C.Buffer(n,`${g}PointyCornerVBO`),this._buffers.push(this._pointyCorners)}bindBuffers(n){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._origins.attribEnable(this._originLocation,3,g.FLOAT,!1,12,0,!0,!1),y.vertexAttribDivisor(this._originLocation,1),this._extents.attribEnable(this._extentLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._extentLocation,1),this._offsets.attribEnable(this._offsetLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._offsetLocation,1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,g.UNSIGNED_BYTE,!1,1,0,!0,!1),y.vertexAttribDivisor(this._pointyCornerLocation,1)}unbindBuffers(n){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._extents.attribDisable(this._extentLocation,!1,!1),this._offsets.attribDisable(this._offsetLocation,!1,!1),this._pointyCorners.attribDisable(this._pointyCornerLocation,!1,!1)}initialize(n=0,g=1,y=2,p=3,t=4){this._vertexLocation=n,this._originLocation=g,this._extentLocation=y,this._offsetLocation=p,this._pointyCornerLocation=t;const i=this.context.gl,a=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(nr.VERTICES,i.STATIC_DRAW),a&&this._vertices.valid}updateData(n,g,y,p){this.bind(),this._count=n.length/3,this._origins.data(n,this.context.gl.STATIC_DRAW),this._extents.data(g,this.context.gl.STATIC_DRAW),this._offsets.data(y,this.context.gl.STATIC_DRAW),this._pointyCorners.data(p,this.context.gl.STATIC_DRAW)}update(){this.bind()}draw(n=0){if(!this._count)return;const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,8,0,!0,!1),this._origins.attribEnable(this._originLocation,3,g.FLOAT,!1,12,n*12,!0,!1),this._extents.attribEnable(this._extentLocation,2,g.FLOAT,!1,8,n*8,!0,!1),this._offsets.attribEnable(this._offsetLocation,2,g.FLOAT,!1,8,n*8,!0,!1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,g.UNSIGNED_BYTE,!1,1,n*1,!0,!1),y.drawArraysInstanced(g.TRIANGLE_STRIP,0,4,this._count)}get valid(){return this.initialized&&this._vertices.valid&&this._origins&&this._origins.valid&&this._offsets&&this._offsets.valid&&this._extents&&this._extents.valid&&this._pointyCorners&&this._pointyCorners.valid}get vertexLocation(){return this._vertexLocation}get originLocation(){return this._originLocation}get extentLocation(){return this._extentLocation}get offsetLocation(){return this._offsetLocation}get pointyCornerLocation(){return this._pointyCornerLocation}},nr.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),nr);Bb([C.Initializable.assert_initialized()],W_.prototype,"draw");let jb=W_;var kb=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

#extension GL_EXT_draw_buffers : enable
attribute vec2 a_vertex;
attribute vec3 a_origin;
attribute vec2 a_extent;
attribute vec2 a_offset;
attribute float a_pointyCorner;

#else

in vec2 a_vertex;
in vec3 a_origin;
in vec2 a_extent;
in vec2 a_offset;
in float a_pointyCorner; 

#endif

uniform vec2 u_ndcOffset;
uniform mat4 u_viewProjection;
uniform float u_aspectRatio;

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

float modI(float a, float b) {
    float m = a - floor((a + 0.5) / b) * b;
    return floor(m + 0.5);
}

void main(void)
{
    v_pointyCornerLeft = step(a_pointyCorner, 2.0);
    v_pointyCornerBottom = modI(a_pointyCorner, 2.0);

    /* POSITIONING */
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.
     * 2-------4
     * |  \\    |
     * |    \\  |
     * 1-------3
     * The current vertex is calculated based on the current quad corners and the extent attributes.
     */

    vec2 extent = a_extent;
    vec2 offset = a_offset;

    
    float radius = extent.y * u_aspectRatio * 0.5;
    extent.x += radius;
    offset.x -= mix(radius, 0.0, step(a_pointyCorner, 2.0));

    v_extent = vec2(extent.x, extent.y * u_aspectRatio);
    v_uv = a_vertex * vec2(extent.x, extent.y * u_aspectRatio);
    v_radius = radius;

    vec4 origin = u_viewProjection * vec4(a_origin, 1.0);
    vec2 originNDC = vec2(origin.x / origin.w, origin.y / origin.w);
    vec4 vertex = vec4(originNDC + a_vertex * extent + offset, origin.z/origin.w, 1.0);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,Ub=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
    #define fragColor gl_FragColor
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

const float ALPHA = 0.8;
const vec3 COLOR = vec3(1.0);

void main(void)
{
    

    
    vec2 mLeft =  vec2(v_radius);
    vec2 mRight = vec2(v_extent.x - v_radius, v_radius);

    
    float borderLeft =   step(v_uv.x, mLeft.x);
    float borderBottom = step(v_uv.y, mLeft.y);
    float borderRight =  step(mRight.x, v_uv.x);
    float borderTop =    step(mRight.y, v_uv.y);

    float alphaLeft =  step(v_radius, distance(v_uv, mLeft))  * borderLeft;
    float alphaRight = step(v_radius, distance(v_uv, mRight)) * borderRight;

    
    
    float alphaLeftBottom =  alphaLeft  * borderBottom;
    float alphaLeftTop =     alphaLeft  * borderTop;
    float alphaRightBottom = alphaRight * borderBottom;
    float alphaRightTop =    alphaRight * borderTop;

    
    float pointyLeftBottom =         v_pointyCornerLeft  *        v_pointyCornerBottom;
    float pointyLeftTop =            v_pointyCornerLeft  * (1.0 - v_pointyCornerBottom);
    float pointyRightBottom = (1.0 - v_pointyCornerLeft) *        v_pointyCornerBottom;
    float pointyRightTop =    (1.0 - v_pointyCornerLeft) * (1.0 - v_pointyCornerBottom);

    
    float shouldBeCutAway = sign(
          alphaLeftBottom  * (1.0 - pointyLeftBottom)
        + alphaLeftTop     * (1.0 - pointyLeftTop)
        + alphaRightBottom * (1.0 - pointyRightBottom)
        + alphaRightTop    * (1.0 - pointyRightTop));

    float alpha = mix(ALPHA, 0.0, shouldBeCutAway);
    fragColor = vec4(COLOR, alpha);
}`,Gb=Object.defineProperty,qb=Object.getOwnPropertyDescriptor,Rs=(T,n,g,y)=>{for(var p=qb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Gb(n,g,p),p};class Ar extends C.Initializable{constructor(n){super(),this._altered=Object.assign(new C.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=n,this._program=new C.Program(n,"ScreenAlignedQuadRenderProgram"),this._geometry=new jb(this._context,"ScreenAlignedQuad")}relink(){for(const n of this._program.shaders)n.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_extent",this._geometry.extentLocation),this._program.attribute("a_offset",this._geometry.offsetLocation),this._program.attribute("a_pointyCorner",this._geometry.pointyCornerLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uAspectRatio=this._program.uniform("u_aspectRatio"))}initialize(){const n=this._context.gl,g=new C.Shader(this._context,n.VERTEX_SHADER,"screenalignedquad.vert");g.initialize(kb,!1);const y=new C.Shader(this._context,n.FRAGMENT_SHADER,"screenalignedquad.frag");return y.initialize(Ub,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uAspectRatio=void 0}update(){const n=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&(n.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),n.uniform1f(this._uAspectRatio,1/this._camera.aspect)),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){C.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const n=this._context.gl,g=this._target.size;n.viewport(0,0,g[0],g[1]),n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(n.depthFunc(n.LEQUAL),n.depthMask(!1)),this._program.bind(),n.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(n.depthFunc(n.LESS),n.depthMask(!0)),n.disable(n.BLEND)}set target(n){this.assertInitialized(),this._target=n}set ndcOffset(n){this.assertInitialized(),this._ndcOffset=n}set camera(n){this.assertInitialized(),this._camera!==n&&(this._camera=n,this._altered.alter("camera"))}updateData(n,g,y,p){this._geometry.updateData(n,g,y,p),this._altered.alter("geometry")}set depthMask(n){this._depthMask=n}}Rs([C.Initializable.assert_initialized()],Ar.prototype,"relink");Rs([C.Initializable.initialize()],Ar.prototype,"initialize");Rs([C.Initializable.uninitialize()],Ar.prototype,"uninitialize");Rs([C.Initializable.assert_initialized()],Ar.prototype,"update");Rs([C.Initializable.assert_initialized()],Ar.prototype,"frame");const Wb="/treemap-renderer/assets/roboto-C39txIsk.fnt",Vb="/treemap-renderer/assets/roboto-Cij1YBZt.png",$b=C.auxiliaries.log,Hb=C.auxiliaries.LogLevel,mr=C.auxiliaries.assert,du=3.5,tr=class tr extends C.Renderer{constructor(n){super(),this._ndcOffsetScale=1,this.coordsAt=(g,y,p,t)=>this._readbackPass.coordsAt(g,y,p,t===void 0?this._camera.viewProjectionInverse:t),this.idAt=(g,y)=>{if(!this._geometry.initialized)return;const p=this._readbackPass.idAt(g,y);if(p===void 0||p===0)return;const t=this._geometry.topology.node(p);return t===void 0?void 0:t.id},this._visualization=n}get geometry(){return this._geometry}set geometry(n){this._geometry=n}get navigation(){return this._navigation}get camera(){return this._camera}set ndcOffsetScale(n){this._ndcOffsetScale!==n&&(this._ndcOffsetScale=n,this.invalidate())}get ndcOffsetScale(){return this._ndcOffsetScale}static verifyMinimumContextRequirements(n){return n.enable(["ANGLE_instanced_arrays","OES_standard_derivatives"]),!0}renderInnerNodes(n,g,y){this._geometry.valid&&(this._innerPass.target=n,this._innerPass.attachment=g,this._innerPass.depthMask=y,this._innerPass.frame())}renderLeafNodes(n,g,y){this._geometry.valid&&this._geometry.leafNodeHeights&&(this._leafPass.target=n,this._leafPass.attachment=g,this._leafPass.depthMask=y,this._leafPass.frame())}renderLeafLabelBackgrounds(n,g){this._labelBackgroundPass.target=n,this._labelBackgroundPass.depthMask=g,this._labelBackgroundPass.frame()}renderPoints(n,g){this._pointPass.target=n,this._pointPass.depthMask=g,this._pointPass.frame()}renderInnerLabels(n,g,y){if(!this._geometry.valid)return;this._innerLabelPass.target=n,this._innerLabelPass.depthMask=y;const p=this._context.gl;p.enable(p.STENCIL_TEST),p.enable(p.DEPTH_TEST),p.stencilFunc(p.EQUAL,1,255),p.stencilOp(p.KEEP,p.KEEP,p.KEEP),this._innerLabelPass.frame(),p.disable(p.STENCIL_TEST)}renderLeafLabels(n,g,y){this._geometry.valid&&(this._leafLabelPass.target=n,this._leafLabelPass.depthMask=y,this._leafLabelPass.frame())}initializeMultiRenderTarget(n){this.assertUninitialized(),this._multiRenderTarget=new Et(n),this._multiRenderTarget.initialize(),this._multiRenderTarget.primaryFBO.clearStencil(0),this._multiRenderTarget.secondaryFBO.clearStencil(0)}initializeLeafPasses(n){this._leafPass=new rr(n),this._leafPass.initialize(),this._leafPass.camera=this._camera}initializeInnerPass(n){this.assertUninitialized(),this._innerPass=new xr(n),this._innerPass.initialize(),this._innerPass.camera=this._camera}initializePointPass(n){this._pointPass=new Tr(n),this._pointPass.initialize(),this._pointPass.camera=this.camera,this._pointPass.pointSize=du}initializeLeafLabelBackgroundPass(n){this._labelBackgroundPass=new Ar(n),this._labelBackgroundPass.initialize(),this._labelBackgroundPass.camera=this.camera}initializeLabelPasses(n){this.assertUninitialized(),this._innerLabelPass=new C.LabelRenderPass(n),this._innerLabelPass.initialize(),this._innerLabelPass.camera=this.camera,this._innerLabelPass.target=this._multiRenderTarget.defaultFBO,this._innerLabelPass.depthFunc=n.gl.ALWAYS,this._innerLabelPass.aaStepScale=.3,this._innerLabelPass.aaSampling=C.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass=new C.LabelRenderPass(n),this._leafLabelPass.initialize(),this._leafLabelPass.camera=this.camera,this._leafLabelPass.target=this._multiRenderTarget.defaultFBO,this._leafLabelPass.aaStepScale=.3,this._leafLabelPass.aaSampling=C.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass.depthFunc=n.gl.ALWAYS,C.FontFace.fromFiles(Wb,new Map([[0,Vb]]),n).then(g=>{for(const y of this._innerLabelPass.labels)y.fontFace=g;for(const y of this._leafLabelPass.labels)y.fontFace=g;this._fontFace=g,this._innerLabelPass.update(!0),this._leafLabelPass.update(!0),this._visualization.configuration&&(this._visualization.configuration.altered.alter("geometry"),this._visualization.configuration.altered.alter("labels")),this.invalidate()}).catch(g=>C.auxiliaries.log(C.auxiliaries.LogLevel.Error,g))}initializeAccumulationPass(n){this.assertUninitialized(),mr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),mr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._accumulationPass=new C.AccumulatePass(n),this._accumulationPass.initialize(this._ndcTriangle),this._accumulationPass.precision=this._framePrecision,this._accumulationPass.texture=this._multiRenderTarget.colorRenderTexture}initializeBlitPass(n){this.assertUninitialized(),mr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),mr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined");const g=this._context.gl,y=this._context.gl2facade;this._blitPass=new C.BlitPass(n),this._blitPass.initialize(this._ndcTriangle),this._blitPass.readBuffer=y.COLOR_ATTACHMENT0,this._blitPass.drawBuffer=g.BACK,this._blitPass.target=this._multiRenderTarget.defaultFBO}initializeReadbackPass(n){this.assertUninitialized(),mr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),mr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._readbackPass=new C.ReadbackPass(n),this._readbackPass.initialize(this._ndcTriangle,this._multiRenderTarget.depthFBO!==void 0),this._readbackPass.cache=!0;const g=this._context.gl,y=this._context.gl2facade;this._multiRenderTarget.depthFBO?(this._readbackPass.depthFBO=this._multiRenderTarget.depthFBO,this._readbackPass.depthAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.depthFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.depthAttachment=g.DEPTH_STENCIL_ATTACHMENT),this._multiRenderTarget.readBackIdFBO?(this._readbackPass.idFBO=this._multiRenderTarget.readBackIdFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.idFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT1)}initializeCamera(){this.assertUninitialized(),this._camera=new C.Camera,this._camera.near=tr.CAMERA_NEAR_DEFAULT,this._camera.far=tr.CAMERA_FAR_DEFAULT,this._camera.eye=C.vec3.fromValues(0,1.5,2.2),this._camera.center=C.vec3.fromValues(0,0,.2),this._camera.up=C.vec3.fromValues(0,1,0),this._camera.fovy=2*C.Camera.calculateFovY(20,60)*C.auxiliaries.RAD2DEG}initializeNavigation(n,g){this.assertUninitialized(),this._navigation=new Ge(n,g),this._navigation.camera=this._camera,this._navigation.idAccess=this,this._navigation.coordsAccess=this}onInitialize(n,g,y){return tr.verifyMinimumContextRequirements(n)?(this._ndcOffsetKernel=new C.AntiAliasingKernel(this._multiFrameNumber),this._ndcOffsetKernel.sort(C.AbstractKernel.SortApproach.BySquaredLength),this._ndcTriangle=new C.NdcFillingTriangle(n,"NdcTriangle"),this._ndcTriangle.initialize(0),this.initializeMultiRenderTarget(n),this.initializeAccumulationPass(n),this.initializeBlitPass(n),this.initializeReadbackPass(n),this.initializeCamera(),this.initializeNavigation(g,y),this.initializeInnerPass(n),this.initializeLeafPasses(n),this.initializePointPass(n),this.initializeLeafLabelBackgroundPass(n),this.initializeLabelPasses(n),!0):!1}onUninitialize(){this._ndcTriangle.uninitialize(),this._multiRenderTarget.uninitialize(),this._accumulationPass.uninitialize(),this._blitPass.uninitialize(),this._readbackPass.uninitialize(),this._innerPass.uninitialize(),this._pointPass.uninitialize(),this._innerLabelPass.uninitialize(),this._leafLabelPass.uninitialize(),this._labelBackgroundPass.uninitialize()}onDiscarded(){}onUpdate(){this._navigation.update();let n=!1;try{n=this._visualization.update()}catch(y){$b(Hb.Error,y)}let g=!1;for(const y of this._innerLabelPass.labels)if(y.altered||y.color.altered){g=!0;break}for(const y of this._leafLabelPass.labels)if(y.altered||y.color.altered){g=!0;break}return n||g||this._altered.any||this._camera.altered}onPrepare(){this._geometry.altered.any&&this._geometry.valid&&(this._innerPass.ids=this._geometry.innerNodeIndices,this._innerPass.layout=this._geometry.innerNodeLayouts,this._innerPass.colors=this._geometry.innerNodeColors,this._innerPass.emphases=this._geometry.innerNodeEmphases,this._innerPass.colorTable=this._geometry.colorTable,this._innerPass.topology=this._geometry.topology,this._innerPass.showRoot=this._geometry.showRoot,this._leafPass.ids=this._geometry.leafNodeIndices,this._leafPass.layoutData=this._geometry.leafNodeLayouts,this._leafPass.areaScales=this._geometry.leafNodeAreaScales,this._leafPass.colors=this._geometry.leafNodeColors,this._leafPass.emphases=this._geometry.leafNodeEmphases,this._leafPass.heights=this._geometry.leafNodeHeights,this._leafPass.colorTable=this._geometry.colorTable,this._leafPass.topology=this._geometry.topology),this._geometry.altered.colorTableLength&&this._leafPass.colorTableLengthAltered(),this._geometry.altered.outlineWidth&&(this._innerPass.outlineWidth=this._geometry.outlineWidth,this._leafPass.outlineWidth=this._geometry.outlineWidth),this._geometry.altered.emphasisOutlineWidth&&(this._innerPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth,this._leafPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth),this._geometry.altered.heightScale&&(this._leafPass.heightScale=this._geometry.heightScale),this._altered.frameSize&&(this._multiRenderTarget.resize(this._frameSize[0],this._frameSize[1]),this._camera.viewport=[this._frameSize[0],this._frameSize[1]],this.invalidate()),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1],this._readbackPass.coordinateReferenceSize=this._canvasSize),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber,this._ndcOffsetKernel.sort(C.AbstractKernel.SortApproach.BySquaredLength)),this._altered.framePrecision&&(this._accumulationPass.precision=this._framePrecision),this._altered.clearColor&&this._multiRenderTarget.setClearColor(this._clearColor),this._innerPass.update(),this._leafPass.update(),this._pointPass.update(),this._labelBackgroundPass.update(),this._innerLabelPass.update(),this._leafLabelPass.update(),this._accumulationPass.update(),this._readbackPass.frame(),this._visualization.prepare(),this._camera.altered=!1,this._geometry.altered.reset(),this._altered.reset()}onFrame(n){const g=this._context.gl,y=this._context.gl2facade,p=this._ndcOffsetKernel.get(n);p[0]=this._ndcOffsetScale*2*p[0]/this._frameSize[0],p[1]=this._ndcOffsetScale*2*p[1]/this._frameSize[1],this._leafPass.ndcOffset=p,this._innerPass.ndcOffset=p,this._innerLabelPass.ndcOffset=p,this._leafLabelPass.ndcOffset=p,this._pointPass.ndcOffset=p,this._labelBackgroundPass.ndcOffset=p;const t=n===0,i=this._multiRenderTarget,a=t?i.primaryFBO:i.secondaryFBO;a.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT,!0,!1),g.viewport(0,0,this._camera.viewport[0],this._camera.viewport[1]),g.depthFunc(g.LESS);const r=Et.Attachment;i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),this.renderLeafNodes(a,i.drawRestricted?r.Color:r.Undefined,!0),this.renderInnerNodes(a,i.drawRestricted?r.Color:r.Undefined,!0),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,g.NONE]),this.renderInnerLabels(a,i.drawRestricted?r.Color:r.Undefined,!1),this.renderLeafLabelBackgrounds(a,!1),this.renderLeafLabels(a,i.drawRestricted?r.Color:r.Undefined,!1),this.renderPoints(a,!1),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),t&&i.idFBO&&(i.idFBO.clear(g.COLOR_BUFFER_BIT|g.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.idFBO,r.Id,!1),this.renderInnerNodes(i.idFBO,r.Id,!1)),t&&i.depthFBO&&(i.depthFBO.clear(g.COLOR_BUFFER_BIT|g.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.depthFBO,r.Depth,!1),this.renderInnerNodes(i.depthFBO,r.Depth,!1)),this._accumulationPass.frame(n)}onSwap(){var g;if(!this._accumulationPass.initialized||!((g=this._accumulationPass.framebuffer)!=null&&g.initialized)||!this._blitPass.initialized)return;const n=this._blitPass;n.framebuffer=this._accumulationPass.framebuffer,n.readBuffer=this._context.gl2facade.COLOR_ATTACHMENT0,n.frame()}updateLabelsForPass(n,g){const y=[];for(const p of n)p!==void 0&&(p.fontFace=this._fontFace,y.push(p));g.labels=y,g.update()}updateLabels(n,g){this.updateLabelsForPass(n,this._innerLabelPass),this.updateLabelsForPass(g,this._leafLabelPass)}updateLeafLabelPass(){this._leafLabelPass.update()}updateLeafLabelBackgrounds(n){const g=[],y=[],p=[],t=[];let i=0;for(const a of n){if(!a||a.color.a===0)continue;const r=2*a.extent[1]/this._frameSize[1];i=Math.max(i,r)}for(const a of n){if(!a||a.color.a===0)continue;g.push(a.position[0],a.position[1],a.position[2]);const r=du*.5,h=du*.5,_=(2*a.extent[0]+r)/this._frameSize[0];y.push(_,i);const d=r/this._frameSize[1],c=a.alignment===C.Label.Alignment.Right?-d-_:d,s=h/this._frameSize[1],o=a.lineAnchor===C.Label.LineAnchor.Top?s-i:-s;p.push(c,o);let l=0;a.alignment===C.Label.Alignment.Left?a.lineAnchor===C.Label.LineAnchor.Bottom?l=1:a.lineAnchor===C.Label.LineAnchor.Top&&(l=2):a.alignment===C.Label.Alignment.Right&&(a.lineAnchor===C.Label.LineAnchor.Bottom?l=3:a.lineAnchor===C.Label.LineAnchor.Top&&(l=4)),t.push(l)}this._labelBackgroundPass.updateData(new Float32Array(g),new Float32Array(y),new Float32Array(p),new Uint8Array(t))}updatePoints(n){const g=[],y=[];for(const p of n)p&&(g.push(p.position[0],p.position[1],p.position[2]),y.push(p.color.r,p.color.g,p.color.b,p.color.a));this._pointPass.positions=new Float32Array(g),this._pointPass.colors=new Float32Array(y)}frameSizeAltered(){return this._altered.frameSize}setCameraEye(n,g,y){this._camera.eye=C.vec3.fromValues(n,g,y)}invalidate(){this.initialized&&super.invalidate(!0)}};tr.CAMERA_NEAR_DEFAULT=.01,tr.CAMERA_FAR_DEFAULT=10;let vu=tr;class Xb{static innerNodes(n,g,y){const p=new Uint8Array(n.numberOfInnerNodes);return n.forEachInnerNode(t=>{p[t.index]=g+t.depth%y}),p}}var Yb=Object.defineProperty,Zb=Object.getOwnPropertyDescriptor,V_=(T,n,g,y)=>{for(var p=Zb(n,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(p=i(n,g,p)||p);return p&&Yb(n,g,p),p};class vt extends C.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new C.ChangeLookup,{any:!1,colorTableLength:!1,colorTable:!1,innerNodeIndices:!1,innerNodeLayouts:!1,innerNodeEmphases:!1,innerNodeColors:!1,leafNodeIndices:!1,leafNodeLayouts:!1,leafNodeEmphases:!1,leafNodeAreaScales:!1,leafNodeColors:!1,leafNodeHeights:!1,outlineWidth:!1,emphasisOutlineWidth:!1,heightScale:!1,labels:!1})}initialize(n){return this._topology=n,this._altered.alter("any"),this._topology.numberOfInnerNodes>0||this._topology.numberOfLeafNodes>0}uninitialize(){this._topology=void 0,this._colorTable=void 0,this._leafNodeAreaScales=void 0,this._leafNodeColors=void 0,this._leafNodeHeights=void 0,this._innerNodeIndices=void 0,this._innerNodeLayouts=void 0,this._innerNodeEmphases=void 0,this._innerNodeColors=void 0,this._leafNodeIndices=void 0,this._leafNodeLayouts=void 0,this._leafNodeEmphases=void 0,this._showRoot=!0}get altered(){return this._altered}get topology(){return this.assertInitialized(),this._topology}set innerNodeIndices(n){this.assertInitialized(),this._innerNodeIndices=n,this._altered.alter("innerNodeIndices")}get innerNodeIndices(){return this._innerNodeIndices}set innerNodeLayouts(n){this.assertInitialized(),this._innerNodeLayouts=n,this._altered.alter("innerNodeLayouts")}get innerNodeLayouts(){return this._innerNodeLayouts}set innerNodeEmphases(n){this.assertInitialized(),this._innerNodeEmphases=n,this._altered.alter("innerNodeEmphases")}get innerNodeEmphases(){return this._innerNodeEmphases}set innerNodeColors(n){this.assertInitialized(),this._innerNodeColors=n,this._altered.alter("innerNodeColors")}get innerNodeColors(){return this._innerNodeColors}set leafNodeIndices(n){this.assertInitialized(),this._leafNodeIndices=n,this._altered.alter("leafNodeIndices")}get leafNodeIndices(){return this._leafNodeIndices}set leafNodeLayouts(n){this.assertInitialized(),this._leafNodeLayouts=n,this._altered.alter("leafNodeLayouts")}get leafNodeLayouts(){return this._leafNodeLayouts}set leafNodeEmphases(n){this.assertInitialized(),this._leafNodeEmphases=n,this._altered.alter("leafNodeEmphases")}get leafNodeEmphases(){return this._leafNodeEmphases}get leafNodeAreaScales(){return this._leafNodeAreaScales}set leafNodeAreaScales(n){this.assertInitialized(),this._leafNodeAreaScales=n,this._altered.alter("leafNodeAreaScales")}get leafNodeColors(){return this._leafNodeColors}set leafNodeColors(n){this.assertInitialized(),this._leafNodeColors=n,this._altered.alter("leafNodeColors")}set colorTable(n){this.assertInitialized(),this._colorTable=n,this._altered.alter("colorTable")}get colorTable(){return this._colorTable}get leafNodeHeights(){return this._leafNodeHeights}set leafNodeHeights(n){this.assertInitialized(),this._leafNodeHeights=n,this._altered.alter("leafNodeHeights")}get innerNodeCount(){return this.assertInitialized(),this._topology.numberOfInnerNodes}get leafNodeCount(){return this.assertInitialized(),this._topology.numberOfLeafNodes}set heightScale(n){this.assertInitialized(),this._heightScale=n,this._altered.alter("heightScale")}get heightScale(){return this._heightScale}set outlineWidth(n){this.assertInitialized(),this._outlineWidth=n,this._altered.alter("outlineWidth")}get outlineWidth(){return this._outlineWidth}set emphasisOutlineWidth(n){this.assertInitialized(),this._emphasisOutlineWidth=n,this._altered.alter("emphasisOutlineWidth")}get emphasisOutlineWidth(){return this._emphasisOutlineWidth}set showRoot(n){this.assertInitialized(),this._showRoot=!!n,this._altered.alter("any")}get showRoot(){return this._showRoot}get valid(){return this.initialized}}V_([C.Initializable.initialize()],vt.prototype,"initialize");V_([C.Initializable.uninitialize()],vt.prototype,"uninitialize");(T=>{(n=>{n[n.None=0]="None",n[n.Outline=1]="Outline",n[n.Highlight=2]="Highlight"})(T.Emphasis||(T.Emphasis={}))})(vt||(vt={}));class qf{static innerNodes(n,g,y){const p=new Uint8Array(n.numberOfInnerNodes);return n.forEachInnerNode(t=>{y&&y.has(t.id)?p[t.index]=vt.Emphasis.Highlight:g&&g.has(t.id)?p[t.index]=vt.Emphasis.Outline:p[t.index]=vt.Emphasis.None}),p}static leafNodes(n,g,y){const p=new Uint8Array(n.numberOfLeafNodes);return n.forEachLeafNode(t=>{const i=t.index-n.numberOfInnerNodes;y&&y.has(t.id)?p[i]=vt.Emphasis.Highlight:g&&g.has(t.id)?p[i]=vt.Emphasis.Outline:p[i]=vt.Emphasis.None}),p}}class Wf{static innerNodes(n){const g=new Uint8Array(4*n.numberOfInnerNodes);return n.forEachInnerNode(y=>{const p=y.index,t=C.vec4.create();C.gl_matrix_extensions.encode_uint32_to_rgba8(t,y.index),g[4*p+0]=t[0],g[4*p+1]=t[1],g[4*p+2]=t[2],g[4*p+3]=t[3]}),g}static leafNodes(n){const g=new Uint8Array(4*n.numberOfLeafNodes),y=n.numberOfInnerNodes;return n.forEachLeafNode(p=>{const t=p.index-y,i=C.vec4.create();C.gl_matrix_extensions.encode_uint32_to_rgba8(i,p.index),g[4*t+0]=i[0],g[4*t+1]=i[1],g[4*t+2]=i[2],g[4*t+3]=i[3]}),g}}class Vf{constructor(){this.outer=0,this.inner=0}next(n){++this.inner,this.inner===n[this.outer].length&&(++this.outer,this.inner=0)}end(n){return this.outer===n.length}element(n){return n[this.outer][this.inner]}}const $f=C.auxiliaries.assert,Ys=C.gl_matrix_extensions.v2;var Te;(T=>{(p=>{p.UpperRight="upper-right",p.UpperLeft="upper-left",p.LowerRight="lower-right",p.LowerLeft="lower-left",p.Hidden="hidden"})(T.Type||(T.Type={}));function n(p,t,i){switch(p){case"upper-right":return t;case"upper-left":return C.vec2.sub(Ys(),t,[i[0],0]);case"lower-left":return C.vec2.sub(Ys(),t,i);case"lower-right":return C.vec2.sub(Ys(),t,[0,i[1]]);case"hidden":return t;default:$f(!1,"No valid type for relative label position, given"+p)}return C.vec2.create()}T.labelOrigin=n;function g(p){return p!=="hidden"}T.isVisible=g;function y(p,t){const i=C.vec2.add(Ys(),p,[t[0]/2,t[1]/2]);return i[0]>0&&i[1]>0?"upper-right":i[0]<0&&i[1]>0?"upper-left":i[0]<0&&i[1]<0?"lower-left":i[0]>0&&i[1]<0?"lower-right":($f(!1,`midpointOffset is ${i}, given offset ${p} and extent ${t}`),"hidden")}T.relativeLabelPosition=y})(Te||(Te={}));const we=C.gl_matrix_extensions.v2;class fu{constructor(n,g,y){this.origin=n,this.extent=g,this.position=y}areBothPositionsHidden(n){return this.position===Te.Type.Hidden||n===Te.Type.Hidden}overlaps(n){if(this.areBothPositionsHidden(n.position))return!1;const g=C.vec2.add(we(),this.origin,this.extent),y=C.vec2.add(we(),n.origin,n.extent);return this.origin[0]<y[0]&&g[0]>n.origin[0]&&this.origin[1]<y[1]&&g[1]>n.origin[1]}paddedOverlaps(n,g){if(this.areBothPositionsHidden(n.position))return!1;const y=C.vec2.fromValues(g[0]+1,g[1]+1),p=C.vec2.sub(we(),this.origin,C.vec2.mul(we(),this.extent,g)),t=C.vec2.sub(we(),n.origin,C.vec2.mul(we(),n.extent,g)),i=C.vec2.add(we(),this.origin,C.vec2.mul(we(),this.extent,y)),a=C.vec2.add(we(),n.origin,C.vec2.mul(we(),n.extent,y));return p[0]<a[0]&&i[0]>t[0]&&p[1]<a[1]&&i[1]>t[1]}overlapArea(n){if(this.areBothPositionsHidden(n.position))return 0;const g=C.vec2.max(we(),this.origin,n.origin),y=C.vec2.min(we(),C.vec2.add(we(),this.origin,this.extent),C.vec2.add(we(),n.origin,n.extent));return Math.max(0,y[0]-g[0])*Math.max(0,y[1]-g[1])}paddedOverlapArea(n,g){if(this.areBothPositionsHidden(n.position))return 0;const y=C.vec2.max(we(),C.vec2.sub(we(),this.origin,C.vec2.mul(we(),this.extent,g)),C.vec2.sub(we(),n.origin,C.vec2.mul(we(),n.extent,g))),p=C.vec2.fromValues(g[0]+1,g[1]+1),t=C.vec2.min(we(),C.vec2.add(we(),this.origin,C.vec2.mul(we(),this.extent,p)),C.vec2.add(we(),n.origin,C.vec2.mul(we(),n.extent,p)));return Math.max(0,t[0]-y[0])*Math.max(0,t[1]-y[1])}area(){return this.extent[0]*this.extent[1]}}const Kb=C.auxiliaries.assert,Qb=C.auxiliaries.log,Jb=C.auxiliaries.LogLevel,eg=20;function Zs(T,n,g){T.length>0&&T[T.length-1].value<n&&(T[T.length-1]={nodeId:g,value:n},T.sort((y,p)=>p.value-y.value))}function Ks(T,n){n.filter(g=>g.nodeId!==void 0&&g.nodeId!=Fe.INVALID_INDEX).map(g=>{T.add(g.nodeId)})}class Qe{static createLeafLabel(n,g){const y=new C.Projected3DLabel(new C.Text("  "+n+"  "),C.Label.Type.Dynamic);return y.color.fromF32(...Qe.leafLabelColor),y.lineAnchor=C.Label.LineAnchor.Bottom,y.fontSize=eg*window.devicePixelRatio,Kb(g.length===3,`Expected a 3D position for leaf label anchor, got ${g}`),y.position=g,y}static createInnerNodeLabel(n,g,y){const p=new C.Position3DLabel(new C.Text(n),C.Label.Type.Static);p.color.fromF32(...Qe.innerLabelColor),p.alignment=C.Label.Alignment.Center,p.lineAnchor=C.Label.LineAnchor.Bottom;const t=0;let i=0;const a=0;let r=0;switch(p.fontSize=y*2,p.elide=C.Label.Elide.Middle,t){case 0:i=g.left+g.right-1,r=(g.bottom-y)*2-1,p.lineWidth=g.width*2,p.direction=[1,0,0],p.up=[0,0,-1];break;case 1:i=g.left+g.right-1,r=(g.top+y)*2-1,p.lineWidth=g.width*2,p.direction=[-1,0,0],p.up=[0,0,1];break;case 2:i=(g.left-y)*2-1,r=g.top+g.bottom-1,p.lineWidth=g.height*2,p.direction=[0,0,1],p.up=[1,0,0];break;case 3:i=(g.right+y)*2-1,r=g.top+g.bottom-1,p.lineWidth=g.height*2,p.direction=[0,0,-1],p.up=[-1,0,0];break;default:p.fontSize=0,Qb(Jb.Warning,`${t} is not a valid value of LabelPaddingSide, skip label '${n}'`)}return p.position=[i,a,-r],p}static createInnerNodeLabelOnAccessory(n,g){const y=new C.Position3DLabel(new C.Text(n),C.Label.Type.Static);y.color.fromF32(...Qe.innerLabelColor),y.alignment=C.Label.Alignment.Center,y.lineAnchor=C.Label.LineAnchor.Bottom;const p=g.left+g.right-1,t=0,i=g.bottom*2-1;return y.fontSize=g.height*2,y.elide=C.Label.Elide.Middle,y.lineWidth=g.width*2,y.position=[p,t,-i],y.direction=[1,0,0],y.up=[0,0,-1],y}static fillLeafLabelArray(n,g,y,p,t,i){const a=new Array(n.numberOfInnerNodes);return y.forEach(r=>{const h=n.leafNodeById(r),_=g.get(r);if(h===void 0||_===void 0||_.length===0)return;const d=h.index-n.numberOfInnerNodes,c=d*4,s=t[c+0],o=t[c+1],l=t[c+2],m=t[c+3],v=d*2,f=i[v+1];if(l>0&&m>0){const b=s+l*.5,x=f*p/255,E=o+m*.5;a[h.index]=Qe.createLeafLabel(_,[b,x,E])}}),a}static fillInnerNodeLabelArrayOnAccessory(n,g,y,p){const t=new Array(n.numberOfInnerNodes);return y.forEach(i=>{const a=n.innerNodeById(i);if(a!==void 0&&p[a.index]!==void 0&&p[a.index].area>0){const r=g.get(i);if(r===void 0||r.length===0)return;t[a.index]=Qe.createInnerNodeLabelOnAccessory(r,p[a.index])}}),t}static fillInnerNodeLabelArray(n,g,y,p,t){const i=new Array(n.numberOfInnerNodes);return y.forEach(a=>{const r=n.innerNodeById(a);if(r!==void 0&&p[r.index]!==void 0){const h=g.get(a);if(h===void 0||h.length===0)return;!r.isLeaf&&p[r.index].area>0&&(i[r.index]=Qe.createInnerNodeLabel(h,p[r.index],t[r.index]))}}),i}static createLabelSelection(n,g,y,p,t,i,a,r,h,_){const d=new Set(t),c=new Array(a),s=new Array(r),o=new Array(h),l=new Array(_);return c.fill({nodeId:void 0,value:-1}),s.fill({nodeId:void 0,value:-1}),o.fill({nodeId:void 0,value:-1}),l.fill({nodeId:void 0,value:-1}),n.parentsDoUntilDepth(i[1],m=>{m.depth<i[0]||Zs(c,g[m.index],m.id)}),n.forEachLeafNode(m=>{m.id!==void 0&&(Zs(s,g[m.index],m.id),Zs(o,y[m.index],m.id),Zs(l,p[m.index],m.id))}),Ks(d,c),Ks(d,s),Ks(d,o),Ks(d,l),d}static fillLeafLabelArrayByExplicitNames(n,g,y,p,t){const i=new Set;return g.forEach((a,r)=>{i.add(r)}),Qe.fillLeafLabelArray(n,g,i,y,p,t)}static fillInnerNodeLabelArrayOnAccessoryByExplicitNames(n,g,y){const p=new Set;return g.forEach((t,i)=>{p.add(i)}),Qe.fillInnerNodeLabelArrayOnAccessory(n,g,p,y)}}(T=>{T.leafLabelColor=[0,0,0,.8],T.innerLabelColor=[0,0,0,.54]})(Qe||(Qe={}));const to=C.auxiliaries.assert,tg=C.gl_matrix_extensions.v2;var ro;(T=>{T.leafLabelsTreemap=(n,g,y,p)=>{let t=0;switch(y){case Te.Type.UpperRight:t=0*p;break;case Te.Type.LowerRight:t=1*p;break;case Te.Type.UpperLeft:t=1*p;break;case Te.Type.LowerLeft:t=3*p;break;case Te.Type.Hidden:t=60*p;break;default:to(!1,`No valid relative position type, given ${y}`)}return 15*g+.3*t}})(ro||(ro={}));class rg{static getNDCExtentForLeafLabel(n,g){to(g.width!==0&&g.height!==0,`camera viewport is invalid: ${g.width} ${g.height}`);const y=n.label.extent[0]/g.width,p=n.label.extent[1]/g.height;return C.vec2.fromValues(y,p)}static placementFor(n,g){const y=C.vec2.sub(tg(),n.origin,g);let p=!0,t=C.Label.Alignment.Left,i=C.Label.LineAnchor.Bottom;switch(n.position){case Te.Type.UpperRight:break;case Te.Type.LowerRight:i=C.Label.LineAnchor.Top;break;case Te.Type.UpperLeft:t=C.Label.Alignment.Right;break;case Te.Type.LowerLeft:i=C.Label.LineAnchor.Top,t=C.Label.Alignment.Right;break;case Te.Type.Hidden:p=!1;break;default:to(!1,"No valid type for relative label position, given"+y)}return{offset:y,alignment:t,lineAnchor:i,display:p}}static createCollisionGraph(n,g){g||(g=C.vec2.fromValues(1,1));const y=[];for(let t=0;t<n.length;t++){y.push([]);for(const i of n[t])y[t].push([])}const p=new Vf;for(;!p.end(n);p.next(n)){const t=p.element(y),i=p.element(n),a=new Vf;for(;!a.end(n);a.next(n)){if(p.outer===a.outer)continue;const r=a.element(n);if(i.paddedOverlaps(r,g)){const h=i.paddedOverlapArea(r,g);t.push({index:a.outer,position:a.inner,overlapArea:h});const _=p.element(y).length;to(_>0,`Size expected to be greater than zero, given ${_.length}`)}}}return y}static computeLabelAreas(n,g,y){const p=[];for(const t of n){p.push([]);const i=this.getNDCExtentForLeafLabel(t,y);for(const a of g){const r=Te.labelOrigin(a,t.pointLocation,i);p[p.length-1].push(new fu(r,i,a))}}return p}static getRandomInt(n){return Math.floor(Math.random()*Math.floor(n))}static randomIndexExcept(n,g){const y=this.getRandomInt(g-1);return y===n?g-1:y}static randomStartLabelAreas(n){const g=[];for(const y of n)g.push(this.getRandomInt(y.length));return g}static computePenalty(n,g,y,p,t){if(n.extent[0]===0||n.extent[1]===0)return 0;let i=0,a=0;for(const r of g)t[r.index]===r.position&&(i+=r.overlapArea,++a);return i/=n.area(),p(a,i,n.position,y)}static simulatedAnnealing(n,g,y,p){const t=[Te.Type.UpperRight,Te.Type.UpperLeft,Te.Type.LowerLeft,Te.Type.LowerRight,Te.Type.Hidden],i=this.computeLabelAreas(n,t,p),a=this.randomStartLabelAreas(i),r=this.createCollisionGraph(i,y),h=.91023922662,_=50,d=.9,c=5*n.length,s=20*n.length;let o=h,l=0,m=0,v=0;for(;;){const f=this.getRandomInt(n.length),b=a[f],x=this.randomIndexExcept(b,i[f].length),E=this.computePenalty(i[f][b],r[f][b],n[f].priority,g,a),O=this.computePenalty(i[f][x],r[f][x],n[f].priority,g,a),S=E-O,w=Math.exp(S/o),P=Math.max(0,Math.min(w,1)),N=Math.random()<P;if((S>0||N)&&(a[f]=x,++m),++v,m>c||v>s){if(m===0||l===_)break;o*=d,m=0,v=0,++l}}for(let f=0;f<n.length;++f)n[f].placement=this.placementFor(i[f][a[f]],n[f].pointLocation)}static greedy(n,g,y,p){const t=[],i=[Te.Type.UpperRight,Te.Type.UpperLeft,Te.Type.LowerLeft,Te.Type.LowerRight,Te.Type.Hidden];for(const a of n){const r=this.getNDCExtentForLeafLabel(a,p);let h=Number.POSITIVE_INFINITY,_=new fu(C.vec2.create(),C.vec2.create(),Te.Type.LowerLeft);for(const d of i){const c=Te.labelOrigin(d,a.pointLocation,r),s=new fu(c,r,d);let o=0,l=0;for(const v of t)o+=s.paddedOverlapArea(v,y),l+=s.paddedOverlaps(v,y)?1:0;o/=s.area();const m=g(l,o,d,a.priority);m<h&&(h=m,_=s)}a.placement=this.placementFor(_,a.pointLocation),t.push(_)}}static prepareLeafLabels(n,g){const y=[];for(const p of n)if(p){const t=C.vec4.fromValues(p.position[0],p.position[1],p.position[2],1);C.vec4.transformMat4(t,t,g.viewProjection);const i=t[3],a=C.vec2.fromValues(t[0]/i,t[1]/i);y.push({label:p,pointLocation:a,priority:p.position[1]*9+1,placement:{offset:C.vec2.create(),alignment:p.alignment,lineAnchor:p.lineAnchor,display:!0}})}return y}static applyNewPlacements(n){let g=!1,y=!1;for(const p of n){const t=p.label.alignment!==p.placement.alignment,i=p.label.lineAnchor!==p.placement.lineAnchor;p.label.alignment=p.placement.alignment,p.label.lineAnchor=p.placement.lineAnchor;const a=p.placement.display?Qe.leafLabelColor[3]:0;p.label.color.fromRGB(p.label.color.r,p.label.color.g,p.label.color.b,a),g=g?!0:p.label.color.altered,y=y?!0:t||i}return{visibility:g,positioning:y}}static adaptPositionToPreventOverlapGreedy(n,g){const y=this.prepareLeafLabels(n,g);y.sort((t,i)=>i.priority-t.priority);const p=C.vec2.fromValues(1,1);return this.greedy(y,ro.leafLabelsTreemap,p,g),this.applyNewPlacements(y)}static adaptPositionToPreventOverlapSimulatedAnnealing(n,g){const y=this.prepareLeafLabels(n,g),p=C.vec2.fromValues(1,1);return this.simulatedAnnealing(y,ro.leafLabelsTreemap,p,g),this.applyNewPlacements(y)}}class ig{constructor(n){this._topology=n}resolve(n,g,y,p){if(p&&(n===void 0||n===""))return p();const t=nt.create(this._topology,y,n,g);return p&&t===void 0?p():t}constBufferCallback(n=0){return()=>{const g=new Float32Array(this._topology.numberOfNodes);return g.fill(n),g}}}class ng{constructor(n,g,y,p){this._emphasis=n.rgbaF32,this._auxiliary=new Float32Array(g.length*4);for(let t=0;t<g.length;++t)this._auxiliary.set(g[t].rgbaF32,t*4);this._inner=new Float32Array(y.length*4);for(let t=0;t<y.length;++t)this._inner.set(y[t].rgbaF32,t*4);this._leaf=new Float32Array(p.length*4);for(let t=0;t<p.length;++t)this._leaf.set(p[t].rgbaF32,t*4)}get innerNodeColorOffset(){return this.auxiliaryColorCount}get innerNodeColorCount(){return this._inner.length/4}get leafColorOffset(){return this.innerNodeColorOffset+this.innerNodeColorCount}get leafColorCount(){return this._leaf.length/4}get auxiliaryColorOffset(){return 0}get auxiliaryColorCount(){return this._auxiliary.length/4+1}get selectionColorIndex(){return 0}get bits(){const n=new Float32Array((this.auxiliaryColorCount+this.innerNodeColorCount+this.leafColorCount)*4);return n.set(this._emphasis,0),n.set(this._auxiliary,4),n.set(this._inner,this.innerNodeColorOffset*4),n.set(this._leaf,this.leafColorOffset*4),n}get length(){return this.auxiliaryColorCount+this.leafColorCount+this.innerNodeColorCount}}class _t{static getColorIndex(n,g,y){const t=(n-y[0])/(y[1]-y[0]);return Math.min(g-1,Math.floor(Math.max(0,g*t-1e-4)))}static getColorIndexInverted(n,g,y){return g-1-this.getColorIndex(n,g,y)}static getColorIndexComputation(n,g){return y=>this.getColorIndex(y,n,g)}static insertLayoutIntoBuffer(n,g,y){const p=4*g;n[p+0]=-1+2*y.left,n[p+1]=1-2*y.bottom-2*y.height,n[p+2]=2*y.width,n[p+3]=2*y.height}static createLeafLayoutBuffer(n,g,y){const p=new Float32Array(4*n.numberOfLeafNodes),t=n.numberOfInnerNodes;return n.forEachLeafNode(i=>{const a=i.index-t,r=g[i.index];_t.insertLayoutIntoBuffer(p,a,r)}),p}static createLayerHeightBuffer(n,g,y,p){const t=new Uint8Array(2*n.numberOfLeafNodes),i=n.numberOfInnerNodes;let a=!1;return n.forEachLeafNode(r=>{const h=r.index-i,_=y!==void 0?Math.max(y[2*h+1],0):0,d=Math.max(g[r.index],0);let c=_+d*255;_>0&&d>0&&(c=Math.ceil(c)),c>255&&(a=!0,c=255),t[2*h+0]=_,t[2*h+1]=c}),a&&console.error("Height value overflow"),t}static createEmptyLayerHeightBuffer(n){return new Uint8Array(2*n.numberOfLeafNodes)}static createLeafAreaScalesBuffer(n,g){const y=new Uint8Array(n.numberOfLeafNodes),p=n.numberOfInnerNodes;return n.forEachLeafNode(t=>{const i=t.index-p,a=Math.min(g[t.index]*255,255);y[i]=a}),y}static createDefaultLeafAreaScalesBuffer(n,g=1){const y=new Uint8Array(n.numberOfLeafNodes);return y.fill(g*255),y}static createParentLayoutBuffer(n,g,y){const p=new Float32Array(4*n.numberOfInnerNodes);return n.forEachInnerNode(t=>{const i=t.index,a=g[t.index];_t.insertLayoutIntoBuffer(p,i,a)}),p}static defaultLeafNodeColors(n,g){const y=new Uint8Array(n.numberOfLeafNodes);return y.fill(g),y}static createLeafNodeColors(n,g,y,p,t){const i=new Uint8Array(n.numberOfLeafNodes),a=n.numberOfInnerNodes,r=this.getColorIndexComputation(p,t);return n.forEachLeafNode(h=>{const _=h.index-a,d=g[h.index];i[_]=y+r(d)+32}),i}static createLeafNodeHeights(){return new Uint8Array(0)}static createLeafNodeAreaScales(){return new Uint8Array(0)}}class ag{constructor(){this.topology=new et}}const Ze=C.auxiliaries.assert;class ve{static clone(n){return new ve(n.left,n.bottom,n.right,n.top)}constructor(n,g,y,p,t){this._left=n,this._right=y,this._top=p,this._bottom=g,this.orientation=t}get area(){return this.width*this.height}get center(){return[(this._left+this._right)/2,(this._bottom+this._top)/2]}get shorterSide(){return Math.min(this.width,this.height)}get longerSide(){return Math.max(this.width,this.height)}get isReversed(){return this.orientation===void 0?!1:this.orientation>=ve.Orientation.DC}get top(){return this._top}set top(n){Ze(n>=this.bottom,"Non-negative height expected"),this._top=n}get left(){return this._left}set left(n){Ze(n<=this.right,"Non-negative width expected"),this._left=n}get right(){return this._right}set right(n){Ze(n>=this.left,"Non-negative width expected"),this._right=n}get bottom(){return this._bottom}set bottom(n){Ze(n<=this.top,"Non-negative height expected"),this._bottom=n}get width(){return this._right-this._left}get height(){return this._top-this._bottom}get isHorizontal(){return this.width>this.height}get isVertical(){return this.width<=this.height}relativeTop(n){return this.relativeRect(0,1-n,1,n)}truncateTop(n){return Ze(n<=this._top&&n>=this._bottom,"Expect new top to be within rectangle"),new ve(this._left,this._bottom,this._right,n)}relativeLeft(n){return this.relativeRect(0,0,n,1)}truncateLeft(n){return Ze(n<=this._right&&n>=this._left,"Expect new top to be within rectangle"),new ve(n,this._bottom,this._right,this._top)}relativeRight(n){return this.relativeRect(1-n,0,n,1)}truncateRight(n){return Ze(n<=this._right&&n>=this._left,"Expect new top to be within rectangle"),new ve(this._left,this._bottom,n,this._top)}relativeBottom(n){return this.relativeRect(0,0,1,n)}truncateBottom(n){return Ze(n<=this._top&&n>=this._bottom,"Expect new top to be within rectangle"),new ve(this._left,n,this._right,this._top)}applyOffset(n,g){this._left+=n,this._right+=n,this._top+=g,this._bottom+=g}relativeRect(n,g,y,p,t){Ze(n>=0&&n<=1,"Expect posX to be in [0, 1]"),Ze(g>=0&&g<=1,"Expect posY to be in [0, 1]"),Ze(y>=0&&y<=1,"Expect extX to be in [0, 1]"),Ze(p>=0&&p<=1,"Expect extY to be in [0, 1]"),Ze(n+y<=1,"Final width must not exceed given width"),Ze(g+p<=1,"Final height must not exceed given height");const i=this._left+n*this.width,a=this._bottom+g*this.height,r=Math.min(i+y*this.width,this._right),h=Math.min(a+p*this.height,this._top);return new ve(i,a,r,h,t)}equalizedMargin(n,g,y){if(this.area<=0)return 0;let p=n;const t=2*this.width*n+2*this.height*n-4*n*n;if(t<0||t/this.area>=g||this.shorterSide<2*n){let i;const a=this.area*g*.99,r=.25*(this.width+this.height),h=.25*a,_=r*r-h;if(_<=0)i=r;else{const d=Math.sqrt(_),c=r+d,s=r-d;i=Math.min(c,s),i=i<0?0:i}Ze(i<p,`expected ${i} to be smaller than ${p}`),p=i}return p}equalizedRelativeMargin(n){if(this.area<=0)return 0;const g=this.area*(1-n),y=this.width/this.height,p=Math.sqrt(g*y),t=Math.sqrt(g/y),i=this.area-g,a=-(p+t)*.5,r=i*.25,h=a*a*.25-r,_=h<0?0:Math.sqrt(h),d=-a*.5+_,c=-a*.5-_;return d<0||c<0?Math.max(d,c):Math.min(d,c)}padded(n){return this.width<2*n||this.height<2*n?new ve(this.left,this.bottom,this.left,this.bottom):new ve(this.left+n,this.bottom+n,this.right-n,this.top-n)}paddedWithMinArea(n,g){return n<=0?this.padded(n):1-(2*this.width*n+2*this.height*n-4*n*n)/this.area>=g&&this.shorterSide>4*n?this.padded(n):this.padded(this.shorterSide/4).relativePadded(Math.max(0,1-n/(4*this.shorterSide)))}relativePadded(n){const g=n/2;return this.relativeRect(g,g,1-n,1-n)}map(n,g){const y=(this.left-n.left)/n.width*g.width+g.left,p=g.right-(n.right-this.right)/n.width*g.width,t=g.top-(n.top-this.top)/n.height*g.height,i=(this.bottom-n.bottom)/n.height*g.height+g.bottom;return new ve(y,i,p,t)}enclose(n){const g=Math.min(this.left,n.left),y=Math.max(this.top,n.top),p=Math.max(this.right,n.right),t=Math.min(this.bottom,n.bottom);this._left=g,this._right=p,this._top=y,this._bottom=t}intersects(n){return!(n.left+Number.EPSILON>=this.right||n.right<=this.left+Number.EPSILON||n.top<=this.bottom+Number.EPSILON||n.bottom+Number.EPSILON>=this.top)}comprises(n){return this.left-Number.EPSILON<=n.left+Number.EPSILON&&this.right+Number.EPSILON>=n.right-Number.EPSILON&&this.bottom-Number.EPSILON<=n.bottom+Number.EPSILON&&this.top+Number.EPSILON>=n.top-Number.EPSILON}get aspectRatio(){return this.width/this.height}centerAround(n){const g=this.center,y=[n[0]-g[0],n[1]-g[1]];this.applyOffset(y[0],y[1])}}(T=>{(n=>{n[n.CD=0]="CD",n[n.AC=1]="AC",n[n.BA=2]="BA",n[n.DB=3]="DB",n[n.DC=4]="DC",n[n.CA=5]="CA",n[n.AB=6]="AB",n[n.BD=7]="BD"})(T.Orientation||(T.Orientation={}))})(ve||(ve={}));class pt{static compute(n,g,y,p,t,i,a,r){const h=g[n.root.index];n.nodesDo(s=>{const o=g[s.index],l=Math.sqrt(o/h);p[s.index]=new ve(0,0,l*y,l)});const _=new Array;_[n.root.index]=[0,0],n.reverseParentsDo(s=>{let o=0,l=0,m=o,v=l,f=pt.Direction.Y;n.childrenDo(s,x=>{const E=p[x.index]=t.siblingMarginAfterCallback(p[x.index],p[s.index],p[s.index],x);switch(f){case pt.Direction.X:o+E.width>=m&&(o=m,l=0,f=pt.Direction.Y);break;default:case pt.Direction.Y:l+E.height>=v&&(o=0,l=v,f=pt.Direction.X);break}switch(_[x.index]=[o,l],f){case pt.Direction.X:o+=E.width,m=Math.max(m,o),v=Math.max(v,Math.max(l+E.height,E.top));break;default:case pt.Direction.Y:l+=E.height,m=Math.max(m,Math.max(o+E.width,E.right)),v=Math.max(v,l);break}});const b=t.parentPaddingCallback(new ve(0,0,m,v),s,n,p,a,r);p[s.index]=t.accessoryPaddingCallback(b,s,n,p,i)}),n.nodesDo(s=>{const o=p[s.index],l=_[s.index];o.applyOffset(l[0],l[1]),n.childrenDo(s,m=>{const v=_[m.index];v[0]+=l[0],v[1]+=l[1]})});const d=p[n.root.index],c=new ve(0,0,d.aspectRatio,1);c.centerAround([.5,.5]),n.reverseNodesDo(s=>{p[s.index]=p[s.index].map(d,c)})}}(T=>{(n=>{n[n.X=0]="X",n[n.Y=1]="Y"})(T.Direction||(T.Direction={}))})(pt||(pt={}));const Qs=C.auxiliaries.assert;class ms{static aspectRatio(n,g,y){const p=n*g,t=y;return p>t?p/t:t/p}constructor(n,g,y,p,t){this._tree=n,this._weights=g,this._availableSpace=y,this._availableWeight=p,this._horizontal=t,this._insertedChildrenCount=0,this._overallChildrenCount=0,this._parentWeight=p,this._childrenWeight=0,this._overallChildrenWeight=0}optimizedAverageAspectRatio(n){if(n){const g=Math.min(this._childrenWeight+n,this._availableWeight),y=Math.min(g/this._availableWeight,1),p=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/(this._insertedChildrenCount+1),p,t)}else{const g=this._childrenWeight,y=Math.min(g/this._availableWeight,1),p=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/this._insertedChildrenCount,p,t)}}insert(n,g){this._firstChild||(this._firstChild=n),Qs(this._lastChild===void 0||this._lastChild===n,"Next node invariant not held."),this._lastChild=this._tree.node(n.nextSibling),g>Number.EPSILON&&(this._childrenWeight=Math.min(this._childrenWeight+g,this._availableWeight),this._overallChildrenWeight=Math.min(this._overallChildrenWeight+g,this._parentWeight),this._insertedChildrenCount+=1)}layoutNodes(n){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,y=>{n[y.index]=new ve(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const g=this.currentSpace;if(this._horizontal){let y=g.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{const t=this._weights[p.index],i=g.width*t/this._childrenWeight,a=Math.min(y+i,g.right);n[p.index]=new ve(y,g.bottom,a,g.top),Qs(this._availableSpace.comprises(n[p.index]),"Expect that child rect is within parent rect"),y=a})}else{let y=g.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{const t=this._weights[p.index],i=g.height*t/this._childrenWeight,a=Math.min(y+i,g.top);n[p.index]=new ve(g.left,y,g.right,a),Qs(this._availableSpace.comprises(n[p.index]),"Expect that child rect is within parent rect"),y=a})}}get isDisabled(){return this._availableWeight<=0||this._availableSpace.width<=0||this._availableSpace.height<=0}get availableWeight(){return this._availableWeight}get remainingWeight(){return this.isDisabled?0:Math.max(this._parentWeight-this._overallChildrenWeight,0)}get availableSpace(){return this._availableSpace}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return ve.clone(this.availableSpace);const n=this._childrenWeight/this._availableWeight;if(this._horizontal){const g=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else{const g=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateRight(g)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const n=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal){const g=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else{const g=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}}get isHorizontal(){return this._horizontal}increasesAverageAspectRatio(n){return this.isDisabled||this._firstChild===void 0||n<=Number.EPSILON?!1:this.optimizedAverageAspectRatio(n)>this.optimizedAverageAspectRatio()+Number.EPSILON}next(n){const g=this.remainingSpace;Qs(this._availableSpace.comprises(g),"Remaining Space should not exceed available space"),this._availableSpace=g,this._availableWeight=this.remainingWeight,this._horizontal=n,this._firstChild=void 0,this._lastChild=void 0,this._insertedChildrenCount=0,this._childrenWeight=0}}const Js=C.auxiliaries.assert;class sg extends ms{constructor(n,g,y,p,t,i,a){super(n,g,y,p,t),this._reverse=i,this._parentReverse=a}get reverse(){return this._reverse}set reverse(n){this._reverse=n}get parentReverse(){return this._parentReverse}set parentReverse(n){this._parentReverse=n}layoutNodes(n){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,p=>{n[p.index]=new ve(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const g=this.currentSpace,y=this._reverse?ve.Orientation.DC:ve.Orientation.CD;if(this._horizontal)if(this._parentReverse){let p=g.right;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=g.width*i/this._childrenWeight,r=Math.max(p-a,g.left);n[t.index]=new ve(r,g.bottom,p,g.top,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else{let p=g.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=g.width*i/this._childrenWeight,r=Math.min(p+a,g.right);n[t.index]=new ve(p,g.bottom,r,g.top,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else if(this._parentReverse){let p=g.top;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=g.height*i/this._childrenWeight,r=Math.max(p-a,g.bottom);n[t.index]=new ve(g.left,r,g.right,p,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}else{let p=g.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],a=g.height*i/this._childrenWeight,r=Math.min(p+a,g.top);n[t.index]=new ve(g.left,p,g.right,r,y),Js(this._availableSpace.comprises(n[t.index]),"Expect that child rect is within parent rect"),p=r})}}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return ve.clone(this.availableSpace);const n=this._childrenWeight/this._availableWeight;if(this._horizontal)if(this._parentReverse){const g=this._availableSpace.top-n*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else{const g=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else if(this._parentReverse){const g=this._availableSpace.right-n*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}else{const g=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateRight(g)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const n=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal)if(this._parentReverse){const g=this._availableSpace.top-n*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else{const g=this._availableSpace.bottom+n*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else if(this._parentReverse){const g=this._availableSpace.right-n*this._availableSpace.width;return this._availableSpace.truncateRight(g)}else{const g=this._availableSpace.left+n*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}}next(n){super.next(n),this._reverse=!this._reverse}}class og{static compute(n,g,y,p,t,i,a,r){p[n.root.index]=new ve(0,0,y,1),p[n.root.index].centerAround([.5,.5]),n.forEachInnerNode(h=>{let _=t.accessoryPaddingCallback(p[h.index],h,n,p,i);_=t.parentPaddingCallback(_,h,n,p,a,r);const d=t.siblingMarginBeforeCallback(_,h,n,p,a,r),c=d.isReversed,s=c,o=new sg(n,g,d,g[h.index],d.isVertical,s,c);n.childrenDo(h,l=>{const m=g[l.index];o.increasesAverageAspectRatio(m)&&(o.layoutNodes(p),o.next(d.isVertical)),o.insert(l,m)}),o.layoutNodes(p),n.childrenDo(h,l=>{p[l.index]=t.siblingMarginAfterCallback(p[l.index],d,_,l)})})}}class lg{static compute(n,g,y,p,t,i,a,r){p[n.root.index]=new ve(0,0,y,1),p[n.root.index].centerAround([.5,.5]),n.forEachInnerNode(h=>{let _=t.accessoryPaddingCallback(p[h.index],h,n,p,i);_=t.parentPaddingCallback(_,h,n,p,a,r);const d=t.siblingMarginBeforeCallback(_,h,n,p,a,r),c=new ms(n,g,d,g[h.index],_.isVertical);n.childrenDo(h,s=>{const o=g[s.index];c.increasesAverageAspectRatio(o)&&(c.layoutNodes(p),c.next(d.isVertical)),c.insert(s,o)}),c.layoutNodes(p),n.childrenDo(h,s=>{p[s.index]=t.siblingMarginAfterCallback(p[s.index],d,_,s)})})}}const Hf=C.auxiliaries.assert,me=class me{static createLayout(n,g,y,p,t,i){const a=new Array(n.numberOfNodes);if(Hf(g!==void 0,"Valid weights expected"),g===void 0)return a;const r=g[0];if(C.auxiliaries.assertions()&&n.numberOfNodes>1){let _=0;n.forEachLeafNode(d=>{_+=g[d.index]}),Hf(r!==void 0&&(_===0||r>0),"Accumulated leaf weights as root weight expected")}const h=y.aspectRatio;switch(y.algorithm){case me.LayoutAlgorithm.Strip:lg.compute(n,g,h,a,me.splittingLayoutPostprocessing(y),p,t,i);break;case me.LayoutAlgorithm.Snake:og.compute(n,g,h,a,me.splittingLayoutPostprocessing(y),p,t,i);break;case me.LayoutAlgorithm.CodeCity:pt.compute(n,g,h,a,me.packingLayoutPostprocessing(y),p,t,i);break}return a}static splittingLayoutPostprocessing(n){const g={parentPaddingCallback:me.emptyParentCallback,siblingMarginBeforeCallback:me.emptyParentCallback,siblingMarginAfterCallback:me.emptySiblingCallback,accessoryPaddingCallback:me.emptyAccessoryParentCallback};let y=[0],p=0;if(n.siblingMargin!==void 0&&(p=n.siblingMargin.value,p>=0))switch(n.siblingMargin.type){case me.SiblingMarginType.Absolute:g.siblingMarginAfterCallback=(t,i,a,r)=>{if(r.isRoot)return t;const h=p;return t.map(i,a).paddedWithMinArea(h*.5,0)};break;case me.SiblingMarginType.Relative:g.siblingMarginAfterCallback=(t,i,a,r)=>{if(r.isRoot)return t;const h=t.equalizedRelativeMargin(p);return t.map(i,a).paddedWithMinArea(h*.5,0)};break}if(n.parentPadding!==void 0&&(n.parentPadding.value instanceof Array?y=n.parentPadding.value:y=[n.parentPadding.value],y[0]>=0))switch(n.parentPadding.type){case me.ParentPaddingType.Mixed:g.parentPaddingCallback=(t,i,a,r,h,_)=>{let d,c;if(y.length-1>i.depth){const s=y[i.depth];d=t.equalizedMargin(s,.5,.9),c=t.padded(d),h!==void 0&&_!==void 0&&(h[i.index]=c,_[i.index]=d)}else d=t.equalizedRelativeMargin(y[y.length-1]),c=t.padded(d);return c},g.siblingMarginBeforeCallback=(t,i,a,r)=>{let h;return y.length>i.depth?h=p:h=t.equalizedRelativeMargin(p),t.padded(-h*.5)};break;case me.ParentPaddingType.Absolute:g.parentPaddingCallback=(t,i,a,r)=>{const h=t.equalizedMargin(y[0],.5,.6);return t.padded(h)},g.siblingMarginBeforeCallback=(t,i,a,r)=>{const h=p;return t.padded(-h*.5)};break;case me.ParentPaddingType.Relative:g.parentPaddingCallback=(t,i,a,r)=>{const h=t.equalizedRelativeMargin(y[0]);return t.padded(h)},g.siblingMarginBeforeCallback=(t,i,a,r)=>{const h=t.equalizedRelativeMargin(p);return t.padded(-h*.5)};break}if(n.accessoryPadding!==void 0){const t=n.accessoryPadding.type,i=n.accessoryPadding.value,a=n.accessoryPadding.direction,r=n.accessoryPadding.relativeAreaThreshold!==void 0?n.accessoryPadding.relativeAreaThreshold:0,h=n.accessoryPadding.targetAspectRatio!==void 0?n.accessoryPadding.targetAspectRatio:Number.NaN;if(i!==void 0)switch(t){case me.AccessoryPaddingType.Absolute:{switch(a){case me.AccessoryPaddingDirection.Bottom:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;if(i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i,l>_.height)return o[d.index]=new ve(0,0,0,0),_;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.truncateBottom(_.bottom+l),f=_.truncateTop(v.bottom);return v.area/_.area<=m||f.aspectRatio<h?(o[d.index]=new ve(0,0,0,0),_):(o[d.index]=f,v)};break}case me.AccessoryPaddingDirection.Top:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;if(i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i,l>_.height)return o[d.index]=new ve(0,0,0,0),_;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.truncateTop(_.top-l),f=_.truncateBottom(v.top);return v.area/_.area<=m||f.aspectRatio<h?(o[d.index]=new ve(0,0,0,0),_):(o[d.index]=f,v)};break}case me.AccessoryPaddingDirection.Left:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;if(i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i,l>_.width)return o[d.index]=new ve(0,0,0,0),_;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.truncateLeft(_.left+l),f=_.truncateRight(v.left);return v.area/_.area<=m||f.aspectRatio<h?(o[d.index]=new ve(0,0,0,0),_):(o[d.index]=f,v)};break}case me.AccessoryPaddingDirection.Right:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;if(i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i,l>_.width)return o[d.index]=new ve(0,0,0,0),_;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.truncateRight(_.right+l),f=_.truncateLeft(v.right);return v.area/_.area<=m||f.aspectRatio<h?(o[d.index]=new ve(0,0,0,0),_):(o[d.index]=f,v)};break}}break}case me.AccessoryPaddingType.Relative:{switch(a){case me.AccessoryPaddingDirection.Bottom:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.relativeTop(1-l);return v.area/_.area>m?v:_};break}case me.AccessoryPaddingDirection.Top:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.relativeBottom(1-l);return v.area/_.area>m?v:_};break}case me.AccessoryPaddingDirection.Left:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.relativeRight(1-l);return v.area/_.area>m?v:_};break}case me.AccessoryPaddingDirection.Right:{g.accessoryPaddingCallback=(_,d,c,s,o)=>{let l;i instanceof Array?l=i.length>d.depth?i[d.depth]:0:l=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const v=_.relativeLeft(1-l);return v.area/_.area>m?v:_};break}}break}}}return g}static packingLayoutPostprocessing(n){return{parentPaddingCallback:me.emptyParentCallback,siblingMarginBeforeCallback:me.emptyParentCallback,siblingMarginAfterCallback:me.emptySiblingCallback,accessoryPaddingCallback:me.emptyAccessoryParentCallback}}};me.emptyParentCallback=(n,g,y,p)=>n,me.emptyAccessoryParentCallback=(n,g,y,p,t)=>n,me.emptySiblingCallback=(n,g,y,p)=>n;let bs=me;(T=>{(n=>{n.Strip="strip",n.Snake="snake",n.CodeCity="codecity"})(T.LayoutAlgorithm||(T.LayoutAlgorithm={})),(n=>{n.Relative="relative",n.Absolute="absolute"})(T.SiblingMarginType||(T.SiblingMarginType={})),(n=>{n.Relative="relative",n.Absolute="absolute",n.Mixed="mixed"})(T.ParentPaddingType||(T.ParentPaddingType={})),(n=>{n.Relative="relative",n.Absolute="absolute"})(T.AccessoryPaddingType||(T.AccessoryPaddingType={})),(n=>{n.Top="top",n.Bottom="bottom",n.Left="left",n.Right="right"})(T.AccessoryPaddingDirection||(T.AccessoryPaddingDirection={}))})(bs||(bs={}));const We=class We{static byValue(n,g,y){if(!(g.length<2)){g.sort(y);for(let p=0;p<g.length-1;++p)g[p][0].nextSibling=g[p+1][0].index;g[g.length-1][0].nextSibling=Fe.INVALID_INDEX,n.firstChild=g[0][0].index}}static byValues(n,g,y,p){const t=new Array;let i=n.node(g.firstChild);do t.push([i,y[i.index]]),i=n.node(i.nextSibling);while(i!==void 0);We.byValue(g,t,p)}static byIdentifier(n,g,y){const p=new Array;let t=n.node(g.firstChild);for(;t!==void 0;)p.push([t,t.id]),t=n.node(t.nextSibling);We.byValue(g,p,y)}static restoreOriginalSortOrder(n,g){g.firstChild=g.initialFirstChild;for(let y=n.node(g.initialFirstChild);y!==void 0;y=n.node(y.initialNextSibling))y.nextSibling=y.initialNextSibling}static sortNodes(n,g,y,p){const t=p.layout.sort;if(t===void 0||t.algorithm===We.Algorithm.Keep)return n.forEachInnerNode(a=>We.restoreOriginalSortOrder(n,a)),!0;let i;switch(t.algorithm){case We.Algorithm.Ascending:i=We.ASCENDING_COMPARATOR;break;case We.Algorithm.Descending:default:i=We.DESCENDING_COMPARATOR;break}switch(t.key){case We.Key.Weight:const a=nt.create(n,g,p.layout.weight,p);a&&n.forEachInnerNode(r=>We.byValues(n,r,a,i));break;case We.Key.Identity:n.forEachInnerNode(r=>We.byIdentifier(n,r,i));break;default:y!==void 0&&n.forEachInnerNode(r=>We.byValues(n,r,y,i))}return!0}};We.ASCENDING_COMPARATOR=(n,g)=>n[1]-g[1],We.DESCENDING_COMPARATOR=(n,g)=>g[1]-n[1];let gs=We;(T=>{(n=>{n.Keep="keep",n.Ascending="ascending",n.Descending="descending"})(T.Algorithm||(T.Algorithm={})),(n=>{n.Identity="identity",n.Weight="weight"})(T.Key||(T.Key={}))})(gs||(gs={}));const ug=[{identifier:"Spectral",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,153,213,148],[215,25,28,253,174,97,171,221,164,43,131,186],[215,25,28,253,174,97,255,255,191,171,221,164,43,131,186],[213,62,79,252,141,89,254,224,139,230,245,152,153,213,148,50,136,189],[213,62,79,252,141,89,254,224,139,255,255,191,230,245,152,153,213,148,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162]]},{identifier:"RdYlGn",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,207,96],[215,25,28,253,174,97,166,217,106,26,150,65],[215,25,28,253,174,97,255,255,191,166,217,106,26,150,65],[215,48,39,252,141,89,254,224,139,217,239,139,145,207,96,26,152,80],[215,48,39,252,141,89,254,224,139,255,255,191,217,239,139,145,207,96,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55]]},{identifier:"RdBu",type:"diverging",format:"rgb",colors:[[239,138,98,247,247,247,103,169,207],[202,0,32,244,165,130,146,197,222,5,113,176],[202,0,32,244,165,130,247,247,247,146,197,222,5,113,176],[178,24,43,239,138,98,253,219,199,209,229,240,103,169,207,33,102,172],[178,24,43,239,138,98,253,219,199,247,247,247,209,229,240,103,169,207,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97]]},{identifier:"PiYG",type:"diverging",format:"rgb",colors:[[233,163,201,247,247,247,161,215,106],[208,28,139,241,182,218,184,225,134,77,172,38],[208,28,139,241,182,218,247,247,247,184,225,134,77,172,38],[197,27,125,233,163,201,253,224,239,230,245,208,161,215,106,77,146,33],[197,27,125,233,163,201,253,224,239,247,247,247,230,245,208,161,215,106,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25]]},{identifier:"PRGn",type:"diverging",format:"rgb",colors:[[175,141,195,247,247,247,127,191,123],[123,50,148,194,165,207,166,219,160,0,136,55],[123,50,148,194,165,207,247,247,247,166,219,160,0,136,55],[118,42,131,175,141,195,231,212,232,217,240,211,127,191,123,27,120,55],[118,42,131,175,141,195,231,212,232,247,247,247,217,240,211,127,191,123,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27]]},{identifier:"RdYlBu",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,191,219],[215,25,28,253,174,97,171,217,233,44,123,182],[215,25,28,253,174,97,255,255,191,171,217,233,44,123,182],[215,48,39,252,141,89,254,224,144,224,243,248,145,191,219,69,117,180],[215,48,39,252,141,89,254,224,144,255,255,191,224,243,248,145,191,219,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149]]},{identifier:"BrBG",type:"diverging",format:"rgb",colors:[[216,179,101,245,245,245,90,180,172],[166,97,26,223,194,125,128,205,193,1,133,113],[166,97,26,223,194,125,245,245,245,128,205,193,1,133,113],[140,81,10,216,179,101,246,232,195,199,234,229,90,180,172,1,102,94],[140,81,10,216,179,101,246,232,195,245,245,245,199,234,229,90,180,172,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48]]},{identifier:"RdGy",type:"diverging",format:"rgb",colors:[[239,138,98,255,255,255,153,153,153],[202,0,32,244,165,130,186,186,186,64,64,64],[202,0,32,244,165,130,255,255,255,186,186,186,64,64,64],[178,24,43,239,138,98,253,219,199,224,224,224,153,153,153,77,77,77],[178,24,43,239,138,98,253,219,199,255,255,255,224,224,224,153,153,153,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26]]},{identifier:"PuOr",type:"diverging",format:"rgb",colors:[[241,163,64,247,247,247,153,142,195],[230,97,1,253,184,99,178,171,210,94,60,153],[230,97,1,253,184,99,247,247,247,178,171,210,94,60,153],[179,88,6,241,163,64,254,224,182,216,218,235,153,142,195,84,39,136],[179,88,6,241,163,64,254,224,182,247,247,247,216,218,235,153,142,195,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75]]},{identifier:"Set2",type:"qualitative",format:"rgb",colors:[[102,194,165,252,141,98,141,160,203],[102,194,165,252,141,98,141,160,203,231,138,195],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148,179,179,179]]},{identifier:"Accent",type:"qualitative",format:"rgb",colors:[[127,201,127,190,174,212,253,192,134],[127,201,127,190,174,212,253,192,134,255,255,153],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23,102,102,102]]},{identifier:"Set1",type:"qualitative",format:"rgb",colors:[[228,26,28,55,126,184,77,175,74],[228,26,28,55,126,184,77,175,74,152,78,163],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191,153,153,153]]},{identifier:"Set3",type:"qualitative",format:"rgb",colors:[[141,211,199,255,255,179,190,186,218],[141,211,199,255,255,179,190,186,218,251,128,114],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197,255,237,111]]},{identifier:"Dark2",type:"qualitative",format:"rgb",colors:[[27,158,119,217,95,2,117,112,179],[27,158,119,217,95,2,117,112,179,231,41,138],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29,102,102,102]]},{identifier:"Paired",type:"qualitative",format:"rgb",colors:[[166,206,227,31,120,180,178,223,138],[166,206,227,31,120,180,178,223,138,51,160,44],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153,177,89,40]]},{identifier:"Pastel2",type:"qualitative",format:"rgb",colors:[[179,226,205,253,205,172,203,213,232],[179,226,205,253,205,172,203,213,232,244,202,228],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204,204,204,204]]},{identifier:"Pastel1",type:"qualitative",format:"rgb",colors:[[251,180,174,179,205,227,204,235,197],[251,180,174,179,205,227,204,235,197,222,203,228],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236,242,242,242]]},{identifier:"OrRd",type:"sequential",format:"rgb",colors:[[254,232,200,253,187,132,227,74,51],[254,240,217,253,204,138,252,141,89,215,48,31],[254,240,217,253,204,138,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,179,0,0,127,0,0]]},{identifier:"PuBu",type:"sequential",format:"rgb",colors:[[236,231,242,166,189,219,43,140,190],[241,238,246,189,201,225,116,169,207,5,112,176],[241,238,246,189,201,225,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,4,90,141,2,56,88]]},{identifier:"BuPu",type:"sequential",format:"rgb",colors:[[224,236,244,158,188,218,136,86,167],[237,248,251,179,205,227,140,150,198,136,65,157],[237,248,251,179,205,227,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,129,15,124,77,0,75]]},{identifier:"Oranges",type:"sequential",format:"rgb",colors:[[254,230,206,253,174,107,230,85,13],[254,237,222,253,190,133,253,141,60,217,71,1],[254,237,222,253,190,133,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,166,54,3,127,39,4]]},{identifier:"BuGn",type:"sequential",format:"rgb",colors:[[229,245,249,153,216,201,44,162,95],[237,248,251,178,226,226,102,194,164,35,139,69],[237,248,251,178,226,226,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,109,44,0,68,27]]},{identifier:"YlOrBr",type:"sequential",format:"rgb",colors:[[255,247,188,254,196,79,217,95,14],[255,255,212,254,217,142,254,153,41,204,76,2],[255,255,212,254,217,142,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,153,52,4,102,37,6]]},{identifier:"YlGn",type:"sequential",format:"rgb",colors:[[247,252,185,173,221,142,49,163,84],[255,255,204,194,230,153,120,198,121,35,132,67],[255,255,204,194,230,153,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,104,55,0,69,41]]},{identifier:"Reds",type:"sequential",format:"rgb",colors:[[254,224,210,252,146,114,222,45,38],[254,229,217,252,174,145,251,106,74,203,24,29],[254,229,217,252,174,145,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,165,15,21,103,0,13]]},{identifier:"RdPu",type:"sequential",format:"rgb",colors:[[253,224,221,250,159,181,197,27,138],[254,235,226,251,180,185,247,104,161,174,1,126],[254,235,226,251,180,185,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119,73,0,106]]},{identifier:"Greens",type:"sequential",format:"rgb",colors:[[229,245,224,161,217,155,49,163,84],[237,248,233,186,228,179,116,196,118,35,139,69],[237,248,233,186,228,179,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,109,44,0,68,27]]},{identifier:"YlGnBu",type:"sequential",format:"rgb",colors:[[237,248,177,127,205,187,44,127,184],[255,255,204,161,218,180,65,182,196,34,94,168],[255,255,204,161,218,180,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,37,52,148,8,29,88]]},{identifier:"Purples",type:"sequential",format:"rgb",colors:[[239,237,245,188,189,220,117,107,177],[242,240,247,203,201,226,158,154,200,106,81,163],[242,240,247,203,201,226,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,84,39,143,63,0,125]]},{identifier:"GnBu",type:"sequential",format:"rgb",colors:[[224,243,219,168,221,181,67,162,202],[240,249,232,186,228,188,123,204,196,43,140,190],[240,249,232,186,228,188,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,104,172,8,64,129]]},{identifier:"Greys",type:"sequential",format:"rgb",colors:[[240,240,240,189,189,189,99,99,99],[247,247,247,204,204,204,150,150,150,82,82,82],[247,247,247,204,204,204,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37,0,0,0]]},{identifier:"YlOrRd",type:"sequential",format:"rgb",colors:[[255,237,160,254,178,76,240,59,32],[255,255,178,254,204,92,253,141,60,227,26,28],[255,255,178,254,204,92,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,189,0,38,128,0,38]]},{identifier:"PuRd",type:"sequential",format:"rgb",colors:[[231,225,239,201,148,199,221,28,119],[241,238,246,215,181,216,223,101,176,206,18,86],[241,238,246,215,181,216,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,152,0,67,103,0,31]]},{identifier:"Blues",type:"sequential",format:"rgb",colors:[[222,235,247,158,202,225,49,130,189],[239,243,255,189,215,231,107,174,214,33,113,181],[239,243,255,189,215,231,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,81,156,8,48,107]]},{identifier:"PuBuGn",type:"sequential",format:"rgb",colors:[[236,226,240,166,189,219,28,144,153],[246,239,247,189,201,225,103,169,207,2,129,138],[246,239,247,189,201,225,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,108,89,1,70,54]]}],cg=[{identifier:"magma",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002258,.001295,.018331,.003279,.002305,.023708,.004512,.00349,.029965,.00595,.004843,.03713,.007588,.006356,.044973,.009426,.008022,.052844,.011465,.009828,.06075,.013708,.011771,.068667,.016156,.01384,.076603,.018815,.016026,.084584,.021692,.01832,.09261,.024792,.020715,.100676,.028123,.023201,.108787,.031696,.025765,.116965,.03552,.028397,.125209,.039608,.03109,.133515,.04383,.03383,.141886,.048062,.036607,.150327,.05232,.039407,.158841,.056615,.04216,.167446,.060949,.044794,.176129,.06533,.047318,.184892,.069764,.049726,.193735,.074257,.052017,.20266,.078815,.054184,.211667,.083446,.056225,.220755,.088155,.058133,.229922,.092949,.059904,.239164,.097833,.061531,.248477,.102815,.06301,.257854,.107899,.064335,.267289,.113094,.065492,.276784,.118405,.066479,.286321,.123833,.067295,.295879,.12938,.067935,.305443,.135053,.068391,.315,.140858,.068654,.324538,.146785,.068738,.334011,.152839,.068637,.343404,.159018,.068354,.352688,.165308,.067911,.361816,.171713,.067305,.370771,.178212,.066576,.379497,.184801,.065732,.387973,.19146,.064818,.396152,.198177,.063862,.404009,.204935,.062907,.411514,.211718,.061992,.418647,.218512,.061158,.425392,.225302,.060445,.431742,.232077,.059889,.437695,.238826,.059517,.443256,.245543,.059352,.448436,.25222,.059415,.453248,.258857,.059706,.45771,.265447,.060237,.46184,.271994,.060994,.46566,.278493,.061978,.46919,.284951,.063168,.472451,.291366,.064553,.475462,.29774,.066117,.478243,.304081,.067835,.480812,.310382,.069702,.483186,.316654,.07169,.48538,.322899,.073782,.487408,.329114,.075972,.489287,.335308,.078236,.491024,.341482,.080564,.492631,.347636,.082946,.494121,.353773,.085373,.495501,.359898,.087831,.496778,.366012,.090314,.49796,.372116,.092816,.499053,.378211,.095332,.500067,.384299,.097855,.501002,.390384,.100379,.501864,.396467,.102902,.502658,.402548,.10542,.503386,.408629,.10793,.504052,.414709,.110431,.504662,.420791,.11292,.505215,.426877,.115395,.505714,.432967,.117855,.50616,.439062,.120298,.506555,.445163,.122724,.506901,.451271,.125132,.507198,.457386,.127522,.507448,.463508,.129893,.507652,.46964,.132245,.507809,.47578,.134577,.507921,.481929,.136891,.507989,.488088,.139186,.508011,.494258,.141462,.507988,.500438,.143719,.50792,.506629,.145958,.507806,.512831,.148179,.507648,.519045,.150383,.507443,.52527,.152569,.507192,.531507,.154739,.506895,.537755,.156894,.506551,.544015,.159033,.506159,.550287,.161158,.505719,.556571,.163269,.50523,.562866,.165368,.504692,.569172,.167454,.504105,.57549,.16953,.503466,.581819,.171596,.502777,.588158,.173652,.502035,.594508,.175701,.501241,.600868,.177743,.500394,.607238,.179779,.499492,.613617,.181811,.498536,.620005,.18384,.497524,.626401,.185867,.496456,.632805,.187893,.495332,.639216,.189921,.49415,.645633,.191952,.49291,.652056,.193986,.491611,.658483,.196027,.490253,.664915,.198075,.488836,.671349,.200133,.487358,.677786,.202203,.485819,.684224,.204286,.484219,.690661,.206384,.482558,.697098,.208501,.480835,.703532,.210638,.479049,.709962,.212797,.477201,.716387,.214982,.47529,.722805,.217194,.473316,.729216,.219437,.471279,.735616,.221713,.46918,.742004,.224025,.467018,.748378,.226377,.464794,.754737,.228772,.462509,.761077,.231214,.460162,.767398,.233705,.457755,.773695,.236249,.455289,.779968,.238851,.452765,.786212,.241514,.450184,.792427,.244242,.447543,.798608,.24704,.444848,.804752,.249911,.442102,.810855,.252861,.439305,.816914,.255895,.436461,.822926,.259016,.433573,.828886,.262229,.430644,.834791,.26554,.427671,.840636,.268953,.424666,.846416,.272473,.421631,.852126,.276106,.418573,.857763,.279857,.415496,.86332,.283729,.412403,.868793,.287728,.409303,.874176,.291859,.406205,.879464,.296125,.403118,.884651,.30053,.400047,.889731,.305079,.397002,.8947,.309773,.393995,.899552,.314616,.391037,.904281,.31961,.388137,.908884,.324755,.385308,.913354,.330052,.382563,.917689,.3355,.379915,.921884,.341098,.377376,.925937,.346844,.374959,.929845,.352734,.372677,.933606,.358764,.370541,.937221,.364929,.368567,.940687,.371224,.366762,.944006,.377643,.365136,.94718,.384178,.363701,.95021,.39082,.362468,.953099,.397563,.361438,.955849,.4044,.360619,.958464,.411324,.360014,.960949,.418323,.35963,.96331,.42539,.359469,.965549,.432519,.359529,.967671,.439703,.35981,.96968,.446936,.360311,.971582,.45421,.36103,.973381,.46152,.361965,.975082,.468861,.363111,.97669,.476226,.364466,.97821,.483612,.366025,.979645,.491014,.367783,.981,.498428,.369734,.982279,.505851,.371874,.983485,.51328,.374198,.984622,.520713,.376698,.985693,.528148,.379371,.9867,.535582,.38221,.987646,.543015,.38521,.988533,.550446,.388365,.989363,.557873,.391671,.990138,.565296,.395122,.990871,.572706,.398714,.991558,.580107,.402441,.992196,.587502,.406299,.992785,.594891,.410283,.993326,.602275,.41439,.993834,.609644,.418613,.994309,.616999,.42295,.994738,.62435,.427397,.995122,.631696,.431951,.99548,.639027,.436607,.99581,.646344,.441361,.996096,.653659,.446213,.996341,.660969,.45116,.99658,.668256,.456192,.996775,.675541,.461314,.996925,.682828,.466526,.997077,.690088,.471811,.997186,.697349,.477182,.997254,.704611,.482635,.997325,.711848,.488154,.997351,.719089,.493755,.997351,.726324,.499428,.997341,.733545,.505167,.997285,.740772,.510983,.997228,.747981,.516859,.997138,.75519,.522806,.997019,.762398,.528821,.996898,.769591,.534892,.996727,.776795,.541039,.996571,.783977,.547233,.996369,.791167,.553499,.996162,.798348,.55982,.995932,.805527,.566202,.99568,.812706,.572645,.995424,.819875,.57914,.995131,.827052,.585701,.994851,.834213,.592307,.994524,.841387,.598983,.994222,.84854,.605696,.993866,.855711,.612482,.993545,.862859,.619299,.99317,.870024,.626189,.992831,.877168,.633109,.99244,.88433,.640099,.992089,.89147,.647116,.991688,.898627,.654202,.991332,.905763,.661309,.99093,.912915,.668481,.99057,.920049,.675675,.990175,.927196,.682926,.989815,.934329,.690198,.989434,.94147,.697519,.989077,.948604,.704863,.988717,.955742,.712242,.988367,.962878,.719649,.988033,.970012,.727077,.987691,.977154,.734536,.987387,.984288,.742002,.987053,.991438,.7495]]},{identifier:"inferno",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002267,.00127,.01857,.003299,.002249,.024239,.004547,.003392,.030909,.006006,.004692,.038558,.007676,.006136,.046836,.009561,.007713,.055143,.011663,.009417,.06346,.013995,.011225,.071862,.016561,.013136,.080282,.019373,.015133,.088767,.022447,.017199,.097327,.025793,.019331,.10593,.029432,.021503,.114621,.033385,.023702,.123397,.037668,.025921,.132232,.042253,.028139,.141141,.046915,.030324,.150164,.051644,.032474,.159254,.056449,.034569,.168414,.06134,.03659,.177642,.066331,.038504,.186962,.071429,.040294,.196354,.076637,.041905,.205799,.081962,.043328,.215289,.087411,.044556,.224813,.09299,.045583,.234358,.098702,.046402,.243904,.104551,.047008,.25343,.110536,.047399,.262912,.116656,.047574,.272321,.122908,.047536,.281624,.129285,.047293,.290788,.135778,.046856,.299776,.142378,.046242,.308553,.149073,.045468,.317085,.15585,.044559,.325338,.162689,.043554,.333277,.169575,.042489,.340874,.176493,.041402,.348111,.183429,.040329,.354971,.190367,.039309,.361447,.197297,.0384,.367535,.204209,.037632,.373238,.211095,.03703,.378563,.217949,.036615,.383522,.224763,.036405,.388129,.231538,.036405,.3924,.238273,.036621,.396353,.244967,.037055,.400007,.25162,.037705,.403378,.258234,.038571,.406485,.26481,.039647,.409345,.271347,.040922,.411976,.27785,.042353,.414392,.284321,.043933,.416608,.290763,.045644,.418637,.297178,.04747,.420491,.303568,.049396,.422182,.309935,.051407,.423721,.316282,.05349,.425116,.32261,.055634,.426377,.328921,.057827,.427511,.335217,.06006,.428524,.3415,.062325,.429425,.347771,.064616,.430217,.354032,.066925,.430906,.360284,.069247,.431497,.366529,.071579,.431994,.372768,.073915,.4324,.379001,.076253,.432719,.385228,.078591,.432955,.391453,.080927,.433109,.397674,.083257,.433183,.403894,.08558,.433179,.410113,.087896,.433098,.416331,.090203,.432943,.422549,.092501,.432714,.428768,.09479,.432412,.434987,.097069,.432039,.441207,.099338,.431594,.447428,.101597,.43108,.453651,.103848,.430498,.459875,.106089,.429846,.4661,.108322,.429125,.472328,.110547,.428334,.478558,.112764,.427475,.484789,.114974,.426548,.491022,.117179,.425552,.497257,.119379,.424488,.503493,.121575,.423356,.50973,.123769,.422156,.515967,.12596,.420887,.522206,.12815,.419549,.528444,.130341,.418142,.534683,.132534,.416667,.54092,.134729,.415123,.547157,.136929,.413511,.553392,.139134,.411829,.559624,.141346,.410078,.565854,.143567,.408258,.572081,.145797,.406369,.578304,.148039,.404411,.584521,.150294,.402385,.590734,.152563,.40029,.59694,.154848,.398125,.603139,.157151,.395891,.60933,.159474,.393589,.615513,.161817,.391219,.621685,.164184,.388781,.627847,.166575,.386276,.633998,.168992,.383704,.640135,.171438,.381065,.64626,.173914,.378359,.652369,.176421,.375586,.658463,.178962,.372748,.66454,.181539,.369846,.670599,.184153,.366879,.676638,.186807,.363849,.682656,.189501,.360757,.688653,.192239,.357603,.694627,.195021,.354388,.700576,.197851,.351113,.7065,.200728,.347777,.712396,.203656,.344383,.718264,.206636,.340931,.724103,.20967,.337424,.729909,.212759,.333861,.735683,.215906,.330245,.741423,.219112,.326576,.747127,.222378,.322856,.752794,.225706,.319085,.758422,.229097,.315266,.76401,.232554,.311399,.769556,.236077,.307485,.775059,.239667,.303526,.780517,.243327,.299523,.785929,.247056,.295477,.791293,.250856,.29139,.796607,.254728,.287264,.801871,.258674,.283099,.807082,.262692,.278898,.812239,.266786,.274661,.817341,.270954,.27039,.822386,.275197,.266085,.827372,.279517,.26175,.832299,.283913,.257383,.837165,.288385,.252988,.841969,.292933,.248564,.846709,.297559,.244113,.851384,.30226,.239636,.855992,.307038,.235133,.860533,.311892,.230606,.865006,.316822,.226055,.869409,.321827,.221482,.873741,.326906,.216886,.878001,.33206,.212268,.882188,.337287,.207628,.886302,.342586,.202968,.890341,.347957,.198286,.894305,.353399,.193584,.898192,.358911,.18886,.902003,.364492,.184116,.905735,.37014,.17935,.90939,.375856,.174563,.912966,.381636,.169755,.916462,.387481,.164924,.919879,.393389,.16007,.923215,.399359,.155193,.92647,.405389,.150292,.929644,.411479,.145367,.932737,.417627,.140417,.935747,.423831,.13544,.938675,.430091,.130438,.941521,.436405,.125409,.944285,.442772,.120354,.946965,.449191,.115272,.949562,.45566,.110164,.952075,.462178,.105031,.954506,.468744,.099874,.956852,.475356,.094695,.959114,.482014,.089499,.961293,.488716,.084289,.963387,.495462,.079073,.965397,.502249,.073859,.967322,.509078,.068659,.969163,.515946,.063488,.970919,.522853,.058367,.97259,.529798,.053324,.974176,.53678,.048392,.975677,.543798,.043618,.977092,.55085,.03905,.978422,.557937,.034931,.979666,.565057,.031409,.980824,.572209,.028508,.981895,.579392,.02625,.982881,.586606,.024661,.983779,.593849,.02377,.984591,.601122,.023606,.985315,.608422,.024202,.985952,.61575,.025592,.986502,.623105,.027814,.986964,.630485,.030908,.987337,.63789,.034916,.987622,.64532,.039886,.987819,.652773,.045581,.987926,.66025,.05175,.987945,.667748,.058329,.987874,.675267,.065257,.987714,.682807,.072489,.987464,.690366,.07999,.987124,.697944,.087731,.986694,.70554,.095694,.986175,.713153,.103863,.985566,.720782,.112229,.984865,.728427,.120785,.984075,.736087,.129527,.983196,.743758,.138453,.982228,.751442,.147565,.981173,.759135,.156863,.980032,.766837,.166353,.978806,.774545,.176037,.977497,.782258,.185923,.976108,.789974,.196018,.974638,.797692,.206332,.973088,.805409,.216877,.971468,.813122,.227658,.969783,.820825,.238686,.968041,.828515,.249972,.966243,.836191,.261534,.964394,.843848,.273391,.962517,.851476,.285546,.960626,.859069,.29801,.95872,.866624,.31082,.956834,.874129,.323974,.954997,.881569,.337475,.953215,.888942,.351369,.951546,.896226,.365627,.950018,.903409,.380271,.948683,.910473,.395289,.947594,.917399,.410665,.946809,.924168,.426373,.946392,.930761,.442367,.946403,.937159,.458592,.946903,.943348,.47497,.947937,.949318,.491426,.949545,.955063,.50786,.95174,.960587,.524203,.954529,.965896,.540361,.957896,.971003,.556275,.961812,.975924,.571925,.966249,.980678,.587206,.971162,.985282,.602154,.976511,.989753,.61676,.982257,.994109,.631017,.988362,.998364,.644924]]},{identifier:"plasma",type:"diverging",format:"rgbf",colors:[[.050383,.029803,.527975,.063536,.028426,.533124,.075353,.027206,.538007,.086222,.026125,.542658,.096379,.025165,.547103,.10598,.024309,.551368,.115124,.023556,.555468,.123903,.022878,.559423,.132381,.022258,.56325,.140603,.021687,.566959,.148607,.021154,.570562,.156421,.020651,.574065,.16407,.020171,.577478,.171574,.019706,.580806,.17895,.019252,.584054,.186213,.018803,.587228,.193374,.018354,.59033,.200445,.017902,.593364,.207435,.017442,.596333,.21435,.016973,.599239,.221197,.016497,.602083,.227983,.016007,.604867,.234715,.015502,.607592,.241396,.014979,.610259,.248032,.014439,.612868,.254627,.013882,.615419,.261183,.013308,.617911,.267703,.012716,.620346,.274191,.012109,.622722,.280648,.011488,.625038,.287076,.010855,.627295,.293478,.010213,.62949,.299855,.009561,.631624,.30621,.008902,.633694,.312543,.008239,.6357,.318856,.007576,.63764,.32515,.006915,.639512,.331426,.006261,.641316,.337683,.005618,.643049,.343925,.004991,.64471,.35015,.004382,.646298,.356359,.003798,.64781,.362553,.003243,.649245,.368733,.002724,.650601,.374897,.002245,.651876,.381047,.001814,.653068,.387183,.001434,.654177,.393304,.001114,.655199,.399411,859e-6,.656133,.405503,678e-6,.656977,.41158,577e-6,.65773,.417642,564e-6,.65839,.423689,646e-6,.658956,.429719,831e-6,.659425,.435734,.001127,.659797,.441732,.00154,.660069,.447714,.00208,.66024,.453677,.002755,.66031,.459623,.003574,.660277,.46555,.004545,.660139,.471457,.005678,.659897,.477344,.00698,.659549,.48321,.00846,.659095,.489055,.010127,.658534,.494877,.01199,.657865,.500678,.014055,.657088,.506454,.016333,.656202,.512206,.018833,.655209,.517933,.021563,.654109,.523633,.024532,.652901,.529306,.027747,.651586,.534952,.031217,.650165,.54057,.03495,.64864,.546157,.038954,.64701,.551715,.043136,.645277,.557243,.047331,.643443,.562738,.051545,.641509,.568201,.055778,.639477,.573632,.060028,.637349,.579029,.064296,.635126,.584391,.068579,.632812,.589719,.072878,.630408,.595011,.07719,.627917,.600266,.081516,.625342,.605485,.085854,.622686,.610667,.090204,.619951,.615812,.094564,.61714,.620919,.098934,.614257,.625987,.103312,.611305,.631017,.107699,.608287,.636008,.112092,.605205,.640959,.116492,.602065,.645872,.120898,.598867,.650746,.125309,.595617,.65558,.129725,.592317,.660374,.134144,.588971,.665129,.138566,.585582,.669845,.142992,.582154,.674522,.147419,.578688,.67916,.151848,.575189,.683758,.156278,.57166,.688318,.160709,.568103,.69284,.165141,.564522,.697324,.169573,.560919,.701769,.174005,.557296,.706178,.178437,.553657,.710549,.182868,.550004,.714883,.187299,.546338,.719181,.191729,.542663,.723444,.196158,.538981,.72767,.200586,.535293,.731862,.205013,.531601,.736019,.209439,.527908,.740143,.213864,.524216,.744232,.218288,.520524,.748289,.222711,.516834,.752312,.227133,.513149,.756304,.231555,.509468,.760264,.235976,.505794,.764193,.240396,.502126,.76809,.244817,.498465,.771958,.249237,.494813,.775796,.253658,.491171,.779604,.258078,.487539,.783383,.2625,.483918,.787133,.266922,.480307,.790855,.271345,.476706,.794549,.27577,.473117,.798216,.280197,.469538,.801855,.284626,.465971,.805467,.289057,.462415,.809052,.293491,.45887,.812612,.297928,.455338,.816144,.302368,.451816,.819651,.306812,.448306,.823132,.311261,.444806,.826588,.315714,.441316,.830018,.320172,.437836,.833422,.324635,.434366,.836801,.329105,.430905,.840155,.33358,.427455,.843484,.338062,.424013,.846788,.342551,.420579,.850066,.347048,.417153,.853319,.351553,.413734,.856547,.356066,.410322,.85975,.360588,.406917,.862927,.365119,.403519,.866078,.36966,.400126,.869203,.374212,.396738,.872303,.378774,.393355,.875376,.383347,.389976,.878423,.387932,.3866,.881443,.392529,.383229,.884436,.397139,.37986,.887402,.401762,.376494,.89034,.406398,.37313,.89325,.411048,.369768,.896131,.415712,.366407,.898984,.420392,.363047,.901807,.425087,.359688,.904601,.429797,.356329,.907365,.434524,.35297,.910098,.439268,.34961,.9128,.444029,.346251,.915471,.448807,.34289,.918109,.453603,.339529,.920714,.458417,.336166,.923287,.463251,.332801,.925825,.468103,.329435,.928329,.472975,.326067,.930798,.477867,.322697,.933232,.48278,.319325,.93563,.487712,.315952,.93799,.492667,.312575,.940313,.497642,.309197,.942598,.502639,.305816,.944844,.507658,.302433,.947051,.512699,.299049,.949217,.517763,.295662,.951344,.52285,.292275,.953428,.52796,.288883,.95547,.533093,.28549,.957469,.53825,.282096,.959424,.543431,.278701,.961336,.548636,.275305,.963203,.553865,.271909,.965024,.559118,.268513,.966798,.564396,.265118,.968526,.5697,.261721,.970205,.575028,.258325,.971835,.580382,.254931,.973416,.585761,.25154,.974947,.591165,.248151,.976428,.596595,.244767,.977856,.602051,.241387,.979233,.607532,.238013,.980556,.613039,.234646,.981826,.618572,.231287,.983041,.624131,.227937,.984199,.629718,.224595,.985301,.63533,.221265,.986345,.640969,.217948,.987332,.646633,.214648,.98826,.652325,.211364,.989128,.658043,.2081,.989935,.663787,.204859,.990681,.669558,.201642,.991365,.675355,.198453,.991985,.681179,.195295,.992541,.68703,.19217,.993032,.692907,.189084,.993456,.69881,.186041,.993814,.704741,.183043,.994103,.710698,.180097,.994324,.716681,.177208,.994474,.722691,.174381,.994553,.728728,.171622,.994561,.734791,.168938,.994495,.74088,.166335,.994355,.746995,.163821,.994141,.753137,.161404,.993851,.759304,.159092,.993482,.765499,.156891,.993033,.77172,.154808,.992505,.777967,.152855,.991897,.784239,.151042,.991209,.790537,.149377,.990439,.796859,.14787,.989587,.803205,.146529,.988648,.809579,.145357,.987621,.815978,.144363,.986509,.822401,.143557,.985314,.828846,.142945,.984031,.835315,.142528,.982653,.841812,.142303,.98119,.848329,.142279,.979644,.854866,.142453,.977995,.861432,.142808,.976265,.868016,.143351,.974443,.874622,.144061,.97253,.88125,.144923,.970533,.887896,.145919,.968443,.894564,.147014,.966271,.901249,.14818,.964021,.90795,.14937,.961681,.914672,.15052,.959276,.921407,.151566,.956808,.928152,.152409,.954287,.934908,.152921,.951726,.941671,.152925,.949151,.948435,.152178,.946602,.95519,.150328,.944152,.961916,.146861,.941896,.96859,.140956,.940015,.975158,.131326]]},{identifier:"viridis",type:"diverging",format:"rgbf",colors:[[.267004,.004874,.329415,.26851,.009605,.335427,.269944,.014625,.341379,.271305,.019942,.347269,.272594,.025563,.353093,.273809,.031497,.358853,.274952,.037752,.364543,.276022,.044167,.370164,.277018,.050344,.375715,.277941,.056324,.381191,.278791,.062145,.386592,.279566,.067836,.391917,.280267,.073417,.397163,.280894,.078907,.402329,.281446,.08432,.407414,.281924,.089666,.412415,.282327,.094955,.417331,.282656,.100196,.42216,.28291,.105393,.426902,.283091,.110553,.431554,.283197,.11568,.436115,.283229,.120777,.440584,.283187,.125848,.44496,.283072,.130895,.449241,.282884,.13592,.453427,.282623,.140926,.457517,.28229,.145912,.46151,.281887,.150881,.465405,.281412,.155834,.469201,.280868,.160771,.472899,.280255,.165693,.476498,.279574,.170599,.479997,.278826,.17549,.483397,.278012,.180367,.486697,.277134,.185228,.489898,.276194,.190074,.493001,.275191,.194905,.496005,.274128,.199721,.498911,.273006,.20452,.501721,.271828,.209303,.504434,.270595,.214069,.507052,.269308,.218818,.509577,.267968,.223549,.512008,.26658,.228262,.514349,.265145,.232956,.516599,.263663,.237631,.518762,.262138,.242286,.520837,.260571,.246922,.522828,.258965,.251537,.524736,.257322,.25613,.526563,.255645,.260703,.528312,.253935,.265254,.529983,.252194,.269783,.531579,.250425,.27429,.533103,.248629,.278775,.534556,.246811,.283237,.535941,.244972,.287675,.53726,.243113,.292092,.538516,.241237,.296485,.539709,.239346,.300855,.540844,.237441,.305202,.541921,.235526,.309527,.542944,.233603,.313828,.543914,.231674,.318106,.544834,.229739,.322361,.545706,.227802,.326594,.546532,.225863,.330805,.547314,.223925,.334994,.548053,.221989,.339161,.548752,.220057,.343307,.549413,.21813,.347432,.550038,.21621,.351535,.550627,.214298,.355619,.551184,.212395,.359683,.55171,.210503,.363727,.552206,.208623,.367752,.552675,.206756,.371758,.553117,.204903,.375746,.553533,.203063,.379716,.553925,.201239,.38367,.554294,.19943,.387607,.554642,.197636,.391528,.554969,.19586,.395433,.555276,.1941,.399323,.555565,.192357,.403199,.555836,.190631,.407061,.556089,.188923,.41091,.556326,.187231,.414746,.556547,.185556,.41857,.556753,.183898,.422383,.556944,.182256,.426184,.55712,.180629,.429975,.557282,.179019,.433756,.55743,.177423,.437527,.557565,.175841,.44129,.557685,.174274,.445044,.557792,.172719,.448791,.557885,.171176,.45253,.557965,.169646,.456262,.55803,.168126,.459988,.558082,.166617,.463708,.558119,.165117,.467423,.558141,.163625,.471133,.558148,.162142,.474838,.55814,.160665,.47854,.558115,.159194,.482237,.558073,.157729,.485932,.558013,.15627,.489624,.557936,.154815,.493313,.55784,.153364,.497,.557724,.151918,.500685,.557587,.150476,.504369,.55743,.149039,.508051,.55725,.147607,.511733,.557049,.14618,.515413,.556823,.144759,.519093,.556572,.143343,.522773,.556295,.141935,.526453,.555991,.140536,.530132,.555659,.139147,.533812,.555298,.13777,.537492,.554906,.136408,.541173,.554483,.135066,.544853,.554029,.133743,.548535,.553541,.132444,.552216,.553018,.131172,.555899,.552459,.129933,.559582,.551864,.128729,.563265,.551229,.127568,.566949,.550556,.126453,.570633,.549841,.125394,.574318,.549086,.124395,.578002,.548287,.123463,.581687,.547445,.122606,.585371,.546557,.121831,.589055,.545623,.121148,.592739,.544641,.120565,.596422,.543611,.120092,.600104,.54253,.119738,.603785,.5414,.119512,.607464,.540218,.119423,.611141,.538982,.119483,.614817,.537692,.119699,.61849,.536347,.120081,.622161,.534946,.120638,.625828,.533488,.12138,.629492,.531973,.122312,.633153,.530398,.123444,.636809,.528763,.12478,.640461,.527068,.126326,.644107,.525311,.128087,.647749,.523491,.130067,.651384,.521608,.132268,.655014,.519661,.134692,.658636,.517649,.137339,.662252,.515571,.14021,.665859,.513427,.143303,.669459,.511215,.146616,.67305,.508936,.150148,.676631,.506589,.153894,.680203,.504172,.157851,.683765,.501686,.162016,.687316,.499129,.166383,.690856,.496502,.170948,.694384,.493803,.175707,.6979,.491033,.180653,.701402,.488189,.185783,.704891,.485273,.19109,.708366,.482284,.196571,.711827,.479221,.202219,.715272,.476084,.20803,.718701,.472873,.214,.722114,.469588,.220124,.725509,.466226,.226397,.728888,.462789,.232815,.732247,.459277,.239374,.735588,.455688,.24607,.73891,.452024,.252899,.742211,.448284,.259857,.745492,.444467,.266941,.748751,.440573,.274149,.751988,.436601,.281477,.755203,.432552,.288921,.758394,.428426,.296479,.761561,.424223,.304148,.764704,.419943,.311925,.767822,.415586,.319809,.770914,.411152,.327796,.77398,.40664,.335885,.777018,.402049,.344074,.780029,.397381,.35236,.783011,.392636,.360741,.785964,.387814,.369214,.788888,.382914,.377779,.791781,.377939,.386433,.794644,.372886,.395174,.797475,.367757,.404001,.800275,.362552,.412913,.803041,.357269,.421908,.805774,.35191,.430983,.808473,.346476,.440137,.811138,.340967,.449368,.813768,.335384,.458674,.816363,.329727,.468053,.818921,.323998,.477504,.821444,.318195,.487026,.823929,.312321,.496615,.826376,.306377,.506271,.828786,.300362,.515992,.831158,.294279,.525776,.833491,.288127,.535621,.835785,.281908,.545524,.838039,.275626,.555484,.840254,.269281,.565498,.84243,.262877,.575563,.844566,.256415,.585678,.846661,.249897,.595839,.848717,.243329,.606045,.850733,.236712,.616293,.852709,.230052,.626579,.854645,.223353,.636902,.856542,.21662,.647257,.8584,.209861,.657642,.860219,.203082,.668054,.861999,.196293,.678489,.863742,.189503,.688944,.865448,.182725,.699415,.867117,.175971,.709898,.868751,.169257,.720391,.87035,.162603,.730889,.871916,.156029,.741388,.873449,.149561,.751884,.874951,.143228,.762373,.876424,.137064,.772852,.877868,.131109,.783315,.879285,.125405,.79376,.880678,.120005,.804182,.882046,.114965,.814576,.883393,.110347,.82494,.88472,.106217,.83527,.886029,.102646,.845561,.887322,.099702,.85581,.888601,.097452,.866013,.889868,.095953,.876168,.891125,.09525,.886271,.892374,.095374,.89632,.893616,.096335,.906311,.894855,.098125,.916242,.896091,.100717,.926106,.89733,.104071,.935904,.89857,.108131,.945636,.899815,.112838,.9553,.901065,.118128,.964894,.902323,.123941,.974417,.90359,.130215,.983868,.904867,.136897,.993248,.906157,.143936]]}],eo=C.auxiliaries.assert,hg=[...ug,...cg];class fg{constructor(){this._intermediaries=new ag,this._labelsChanged=!1,this._bufferResolver=new ig(this._intermediaries.topology),this._geometry=new vt,this._renderer=new vu(this),this._renderer.geometry=this._geometry}applyInnerNodeColorMapping(n){const g=n.geometry,y=n.altered.geometry;if(eo(this._geometry.innerNodeColors!==void 0||y.any,"expected any alteration when inner-node color mapping is yet to be defined"),!y.any&&!n.altered.topology)return;eo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)");const p=this._intermediaries.topology;(n.altered.topology||y.emphasis.any||this._geometry.innerNodeEmphases===void 0)&&(this._geometry.innerNodeEmphases=qf.innerNodes(p,g.emphasis?new Set(g.emphasis.outline):void 0,g.emphasis?new Set(g.emphasis.highlight):void 0)),(n.altered.topology||this._geometry.innerNodeColors===void 0)&&(this._geometry.innerNodeColors=Xb.innerNodes(p,this._colorLUT.innerNodeColorOffset,this._colorLUT.innerNodeColorCount))}applyLeafNodeColorMapping(n){const g=n.geometry,y=n.altered.geometry;if(!y.any&&!n.altered.topology)return;if(eo(this._geometry!==void 0&&this._colorLUT!==void 0,"expected color lookup-table to be specified (cached)"),(n.altered.topology||y.emphasis.any||this._geometry.leafNodeEmphases===void 0)&&(this._geometry.leafNodeEmphases=qf.leafNodes(this._intermediaries.topology,g.emphasis?new Set(g.emphasis.outline):void 0,g.emphasis?new Set(g.emphasis.highlight):void 0)),!(g.leafLayer!==void 0)){this._geometry.leafNodeColors=_t.defaultLeafNodeColors(this._intermediaries.topology,this._colorLUT.leafColorOffset);return}if(!y.colors&&this._geometry.leafNodeColors!==void 0)return;const t=this._bufferResolver.resolve(g.leafLayer.colors,n,this._normalization,this._bufferResolver.constBufferCallback(0));this._intermediaries.aggregatedColors=t;const i=nt.range(t),a=this._colorLUT.leafColorCount,r=this._colorLUT.leafColorOffset;this._geometry.leafNodeColors=_t.createLeafNodeColors(this._intermediaries.topology,t,r,a,i),this._geometry.altered.alter("leafNodeColors")}createLayout(n,g,y,p,t,i){return bs.createLayout(n,g,y.layout,p,t,i)}updateLabels(){const n=this._intermediaries.innerNodeLabels,g=this._intermediaries.leafLabels;if(this._geometry===void 0||!this._geometry.valid||g===void 0||n===void 0)return;let y=!1;if(this._labelsChanged&&(this._renderer.updateLabels(n,g),this._renderer.updatePoints(g),y=!0),this._renderer.camera.altered||this._labelsChanged){const p=rg.adaptPositionToPreventOverlapGreedy(g,this._renderer.camera);p.visibility||p.positioning?(this._renderer.updateLeafLabelBackgrounds(g),this._renderer.updateLeafLabelPass()):this._renderer.frameSizeAltered()?this._renderer.updateLeafLabelBackgrounds(g):y&&this._renderer.updateLeafLabelBackgrounds(g),p.visibility&&this._renderer.updatePoints(g)}this._labelsChanged&&(this._labelsChanged=!1)}update(){var l;if(this._configuration===void 0||this._configuration.topology===void 0)return this._geometry.initialized&&this._geometry.uninitialize(),!0;const n=this._configuration,g=n.altered;if(!g.any)return!1;eo(n.topology!==void 0,"Valid topology expected");let y=g.layout.sort;const p=this._intermediaries.topology;let t;g.topology&&(p.initialize(n.topology.format,n.topology.semantics,n.topology.edges),this._intermediaries.aggregatedWeights=void 0,this._intermediaries.aggregatedHeights=void 0,this._intermediaries.aggregatedColors=void 0,this._intermediaries.accessorySpaces=void 0,this._intermediaries.labelRects=void 0,this._intermediaries.labelPaddingSpaces=void 0,t=void 0,this._geometry.initialized&&this._geometry.uninitialize(),this._geometry.initialize(p),y=!0),this._normalization=nt.createNormalization(p,n);let i=this._intermediaries.aggregatedWeights;(i===void 0||g.layout.weight)&&(i=this._intermediaries.aggregatedWeights=this._bufferResolver.resolve(n.layout.weight,n,this._normalization),t=void 0,y=!0),y&&(gs.sortNodes(p,this._normalization,i,n),t=void 0);let a=this._intermediaries.accessorySpaces,r=this._intermediaries.labelRects,h=this._intermediaries.labelPaddingSpaces;if((t===void 0||g.layout.any)&&(a=this._intermediaries.accessorySpaces=new Array(p.numberOfInnerNodes),r=this._intermediaries.labelRects=new Array(p.numberOfInnerNodes),h=this._intermediaries.labelPaddingSpaces=new Array(p.numberOfInnerNodes),t=this.createLayout(p,i,n,a,r,h),this._geometry.innerNodeLayouts=void 0,this._geometry.leafNodeLayouts=void 0),this._geometry.innerNodeIndices===void 0&&(this._geometry.innerNodeIndices=Wf.innerNodes(p)),this._geometry.leafNodeIndices===void 0&&(this._geometry.leafNodeIndices=Wf.leafNodes(p)),this._geometry.innerNodeLayouts===void 0&&(this._geometry.innerNodeLayouts=_t.createParentLayoutBuffer(p,t,this._configuration.geometry)),this._geometry.leafNodeLayouts===void 0&&(this._geometry.leafNodeLayouts=_t.createLeafLayoutBuffer(p,t,this._configuration.geometry)),this._geometry.leafNodeAreaScales===void 0){const m=this._bufferResolver.constBufferCallback(1);if(this._configuration.geometry.leafLayer){const v=this._bufferResolver.resolve(this._configuration.geometry.leafLayer.areaScale,n,this._normalization,m);this._geometry.leafNodeAreaScales=_t.createLeafAreaScalesBuffer(p,v)}else this._geometry.leafNodeAreaScales=_t.createLeafAreaScalesBuffer(p,m())}const _=(m,v)=>{switch(v){case C.Color.Space.CMYK:{const f=m.fill(1,m.length,5);return new C.Color().fromCMYK(f[0],f[1],f[2],f[3],f[4])}case C.Color.Space.LAB:{const f=m.fill(1,m.length,4);return new C.Color().fromLAB(f[0],f[1],f[2],f[3])}case C.Color.Space.HSL:{const f=m.fill(1,m.length,4);return new C.Color().fromHSL(f[0],f[1],f[2],f[3])}case"hex":return new C.Color().fromHex(m);default:case C.Color.Space.RGB:{const f=m.fill(1,m.length,4);return new C.Color().fromRGB(f[0],f[1],f[2],f[3])}}},d=(m,v)=>{const f=new Array(m.length);for(let b=0;b<f.length;++b)f[b]=_(m[b],v);return f},c=(m,v,f)=>{if(m===void 0||v===void 0)return f;const b=m.find(x=>x.identifier===v.split(":")[1]);if(b===void 0)return f;if(ar.isColorArray(b))return b.value!==void 0?_(b.value,b.colorspace):d(b.values,b.colorspace);if(ar.isColorPreset(b)){const x=hg.find(S=>S.identifier==b.preset);if(!x)return f;const E=b.steps&&x.colors.find(S=>S.length===b.steps*3)||x.colors[0];return C.ColorScale.fromArray(E,x.format,E.length/3,void 0).colors}else return f};if(n.altered.colors||this._colorLUT===void 0){const m=c(n.colors,n.geometry.emphasis?n.geometry.emphasis.color:void 0,new C.Color([0,.27058823529411763,.39215686274509803])),v=c(n.colors,n.geometry.auxiliary,new C.Color([0/255,67/255,37/255])),f=n.geometry.parentLayer?c(n.colors,n.geometry.parentLayer.colorMap,[new C.Color([91/255,92/255,93/255]),new C.Color([93/255,94/255,96/255])]):[new C.Color([91/255,92/255,93/255]),new C.Color([93/255,94/255,96/255])],b=n.geometry.leafLayer?c(n.colors,n.geometry.leafLayer.colorMap,[new C.Color([0/255,0/255,0/255]),new C.Color([44/255,14/255,49/255])]):[new C.Color([0/255,0/255,0/255]),new C.Color([44/255,14/255,49/255])];this._colorLUT=new ng(m,v,f,b),this._geometry.colorTable=void 0}(!this._geometry.colorTable||this._geometry.colorTable.length!==this._colorLUT.bits.length)&&(this._geometry.colorTable=this._colorLUT.bits,this._geometry.altered.alter("colorTableLength"),this._renderer.invalidate()),this.applyInnerNodeColorMapping(n),this.applyLeafNodeColorMapping(n);let s=this._geometry.heightScale;if(s===void 0||g.geometry.heightScale){const m=n.geometry.heightScale;m!==void 0&&m in br.HeightScaleApproach?s=this._geometry.heightScale=br.heightScale(p,m):m!==void 0?s=this._geometry.heightScale=m:s=this._geometry.heightScale=br.heightScale(p,br.HeightScaleApproach.SomethingInverseSqrt),this._geometry.altered.alter("heightScale")}n.altered.geometry.outlineWidth&&(this._geometry.outlineWidth=n.geometry.outlineWidth,this._geometry.altered.alter("outlineWidth")),n.geometry.emphasis&&n.altered.geometry.emphasis.outlineWidth&&(this._geometry.emphasisOutlineWidth=n.geometry.emphasis.outlineWidth,this._geometry.altered.alter("emphasisOutlineWidth")),this._geometry.showRoot=!!((l=n.geometry.parentLayer)!=null&&l.showRoot);let o;if(n.geometry.leafLayer!==void 0){if(g.geometry.heights||g.buffers||g.bufferViews||o===void 0){const m=n.geometry.leafLayer;o=this._bufferResolver.resolve(m.height!==void 0?m.height:"",n,this._normalization,this._bufferResolver.constBufferCallback()),this._intermediaries.aggregatedHeights=o;const v=_t.createLayerHeightBuffer(p,o,void 0,this._configuration.geometry);this._geometry.leafNodeHeights=v,this._geometry.altered.alter("leafNodeHeights")}}else o=void 0,this._geometry.leafNodeHeights=_t.createEmptyLayerHeightBuffer(p);if((this._intermediaries.leafLabels===void 0||this._intermediaries.innerNodeLabels===void 0||n.altered.labels)&&n.labels!==void 0&&n.labels.names!==void 0){let m=new Map;if(typeof n.labels.names=="string"){const v=nt.create(p,this._normalization,n.labels.names,n);Object.keys(v).forEach(f=>{const b=parseInt(f,10);m.set(b,v[b])})}else m=n.labels.names;if(m!==void 0&&this._intermediaries.aggregatedHeights&&this._intermediaries.aggregatedWeights&&this._intermediaries.aggregatedColors){const v=Qe.createLabelSelection(p,this._intermediaries.aggregatedWeights,this._intermediaries.aggregatedHeights,this._intermediaries.aggregatedColors,new Set,n.labels.innerNodeLayerRange,n.labels.numTopInnerNodes,n.labels.numTopWeightNodes,n.labels.numTopHeightNodes,n.labels.numTopColorNodes);this._intermediaries.leafLabels=Qe.fillLeafLabelArray(p,m,v,this._geometry.heightScale,this._geometry.leafNodeLayouts,this._geometry.leafNodeHeights),this._intermediaries.innerNodeLabels=Qe.fillInnerNodeLabelArrayOnAccessory(p,m,v,this._intermediaries.accessorySpaces),this._labelsChanged=!0,this._renderer.invalidate()}}return n.altered.reset(),!0}prepare(){this.updateLabels()}get renderer(){return this._renderer}get configuration(){return this._configuration}set configuration(n){this._configuration=n}}function _g(T,n,g=new C.Color().fromHex("fafafa")){const y=T instanceof HTMLCanvasElement?T:document.getElementById(T),p=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);navigator.appVersion.indexOf("Mac")!==-1&&p&&(y.dataset.msqrdP="no-WEBGL_draw_buffers",console.warn("detected Chrome on MacOS, disabling WEBGL_draw_buffers"));const t=new C.Canvas(y,{alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});return new C.viewer.EventBlocker(t.element).block("contextmenu"),t.clearColor=g,t.framePrecision=C.Wizard.Precision.byte,t.controller.multiFrameNumber=64,t.context.gl.clearColor(g.r,g.g,g.b,g.a),t.context.gl.clear(t.context.gl.COLOR_BUFFER_BIT),t}typeof LOG_VERBOSITY_THRESHOLD<"u"&&C.auxiliaries.logVerbosity(LOG_VERBOSITY_THRESHOLD);typeof DISABLE_ASSERTIONS<"u"&&C.auxiliaries.assertions(!DISABLE_ASSERTIONS);class pg extends C.Initializable{expose(){}}export{ar as C,pg as E,gs as N,et as T,fg as V,$ as c,dg as g,_g as i,C as w};
