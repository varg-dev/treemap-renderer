function Sv(T,a){for(var g=0;g<a.length;g++){const y=a[g];if(typeof y!="string"&&!Array.isArray(y)){for(const v in y)if(v!=="default"&&!(v in T)){const t=Object.getOwnPropertyDescriptor(y,v);t&&Object.defineProperty(T,v,t.get?t:{enumerable:!0,get:()=>y[v]})}}}return Object.freeze(Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}))}var H=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ov(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var Xf={exports:{}},$u={},Ur={},Hu={},Gr={},Oc;function Ce(){if(Oc)return Gr;Oc=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.isFunction=void 0;function T(a){return typeof a=="function"}return Gr.isFunction=T,Gr}var Vt={},qr={},Wr={},Rc;function yr(){if(Rc)return Wr;Rc=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.createErrorClass=void 0;function T(a){var g=function(v){Error.call(v),v.stack=new Error().stack},y=a(g);return y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y}return Wr.createErrorClass=T,Wr}var wc;function Yf(){if(wc)return qr;wc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.UnsubscriptionError=void 0;var T=yr();return qr.UnsubscriptionError=T.createErrorClass(function(a){return function(y){a(this),this.message=y?y.length+` errors occurred during unsubscription:
`+y.map(function(v,t){return t+1+") "+v.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=y}}),qr}var Vr={},Pc;function Zt(){if(Pc)return Vr;Pc=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.arrRemove=void 0;function T(a,g){if(a){var y=a.indexOf(g);0<=y&&a.splice(y,1)}}return Vr.arrRemove=T,Vr}var Lc;function Ot(){if(Lc)return Vt;Lc=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},a=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,u=[],o;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)u.push(s.value)}catch(m){o={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(o)throw o.error}}return u},g=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.isSubscription=Vt.EMPTY_SUBSCRIPTION=Vt.Subscription=void 0;var y=Ce(),v=Yf(),t=Zt(),i=function(){function c(f){this.initialTeardown=f,this.closed=!1,this._parentage=null,this._finalizers=null}return c.prototype.unsubscribe=function(){var f,d,h,s,u;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var m=T(o),_=m.next();!_.done;_=m.next()){var p=_.value;p.remove(this)}}catch(R){f={error:R}}finally{try{_&&!_.done&&(d=m.return)&&d.call(m)}finally{if(f)throw f.error}}else o.remove(this);var b=this.initialTeardown;if(y.isFunction(b))try{b()}catch(R){u=R instanceof v.UnsubscriptionError?R.errors:[R]}var x=this._finalizers;if(x){this._finalizers=null;try{for(var E=T(x),w=E.next();!w.done;w=E.next()){var S=w.value;try{r(S)}catch(R){u=u??[],R instanceof v.UnsubscriptionError?u=g(g([],a(u)),a(R.errors)):u.push(R)}}}catch(R){h={error:R}}finally{try{w&&!w.done&&(s=E.return)&&s.call(E)}finally{if(h)throw h.error}}}if(u)throw new v.UnsubscriptionError(u)}},c.prototype.add=function(f){var d;if(f&&f!==this)if(this.closed)r(f);else{if(f instanceof c){if(f.closed||f._hasParent(this))return;f._addParent(this)}(this._finalizers=(d=this._finalizers)!==null&&d!==void 0?d:[]).push(f)}},c.prototype._hasParent=function(f){var d=this._parentage;return d===f||Array.isArray(d)&&d.includes(f)},c.prototype._addParent=function(f){var d=this._parentage;this._parentage=Array.isArray(d)?(d.push(f),d):d?[d,f]:f},c.prototype._removeParent=function(f){var d=this._parentage;d===f?this._parentage=null:Array.isArray(d)&&t.arrRemove(d,f)},c.prototype.remove=function(f){var d=this._finalizers;d&&t.arrRemove(d,f),f instanceof c&&f._removeParent(this)},c.EMPTY=function(){var f=new c;return f.closed=!0,f}(),c}();Vt.Subscription=i,Vt.EMPTY_SUBSCRIPTION=i.EMPTY;function n(c){return c instanceof i||c&&"closed"in c&&y.isFunction(c.remove)&&y.isFunction(c.add)&&y.isFunction(c.unsubscribe)}Vt.isSubscription=n;function r(c){y.isFunction(c)?c():c.unsubscribe()}return Vt}var $r={},Mc;function ys(){return Mc||(Mc=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.config=void 0,$r.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}),$r}var Hr={},Xu={},Ic;function Zf(){return Ic||(Ic=1,function(T){var a=H&&H.__read||function(y,v){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),n,r=[],c;try{for(;(v===void 0||v-- >0)&&!(n=i.next()).done;)r.push(n.value)}catch(f){c={error:f}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return r},g=H&&H.__spreadArray||function(y,v){for(var t=0,i=v.length,n=y.length;t<i;t++,n++)y[n]=v[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.timeoutProvider=void 0,T.timeoutProvider={setTimeout:function(y,v){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var n=T.timeoutProvider.delegate;return n!=null&&n.setTimeout?n.setTimeout.apply(n,g([y,v],a(t))):setTimeout.apply(void 0,g([y,v],a(t)))},clearTimeout:function(y){var v=T.timeoutProvider.delegate;return((v==null?void 0:v.clearTimeout)||clearTimeout)(y)},delegate:void 0}}(Xu)),Xu}var Fc;function Kf(){if(Fc)return Hr;Fc=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.reportUnhandledError=void 0;var T=ys(),a=Zf();function g(y){a.timeoutProvider.setTimeout(function(){var v=T.config.onUnhandledError;if(v)v(y);else throw y})}return Hr.reportUnhandledError=g,Hr}var Xr={},Cc;function ut(){if(Cc)return Xr;Cc=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.noop=void 0;function T(){}return Xr.noop=T,Xr}var Ft={},Nc;function Rv(){if(Nc)return Ft;Nc=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.createNotification=Ft.nextNotification=Ft.errorNotification=Ft.COMPLETE_NOTIFICATION=void 0,Ft.COMPLETE_NOTIFICATION=function(){return g("C",void 0,void 0)}();function T(y){return g("E",void 0,y)}Ft.errorNotification=T;function a(y){return g("N",y,void 0)}Ft.nextNotification=a;function g(y,v,t){return{kind:y,value:v,error:t}}return Ft.createNotification=g,Ft}var er={},zc;function ml(){if(zc)return er;zc=1,Object.defineProperty(er,"__esModule",{value:!0}),er.captureError=er.errorContext=void 0;var T=ys(),a=null;function g(v){if(T.config.useDeprecatedSynchronousErrorHandling){var t=!a;if(t&&(a={errorThrown:!1,error:null}),v(),t){var i=a,n=i.errorThrown,r=i.error;if(a=null,n)throw r}}else v()}er.errorContext=g;function y(v){T.config.useDeprecatedSynchronousErrorHandling&&a&&(a.errorThrown=!0,a.error=v)}return er.captureError=y,er}var Bc;function Es(){return Bc||(Bc=1,function(T){var a=H&&H.__extends||function(){var p=function(b,x){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,w){E.__proto__=w}||function(E,w){for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(E[S]=w[S])},p(b,x)};return function(b,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");p(b,x);function E(){this.constructor=b}b.prototype=x===null?Object.create(x):(E.prototype=x.prototype,new E)}}();Object.defineProperty(T,"__esModule",{value:!0}),T.EMPTY_OBSERVER=T.SafeSubscriber=T.Subscriber=void 0;var g=Ce(),y=Ot(),v=ys(),t=Kf(),i=ut(),n=Rv(),r=Zf(),c=ml(),f=function(p){a(b,p);function b(x){var E=p.call(this)||this;return E.isStopped=!1,x?(E.destination=x,y.isSubscription(x)&&x.add(E)):E.destination=T.EMPTY_OBSERVER,E}return b.create=function(x,E,w){return new u(x,E,w)},b.prototype.next=function(x){this.isStopped?_(n.nextNotification(x),this):this._next(x)},b.prototype.error=function(x){this.isStopped?_(n.errorNotification(x),this):(this.isStopped=!0,this._error(x))},b.prototype.complete=function(){this.isStopped?_(n.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},b.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,p.prototype.unsubscribe.call(this),this.destination=null)},b.prototype._next=function(x){this.destination.next(x)},b.prototype._error=function(x){try{this.destination.error(x)}finally{this.unsubscribe()}},b.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},b}(y.Subscription);T.Subscriber=f;var d=Function.prototype.bind;function h(p,b){return d.call(p,b)}var s=function(){function p(b){this.partialObserver=b}return p.prototype.next=function(b){var x=this.partialObserver;if(x.next)try{x.next(b)}catch(E){o(E)}},p.prototype.error=function(b){var x=this.partialObserver;if(x.error)try{x.error(b)}catch(E){o(E)}else o(b)},p.prototype.complete=function(){var b=this.partialObserver;if(b.complete)try{b.complete()}catch(x){o(x)}},p}(),u=function(p){a(b,p);function b(x,E,w){var S=p.call(this)||this,R;if(g.isFunction(x)||!x)R={next:x??void 0,error:E??void 0,complete:w??void 0};else{var O;S&&v.config.useDeprecatedNextContext?(O=Object.create(x),O.unsubscribe=function(){return S.unsubscribe()},R={next:x.next&&h(x.next,O),error:x.error&&h(x.error,O),complete:x.complete&&h(x.complete,O)}):R=x}return S.destination=new s(R),S}return b}(f);T.SafeSubscriber=u;function o(p){v.config.useDeprecatedSynchronousErrorHandling?c.captureError(p):t.reportUnhandledError(p)}function m(p){throw p}function _(p,b){var x=v.config.onStoppedNotification;x&&r.timeoutProvider.setTimeout(function(){return x(p,b)})}T.EMPTY_OBSERVER={closed:!0,next:i.noop,error:m,complete:i.noop}}(Hu)),Hu}var Yr={},Dc;function io(){return Dc||(Dc=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.observable=void 0,Yr.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()),Yr}var tr={},Zr={},jc;function lt(){if(jc)return Zr;jc=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.identity=void 0;function T(a){return a}return Zr.identity=T,Zr}var kc;function no(){if(kc)return tr;kc=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.pipeFromArray=tr.pipe=void 0;var T=lt();function a(){for(var y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];return g(y)}tr.pipe=a;function g(y){return y.length===0?T.identity:y.length===1?y[0]:function(t){return y.reduce(function(i,n){return n(i)},t)}}return tr.pipeFromArray=g,tr}var Uc;function ze(){if(Uc)return Ur;Uc=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Observable=void 0;var T=Es(),a=Ot(),g=io(),y=no(),v=ys(),t=Ce(),i=ml(),n=function(){function d(h){h&&(this._subscribe=h)}return d.prototype.lift=function(h){var s=new d;return s.source=this,s.operator=h,s},d.prototype.subscribe=function(h,s,u){var o=this,m=f(h)?h:new T.SafeSubscriber(h,s,u);return i.errorContext(function(){var _=o,p=_.operator,b=_.source;m.add(p?p.call(m,b):b?o._subscribe(m):o._trySubscribe(m))}),m},d.prototype._trySubscribe=function(h){try{return this._subscribe(h)}catch(s){h.error(s)}},d.prototype.forEach=function(h,s){var u=this;return s=r(s),new s(function(o,m){var _=new T.SafeSubscriber({next:function(p){try{h(p)}catch(b){m(b),_.unsubscribe()}},error:m,complete:o});u.subscribe(_)})},d.prototype._subscribe=function(h){var s;return(s=this.source)===null||s===void 0?void 0:s.subscribe(h)},d.prototype[g.observable]=function(){return this},d.prototype.pipe=function(){for(var h=[],s=0;s<arguments.length;s++)h[s]=arguments[s];return y.pipeFromArray(h)(this)},d.prototype.toPromise=function(h){var s=this;return h=r(h),new h(function(u,o){var m;s.subscribe(function(_){return m=_},function(_){return o(_)},function(){return u(m)})})},d.create=function(h){return new d(h)},d}();Ur.Observable=n;function r(d){var h;return(h=d??v.config.Promise)!==null&&h!==void 0?h:Promise}function c(d){return d&&t.isFunction(d.next)&&t.isFunction(d.error)&&t.isFunction(d.complete)}function f(d){return d&&d instanceof T.Subscriber||c(d)&&a.isSubscription(d)}return Ur}var Kr={},Qr={},rr={},Gc;function ie(){if(Gc)return rr;Gc=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.operate=rr.hasLift=void 0;var T=Ce();function a(y){return T.isFunction(y==null?void 0:y.lift)}rr.hasLift=a;function g(y){return function(v){if(a(v))return v.lift(function(t){try{return y(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}return rr.operate=g,rr}var ir={},qc;function ue(){if(qc)return ir;qc=1;var T=H&&H.__extends||function(){var v=function(t,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(n[c]=r[c])},v(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");v(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(ir,"__esModule",{value:!0}),ir.OperatorSubscriber=ir.createOperatorSubscriber=void 0;var a=Es();function g(v,t,i,n,r){return new y(v,t,i,n,r)}ir.createOperatorSubscriber=g;var y=function(v){T(t,v);function t(i,n,r,c,f,d){var h=v.call(this,i)||this;return h.onFinalize=f,h.shouldUnsubscribe=d,h._next=n?function(s){try{n(s)}catch(u){i.error(u)}}:v.prototype._next,h._error=c?function(s){try{c(s)}catch(u){i.error(u)}finally{this.unsubscribe()}}:v.prototype._error,h._complete=r?function(){try{r()}catch(s){i.error(s)}finally{this.unsubscribe()}}:v.prototype._complete,h}return t.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;v.prototype.unsubscribe.call(this),!n&&((i=this.onFinalize)===null||i===void 0||i.call(this))}},t}(a.Subscriber);return ir.OperatorSubscriber=y,ir}var Wc;function Qf(){if(Wc)return Qr;Wc=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.refCount=void 0;var T=ie(),a=ue();function g(){return T.operate(function(y,v){var t=null;y._refCount++;var i=a.createOperatorSubscriber(v,void 0,void 0,void 0,function(){if(!y||y._refCount<=0||0<--y._refCount){t=null;return}var n=y._connection,r=t;t=null,n&&(!r||n===r)&&n.unsubscribe(),v.unsubscribe()});y.subscribe(i),i.closed||(t=y.connect())})}return Qr.refCount=g,Qr}var Vc;function ao(){if(Vc)return Kr;Vc=1;var T=H&&H.__extends||function(){var n=function(r,c){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(f[h]=d[h])},n(r,c)};return function(r,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");n(r,c);function f(){this.constructor=r}r.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)}}();Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.ConnectableObservable=void 0;var a=ze(),g=Ot(),y=Qf(),v=ue(),t=ie(),i=function(n){T(r,n);function r(c,f){var d=n.call(this)||this;return d.source=c,d.subjectFactory=f,d._subject=null,d._refCount=0,d._connection=null,t.hasLift(c)&&(d.lift=c.lift),d}return r.prototype._subscribe=function(c){return this.getSubject().subscribe(c)},r.prototype.getSubject=function(){var c=this._subject;return(!c||c.isStopped)&&(this._subject=this.subjectFactory()),this._subject},r.prototype._teardown=function(){this._refCount=0;var c=this._connection;this._subject=this._connection=null,c==null||c.unsubscribe()},r.prototype.connect=function(){var c=this,f=this._connection;if(!f){f=this._connection=new g.Subscription;var d=this.getSubject();f.add(this.source.subscribe(v.createOperatorSubscriber(d,void 0,function(){c._teardown(),d.complete()},function(h){c._teardown(),d.error(h)},function(){return c._teardown()}))),f.closed&&(this._connection=null,f=g.Subscription.EMPTY)}return f},r.prototype.refCount=function(){return y.refCount()(this)},r}(a.Observable);return Kr.ConnectableObservable=i,Kr}var Jr={},Yu={},$c;function wv(){return $c||($c=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.performanceTimestampProvider=void 0,T.performanceTimestampProvider={now:function(){return(T.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}}(Yu)),Yu}var Zu={},Hc;function Jf(){return Hc||(Hc=1,function(T){var a=H&&H.__read||function(v,t){var i=typeof Symbol=="function"&&v[Symbol.iterator];if(!i)return v;var n=i.call(v),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(f)throw f.error}}return c},g=H&&H.__spreadArray||function(v,t){for(var i=0,n=t.length,r=v.length;i<n;i++,r++)v[r]=t[i];return v};Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrameProvider=void 0;var y=Ot();T.animationFrameProvider={schedule:function(v){var t=requestAnimationFrame,i=cancelAnimationFrame,n=T.animationFrameProvider.delegate;n&&(t=n.requestAnimationFrame,i=n.cancelAnimationFrame);var r=t(function(c){i=void 0,v(c)});return new y.Subscription(function(){return i==null?void 0:i(r)})},requestAnimationFrame:function(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.requestAnimationFrame)||requestAnimationFrame).apply(void 0,g([],a(v)))},cancelAnimationFrame:function(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];var i=T.animationFrameProvider.delegate;return((i==null?void 0:i.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,g([],a(v)))},delegate:void 0}}(Zu)),Zu}var Xc;function Pv(){if(Xc)return Jr;Xc=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.animationFrames=void 0;var T=ze(),a=wv(),g=Jf();function y(i){return i?v(i):t}Jr.animationFrames=y;function v(i){return new T.Observable(function(n){var r=i||a.performanceTimestampProvider,c=r.now(),f=0,d=function(){n.closed||(f=g.animationFrameProvider.requestAnimationFrame(function(h){f=0;var s=r.now();n.next({timestamp:i?s:h,elapsed:s-c}),d()}))};return d(),function(){f&&g.animationFrameProvider.cancelAnimationFrame(f)}})}var t=v();return Jr}var nr={},ei={},Yc;function e_(){if(Yc)return ei;Yc=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.ObjectUnsubscribedError=void 0;var T=yr();return ei.ObjectUnsubscribedError=T.createErrorClass(function(a){return function(){a(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ei}var Zc;function ct(){if(Zc)return nr;Zc=1;var T=H&&H.__extends||function(){var c=function(f,d){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,s){h.__proto__=s}||function(h,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(h[u]=s[u])},c(f,d)};return function(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");c(f,d);function h(){this.constructor=f}f.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),a=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(nr,"__esModule",{value:!0}),nr.AnonymousSubject=nr.Subject=void 0;var g=ze(),y=Ot(),v=e_(),t=Zt(),i=ml(),n=function(c){T(f,c);function f(){var d=c.call(this)||this;return d.closed=!1,d.currentObservers=null,d.observers=[],d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return f.prototype.lift=function(d){var h=new r(this,this);return h.operator=d,h},f.prototype._throwIfClosed=function(){if(this.closed)throw new v.ObjectUnsubscribedError},f.prototype.next=function(d){var h=this;i.errorContext(function(){var s,u;if(h._throwIfClosed(),!h.isStopped){h.currentObservers||(h.currentObservers=Array.from(h.observers));try{for(var o=a(h.currentObservers),m=o.next();!m.done;m=o.next()){var _=m.value;_.next(d)}}catch(p){s={error:p}}finally{try{m&&!m.done&&(u=o.return)&&u.call(o)}finally{if(s)throw s.error}}}})},f.prototype.error=function(d){var h=this;i.errorContext(function(){if(h._throwIfClosed(),!h.isStopped){h.hasError=h.isStopped=!0,h.thrownError=d;for(var s=h.observers;s.length;)s.shift().error(d)}})},f.prototype.complete=function(){var d=this;i.errorContext(function(){if(d._throwIfClosed(),!d.isStopped){d.isStopped=!0;for(var h=d.observers;h.length;)h.shift().complete()}})},f.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(f.prototype,"observed",{get:function(){var d;return((d=this.observers)===null||d===void 0?void 0:d.length)>0},enumerable:!1,configurable:!0}),f.prototype._trySubscribe=function(d){return this._throwIfClosed(),c.prototype._trySubscribe.call(this,d)},f.prototype._subscribe=function(d){return this._throwIfClosed(),this._checkFinalizedStatuses(d),this._innerSubscribe(d)},f.prototype._innerSubscribe=function(d){var h=this,s=this,u=s.hasError,o=s.isStopped,m=s.observers;return u||o?y.EMPTY_SUBSCRIPTION:(this.currentObservers=null,m.push(d),new y.Subscription(function(){h.currentObservers=null,t.arrRemove(m,d)}))},f.prototype._checkFinalizedStatuses=function(d){var h=this,s=h.hasError,u=h.thrownError,o=h.isStopped;s?d.error(u):o&&d.complete()},f.prototype.asObservable=function(){var d=new g.Observable;return d.source=this,d},f.create=function(d,h){return new r(d,h)},f}(g.Observable);nr.Subject=n;var r=function(c){T(f,c);function f(d,h){var s=c.call(this)||this;return s.destination=d,s.source=h,s}return f.prototype.next=function(d){var h,s;(s=(h=this.destination)===null||h===void 0?void 0:h.next)===null||s===void 0||s.call(h,d)},f.prototype.error=function(d){var h,s;(s=(h=this.destination)===null||h===void 0?void 0:h.error)===null||s===void 0||s.call(h,d)},f.prototype.complete=function(){var d,h;(h=(d=this.destination)===null||d===void 0?void 0:d.complete)===null||h===void 0||h.call(d)},f.prototype._subscribe=function(d){var h,s;return(s=(h=this.source)===null||h===void 0?void 0:h.subscribe(d))!==null&&s!==void 0?s:y.EMPTY_SUBSCRIPTION},f}(n);return nr.AnonymousSubject=r,nr}var ti={},Kc;function t_(){if(Kc)return ti;Kc=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ti,"__esModule",{value:!0}),ti.BehaviorSubject=void 0;var a=ct(),g=function(y){T(v,y);function v(t){var i=y.call(this)||this;return i._value=t,i}return Object.defineProperty(v.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),v.prototype._subscribe=function(t){var i=y.prototype._subscribe.call(this,t);return!i.closed&&t.next(this._value),i},v.prototype.getValue=function(){var t=this,i=t.hasError,n=t.thrownError,r=t._value;if(i)throw n;return this._throwIfClosed(),r},v.prototype.next=function(t){y.prototype.next.call(this,this._value=t)},v}(a.Subject);return ti.BehaviorSubject=g,ti}var ri={},Ku={},Qc;function gl(){return Qc||(Qc=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.dateTimestampProvider=void 0,T.dateTimestampProvider={now:function(){return(T.dateTimestampProvider.delegate||Date).now()},delegate:void 0}}(Ku)),Ku}var Jc;function bl(){if(Jc)return ri;Jc=1;var T=H&&H.__extends||function(){var v=function(t,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(n[c]=r[c])},v(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");v(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(ri,"__esModule",{value:!0}),ri.ReplaySubject=void 0;var a=ct(),g=gl(),y=function(v){T(t,v);function t(i,n,r){i===void 0&&(i=1/0),n===void 0&&(n=1/0),r===void 0&&(r=g.dateTimestampProvider);var c=v.call(this)||this;return c._bufferSize=i,c._windowTime=n,c._timestampProvider=r,c._buffer=[],c._infiniteTimeWindow=!0,c._infiniteTimeWindow=n===1/0,c._bufferSize=Math.max(1,i),c._windowTime=Math.max(1,n),c}return t.prototype.next=function(i){var n=this,r=n.isStopped,c=n._buffer,f=n._infiniteTimeWindow,d=n._timestampProvider,h=n._windowTime;r||(c.push(i),!f&&c.push(d.now()+h)),this._trimBuffer(),v.prototype.next.call(this,i)},t.prototype._subscribe=function(i){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(i),r=this,c=r._infiniteTimeWindow,f=r._buffer,d=f.slice(),h=0;h<d.length&&!i.closed;h+=c?1:2)i.next(d[h]);return this._checkFinalizedStatuses(i),n},t.prototype._trimBuffer=function(){var i=this,n=i._bufferSize,r=i._timestampProvider,c=i._buffer,f=i._infiniteTimeWindow,d=(f?1:2)*n;if(n<1/0&&d<c.length&&c.splice(0,c.length-d),!f){for(var h=r.now(),s=0,u=1;u<c.length&&c[u]<=h;u+=2)s=u;s&&c.splice(0,s+1)}},t}(a.Subject);return ri.ReplaySubject=y,ri}var ii={},eh;function yl(){if(eh)return ii;eh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ii,"__esModule",{value:!0}),ii.AsyncSubject=void 0;var a=ct(),g=function(y){T(v,y);function v(){var t=y!==null&&y.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return v.prototype._checkFinalizedStatuses=function(t){var i=this,n=i.hasError,r=i._hasValue,c=i._value,f=i.thrownError,d=i.isStopped,h=i._isComplete;n?t.error(f):(d||h)&&(r&&t.next(c),t.complete())},v.prototype.next=function(t){this.isStopped||(this._value=t,this._hasValue=!0)},v.prototype.complete=function(){var t=this,i=t._hasValue,n=t._value,r=t._isComplete;r||(this._isComplete=!0,i&&y.prototype.next.call(this,n),y.prototype.complete.call(this))},v}(a.Subject);return ii.AsyncSubject=g,ii}var Qu={},ni={},ai={},si={},th;function Lv(){if(th)return si;th=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(si,"__esModule",{value:!0}),si.Action=void 0;var a=Ot(),g=function(y){T(v,y);function v(t,i){return y.call(this)||this}return v.prototype.schedule=function(t,i){return this},v}(a.Subscription);return si.Action=g,si}var Ju={},rh;function Mv(){return rh||(rh=1,function(T){var a=H&&H.__read||function(y,v){var t=typeof Symbol=="function"&&y[Symbol.iterator];if(!t)return y;var i=t.call(y),n,r=[],c;try{for(;(v===void 0||v-- >0)&&!(n=i.next()).done;)r.push(n.value)}catch(f){c={error:f}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return r},g=H&&H.__spreadArray||function(y,v){for(var t=0,i=v.length,n=y.length;t<i;t++,n++)y[n]=v[t];return y};Object.defineProperty(T,"__esModule",{value:!0}),T.intervalProvider=void 0,T.intervalProvider={setInterval:function(y,v){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var n=T.intervalProvider.delegate;return n!=null&&n.setInterval?n.setInterval.apply(n,g([y,v],a(t))):setInterval.apply(void 0,g([y,v],a(t)))},clearInterval:function(y){var v=T.intervalProvider.delegate;return((v==null?void 0:v.clearInterval)||clearInterval)(y)},delegate:void 0}}(Ju)),Ju}var ih;function Ts(){if(ih)return ai;ih=1;var T=H&&H.__extends||function(){var t=function(i,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,c){r.__proto__=c}||function(r,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(r[f]=c[f])},t(i,n)};return function(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(i,n);function r(){this.constructor=i}i.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(ai,"__esModule",{value:!0}),ai.AsyncAction=void 0;var a=Lv(),g=Mv(),y=Zt(),v=function(t){T(i,t);function i(n,r){var c=t.call(this,n,r)||this;return c.scheduler=n,c.work=r,c.pending=!1,c}return i.prototype.schedule=function(n,r){var c;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var f=this.id,d=this.scheduler;return f!=null&&(this.id=this.recycleAsyncId(d,f,r)),this.pending=!0,this.delay=r,this.id=(c=this.id)!==null&&c!==void 0?c:this.requestAsyncId(d,this.id,r),this},i.prototype.requestAsyncId=function(n,r,c){return c===void 0&&(c=0),g.intervalProvider.setInterval(n.flush.bind(n,this),c)},i.prototype.recycleAsyncId=function(n,r,c){if(c===void 0&&(c=0),c!=null&&this.delay===c&&this.pending===!1)return r;r!=null&&g.intervalProvider.clearInterval(r)},i.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var c=this._execute(n,r);if(c)return c;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(n,r){var c=!1,f;try{this.work(n)}catch(d){c=!0,f=d||new Error("Scheduled action threw falsy error")}if(c)return this.unsubscribe(),f},i.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,c=n.scheduler,f=c.actions;this.work=this.state=this.scheduler=null,this.pending=!1,y.arrRemove(f,this),r!=null&&(this.id=this.recycleAsyncId(c,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},i}(a.Action);return ai.AsyncAction=v,ai}var el={},ar={},nh;function Iv(){if(nh)return ar;nh=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.TestTools=ar.Immediate=void 0;var T=1,a,g={};function y(v){return v in g?(delete g[v],!0):!1}return ar.Immediate={setImmediate:function(v){var t=T++;return g[t]=!0,a||(a=Promise.resolve()),a.then(function(){return y(t)&&v()}),t},clearImmediate:function(v){y(v)}},ar.TestTools={pending:function(){return Object.keys(g).length}},ar}var ah;function Fv(){return ah||(ah=1,function(T){var a=H&&H.__read||function(i,n){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(n===void 0||n-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},g=H&&H.__spreadArray||function(i,n){for(var r=0,c=n.length,f=i.length;r<c;r++,f++)i[f]=n[r];return i};Object.defineProperty(T,"__esModule",{value:!0}),T.immediateProvider=void 0;var y=Iv(),v=y.Immediate.setImmediate,t=y.Immediate.clearImmediate;T.immediateProvider={setImmediate:function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var r=T.immediateProvider.delegate;return((r==null?void 0:r.setImmediate)||v).apply(void 0,g([],a(i)))},clearImmediate:function(i){var n=T.immediateProvider.delegate;return((n==null?void 0:n.clearImmediate)||t)(i)},delegate:void 0}}(el)),el}var sh;function Cv(){if(sh)return ni;sh=1;var T=H&&H.__extends||function(){var v=function(t,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(n[c]=r[c])},v(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");v(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(ni,"__esModule",{value:!0}),ni.AsapAction=void 0;var a=Ts(),g=Fv(),y=function(v){T(t,v);function t(i,n){var r=v.call(this,i,n)||this;return r.scheduler=i,r.work=n,r}return t.prototype.requestAsyncId=function(i,n,r){return r===void 0&&(r=0),r!==null&&r>0?v.prototype.requestAsyncId.call(this,i,n,r):(i.actions.push(this),i._scheduled||(i._scheduled=g.immediateProvider.setImmediate(i.flush.bind(i,void 0))))},t.prototype.recycleAsyncId=function(i,n,r){var c;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return v.prototype.recycleAsyncId.call(this,i,n,r);var f=i.actions;n!=null&&((c=f[f.length-1])===null||c===void 0?void 0:c.id)!==n&&(g.immediateProvider.clearImmediate(n),i._scheduled===n&&(i._scheduled=void 0))},t}(a.AsyncAction);return ni.AsapAction=y,ni}var oi={},ui={},li={},oh;function r_(){if(oh)return li;oh=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Scheduler=void 0;var T=gl(),a=function(){function g(y,v){v===void 0&&(v=g.now),this.schedulerActionCtor=y,this.now=v}return g.prototype.schedule=function(y,v,t){return v===void 0&&(v=0),new this.schedulerActionCtor(this,y).schedule(t,v)},g.now=T.dateTimestampProvider.now,g}();return li.Scheduler=a,li}var uh;function xs(){if(uh)return ui;uh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ui,"__esModule",{value:!0}),ui.AsyncScheduler=void 0;var a=r_(),g=function(y){T(v,y);function v(t,i){i===void 0&&(i=a.Scheduler.now);var n=y.call(this,t,i)||this;return n.actions=[],n._active=!1,n}return v.prototype.flush=function(t){var i=this.actions;if(this._active){i.push(t);return}var n;this._active=!0;do if(n=t.execute(t.state,t.delay))break;while(t=i.shift());if(this._active=!1,n){for(;t=i.shift();)t.unsubscribe();throw n}},v}(a.Scheduler);return ui.AsyncScheduler=g,ui}var lh;function Nv(){if(lh)return oi;lh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(oi,"__esModule",{value:!0}),oi.AsapScheduler=void 0;var a=xs(),g=function(y){T(v,y);function v(){return y!==null&&y.apply(this,arguments)||this}return v.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var n=this.actions,r;t=t||n.shift();do if(r=t.execute(t.state,t.delay))break;while((t=n[0])&&t.id===i&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===i&&n.shift();)t.unsubscribe();throw r}},v}(a.AsyncScheduler);return oi.AsapScheduler=g,oi}var ch;function zv(){return ch||(ch=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.asap=T.asapScheduler=void 0;var a=Cv(),g=Nv();T.asapScheduler=new g.AsapScheduler(a.AsapAction),T.asap=T.asapScheduler}(Qu)),Qu}var tl={},hh;function Tt(){return hh||(hh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.async=T.asyncScheduler=void 0;var a=Ts(),g=xs();T.asyncScheduler=new g.AsyncScheduler(a.AsyncAction),T.async=T.asyncScheduler}(tl)),tl}var rl={},ci={},dh;function Bv(){if(dh)return ci;dh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ci,"__esModule",{value:!0}),ci.QueueAction=void 0;var a=Ts(),g=function(y){T(v,y);function v(t,i){var n=y.call(this,t,i)||this;return n.scheduler=t,n.work=i,n}return v.prototype.schedule=function(t,i){return i===void 0&&(i=0),i>0?y.prototype.schedule.call(this,t,i):(this.delay=i,this.state=t,this.scheduler.flush(this),this)},v.prototype.execute=function(t,i){return i>0||this.closed?y.prototype.execute.call(this,t,i):this._execute(t,i)},v.prototype.requestAsyncId=function(t,i,n){return n===void 0&&(n=0),n!=null&&n>0||n==null&&this.delay>0?y.prototype.requestAsyncId.call(this,t,i,n):(t.flush(this),0)},v}(a.AsyncAction);return ci.QueueAction=g,ci}var hi={},fh;function Dv(){if(fh)return hi;fh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(hi,"__esModule",{value:!0}),hi.QueueScheduler=void 0;var a=xs(),g=function(y){T(v,y);function v(){return y!==null&&y.apply(this,arguments)||this}return v}(a.AsyncScheduler);return hi.QueueScheduler=g,hi}var _h;function jv(){return _h||(_h=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.queue=T.queueScheduler=void 0;var a=Bv(),g=Dv();T.queueScheduler=new g.QueueScheduler(a.QueueAction),T.queue=T.queueScheduler}(rl)),rl}var il={},di={},ph;function kv(){if(ph)return di;ph=1;var T=H&&H.__extends||function(){var v=function(t,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(n[c]=r[c])},v(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");v(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(di,"__esModule",{value:!0}),di.AnimationFrameAction=void 0;var a=Ts(),g=Jf(),y=function(v){T(t,v);function t(i,n){var r=v.call(this,i,n)||this;return r.scheduler=i,r.work=n,r}return t.prototype.requestAsyncId=function(i,n,r){return r===void 0&&(r=0),r!==null&&r>0?v.prototype.requestAsyncId.call(this,i,n,r):(i.actions.push(this),i._scheduled||(i._scheduled=g.animationFrameProvider.requestAnimationFrame(function(){return i.flush(void 0)})))},t.prototype.recycleAsyncId=function(i,n,r){var c;if(r===void 0&&(r=0),r!=null?r>0:this.delay>0)return v.prototype.recycleAsyncId.call(this,i,n,r);var f=i.actions;n!=null&&((c=f[f.length-1])===null||c===void 0?void 0:c.id)!==n&&(g.animationFrameProvider.cancelAnimationFrame(n),i._scheduled=void 0)},t}(a.AsyncAction);return di.AnimationFrameAction=y,di}var fi={},vh;function Uv(){if(vh)return fi;vh=1;var T=H&&H.__extends||function(){var y=function(v,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},y(v,t)};return function(v,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y(v,t);function i(){this.constructor=v}v.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(fi,"__esModule",{value:!0}),fi.AnimationFrameScheduler=void 0;var a=xs(),g=function(y){T(v,y);function v(){return y!==null&&y.apply(this,arguments)||this}return v.prototype.flush=function(t){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var n=this.actions,r;t=t||n.shift();do if(r=t.execute(t.state,t.delay))break;while((t=n[0])&&t.id===i&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===i&&n.shift();)t.unsubscribe();throw r}},v}(a.AsyncScheduler);return fi.AnimationFrameScheduler=g,fi}var mh;function Gv(){return mh||(mh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.animationFrame=T.animationFrameScheduler=void 0;var a=kv(),g=Uv();T.animationFrameScheduler=new g.AnimationFrameScheduler(a.AnimationFrameAction),T.animationFrame=T.animationFrameScheduler}(il)),il}var sr={},gh;function qv(){if(gh)return sr;gh=1;var T=H&&H.__extends||function(){var i=function(n,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(c[d]=f[d])},i(n,r)};return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");i(n,r);function c(){this.constructor=n}n.prototype=r===null?Object.create(r):(c.prototype=r.prototype,new c)}}();Object.defineProperty(sr,"__esModule",{value:!0}),sr.VirtualAction=sr.VirtualTimeScheduler=void 0;var a=Ts(),g=Ot(),y=xs(),v=function(i){T(n,i);function n(r,c){r===void 0&&(r=t),c===void 0&&(c=1/0);var f=i.call(this,r,function(){return f.frame})||this;return f.maxFrames=c,f.frame=0,f.index=-1,f}return n.prototype.flush=function(){for(var r=this,c=r.actions,f=r.maxFrames,d,h;(h=c[0])&&h.delay<=f&&(c.shift(),this.frame=h.delay,!(d=h.execute(h.state,h.delay))););if(d){for(;h=c.shift();)h.unsubscribe();throw d}},n.frameTimeFactor=10,n}(y.AsyncScheduler);sr.VirtualTimeScheduler=v;var t=function(i){T(n,i);function n(r,c,f){f===void 0&&(f=r.index+=1);var d=i.call(this,r,c)||this;return d.scheduler=r,d.work=c,d.index=f,d.active=!0,d.index=r.index=f,d}return n.prototype.schedule=function(r,c){if(c===void 0&&(c=0),Number.isFinite(c)){if(!this.id)return i.prototype.schedule.call(this,r,c);this.active=!1;var f=new n(this.scheduler,this.work);return this.add(f),f.schedule(r,c)}else return g.Subscription.EMPTY},n.prototype.requestAsyncId=function(r,c,f){f===void 0&&(f=0),this.delay=r.frame+f;var d=r.actions;return d.push(this),d.sort(n.sortActions),1},n.prototype.recycleAsyncId=function(r,c,f){},n.prototype._execute=function(r,c){if(this.active===!0)return i.prototype._execute.call(this,r,c)},n.sortActions=function(r,c){return r.delay===c.delay?r.index===c.index?0:r.index>c.index?1:-1:r.delay>c.delay?1:-1},n}(a.AsyncAction);return sr.VirtualAction=t,sr}var nl={},al={},bh;function kt(){return bh||(bh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.empty=T.EMPTY=void 0;var a=ze();T.EMPTY=new a.Observable(function(v){return v.complete()});function g(v){return v?y(v):T.EMPTY}T.empty=g;function y(v){return new a.Observable(function(t){return v.schedule(function(){return t.complete()})})}}(al)),al}var _i={},$t={},pi={},yh;function so(){if(yh)return pi;yh=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isScheduler=void 0;var T=Ce();function a(g){return g&&T.isFunction(g.schedule)}return pi.isScheduler=a,pi}var Eh;function xt(){if(Eh)return $t;Eh=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.popNumber=$t.popScheduler=$t.popResultSelector=void 0;var T=Ce(),a=so();function g(i){return i[i.length-1]}function y(i){return T.isFunction(g(i))?i.pop():void 0}$t.popResultSelector=y;function v(i){return a.isScheduler(g(i))?i.pop():void 0}$t.popScheduler=v;function t(i,n){return typeof g(i)=="number"?i.pop():n}return $t.popNumber=t,$t}var vi={},mi={},gi={},st={},bi={},Th;function El(){return Th||(Th=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.isArrayLike=void 0,bi.isArrayLike=function(T){return T&&typeof T.length=="number"&&typeof T!="function"}),bi}var yi={},xh;function i_(){if(xh)return yi;xh=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.isPromise=void 0;var T=Ce();function a(g){return T.isFunction(g==null?void 0:g.then)}return yi.isPromise=a,yi}var Ei={},Ah;function n_(){if(Ah)return Ei;Ah=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.isInteropObservable=void 0;var T=io(),a=Ce();function g(y){return a.isFunction(y[T.observable])}return Ei.isInteropObservable=g,Ei}var Ti={},Sh;function a_(){if(Sh)return Ti;Sh=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.isAsyncIterable=void 0;var T=Ce();function a(g){return Symbol.asyncIterator&&T.isFunction(g==null?void 0:g[Symbol.asyncIterator])}return Ti.isAsyncIterable=a,Ti}var xi={},Oh;function s_(){if(Oh)return xi;Oh=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.createInvalidObservableTypeError=void 0;function T(a){return new TypeError("You provided "+(a!==null&&typeof a=="object"?"an invalid object":"'"+a+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}return xi.createInvalidObservableTypeError=T,xi}var Ai={},or={},Rh;function o_(){if(Rh)return or;Rh=1,Object.defineProperty(or,"__esModule",{value:!0}),or.iterator=or.getSymbolIterator=void 0;function T(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}return or.getSymbolIterator=T,or.iterator=T(),or}var wh;function u_(){if(wh)return Ai;wh=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.isIterable=void 0;var T=o_(),a=Ce();function g(y){return a.isFunction(y==null?void 0:y[T.iterator])}return Ai.isIterable=g,Ai}var ur={},Ph;function Tl(){if(Ph)return ur;Ph=1;var T=H&&H.__generator||function(i,n){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,f,d,h;return h={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function s(o){return function(m){return u([o,m])}}function u(o){if(c)throw new TypeError("Generator is already executing.");for(;r;)try{if(c=1,f&&(d=o[0]&2?f.return:o[0]?f.throw||((d=f.return)&&d.call(f),0):f.next)&&!(d=d.call(f,o[1])).done)return d;switch(f=0,d&&(o=[o[0]&2,d.value]),o[0]){case 0:case 1:d=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,f=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!d||o[1]>d[0]&&o[1]<d[3])){r.label=o[1];break}if(o[0]===6&&r.label<d[1]){r.label=d[1],d=o;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(o);break}d[2]&&r.ops.pop(),r.trys.pop();continue}o=n.call(i,r)}catch(m){o=[6,m],f=0}finally{c=d=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},a=H&&H.__await||function(i){return this instanceof a?(this.v=i,this):new a(i)},g=H&&H.__asyncGenerator||function(i,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=r.apply(i,n||[]),f,d=[];return f={},h("next"),h("throw"),h("return"),f[Symbol.asyncIterator]=function(){return this},f;function h(p){c[p]&&(f[p]=function(b){return new Promise(function(x,E){d.push([p,b,x,E])>1||s(p,b)})})}function s(p,b){try{u(c[p](b))}catch(x){_(d[0][3],x)}}function u(p){p.value instanceof a?Promise.resolve(p.value.v).then(o,m):_(d[0][2],p)}function o(p){s("next",p)}function m(p){s("throw",p)}function _(p,b){p(b),d.shift(),d.length&&s(d[0][0],d[0][1])}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.isReadableStreamLike=ur.readableStreamLikeToAsyncGenerator=void 0;var y=Ce();function v(i){return g(this,arguments,function(){var r,c,f,d;return T(this,function(h){switch(h.label){case 0:r=i.getReader(),h.label=1;case 1:h.trys.push([1,,9,10]),h.label=2;case 2:return[4,a(r.read())];case 3:return c=h.sent(),f=c.value,d=c.done,d?[4,a(void 0)]:[3,5];case 4:return[2,h.sent()];case 5:return[4,a(f)];case 6:return[4,h.sent()];case 7:return h.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}ur.readableStreamLikeToAsyncGenerator=v;function t(i){return y.isFunction(i==null?void 0:i.getReader)}return ur.isReadableStreamLike=t,ur}var Lh;function ye(){if(Lh)return st;Lh=1;var T=H&&H.__awaiter||function(S,R,O,I){function D(j){return j instanceof O?j:new O(function(k){k(j)})}return new(O||(O=Promise))(function(j,k){function G(Y){try{K(I.next(Y))}catch(re){k(re)}}function Z(Y){try{K(I.throw(Y))}catch(re){k(re)}}function K(Y){Y.done?j(Y.value):D(Y.value).then(G,Z)}K((I=I.apply(S,R||[])).next())})},a=H&&H.__generator||function(S,R){var O={label:0,sent:function(){if(j[0]&1)throw j[1];return j[1]},trys:[],ops:[]},I,D,j,k;return k={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function G(K){return function(Y){return Z([K,Y])}}function Z(K){if(I)throw new TypeError("Generator is already executing.");for(;O;)try{if(I=1,D&&(j=K[0]&2?D.return:K[0]?D.throw||((j=D.return)&&j.call(D),0):D.next)&&!(j=j.call(D,K[1])).done)return j;switch(D=0,j&&(K=[K[0]&2,j.value]),K[0]){case 0:case 1:j=K;break;case 4:return O.label++,{value:K[1],done:!1};case 5:O.label++,D=K[1],K=[0];continue;case 7:K=O.ops.pop(),O.trys.pop();continue;default:if(j=O.trys,!(j=j.length>0&&j[j.length-1])&&(K[0]===6||K[0]===2)){O=0;continue}if(K[0]===3&&(!j||K[1]>j[0]&&K[1]<j[3])){O.label=K[1];break}if(K[0]===6&&O.label<j[1]){O.label=j[1],j=K;break}if(j&&O.label<j[2]){O.label=j[2],O.ops.push(K);break}j[2]&&O.ops.pop(),O.trys.pop();continue}K=R.call(S,O)}catch(Y){K=[6,Y],D=0}finally{I=j=0}if(K[0]&5)throw K[1];return{value:K[0]?K[1]:void 0,done:!0}}},g=H&&H.__asyncValues||function(S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=S[Symbol.asyncIterator],O;return R?R.call(S):(S=typeof y=="function"?y(S):S[Symbol.iterator](),O={},I("next"),I("throw"),I("return"),O[Symbol.asyncIterator]=function(){return this},O);function I(j){O[j]=S[j]&&function(k){return new Promise(function(G,Z){k=S[j](k),D(G,Z,k.done,k.value)})}}function D(j,k,G,Z){Promise.resolve(Z).then(function(K){j({value:K,done:G})},k)}},y=H&&H.__values||function(S){var R=typeof Symbol=="function"&&Symbol.iterator,O=R&&S[R],I=0;if(O)return O.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&I>=S.length&&(S=void 0),{value:S&&S[I++],done:!S}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(st,"__esModule",{value:!0}),st.fromReadableStreamLike=st.fromAsyncIterable=st.fromIterable=st.fromPromise=st.fromArrayLike=st.fromInteropObservable=st.innerFrom=void 0;var v=El(),t=i_(),i=ze(),n=n_(),r=a_(),c=s_(),f=u_(),d=Tl(),h=Ce(),s=Kf(),u=io();function o(S){if(S instanceof i.Observable)return S;if(S!=null){if(n.isInteropObservable(S))return m(S);if(v.isArrayLike(S))return _(S);if(t.isPromise(S))return p(S);if(r.isAsyncIterable(S))return x(S);if(f.isIterable(S))return b(S);if(d.isReadableStreamLike(S))return E(S)}throw c.createInvalidObservableTypeError(S)}st.innerFrom=o;function m(S){return new i.Observable(function(R){var O=S[u.observable]();if(h.isFunction(O.subscribe))return O.subscribe(R);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}st.fromInteropObservable=m;function _(S){return new i.Observable(function(R){for(var O=0;O<S.length&&!R.closed;O++)R.next(S[O]);R.complete()})}st.fromArrayLike=_;function p(S){return new i.Observable(function(R){S.then(function(O){R.closed||(R.next(O),R.complete())},function(O){return R.error(O)}).then(null,s.reportUnhandledError)})}st.fromPromise=p;function b(S){return new i.Observable(function(R){var O,I;try{for(var D=y(S),j=D.next();!j.done;j=D.next()){var k=j.value;if(R.next(k),R.closed)return}}catch(G){O={error:G}}finally{try{j&&!j.done&&(I=D.return)&&I.call(D)}finally{if(O)throw O.error}}R.complete()})}st.fromIterable=b;function x(S){return new i.Observable(function(R){w(S,R).catch(function(O){return R.error(O)})})}st.fromAsyncIterable=x;function E(S){return x(d.readableStreamLikeToAsyncGenerator(S))}st.fromReadableStreamLike=E;function w(S,R){var O,I,D,j;return T(this,void 0,void 0,function(){var k,G;return a(this,function(Z){switch(Z.label){case 0:Z.trys.push([0,5,6,11]),O=g(S),Z.label=1;case 1:return[4,O.next()];case 2:if(I=Z.sent(),!!I.done)return[3,4];if(k=I.value,R.next(k),R.closed)return[2];Z.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return G=Z.sent(),D={error:G},[3,11];case 6:return Z.trys.push([6,,9,10]),I&&!I.done&&(j=O.return)?[4,j.call(O)]:[3,8];case 7:Z.sent(),Z.label=8;case 8:return[3,10];case 9:if(D)throw D.error;return[7];case 10:return[7];case 11:return R.complete(),[2]}})})}return st}var Si={},Oi={},Mh;function Kt(){if(Mh)return Oi;Mh=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.executeSchedule=void 0;function T(a,g,y,v,t){v===void 0&&(v=0),t===void 0&&(t=!1);var i=g.schedule(function(){y(),t?a.add(this.schedule(null,v)):this.unsubscribe()},v);if(a.add(i),!t)return i}return Oi.executeSchedule=T,Oi}var Ih;function oo(){if(Ih)return Si;Ih=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.observeOn=void 0;var T=Kt(),a=ie(),g=ue();function y(v,t){return t===void 0&&(t=0),a.operate(function(i,n){i.subscribe(g.createOperatorSubscriber(n,function(r){return T.executeSchedule(n,v,function(){return n.next(r)},t)},function(){return T.executeSchedule(n,v,function(){return n.complete()},t)},function(r){return T.executeSchedule(n,v,function(){return n.error(r)},t)}))})}return Si.observeOn=y,Si}var Ri={},Fh;function uo(){if(Fh)return Ri;Fh=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.subscribeOn=void 0;var T=ie();function a(g,y){return y===void 0&&(y=0),T.operate(function(v,t){t.add(g.schedule(function(){return v.subscribe(t)},y))})}return Ri.subscribeOn=a,Ri}var Ch;function Wv(){if(Ch)return gi;Ch=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.scheduleObservable=void 0;var T=ye(),a=oo(),g=uo();function y(v,t){return T.innerFrom(v).pipe(g.subscribeOn(t),a.observeOn(t))}return gi.scheduleObservable=y,gi}var wi={},Nh;function Vv(){if(Nh)return wi;Nh=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.schedulePromise=void 0;var T=ye(),a=oo(),g=uo();function y(v,t){return T.innerFrom(v).pipe(g.subscribeOn(t),a.observeOn(t))}return wi.schedulePromise=y,wi}var Pi={},zh;function $v(){if(zh)return Pi;zh=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.scheduleArray=void 0;var T=ze();function a(g,y){return new T.Observable(function(v){var t=0;return y.schedule(function(){t===g.length?v.complete():(v.next(g[t++]),v.closed||this.schedule())})})}return Pi.scheduleArray=a,Pi}var Li={},Bh;function l_(){if(Bh)return Li;Bh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.scheduleIterable=void 0;var T=ze(),a=o_(),g=Ce(),y=Kt();function v(t,i){return new T.Observable(function(n){var r;return y.executeSchedule(n,i,function(){r=t[a.iterator](),y.executeSchedule(n,i,function(){var c,f,d;try{c=r.next(),f=c.value,d=c.done}catch(h){n.error(h);return}d?n.complete():n.next(f)},0,!0)}),function(){return g.isFunction(r==null?void 0:r.return)&&r.return()}})}return Li.scheduleIterable=v,Li}var Mi={},Dh;function c_(){if(Dh)return Mi;Dh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.scheduleAsyncIterable=void 0;var T=ze(),a=Kt();function g(y,v){if(!y)throw new Error("Iterable cannot be null");return new T.Observable(function(t){a.executeSchedule(t,v,function(){var i=y[Symbol.asyncIterator]();a.executeSchedule(t,v,function(){i.next().then(function(n){n.done?t.complete():t.next(n.value)})},0,!0)})})}return Mi.scheduleAsyncIterable=g,Mi}var Ii={},jh;function Hv(){if(jh)return Ii;jh=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.scheduleReadableStreamLike=void 0;var T=c_(),a=Tl();function g(y,v){return T.scheduleAsyncIterable(a.readableStreamLikeToAsyncGenerator(y),v)}return Ii.scheduleReadableStreamLike=g,Ii}var kh;function h_(){if(kh)return mi;kh=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.scheduled=void 0;var T=Wv(),a=Vv(),g=$v(),y=l_(),v=c_(),t=n_(),i=i_(),n=El(),r=u_(),c=a_(),f=s_(),d=Tl(),h=Hv();function s(u,o){if(u!=null){if(t.isInteropObservable(u))return T.scheduleObservable(u,o);if(n.isArrayLike(u))return g.scheduleArray(u,o);if(i.isPromise(u))return a.schedulePromise(u,o);if(c.isAsyncIterable(u))return v.scheduleAsyncIterable(u,o);if(r.isIterable(u))return y.scheduleIterable(u,o);if(d.isReadableStreamLike(u))return h.scheduleReadableStreamLike(u,o)}throw f.createInvalidObservableTypeError(u)}return mi.scheduled=s,mi}var Uh;function Qt(){if(Uh)return vi;Uh=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.from=void 0;var T=h_(),a=ye();function g(y,v){return v?T.scheduled(y,v):a.innerFrom(y)}return vi.from=g,vi}var Gh;function xl(){if(Gh)return _i;Gh=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.of=void 0;var T=xt(),a=Qt();function g(){for(var y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];var t=T.popScheduler(y);return a.from(y,t)}return _i.of=g,_i}var Fi={},qh;function d_(){if(qh)return Fi;qh=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.throwError=void 0;var T=ze(),a=Ce();function g(y,v){var t=a.isFunction(y)?y:function(){return y},i=function(n){return n.error(t())};return new T.Observable(v?function(n){return v.schedule(i,0,n)}:i)}return Fi.throwError=g,Fi}var Wh;function Al(){return Wh||(Wh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.observeNotification=T.Notification=T.NotificationKind=void 0;var a=kt(),g=xl(),y=d_(),v=Ce();(function(n){n.NEXT="N",n.ERROR="E",n.COMPLETE="C"})(T.NotificationKind||(T.NotificationKind={}));var t=function(){function n(r,c,f){this.kind=r,this.value=c,this.error=f,this.hasValue=r==="N"}return n.prototype.observe=function(r){return i(this,r)},n.prototype.do=function(r,c,f){var d=this,h=d.kind,s=d.value,u=d.error;return h==="N"?r==null?void 0:r(s):h==="E"?c==null?void 0:c(u):f==null?void 0:f()},n.prototype.accept=function(r,c,f){var d;return v.isFunction((d=r)===null||d===void 0?void 0:d.next)?this.observe(r):this.do(r,c,f)},n.prototype.toObservable=function(){var r=this,c=r.kind,f=r.value,d=r.error,h=c==="N"?g.of(f):c==="E"?y.throwError(function(){return d}):c==="C"?a.EMPTY:0;if(!h)throw new TypeError("Unexpected notification kind "+c);return h},n.createNext=function(r){return new n("N",r)},n.createError=function(r){return new n("E",void 0,r)},n.createComplete=function(){return n.completeNotification},n.completeNotification=new n("C"),n}();T.Notification=t;function i(n,r){var c,f,d,h=n,s=h.kind,u=h.value,o=h.error;if(typeof s!="string")throw new TypeError('Invalid notification, missing "kind"');s==="N"?(c=r.next)===null||c===void 0||c.call(r,u):s==="E"?(f=r.error)===null||f===void 0||f.call(r,o):(d=r.complete)===null||d===void 0||d.call(r)}T.observeNotification=i}(nl)),nl}var Ci={},Vh;function Xv(){if(Vh)return Ci;Vh=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.isObservable=void 0;var T=ze(),a=Ce();function g(y){return!!y&&(y instanceof T.Observable||a.isFunction(y.lift)&&a.isFunction(y.subscribe))}return Ci.isObservable=g,Ci}var Ni={},zi={},$h;function Er(){if($h)return zi;$h=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.EmptyError=void 0;var T=yr();return zi.EmptyError=T.createErrorClass(function(a){return function(){a(this),this.name="EmptyError",this.message="no elements in sequence"}}),zi}var Hh;function Yv(){if(Hh)return Ni;Hh=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.lastValueFrom=void 0;var T=Er();function a(g,y){var v=typeof y=="object";return new Promise(function(t,i){var n=!1,r;g.subscribe({next:function(c){r=c,n=!0},error:i,complete:function(){n?t(r):v?t(y.defaultValue):i(new T.EmptyError)}})})}return Ni.lastValueFrom=a,Ni}var Bi={},Xh;function Zv(){if(Xh)return Bi;Xh=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.firstValueFrom=void 0;var T=Er(),a=Es();function g(y,v){var t=typeof v=="object";return new Promise(function(i,n){var r=new a.SafeSubscriber({next:function(c){i(c),r.unsubscribe()},error:n,complete:function(){t?i(v.defaultValue):n(new T.EmptyError)}});y.subscribe(r)})}return Bi.firstValueFrom=g,Bi}var Di={},Yh;function f_(){if(Yh)return Di;Yh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.ArgumentOutOfRangeError=void 0;var T=yr();return Di.ArgumentOutOfRangeError=T.createErrorClass(function(a){return function(){a(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}),Di}var ji={},Zh;function __(){if(Zh)return ji;Zh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.NotFoundError=void 0;var T=yr();return ji.NotFoundError=T.createErrorClass(function(a){return function(y){a(this),this.name="NotFoundError",this.message=y}}),ji}var ki={},Kh;function p_(){if(Kh)return ki;Kh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.SequenceError=void 0;var T=yr();return ki.SequenceError=T.createErrorClass(function(a){return function(y){a(this),this.name="SequenceError",this.message=y}}),ki}var sl={},Ui={},Qh;function Sl(){if(Qh)return Ui;Qh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.isValidDate=void 0;function T(a){return a instanceof Date&&!isNaN(a)}return Ui.isValidDate=T,Ui}var Jh;function _l(){return Jh||(Jh=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.timeout=T.TimeoutError=void 0;var a=Tt(),g=Sl(),y=ie(),v=ye(),t=yr(),i=ue(),n=Kt();T.TimeoutError=t.createErrorClass(function(f){return function(h){h===void 0&&(h=null),f(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=h}});function r(f,d){var h=g.isValidDate(f)?{first:f}:typeof f=="number"?{each:f}:f,s=h.first,u=h.each,o=h.with,m=o===void 0?c:o,_=h.scheduler,p=_===void 0?d??a.asyncScheduler:_,b=h.meta,x=b===void 0?null:b;if(s==null&&u==null)throw new TypeError("No timeout provided.");return y.operate(function(E,w){var S,R,O=null,I=0,D=function(j){R=n.executeSchedule(w,p,function(){try{S.unsubscribe(),v.innerFrom(m({meta:x,lastValue:O,seen:I})).subscribe(w)}catch(k){w.error(k)}},j)};S=E.subscribe(i.createOperatorSubscriber(w,function(j){R==null||R.unsubscribe(),I++,w.next(O=j),u>0&&D(u)},void 0,void 0,function(){R!=null&&R.closed||R==null||R.unsubscribe(),O=null})),!I&&D(s!=null?typeof s=="number"?s:+s-p.now():u)})}T.timeout=r;function c(f){throw new T.TimeoutError(f)}}(sl)),sl}var Gi={},qi={},Wi={},Vi={},ed;function Tr(){if(ed)return Vi;ed=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.map=void 0;var T=ie(),a=ue();function g(y,v){return T.operate(function(t,i){var n=0;t.subscribe(a.createOperatorSubscriber(i,function(r){i.next(y.call(v,r,n++))}))})}return Vi.map=g,Vi}var td;function xr(){if(td)return Wi;td=1;var T=H&&H.__read||function(i,n){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(n===void 0||n-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},a=H&&H.__spreadArray||function(i,n){for(var r=0,c=n.length,f=i.length;r<c;r++,f++)i[f]=n[r];return i};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.mapOneOrManyArgs=void 0;var g=Tr(),y=Array.isArray;function v(i,n){return y(n)?i.apply(void 0,a([],T(n))):i(n)}function t(i){return g.map(function(n){return v(i,n)})}return Wi.mapOneOrManyArgs=t,Wi}var rd;function v_(){if(rd)return qi;rd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,u=[],o;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)u.push(s.value)}catch(m){o={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(o)throw o.error}}return u},a=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(qi,"__esModule",{value:!0}),qi.bindCallbackInternals=void 0;var g=so(),y=ze(),v=uo(),t=xr(),i=oo(),n=yl();function r(c,f,d,h){if(d)if(g.isScheduler(d))h=d;else return function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return r(c,f,h).apply(this,s).pipe(t.mapOneOrManyArgs(d))};return h?function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return r(c,f).apply(this,s).pipe(v.subscribeOn(h),i.observeOn(h))}:function(){for(var s=this,u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];var m=new n.AsyncSubject,_=!0;return new y.Observable(function(p){var b=m.subscribe(p);if(_){_=!1;var x=!1,E=!1;f.apply(s,a(a([],T(u)),[function(){for(var w=[],S=0;S<arguments.length;S++)w[S]=arguments[S];if(c){var R=w.shift();if(R!=null){m.error(R);return}}m.next(1<w.length?w:w[0]),E=!0,x&&m.complete()}])),E&&m.complete(),x=!0}return b})}}return qi.bindCallbackInternals=r,qi}var id;function Kv(){if(id)return Gi;id=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.bindCallback=void 0;var T=v_();function a(g,y,v){return T.bindCallbackInternals(!1,g,y,v)}return Gi.bindCallback=a,Gi}var $i={},nd;function Qv(){if(nd)return $i;nd=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.bindNodeCallback=void 0;var T=v_();function a(g,y,v){return T.bindCallbackInternals(!0,g,y,v)}return $i.bindNodeCallback=a,$i}var lr={},Hi={},ad;function m_(){if(ad)return Hi;ad=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.argsArgArrayOrObject=void 0;var T=Array.isArray,a=Object.getPrototypeOf,g=Object.prototype,y=Object.keys;function v(i){if(i.length===1){var n=i[0];if(T(n))return{args:n,keys:null};if(t(n)){var r=y(n);return{args:r.map(function(c){return n[c]}),keys:r}}}return{args:i,keys:null}}Hi.argsArgArrayOrObject=v;function t(i){return i&&typeof i=="object"&&a(i)===g}return Hi}var Xi={},sd;function g_(){if(sd)return Xi;sd=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.createObject=void 0;function T(a,g){return a.reduce(function(y,v,t){return y[v]=g[t],y},{})}return Xi.createObject=T,Xi}var od;function Ol(){if(od)return lr;od=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.combineLatestInit=lr.combineLatest=void 0;var T=ze(),a=m_(),g=Qt(),y=lt(),v=xr(),t=xt(),i=g_(),n=ue(),r=Kt();function c(){for(var h=[],s=0;s<arguments.length;s++)h[s]=arguments[s];var u=t.popScheduler(h),o=t.popResultSelector(h),m=a.argsArgArrayOrObject(h),_=m.args,p=m.keys;if(_.length===0)return g.from([],u);var b=new T.Observable(f(_,u,p?function(x){return i.createObject(p,x)}:y.identity));return o?b.pipe(v.mapOneOrManyArgs(o)):b}lr.combineLatest=c;function f(h,s,u){return u===void 0&&(u=y.identity),function(o){d(s,function(){for(var m=h.length,_=new Array(m),p=m,b=m,x=function(w){d(s,function(){var S=g.from(h[w],s),R=!1;S.subscribe(n.createOperatorSubscriber(o,function(O){_[w]=O,R||(R=!0,b--),b||o.next(u(_.slice()))},function(){--p||o.complete()}))},o)},E=0;E<m;E++)x(E)},o)}}lr.combineLatestInit=f;function d(h,s,u){h?r.executeSchedule(u,h,s):s()}return lr}var Yi={},Zi={},Ki={},Qi={},Ji={},ud;function Rl(){if(ud)return Ji;ud=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.mergeInternals=void 0;var T=ye(),a=Kt(),g=ue();function y(v,t,i,n,r,c,f,d){var h=[],s=0,u=0,o=!1,m=function(){o&&!h.length&&!s&&t.complete()},_=function(b){return s<n?p(b):h.push(b)},p=function(b){c&&t.next(b),s++;var x=!1;T.innerFrom(i(b,u++)).subscribe(g.createOperatorSubscriber(t,function(E){r==null||r(E),c?_(E):t.next(E)},function(){x=!0},void 0,function(){if(x)try{s--;for(var E=function(){var w=h.shift();f?a.executeSchedule(t,f,function(){return p(w)}):p(w)};h.length&&s<n;)E();m()}catch(w){t.error(w)}}))};return v.subscribe(g.createOperatorSubscriber(t,_,function(){o=!0,m()})),function(){d==null||d()}}return Ji.mergeInternals=y,Ji}var ld;function Jt(){if(ld)return Qi;ld=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.mergeMap=void 0;var T=Tr(),a=ye(),g=ie(),y=Rl(),v=Ce();function t(i,n,r){return r===void 0&&(r=1/0),v.isFunction(n)?t(function(c,f){return T.map(function(d,h){return n(c,d,f,h)})(a.innerFrom(i(c,f)))},r):(typeof n=="number"&&(r=n),g.operate(function(c,f){return y.mergeInternals(c,f,i,r)}))}return Qi.mergeMap=t,Qi}var cd;function lo(){if(cd)return Ki;cd=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.mergeAll=void 0;var T=Jt(),a=lt();function g(y){return y===void 0&&(y=1/0),T.mergeMap(a.identity,y)}return Ki.mergeAll=g,Ki}var hd;function wl(){if(hd)return Zi;hd=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.concatAll=void 0;var T=lo();function a(){return T.mergeAll(1)}return Zi.concatAll=a,Zi}var dd;function co(){if(dd)return Yi;dd=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.concat=void 0;var T=wl(),a=xt(),g=Qt();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];return T.concatAll()(g.from(v,a.popScheduler(v)))}return Yi.concat=y,Yi}var en={},tn={},fd;function ho(){if(fd)return tn;fd=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.defer=void 0;var T=ze(),a=ye();function g(y){return new T.Observable(function(v){a.innerFrom(y()).subscribe(v)})}return tn.defer=g,tn}var _d;function Jv(){if(_d)return en;_d=1,Object.defineProperty(en,"__esModule",{value:!0}),en.connectable=void 0;var T=ct(),a=ze(),g=ho(),y={connector:function(){return new T.Subject},resetOnDisconnect:!0};function v(t,i){i===void 0&&(i=y);var n=null,r=i.connector,c=i.resetOnDisconnect,f=c===void 0?!0:c,d=r(),h=new a.Observable(function(s){return d.subscribe(s)});return h.connect=function(){return(!n||n.closed)&&(n=g.defer(function(){return t}).subscribe(d),f&&n.add(function(){return d=r()})),n},h}return en.connectable=v,en}var rn={},pd;function em(){if(pd)return rn;pd=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.forkJoin=void 0;var T=ze(),a=m_(),g=ye(),y=xt(),v=ue(),t=xr(),i=g_();function n(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];var f=y.popResultSelector(r),d=a.argsArgArrayOrObject(r),h=d.args,s=d.keys,u=new T.Observable(function(o){var m=h.length;if(!m){o.complete();return}for(var _=new Array(m),p=m,b=m,x=function(w){var S=!1;g.innerFrom(h[w]).subscribe(v.createOperatorSubscriber(o,function(R){S||(S=!0,b--),_[w]=R},function(){return p--},void 0,function(){(!p||!S)&&(b||o.next(s?i.createObject(s,_):_),o.complete())}))},E=0;E<m;E++)x(E)});return f?u.pipe(t.mapOneOrManyArgs(f)):u}return rn.forkJoin=n,rn}var nn={},vd;function tm(){if(vd)return nn;vd=1;var T=H&&H.__read||function(o,m){var _=typeof Symbol=="function"&&o[Symbol.iterator];if(!_)return o;var p=_.call(o),b,x=[],E;try{for(;(m===void 0||m-- >0)&&!(b=p.next()).done;)x.push(b.value)}catch(w){E={error:w}}finally{try{b&&!b.done&&(_=p.return)&&_.call(p)}finally{if(E)throw E.error}}return x};Object.defineProperty(nn,"__esModule",{value:!0}),nn.fromEvent=void 0;var a=ye(),g=ze(),y=Jt(),v=El(),t=Ce(),i=xr(),n=["addListener","removeListener"],r=["addEventListener","removeEventListener"],c=["on","off"];function f(o,m,_,p){if(t.isFunction(_)&&(p=_,_=void 0),p)return f(o,m,_).pipe(i.mapOneOrManyArgs(p));var b=T(u(o)?r.map(function(w){return function(S){return o[w](m,S,_)}}):h(o)?n.map(d(o,m)):s(o)?c.map(d(o,m)):[],2),x=b[0],E=b[1];if(!x&&v.isArrayLike(o))return y.mergeMap(function(w){return f(w,m,_)})(a.innerFrom(o));if(!x)throw new TypeError("Invalid event target");return new g.Observable(function(w){var S=function(){for(var R=[],O=0;O<arguments.length;O++)R[O]=arguments[O];return w.next(1<R.length?R:R[0])};return x(S),function(){return E(S)}})}nn.fromEvent=f;function d(o,m){return function(_){return function(p){return o[_](m,p)}}}function h(o){return t.isFunction(o.addListener)&&t.isFunction(o.removeListener)}function s(o){return t.isFunction(o.on)&&t.isFunction(o.off)}function u(o){return t.isFunction(o.addEventListener)&&t.isFunction(o.removeEventListener)}return nn}var an={},md;function rm(){if(md)return an;md=1,Object.defineProperty(an,"__esModule",{value:!0}),an.fromEventPattern=void 0;var T=ze(),a=Ce(),g=xr();function y(v,t,i){return i?y(v,t).pipe(g.mapOneOrManyArgs(i)):new T.Observable(function(n){var r=function(){for(var f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];return n.next(f.length===1?f[0]:f)},c=v(r);return a.isFunction(t)?function(){return t(r,c)}:void 0})}return an.fromEventPattern=y,an}var sn={},gd;function im(){if(gd)return sn;gd=1;var T=H&&H.__generator||function(i,n){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,f,d,h;return h={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function s(o){return function(m){return u([o,m])}}function u(o){if(c)throw new TypeError("Generator is already executing.");for(;r;)try{if(c=1,f&&(d=o[0]&2?f.return:o[0]?f.throw||((d=f.return)&&d.call(f),0):f.next)&&!(d=d.call(f,o[1])).done)return d;switch(f=0,d&&(o=[o[0]&2,d.value]),o[0]){case 0:case 1:d=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,f=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!d||o[1]>d[0]&&o[1]<d[3])){r.label=o[1];break}if(o[0]===6&&r.label<d[1]){r.label=d[1],d=o;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(o);break}d[2]&&r.ops.pop(),r.trys.pop();continue}o=n.call(i,r)}catch(m){o=[6,m],f=0}finally{c=d=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(sn,"__esModule",{value:!0}),sn.generate=void 0;var a=lt(),g=so(),y=ho(),v=l_();function t(i,n,r,c,f){var d,h,s,u;arguments.length===1?(d=i,u=d.initialState,n=d.condition,r=d.iterate,h=d.resultSelector,s=h===void 0?a.identity:h,f=d.scheduler):(u=i,!c||g.isScheduler(c)?(s=a.identity,f=c):s=c);function o(){var m;return T(this,function(_){switch(_.label){case 0:m=u,_.label=1;case 1:return!n||n(m)?[4,s(m)]:[3,4];case 2:_.sent(),_.label=3;case 3:return m=r(m),[3,1];case 4:return[2]}})}return y.defer(f?function(){return v.scheduleIterable(o(),f)}:o)}return sn.generate=t,sn}var on={},bd;function nm(){if(bd)return on;bd=1,Object.defineProperty(on,"__esModule",{value:!0}),on.iif=void 0;var T=ho();function a(g,y,v){return T.defer(function(){return g()?y:v})}return on.iif=a,on}var un={},ln={},yd;function Ar(){if(yd)return ln;yd=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.timer=void 0;var T=ze(),a=Tt(),g=so(),y=Sl();function v(t,i,n){t===void 0&&(t=0),n===void 0&&(n=a.async);var r=-1;return i!=null&&(g.isScheduler(i)?n=i:r=i),new T.Observable(function(c){var f=y.isValidDate(t)?+t-n.now():t;f<0&&(f=0);var d=0;return n.schedule(function(){c.closed||(c.next(d++),0<=r?this.schedule(void 0,r):c.complete())},f)})}return ln.timer=v,ln}var Ed;function b_(){if(Ed)return un;Ed=1,Object.defineProperty(un,"__esModule",{value:!0}),un.interval=void 0;var T=Tt(),a=Ar();function g(y,v){return y===void 0&&(y=0),v===void 0&&(v=T.asyncScheduler),y<0&&(y=0),a.timer(y,y,v)}return un.interval=g,un}var cn={},Td;function am(){if(Td)return cn;Td=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.merge=void 0;var T=lo(),a=ye(),g=kt(),y=xt(),v=Qt();function t(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var r=y.popScheduler(i),c=y.popNumber(i,1/0),f=i;return f.length?f.length===1?a.innerFrom(f[0]):T.mergeAll(c)(v.from(f,r)):g.EMPTY}return cn.merge=t,cn}var ol={},xd;function Ad(){return xd||(xd=1,function(T){Object.defineProperty(T,"__esModule",{value:!0}),T.never=T.NEVER=void 0;var a=ze(),g=ut();T.NEVER=new a.Observable(g.noop);function y(){return T.NEVER}T.never=y}(ol)),ol}var hn={},dn={},Sd;function Pr(){if(Sd)return dn;Sd=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.argsOrArgArray=void 0;var T=Array.isArray;function a(g){return g.length===1&&T(g[0])?g[0]:g}return dn.argsOrArgArray=a,dn}var Od;function y_(){if(Od)return hn;Od=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.onErrorResumeNext=void 0;var T=ze(),a=Pr(),g=ue(),y=ut(),v=ye();function t(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var r=a.argsOrArgArray(i);return new T.Observable(function(c){var f=0,d=function(){if(f<r.length){var h=void 0;try{h=v.innerFrom(r[f++])}catch{d();return}var s=new g.OperatorSubscriber(c,void 0,y.noop,y.noop);h.subscribe(s),s.add(d)}else c.complete()};d()})}return hn.onErrorResumeNext=t,hn}var fn={},Rd;function sm(){if(Rd)return fn;Rd=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.pairs=void 0;var T=Qt();function a(g,y){return T.from(Object.entries(g),y)}return fn.pairs=a,fn}var _n={},pn={},wd;function om(){if(wd)return pn;wd=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.not=void 0;function T(a,g){return function(y,v){return!a.call(g,y,v)}}return pn.not=T,pn}var vn={},Pd;function Lr(){if(Pd)return vn;Pd=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.filter=void 0;var T=ie(),a=ue();function g(y,v){return T.operate(function(t,i){var n=0;t.subscribe(a.createOperatorSubscriber(i,function(r){return y.call(v,r,n++)&&i.next(r)}))})}return vn.filter=g,vn}var Ld;function um(){if(Ld)return _n;Ld=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.partition=void 0;var T=om(),a=Lr(),g=ye();function y(v,t,i){return[a.filter(t,i)(g.innerFrom(v)),a.filter(T.not(t,i))(g.innerFrom(v))]}return _n.partition=y,_n}var cr={},Md;function E_(){if(Md)return cr;Md=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.raceInit=cr.race=void 0;var T=ze(),a=ye(),g=Pr(),y=ue();function v(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i=g.argsOrArgArray(i),i.length===1?a.innerFrom(i[0]):new T.Observable(t(i))}cr.race=v;function t(i){return function(n){for(var r=[],c=function(d){r.push(a.innerFrom(i[d]).subscribe(y.createOperatorSubscriber(n,function(h){if(r){for(var s=0;s<r.length;s++)s!==d&&r[s].unsubscribe();r=null}n.next(h)})))},f=0;r&&!n.closed&&f<i.length;f++)c(f)}}return cr.raceInit=t,cr}var mn={},Id;function lm(){if(Id)return mn;Id=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.range=void 0;var T=ze(),a=kt();function g(y,v,t){if(v==null&&(v=y,y=0),v<=0)return a.EMPTY;var i=v+y;return new T.Observable(t?function(n){var r=y;return t.schedule(function(){r<i?(n.next(r++),this.schedule()):n.complete()})}:function(n){for(var r=y;r<i&&!n.closed;)n.next(r++);n.complete()})}return mn.range=g,mn}var gn={},Fd;function cm(){if(Fd)return gn;Fd=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.using=void 0;var T=ze(),a=ye(),g=kt();function y(v,t){return new T.Observable(function(i){var n=v(),r=t(n),c=r?a.innerFrom(r):g.EMPTY;return c.subscribe(i),function(){n&&n.unsubscribe()}})}return gn.using=y,gn}var bn={},Cd;function Pl(){if(Cd)return bn;Cd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,u=[],o;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)u.push(s.value)}catch(m){o={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(o)throw o.error}}return u},a=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(bn,"__esModule",{value:!0}),bn.zip=void 0;var g=ze(),y=ye(),v=Pr(),t=kt(),i=ue(),n=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=n.popResultSelector(c),h=v.argsOrArgArray(c);return h.length?new g.Observable(function(s){var u=h.map(function(){return[]}),o=h.map(function(){return!1});s.add(function(){u=o=null});for(var m=function(p){y.innerFrom(h[p]).subscribe(i.createOperatorSubscriber(s,function(b){if(u[p].push(b),u.every(function(E){return E.length})){var x=u.map(function(E){return E.shift()});s.next(d?d.apply(void 0,a([],T(x))):x),u.some(function(E,w){return!E.length&&o[w]})&&s.complete()}},function(){o[p]=!0,!u[p].length&&s.complete()}))},_=0;!s.closed&&_<h.length;_++)m(_);return function(){u=o=null}}):t.EMPTY}return bn.zip=r,bn}var ul={},Nd;function hm(){return Nd||(Nd=1,Object.defineProperty(ul,"__esModule",{value:!0})),ul}var yn={},zd;function T_(){if(zd)return yn;zd=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.audit=void 0;var T=ie(),a=ye(),g=ue();function y(v){return T.operate(function(t,i){var n=!1,r=null,c=null,f=!1,d=function(){if(c==null||c.unsubscribe(),c=null,n){n=!1;var s=r;r=null,i.next(s)}f&&i.complete()},h=function(){c=null,f&&i.complete()};t.subscribe(g.createOperatorSubscriber(i,function(s){n=!0,r=s,c||a.innerFrom(v(s)).subscribe(c=g.createOperatorSubscriber(i,d,h))},function(){f=!0,(!n||!c||c.closed)&&i.complete()}))})}return yn.audit=y,yn}var En={},Bd;function dm(){if(Bd)return En;Bd=1,Object.defineProperty(En,"__esModule",{value:!0}),En.auditTime=void 0;var T=Tt(),a=T_(),g=Ar();function y(v,t){return t===void 0&&(t=T.asyncScheduler),a.audit(function(){return g.timer(v,t)})}return En.auditTime=y,En}var Tn={},Dd;function fm(){if(Dd)return Tn;Dd=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.buffer=void 0;var T=ie(),a=ut(),g=ue(),y=ye();function v(t){return T.operate(function(i,n){var r=[];return i.subscribe(g.createOperatorSubscriber(n,function(c){return r.push(c)},function(){n.next(r),n.complete()})),y.innerFrom(t).subscribe(g.createOperatorSubscriber(n,function(){var c=r;r=[],n.next(c)},a.noop)),function(){r=null}})}return Tn.buffer=v,Tn}var xn={},jd;function _m(){if(jd)return xn;jd=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(xn,"__esModule",{value:!0}),xn.bufferCount=void 0;var a=ie(),g=ue(),y=Zt();function v(t,i){return i===void 0&&(i=null),i=i??t,a.operate(function(n,r){var c=[],f=0;n.subscribe(g.createOperatorSubscriber(r,function(d){var h,s,u,o,m=null;f++%i===0&&c.push([]);try{for(var _=T(c),p=_.next();!p.done;p=_.next()){var b=p.value;b.push(d),t<=b.length&&(m=m??[],m.push(b))}}catch(w){h={error:w}}finally{try{p&&!p.done&&(s=_.return)&&s.call(_)}finally{if(h)throw h.error}}if(m)try{for(var x=T(m),E=x.next();!E.done;E=x.next()){var b=E.value;y.arrRemove(c,b),r.next(b)}}catch(w){u={error:w}}finally{try{E&&!E.done&&(o=x.return)&&o.call(x)}finally{if(u)throw u.error}}},function(){var d,h;try{for(var s=T(c),u=s.next();!u.done;u=s.next()){var o=u.value;r.next(o)}}catch(m){d={error:m}}finally{try{u&&!u.done&&(h=s.return)&&h.call(s)}finally{if(d)throw d.error}}r.complete()},void 0,function(){c=null}))})}return xn.bufferCount=v,xn}var An={},kd;function pm(){if(kd)return An;kd=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(An,"__esModule",{value:!0}),An.bufferTime=void 0;var a=Ot(),g=ie(),y=ue(),v=Zt(),t=Tt(),i=xt(),n=Kt();function r(c){for(var f,d,h=[],s=1;s<arguments.length;s++)h[s-1]=arguments[s];var u=(f=i.popScheduler(h))!==null&&f!==void 0?f:t.asyncScheduler,o=(d=h[0])!==null&&d!==void 0?d:null,m=h[1]||1/0;return g.operate(function(_,p){var b=[],x=!1,E=function(R){var O=R.buffer,I=R.subs;I.unsubscribe(),v.arrRemove(b,R),p.next(O),x&&w()},w=function(){if(b){var R=new a.Subscription;p.add(R);var O=[],I={buffer:O,subs:R};b.push(I),n.executeSchedule(R,u,function(){return E(I)},c)}};o!==null&&o>=0?n.executeSchedule(p,u,w,o,!0):x=!0,w();var S=y.createOperatorSubscriber(p,function(R){var O,I,D=b.slice();try{for(var j=T(D),k=j.next();!k.done;k=j.next()){var G=k.value,Z=G.buffer;Z.push(R),m<=Z.length&&E(G)}}catch(K){O={error:K}}finally{try{k&&!k.done&&(I=j.return)&&I.call(j)}finally{if(O)throw O.error}}},function(){for(;b!=null&&b.length;)p.next(b.shift().buffer);S==null||S.unsubscribe(),p.complete(),p.unsubscribe()},void 0,function(){return b=null});_.subscribe(S)})}return An.bufferTime=r,An}var Sn={},Ud;function vm(){if(Ud)return Sn;Ud=1;var T=H&&H.__values||function(r){var c=typeof Symbol=="function"&&Symbol.iterator,f=c&&r[c],d=0;if(f)return f.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&d>=r.length&&(r=void 0),{value:r&&r[d++],done:!r}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.bufferToggle=void 0;var a=Ot(),g=ie(),y=ye(),v=ue(),t=ut(),i=Zt();function n(r,c){return g.operate(function(f,d){var h=[];y.innerFrom(r).subscribe(v.createOperatorSubscriber(d,function(s){var u=[];h.push(u);var o=new a.Subscription,m=function(){i.arrRemove(h,u),d.next(u),o.unsubscribe()};o.add(y.innerFrom(c(s)).subscribe(v.createOperatorSubscriber(d,m,t.noop)))},t.noop)),f.subscribe(v.createOperatorSubscriber(d,function(s){var u,o;try{for(var m=T(h),_=m.next();!_.done;_=m.next()){var p=_.value;p.push(s)}}catch(b){u={error:b}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(u)throw u.error}}},function(){for(;h.length>0;)d.next(h.shift());d.complete()}))})}return Sn.bufferToggle=n,Sn}var On={},Gd;function mm(){if(Gd)return On;Gd=1,Object.defineProperty(On,"__esModule",{value:!0}),On.bufferWhen=void 0;var T=ie(),a=ut(),g=ue(),y=ye();function v(t){return T.operate(function(i,n){var r=null,c=null,f=function(){c==null||c.unsubscribe();var d=r;r=[],d&&n.next(d),y.innerFrom(t()).subscribe(c=g.createOperatorSubscriber(n,f,a.noop))};f(),i.subscribe(g.createOperatorSubscriber(n,function(d){return r==null?void 0:r.push(d)},function(){r&&n.next(r),n.complete()},void 0,function(){return r=c=null}))})}return On.bufferWhen=v,On}var Rn={},qd;function gm(){if(qd)return Rn;qd=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.catchError=void 0;var T=ye(),a=ue(),g=ie();function y(v){return g.operate(function(t,i){var n=null,r=!1,c;n=t.subscribe(a.createOperatorSubscriber(i,void 0,void 0,function(f){c=T.innerFrom(v(f,y(v)(t))),n?(n.unsubscribe(),n=null,c.subscribe(i)):r=!0})),r&&(n.unsubscribe(),n=null,c.subscribe(i))})}return Rn.catchError=y,Rn}var wn={},Pn={},Ln={},Mn={},In={},Fn={},Wd;function x_(){if(Wd)return Fn;Wd=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.scanInternals=void 0;var T=ue();function a(g,y,v,t,i){return function(n,r){var c=v,f=y,d=0;n.subscribe(T.createOperatorSubscriber(r,function(h){var s=d++;f=c?g(f,h,s):(c=!0,h),t&&r.next(f)},i&&function(){c&&r.next(f),r.complete()}))}}return Fn.scanInternals=a,Fn}var Vd;function As(){if(Vd)return In;Vd=1,Object.defineProperty(In,"__esModule",{value:!0}),In.reduce=void 0;var T=x_(),a=ie();function g(y,v){return a.operate(T.scanInternals(y,v,arguments.length>=2,!1,!0))}return In.reduce=g,In}var $d;function A_(){if($d)return Mn;$d=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.toArray=void 0;var T=As(),a=ie(),g=function(v,t){return v.push(t),v};function y(){return a.operate(function(v,t){T.reduce(g,[])(v).subscribe(t)})}return Mn.toArray=y,Mn}var Hd;function S_(){if(Hd)return Ln;Hd=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.joinAllInternals=void 0;var T=lt(),a=xr(),g=no(),y=Jt(),v=A_();function t(i,n){return g.pipe(v.toArray(),y.mergeMap(function(r){return i(r)}),n?a.mapOneOrManyArgs(n):T.identity)}return Ln.joinAllInternals=t,Ln}var Xd;function O_(){if(Xd)return Pn;Xd=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.combineLatestAll=void 0;var T=Ol(),a=S_();function g(y){return a.joinAllInternals(T.combineLatest,y)}return Pn.combineLatestAll=g,Pn}var Yd;function bm(){if(Yd)return wn;Yd=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.combineAll=void 0;var T=O_();return wn.combineAll=T.combineLatestAll,wn}var Cn={},Nn={},Zd;function ym(){if(Zd)return Nn;Zd=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,u=[],o;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)u.push(s.value)}catch(m){o={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(o)throw o.error}}return u},a=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.combineLatest=void 0;var g=Ol(),y=ie(),v=Pr(),t=xr(),i=no(),n=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=n.popResultSelector(c);return d?i.pipe(r.apply(void 0,a([],T(c))),t.mapOneOrManyArgs(d)):y.operate(function(h,s){g.combineLatestInit(a([h],T(v.argsOrArgArray(c))))(s)})}return Nn.combineLatest=r,Nn}var Kd;function Em(){if(Kd)return Cn;Kd=1;var T=H&&H.__read||function(v,t){var i=typeof Symbol=="function"&&v[Symbol.iterator];if(!i)return v;var n=i.call(v),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(f)throw f.error}}return c},a=H&&H.__spreadArray||function(v,t){for(var i=0,n=t.length,r=v.length;i<n;i++,r++)v[r]=t[i];return v};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.combineLatestWith=void 0;var g=ym();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];return g.combineLatest.apply(void 0,a([],T(v)))}return Cn.combineLatestWith=y,Cn}var zn={},Qd;function R_(){if(Qd)return zn;Qd=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.concatMap=void 0;var T=Jt(),a=Ce();function g(y,v){return a.isFunction(v)?T.mergeMap(y,v,1):T.mergeMap(y,1)}return zn.concatMap=g,zn}var Bn={},Jd;function Tm(){if(Jd)return Bn;Jd=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.concatMapTo=void 0;var T=R_(),a=Ce();function g(y,v){return a.isFunction(v)?T.concatMap(function(){return y},v):T.concatMap(function(){return y})}return Bn.concatMapTo=g,Bn}var Dn={},jn={},e0;function xm(){if(e0)return jn;e0=1;var T=H&&H.__read||function(n,r){var c=typeof Symbol=="function"&&n[Symbol.iterator];if(!c)return n;var f=c.call(n),d,h=[],s;try{for(;(r===void 0||r-- >0)&&!(d=f.next()).done;)h.push(d.value)}catch(u){s={error:u}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(s)throw s.error}}return h},a=H&&H.__spreadArray||function(n,r){for(var c=0,f=r.length,d=n.length;c<f;c++,d++)n[d]=r[c];return n};Object.defineProperty(jn,"__esModule",{value:!0}),jn.concat=void 0;var g=ie(),y=wl(),v=xt(),t=Qt();function i(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var c=v.popScheduler(n);return g.operate(function(f,d){y.concatAll()(t.from(a([f],T(n)),c)).subscribe(d)})}return jn.concat=i,jn}var t0;function Am(){if(t0)return Dn;t0=1;var T=H&&H.__read||function(v,t){var i=typeof Symbol=="function"&&v[Symbol.iterator];if(!i)return v;var n=i.call(v),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(f)throw f.error}}return c},a=H&&H.__spreadArray||function(v,t){for(var i=0,n=t.length,r=v.length;i<n;i++,r++)v[r]=t[i];return v};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.concatWith=void 0;var g=xm();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];return g.concat.apply(void 0,a([],T(v)))}return Dn.concatWith=y,Dn}var kn={},Un={},r0;function Sm(){if(r0)return Un;r0=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.fromSubscribable=void 0;var T=ze();function a(g){return new T.Observable(function(y){return g.subscribe(y)})}return Un.fromSubscribable=a,Un}var i0;function Ll(){if(i0)return kn;i0=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.connect=void 0;var T=ct(),a=ye(),g=ie(),y=Sm(),v={connector:function(){return new T.Subject}};function t(i,n){n===void 0&&(n=v);var r=n.connector;return g.operate(function(c,f){var d=r();a.innerFrom(i(y.fromSubscribable(d))).subscribe(f),f.add(c.subscribe(d))})}return kn.connect=t,kn}var Gn={},n0;function Om(){if(n0)return Gn;n0=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.count=void 0;var T=As();function a(g){return T.reduce(function(y,v,t){return!g||g(v,t)?y+1:y},0)}return Gn.count=a,Gn}var qn={},a0;function Rm(){if(a0)return qn;a0=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.debounce=void 0;var T=ie(),a=ut(),g=ue(),y=ye();function v(t){return T.operate(function(i,n){var r=!1,c=null,f=null,d=function(){if(f==null||f.unsubscribe(),f=null,r){r=!1;var h=c;c=null,n.next(h)}};i.subscribe(g.createOperatorSubscriber(n,function(h){f==null||f.unsubscribe(),r=!0,c=h,f=g.createOperatorSubscriber(n,d,a.noop),y.innerFrom(t(h)).subscribe(f)},function(){d(),n.complete()},void 0,function(){c=f=null}))})}return qn.debounce=v,qn}var Wn={},s0;function wm(){if(s0)return Wn;s0=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.debounceTime=void 0;var T=Tt(),a=ie(),g=ue();function y(v,t){return t===void 0&&(t=T.asyncScheduler),a.operate(function(i,n){var r=null,c=null,f=null,d=function(){if(r){r.unsubscribe(),r=null;var s=c;c=null,n.next(s)}};function h(){var s=f+v,u=t.now();if(u<s){r=this.schedule(void 0,s-u),n.add(r);return}d()}i.subscribe(g.createOperatorSubscriber(n,function(s){c=s,f=t.now(),r||(r=t.schedule(h,v),n.add(r))},function(){d(),n.complete()},void 0,function(){c=r=null}))})}return Wn.debounceTime=y,Wn}var Vn={},o0;function fo(){if(o0)return Vn;o0=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.defaultIfEmpty=void 0;var T=ie(),a=ue();function g(y){return T.operate(function(v,t){var i=!1;v.subscribe(a.createOperatorSubscriber(t,function(n){i=!0,t.next(n)},function(){i||t.next(y),t.complete()}))})}return Vn.defaultIfEmpty=g,Vn}var $n={},Hn={},Xn={},u0;function _o(){if(u0)return Xn;u0=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.take=void 0;var T=kt(),a=ie(),g=ue();function y(v){return v<=0?function(){return T.EMPTY}:a.operate(function(t,i){var n=0;t.subscribe(g.createOperatorSubscriber(i,function(r){++n<=v&&(i.next(r),v<=n&&i.complete())}))})}return Xn.take=y,Xn}var Yn={},l0;function w_(){if(l0)return Yn;l0=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.ignoreElements=void 0;var T=ie(),a=ue(),g=ut();function y(){return T.operate(function(v,t){v.subscribe(a.createOperatorSubscriber(t,g.noop))})}return Yn.ignoreElements=y,Yn}var Zn={},c0;function P_(){if(c0)return Zn;c0=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.mapTo=void 0;var T=Tr();function a(g){return T.map(function(){return g})}return Zn.mapTo=a,Zn}var h0;function L_(){if(h0)return Hn;h0=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.delayWhen=void 0;var T=co(),a=_o(),g=w_(),y=P_(),v=Jt(),t=ye();function i(n,r){return r?function(c){return T.concat(r.pipe(a.take(1),g.ignoreElements()),c.pipe(i(n)))}:v.mergeMap(function(c,f){return t.innerFrom(n(c,f)).pipe(a.take(1),y.mapTo(c))})}return Hn.delayWhen=i,Hn}var d0;function Pm(){if(d0)return $n;d0=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.delay=void 0;var T=Tt(),a=L_(),g=Ar();function y(v,t){t===void 0&&(t=T.asyncScheduler);var i=g.timer(v,t);return a.delayWhen(function(){return i})}return $n.delay=y,$n}var Kn={},f0;function Lm(){if(f0)return Kn;f0=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.dematerialize=void 0;var T=Al(),a=ie(),g=ue();function y(){return a.operate(function(v,t){v.subscribe(g.createOperatorSubscriber(t,function(i){return T.observeNotification(i,t)}))})}return Kn.dematerialize=y,Kn}var Qn={},_0;function Mm(){if(_0)return Qn;_0=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.distinct=void 0;var T=ie(),a=ue(),g=ut(),y=ye();function v(t,i){return T.operate(function(n,r){var c=new Set;n.subscribe(a.createOperatorSubscriber(r,function(f){var d=t?t(f):f;c.has(d)||(c.add(d),r.next(f))})),i&&y.innerFrom(i).subscribe(a.createOperatorSubscriber(r,function(){return c.clear()},g.noop))})}return Qn.distinct=v,Qn}var Jn={},p0;function M_(){if(p0)return Jn;p0=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.distinctUntilChanged=void 0;var T=lt(),a=ie(),g=ue();function y(t,i){return i===void 0&&(i=T.identity),t=t??v,a.operate(function(n,r){var c,f=!0;n.subscribe(g.createOperatorSubscriber(r,function(d){var h=i(d);(f||!t(c,h))&&(f=!1,c=h,r.next(d))}))})}Jn.distinctUntilChanged=y;function v(t,i){return t===i}return Jn}var ea={},v0;function Im(){if(v0)return ea;v0=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.distinctUntilKeyChanged=void 0;var T=M_();function a(g,y){return T.distinctUntilChanged(function(v,t){return y?y(v[g],t[g]):v[g]===t[g]})}return ea.distinctUntilKeyChanged=a,ea}var ta={},ra={},m0;function po(){if(m0)return ra;m0=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.throwIfEmpty=void 0;var T=Er(),a=ie(),g=ue();function y(t){return t===void 0&&(t=v),a.operate(function(i,n){var r=!1;i.subscribe(g.createOperatorSubscriber(n,function(c){r=!0,n.next(c)},function(){return r?n.complete():n.error(t())}))})}ra.throwIfEmpty=y;function v(){return new T.EmptyError}return ra}var g0;function Fm(){if(g0)return ta;g0=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.elementAt=void 0;var T=f_(),a=Lr(),g=po(),y=fo(),v=_o();function t(i,n){if(i<0)throw new T.ArgumentOutOfRangeError;var r=arguments.length>=2;return function(c){return c.pipe(a.filter(function(f,d){return d===i}),v.take(1),r?y.defaultIfEmpty(n):g.throwIfEmpty(function(){return new T.ArgumentOutOfRangeError}))}}return ta.elementAt=t,ta}var ia={},b0;function Cm(){if(b0)return ia;b0=1;var T=H&&H.__read||function(t,i){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(d)throw d.error}}return f},a=H&&H.__spreadArray||function(t,i){for(var n=0,r=i.length,c=t.length;n<r;n++,c++)t[c]=i[n];return t};Object.defineProperty(ia,"__esModule",{value:!0}),ia.endWith=void 0;var g=co(),y=xl();function v(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return function(n){return g.concat(n,y.of.apply(void 0,a([],T(t))))}}return ia.endWith=v,ia}var na={},y0;function Nm(){if(y0)return na;y0=1,Object.defineProperty(na,"__esModule",{value:!0}),na.every=void 0;var T=ie(),a=ue();function g(y,v){return T.operate(function(t,i){var n=0;t.subscribe(a.createOperatorSubscriber(i,function(r){y.call(v,r,n++,t)||(i.next(!1),i.complete())},function(){i.next(!0),i.complete()}))})}return na.every=g,na}var aa={},sa={},oa={},E0;function I_(){if(E0)return oa;E0=1,Object.defineProperty(oa,"__esModule",{value:!0}),oa.exhaustMap=void 0;var T=Tr(),a=ye(),g=ie(),y=ue();function v(t,i){return i?function(n){return n.pipe(v(function(r,c){return a.innerFrom(t(r,c)).pipe(T.map(function(f,d){return i(r,f,c,d)}))}))}:g.operate(function(n,r){var c=0,f=null,d=!1;n.subscribe(y.createOperatorSubscriber(r,function(h){f||(f=y.createOperatorSubscriber(r,void 0,function(){f=null,d&&r.complete()}),a.innerFrom(t(h,c++)).subscribe(f))},function(){d=!0,!f&&r.complete()}))})}return oa.exhaustMap=v,oa}var T0;function F_(){if(T0)return sa;T0=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.exhaustAll=void 0;var T=I_(),a=lt();function g(){return T.exhaustMap(a.identity)}return sa.exhaustAll=g,sa}var x0;function zm(){if(x0)return aa;x0=1,Object.defineProperty(aa,"__esModule",{value:!0}),aa.exhaust=void 0;var T=F_();return aa.exhaust=T.exhaustAll,aa}var ua={},A0;function Bm(){if(A0)return ua;A0=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.expand=void 0;var T=ie(),a=Rl();function g(y,v,t){return v===void 0&&(v=1/0),v=(v||0)<1?1/0:v,T.operate(function(i,n){return a.mergeInternals(i,n,y,v,void 0,!0,t)})}return ua.expand=g,ua}var la={},S0;function Dm(){if(S0)return la;S0=1,Object.defineProperty(la,"__esModule",{value:!0}),la.finalize=void 0;var T=ie();function a(g){return T.operate(function(y,v){try{y.subscribe(v)}finally{v.add(g)}})}return la.finalize=a,la}var hr={},O0;function C_(){if(O0)return hr;O0=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.createFind=hr.find=void 0;var T=ie(),a=ue();function g(v,t){return T.operate(y(v,t,"value"))}hr.find=g;function y(v,t,i){var n=i==="index";return function(r,c){var f=0;r.subscribe(a.createOperatorSubscriber(c,function(d){var h=f++;v.call(t,d,h,r)&&(c.next(n?h:d),c.complete())},function(){c.next(n?-1:void 0),c.complete()}))}}return hr.createFind=y,hr}var ca={},R0;function jm(){if(R0)return ca;R0=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.findIndex=void 0;var T=ie(),a=C_();function g(y,v){return T.operate(a.createFind(y,v,"index"))}return ca.findIndex=g,ca}var ha={},w0;function km(){if(w0)return ha;w0=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.first=void 0;var T=Er(),a=Lr(),g=_o(),y=fo(),v=po(),t=lt();function i(n,r){var c=arguments.length>=2;return function(f){return f.pipe(n?a.filter(function(d,h){return n(d,h,f)}):t.identity,g.take(1),c?y.defaultIfEmpty(r):v.throwIfEmpty(function(){return new T.EmptyError}))}}return ha.first=i,ha}var da={},P0;function Um(){if(P0)return da;P0=1,Object.defineProperty(da,"__esModule",{value:!0}),da.groupBy=void 0;var T=ze(),a=ye(),g=ct(),y=ie(),v=ue();function t(i,n,r,c){return y.operate(function(f,d){var h;!n||typeof n=="function"?h=n:(r=n.duration,h=n.element,c=n.connector);var s=new Map,u=function(x){s.forEach(x),x(d)},o=function(x){return u(function(E){return E.error(x)})},m=0,_=!1,p=new v.OperatorSubscriber(d,function(x){try{var E=i(x),w=s.get(E);if(!w){s.set(E,w=c?c():new g.Subject);var S=b(E,w);if(d.next(S),r){var R=v.createOperatorSubscriber(w,function(){w.complete(),R==null||R.unsubscribe()},void 0,void 0,function(){return s.delete(E)});p.add(a.innerFrom(r(S)).subscribe(R))}}w.next(h?h(x):x)}catch(O){o(O)}},function(){return u(function(x){return x.complete()})},o,function(){return s.clear()},function(){return _=!0,m===0});f.subscribe(p);function b(x,E){var w=new T.Observable(function(S){m++;var R=E.subscribe(S);return function(){R.unsubscribe(),--m===0&&_&&p.unsubscribe()}});return w.key=x,w}})}return da.groupBy=t,da}var fa={},L0;function Gm(){if(L0)return fa;L0=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.isEmpty=void 0;var T=ie(),a=ue();function g(){return T.operate(function(y,v){y.subscribe(a.createOperatorSubscriber(v,function(){v.next(!1),v.complete()},function(){v.next(!0),v.complete()}))})}return fa.isEmpty=g,fa}var _a={},pa={},M0;function N_(){if(M0)return pa;M0=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(pa,"__esModule",{value:!0}),pa.takeLast=void 0;var a=kt(),g=ie(),y=ue();function v(t){return t<=0?function(){return a.EMPTY}:g.operate(function(i,n){var r=[];i.subscribe(y.createOperatorSubscriber(n,function(c){r.push(c),t<r.length&&r.shift()},function(){var c,f;try{for(var d=T(r),h=d.next();!h.done;h=d.next()){var s=h.value;n.next(s)}}catch(u){c={error:u}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(c)throw c.error}}n.complete()},void 0,function(){r=null}))})}return pa.takeLast=v,pa}var I0;function qm(){if(I0)return _a;I0=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.last=void 0;var T=Er(),a=Lr(),g=N_(),y=po(),v=fo(),t=lt();function i(n,r){var c=arguments.length>=2;return function(f){return f.pipe(n?a.filter(function(d,h){return n(d,h,f)}):t.identity,g.takeLast(1),c?v.defaultIfEmpty(r):y.throwIfEmpty(function(){return new T.EmptyError}))}}return _a.last=i,_a}var va={},F0;function Wm(){if(F0)return va;F0=1,Object.defineProperty(va,"__esModule",{value:!0}),va.materialize=void 0;var T=Al(),a=ie(),g=ue();function y(){return a.operate(function(v,t){v.subscribe(g.createOperatorSubscriber(t,function(i){t.next(T.Notification.createNext(i))},function(){t.next(T.Notification.createComplete()),t.complete()},function(i){t.next(T.Notification.createError(i)),t.complete()}))})}return va.materialize=y,va}var ma={},C0;function Vm(){if(C0)return ma;C0=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.max=void 0;var T=As(),a=Ce();function g(y){return T.reduce(a.isFunction(y)?function(v,t){return y(v,t)>0?v:t}:function(v,t){return v>t?v:t})}return ma.max=g,ma}var ga={},N0;function $m(){if(N0)return ga;N0=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.flatMap=void 0;var T=Jt();return ga.flatMap=T.mergeMap,ga}var ba={},z0;function Hm(){if(z0)return ba;z0=1,Object.defineProperty(ba,"__esModule",{value:!0}),ba.mergeMapTo=void 0;var T=Jt(),a=Ce();function g(y,v,t){return t===void 0&&(t=1/0),a.isFunction(v)?T.mergeMap(function(){return y},v,t):(typeof v=="number"&&(t=v),T.mergeMap(function(){return y},t))}return ba.mergeMapTo=g,ba}var ya={},B0;function Xm(){if(B0)return ya;B0=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.mergeScan=void 0;var T=ie(),a=Rl();function g(y,v,t){return t===void 0&&(t=1/0),T.operate(function(i,n){var r=v;return a.mergeInternals(i,n,function(c,f){return y(r,c,f)},t,function(c){r=c},!1,void 0,function(){return r=null})})}return ya.mergeScan=g,ya}var Ea={},Ta={},D0;function Ym(){if(D0)return Ta;D0=1;var T=H&&H.__read||function(r,c){var f=typeof Symbol=="function"&&r[Symbol.iterator];if(!f)return r;var d=f.call(r),h,s=[],u;try{for(;(c===void 0||c-- >0)&&!(h=d.next()).done;)s.push(h.value)}catch(o){u={error:o}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(u)throw u.error}}return s},a=H&&H.__spreadArray||function(r,c){for(var f=0,d=c.length,h=r.length;f<d;f++,h++)r[h]=c[f];return r};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.merge=void 0;var g=ie(),y=Pr(),v=lo(),t=xt(),i=Qt();function n(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];var f=t.popScheduler(r),d=t.popNumber(r,1/0);return r=y.argsOrArgArray(r),g.operate(function(h,s){v.mergeAll(d)(i.from(a([h],T(r)),f)).subscribe(s)})}return Ta.merge=n,Ta}var j0;function Zm(){if(j0)return Ea;j0=1;var T=H&&H.__read||function(v,t){var i=typeof Symbol=="function"&&v[Symbol.iterator];if(!i)return v;var n=i.call(v),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(f)throw f.error}}return c},a=H&&H.__spreadArray||function(v,t){for(var i=0,n=t.length,r=v.length;i<n;i++,r++)v[r]=t[i];return v};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.mergeWith=void 0;var g=Ym();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];return g.merge.apply(void 0,a([],T(v)))}return Ea.mergeWith=y,Ea}var xa={},k0;function Km(){if(k0)return xa;k0=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.min=void 0;var T=As(),a=Ce();function g(y){return T.reduce(a.isFunction(y)?function(v,t){return y(v,t)<0?v:t}:function(v,t){return v<t?v:t})}return xa.min=g,xa}var Aa={},U0;function Ml(){if(U0)return Aa;U0=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.multicast=void 0;var T=ao(),a=Ce(),g=Ll();function y(v,t){var i=a.isFunction(v)?v:function(){return v};return a.isFunction(t)?g.connect(t,{connector:i}):function(n){return new T.ConnectableObservable(n,i)}}return Aa.multicast=y,Aa}var dr={},G0;function Qm(){if(G0)return dr;G0=1;var T=H&&H.__read||function(t,i){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(d)throw d.error}}return f},a=H&&H.__spreadArray||function(t,i){for(var n=0,r=i.length,c=t.length;n<r;n++,c++)t[c]=i[n];return t};Object.defineProperty(dr,"__esModule",{value:!0}),dr.onErrorResumeNext=dr.onErrorResumeNextWith=void 0;var g=Pr(),y=y_();function v(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=g.argsOrArgArray(t);return function(r){return y.onErrorResumeNext.apply(void 0,a([r],T(n)))}}return dr.onErrorResumeNextWith=v,dr.onErrorResumeNext=v,dr}var Sa={},q0;function Jm(){if(q0)return Sa;q0=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.pairwise=void 0;var T=ie(),a=ue();function g(){return T.operate(function(y,v){var t,i=!1;y.subscribe(a.createOperatorSubscriber(v,function(n){var r=t;t=n,i&&v.next([r,n]),i=!0}))})}return Sa.pairwise=g,Sa}var Oa={},W0;function e2(){if(W0)return Oa;W0=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.pluck=void 0;var T=Tr();function a(){for(var g=[],y=0;y<arguments.length;y++)g[y]=arguments[y];var v=g.length;if(v===0)throw new Error("list of properties cannot be empty.");return T.map(function(t){for(var i=t,n=0;n<v;n++){var r=i==null?void 0:i[g[n]];if(typeof r<"u")i=r;else return}return i})}return Oa.pluck=a,Oa}var Ra={},V0;function t2(){if(V0)return Ra;V0=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.publish=void 0;var T=ct(),a=Ml(),g=Ll();function y(v){return v?function(t){return g.connect(v)(t)}:function(t){return a.multicast(new T.Subject)(t)}}return Ra.publish=y,Ra}var wa={},$0;function r2(){if($0)return wa;$0=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.publishBehavior=void 0;var T=t_(),a=ao();function g(y){return function(v){var t=new T.BehaviorSubject(y);return new a.ConnectableObservable(v,function(){return t})}}return wa.publishBehavior=g,wa}var Pa={},H0;function i2(){if(H0)return Pa;H0=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.publishLast=void 0;var T=yl(),a=ao();function g(){return function(y){var v=new T.AsyncSubject;return new a.ConnectableObservable(y,function(){return v})}}return Pa.publishLast=g,Pa}var La={},X0;function n2(){if(X0)return La;X0=1,Object.defineProperty(La,"__esModule",{value:!0}),La.publishReplay=void 0;var T=bl(),a=Ml(),g=Ce();function y(v,t,i,n){i&&!g.isFunction(i)&&(n=i);var r=g.isFunction(i)?i:void 0;return function(c){return a.multicast(new T.ReplaySubject(v,t,n),r)(c)}}return La.publishReplay=y,La}var Ma={},Y0;function a2(){if(Y0)return Ma;Y0=1;var T=H&&H.__read||function(i,n){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var c=r.call(i),f,d=[],h;try{for(;(n===void 0||n-- >0)&&!(f=c.next()).done;)d.push(f.value)}catch(s){h={error:s}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(h)throw h.error}}return d},a=H&&H.__spreadArray||function(i,n){for(var r=0,c=n.length,f=i.length;r<c;r++,f++)i[f]=n[r];return i};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.raceWith=void 0;var g=E_(),y=ie(),v=lt();function t(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.length?y.operate(function(r,c){g.raceInit(a([r],T(i)))(c)}):v.identity}return Ma.raceWith=t,Ma}var Ia={},Z0;function s2(){if(Z0)return Ia;Z0=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.repeat=void 0;var T=kt(),a=ie(),g=ue(),y=ye(),v=Ar();function t(i){var n,r=1/0,c;return i!=null&&(typeof i=="object"?(n=i.count,r=n===void 0?1/0:n,c=i.delay):r=i),r<=0?function(){return T.EMPTY}:a.operate(function(f,d){var h=0,s,u=function(){if(s==null||s.unsubscribe(),s=null,c!=null){var m=typeof c=="number"?v.timer(c):y.innerFrom(c(h)),_=g.createOperatorSubscriber(d,function(){_.unsubscribe(),o()});m.subscribe(_)}else o()},o=function(){var m=!1;s=f.subscribe(g.createOperatorSubscriber(d,void 0,function(){++h<r?s?u():m=!0:d.complete()})),m&&u()};o()})}return Ia.repeat=t,Ia}var Fa={},K0;function o2(){if(K0)return Fa;K0=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.repeatWhen=void 0;var T=ye(),a=ct(),g=ie(),y=ue();function v(t){return g.operate(function(i,n){var r,c=!1,f,d=!1,h=!1,s=function(){return h&&d&&(n.complete(),!0)},u=function(){return f||(f=new a.Subject,T.innerFrom(t(f)).subscribe(y.createOperatorSubscriber(n,function(){r?o():c=!0},function(){d=!0,s()}))),f},o=function(){h=!1,r=i.subscribe(y.createOperatorSubscriber(n,void 0,function(){h=!0,!s()&&u().next()})),c&&(r.unsubscribe(),r=null,c=!1,o())};o()})}return Fa.repeatWhen=v,Fa}var Ca={},Q0;function u2(){if(Q0)return Ca;Q0=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.retry=void 0;var T=ie(),a=ue(),g=lt(),y=Ar(),v=ye();function t(i){i===void 0&&(i=1/0);var n;i&&typeof i=="object"?n=i:n={count:i};var r=n.count,c=r===void 0?1/0:r,f=n.delay,d=n.resetOnSuccess,h=d===void 0?!1:d;return c<=0?g.identity:T.operate(function(s,u){var o=0,m,_=function(){var p=!1;m=s.subscribe(a.createOperatorSubscriber(u,function(b){h&&(o=0),u.next(b)},void 0,function(b){if(o++<c){var x=function(){m?(m.unsubscribe(),m=null,_()):p=!0};if(f!=null){var E=typeof f=="number"?y.timer(f):v.innerFrom(f(b,o)),w=a.createOperatorSubscriber(u,function(){w.unsubscribe(),x()},function(){u.complete()});E.subscribe(w)}else x()}else u.error(b)})),p&&(m.unsubscribe(),m=null,_())};_()})}return Ca.retry=t,Ca}var Na={},J0;function l2(){if(J0)return Na;J0=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.retryWhen=void 0;var T=ye(),a=ct(),g=ie(),y=ue();function v(t){return g.operate(function(i,n){var r,c=!1,f,d=function(){r=i.subscribe(y.createOperatorSubscriber(n,void 0,void 0,function(h){f||(f=new a.Subject,T.innerFrom(t(f)).subscribe(y.createOperatorSubscriber(n,function(){return r?d():c=!0}))),f&&f.next(h)})),c&&(r.unsubscribe(),r=null,c=!1,d())};d()})}return Na.retryWhen=v,Na}var za={},ef;function z_(){if(ef)return za;ef=1,Object.defineProperty(za,"__esModule",{value:!0}),za.sample=void 0;var T=ye(),a=ie(),g=ut(),y=ue();function v(t){return a.operate(function(i,n){var r=!1,c=null;i.subscribe(y.createOperatorSubscriber(n,function(f){r=!0,c=f})),T.innerFrom(t).subscribe(y.createOperatorSubscriber(n,function(){if(r){r=!1;var f=c;c=null,n.next(f)}},g.noop))})}return za.sample=v,za}var Ba={},tf;function c2(){if(tf)return Ba;tf=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.sampleTime=void 0;var T=Tt(),a=z_(),g=b_();function y(v,t){return t===void 0&&(t=T.asyncScheduler),a.sample(g.interval(v,t))}return Ba.sampleTime=y,Ba}var Da={},rf;function h2(){if(rf)return Da;rf=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.scan=void 0;var T=ie(),a=x_();function g(y,v){return T.operate(a.scanInternals(y,v,arguments.length>=2,!0))}return Da.scan=g,Da}var ja={},nf;function d2(){if(nf)return ja;nf=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.sequenceEqual=void 0;var T=ie(),a=ue(),g=ye();function y(t,i){return i===void 0&&(i=function(n,r){return n===r}),T.operate(function(n,r){var c=v(),f=v(),d=function(s){r.next(s),r.complete()},h=function(s,u){var o=a.createOperatorSubscriber(r,function(m){var _=u.buffer,p=u.complete;_.length===0?p?d(!1):s.buffer.push(m):!i(m,_.shift())&&d(!1)},function(){s.complete=!0;var m=u.complete,_=u.buffer;m&&d(_.length===0),o==null||o.unsubscribe()});return o};n.subscribe(h(c,f)),g.innerFrom(t).subscribe(h(f,c))})}ja.sequenceEqual=y;function v(){return{buffer:[],complete:!1}}return ja}var ka={},af;function B_(){if(af)return ka;af=1;var T=H&&H.__read||function(r,c){var f=typeof Symbol=="function"&&r[Symbol.iterator];if(!f)return r;var d=f.call(r),h,s=[],u;try{for(;(c===void 0||c-- >0)&&!(h=d.next()).done;)s.push(h.value)}catch(o){u={error:o}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(u)throw u.error}}return s},a=H&&H.__spreadArray||function(r,c){for(var f=0,d=c.length,h=r.length;f<d;f++,h++)r[h]=c[f];return r};Object.defineProperty(ka,"__esModule",{value:!0}),ka.share=void 0;var g=ye(),y=ct(),v=Es(),t=ie();function i(r){r===void 0&&(r={});var c=r.connector,f=c===void 0?function(){return new y.Subject}:c,d=r.resetOnError,h=d===void 0?!0:d,s=r.resetOnComplete,u=s===void 0?!0:s,o=r.resetOnRefCountZero,m=o===void 0?!0:o;return function(_){var p,b,x,E=0,w=!1,S=!1,R=function(){b==null||b.unsubscribe(),b=void 0},O=function(){R(),p=x=void 0,w=S=!1},I=function(){var D=p;O(),D==null||D.unsubscribe()};return t.operate(function(D,j){E++,!S&&!w&&R();var k=x=x??f();j.add(function(){E--,E===0&&!S&&!w&&(b=n(I,m))}),k.subscribe(j),!p&&E>0&&(p=new v.SafeSubscriber({next:function(G){return k.next(G)},error:function(G){S=!0,R(),b=n(O,h,G),k.error(G)},complete:function(){w=!0,R(),b=n(O,u),k.complete()}}),g.innerFrom(D).subscribe(p))})(_)}}ka.share=i;function n(r,c){for(var f=[],d=2;d<arguments.length;d++)f[d-2]=arguments[d];if(c===!0){r();return}if(c!==!1){var h=new v.SafeSubscriber({next:function(){h.unsubscribe(),r()}});return g.innerFrom(c.apply(void 0,a([],T(f)))).subscribe(h)}}return ka}var Ua={},sf;function f2(){if(sf)return Ua;sf=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.shareReplay=void 0;var T=bl(),a=B_();function g(y,v,t){var i,n,r,c,f=!1;return y&&typeof y=="object"?(i=y.bufferSize,c=i===void 0?1/0:i,n=y.windowTime,v=n===void 0?1/0:n,r=y.refCount,f=r===void 0?!1:r,t=y.scheduler):c=y??1/0,a.share({connector:function(){return new T.ReplaySubject(c,v,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:f})}return Ua.shareReplay=g,Ua}var Ga={},of;function _2(){if(of)return Ga;of=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.single=void 0;var T=Er(),a=p_(),g=__(),y=ie(),v=ue();function t(i){return y.operate(function(n,r){var c=!1,f,d=!1,h=0;n.subscribe(v.createOperatorSubscriber(r,function(s){d=!0,(!i||i(s,h++,n))&&(c&&r.error(new a.SequenceError("Too many matching values")),c=!0,f=s)},function(){c?(r.next(f),r.complete()):r.error(d?new g.NotFoundError("No matching values"):new T.EmptyError)}))})}return Ga.single=t,Ga}var qa={},uf;function p2(){if(uf)return qa;uf=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.skip=void 0;var T=Lr();function a(g){return T.filter(function(y,v){return g<=v})}return qa.skip=a,qa}var Wa={},lf;function v2(){if(lf)return Wa;lf=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.skipLast=void 0;var T=lt(),a=ie(),g=ue();function y(v){return v<=0?T.identity:a.operate(function(t,i){var n=new Array(v),r=0;return t.subscribe(g.createOperatorSubscriber(i,function(c){var f=r++;if(f<v)n[f]=c;else{var d=f%v,h=n[d];n[d]=c,i.next(h)}})),function(){n=null}})}return Wa.skipLast=y,Wa}var Va={},cf;function m2(){if(cf)return Va;cf=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.skipUntil=void 0;var T=ie(),a=ue(),g=ye(),y=ut();function v(t){return T.operate(function(i,n){var r=!1,c=a.createOperatorSubscriber(n,function(){c==null||c.unsubscribe(),r=!0},y.noop);g.innerFrom(t).subscribe(c),i.subscribe(a.createOperatorSubscriber(n,function(f){return r&&n.next(f)}))})}return Va.skipUntil=v,Va}var $a={},hf;function g2(){if(hf)return $a;hf=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.skipWhile=void 0;var T=ie(),a=ue();function g(y){return T.operate(function(v,t){var i=!1,n=0;v.subscribe(a.createOperatorSubscriber(t,function(r){return(i||(i=!y(r,n++)))&&t.next(r)}))})}return $a.skipWhile=g,$a}var Ha={},df;function b2(){if(df)return Ha;df=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.startWith=void 0;var T=co(),a=xt(),g=ie();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];var i=a.popScheduler(v);return g.operate(function(n,r){(i?T.concat(v,n,i):T.concat(v,n)).subscribe(r)})}return Ha.startWith=y,Ha}var Xa={},Ya={},ff;function vo(){if(ff)return Ya;ff=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.switchMap=void 0;var T=ye(),a=ie(),g=ue();function y(v,t){return a.operate(function(i,n){var r=null,c=0,f=!1,d=function(){return f&&!r&&n.complete()};i.subscribe(g.createOperatorSubscriber(n,function(h){r==null||r.unsubscribe();var s=0,u=c++;T.innerFrom(v(h,u)).subscribe(r=g.createOperatorSubscriber(n,function(o){return n.next(t?t(h,o,u,s++):o)},function(){r=null,d()}))},function(){f=!0,d()}))})}return Ya.switchMap=y,Ya}var _f;function y2(){if(_f)return Xa;_f=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.switchAll=void 0;var T=vo(),a=lt();function g(){return T.switchMap(a.identity)}return Xa.switchAll=g,Xa}var Za={},pf;function E2(){if(pf)return Za;pf=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.switchMapTo=void 0;var T=vo(),a=Ce();function g(y,v){return a.isFunction(v)?T.switchMap(function(){return y},v):T.switchMap(function(){return y})}return Za.switchMapTo=g,Za}var Ka={},vf;function T2(){if(vf)return Ka;vf=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.switchScan=void 0;var T=vo(),a=ie();function g(y,v){return a.operate(function(t,i){var n=v;return T.switchMap(function(r,c){return y(n,r,c)},function(r,c){return n=c,c})(t).subscribe(i),function(){n=null}})}return Ka.switchScan=g,Ka}var Qa={},mf;function x2(){if(mf)return Qa;mf=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.takeUntil=void 0;var T=ie(),a=ue(),g=ye(),y=ut();function v(t){return T.operate(function(i,n){g.innerFrom(t).subscribe(a.createOperatorSubscriber(n,function(){return n.complete()},y.noop)),!n.closed&&i.subscribe(n)})}return Qa.takeUntil=v,Qa}var Ja={},gf;function A2(){if(gf)return Ja;gf=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.takeWhile=void 0;var T=ie(),a=ue();function g(y,v){return v===void 0&&(v=!1),T.operate(function(t,i){var n=0;t.subscribe(a.createOperatorSubscriber(i,function(r){var c=y(r,n++);(c||v)&&i.next(r),!c&&i.complete()}))})}return Ja.takeWhile=g,Ja}var es={},bf;function S2(){if(bf)return es;bf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.tap=void 0;var T=Ce(),a=ie(),g=ue(),y=lt();function v(t,i,n){var r=T.isFunction(t)||i||n?{next:t,error:i,complete:n}:t;return r?a.operate(function(c,f){var d;(d=r.subscribe)===null||d===void 0||d.call(r);var h=!0;c.subscribe(g.createOperatorSubscriber(f,function(s){var u;(u=r.next)===null||u===void 0||u.call(r,s),f.next(s)},function(){var s;h=!1,(s=r.complete)===null||s===void 0||s.call(r),f.complete()},function(s){var u;h=!1,(u=r.error)===null||u===void 0||u.call(r,s),f.error(s)},function(){var s,u;h&&((s=r.unsubscribe)===null||s===void 0||s.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):y.identity}return es.tap=v,es}var ts={},yf;function D_(){if(yf)return ts;yf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.throttle=void 0;var T=ie(),a=ue(),g=ye();function y(v,t){return T.operate(function(i,n){var r=t??{},c=r.leading,f=c===void 0?!0:c,d=r.trailing,h=d===void 0?!1:d,s=!1,u=null,o=null,m=!1,_=function(){o==null||o.unsubscribe(),o=null,h&&(x(),m&&n.complete())},p=function(){o=null,m&&n.complete()},b=function(E){return o=g.innerFrom(v(E)).subscribe(a.createOperatorSubscriber(n,_,p))},x=function(){if(s){s=!1;var E=u;u=null,n.next(E),!m&&b(E)}};i.subscribe(a.createOperatorSubscriber(n,function(E){s=!0,u=E,!(o&&!o.closed)&&(f?x():b(E))},function(){m=!0,!(h&&s&&o&&!o.closed)&&n.complete()}))})}return ts.throttle=y,ts}var rs={},Ef;function O2(){if(Ef)return rs;Ef=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.throttleTime=void 0;var T=Tt(),a=D_(),g=Ar();function y(v,t,i){t===void 0&&(t=T.asyncScheduler);var n=g.timer(v,t);return a.throttle(function(){return n},i)}return rs.throttleTime=y,rs}var fr={},Tf;function R2(){if(Tf)return fr;Tf=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.TimeInterval=fr.timeInterval=void 0;var T=Tt(),a=ie(),g=ue();function y(t){return t===void 0&&(t=T.asyncScheduler),a.operate(function(i,n){var r=t.now();i.subscribe(g.createOperatorSubscriber(n,function(c){var f=t.now(),d=f-r;r=f,n.next(new v(c,d))}))})}fr.timeInterval=y;var v=function(){function t(i,n){this.value=i,this.interval=n}return t}();return fr.TimeInterval=v,fr}var is={},xf;function w2(){if(xf)return is;xf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.timeoutWith=void 0;var T=Tt(),a=Sl(),g=_l();function y(v,t,i){var n,r,c;if(i=i??T.async,a.isValidDate(v)?n=v:typeof v=="number"&&(r=v),t)c=function(){return t};else throw new TypeError("No observable provided to switch to");if(n==null&&r==null)throw new TypeError("No timeout provided.");return g.timeout({first:n,each:r,scheduler:i,with:c})}return is.timeoutWith=y,is}var ns={},Af;function P2(){if(Af)return ns;Af=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.timestamp=void 0;var T=gl(),a=Tr();function g(y){return y===void 0&&(y=T.dateTimestampProvider),a.map(function(v){return{value:v,timestamp:y.now()}})}return ns.timestamp=g,ns}var as={},Sf;function L2(){if(Sf)return as;Sf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.window=void 0;var T=ct(),a=ie(),g=ue(),y=ut(),v=ye();function t(i){return a.operate(function(n,r){var c=new T.Subject;r.next(c.asObservable());var f=function(d){c.error(d),r.error(d)};return n.subscribe(g.createOperatorSubscriber(r,function(d){return c==null?void 0:c.next(d)},function(){c.complete(),r.complete()},f)),v.innerFrom(i).subscribe(g.createOperatorSubscriber(r,function(){c.complete(),r.next(c=new T.Subject)},y.noop,f)),function(){c==null||c.unsubscribe(),c=null}})}return as.window=t,as}var ss={},Of;function M2(){if(Of)return ss;Of=1;var T=H&&H.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ss,"__esModule",{value:!0}),ss.windowCount=void 0;var a=ct(),g=ie(),y=ue();function v(t,i){i===void 0&&(i=0);var n=i>0?i:t;return g.operate(function(r,c){var f=[new a.Subject],d=0;c.next(f[0].asObservable()),r.subscribe(y.createOperatorSubscriber(c,function(h){var s,u;try{for(var o=T(f),m=o.next();!m.done;m=o.next()){var _=m.value;_.next(h)}}catch(x){s={error:x}}finally{try{m&&!m.done&&(u=o.return)&&u.call(o)}finally{if(s)throw s.error}}var p=d-t+1;if(p>=0&&p%n===0&&f.shift().complete(),++d%n===0){var b=new a.Subject;f.push(b),c.next(b.asObservable())}},function(){for(;f.length>0;)f.shift().complete();c.complete()},function(h){for(;f.length>0;)f.shift().error(h);c.error(h)},function(){f=null}))})}return ss.windowCount=v,ss}var os={},Rf;function I2(){if(Rf)return os;Rf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.windowTime=void 0;var T=ct(),a=Tt(),g=Ot(),y=ie(),v=ue(),t=Zt(),i=xt(),n=Kt();function r(c){for(var f,d,h=[],s=1;s<arguments.length;s++)h[s-1]=arguments[s];var u=(f=i.popScheduler(h))!==null&&f!==void 0?f:a.asyncScheduler,o=(d=h[0])!==null&&d!==void 0?d:null,m=h[1]||1/0;return y.operate(function(_,p){var b=[],x=!1,E=function(O){var I=O.window,D=O.subs;I.complete(),D.unsubscribe(),t.arrRemove(b,O),x&&w()},w=function(){if(b){var O=new g.Subscription;p.add(O);var I=new T.Subject,D={window:I,subs:O,seen:0};b.push(D),p.next(I.asObservable()),n.executeSchedule(O,u,function(){return E(D)},c)}};o!==null&&o>=0?n.executeSchedule(p,u,w,o,!0):x=!0,w();var S=function(O){return b.slice().forEach(O)},R=function(O){S(function(I){var D=I.window;return O(D)}),O(p),p.unsubscribe()};return _.subscribe(v.createOperatorSubscriber(p,function(O){S(function(I){I.window.next(O),m<=++I.seen&&E(I)})},function(){return R(function(O){return O.complete()})},function(O){return R(function(I){return I.error(O)})})),function(){b=null}})}return os.windowTime=r,os}var us={},wf;function F2(){if(wf)return us;wf=1;var T=H&&H.__values||function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],h=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&h>=c.length&&(c=void 0),{value:c&&c[h++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(us,"__esModule",{value:!0}),us.windowToggle=void 0;var a=ct(),g=Ot(),y=ie(),v=ye(),t=ue(),i=ut(),n=Zt();function r(c,f){return y.operate(function(d,h){var s=[],u=function(o){for(;0<s.length;)s.shift().error(o);h.error(o)};v.innerFrom(c).subscribe(t.createOperatorSubscriber(h,function(o){var m=new a.Subject;s.push(m);var _=new g.Subscription,p=function(){n.arrRemove(s,m),m.complete(),_.unsubscribe()},b;try{b=v.innerFrom(f(o))}catch(x){u(x);return}h.next(m.asObservable()),_.add(b.subscribe(t.createOperatorSubscriber(h,p,i.noop,u)))},i.noop)),d.subscribe(t.createOperatorSubscriber(h,function(o){var m,_,p=s.slice();try{for(var b=T(p),x=b.next();!x.done;x=b.next()){var E=x.value;E.next(o)}}catch(w){m={error:w}}finally{try{x&&!x.done&&(_=b.return)&&_.call(b)}finally{if(m)throw m.error}}},function(){for(;0<s.length;)s.shift().complete();h.complete()},u,function(){for(;0<s.length;)s.shift().unsubscribe()}))})}return us.windowToggle=r,us}var ls={},Pf;function C2(){if(Pf)return ls;Pf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.windowWhen=void 0;var T=ct(),a=ie(),g=ue(),y=ye();function v(t){return a.operate(function(i,n){var r,c,f=function(h){r.error(h),n.error(h)},d=function(){c==null||c.unsubscribe(),r==null||r.complete(),r=new T.Subject,n.next(r.asObservable());var h;try{h=y.innerFrom(t())}catch(s){f(s);return}h.subscribe(c=g.createOperatorSubscriber(n,d,d,f))};d(),i.subscribe(g.createOperatorSubscriber(n,function(h){return r.next(h)},function(){r.complete(),n.complete()},f,function(){c==null||c.unsubscribe(),r=null}))})}return ls.windowWhen=v,ls}var cs={},Lf;function N2(){if(Lf)return cs;Lf=1;var T=H&&H.__read||function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var h=d.call(c),s,u=[],o;try{for(;(f===void 0||f-- >0)&&!(s=h.next()).done;)u.push(s.value)}catch(m){o={error:m}}finally{try{s&&!s.done&&(d=h.return)&&d.call(h)}finally{if(o)throw o.error}}return u},a=H&&H.__spreadArray||function(c,f){for(var d=0,h=f.length,s=c.length;d<h;d++,s++)c[s]=f[d];return c};Object.defineProperty(cs,"__esModule",{value:!0}),cs.withLatestFrom=void 0;var g=ie(),y=ue(),v=ye(),t=lt(),i=ut(),n=xt();function r(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=n.popResultSelector(c);return g.operate(function(h,s){for(var u=c.length,o=new Array(u),m=c.map(function(){return!1}),_=!1,p=function(x){v.innerFrom(c[x]).subscribe(y.createOperatorSubscriber(s,function(E){o[x]=E,!_&&!m[x]&&(m[x]=!0,(_=m.every(t.identity))&&(m=null))},i.noop))},b=0;b<u;b++)p(b);h.subscribe(y.createOperatorSubscriber(s,function(x){if(_){var E=a([x],T(o));s.next(d?d.apply(void 0,a([],T(E))):E)}}))})}return cs.withLatestFrom=r,cs}var hs={},Mf;function z2(){if(Mf)return hs;Mf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.zipAll=void 0;var T=Pl(),a=S_();function g(y){return a.joinAllInternals(T.zip,y)}return hs.zipAll=g,hs}var ds={},fs={},If;function B2(){if(If)return fs;If=1;var T=H&&H.__read||function(t,i){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),c,f=[],d;try{for(;(i===void 0||i-- >0)&&!(c=r.next()).done;)f.push(c.value)}catch(h){d={error:h}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(d)throw d.error}}return f},a=H&&H.__spreadArray||function(t,i){for(var n=0,r=i.length,c=t.length;n<r;n++,c++)t[c]=i[n];return t};Object.defineProperty(fs,"__esModule",{value:!0}),fs.zip=void 0;var g=Pl(),y=ie();function v(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return y.operate(function(n,r){g.zip.apply(void 0,a([n],T(t))).subscribe(r)})}return fs.zip=v,fs}var Ff;function D2(){if(Ff)return ds;Ff=1;var T=H&&H.__read||function(v,t){var i=typeof Symbol=="function"&&v[Symbol.iterator];if(!i)return v;var n=i.call(v),r,c=[],f;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)c.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(f)throw f.error}}return c},a=H&&H.__spreadArray||function(v,t){for(var i=0,n=t.length,r=v.length;i<n;i++,r++)v[r]=t[i];return v};Object.defineProperty(ds,"__esModule",{value:!0}),ds.zipWith=void 0;var g=B2();function y(){for(var v=[],t=0;t<arguments.length;t++)v[t]=arguments[t];return g.zip.apply(void 0,a([],T(v)))}return ds.zipWith=y,ds}var Cf;function j_(){return Cf||(Cf=1,function(T){var a=H&&H.__createBinding||(Object.create?function(Xt,Yt,Pt,qt){qt===void 0&&(qt=Pt),Object.defineProperty(Xt,qt,{enumerable:!0,get:function(){return Yt[Pt]}})}:function(Xt,Yt,Pt,qt){qt===void 0&&(qt=Pt),Xt[qt]=Yt[Pt]}),g=H&&H.__exportStar||function(Xt,Yt){for(var Pt in Xt)Pt!=="default"&&!Object.prototype.hasOwnProperty.call(Yt,Pt)&&a(Yt,Xt,Pt)};Object.defineProperty(T,"__esModule",{value:!0}),T.interval=T.iif=T.generate=T.fromEventPattern=T.fromEvent=T.from=T.forkJoin=T.empty=T.defer=T.connectable=T.concat=T.combineLatest=T.bindNodeCallback=T.bindCallback=T.UnsubscriptionError=T.TimeoutError=T.SequenceError=T.ObjectUnsubscribedError=T.NotFoundError=T.EmptyError=T.ArgumentOutOfRangeError=T.firstValueFrom=T.lastValueFrom=T.isObservable=T.identity=T.noop=T.pipe=T.NotificationKind=T.Notification=T.Subscriber=T.Subscription=T.Scheduler=T.VirtualAction=T.VirtualTimeScheduler=T.animationFrameScheduler=T.animationFrame=T.queueScheduler=T.queue=T.asyncScheduler=T.async=T.asapScheduler=T.asap=T.AsyncSubject=T.ReplaySubject=T.BehaviorSubject=T.Subject=T.animationFrames=T.observable=T.ConnectableObservable=T.Observable=void 0,T.filter=T.expand=T.exhaustMap=T.exhaustAll=T.exhaust=T.every=T.endWith=T.elementAt=T.distinctUntilKeyChanged=T.distinctUntilChanged=T.distinct=T.dematerialize=T.delayWhen=T.delay=T.defaultIfEmpty=T.debounceTime=T.debounce=T.count=T.connect=T.concatWith=T.concatMapTo=T.concatMap=T.concatAll=T.combineLatestWith=T.combineLatestAll=T.combineAll=T.catchError=T.bufferWhen=T.bufferToggle=T.bufferTime=T.bufferCount=T.buffer=T.auditTime=T.audit=T.config=T.NEVER=T.EMPTY=T.scheduled=T.zip=T.using=T.timer=T.throwError=T.range=T.race=T.partition=T.pairs=T.onErrorResumeNext=T.of=T.never=T.merge=void 0,T.switchMap=T.switchAll=T.subscribeOn=T.startWith=T.skipWhile=T.skipUntil=T.skipLast=T.skip=T.single=T.shareReplay=T.share=T.sequenceEqual=T.scan=T.sampleTime=T.sample=T.refCount=T.retryWhen=T.retry=T.repeatWhen=T.repeat=T.reduce=T.raceWith=T.publishReplay=T.publishLast=T.publishBehavior=T.publish=T.pluck=T.pairwise=T.onErrorResumeNextWith=T.observeOn=T.multicast=T.min=T.mergeWith=T.mergeScan=T.mergeMapTo=T.mergeMap=T.flatMap=T.mergeAll=T.max=T.materialize=T.mapTo=T.map=T.last=T.isEmpty=T.ignoreElements=T.groupBy=T.first=T.findIndex=T.find=T.finalize=void 0,T.zipWith=T.zipAll=T.withLatestFrom=T.windowWhen=T.windowToggle=T.windowTime=T.windowCount=T.window=T.toArray=T.timestamp=T.timeoutWith=T.timeout=T.timeInterval=T.throwIfEmpty=T.throttleTime=T.throttle=T.tap=T.takeWhile=T.takeUntil=T.takeLast=T.take=T.switchScan=T.switchMapTo=void 0;var y=ze();Object.defineProperty(T,"Observable",{enumerable:!0,get:function(){return y.Observable}});var v=ao();Object.defineProperty(T,"ConnectableObservable",{enumerable:!0,get:function(){return v.ConnectableObservable}});var t=io();Object.defineProperty(T,"observable",{enumerable:!0,get:function(){return t.observable}});var i=Pv();Object.defineProperty(T,"animationFrames",{enumerable:!0,get:function(){return i.animationFrames}});var n=ct();Object.defineProperty(T,"Subject",{enumerable:!0,get:function(){return n.Subject}});var r=t_();Object.defineProperty(T,"BehaviorSubject",{enumerable:!0,get:function(){return r.BehaviorSubject}});var c=bl();Object.defineProperty(T,"ReplaySubject",{enumerable:!0,get:function(){return c.ReplaySubject}});var f=yl();Object.defineProperty(T,"AsyncSubject",{enumerable:!0,get:function(){return f.AsyncSubject}});var d=zv();Object.defineProperty(T,"asap",{enumerable:!0,get:function(){return d.asap}}),Object.defineProperty(T,"asapScheduler",{enumerable:!0,get:function(){return d.asapScheduler}});var h=Tt();Object.defineProperty(T,"async",{enumerable:!0,get:function(){return h.async}}),Object.defineProperty(T,"asyncScheduler",{enumerable:!0,get:function(){return h.asyncScheduler}});var s=jv();Object.defineProperty(T,"queue",{enumerable:!0,get:function(){return s.queue}}),Object.defineProperty(T,"queueScheduler",{enumerable:!0,get:function(){return s.queueScheduler}});var u=Gv();Object.defineProperty(T,"animationFrame",{enumerable:!0,get:function(){return u.animationFrame}}),Object.defineProperty(T,"animationFrameScheduler",{enumerable:!0,get:function(){return u.animationFrameScheduler}});var o=qv();Object.defineProperty(T,"VirtualTimeScheduler",{enumerable:!0,get:function(){return o.VirtualTimeScheduler}}),Object.defineProperty(T,"VirtualAction",{enumerable:!0,get:function(){return o.VirtualAction}});var m=r_();Object.defineProperty(T,"Scheduler",{enumerable:!0,get:function(){return m.Scheduler}});var _=Ot();Object.defineProperty(T,"Subscription",{enumerable:!0,get:function(){return _.Subscription}});var p=Es();Object.defineProperty(T,"Subscriber",{enumerable:!0,get:function(){return p.Subscriber}});var b=Al();Object.defineProperty(T,"Notification",{enumerable:!0,get:function(){return b.Notification}}),Object.defineProperty(T,"NotificationKind",{enumerable:!0,get:function(){return b.NotificationKind}});var x=no();Object.defineProperty(T,"pipe",{enumerable:!0,get:function(){return x.pipe}});var E=ut();Object.defineProperty(T,"noop",{enumerable:!0,get:function(){return E.noop}});var w=lt();Object.defineProperty(T,"identity",{enumerable:!0,get:function(){return w.identity}});var S=Xv();Object.defineProperty(T,"isObservable",{enumerable:!0,get:function(){return S.isObservable}});var R=Yv();Object.defineProperty(T,"lastValueFrom",{enumerable:!0,get:function(){return R.lastValueFrom}});var O=Zv();Object.defineProperty(T,"firstValueFrom",{enumerable:!0,get:function(){return O.firstValueFrom}});var I=f_();Object.defineProperty(T,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return I.ArgumentOutOfRangeError}});var D=Er();Object.defineProperty(T,"EmptyError",{enumerable:!0,get:function(){return D.EmptyError}});var j=__();Object.defineProperty(T,"NotFoundError",{enumerable:!0,get:function(){return j.NotFoundError}});var k=e_();Object.defineProperty(T,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return k.ObjectUnsubscribedError}});var G=p_();Object.defineProperty(T,"SequenceError",{enumerable:!0,get:function(){return G.SequenceError}});var Z=_l();Object.defineProperty(T,"TimeoutError",{enumerable:!0,get:function(){return Z.TimeoutError}});var K=Yf();Object.defineProperty(T,"UnsubscriptionError",{enumerable:!0,get:function(){return K.UnsubscriptionError}});var Y=Kv();Object.defineProperty(T,"bindCallback",{enumerable:!0,get:function(){return Y.bindCallback}});var re=Qv();Object.defineProperty(T,"bindNodeCallback",{enumerable:!0,get:function(){return re.bindNodeCallback}});var Q=Ol();Object.defineProperty(T,"combineLatest",{enumerable:!0,get:function(){return Q.combineLatest}});var ae=co();Object.defineProperty(T,"concat",{enumerable:!0,get:function(){return ae.concat}});var se=Jv();Object.defineProperty(T,"connectable",{enumerable:!0,get:function(){return se.connectable}});var ee=ho();Object.defineProperty(T,"defer",{enumerable:!0,get:function(){return ee.defer}});var le=kt();Object.defineProperty(T,"empty",{enumerable:!0,get:function(){return le.empty}});var ge=em();Object.defineProperty(T,"forkJoin",{enumerable:!0,get:function(){return ge.forkJoin}});var ve=Qt();Object.defineProperty(T,"from",{enumerable:!0,get:function(){return ve.from}});var ne=tm();Object.defineProperty(T,"fromEvent",{enumerable:!0,get:function(){return ne.fromEvent}});var be=rm();Object.defineProperty(T,"fromEventPattern",{enumerable:!0,get:function(){return be.fromEventPattern}});var Te=im();Object.defineProperty(T,"generate",{enumerable:!0,get:function(){return Te.generate}});var oe=nm();Object.defineProperty(T,"iif",{enumerable:!0,get:function(){return oe.iif}});var me=b_();Object.defineProperty(T,"interval",{enumerable:!0,get:function(){return me.interval}});var Ee=am();Object.defineProperty(T,"merge",{enumerable:!0,get:function(){return Ee.merge}});var Oe=Ad();Object.defineProperty(T,"never",{enumerable:!0,get:function(){return Oe.never}});var xe=xl();Object.defineProperty(T,"of",{enumerable:!0,get:function(){return xe.of}});var ke=y_();Object.defineProperty(T,"onErrorResumeNext",{enumerable:!0,get:function(){return ke.onErrorResumeNext}});var Le=sm();Object.defineProperty(T,"pairs",{enumerable:!0,get:function(){return Le.pairs}});var Re=um();Object.defineProperty(T,"partition",{enumerable:!0,get:function(){return Re.partition}});var Ye=E_();Object.defineProperty(T,"race",{enumerable:!0,get:function(){return Ye.race}});var qe=lm();Object.defineProperty(T,"range",{enumerable:!0,get:function(){return qe.range}});var rt=d_();Object.defineProperty(T,"throwError",{enumerable:!0,get:function(){return rt.throwError}});var ht=Ar();Object.defineProperty(T,"timer",{enumerable:!0,get:function(){return ht.timer}});var $e=cm();Object.defineProperty(T,"using",{enumerable:!0,get:function(){return $e.using}});var Me=Pl();Object.defineProperty(T,"zip",{enumerable:!0,get:function(){return Me.zip}});var Be=h_();Object.defineProperty(T,"scheduled",{enumerable:!0,get:function(){return Be.scheduled}});var yt=kt();Object.defineProperty(T,"EMPTY",{enumerable:!0,get:function(){return yt.EMPTY}});var we=Ad();Object.defineProperty(T,"NEVER",{enumerable:!0,get:function(){return we.NEVER}}),g(hm(),T);var At=ys();Object.defineProperty(T,"config",{enumerable:!0,get:function(){return At.config}});var dt=T_();Object.defineProperty(T,"audit",{enumerable:!0,get:function(){return dt.audit}});var Et=dm();Object.defineProperty(T,"auditTime",{enumerable:!0,get:function(){return Et.auditTime}});var ft=fm();Object.defineProperty(T,"buffer",{enumerable:!0,get:function(){return ft.buffer}});var mt=_m();Object.defineProperty(T,"bufferCount",{enumerable:!0,get:function(){return mt.bufferCount}});var gt=pm();Object.defineProperty(T,"bufferTime",{enumerable:!0,get:function(){return gt.bufferTime}});var tt=vm();Object.defineProperty(T,"bufferToggle",{enumerable:!0,get:function(){return tt.bufferToggle}});var zt=mm();Object.defineProperty(T,"bufferWhen",{enumerable:!0,get:function(){return zt.bufferWhen}});var Qe=gm();Object.defineProperty(T,"catchError",{enumerable:!0,get:function(){return Qe.catchError}});var Rt=bm();Object.defineProperty(T,"combineAll",{enumerable:!0,get:function(){return Rt.combineAll}});var Gt=O_();Object.defineProperty(T,"combineLatestAll",{enumerable:!0,get:function(){return Gt.combineLatestAll}});var Nr=Em();Object.defineProperty(T,"combineLatestWith",{enumerable:!0,get:function(){return Nr.combineLatestWith}});var zr=wl();Object.defineProperty(T,"concatAll",{enumerable:!0,get:function(){return zr.concatAll}});var Ue=R_();Object.defineProperty(T,"concatMap",{enumerable:!0,get:function(){return Ue.concatMap}});var Je=Tm();Object.defineProperty(T,"concatMapTo",{enumerable:!0,get:function(){return Je.concatMapTo}});var it=Am();Object.defineProperty(T,"concatWith",{enumerable:!0,get:function(){return it.concatWith}});var wt=Ll();Object.defineProperty(T,"connect",{enumerable:!0,get:function(){return wt.connect}});var Bt=Om();Object.defineProperty(T,"count",{enumerable:!0,get:function(){return Bt.count}});var mo=Rm();Object.defineProperty(T,"debounce",{enumerable:!0,get:function(){return mo.debounce}});var go=wm();Object.defineProperty(T,"debounceTime",{enumerable:!0,get:function(){return go.debounceTime}});var bo=fo();Object.defineProperty(T,"defaultIfEmpty",{enumerable:!0,get:function(){return bo.defaultIfEmpty}});var yo=Pm();Object.defineProperty(T,"delay",{enumerable:!0,get:function(){return yo.delay}});var Eo=L_();Object.defineProperty(T,"delayWhen",{enumerable:!0,get:function(){return Eo.delayWhen}});var To=Lm();Object.defineProperty(T,"dematerialize",{enumerable:!0,get:function(){return To.dematerialize}});var ws=Mm();Object.defineProperty(T,"distinct",{enumerable:!0,get:function(){return ws.distinct}});var xo=M_();Object.defineProperty(T,"distinctUntilChanged",{enumerable:!0,get:function(){return xo.distinctUntilChanged}});var Ao=Im();Object.defineProperty(T,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Ao.distinctUntilKeyChanged}});var So=Fm();Object.defineProperty(T,"elementAt",{enumerable:!0,get:function(){return So.elementAt}});var Oo=Cm();Object.defineProperty(T,"endWith",{enumerable:!0,get:function(){return Oo.endWith}});var Ro=Nm();Object.defineProperty(T,"every",{enumerable:!0,get:function(){return Ro.every}});var wo=zm();Object.defineProperty(T,"exhaust",{enumerable:!0,get:function(){return wo.exhaust}});var Po=F_();Object.defineProperty(T,"exhaustAll",{enumerable:!0,get:function(){return Po.exhaustAll}});var Lo=I_();Object.defineProperty(T,"exhaustMap",{enumerable:!0,get:function(){return Lo.exhaustMap}});var Mo=Bm();Object.defineProperty(T,"expand",{enumerable:!0,get:function(){return Mo.expand}});var Io=Lr();Object.defineProperty(T,"filter",{enumerable:!0,get:function(){return Io.filter}});var Fo=Dm();Object.defineProperty(T,"finalize",{enumerable:!0,get:function(){return Fo.finalize}});var Co=C_();Object.defineProperty(T,"find",{enumerable:!0,get:function(){return Co.find}});var No=jm();Object.defineProperty(T,"findIndex",{enumerable:!0,get:function(){return No.findIndex}});var Ps=km();Object.defineProperty(T,"first",{enumerable:!0,get:function(){return Ps.first}});var zo=Um();Object.defineProperty(T,"groupBy",{enumerable:!0,get:function(){return zo.groupBy}});var Bo=w_();Object.defineProperty(T,"ignoreElements",{enumerable:!0,get:function(){return Bo.ignoreElements}});var Do=Gm();Object.defineProperty(T,"isEmpty",{enumerable:!0,get:function(){return Do.isEmpty}});var jo=qm();Object.defineProperty(T,"last",{enumerable:!0,get:function(){return jo.last}});var ko=Tr();Object.defineProperty(T,"map",{enumerable:!0,get:function(){return ko.map}});var Uo=P_();Object.defineProperty(T,"mapTo",{enumerable:!0,get:function(){return Uo.mapTo}});var Go=Wm();Object.defineProperty(T,"materialize",{enumerable:!0,get:function(){return Go.materialize}});var qo=Vm();Object.defineProperty(T,"max",{enumerable:!0,get:function(){return qo.max}});var Wo=lo();Object.defineProperty(T,"mergeAll",{enumerable:!0,get:function(){return Wo.mergeAll}});var Vo=$m();Object.defineProperty(T,"flatMap",{enumerable:!0,get:function(){return Vo.flatMap}});var $o=Jt();Object.defineProperty(T,"mergeMap",{enumerable:!0,get:function(){return $o.mergeMap}});var Ls=Hm();Object.defineProperty(T,"mergeMapTo",{enumerable:!0,get:function(){return Ls.mergeMapTo}});var Ho=Xm();Object.defineProperty(T,"mergeScan",{enumerable:!0,get:function(){return Ho.mergeScan}});var Xo=Zm();Object.defineProperty(T,"mergeWith",{enumerable:!0,get:function(){return Xo.mergeWith}});var Yo=Km();Object.defineProperty(T,"min",{enumerable:!0,get:function(){return Yo.min}});var Zo=Ml();Object.defineProperty(T,"multicast",{enumerable:!0,get:function(){return Zo.multicast}});var Ms=oo();Object.defineProperty(T,"observeOn",{enumerable:!0,get:function(){return Ms.observeOn}});var Ko=Qm();Object.defineProperty(T,"onErrorResumeNextWith",{enumerable:!0,get:function(){return Ko.onErrorResumeNextWith}});var Qo=Jm();Object.defineProperty(T,"pairwise",{enumerable:!0,get:function(){return Qo.pairwise}});var Jo=e2();Object.defineProperty(T,"pluck",{enumerable:!0,get:function(){return Jo.pluck}});var eu=t2();Object.defineProperty(T,"publish",{enumerable:!0,get:function(){return eu.publish}});var tu=r2();Object.defineProperty(T,"publishBehavior",{enumerable:!0,get:function(){return tu.publishBehavior}});var ru=i2();Object.defineProperty(T,"publishLast",{enumerable:!0,get:function(){return ru.publishLast}});var iu=n2();Object.defineProperty(T,"publishReplay",{enumerable:!0,get:function(){return iu.publishReplay}});var nu=a2();Object.defineProperty(T,"raceWith",{enumerable:!0,get:function(){return nu.raceWith}});var au=As();Object.defineProperty(T,"reduce",{enumerable:!0,get:function(){return au.reduce}});var su=s2();Object.defineProperty(T,"repeat",{enumerable:!0,get:function(){return su.repeat}});var ou=o2();Object.defineProperty(T,"repeatWhen",{enumerable:!0,get:function(){return ou.repeatWhen}});var uu=u2();Object.defineProperty(T,"retry",{enumerable:!0,get:function(){return uu.retry}});var Is=l2();Object.defineProperty(T,"retryWhen",{enumerable:!0,get:function(){return Is.retryWhen}});var lu=Qf();Object.defineProperty(T,"refCount",{enumerable:!0,get:function(){return lu.refCount}});var Fs=z_();Object.defineProperty(T,"sample",{enumerable:!0,get:function(){return Fs.sample}});var Cs=c2();Object.defineProperty(T,"sampleTime",{enumerable:!0,get:function(){return Cs.sampleTime}});var Ns=h2();Object.defineProperty(T,"scan",{enumerable:!0,get:function(){return Ns.scan}});var cu=d2();Object.defineProperty(T,"sequenceEqual",{enumerable:!0,get:function(){return cu.sequenceEqual}});var hu=B_();Object.defineProperty(T,"share",{enumerable:!0,get:function(){return hu.share}});var du=f2();Object.defineProperty(T,"shareReplay",{enumerable:!0,get:function(){return du.shareReplay}});var fu=_2();Object.defineProperty(T,"single",{enumerable:!0,get:function(){return fu.single}});var zs=p2();Object.defineProperty(T,"skip",{enumerable:!0,get:function(){return zs.skip}});var _u=v2();Object.defineProperty(T,"skipLast",{enumerable:!0,get:function(){return _u.skipLast}});var pu=m2();Object.defineProperty(T,"skipUntil",{enumerable:!0,get:function(){return pu.skipUntil}});var vu=g2();Object.defineProperty(T,"skipWhile",{enumerable:!0,get:function(){return vu.skipWhile}});var Bs=b2();Object.defineProperty(T,"startWith",{enumerable:!0,get:function(){return Bs.startWith}});var mu=uo();Object.defineProperty(T,"subscribeOn",{enumerable:!0,get:function(){return mu.subscribeOn}});var gu=y2();Object.defineProperty(T,"switchAll",{enumerable:!0,get:function(){return gu.switchAll}});var bu=vo();Object.defineProperty(T,"switchMap",{enumerable:!0,get:function(){return bu.switchMap}});var yu=E2();Object.defineProperty(T,"switchMapTo",{enumerable:!0,get:function(){return yu.switchMapTo}});var Eu=T2();Object.defineProperty(T,"switchScan",{enumerable:!0,get:function(){return Eu.switchScan}});var Tu=_o();Object.defineProperty(T,"take",{enumerable:!0,get:function(){return Tu.take}});var xu=N_();Object.defineProperty(T,"takeLast",{enumerable:!0,get:function(){return xu.takeLast}});var Ds=x2();Object.defineProperty(T,"takeUntil",{enumerable:!0,get:function(){return Ds.takeUntil}});var Au=A2();Object.defineProperty(T,"takeWhile",{enumerable:!0,get:function(){return Au.takeWhile}});var Su=S2();Object.defineProperty(T,"tap",{enumerable:!0,get:function(){return Su.tap}});var Ou=D_();Object.defineProperty(T,"throttle",{enumerable:!0,get:function(){return Ou.throttle}});var Ru=O2();Object.defineProperty(T,"throttleTime",{enumerable:!0,get:function(){return Ru.throttleTime}});var wu=po();Object.defineProperty(T,"throwIfEmpty",{enumerable:!0,get:function(){return wu.throwIfEmpty}});var Pu=R2();Object.defineProperty(T,"timeInterval",{enumerable:!0,get:function(){return Pu.timeInterval}});var Br=_l();Object.defineProperty(T,"timeout",{enumerable:!0,get:function(){return Br.timeout}});var Lu=w2();Object.defineProperty(T,"timeoutWith",{enumerable:!0,get:function(){return Lu.timeoutWith}});var js=P2();Object.defineProperty(T,"timestamp",{enumerable:!0,get:function(){return js.timestamp}});var Dr=A_();Object.defineProperty(T,"toArray",{enumerable:!0,get:function(){return Dr.toArray}});var Mu=L2();Object.defineProperty(T,"window",{enumerable:!0,get:function(){return Mu.window}});var Iu=M2();Object.defineProperty(T,"windowCount",{enumerable:!0,get:function(){return Iu.windowCount}});var Fu=I2();Object.defineProperty(T,"windowTime",{enumerable:!0,get:function(){return Fu.windowTime}});var ks=F2();Object.defineProperty(T,"windowToggle",{enumerable:!0,get:function(){return ks.windowToggle}});var Us=C2();Object.defineProperty(T,"windowWhen",{enumerable:!0,get:function(){return Us.windowWhen}});var Gs=N2();Object.defineProperty(T,"withLatestFrom",{enumerable:!0,get:function(){return Gs.withLatestFrom}});var Cu=z2();Object.defineProperty(T,"zipAll",{enumerable:!0,get:function(){return Cu.zipAll}});var Nu=D2();Object.defineProperty(T,"zipWith",{enumerable:!0,get:function(){return Nu.zipWith}})}($u)),$u}(()=>{var T={3557:(v,t,i)=>{i.r(t),i.d(t,{glMatrix:()=>n,mat2:()=>r,mat2d:()=>c,mat3:()=>f,mat4:()=>d,quat:()=>u,quat2:()=>o,vec2:()=>m,vec3:()=>h,vec4:()=>s});var n={};i.r(n),i.d(n,{ARRAY_TYPE:()=>p,EPSILON:()=>_,RANDOM:()=>b,equals:()=>S,setMatrixArrayType:()=>x,toRadian:()=>w});var r={};i.r(r),i.d(r,{LDU:()=>ve,add:()=>ne,adjoint:()=>K,clone:()=>O,copy:()=>I,create:()=>R,determinant:()=>Y,equals:()=>oe,exactEquals:()=>Te,frob:()=>ge,fromRotation:()=>se,fromScaling:()=>ee,fromValues:()=>j,identity:()=>D,invert:()=>Z,mul:()=>Oe,multiply:()=>re,multiplyScalar:()=>me,multiplyScalarAndAdd:()=>Ee,rotate:()=>Q,scale:()=>ae,set:()=>k,str:()=>le,sub:()=>xe,subtract:()=>be,transpose:()=>G});var c={};i.r(c),i.d(c,{add:()=>gt,clone:()=>Le,copy:()=>Re,create:()=>ke,determinant:()=>$e,equals:()=>Gt,exactEquals:()=>Rt,frob:()=>mt,fromRotation:()=>At,fromScaling:()=>dt,fromTranslation:()=>Et,fromValues:()=>qe,identity:()=>Ye,invert:()=>ht,mul:()=>Nr,multiply:()=>Me,multiplyScalar:()=>zt,multiplyScalarAndAdd:()=>Qe,rotate:()=>Be,scale:()=>yt,set:()=>rt,str:()=>ft,sub:()=>zr,subtract:()=>tt,translate:()=>we});var f={};i.r(f),i.d(f,{add:()=>No,adjoint:()=>Eo,clone:()=>it,copy:()=>wt,create:()=>Ue,determinant:()=>To,equals:()=>jo,exactEquals:()=>Do,frob:()=>Co,fromMat2d:()=>Po,fromMat4:()=>Je,fromQuat:()=>Lo,fromRotation:()=>Ro,fromScaling:()=>wo,fromTranslation:()=>Oo,fromValues:()=>Bt,identity:()=>go,invert:()=>yo,mul:()=>ko,multiply:()=>ws,multiplyScalar:()=>zo,multiplyScalarAndAdd:()=>Bo,normalFromMat4:()=>Mo,projection:()=>Io,rotate:()=>Ao,scale:()=>So,set:()=>mo,str:()=>Fo,sub:()=>Uo,subtract:()=>Ps,translate:()=>xo,transpose:()=>bo});var d={};i.r(d),i.d(d,{add:()=>xu,adjoint:()=>Yo,clone:()=>qo,copy:()=>Wo,create:()=>Go,determinant:()=>Zo,equals:()=>Ru,exactEquals:()=>Ou,frob:()=>Tu,fromQuat:()=>du,fromQuat2:()=>lu,fromRotation:()=>au,fromRotationTranslation:()=>Is,fromRotationTranslationScale:()=>cu,fromRotationTranslationScaleOrigin:()=>hu,fromScaling:()=>nu,fromTranslation:()=>iu,fromValues:()=>Vo,fromXRotation:()=>su,fromYRotation:()=>ou,fromZRotation:()=>uu,frustum:()=>fu,getRotation:()=>Ns,getScaling:()=>Cs,getTranslation:()=>Fs,identity:()=>Ls,invert:()=>Xo,lookAt:()=>bu,mul:()=>wu,multiply:()=>Ms,multiplyScalar:()=>Au,multiplyScalarAndAdd:()=>Su,ortho:()=>mu,orthoNO:()=>Bs,orthoZO:()=>gu,perspective:()=>_u,perspectiveFromFieldOfView:()=>vu,perspectiveNO:()=>zs,perspectiveZO:()=>pu,rotate:()=>Jo,rotateX:()=>eu,rotateY:()=>tu,rotateZ:()=>ru,scale:()=>Qo,set:()=>$o,str:()=>Eu,sub:()=>Pu,subtract:()=>Ds,targetTo:()=>yu,translate:()=>Ko,transpose:()=>Ho});var h={};i.r(h),i.d(h,{add:()=>Fu,angle:()=>s1,bezier:()=>Q_,ceil:()=>Cu,clone:()=>Lu,copy:()=>Mu,create:()=>Br,cross:()=>qs,dist:()=>_1,distance:()=>Il,div:()=>f1,divide:()=>Gs,dot:()=>zu,equals:()=>c1,exactEquals:()=>l1,floor:()=>Nu,forEach:()=>m1,fromValues:()=>Dr,hermite:()=>K_,inverse:()=>Y_,len:()=>zl,length:()=>js,lerp:()=>Z_,max:()=>Yt,min:()=>Xt,mul:()=>d1,multiply:()=>Us,negate:()=>X_,normalize:()=>Nl,random:()=>J_,rotateX:()=>i1,rotateY:()=>n1,rotateZ:()=>a1,round:()=>Pt,scale:()=>qt,scaleAndAdd:()=>H_,set:()=>Iu,sqrDist:()=>p1,sqrLen:()=>v1,squaredDistance:()=>Fl,squaredLength:()=>Cl,str:()=>u1,sub:()=>h1,subtract:()=>ks,transformMat3:()=>t1,transformMat4:()=>e1,transformQuat:()=>r1,zero:()=>o1});var s={};i.r(s),i.d(s,{add:()=>Gl,ceil:()=>g1,clone:()=>Dl,copy:()=>kl,create:()=>Bl,cross:()=>O1,dist:()=>N1,distance:()=>Hl,div:()=>C1,divide:()=>Vl,dot:()=>Zl,equals:()=>Jl,exactEquals:()=>Ql,floor:()=>b1,forEach:()=>j1,fromValues:()=>jl,inverse:()=>S1,len:()=>B1,length:()=>Bu,lerp:()=>Kl,max:()=>E1,min:()=>y1,mul:()=>F1,multiply:()=>Wl,negate:()=>A1,normalize:()=>Yl,random:()=>R1,round:()=>T1,scale:()=>$l,scaleAndAdd:()=>x1,set:()=>Ul,sqrDist:()=>z1,sqrLen:()=>D1,squaredDistance:()=>Xl,squaredLength:()=>Du,str:()=>M1,sub:()=>I1,subtract:()=>ql,transformMat4:()=>w1,transformQuat:()=>P1,zero:()=>L1});var u={};i.r(u),i.d(u,{add:()=>J1,calculateW:()=>q1,clone:()=>Z1,conjugate:()=>H1,copy:()=>Uu,create:()=>Ws,dot:()=>Gu,equals:()=>ap,exactEquals:()=>np,exp:()=>ac,fromEuler:()=>X1,fromMat3:()=>oc,fromValues:()=>K1,getAngle:()=>G1,getAxisAngle:()=>U1,identity:()=>k1,invert:()=>$1,len:()=>rp,length:()=>qu,lerp:()=>tp,ln:()=>sc,mul:()=>ep,multiply:()=>tc,normalize:()=>Vu,pow:()=>W1,random:()=>V1,rotateX:()=>rc,rotateY:()=>ic,rotateZ:()=>nc,rotationTo:()=>sp,scale:()=>cc,set:()=>Q1,setAxes:()=>up,setAxisAngle:()=>ec,slerp:()=>Vs,sqlerp:()=>op,sqrLen:()=>ip,squaredLength:()=>Wu,str:()=>Y1});var o={};i.r(o),i.d(o,{add:()=>Lp,clone:()=>cp,conjugate:()=>Np,copy:()=>dc,create:()=>lp,dot:()=>_c,equals:()=>Up,exactEquals:()=>kp,fromMat4:()=>pp,fromRotation:()=>_p,fromRotationTranslation:()=>hc,fromRotationTranslationValues:()=>dp,fromTranslation:()=>fp,fromValues:()=>hp,getDual:()=>bp,getReal:()=>gp,getTranslation:()=>Tp,identity:()=>vp,invert:()=>Cp,len:()=>zp,length:()=>pc,lerp:()=>Fp,mul:()=>Mp,multiply:()=>fc,normalize:()=>Dp,rotateAroundAxis:()=>Pp,rotateByQuatAppend:()=>Rp,rotateByQuatPrepend:()=>wp,rotateX:()=>Ap,rotateY:()=>Sp,rotateZ:()=>Op,scale:()=>Ip,set:()=>mp,setDual:()=>Ep,setReal:()=>yp,sqrLen:()=>Bp,squaredLength:()=>$s,str:()=>jp,translate:()=>xp});var m={};i.r(m),i.d(m,{add:()=>$p,angle:()=>dv,ceil:()=>Hp,clone:()=>Gp,copy:()=>Wp,create:()=>vc,cross:()=>nv,dist:()=>Ev,distance:()=>yc,div:()=>yv,divide:()=>bc,dot:()=>iv,equals:()=>vv,exactEquals:()=>pv,floor:()=>Xp,forEach:()=>Av,fromValues:()=>qp,inverse:()=>tv,len:()=>mv,length:()=>Tc,lerp:()=>av,max:()=>Zp,min:()=>Yp,mul:()=>bv,multiply:()=>gc,negate:()=>ev,normalize:()=>rv,random:()=>sv,rotate:()=>hv,round:()=>Kp,scale:()=>Qp,scaleAndAdd:()=>Jp,set:()=>Vp,sqrDist:()=>Tv,sqrLen:()=>xv,squaredDistance:()=>Ec,squaredLength:()=>xc,str:()=>_v,sub:()=>gv,subtract:()=>mc,transformMat2:()=>ov,transformMat2d:()=>uv,transformMat3:()=>lv,transformMat4:()=>cv,zero:()=>fv});var _=1e-6,p=typeof Float32Array<"u"?Float32Array:Array,b=Math.random;function x(e){p=e}var E=Math.PI/180;function w(e){return e*E}function S(e,l){return Math.abs(e-l)<=_*Math.max(1,Math.abs(e),Math.abs(l))}function R(){var e=new p(4);return p!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function O(e){var l=new p(4);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l}function I(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e}function D(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function j(e,l,A,P){var L=new p(4);return L[0]=e,L[1]=l,L[2]=A,L[3]=P,L}function k(e,l,A,P,L){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e}function G(e,l){if(e===l){var A=l[1];e[1]=l[2],e[2]=A}else e[0]=l[0],e[1]=l[2],e[2]=l[1],e[3]=l[3];return e}function Z(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*M-L*P;return F?(F=1/F,e[0]=M*F,e[1]=-P*F,e[2]=-L*F,e[3]=A*F,e):null}function K(e,l){var A=l[0];return e[0]=l[3],e[1]=-l[1],e[2]=-l[2],e[3]=A,e}function Y(e){return e[0]*e[3]-e[2]*e[1]}function re(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*C+M*z,e[1]=L*C+F*z,e[2]=P*B+M*U,e[3]=L*B+F*U,e}function Q(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+M*C,e[1]=L*z+F*C,e[2]=P*-C+M*z,e[3]=L*-C+F*z,e}function ae(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1];return e[0]=P*C,e[1]=L*C,e[2]=M*z,e[3]=F*z,e}function se(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=-A,e[3]=P,e}function ee(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=l[1],e}function le(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ge(e){return Math.hypot(e[0],e[1],e[2],e[3])}function ve(e,l,A,P){return e[2]=P[2]/P[0],A[0]=P[0],A[1]=P[1],A[3]=P[3]-e[2]*A[1],[e,l,A]}function ne(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e}function be(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e}function Te(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]}function oe(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=l[0],C=l[1],z=l[2],B=l[3];return Math.abs(A-F)<=_*Math.max(1,Math.abs(A),Math.abs(F))&&Math.abs(P-C)<=_*Math.max(1,Math.abs(P),Math.abs(C))&&Math.abs(L-z)<=_*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=_*Math.max(1,Math.abs(M),Math.abs(B))}function me(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e}function Ee(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e}Math.hypot||(Math.hypot=function(){for(var e=0,l=arguments.length;l--;)e+=arguments[l]*arguments[l];return Math.sqrt(e)});var Oe=re,xe=be;function ke(){var e=new p(6);return p!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function Le(e){var l=new p(6);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l}function Re(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e}function Ye(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function qe(e,l,A,P,L,M){var F=new p(6);return F[0]=e,F[1]=l,F[2]=A,F[3]=P,F[4]=L,F[5]=M,F}function rt(e,l,A,P,L,M,F){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e}function ht(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=A*M-P*L;return z?(z=1/z,e[0]=M*z,e[1]=-P*z,e[2]=-L*z,e[3]=A*z,e[4]=(L*C-M*F)*z,e[5]=(P*F-A*C)*z,e):null}function $e(e){return e[0]*e[3]-e[1]*e[2]}function Me(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1],q=A[2],W=A[3],V=A[4],X=A[5];return e[0]=P*B+M*U,e[1]=L*B+F*U,e[2]=P*q+M*W,e[3]=L*q+F*W,e[4]=P*V+M*X+C,e[5]=L*V+F*X+z,e}function Be(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=Math.sin(A),U=Math.cos(A);return e[0]=P*U+M*B,e[1]=L*U+F*B,e[2]=P*-B+M*U,e[3]=L*-B+F*U,e[4]=C,e[5]=z,e}function yt(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1];return e[0]=P*B,e[1]=L*B,e[2]=M*U,e[3]=F*U,e[4]=C,e[5]=z,e}function we(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=A[0],U=A[1];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=P*B+M*U+C,e[5]=L*B+F*U+z,e}function At(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=-A,e[3]=P,e[4]=0,e[5]=0,e}function dt(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=l[1],e[4]=0,e[5]=0,e}function Et(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=l[0],e[5]=l[1],e}function ft(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function mt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function gt(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e}function tt(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e}function zt(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e}function Qe(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e}function Rt(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]}function Gt(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=l[0],B=l[1],U=l[2],q=l[3],W=l[4],V=l[5];return Math.abs(A-z)<=_*Math.max(1,Math.abs(A),Math.abs(z))&&Math.abs(P-B)<=_*Math.max(1,Math.abs(P),Math.abs(B))&&Math.abs(L-U)<=_*Math.max(1,Math.abs(L),Math.abs(U))&&Math.abs(M-q)<=_*Math.max(1,Math.abs(M),Math.abs(q))&&Math.abs(F-W)<=_*Math.max(1,Math.abs(F),Math.abs(W))&&Math.abs(C-V)<=_*Math.max(1,Math.abs(C),Math.abs(V))}var Nr=Me,zr=tt;function Ue(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Je(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[4],e[4]=l[5],e[5]=l[6],e[6]=l[8],e[7]=l[9],e[8]=l[10],e}function it(e){var l=new p(9);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l[8]=e[8],l}function wt(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e}function Bt(e,l,A,P,L,M,F,C,z){var B=new p(9);return B[0]=e,B[1]=l,B[2]=A,B[3]=P,B[4]=L,B[5]=M,B[6]=F,B[7]=C,B[8]=z,B}function mo(e,l,A,P,L,M,F,C,z,B){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e[8]=B,e}function go(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function bo(e,l){if(e===l){var A=l[1],P=l[2],L=l[5];e[1]=l[3],e[2]=l[6],e[3]=A,e[5]=l[7],e[6]=P,e[7]=L}else e[0]=l[0],e[1]=l[3],e[2]=l[6],e[3]=l[1],e[4]=l[4],e[5]=l[7],e[6]=l[2],e[7]=l[5],e[8]=l[8];return e}function yo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=U*F-C*B,W=-U*M+C*z,V=B*M-F*z,X=A*q+P*W+L*V;return X?(X=1/X,e[0]=q*X,e[1]=(-U*P+L*B)*X,e[2]=(C*P-L*F)*X,e[3]=W*X,e[4]=(U*A-L*z)*X,e[5]=(-C*A+L*M)*X,e[6]=V*X,e[7]=(-B*A+P*z)*X,e[8]=(F*A-P*M)*X,e):null}function Eo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8];return e[0]=F*U-C*B,e[1]=L*B-P*U,e[2]=P*C-L*F,e[3]=C*z-M*U,e[4]=A*U-L*z,e[5]=L*M-A*C,e[6]=M*B-F*z,e[7]=P*z-A*B,e[8]=A*F-P*M,e}function To(e){var l=e[0],A=e[1],P=e[2],L=e[3],M=e[4],F=e[5],C=e[6],z=e[7],B=e[8];return l*(B*M-F*z)+A*(-B*L+F*C)+P*(z*L-M*C)}function ws(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=A[0],V=A[1],X=A[2],J=A[3],$=A[4],te=A[5],de=A[6],ce=A[7],he=A[8];return e[0]=W*P+V*F+X*B,e[1]=W*L+V*C+X*U,e[2]=W*M+V*z+X*q,e[3]=J*P+$*F+te*B,e[4]=J*L+$*C+te*U,e[5]=J*M+$*z+te*q,e[6]=de*P+ce*F+he*B,e[7]=de*L+ce*C+he*U,e[8]=de*M+ce*z+he*q,e}function xo(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=A[0],V=A[1];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=C,e[5]=z,e[6]=W*P+V*F+B,e[7]=W*L+V*C+U,e[8]=W*M+V*z+q,e}function Ao(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=Math.sin(A),V=Math.cos(A);return e[0]=V*P+W*F,e[1]=V*L+W*C,e[2]=V*M+W*z,e[3]=V*F-W*P,e[4]=V*C-W*L,e[5]=V*z-W*M,e[6]=B,e[7]=U,e[8]=q,e}function So(e,l,A){var P=A[0],L=A[1];return e[0]=P*l[0],e[1]=P*l[1],e[2]=P*l[2],e[3]=L*l[3],e[4]=L*l[4],e[5]=L*l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e}function Oo(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=l[0],e[7]=l[1],e[8]=1,e}function Ro(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=0,e[3]=-A,e[4]=P,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function wo(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=0,e[4]=l[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Po(e,l){return e[0]=l[0],e[1]=l[1],e[2]=0,e[3]=l[2],e[4]=l[3],e[5]=0,e[6]=l[4],e[7]=l[5],e[8]=1,e}function Lo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A+A,C=P+P,z=L+L,B=A*F,U=P*F,q=P*C,W=L*F,V=L*C,X=L*z,J=M*F,$=M*C,te=M*z;return e[0]=1-q-X,e[3]=U-te,e[6]=W+$,e[1]=U+te,e[4]=1-B-X,e[7]=V-J,e[2]=W-$,e[5]=V+J,e[8]=1-B-q,e}function Mo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15],de=A*C-P*F,ce=A*z-L*F,he=A*B-M*F,pe=P*z-L*C,fe=P*B-M*C,He=L*B-M*z,We=U*J-q*X,Ve=U*$-W*X,De=U*te-V*X,Ze=q*$-W*J,Ie=q*te-V*J,Fe=W*te-V*$,_e=de*Fe-ce*Ie+he*Ze+pe*De-fe*Ve+He*We;return _e?(_e=1/_e,e[0]=(C*Fe-z*Ie+B*Ze)*_e,e[1]=(z*De-F*Fe-B*Ve)*_e,e[2]=(F*Ie-C*De+B*We)*_e,e[3]=(L*Ie-P*Fe-M*Ze)*_e,e[4]=(A*Fe-L*De+M*Ve)*_e,e[5]=(P*De-A*Ie-M*We)*_e,e[6]=(J*He-$*fe+te*pe)*_e,e[7]=($*he-X*He-te*ce)*_e,e[8]=(X*fe-J*he+te*de)*_e,e):null}function Io(e,l,A){return e[0]=2/l,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/A,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Fo(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Co(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function No(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e[8]=l[8]+A[8],e}function Ps(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e[6]=l[6]-A[6],e[7]=l[7]-A[7],e[8]=l[8]-A[8],e}function zo(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e[8]=l[8]*A,e}function Bo(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e[6]=l[6]+A[6]*P,e[7]=l[7]+A[7]*P,e[8]=l[8]+A[8]*P,e}function Do(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]&&e[8]===l[8]}function jo(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=e[8],q=l[0],W=l[1],V=l[2],X=l[3],J=l[4],$=l[5],te=l[6],de=l[7],ce=l[8];return Math.abs(A-q)<=_*Math.max(1,Math.abs(A),Math.abs(q))&&Math.abs(P-W)<=_*Math.max(1,Math.abs(P),Math.abs(W))&&Math.abs(L-V)<=_*Math.max(1,Math.abs(L),Math.abs(V))&&Math.abs(M-X)<=_*Math.max(1,Math.abs(M),Math.abs(X))&&Math.abs(F-J)<=_*Math.max(1,Math.abs(F),Math.abs(J))&&Math.abs(C-$)<=_*Math.max(1,Math.abs(C),Math.abs($))&&Math.abs(z-te)<=_*Math.max(1,Math.abs(z),Math.abs(te))&&Math.abs(B-de)<=_*Math.max(1,Math.abs(B),Math.abs(de))&&Math.abs(U-ce)<=_*Math.max(1,Math.abs(U),Math.abs(ce))}var ko=ws,Uo=Ps;function Go(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function qo(e){var l=new p(16);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l[8]=e[8],l[9]=e[9],l[10]=e[10],l[11]=e[11],l[12]=e[12],l[13]=e[13],l[14]=e[14],l[15]=e[15],l}function Wo(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[8]=l[8],e[9]=l[9],e[10]=l[10],e[11]=l[11],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15],e}function Vo(e,l,A,P,L,M,F,C,z,B,U,q,W,V,X,J){var $=new p(16);return $[0]=e,$[1]=l,$[2]=A,$[3]=P,$[4]=L,$[5]=M,$[6]=F,$[7]=C,$[8]=z,$[9]=B,$[10]=U,$[11]=q,$[12]=W,$[13]=V,$[14]=X,$[15]=J,$}function $o(e,l,A,P,L,M,F,C,z,B,U,q,W,V,X,J,$){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e[8]=B,e[9]=U,e[10]=q,e[11]=W,e[12]=V,e[13]=X,e[14]=J,e[15]=$,e}function Ls(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ho(e,l){if(e===l){var A=l[1],P=l[2],L=l[3],M=l[6],F=l[7],C=l[11];e[1]=l[4],e[2]=l[8],e[3]=l[12],e[4]=A,e[6]=l[9],e[7]=l[13],e[8]=P,e[9]=M,e[11]=l[14],e[12]=L,e[13]=F,e[14]=C}else e[0]=l[0],e[1]=l[4],e[2]=l[8],e[3]=l[12],e[4]=l[1],e[5]=l[5],e[6]=l[9],e[7]=l[13],e[8]=l[2],e[9]=l[6],e[10]=l[10],e[11]=l[14],e[12]=l[3],e[13]=l[7],e[14]=l[11],e[15]=l[15];return e}function Xo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15],de=A*C-P*F,ce=A*z-L*F,he=A*B-M*F,pe=P*z-L*C,fe=P*B-M*C,He=L*B-M*z,We=U*J-q*X,Ve=U*$-W*X,De=U*te-V*X,Ze=q*$-W*J,Ie=q*te-V*J,Fe=W*te-V*$,_e=de*Fe-ce*Ie+he*Ze+pe*De-fe*Ve+He*We;return _e?(_e=1/_e,e[0]=(C*Fe-z*Ie+B*Ze)*_e,e[1]=(L*Ie-P*Fe-M*Ze)*_e,e[2]=(J*He-$*fe+te*pe)*_e,e[3]=(W*fe-q*He-V*pe)*_e,e[4]=(z*De-F*Fe-B*Ve)*_e,e[5]=(A*Fe-L*De+M*Ve)*_e,e[6]=($*he-X*He-te*ce)*_e,e[7]=(U*He-W*he+V*ce)*_e,e[8]=(F*Ie-C*De+B*We)*_e,e[9]=(P*De-A*Ie-M*We)*_e,e[10]=(X*fe-J*he+te*de)*_e,e[11]=(q*he-U*fe-V*de)*_e,e[12]=(C*Ve-F*Ze-z*We)*_e,e[13]=(A*Ze-P*Ve+L*We)*_e,e[14]=(J*ce-X*pe-$*de)*_e,e[15]=(U*pe-q*ce+W*de)*_e,e):null}function Yo(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=l[4],C=l[5],z=l[6],B=l[7],U=l[8],q=l[9],W=l[10],V=l[11],X=l[12],J=l[13],$=l[14],te=l[15];return e[0]=C*(W*te-V*$)-q*(z*te-B*$)+J*(z*V-B*W),e[1]=-(P*(W*te-V*$)-q*(L*te-M*$)+J*(L*V-M*W)),e[2]=P*(z*te-B*$)-C*(L*te-M*$)+J*(L*B-M*z),e[3]=-(P*(z*V-B*W)-C*(L*V-M*W)+q*(L*B-M*z)),e[4]=-(F*(W*te-V*$)-U*(z*te-B*$)+X*(z*V-B*W)),e[5]=A*(W*te-V*$)-U*(L*te-M*$)+X*(L*V-M*W),e[6]=-(A*(z*te-B*$)-F*(L*te-M*$)+X*(L*B-M*z)),e[7]=A*(z*V-B*W)-F*(L*V-M*W)+U*(L*B-M*z),e[8]=F*(q*te-V*J)-U*(C*te-B*J)+X*(C*V-B*q),e[9]=-(A*(q*te-V*J)-U*(P*te-M*J)+X*(P*V-M*q)),e[10]=A*(C*te-B*J)-F*(P*te-M*J)+X*(P*B-M*C),e[11]=-(A*(C*V-B*q)-F*(P*V-M*q)+U*(P*B-M*C)),e[12]=-(F*(q*$-W*J)-U*(C*$-z*J)+X*(C*W-z*q)),e[13]=A*(q*$-W*J)-U*(P*$-L*J)+X*(P*W-L*q),e[14]=-(A*(C*$-z*J)-F*(P*$-L*J)+X*(P*z-L*C)),e[15]=A*(C*W-z*q)-F*(P*W-L*q)+U*(P*z-L*C),e}function Zo(e){var l=e[0],A=e[1],P=e[2],L=e[3],M=e[4],F=e[5],C=e[6],z=e[7],B=e[8],U=e[9],q=e[10],W=e[11],V=e[12],X=e[13],J=e[14],$=e[15];return(l*F-A*M)*(q*$-W*J)-(l*C-P*M)*(U*$-W*X)+(l*z-L*M)*(U*J-q*X)+(A*C-P*F)*(B*$-W*V)-(A*z-L*F)*(B*J-q*V)+(P*z-L*C)*(B*X-U*V)}function Ms(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=l[9],V=l[10],X=l[11],J=l[12],$=l[13],te=l[14],de=l[15],ce=A[0],he=A[1],pe=A[2],fe=A[3];return e[0]=ce*P+he*C+pe*q+fe*J,e[1]=ce*L+he*z+pe*W+fe*$,e[2]=ce*M+he*B+pe*V+fe*te,e[3]=ce*F+he*U+pe*X+fe*de,ce=A[4],he=A[5],pe=A[6],fe=A[7],e[4]=ce*P+he*C+pe*q+fe*J,e[5]=ce*L+he*z+pe*W+fe*$,e[6]=ce*M+he*B+pe*V+fe*te,e[7]=ce*F+he*U+pe*X+fe*de,ce=A[8],he=A[9],pe=A[10],fe=A[11],e[8]=ce*P+he*C+pe*q+fe*J,e[9]=ce*L+he*z+pe*W+fe*$,e[10]=ce*M+he*B+pe*V+fe*te,e[11]=ce*F+he*U+pe*X+fe*de,ce=A[12],he=A[13],pe=A[14],fe=A[15],e[12]=ce*P+he*C+pe*q+fe*J,e[13]=ce*L+he*z+pe*W+fe*$,e[14]=ce*M+he*B+pe*V+fe*te,e[15]=ce*F+he*U+pe*X+fe*de,e}function Ko(e,l,A){var P,L,M,F,C,z,B,U,q,W,V,X,J=A[0],$=A[1],te=A[2];return l===e?(e[12]=l[0]*J+l[4]*$+l[8]*te+l[12],e[13]=l[1]*J+l[5]*$+l[9]*te+l[13],e[14]=l[2]*J+l[6]*$+l[10]*te+l[14],e[15]=l[3]*J+l[7]*$+l[11]*te+l[15]):(P=l[0],L=l[1],M=l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=l[8],W=l[9],V=l[10],X=l[11],e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=C,e[5]=z,e[6]=B,e[7]=U,e[8]=q,e[9]=W,e[10]=V,e[11]=X,e[12]=P*J+C*$+q*te+l[12],e[13]=L*J+z*$+W*te+l[13],e[14]=M*J+B*$+V*te+l[14],e[15]=F*J+U*$+X*te+l[15]),e}function Qo(e,l,A){var P=A[0],L=A[1],M=A[2];return e[0]=l[0]*P,e[1]=l[1]*P,e[2]=l[2]*P,e[3]=l[3]*P,e[4]=l[4]*L,e[5]=l[5]*L,e[6]=l[6]*L,e[7]=l[7]*L,e[8]=l[8]*M,e[9]=l[9]*M,e[10]=l[10]*M,e[11]=l[11]*M,e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15],e}function Jo(e,l,A,P){var L,M,F,C,z,B,U,q,W,V,X,J,$,te,de,ce,he,pe,fe,He,We,Ve,De,Ze,Ie=P[0],Fe=P[1],_e=P[2],It=Math.hypot(Ie,Fe,_e);return It<_?null:(Ie*=It=1/It,Fe*=It,_e*=It,L=Math.sin(A),F=1-(M=Math.cos(A)),C=l[0],z=l[1],B=l[2],U=l[3],q=l[4],W=l[5],V=l[6],X=l[7],J=l[8],$=l[9],te=l[10],de=l[11],ce=Ie*Ie*F+M,he=Fe*Ie*F+_e*L,pe=_e*Ie*F-Fe*L,fe=Ie*Fe*F-_e*L,He=Fe*Fe*F+M,We=_e*Fe*F+Ie*L,Ve=Ie*_e*F+Fe*L,De=Fe*_e*F-Ie*L,Ze=_e*_e*F+M,e[0]=C*ce+q*he+J*pe,e[1]=z*ce+W*he+$*pe,e[2]=B*ce+V*he+te*pe,e[3]=U*ce+X*he+de*pe,e[4]=C*fe+q*He+J*We,e[5]=z*fe+W*He+$*We,e[6]=B*fe+V*He+te*We,e[7]=U*fe+X*He+de*We,e[8]=C*Ve+q*De+J*Ze,e[9]=z*Ve+W*De+$*Ze,e[10]=B*Ve+V*De+te*Ze,e[11]=U*Ve+X*De+de*Ze,l!==e&&(e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e)}function eu(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[4],F=l[5],C=l[6],z=l[7],B=l[8],U=l[9],q=l[10],W=l[11];return l!==e&&(e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[4]=M*L+B*P,e[5]=F*L+U*P,e[6]=C*L+q*P,e[7]=z*L+W*P,e[8]=B*L-M*P,e[9]=U*L-F*P,e[10]=q*L-C*P,e[11]=W*L-z*P,e}function tu(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[0],F=l[1],C=l[2],z=l[3],B=l[8],U=l[9],q=l[10],W=l[11];return l!==e&&(e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[0]=M*L-B*P,e[1]=F*L-U*P,e[2]=C*L-q*P,e[3]=z*L-W*P,e[8]=M*P+B*L,e[9]=F*P+U*L,e[10]=C*P+q*L,e[11]=z*P+W*L,e}function ru(e,l,A){var P=Math.sin(A),L=Math.cos(A),M=l[0],F=l[1],C=l[2],z=l[3],B=l[4],U=l[5],q=l[6],W=l[7];return l!==e&&(e[8]=l[8],e[9]=l[9],e[10]=l[10],e[11]=l[11],e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e[0]=M*L+B*P,e[1]=F*L+U*P,e[2]=C*L+q*P,e[3]=z*L+W*P,e[4]=B*L-M*P,e[5]=U*L-F*P,e[6]=q*L-C*P,e[7]=W*L-z*P,e}function iu(e,l){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=l[0],e[13]=l[1],e[14]=l[2],e[15]=1,e}function nu(e,l){return e[0]=l[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function au(e,l,A){var P,L,M,F=A[0],C=A[1],z=A[2],B=Math.hypot(F,C,z);return B<_?null:(F*=B=1/B,C*=B,z*=B,P=Math.sin(l),M=1-(L=Math.cos(l)),e[0]=F*F*M+L,e[1]=C*F*M+z*P,e[2]=z*F*M-C*P,e[3]=0,e[4]=F*C*M-z*P,e[5]=C*C*M+L,e[6]=z*C*M+F*P,e[7]=0,e[8]=F*z*M+C*P,e[9]=C*z*M-F*P,e[10]=z*z*M+L,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function su(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=P,e[6]=A,e[7]=0,e[8]=0,e[9]=-A,e[10]=P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ou(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=0,e[2]=-A,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=A,e[9]=0,e[10]=P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uu(e,l){var A=Math.sin(l),P=Math.cos(l);return e[0]=P,e[1]=A,e[2]=0,e[3]=0,e[4]=-A,e[5]=P,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Is(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=P+P,z=L+L,B=M+M,U=P*C,q=P*z,W=P*B,V=L*z,X=L*B,J=M*B,$=F*C,te=F*z,de=F*B;return e[0]=1-(V+J),e[1]=q+de,e[2]=W-te,e[3]=0,e[4]=q-de,e[5]=1-(U+J),e[6]=X+$,e[7]=0,e[8]=W+te,e[9]=X-$,e[10]=1-(U+V),e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function lu(e,l){var A=new p(3),P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=P*P+L*L+M*M+F*F;return q>0?(A[0]=2*(C*F+U*P+z*M-B*L)/q,A[1]=2*(z*F+U*L+B*P-C*M)/q,A[2]=2*(B*F+U*M+C*L-z*P)/q):(A[0]=2*(C*F+U*P+z*M-B*L),A[1]=2*(z*F+U*L+B*P-C*M),A[2]=2*(B*F+U*M+C*L-z*P)),Is(e,l,A),e}function Fs(e,l){return e[0]=l[12],e[1]=l[13],e[2]=l[14],e}function Cs(e,l){var A=l[0],P=l[1],L=l[2],M=l[4],F=l[5],C=l[6],z=l[8],B=l[9],U=l[10];return e[0]=Math.hypot(A,P,L),e[1]=Math.hypot(M,F,C),e[2]=Math.hypot(z,B,U),e}function Ns(e,l){var A=new p(3);Cs(A,l);var P=1/A[0],L=1/A[1],M=1/A[2],F=l[0]*P,C=l[1]*L,z=l[2]*M,B=l[4]*P,U=l[5]*L,q=l[6]*M,W=l[8]*P,V=l[9]*L,X=l[10]*M,J=F+U+X,$=0;return J>0?($=2*Math.sqrt(J+1),e[3]=.25*$,e[0]=(q-V)/$,e[1]=(W-z)/$,e[2]=(C-B)/$):F>U&&F>X?($=2*Math.sqrt(1+F-U-X),e[3]=(q-V)/$,e[0]=.25*$,e[1]=(C+B)/$,e[2]=(W+z)/$):U>X?($=2*Math.sqrt(1+U-F-X),e[3]=(W-z)/$,e[0]=(C+B)/$,e[1]=.25*$,e[2]=(q+V)/$):($=2*Math.sqrt(1+X-F-U),e[3]=(C-B)/$,e[0]=(W+z)/$,e[1]=(q+V)/$,e[2]=.25*$),e}function cu(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=l[3],z=L+L,B=M+M,U=F+F,q=L*z,W=L*B,V=L*U,X=M*B,J=M*U,$=F*U,te=C*z,de=C*B,ce=C*U,he=P[0],pe=P[1],fe=P[2];return e[0]=(1-(X+$))*he,e[1]=(W+ce)*he,e[2]=(V-de)*he,e[3]=0,e[4]=(W-ce)*pe,e[5]=(1-(q+$))*pe,e[6]=(J+te)*pe,e[7]=0,e[8]=(V+de)*fe,e[9]=(J-te)*fe,e[10]=(1-(q+X))*fe,e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e}function hu(e,l,A,P,L){var M=l[0],F=l[1],C=l[2],z=l[3],B=M+M,U=F+F,q=C+C,W=M*B,V=M*U,X=M*q,J=F*U,$=F*q,te=C*q,de=z*B,ce=z*U,he=z*q,pe=P[0],fe=P[1],He=P[2],We=L[0],Ve=L[1],De=L[2],Ze=(1-(J+te))*pe,Ie=(V+he)*pe,Fe=(X-ce)*pe,_e=(V-he)*fe,It=(1-(W+te))*fe,jr=($+de)*fe,kr=(X+ce)*He,Ac=($-de)*He,Sc=(1-(W+J))*He;return e[0]=Ze,e[1]=Ie,e[2]=Fe,e[3]=0,e[4]=_e,e[5]=It,e[6]=jr,e[7]=0,e[8]=kr,e[9]=Ac,e[10]=Sc,e[11]=0,e[12]=A[0]+We-(Ze*We+_e*Ve+kr*De),e[13]=A[1]+Ve-(Ie*We+It*Ve+Ac*De),e[14]=A[2]+De-(Fe*We+jr*Ve+Sc*De),e[15]=1,e}function du(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A+A,C=P+P,z=L+L,B=A*F,U=P*F,q=P*C,W=L*F,V=L*C,X=L*z,J=M*F,$=M*C,te=M*z;return e[0]=1-q-X,e[1]=U+te,e[2]=W-$,e[3]=0,e[4]=U-te,e[5]=1-B-X,e[6]=V+J,e[7]=0,e[8]=W+$,e[9]=V-J,e[10]=1-B-q,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fu(e,l,A,P,L,M,F){var C=1/(A-l),z=1/(L-P),B=1/(M-F);return e[0]=2*M*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*M*z,e[6]=0,e[7]=0,e[8]=(A+l)*C,e[9]=(L+P)*z,e[10]=(F+M)*B,e[11]=-1,e[12]=0,e[13]=0,e[14]=F*M*2*B,e[15]=0,e}function zs(e,l,A,P,L){var M,F=1/Math.tan(l/2);return e[0]=F/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=F,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(P-L),e[10]=(L+P)*M,e[14]=2*L*P*M):(e[10]=-1,e[14]=-2*P),e}var _u=zs;function pu(e,l,A,P,L){var M,F=1/Math.tan(l/2);return e[0]=F/A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=F,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,L!=null&&L!==1/0?(M=1/(P-L),e[10]=L*M,e[14]=L*P*M):(e[10]=-1,e[14]=-P),e}function vu(e,l,A,P){var L=Math.tan(l.upDegrees*Math.PI/180),M=Math.tan(l.downDegrees*Math.PI/180),F=Math.tan(l.leftDegrees*Math.PI/180),C=Math.tan(l.rightDegrees*Math.PI/180),z=2/(F+C),B=2/(L+M);return e[0]=z,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=B,e[6]=0,e[7]=0,e[8]=-(F-C)*z*.5,e[9]=(L-M)*B*.5,e[10]=P/(A-P),e[11]=-1,e[12]=0,e[13]=0,e[14]=P*A/(A-P),e[15]=0,e}function Bs(e,l,A,P,L,M,F){var C=1/(l-A),z=1/(P-L),B=1/(M-F);return e[0]=-2*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*B,e[11]=0,e[12]=(l+A)*C,e[13]=(L+P)*z,e[14]=(F+M)*B,e[15]=1,e}var mu=Bs;function gu(e,l,A,P,L,M,F){var C=1/(l-A),z=1/(P-L),B=1/(M-F);return e[0]=-2*C,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=B,e[11]=0,e[12]=(l+A)*C,e[13]=(L+P)*z,e[14]=M*B,e[15]=1,e}function bu(e,l,A,P){var L,M,F,C,z,B,U,q,W,V,X=l[0],J=l[1],$=l[2],te=P[0],de=P[1],ce=P[2],he=A[0],pe=A[1],fe=A[2];return Math.abs(X-he)<_&&Math.abs(J-pe)<_&&Math.abs($-fe)<_?Ls(e):(U=X-he,q=J-pe,W=$-fe,L=de*(W*=V=1/Math.hypot(U,q,W))-ce*(q*=V),M=ce*(U*=V)-te*W,F=te*q-de*U,(V=Math.hypot(L,M,F))?(L*=V=1/V,M*=V,F*=V):(L=0,M=0,F=0),C=q*F-W*M,z=W*L-U*F,B=U*M-q*L,(V=Math.hypot(C,z,B))?(C*=V=1/V,z*=V,B*=V):(C=0,z=0,B=0),e[0]=L,e[1]=C,e[2]=U,e[3]=0,e[4]=M,e[5]=z,e[6]=q,e[7]=0,e[8]=F,e[9]=B,e[10]=W,e[11]=0,e[12]=-(L*X+M*J+F*$),e[13]=-(C*X+z*J+B*$),e[14]=-(U*X+q*J+W*$),e[15]=1,e)}function yu(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=P[0],z=P[1],B=P[2],U=L-A[0],q=M-A[1],W=F-A[2],V=U*U+q*q+W*W;V>0&&(U*=V=1/Math.sqrt(V),q*=V,W*=V);var X=z*W-B*q,J=B*U-C*W,$=C*q-z*U;return(V=X*X+J*J+$*$)>0&&(X*=V=1/Math.sqrt(V),J*=V,$*=V),e[0]=X,e[1]=J,e[2]=$,e[3]=0,e[4]=q*$-W*J,e[5]=W*X-U*$,e[6]=U*J-q*X,e[7]=0,e[8]=U,e[9]=q,e[10]=W,e[11]=0,e[12]=L,e[13]=M,e[14]=F,e[15]=1,e}function Eu(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Tu(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xu(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e[8]=l[8]+A[8],e[9]=l[9]+A[9],e[10]=l[10]+A[10],e[11]=l[11]+A[11],e[12]=l[12]+A[12],e[13]=l[13]+A[13],e[14]=l[14]+A[14],e[15]=l[15]+A[15],e}function Ds(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e[4]=l[4]-A[4],e[5]=l[5]-A[5],e[6]=l[6]-A[6],e[7]=l[7]-A[7],e[8]=l[8]-A[8],e[9]=l[9]-A[9],e[10]=l[10]-A[10],e[11]=l[11]-A[11],e[12]=l[12]-A[12],e[13]=l[13]-A[13],e[14]=l[14]-A[14],e[15]=l[15]-A[15],e}function Au(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e[8]=l[8]*A,e[9]=l[9]*A,e[10]=l[10]*A,e[11]=l[11]*A,e[12]=l[12]*A,e[13]=l[13]*A,e[14]=l[14]*A,e[15]=l[15]*A,e}function Su(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e[4]=l[4]+A[4]*P,e[5]=l[5]+A[5]*P,e[6]=l[6]+A[6]*P,e[7]=l[7]+A[7]*P,e[8]=l[8]+A[8]*P,e[9]=l[9]+A[9]*P,e[10]=l[10]+A[10]*P,e[11]=l[11]+A[11]*P,e[12]=l[12]+A[12]*P,e[13]=l[13]+A[13]*P,e[14]=l[14]+A[14]*P,e[15]=l[15]+A[15]*P,e}function Ou(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]&&e[8]===l[8]&&e[9]===l[9]&&e[10]===l[10]&&e[11]===l[11]&&e[12]===l[12]&&e[13]===l[13]&&e[14]===l[14]&&e[15]===l[15]}function Ru(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=e[8],q=e[9],W=e[10],V=e[11],X=e[12],J=e[13],$=e[14],te=e[15],de=l[0],ce=l[1],he=l[2],pe=l[3],fe=l[4],He=l[5],We=l[6],Ve=l[7],De=l[8],Ze=l[9],Ie=l[10],Fe=l[11],_e=l[12],It=l[13],jr=l[14],kr=l[15];return Math.abs(A-de)<=_*Math.max(1,Math.abs(A),Math.abs(de))&&Math.abs(P-ce)<=_*Math.max(1,Math.abs(P),Math.abs(ce))&&Math.abs(L-he)<=_*Math.max(1,Math.abs(L),Math.abs(he))&&Math.abs(M-pe)<=_*Math.max(1,Math.abs(M),Math.abs(pe))&&Math.abs(F-fe)<=_*Math.max(1,Math.abs(F),Math.abs(fe))&&Math.abs(C-He)<=_*Math.max(1,Math.abs(C),Math.abs(He))&&Math.abs(z-We)<=_*Math.max(1,Math.abs(z),Math.abs(We))&&Math.abs(B-Ve)<=_*Math.max(1,Math.abs(B),Math.abs(Ve))&&Math.abs(U-De)<=_*Math.max(1,Math.abs(U),Math.abs(De))&&Math.abs(q-Ze)<=_*Math.max(1,Math.abs(q),Math.abs(Ze))&&Math.abs(W-Ie)<=_*Math.max(1,Math.abs(W),Math.abs(Ie))&&Math.abs(V-Fe)<=_*Math.max(1,Math.abs(V),Math.abs(Fe))&&Math.abs(X-_e)<=_*Math.max(1,Math.abs(X),Math.abs(_e))&&Math.abs(J-It)<=_*Math.max(1,Math.abs(J),Math.abs(It))&&Math.abs($-jr)<=_*Math.max(1,Math.abs($),Math.abs(jr))&&Math.abs(te-kr)<=_*Math.max(1,Math.abs(te),Math.abs(kr))}var wu=Ms,Pu=Ds;function Br(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Lu(e){var l=new p(3);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l}function js(e){var l=e[0],A=e[1],P=e[2];return Math.hypot(l,A,P)}function Dr(e,l,A){var P=new p(3);return P[0]=e,P[1]=l,P[2]=A,P}function Mu(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e}function Iu(e,l,A,P){return e[0]=l,e[1]=A,e[2]=P,e}function Fu(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e}function ks(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e}function Us(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e[2]=l[2]*A[2],e}function Gs(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e[2]=l[2]/A[2],e}function Cu(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e[2]=Math.ceil(l[2]),e}function Nu(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e[2]=Math.floor(l[2]),e}function Xt(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e[2]=Math.min(l[2],A[2]),e}function Yt(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e[2]=Math.max(l[2],A[2]),e}function Pt(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e[2]=Math.round(l[2]),e}function qt(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e}function H_(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e}function Il(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2];return Math.hypot(A,P,L)}function Fl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2];return A*A+P*P+L*L}function Cl(e){var l=e[0],A=e[1],P=e[2];return l*l+A*A+P*P}function X_(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e}function Y_(e,l){return e[0]=1/l[0],e[1]=1/l[1],e[2]=1/l[2],e}function Nl(e,l){var A=l[0],P=l[1],L=l[2],M=A*A+P*P+L*L;return M>0&&(M=1/Math.sqrt(M)),e[0]=l[0]*M,e[1]=l[1]*M,e[2]=l[2]*M,e}function zu(e,l){return e[0]*l[0]+e[1]*l[1]+e[2]*l[2]}function qs(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[0],C=A[1],z=A[2];return e[0]=L*z-M*C,e[1]=M*F-P*z,e[2]=P*C-L*F,e}function Z_(e,l,A,P){var L=l[0],M=l[1],F=l[2];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e[2]=F+P*(A[2]-F),e}function K_(e,l,A,P,L,M){var F=M*M,C=F*(2*M-3)+1,z=F*(M-2)+M,B=F*(M-1),U=F*(3-2*M);return e[0]=l[0]*C+A[0]*z+P[0]*B+L[0]*U,e[1]=l[1]*C+A[1]*z+P[1]*B+L[1]*U,e[2]=l[2]*C+A[2]*z+P[2]*B+L[2]*U,e}function Q_(e,l,A,P,L,M){var F=1-M,C=F*F,z=M*M,B=C*F,U=3*M*C,q=3*z*F,W=z*M;return e[0]=l[0]*B+A[0]*U+P[0]*q+L[0]*W,e[1]=l[1]*B+A[1]*U+P[1]*q+L[1]*W,e[2]=l[2]*B+A[2]*U+P[2]*q+L[2]*W,e}function J_(e,l){l=l||1;var A=2*b()*Math.PI,P=2*b()-1,L=Math.sqrt(1-P*P)*l;return e[0]=Math.cos(A)*L,e[1]=Math.sin(A)*L,e[2]=P*l,e}function e1(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[3]*P+A[7]*L+A[11]*M+A[15];return F=F||1,e[0]=(A[0]*P+A[4]*L+A[8]*M+A[12])/F,e[1]=(A[1]*P+A[5]*L+A[9]*M+A[13])/F,e[2]=(A[2]*P+A[6]*L+A[10]*M+A[14])/F,e}function t1(e,l,A){var P=l[0],L=l[1],M=l[2];return e[0]=P*A[0]+L*A[3]+M*A[6],e[1]=P*A[1]+L*A[4]+M*A[7],e[2]=P*A[2]+L*A[5]+M*A[8],e}function r1(e,l,A){var P=A[0],L=A[1],M=A[2],F=A[3],C=l[0],z=l[1],B=l[2],U=L*B-M*z,q=M*C-P*B,W=P*z-L*C,V=L*W-M*q,X=M*U-P*W,J=P*q-L*U,$=2*F;return U*=$,q*=$,W*=$,V*=2,X*=2,J*=2,e[0]=C+U+V,e[1]=z+q+X,e[2]=B+W+J,e}function i1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[0],M[1]=L[1]*Math.cos(P)-L[2]*Math.sin(P),M[2]=L[1]*Math.sin(P)+L[2]*Math.cos(P),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function n1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[2]*Math.sin(P)+L[0]*Math.cos(P),M[1]=L[1],M[2]=L[2]*Math.cos(P)-L[0]*Math.sin(P),e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function a1(e,l,A,P){var L=[],M=[];return L[0]=l[0]-A[0],L[1]=l[1]-A[1],L[2]=l[2]-A[2],M[0]=L[0]*Math.cos(P)-L[1]*Math.sin(P),M[1]=L[0]*Math.sin(P)+L[1]*Math.cos(P),M[2]=L[2],e[0]=M[0]+A[0],e[1]=M[1]+A[1],e[2]=M[2]+A[2],e}function s1(e,l){var A=e[0],P=e[1],L=e[2],M=l[0],F=l[1],C=l[2],z=Math.sqrt(A*A+P*P+L*L)*Math.sqrt(M*M+F*F+C*C),B=z&&zu(e,l)/z;return Math.acos(Math.min(Math.max(B,-1),1))}function o1(e){return e[0]=0,e[1]=0,e[2]=0,e}function u1(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function l1(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]}function c1(e,l){var A=e[0],P=e[1],L=e[2],M=l[0],F=l[1],C=l[2];return Math.abs(A-M)<=_*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(P-F)<=_*Math.max(1,Math.abs(P),Math.abs(F))&&Math.abs(L-C)<=_*Math.max(1,Math.abs(L),Math.abs(C))}var Wt,h1=ks,d1=Us,f1=Gs,_1=Il,p1=Fl,zl=js,v1=Cl,m1=(Wt=Br(),function(e,l,A,P,L,M){var F,C;for(l||(l=3),A||(A=0),C=P?Math.min(P*l+A,e.length):e.length,F=A;F<C;F+=l)Wt[0]=e[F],Wt[1]=e[F+1],Wt[2]=e[F+2],L(Wt,Wt,M),e[F]=Wt[0],e[F+1]=Wt[1],e[F+2]=Wt[2];return e});function Bl(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Dl(e){var l=new p(4);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l}function jl(e,l,A,P){var L=new p(4);return L[0]=e,L[1]=l,L[2]=A,L[3]=P,L}function kl(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e}function Ul(e,l,A,P,L){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e}function Gl(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e}function ql(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e[2]=l[2]-A[2],e[3]=l[3]-A[3],e}function Wl(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e[2]=l[2]*A[2],e[3]=l[3]*A[3],e}function Vl(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e[2]=l[2]/A[2],e[3]=l[3]/A[3],e}function g1(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e[2]=Math.ceil(l[2]),e[3]=Math.ceil(l[3]),e}function b1(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e[2]=Math.floor(l[2]),e[3]=Math.floor(l[3]),e}function y1(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e[2]=Math.min(l[2],A[2]),e[3]=Math.min(l[3],A[3]),e}function E1(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e[2]=Math.max(l[2],A[2]),e[3]=Math.max(l[3],A[3]),e}function T1(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e[2]=Math.round(l[2]),e[3]=Math.round(l[3]),e}function $l(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e}function x1(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e[2]=l[2]+A[2]*P,e[3]=l[3]+A[3]*P,e}function Hl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2],M=l[3]-e[3];return Math.hypot(A,P,L,M)}function Xl(e,l){var A=l[0]-e[0],P=l[1]-e[1],L=l[2]-e[2],M=l[3]-e[3];return A*A+P*P+L*L+M*M}function Bu(e){var l=e[0],A=e[1],P=e[2],L=e[3];return Math.hypot(l,A,P,L)}function Du(e){var l=e[0],A=e[1],P=e[2],L=e[3];return l*l+A*A+P*P+L*L}function A1(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=-l[3],e}function S1(e,l){return e[0]=1/l[0],e[1]=1/l[1],e[2]=1/l[2],e[3]=1/l[3],e}function Yl(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*A+P*P+L*L+M*M;return F>0&&(F=1/Math.sqrt(F)),e[0]=A*F,e[1]=P*F,e[2]=L*F,e[3]=M*F,e}function Zl(e,l){return e[0]*l[0]+e[1]*l[1]+e[2]*l[2]+e[3]*l[3]}function O1(e,l,A,P){var L=A[0]*P[1]-A[1]*P[0],M=A[0]*P[2]-A[2]*P[0],F=A[0]*P[3]-A[3]*P[0],C=A[1]*P[2]-A[2]*P[1],z=A[1]*P[3]-A[3]*P[1],B=A[2]*P[3]-A[3]*P[2],U=l[0],q=l[1],W=l[2],V=l[3];return e[0]=q*B-W*z+V*C,e[1]=-U*B+W*F-V*M,e[2]=U*z-q*F+V*L,e[3]=-U*C+q*M-W*L,e}function Kl(e,l,A,P){var L=l[0],M=l[1],F=l[2],C=l[3];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e[2]=F+P*(A[2]-F),e[3]=C+P*(A[3]-C),e}function R1(e,l){var A,P,L,M,F,C;l=l||1;do F=(A=2*b()-1)*A+(P=2*b()-1)*P;while(F>=1);do C=(L=2*b()-1)*L+(M=2*b()-1)*M;while(C>=1);var z=Math.sqrt((1-F)/C);return e[0]=l*A,e[1]=l*P,e[2]=l*L*z,e[3]=l*M*z,e}function w1(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3];return e[0]=A[0]*P+A[4]*L+A[8]*M+A[12]*F,e[1]=A[1]*P+A[5]*L+A[9]*M+A[13]*F,e[2]=A[2]*P+A[6]*L+A[10]*M+A[14]*F,e[3]=A[3]*P+A[7]*L+A[11]*M+A[15]*F,e}function P1(e,l,A){var P=l[0],L=l[1],M=l[2],F=A[0],C=A[1],z=A[2],B=A[3],U=B*P+C*M-z*L,q=B*L+z*P-F*M,W=B*M+F*L-C*P,V=-F*P-C*L-z*M;return e[0]=U*B+V*-F+q*-z-W*-C,e[1]=q*B+V*-C+W*-F-U*-z,e[2]=W*B+V*-z+U*-C-q*-F,e[3]=l[3],e}function L1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function M1(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ql(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]}function Jl(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=l[0],C=l[1],z=l[2],B=l[3];return Math.abs(A-F)<=_*Math.max(1,Math.abs(A),Math.abs(F))&&Math.abs(P-C)<=_*Math.max(1,Math.abs(P),Math.abs(C))&&Math.abs(L-z)<=_*Math.max(1,Math.abs(L),Math.abs(z))&&Math.abs(M-B)<=_*Math.max(1,Math.abs(M),Math.abs(B))}var I1=ql,F1=Wl,C1=Vl,N1=Hl,z1=Xl,B1=Bu,D1=Du,j1=function(){var e=Bl();return function(l,A,P,L,M,F){var C,z;for(A||(A=4),P||(P=0),z=L?Math.min(L*A+P,l.length):l.length,C=P;C<z;C+=A)e[0]=l[C],e[1]=l[C+1],e[2]=l[C+2],e[3]=l[C+3],M(e,e,F),l[C]=e[0],l[C+1]=e[1],l[C+2]=e[2],l[C+3]=e[3];return l}}();function Ws(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function k1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ec(e,l,A){A*=.5;var P=Math.sin(A);return e[0]=P*l[0],e[1]=P*l[1],e[2]=P*l[2],e[3]=Math.cos(A),e}function U1(e,l){var A=2*Math.acos(l[3]),P=Math.sin(A/2);return P>_?(e[0]=l[0]/P,e[1]=l[1]/P,e[2]=l[2]/P):(e[0]=1,e[1]=0,e[2]=0),A}function G1(e,l){var A=Gu(e,l);return Math.acos(2*A*A-1)}function tc(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*U+F*C+L*B-M*z,e[1]=L*U+F*z+M*C-P*B,e[2]=M*U+F*B+P*z-L*C,e[3]=F*U-P*C-L*z-M*B,e}function rc(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+F*C,e[1]=L*z+M*C,e[2]=M*z-L*C,e[3]=F*z-P*C,e}function ic(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z-M*C,e[1]=L*z+F*C,e[2]=M*z+P*C,e[3]=F*z-L*C,e}function nc(e,l,A){A*=.5;var P=l[0],L=l[1],M=l[2],F=l[3],C=Math.sin(A),z=Math.cos(A);return e[0]=P*z+L*C,e[1]=L*z-P*C,e[2]=M*z+F*C,e[3]=F*z-M*C,e}function q1(e,l){var A=l[0],P=l[1],L=l[2];return e[0]=A,e[1]=P,e[2]=L,e[3]=Math.sqrt(Math.abs(1-A*A-P*P-L*L)),e}function ac(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=Math.sqrt(A*A+P*P+L*L),C=Math.exp(M),z=F>0?C*Math.sin(F)/F:0;return e[0]=A*z,e[1]=P*z,e[2]=L*z,e[3]=C*Math.cos(F),e}function sc(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=Math.sqrt(A*A+P*P+L*L),C=F>0?Math.atan2(F,M)/F:0;return e[0]=A*C,e[1]=P*C,e[2]=L*C,e[3]=.5*Math.log(A*A+P*P+L*L+M*M),e}function W1(e,l,A){return sc(e,l),cc(e,e,A),ac(e,e),e}function Vs(e,l,A,P){var L,M,F,C,z,B=l[0],U=l[1],q=l[2],W=l[3],V=A[0],X=A[1],J=A[2],$=A[3];return(M=B*V+U*X+q*J+W*$)<0&&(M=-M,V=-V,X=-X,J=-J,$=-$),1-M>_?(L=Math.acos(M),F=Math.sin(L),C=Math.sin((1-P)*L)/F,z=Math.sin(P*L)/F):(C=1-P,z=P),e[0]=C*B+z*V,e[1]=C*U+z*X,e[2]=C*q+z*J,e[3]=C*W+z*$,e}function V1(e){var l=b(),A=b(),P=b(),L=Math.sqrt(1-l),M=Math.sqrt(l);return e[0]=L*Math.sin(2*Math.PI*A),e[1]=L*Math.cos(2*Math.PI*A),e[2]=M*Math.sin(2*Math.PI*P),e[3]=M*Math.cos(2*Math.PI*P),e}function $1(e,l){var A=l[0],P=l[1],L=l[2],M=l[3],F=A*A+P*P+L*L+M*M,C=F?1/F:0;return e[0]=-A*C,e[1]=-P*C,e[2]=-L*C,e[3]=M*C,e}function H1(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=l[3],e}function oc(e,l){var A,P=l[0]+l[4]+l[8];if(P>0)A=Math.sqrt(P+1),e[3]=.5*A,A=.5/A,e[0]=(l[5]-l[7])*A,e[1]=(l[6]-l[2])*A,e[2]=(l[1]-l[3])*A;else{var L=0;l[4]>l[0]&&(L=1),l[8]>l[3*L+L]&&(L=2);var M=(L+1)%3,F=(L+2)%3;A=Math.sqrt(l[3*L+L]-l[3*M+M]-l[3*F+F]+1),e[L]=.5*A,A=.5/A,e[3]=(l[3*M+F]-l[3*F+M])*A,e[M]=(l[3*M+L]+l[3*L+M])*A,e[F]=(l[3*F+L]+l[3*L+F])*A}return e}function X1(e,l,A,P){var L=.5*Math.PI/180;l*=L,A*=L,P*=L;var M=Math.sin(l),F=Math.cos(l),C=Math.sin(A),z=Math.cos(A),B=Math.sin(P),U=Math.cos(P);return e[0]=M*z*U-F*C*B,e[1]=F*C*U+M*z*B,e[2]=F*z*B-M*C*U,e[3]=F*z*U+M*C*B,e}function Y1(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Lt,uc,lc,ju,ku,Mt,Z1=Dl,K1=jl,Uu=kl,Q1=Ul,J1=Gl,ep=tc,cc=$l,Gu=Zl,tp=Kl,qu=Bu,rp=qu,Wu=Du,ip=Wu,Vu=Yl,np=Ql,ap=Jl,sp=(Lt=Br(),uc=Dr(1,0,0),lc=Dr(0,1,0),function(e,l,A){var P=zu(l,A);return P<-.999999?(qs(Lt,uc,l),zl(Lt)<1e-6&&qs(Lt,lc,l),Nl(Lt,Lt),ec(e,Lt,Math.PI),e):P>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(qs(Lt,l,A),e[0]=Lt[0],e[1]=Lt[1],e[2]=Lt[2],e[3]=1+P,Vu(e,e))}),op=(ju=Ws(),ku=Ws(),function(e,l,A,P,L,M){return Vs(ju,l,L,M),Vs(ku,A,P,M),Vs(e,ju,ku,2*M*(1-M)),e}),up=(Mt=Ue(),function(e,l,A,P){return Mt[0]=A[0],Mt[3]=A[1],Mt[6]=A[2],Mt[1]=P[0],Mt[4]=P[1],Mt[7]=P[2],Mt[2]=-l[0],Mt[5]=-l[1],Mt[8]=-l[2],Vu(e,oc(e,Mt))});function lp(){var e=new p(8);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function cp(e){var l=new p(8);return l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3],l[4]=e[4],l[5]=e[5],l[6]=e[6],l[7]=e[7],l}function hp(e,l,A,P,L,M,F,C){var z=new p(8);return z[0]=e,z[1]=l,z[2]=A,z[3]=P,z[4]=L,z[5]=M,z[6]=F,z[7]=C,z}function dp(e,l,A,P,L,M,F){var C=new p(8);C[0]=e,C[1]=l,C[2]=A,C[3]=P;var z=.5*L,B=.5*M,U=.5*F;return C[4]=z*P+B*A-U*l,C[5]=B*P+U*e-z*A,C[6]=U*P+z*l-B*e,C[7]=-z*e-B*l-U*A,C}function hc(e,l,A){var P=.5*A[0],L=.5*A[1],M=.5*A[2],F=l[0],C=l[1],z=l[2],B=l[3];return e[0]=F,e[1]=C,e[2]=z,e[3]=B,e[4]=P*B+L*z-M*C,e[5]=L*B+M*F-P*z,e[6]=M*B+P*C-L*F,e[7]=-P*F-L*C-M*z,e}function fp(e,l){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*l[0],e[5]=.5*l[1],e[6]=.5*l[2],e[7]=0,e}function _p(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function pp(e,l){var A=Ws();Ns(A,l);var P=new p(3);return Fs(P,l),hc(e,A,P),e}function dc(e,l){return e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],e[4]=l[4],e[5]=l[5],e[6]=l[6],e[7]=l[7],e}function vp(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function mp(e,l,A,P,L,M,F,C,z){return e[0]=l,e[1]=A,e[2]=P,e[3]=L,e[4]=M,e[5]=F,e[6]=C,e[7]=z,e}var gp=Uu;function bp(e,l){return e[0]=l[4],e[1]=l[5],e[2]=l[6],e[3]=l[7],e}var yp=Uu;function Ep(e,l){return e[4]=l[0],e[5]=l[1],e[6]=l[2],e[7]=l[3],e}function Tp(e,l){var A=l[4],P=l[5],L=l[6],M=l[7],F=-l[0],C=-l[1],z=-l[2],B=l[3];return e[0]=2*(A*B+M*F+P*z-L*C),e[1]=2*(P*B+M*C+L*F-A*z),e[2]=2*(L*B+M*z+A*C-P*F),e}function xp(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=.5*A[0],z=.5*A[1],B=.5*A[2],U=l[4],q=l[5],W=l[6],V=l[7];return e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=F*C+L*B-M*z+U,e[5]=F*z+M*C-P*B+q,e[6]=F*B+P*z-L*C+W,e[7]=-P*C-L*z-M*B+V,e}function Ap(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return rc(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Sp(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return ic(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Op(e,l,A){var P=-l[0],L=-l[1],M=-l[2],F=l[3],C=l[4],z=l[5],B=l[6],U=l[7],q=C*F+U*P+z*M-B*L,W=z*F+U*L+B*P-C*M,V=B*F+U*M+C*L-z*P,X=U*F-C*P-z*L-B*M;return nc(e,l,A),P=e[0],L=e[1],M=e[2],F=e[3],e[4]=q*F+X*P+W*M-V*L,e[5]=W*F+X*L+V*P-q*M,e[6]=V*F+X*M+q*L-W*P,e[7]=X*F-q*P-W*L-V*M,e}function Rp(e,l,A){var P=A[0],L=A[1],M=A[2],F=A[3],C=l[0],z=l[1],B=l[2],U=l[3];return e[0]=C*F+U*P+z*M-B*L,e[1]=z*F+U*L+B*P-C*M,e[2]=B*F+U*M+C*L-z*P,e[3]=U*F-C*P-z*L-B*M,C=l[4],z=l[5],B=l[6],U=l[7],e[4]=C*F+U*P+z*M-B*L,e[5]=z*F+U*L+B*P-C*M,e[6]=B*F+U*M+C*L-z*P,e[7]=U*F-C*P-z*L-B*M,e}function wp(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[0],z=A[1],B=A[2],U=A[3];return e[0]=P*U+F*C+L*B-M*z,e[1]=L*U+F*z+M*C-P*B,e[2]=M*U+F*B+P*z-L*C,e[3]=F*U-P*C-L*z-M*B,C=A[4],z=A[5],B=A[6],U=A[7],e[4]=P*U+F*C+L*B-M*z,e[5]=L*U+F*z+M*C-P*B,e[6]=M*U+F*B+P*z-L*C,e[7]=F*U-P*C-L*z-M*B,e}function Pp(e,l,A,P){if(Math.abs(P)<_)return dc(e,l);var L=Math.hypot(A[0],A[1],A[2]);P*=.5;var M=Math.sin(P),F=M*A[0]/L,C=M*A[1]/L,z=M*A[2]/L,B=Math.cos(P),U=l[0],q=l[1],W=l[2],V=l[3];e[0]=U*B+V*F+q*z-W*C,e[1]=q*B+V*C+W*F-U*z,e[2]=W*B+V*z+U*C-q*F,e[3]=V*B-U*F-q*C-W*z;var X=l[4],J=l[5],$=l[6],te=l[7];return e[4]=X*B+te*F+J*z-$*C,e[5]=J*B+te*C+$*F-X*z,e[6]=$*B+te*z+X*C-J*F,e[7]=te*B-X*F-J*C-$*z,e}function Lp(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e[2]=l[2]+A[2],e[3]=l[3]+A[3],e[4]=l[4]+A[4],e[5]=l[5]+A[5],e[6]=l[6]+A[6],e[7]=l[7]+A[7],e}function fc(e,l,A){var P=l[0],L=l[1],M=l[2],F=l[3],C=A[4],z=A[5],B=A[6],U=A[7],q=l[4],W=l[5],V=l[6],X=l[7],J=A[0],$=A[1],te=A[2],de=A[3];return e[0]=P*de+F*J+L*te-M*$,e[1]=L*de+F*$+M*J-P*te,e[2]=M*de+F*te+P*$-L*J,e[3]=F*de-P*J-L*$-M*te,e[4]=P*U+F*C+L*B-M*z+q*de+X*J+W*te-V*$,e[5]=L*U+F*z+M*C-P*B+W*de+X*$+V*J-q*te,e[6]=M*U+F*B+P*z-L*C+V*de+X*te+q*$-W*J,e[7]=F*U-P*C-L*z-M*B+X*de-q*J-W*$-V*te,e}var Mp=fc;function Ip(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e[2]=l[2]*A,e[3]=l[3]*A,e[4]=l[4]*A,e[5]=l[5]*A,e[6]=l[6]*A,e[7]=l[7]*A,e}var _c=Gu;function Fp(e,l,A,P){var L=1-P;return _c(l,A)<0&&(P=-P),e[0]=l[0]*L+A[0]*P,e[1]=l[1]*L+A[1]*P,e[2]=l[2]*L+A[2]*P,e[3]=l[3]*L+A[3]*P,e[4]=l[4]*L+A[4]*P,e[5]=l[5]*L+A[5]*P,e[6]=l[6]*L+A[6]*P,e[7]=l[7]*L+A[7]*P,e}function Cp(e,l){var A=$s(l);return e[0]=-l[0]/A,e[1]=-l[1]/A,e[2]=-l[2]/A,e[3]=l[3]/A,e[4]=-l[4]/A,e[5]=-l[5]/A,e[6]=-l[6]/A,e[7]=l[7]/A,e}function Np(e,l){return e[0]=-l[0],e[1]=-l[1],e[2]=-l[2],e[3]=l[3],e[4]=-l[4],e[5]=-l[5],e[6]=-l[6],e[7]=l[7],e}var pc=qu,zp=pc,$s=Wu,Bp=$s;function Dp(e,l){var A=$s(l);if(A>0){A=Math.sqrt(A);var P=l[0]/A,L=l[1]/A,M=l[2]/A,F=l[3]/A,C=l[4],z=l[5],B=l[6],U=l[7],q=P*C+L*z+M*B+F*U;e[0]=P,e[1]=L,e[2]=M,e[3]=F,e[4]=(C-P*q)/A,e[5]=(z-L*q)/A,e[6]=(B-M*q)/A,e[7]=(U-F*q)/A}return e}function jp(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function kp(e,l){return e[0]===l[0]&&e[1]===l[1]&&e[2]===l[2]&&e[3]===l[3]&&e[4]===l[4]&&e[5]===l[5]&&e[6]===l[6]&&e[7]===l[7]}function Up(e,l){var A=e[0],P=e[1],L=e[2],M=e[3],F=e[4],C=e[5],z=e[6],B=e[7],U=l[0],q=l[1],W=l[2],V=l[3],X=l[4],J=l[5],$=l[6],te=l[7];return Math.abs(A-U)<=_*Math.max(1,Math.abs(A),Math.abs(U))&&Math.abs(P-q)<=_*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(L-W)<=_*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(M-V)<=_*Math.max(1,Math.abs(M),Math.abs(V))&&Math.abs(F-X)<=_*Math.max(1,Math.abs(F),Math.abs(X))&&Math.abs(C-J)<=_*Math.max(1,Math.abs(C),Math.abs(J))&&Math.abs(z-$)<=_*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(B-te)<=_*Math.max(1,Math.abs(B),Math.abs(te))}function vc(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function Gp(e){var l=new p(2);return l[0]=e[0],l[1]=e[1],l}function qp(e,l){var A=new p(2);return A[0]=e,A[1]=l,A}function Wp(e,l){return e[0]=l[0],e[1]=l[1],e}function Vp(e,l,A){return e[0]=l,e[1]=A,e}function $p(e,l,A){return e[0]=l[0]+A[0],e[1]=l[1]+A[1],e}function mc(e,l,A){return e[0]=l[0]-A[0],e[1]=l[1]-A[1],e}function gc(e,l,A){return e[0]=l[0]*A[0],e[1]=l[1]*A[1],e}function bc(e,l,A){return e[0]=l[0]/A[0],e[1]=l[1]/A[1],e}function Hp(e,l){return e[0]=Math.ceil(l[0]),e[1]=Math.ceil(l[1]),e}function Xp(e,l){return e[0]=Math.floor(l[0]),e[1]=Math.floor(l[1]),e}function Yp(e,l,A){return e[0]=Math.min(l[0],A[0]),e[1]=Math.min(l[1],A[1]),e}function Zp(e,l,A){return e[0]=Math.max(l[0],A[0]),e[1]=Math.max(l[1],A[1]),e}function Kp(e,l){return e[0]=Math.round(l[0]),e[1]=Math.round(l[1]),e}function Qp(e,l,A){return e[0]=l[0]*A,e[1]=l[1]*A,e}function Jp(e,l,A,P){return e[0]=l[0]+A[0]*P,e[1]=l[1]+A[1]*P,e}function yc(e,l){var A=l[0]-e[0],P=l[1]-e[1];return Math.hypot(A,P)}function Ec(e,l){var A=l[0]-e[0],P=l[1]-e[1];return A*A+P*P}function Tc(e){var l=e[0],A=e[1];return Math.hypot(l,A)}function xc(e){var l=e[0],A=e[1];return l*l+A*A}function ev(e,l){return e[0]=-l[0],e[1]=-l[1],e}function tv(e,l){return e[0]=1/l[0],e[1]=1/l[1],e}function rv(e,l){var A=l[0],P=l[1],L=A*A+P*P;return L>0&&(L=1/Math.sqrt(L)),e[0]=l[0]*L,e[1]=l[1]*L,e}function iv(e,l){return e[0]*l[0]+e[1]*l[1]}function nv(e,l,A){var P=l[0]*A[1]-l[1]*A[0];return e[0]=e[1]=0,e[2]=P,e}function av(e,l,A,P){var L=l[0],M=l[1];return e[0]=L+P*(A[0]-L),e[1]=M+P*(A[1]-M),e}function sv(e,l){l=l||1;var A=2*b()*Math.PI;return e[0]=Math.cos(A)*l,e[1]=Math.sin(A)*l,e}function ov(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[2]*L,e[1]=A[1]*P+A[3]*L,e}function uv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[2]*L+A[4],e[1]=A[1]*P+A[3]*L+A[5],e}function lv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[3]*L+A[6],e[1]=A[1]*P+A[4]*L+A[7],e}function cv(e,l,A){var P=l[0],L=l[1];return e[0]=A[0]*P+A[4]*L+A[12],e[1]=A[1]*P+A[5]*L+A[13],e}function hv(e,l,A,P){var L=l[0]-A[0],M=l[1]-A[1],F=Math.sin(P),C=Math.cos(P);return e[0]=L*C-M*F+A[0],e[1]=L*F+M*C+A[1],e}function dv(e,l){var A=e[0],P=e[1],L=l[0],M=l[1],F=Math.sqrt(A*A+P*P)*Math.sqrt(L*L+M*M),C=F&&(A*L+P*M)/F;return Math.acos(Math.min(Math.max(C,-1),1))}function fv(e){return e[0]=0,e[1]=0,e}function _v(e){return"vec2("+e[0]+", "+e[1]+")"}function pv(e,l){return e[0]===l[0]&&e[1]===l[1]}function vv(e,l){var A=e[0],P=e[1],L=l[0],M=l[1];return Math.abs(A-L)<=_*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(P-M)<=_*Math.max(1,Math.abs(P),Math.abs(M))}var mv=Tc,gv=mc,bv=gc,yv=bc,Ev=yc,Tv=Ec,xv=xc,Av=function(){var e=vc();return function(l,A,P,L,M,F){var C,z;for(A||(A=2),P||(P=0),z=L?Math.min(L*A+P,l.length):l.length,C=P;C<z;C+=A)e[0]=l[C],e[1]=l[C+1],M(e,e,F),l[C]=e[0],l[C+1]=e[1];return l}}()},4613:v=>{v.exports=function(t){var i={};function n(r){if(i[r])return i[r].exports;var c=i[r]={i:r,l:!1,exports:{}};return t[r].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=t,n.c=i,n.d=function(r,c,f){n.o(r,c)||Object.defineProperty(r,c,{enumerable:!0,get:f})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,c){if(1&c&&(r=n(r)),8&c||4&c&&typeof r=="object"&&r&&r.__esModule)return r;var f=Object.create(null);if(n.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:r}),2&c&&typeof r!="string")for(var d in r)n.d(f,d,(function(h){return r[h]}).bind(null,d));return f},n.n=function(r){var c=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(c,"a",c),c},n.o=function(r,c){return Object.prototype.hasOwnProperty.call(r,c)},n.p="",n(n.s=7)}([function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(r){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(r,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(r){this.itemsLoaded++,this.onProgress&&this.onProgress(r,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(r){this.onError&&this.onError(r)}resolveURL(r){return this.urlModifier?this.urlModifier(r):r}}},function(t,i,n){var r=this&&this.__awaiter||function(u,o,m,_){return new(m||(m=Promise))(function(p,b){function x(S){try{w(_.next(S))}catch(R){b(R)}}function E(S){try{w(_.throw(S))}catch(R){b(R)}}function w(S){S.done?p(S.value):new m(function(R){R(S.value)}).then(x,E)}w((_=_.apply(u,o||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const c=n(3),f=n(0);i.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},i.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i.GltfAsset=class{constructor(u,o,m,_=new f.LoadingManager){this.gltf=u,this.glbData=m,this.bufferData=new d(this,o,_),this.imageData=new h(this,o,_)}bufferViewData(u){return r(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const o=this.gltf.bufferViews[u],m=yield this.bufferData.get(o.buffer),_=o.byteLength||0,p=o.byteOffset||0,b=m.buffer,x=m.byteOffset;return new Uint8Array(b,x+p,_)})}accessorData(u){return r(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const o=this.gltf.accessors[u],m=i.GLTF_ELEMENTS_PER_TYPE[o.type];let _;if(o.bufferView!==void 0)_=yield this.bufferViewData(o.bufferView);else{const p=i.GLTF_COMPONENT_TYPE_ARRAYS[o.componentType].BYTES_PER_ELEMENT*m*o.count;_=new Uint8Array(p)}if(o.sparse){const{count:p,indices:b,values:x}=o.sparse;let E=i.GLTF_COMPONENT_TYPE_ARRAYS[b.componentType],w=yield this.bufferViewData(b.bufferView);const S=new E(w.buffer,w.byteOffset+(b.byteOffset||0),p);E=i.GLTF_COMPONENT_TYPE_ARRAYS[o.componentType],w=yield this.bufferViewData(x.bufferView);const R=new E((yield this.bufferViewData(x.bufferView)).buffer,w.byteOffset+(x.byteOffset||0),p*m);o.bufferView&&(_=new Uint8Array(_));const O=new i.GLTF_COMPONENT_TYPE_ARRAYS[o.componentType](_.buffer);for(let I=0;I<p;I++)for(let D=0;D<m;D++)O[m*S[I]+D]=R[m*I+D]}return _})}preFetchAll(){return r(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class d{constructor(o,m,_){this.bufferCache=[],this.asset=o,this.baseUri=m,this.manager=_,this.loader=new c.FileLoader(_),this.loader.responseType="arraybuffer"}get(o){return r(this,void 0,void 0,function*(){if(this.bufferCache[o]!==void 0)return this.bufferCache[o];const m=this.asset.gltf;if(!m.buffers)throw new Error("No buffers found.");const _=m.buffers[o];if(_.uri===void 0){if(o!==0)throw new Error("GLB container is required to be the first buffer");if(this.asset.glbData===void 0)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const p=s(_.uri,this.baseUri),b=yield this.loader.load(p),x=new Uint8Array(b);return this.bufferCache[o]=x,x})}preFetchAll(){return r(this,void 0,void 0,function*(){const o=this.asset.gltf.buffers;return o?Promise.all(o.map((m,_)=>this.get(_))):[]})}}i.BufferData=d;class h{constructor(o,m,_){this.crossOrigin="anonymous",this.imageCache=[],this.asset=o,this.baseUri=m,this.manager=_}get(o){return r(this,void 0,void 0,function*(){if(this.imageCache[o]!==void 0)return this.imageCache[o];const m=this.asset.gltf;if(!m.images)throw new Error("No images found.");const _=m.images[o];let p,b=!1;if(_.bufferView!==void 0){const E=yield this.asset.bufferViewData(_.bufferView);b=!0;const w=new Blob([E],{type:_.mimeType});p=URL.createObjectURL(w)}else{if(_.uri===void 0)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");p=this.manager.resolveURL(s(_.uri,this.baseUri))}const x=new Image;return x.crossOrigin=this.crossOrigin,new Promise((E,w)=>{x.onerror=()=>{w(`Failed to load ${p}`),this.manager.itemEnd(p),this.manager.itemError(p)},x.onload=()=>{b&&URL.revokeObjectURL(p),this.imageCache[o]=x,E(x),this.manager.itemEnd(p)},x.src=p,this.manager.itemStart(p)})})}preFetchAll(){return r(this,void 0,void 0,function*(){const o=this.asset.gltf.images;return o?Promise.all(o.map((m,_)=>this.get(_))):[]})}}function s(u,o){return typeof u!="string"||u===""?"":/^(https?:)?\/\//i.test(u)||/^data:.*,.*$/i.test(u)||/^blob:.*$/i.test(u)?u:o+u}i.ImageData=h,i.resolveURL=s},function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.LoaderUtils=class{static decodeText(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let c="";for(const f of r)c+=String.fromCharCode(f);return decodeURIComponent(escape(c))}static extractUrlBase(r){const c=r.split("/");return c.length===1?"./":(c.pop(),c.join("/")+"/")}}},function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.FileLoader=class{constructor(r){this.runningRequests={},this.manager=r}load(r,c){if(this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r),this.runningRequests[r])return this.runningRequests[r];const f=new Promise((d,h)=>{const s=new XMLHttpRequest;s.open("GET",r,!0);const u=this;s.onload=function(o){const m=this.response;this.status===0?(console.warn("FileLoader: HTTP Status 0 received."),d(m),u.manager.itemEnd(r)):this.status===200?(d(m),u.manager.itemEnd(r)):(h({url:r,status:this.status,statusText:s.statusText}),u.manager.itemEnd(r),u.manager.itemError(r)),delete u.runningRequests[r]},s.onprogress=o=>{c&&c(o)},s.onerror=function(o){h({url:r,status:this.status,statusText:s.statusText}),u.manager.itemEnd(r),u.manager.itemError(r),delete u.runningRequests[r]},this.responseType&&(s.responseType=this.responseType),this.withCredentials&&(s.withCredentials=this.withCredentials),this.mimeType&&s.overrideMimeType&&s.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const o in this.requestHeaders)s.setRequestHeader(o,this.requestHeaders[o]);s.send(null),this.manager.itemStart(r)});return this.runningRequests[r]=f,f}setRequestHeader(r,c){return this.requestHeaders[r]=c,this}}},function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0})},function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0});const r=n(2);i.BINARY_HEADER_MAGIC="glTF",i.GLTFBinaryData=class{constructor(c){const f=new DataView(c,0,12),d=r.LoaderUtils.decodeText(new Uint8Array(c,0,4)),h=f.getUint32(4,!0);if(f.getUint32(8,!0),d!==i.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(h<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(c,12);let u=0;for(;u<s.byteLength;){const o=s.getUint32(u,!0);u+=4;const m=s.getUint32(u,!0);if(u+=4,m===1313821514){const _=new Uint8Array(c,12+u,o);this.json=r.LoaderUtils.decodeText(_)}else if(m===5130562){const _=12+u;this.binaryChunk=new Uint8Array(c,_,o)}u+=o}if(this.json===null)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,i,n){var r=this&&this.__awaiter||function(m,_,p,b){return new(p||(p=Promise))(function(x,E){function w(O){try{R(b.next(O))}catch(I){E(I)}}function S(O){try{R(b.throw(O))}catch(I){E(I)}}function R(O){O.done?x(O.value):new p(function(I){I(O.value)}).then(w,S)}R((b=b.apply(m,_||[])).next())})};function c(m){for(var _ in m)i.hasOwnProperty(_)||(i[_]=m[_])}Object.defineProperty(i,"__esModule",{value:!0});const f=n(3),d=n(5),h=n(1),s=n(2),u=n(0),o=n(4);i.gltf=o,c(n(1)),c(n(0)),i.GltfLoader=class{constructor(m){this.manager=m||new u.LoadingManager}load(m,_){return r(this,void 0,void 0,function*(){const p=s.LoaderUtils.extractUrlBase(m),b=new f.FileLoader(this.manager);b.responseType="arraybuffer";const x=yield b.load(m,_);return yield this.parse(x,p)})}loadFromFiles(m){return r(this,void 0,void 0,function*(){let _,p;for(const[S,R]of m)R.name.match(/\.(gltf|glb)$/)&&(_=R,p=S.replace(R.name,""));if(!_)throw new Error("No .gltf or .glb asset found.");const b=typeof _=="string"?_:URL.createObjectURL(_),x=s.LoaderUtils.extractUrlBase(b),E=[];this.manager.urlModifier=S=>{const R=p+S.replace(x,"").replace(/^(\.?\/)/,"");if(m.has(R)){const O=m.get(R),I=URL.createObjectURL(O);return E.push(I),I}return S};const w=yield this.load(b);return yield w.preFetchAll(),URL.revokeObjectURL(b),E.forEach(URL.revokeObjectURL),w})}parse(m,_){return r(this,void 0,void 0,function*(){let p,b;p=typeof m=="string"?m:s.LoaderUtils.decodeText(new Uint8Array(m,0,4))===d.BINARY_HEADER_MAGIC?(b=new d.GLTFBinaryData(m)).json:s.LoaderUtils.decodeText(new Uint8Array(m));const x=JSON.parse(p);if(x.asset===void 0||x.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new h.GltfAsset(x,_,b,this.manager)})}}},function(t,i,n){t.exports=n(6)}])},7648:(v,t,i)=>{var n=i(6433),r=n.ValidatorResult,c=n.SchemaError,f={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},d=f.validators={};function h(_,p,b,x,E){var w=p.throwError,S=p.throwAll;p.throwError=!1,p.throwAll=!1;var R=this.validateSchema(_,E,p,b);return p.throwError=w,p.throwAll=S,!R.valid&&x instanceof Function&&x(R),R.valid}function s(_,p){if(Object.hasOwnProperty.call(_,p))return _[p];if(p in _){for(;_=Object.getPrototypeOf(_);)if(Object.propertyIsEnumerable.call(_,p))return _[p]}}function u(_,p,b,x,E,w){if(this.types.object(_)&&(!p.properties||p.properties[E]===void 0))if(p.additionalProperties===!1)w.addError({name:"additionalProperties",argument:E,message:"is not allowed to have the additional property "+JSON.stringify(E)});else{var S=p.additionalProperties||{};typeof b.preValidateProperty=="function"&&b.preValidateProperty(_,E,S,b,x);var R=this.validateSchema(_[E],S,b,x.makeChild(S,E));R.instance!==w.instance[E]&&(w.instance[E]=R.instance),w.importErrors(R)}}d.type=function(_,p,b,x){if(_===void 0)return null;var E=new r(_,p,b,x),w=Array.isArray(p.type)?p.type:[p.type];if(!w.some(this.testType.bind(this,_,p,b,x))){var S=w.map(function(R){if(R){var O=R.$id||R.id;return O?"<"+O+">":R+""}});E.addError({name:"type",argument:S,message:"is not of a type(s) "+S})}return E},d.anyOf=function(_,p,b,x){if(_===void 0)return null;var E=new r(_,p,b,x),w=new r(_,p,b,x);if(!Array.isArray(p.anyOf))throw new c("anyOf must be an array");if(!p.anyOf.some(h.bind(this,_,b,x,function(R){w.importErrors(R)}))){var S=p.anyOf.map(function(R,O){var I=R.$id||R.id;return I?"<"+I+">":R.title&&JSON.stringify(R.title)||R.$ref&&"<"+R.$ref+">"||"[subschema "+O+"]"});b.nestedErrors&&E.importErrors(w),E.addError({name:"anyOf",argument:S,message:"is not any of "+S.join(",")})}return E},d.allOf=function(_,p,b,x){if(_===void 0)return null;if(!Array.isArray(p.allOf))throw new c("allOf must be an array");var E=new r(_,p,b,x),w=this;return p.allOf.forEach(function(S,R){var O=w.validateSchema(_,S,b,x);if(!O.valid){var I=S.$id||S.id||S.title&&JSON.stringify(S.title)||S.$ref&&"<"+S.$ref+">"||"[subschema "+R+"]";E.addError({name:"allOf",argument:{id:I,length:O.errors.length,valid:O},message:"does not match allOf schema "+I+" with "+O.errors.length+" error[s]:"}),E.importErrors(O)}}),E},d.oneOf=function(_,p,b,x){if(_===void 0)return null;if(!Array.isArray(p.oneOf))throw new c("oneOf must be an array");var E=new r(_,p,b,x),w=new r(_,p,b,x),S=p.oneOf.filter(h.bind(this,_,b,x,function(O){w.importErrors(O)})).length,R=p.oneOf.map(function(O,I){return O.$id||O.id||O.title&&JSON.stringify(O.title)||O.$ref&&"<"+O.$ref+">"||"[subschema "+I+"]"});return S!==1&&(b.nestedErrors&&E.importErrors(w),E.addError({name:"oneOf",argument:R,message:"is not exactly one from "+R.join(",")})),E},d.if=function(_,p,b,x){if(_===void 0)return null;if(!n.isSchema(p.if))throw new Error('Expected "if" keyword to be a schema');var E,w=h.call(this,_,b,x,null,p.if),S=new r(_,p,b,x);if(w){if(p.then===void 0)return;if(!n.isSchema(p.then))throw new Error('Expected "then" keyword to be a schema');E=this.validateSchema(_,p.then,b,x.makeChild(p.then)),S.importErrors(E)}else{if(p.else===void 0)return;if(!n.isSchema(p.else))throw new Error('Expected "else" keyword to be a schema');E=this.validateSchema(_,p.else,b,x.makeChild(p.else)),S.importErrors(E)}return S},d.propertyNames=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x),w=p.propertyNames!==void 0?p.propertyNames:{};if(!n.isSchema(w))throw new c('Expected "propertyNames" to be a schema (object or boolean)');for(var S in _)if(s(_,S)!==void 0){var R=this.validateSchema(S,w,b,x.makeChild(w));E.importErrors(R)}return E}},d.properties=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x),w=p.properties||{};for(var S in w){var R=w[S];if(R!==void 0){if(R===null)throw new c('Unexpected null, expected schema in "properties"');typeof b.preValidateProperty=="function"&&b.preValidateProperty(_,S,R,b,x);var O=s(_,S),I=this.validateSchema(O,R,b,x.makeChild(R,S));I.instance!==E.instance[S]&&(E.instance[S]=I.instance),E.importErrors(I)}}return E}},d.patternProperties=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x),w=p.patternProperties||{};for(var S in _){var R=!0;for(var O in w){var I=w[O];if(I!==void 0){if(I===null)throw new c('Unexpected null, expected schema in "patternProperties"');try{var D=new RegExp(O,"u")}catch{D=new RegExp(O)}if(D.test(S)){R=!1,typeof b.preValidateProperty=="function"&&b.preValidateProperty(_,S,I,b,x);var j=this.validateSchema(_[S],I,b,x.makeChild(I,S));j.instance!==E.instance[S]&&(E.instance[S]=j.instance),E.importErrors(j)}}}R&&u.call(this,_,p,b,x,S,E)}return E}},d.additionalProperties=function(_,p,b,x){if(this.types.object(_)){if(p.patternProperties)return null;var E=new r(_,p,b,x);for(var w in _)u.call(this,_,p,b,x,w,E);return E}},d.minProperties=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x);return Object.keys(_).length>=p.minProperties||E.addError({name:"minProperties",argument:p.minProperties,message:"does not meet minimum property length of "+p.minProperties}),E}},d.maxProperties=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x);return Object.keys(_).length<=p.maxProperties||E.addError({name:"maxProperties",argument:p.maxProperties,message:"does not meet maximum property length of "+p.maxProperties}),E}},d.items=function(_,p,b,x){var E=this;if(this.types.array(_)&&p.items!==void 0){var w=new r(_,p,b,x);return _.every(function(S,R){if(Array.isArray(p.items))var O=p.items[R]===void 0?p.additionalItems:p.items[R];else O=p.items;if(O===void 0)return!0;if(O===!1)return w.addError({name:"items",message:"additionalItems not permitted"}),!1;var I=E.validateSchema(S,O,b,x.makeChild(O,R));return I.instance!==w.instance[R]&&(w.instance[R]=I.instance),w.importErrors(I),!0}),w}},d.contains=function(_,p,b,x){var E=this;if(this.types.array(_)&&p.contains!==void 0){if(!n.isSchema(p.contains))throw new Error('Expected "contains" keyword to be a schema');var w=new r(_,p,b,x);return _.some(function(S,R){return E.validateSchema(S,p.contains,b,x.makeChild(p.contains,R)).errors.length===0})===!1&&w.addError({name:"contains",argument:p.contains,message:"must contain an item matching given schema"}),w}},d.minimum=function(_,p,b,x){if(this.types.number(_)){var E=new r(_,p,b,x);return p.exclusiveMinimum&&p.exclusiveMinimum===!0?_>p.minimum||E.addError({name:"minimum",argument:p.minimum,message:"must be greater than "+p.minimum}):_>=p.minimum||E.addError({name:"minimum",argument:p.minimum,message:"must be greater than or equal to "+p.minimum}),E}},d.maximum=function(_,p,b,x){if(this.types.number(_)){var E=new r(_,p,b,x);return p.exclusiveMaximum&&p.exclusiveMaximum===!0?_<p.maximum||E.addError({name:"maximum",argument:p.maximum,message:"must be less than "+p.maximum}):_<=p.maximum||E.addError({name:"maximum",argument:p.maximum,message:"must be less than or equal to "+p.maximum}),E}},d.exclusiveMinimum=function(_,p,b,x){if(typeof p.exclusiveMinimum!="boolean"&&this.types.number(_)){var E=new r(_,p,b,x);return _>p.exclusiveMinimum||E.addError({name:"exclusiveMinimum",argument:p.exclusiveMinimum,message:"must be strictly greater than "+p.exclusiveMinimum}),E}},d.exclusiveMaximum=function(_,p,b,x){if(typeof p.exclusiveMaximum!="boolean"&&this.types.number(_)){var E=new r(_,p,b,x);return _<p.exclusiveMaximum||E.addError({name:"exclusiveMaximum",argument:p.exclusiveMaximum,message:"must be strictly less than "+p.exclusiveMaximum}),E}};var o=function(_,p,b,x,E,w){if(this.types.number(_)){var S=p[E];if(S==0)throw new c(E+" cannot be zero");var R=new r(_,p,b,x),O=n.getDecimalPlaces(_),I=n.getDecimalPlaces(S),D=Math.max(O,I),j=Math.pow(10,D);return Math.round(_*j)%Math.round(S*j)!=0&&R.addError({name:E,argument:S,message:w+JSON.stringify(S)}),R}};function m(_,p,b){var x,E=b.length;for(x=p+1;x<E;x++)if(n.deepCompareStrict(_,b[x]))return!1;return!0}d.multipleOf=function(_,p,b,x){return o.call(this,_,p,b,x,"multipleOf","is not a multiple of (divisible by) ")},d.divisibleBy=function(_,p,b,x){return o.call(this,_,p,b,x,"divisibleBy","is not divisible by (multiple of) ")},d.required=function(_,p,b,x){var E=new r(_,p,b,x);return _===void 0&&p.required===!0?E.addError({name:"required",message:"is required"}):this.types.object(_)&&Array.isArray(p.required)&&p.required.forEach(function(w){s(_,w)===void 0&&E.addError({name:"required",argument:w,message:"requires property "+JSON.stringify(w)})}),E},d.pattern=function(_,p,b,x){if(this.types.string(_)){var E=new r(_,p,b,x),w=p.pattern;try{var S=new RegExp(w,"u")}catch{S=new RegExp(w)}return _.match(S)||E.addError({name:"pattern",argument:p.pattern,message:"does not match pattern "+JSON.stringify(p.pattern.toString())}),E}},d.format=function(_,p,b,x){if(_!==void 0){var E=new r(_,p,b,x);return E.disableFormat||n.isFormat(_,p.format,this)||E.addError({name:"format",argument:p.format,message:"does not conform to the "+JSON.stringify(p.format)+" format"}),E}},d.minLength=function(_,p,b,x){if(this.types.string(_)){var E=new r(_,p,b,x),w=_.match(/[\uDC00-\uDFFF]/g);return _.length-(w?w.length:0)>=p.minLength||E.addError({name:"minLength",argument:p.minLength,message:"does not meet minimum length of "+p.minLength}),E}},d.maxLength=function(_,p,b,x){if(this.types.string(_)){var E=new r(_,p,b,x),w=_.match(/[\uDC00-\uDFFF]/g);return _.length-(w?w.length:0)<=p.maxLength||E.addError({name:"maxLength",argument:p.maxLength,message:"does not meet maximum length of "+p.maxLength}),E}},d.minItems=function(_,p,b,x){if(this.types.array(_)){var E=new r(_,p,b,x);return _.length>=p.minItems||E.addError({name:"minItems",argument:p.minItems,message:"does not meet minimum length of "+p.minItems}),E}},d.maxItems=function(_,p,b,x){if(this.types.array(_)){var E=new r(_,p,b,x);return _.length<=p.maxItems||E.addError({name:"maxItems",argument:p.maxItems,message:"does not meet maximum length of "+p.maxItems}),E}},d.uniqueItems=function(_,p,b,x){if(p.uniqueItems===!0&&this.types.array(_)){var E=new r(_,p,b,x);return _.every(m)||E.addError({name:"uniqueItems",message:"contains duplicate item"}),E}},d.dependencies=function(_,p,b,x){if(this.types.object(_)){var E=new r(_,p,b,x);for(var w in p.dependencies)if(_[w]!==void 0){var S=p.dependencies[w],R=x.makeChild(S,w);if(typeof S=="string"&&(S=[S]),Array.isArray(S))S.forEach(function(I){_[I]===void 0&&E.addError({name:"dependencies",argument:R.propertyPath,message:"property "+I+" not found, required by "+R.propertyPath})});else{var O=this.validateSchema(_,S,b,R);E.instance!==O.instance&&(E.instance=O.instance),O&&O.errors.length&&(E.addError({name:"dependencies",argument:R.propertyPath,message:"does not meet dependency required by "+R.propertyPath}),E.importErrors(O))}}return E}},d.enum=function(_,p,b,x){if(_===void 0)return null;if(!Array.isArray(p.enum))throw new c("enum expects an array",p);var E=new r(_,p,b,x);return p.enum.some(n.deepCompareStrict.bind(null,_))||E.addError({name:"enum",argument:p.enum,message:"is not one of enum values: "+p.enum.map(String).join(",")}),E},d.const=function(_,p,b,x){if(_===void 0)return null;var E=new r(_,p,b,x);return n.deepCompareStrict(p.const,_)||E.addError({name:"const",argument:p.const,message:"does not exactly match expected constant: "+p.const}),E},d.not=d.disallow=function(_,p,b,x){var E=this;if(_===void 0)return null;var w=new r(_,p,b,x),S=p.not||p.disallow;return S?(Array.isArray(S)||(S=[S]),S.forEach(function(R){if(E.testType(_,p,b,x,R)){var O=R&&(R.$id||R.id)||R;w.addError({name:"not",argument:O,message:"is of prohibited type "+O})}}),w):null},v.exports=f},6433:(v,t,i)=>{var n=i(9983),r=t.ValidationError=function(E,w,S,R,O,I){if(Array.isArray(R)?(this.path=R,this.property=R.reduce(function(j,k){return j+o(k)},"instance")):R!==void 0&&(this.property=R),E&&(this.message=E),S){var D=S.$id||S.id;this.schema=D||S}w!==void 0&&(this.instance=w),this.name=O,this.argument=I,this.stack=this.toString()};r.prototype.toString=function(){return this.property+" "+this.message};var c=t.ValidatorResult=function(E,w,S,R){this.instance=E,this.schema=w,this.options=S,this.path=R.path,this.propertyPath=R.propertyPath,this.errors=[],this.throwError=S&&S.throwError,this.throwFirst=S&&S.throwFirst,this.throwAll=S&&S.throwAll,this.disableFormat=S&&S.disableFormat===!0};function f(E,w){return w+": "+E.toString()+`
`}function d(E){Error.captureStackTrace&&Error.captureStackTrace(this,d),this.instance=E.instance,this.schema=E.schema,this.options=E.options,this.errors=E.errors}c.prototype.addError=function(E){var w;if(typeof E=="string")w=new r(E,this.instance,this.schema,this.path);else{if(!E)throw new Error("Missing error detail");if(!E.message)throw new Error("Missing error message");if(!E.name)throw new Error("Missing validator type");w=new r(E.message,this.instance,this.schema,this.path,E.name,E.argument)}if(this.errors.push(w),this.throwFirst)throw new d(this);if(this.throwError)throw w;return w},c.prototype.importErrors=function(E){typeof E=="string"||E&&E.validatorType?this.addError(E):E&&E.errors&&(this.errors=this.errors.concat(E.errors))},c.prototype.toString=function(E){return this.errors.map(f).join("")},Object.defineProperty(c.prototype,"valid",{get:function(){return!this.errors.length}}),v.exports.ValidatorResultError=d,d.prototype=new Error,d.prototype.constructor=d,d.prototype.name="Validation Error";var h=t.SchemaError=function E(w,S){this.message=w,this.schema=S,Error.call(this,w),Error.captureStackTrace(this,E)};h.prototype=Object.create(Error.prototype,{constructor:{value:h,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var s=t.SchemaContext=function(E,w,S,R,O){this.schema=E,this.options=w,Array.isArray(S)?(this.path=S,this.propertyPath=S.reduce(function(I,D){return I+o(D)},"instance")):this.propertyPath=S,this.base=R,this.schemas=O};s.prototype.resolve=function(E){return n.resolve(this.base,E)},s.prototype.makeChild=function(E,w){var S=w===void 0?this.path:this.path.concat([w]),R=E.$id||E.id,O=n.resolve(this.base,R||""),I=new s(E,this.options,S,O,Object.create(this.schemas));return R&&!I.schemas[O]&&(I.schemas[O]=E),I};var u=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(E){return typeof E=="string"&&parseFloat(E)===parseInt(E,10)&&!isNaN(E)},regex:function(E){var w=!0;try{new RegExp(E)}catch{w=!1}return w},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};u.regexp=u.regex,u.pattern=u.regex,u.ipv4=u["ip-address"],t.isFormat=function(E,w,S){if(typeof E=="string"&&u[w]!==void 0){if(u[w]instanceof RegExp)return u[w].test(E);if(typeof u[w]=="function")return u[w](E)}else if(S&&S.customFormats&&typeof S.customFormats[w]=="function")return S.customFormats[w](E);return!0};var o=t.makeSuffix=function(E){return(E=E.toString()).match(/[.\s\[\]]/)||E.match(/^[\d]/)?E.match(/^\d+$/)?"["+E+"]":"["+JSON.stringify(E)+"]":"."+E};function m(E,w,S,R){typeof S=="object"?w[R]=b(E[R],S):E.indexOf(S)===-1&&w.push(S)}function _(E,w,S){w[S]=E[S]}function p(E,w,S,R){typeof w[R]=="object"&&w[R]&&E[R]?S[R]=b(E[R],w[R]):S[R]=w[R]}function b(E,w){var S=Array.isArray(w),R=S&&[]||{};return S?(E=E||[],R=R.concat(E),w.forEach(m.bind(null,E,R))):(E&&typeof E=="object"&&Object.keys(E).forEach(_.bind(null,E,R)),Object.keys(w).forEach(p.bind(null,E,w,R))),R}function x(E){return"/"+encodeURIComponent(E).replace(/~/g,"%7E")}t.deepCompareStrict=function E(w,S){if(typeof w!=typeof S)return!1;if(Array.isArray(w))return!!Array.isArray(S)&&w.length===S.length&&w.every(function(I,D){return E(w[D],S[D])});if(typeof w=="object"){if(!w||!S)return w===S;var R=Object.keys(w),O=Object.keys(S);return R.length===O.length&&R.every(function(I){return E(w[I],S[I])})}return w===S},v.exports.deepMerge=b,t.objectGetPath=function(E,w){for(var S,R=w.split("/").slice(1);typeof(S=R.shift())=="string";){var O=decodeURIComponent(S.replace(/~0/,"~").replace(/~1/g,"/"));if(!(O in E))return;E=E[O]}return E},t.encodePath=function(E){return E.map(x).join("")},t.getDecimalPlaces=function(E){var w=0;if(isNaN(E))return w;typeof E!="number"&&(E=Number(E));var S=E.toString().split("e");if(S.length===2){if(S[1][0]!=="-")return w;w=Number(S[1].slice(1))}var R=S[0].split(".");return R.length===2&&(w+=R[1].length),w},t.isSchema=function(E){return typeof E=="object"&&E||typeof E=="boolean"}},3780:(v,t,i)=>{var n=v.exports.Validator=i(4622);v.exports.ValidatorResult=i(6433).ValidatorResult,v.exports.ValidatorResultError=i(6433).ValidatorResultError,v.exports.ValidationError=i(6433).ValidationError,v.exports.SchemaError=i(6433).SchemaError,v.exports.SchemaScanResult=i(8075).SchemaScanResult,v.exports.scan=i(8075).scan,v.exports.validate=function(r,c,f){return new n().validate(r,c,f)}},8075:(v,t,i)=>{var n=i(9983),r=i(6433);function c(f,d){this.id=f,this.ref=d}v.exports.SchemaScanResult=c,v.exports.scan=function(f,d){function h(_,p){if(p&&typeof p=="object")if(p.$ref){var b=n.resolve(_,p.$ref);m[b]=m[b]?m[b]+1:0}else{var x=p.$id||p.id,E=x?n.resolve(_,x):_;if(E){if(E.indexOf("#")<0&&(E+="#"),o[E]){if(!r.deepCompareStrict(o[E],p))throw new Error("Schema <"+E+"> already exists with different definition");return o[E]}o[E]=p,E[E.length-1]=="#"&&(o[E.substring(0,E.length-1)]=p)}s(E+"/items",Array.isArray(p.items)?p.items:[p.items]),s(E+"/extends",Array.isArray(p.extends)?p.extends:[p.extends]),h(E+"/additionalItems",p.additionalItems),u(E+"/properties",p.properties),h(E+"/additionalProperties",p.additionalProperties),u(E+"/definitions",p.definitions),u(E+"/patternProperties",p.patternProperties),u(E+"/dependencies",p.dependencies),s(E+"/disallow",p.disallow),s(E+"/allOf",p.allOf),s(E+"/anyOf",p.anyOf),s(E+"/oneOf",p.oneOf),h(E+"/not",p.not)}}function s(_,p){if(Array.isArray(p))for(var b=0;b<p.length;b++)h(_+"/"+b,p[b])}function u(_,p){if(p&&typeof p=="object")for(var b in p)h(_+"/"+b,p[b])}var o={},m={};return h(f,d),new c(o,m)}},4622:(v,t,i)=>{var n=i(9983),r=i(7648),c=i(6433),f=i(8075).scan,d=c.ValidatorResult,h=c.ValidatorResultError,s=c.SchemaError,u=c.SchemaContext,o=function p(){this.customFormats=Object.create(p.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(_),this.attributes=Object.create(r.validators)};function m(p){var b=typeof p=="string"?p:p.$ref;return typeof b=="string"&&b}o.prototype.customFormats={},o.prototype.schemas=null,o.prototype.types=null,o.prototype.attributes=null,o.prototype.unresolvedRefs=null,o.prototype.addSchema=function(p,b){var x=this;if(!p)return null;var E=f(b||"/",p),w=b||p.$id||p.id;for(var S in E.id)this.schemas[S]=E.id[S];for(var S in E.ref)this.unresolvedRefs.push(S);return this.unresolvedRefs=this.unresolvedRefs.filter(function(R){return x.schemas[R]===void 0}),this.schemas[w]},o.prototype.addSubSchemaArray=function(p,b){if(Array.isArray(b))for(var x=0;x<b.length;x++)this.addSubSchema(p,b[x])},o.prototype.addSubSchemaObject=function(p,b){if(b&&typeof b=="object")for(var x in b)this.addSubSchema(p,b[x])},o.prototype.setSchemas=function(p){this.schemas=p},o.prototype.getSchema=function(p){return this.schemas[p]},o.prototype.validate=function(p,b,x,E){if(typeof b!="boolean"&&typeof b!="object"||b===null)throw new s("Expected `schema` to be an object or boolean");x||(x={});var w,S=b.$id||b.id,R=n.resolve(x.base||"/",S||"");if(!E){(E=new u(b,x,[],R,Object.create(this.schemas))).schemas[R]||(E.schemas[R]=b);var O=f(R,b);for(var I in O.id){var D=O.id[I];E.schemas[I]=D}}if(x.required&&p===void 0)return(w=new d(p,b,x,E)).addError("is required, but is undefined"),w;if(!(w=this.validateSchema(p,b,x,E)))throw new Error("Result undefined");if(x.throwAll&&w.errors.length)throw new h(w);return w},o.prototype.validateSchema=function(p,b,x,E){var w=new d(p,b,x,E);if(typeof b=="boolean")b===!0?b={}:b===!1&&(b={type:[]});else if(!b)throw new Error("schema is undefined");if(b.extends)if(Array.isArray(b.extends)){var S={schema:b,ctx:E};b.extends.forEach(this.schemaTraverser.bind(this,S)),b=S.schema,S.schema=null,S.ctx=null,S=null}else b=c.deepMerge(b,this.superResolve(b.extends,E));var R=m(b);if(R){var O=this.resolve(b,R,E),I=new u(O.subschema,x,E.path,O.switchSchema,E.schemas);return this.validateSchema(p,O.subschema,x,I)}var D=x&&x.skipAttributes||[];for(var j in b)if(!r.ignoreProperties[j]&&D.indexOf(j)<0){var k=null,G=this.attributes[j];if(G)k=G.call(this,p,b,x,E);else if(x.allowUnknownAttributes===!1)throw new s("Unsupported attribute: "+j,b);k&&w.importErrors(k)}if(typeof x.rewrite=="function"){var Z=x.rewrite.call(this,p,b,x,E);w.instance=Z}return w},o.prototype.schemaTraverser=function(p,b){p.schema=c.deepMerge(p.schema,this.superResolve(b,p.ctx))},o.prototype.superResolve=function(p,b){var x=m(p);return x?this.resolve(p,x,b).subschema:p},o.prototype.resolve=function(p,b,x){if(b=x.resolve(b),x.schemas[b])return{subschema:x.schemas[b],switchSchema:b};var E=n.parse(b),w=E&&E.hash,S=w&&w.length&&b.substr(0,b.length-w.length);if(!S||!x.schemas[S])throw new s("no such schema <"+b+">",p);var R=c.objectGetPath(x.schemas[S],w.substr(1));if(R===void 0)throw new s("no such schema "+w+" located in <"+S+">",p);return{subschema:R,switchSchema:b}},o.prototype.testType=function(p,b,x,E,w){if(w!==void 0){if(w===null)throw new s('Unexpected null in "type" keyword');if(typeof this.types[w]=="function")return this.types[w].call(this,p);if(w&&typeof w=="object"){var S=this.validateSchema(p,w,x,E);return S===void 0||!(S&&S.errors.length)}return!0}};var _=o.prototype.types={};_.string=function(p){return typeof p=="string"},_.number=function(p){return typeof p=="number"&&isFinite(p)},_.integer=function(p){return typeof p=="number"&&p%1==0},_.boolean=function(p){return typeof p=="boolean"},_.array=function(p){return Array.isArray(p)},_.null=function(p){return p===null},_.date=function(p){return p instanceof Date},_.any=function(p){return!0},_.object=function(p){return p&&typeof p=="object"&&!Array.isArray(p)&&!(p instanceof Date)},v.exports=o},6751:(v,t,i)=>{i.r(t),i.d(t,{decode:()=>E,default:()=>O,encode:()=>w,toASCII:()=>R,toUnicode:()=>S,ucs2decode:()=>_,ucs2encode:()=>p});const n=2147483647,r=36,c=/^xn--/,f=/[^\0-\x7F]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},s=Math.floor,u=String.fromCharCode;function o(I){throw new RangeError(h[I])}function m(I,D){const j=I.split("@");let k="";j.length>1&&(k=j[0]+"@",I=j[1]);const G=function(Z,K){const Y=[];let re=Z.length;for(;re--;)Y[re]=K(Z[re]);return Y}((I=I.replace(d,".")).split("."),D).join(".");return k+G}function _(I){const D=[];let j=0;const k=I.length;for(;j<k;){const G=I.charCodeAt(j++);if(G>=55296&&G<=56319&&j<k){const Z=I.charCodeAt(j++);(64512&Z)==56320?D.push(((1023&G)<<10)+(1023&Z)+65536):(D.push(G),j--)}else D.push(G)}return D}const p=I=>String.fromCodePoint(...I),b=function(I,D){return I+22+75*(I<26)-((D!=0)<<5)},x=function(I,D,j){let k=0;for(I=j?s(I/700):I>>1,I+=s(I/D);I>455;k+=r)I=s(I/35);return s(k+36*I/(I+38))},E=function(I){const D=[],j=I.length;let k=0,G=128,Z=72,K=I.lastIndexOf("-");K<0&&(K=0);for(let re=0;re<K;++re)I.charCodeAt(re)>=128&&o("not-basic"),D.push(I.charCodeAt(re));for(let re=K>0?K+1:0;re<j;){const Q=k;for(let se=1,ee=r;;ee+=r){re>=j&&o("invalid-input");const le=(Y=I.charCodeAt(re++))>=48&&Y<58?Y-48+26:Y>=65&&Y<91?Y-65:Y>=97&&Y<123?Y-97:r;le>=r&&o("invalid-input"),le>s((n-k)/se)&&o("overflow"),k+=le*se;const ge=ee<=Z?1:ee>=Z+26?26:ee-Z;if(le<ge)break;const ve=r-ge;se>s(n/ve)&&o("overflow"),se*=ve}const ae=D.length+1;Z=x(k-Q,ae,Q==0),s(k/ae)>n-G&&o("overflow"),G+=s(k/ae),k%=ae,D.splice(k++,0,G)}var Y;return String.fromCodePoint(...D)},w=function(I){const D=[],j=(I=_(I)).length;let k=128,G=0,Z=72;for(const re of I)re<128&&D.push(u(re));const K=D.length;let Y=K;for(K&&D.push("-");Y<j;){let re=n;for(const ae of I)ae>=k&&ae<re&&(re=ae);const Q=Y+1;re-k>s((n-G)/Q)&&o("overflow"),G+=(re-k)*Q,k=re;for(const ae of I)if(ae<k&&++G>n&&o("overflow"),ae===k){let se=G;for(let ee=r;;ee+=r){const le=ee<=Z?1:ee>=Z+26?26:ee-Z;if(se<le)break;const ge=se-le,ve=r-le;D.push(u(b(le+ge%ve,0))),se=s(ge/ve)}D.push(u(b(se,0))),Z=x(G,Q,Y===K),G=0,++Y}++G,++k}return D.join("")},S=function(I){return m(I,function(D){return c.test(D)?E(D.slice(4).toLowerCase()):D})},R=function(I){return m(I,function(D){return f.test(D)?"xn--"+w(D):D})},O={version:"2.3.1",ucs2:{decode:_,encode:p},decode:E,encode:w,toASCII:R,toUnicode:S}},769:v=>{var t=String.prototype.replace,i=/%20/g;v.exports={default:"RFC3986",formatters:{RFC1738:function(n){return t.call(n,i,"+")},RFC3986:function(n){return String(n)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},8985:(v,t,i)=>{var n=i(1088),r=i(2286),c=i(769);v.exports={formats:c,parse:r,stringify:n}},2286:(v,t,i)=>{var n=i(5364),r=Object.prototype.hasOwnProperty,c={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},f=function(d,h,s){if(d){var u=s.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,o=/(\[[^[\]]*])/g,m=/(\[[^[\]]*])/.exec(u),_=m?u.slice(0,m.index):u,p=[];if(_){if(!s.plainObjects&&r.call(Object.prototype,_)&&!s.allowPrototypes)return;p.push(_)}for(var b=0;(m=o.exec(u))!==null&&b<s.depth;){if(b+=1,!s.plainObjects&&r.call(Object.prototype,m[1].slice(1,-1))&&!s.allowPrototypes)return;p.push(m[1])}return m&&p.push("["+u.slice(m.index)+"]"),function(x,E,w){for(var S=E,R=x.length-1;R>=0;--R){var O,I=x[R];if(I==="[]"&&w.parseArrays)O=[].concat(S);else{O=w.plainObjects?Object.create(null):{};var D=I.charAt(0)==="["&&I.charAt(I.length-1)==="]"?I.slice(1,-1):I,j=parseInt(D,10);w.parseArrays||D!==""?!isNaN(j)&&I!==D&&String(j)===D&&j>=0&&w.parseArrays&&j<=w.arrayLimit?(O=[])[j]=S:D!=="__proto__"&&(O[D]=S):O={0:S}}S=O}return S}(p,h,s)}};v.exports=function(d,h){var s=h?n.assign({},h):{};if(s.decoder!==null&&s.decoder!==void 0&&typeof s.decoder!="function")throw new TypeError("Decoder has to be a function.");if(s.ignoreQueryPrefix=s.ignoreQueryPrefix===!0,s.delimiter=typeof s.delimiter=="string"||n.isRegExp(s.delimiter)?s.delimiter:c.delimiter,s.depth=typeof s.depth=="number"?s.depth:c.depth,s.arrayLimit=typeof s.arrayLimit=="number"?s.arrayLimit:c.arrayLimit,s.parseArrays=s.parseArrays!==!1,s.decoder=typeof s.decoder=="function"?s.decoder:c.decoder,s.allowDots=typeof s.allowDots=="boolean"?s.allowDots:c.allowDots,s.plainObjects=typeof s.plainObjects=="boolean"?s.plainObjects:c.plainObjects,s.allowPrototypes=typeof s.allowPrototypes=="boolean"?s.allowPrototypes:c.allowPrototypes,s.parameterLimit=typeof s.parameterLimit=="number"?s.parameterLimit:c.parameterLimit,s.strictNullHandling=typeof s.strictNullHandling=="boolean"?s.strictNullHandling:c.strictNullHandling,d===""||d==null)return s.plainObjects?Object.create(null):{};for(var u=typeof d=="string"?function(x,E){for(var w={},S=E.ignoreQueryPrefix?x.replace(/^\?/,""):x,R=E.parameterLimit===1/0?void 0:E.parameterLimit,O=S.split(E.delimiter,R),I=0;I<O.length;++I){var D,j,k=O[I],G=k.indexOf("]="),Z=G===-1?k.indexOf("="):G+1;Z===-1?(D=E.decoder(k,c.decoder),j=E.strictNullHandling?null:""):(D=E.decoder(k.slice(0,Z),c.decoder),j=E.decoder(k.slice(Z+1),c.decoder)),r.call(w,D)?w[D]=[].concat(w[D]).concat(j):w[D]=j}return w}(d,s):d,o=s.plainObjects?Object.create(null):{},m=Object.keys(u),_=0;_<m.length;++_){var p=m[_],b=f(p,u[p],s);o=n.merge(o,b,s)}return n.compact(o)}},1088:(v,t,i)=>{var n=i(5364),r=i(769),c={brackets:function(m){return m+"[]"},indices:function(m,_){return m+"["+_+"]"},repeat:function(m){return m}},f=Array.isArray,d=Array.prototype.push,h=function(m,_){d.apply(m,f(_)?_:[_])},s=Date.prototype.toISOString,u={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(m){return s.call(m)},skipNulls:!1,strictNullHandling:!1},o=function m(_,p,b,x,E,w,S,R,O,I,D,j){var k=_;if(typeof S=="function"?k=S(p,k):k instanceof Date&&(k=I(k)),k===null){if(x)return w&&!j?w(p,u.encoder):p;k=""}if(typeof k=="string"||typeof k=="number"||typeof k=="boolean"||n.isBuffer(k))return w?[D(j?p:w(p,u.encoder))+"="+D(w(k,u.encoder))]:[D(p)+"="+D(String(k))];var G,Z=[];if(k===void 0)return Z;if(f(S))G=S;else{var K=Object.keys(k);G=R?K.sort(R):K}for(var Y=0;Y<G.length;++Y){var re=G[Y];E&&k[re]===null||(f(k)?h(Z,m(k[re],b(p,re),b,x,E,w,S,R,O,I,D,j)):h(Z,m(k[re],p+(O?"."+re:"["+re+"]"),b,x,E,w,S,R,O,I,D,j)))}return Z};v.exports=function(m,_){var p=m,b=_?n.assign({},_):{};if(b.encoder!==null&&b.encoder!==void 0&&typeof b.encoder!="function")throw new TypeError("Encoder has to be a function.");var x=b.delimiter===void 0?u.delimiter:b.delimiter,E=typeof b.strictNullHandling=="boolean"?b.strictNullHandling:u.strictNullHandling,w=typeof b.skipNulls=="boolean"?b.skipNulls:u.skipNulls,S=typeof b.encode=="boolean"?b.encode:u.encode,R=typeof b.encoder=="function"?b.encoder:u.encoder,O=typeof b.sort=="function"?b.sort:null,I=b.allowDots!==void 0&&b.allowDots,D=typeof b.serializeDate=="function"?b.serializeDate:u.serializeDate,j=typeof b.encodeValuesOnly=="boolean"?b.encodeValuesOnly:u.encodeValuesOnly;if(b.format===void 0)b.format=r.default;else if(!Object.prototype.hasOwnProperty.call(r.formatters,b.format))throw new TypeError("Unknown format option provided.");var k,G,Z=r.formatters[b.format];typeof b.filter=="function"?p=(G=b.filter)("",p):f(b.filter)&&(k=G=b.filter);var K,Y=[];if(typeof p!="object"||p===null)return"";K=b.arrayFormat in c?b.arrayFormat:"indices"in b?b.indices?"indices":"repeat":"indices";var re=c[K];k||(k=Object.keys(p)),O&&k.sort(O);for(var Q=0;Q<k.length;++Q){var ae=k[Q];w&&p[ae]===null||h(Y,o(p[ae],ae,re,E,w,S?R:null,G,O,I,D,Z,j))}var se=Y.join(x),ee=b.addQueryPrefix===!0?"?":"";return se.length>0?ee+se:""}},5364:v=>{var t=Object.prototype.hasOwnProperty,i=function(){for(var r=[],c=0;c<256;++c)r.push("%"+((c<16?"0":"")+c.toString(16)).toUpperCase());return r}(),n=function(r,c){for(var f=c&&c.plainObjects?Object.create(null):{},d=0;d<r.length;++d)r[d]!==void 0&&(f[d]=r[d]);return f};v.exports={arrayToObject:n,assign:function(r,c){return Object.keys(c).reduce(function(f,d){return f[d]=c[d],f},r)},compact:function(r){for(var c=[{obj:{o:r},prop:"o"}],f=[],d=0;d<c.length;++d)for(var h=c[d],s=h.obj[h.prop],u=Object.keys(s),o=0;o<u.length;++o){var m=u[o],_=s[m];typeof _=="object"&&_!==null&&f.indexOf(_)===-1&&(c.push({obj:s,prop:m}),f.push(_))}return function(p){for(var b;p.length;){var x=p.pop();if(b=x.obj[x.prop],Array.isArray(b)){for(var E=[],w=0;w<b.length;++w)b[w]!==void 0&&E.push(b[w]);x.obj[x.prop]=E}}return b}(c)},decode:function(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch{return r}},encode:function(r){if(r.length===0)return r;for(var c=typeof r=="string"?r:String(r),f="",d=0;d<c.length;++d){var h=c.charCodeAt(d);h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122?f+=c.charAt(d):h<128?f+=i[h]:h<2048?f+=i[192|h>>6]+i[128|63&h]:h<55296||h>=57344?f+=i[224|h>>12]+i[128|h>>6&63]+i[128|63&h]:(d+=1,h=65536+((1023&h)<<10|1023&c.charCodeAt(d)),f+=i[240|h>>18]+i[128|h>>12&63]+i[128|h>>6&63]+i[128|63&h])}return f},isBuffer:function(r){return r!=null&&!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))},isRegExp:function(r){return Object.prototype.toString.call(r)==="[object RegExp]"},merge:function r(c,f,d){if(!f)return c;if(typeof f!="object"){if(Array.isArray(c))c.push(f);else{if(!c||typeof c!="object")return[c,f];(d&&(d.plainObjects||d.allowPrototypes)||!t.call(Object.prototype,f))&&(c[f]=!0)}return c}if(!c||typeof c!="object")return[c].concat(f);var h=c;return Array.isArray(c)&&!Array.isArray(f)&&(h=n(c,d)),Array.isArray(c)&&Array.isArray(f)?(f.forEach(function(s,u){if(t.call(c,u)){var o=c[u];o&&typeof o=="object"&&s&&typeof s=="object"?c[u]=r(o,s,d):c.push(s)}else c[u]=s}),c):Object.keys(f).reduce(function(s,u){var o=f[u];return t.call(s,u)?s[u]=r(s[u],o,d):s[u]=o,s},h)}}},9017:function(v,t,i){var n=this&&this.__decorate||function(p,b,x,E){var w,S=arguments.length,R=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,b,x,E);else for(var O=p.length-1;O>=0;O--)(w=p[O])&&(R=(S<3?w(R):S>3?w(b,x,R):w(b,x))||R);return S>3&&R&&Object.defineProperty(b,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.AccumulatePass=void 0;const r=i(9504),c=i(7564),f=i(8215),d=i(4127),h=i(1896),s=i(4168),u=i(771),o=i(8593),m=i(9217);class _ extends d.Initializable{constructor(b){super(),this._altered=Object.assign(new c.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=m.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=b}initialize(b){const x=this._context.gl;this._accumulationFBOs=[new f.Framebuffer(this._context,"AccumPingFBO"),new f.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new o.Texture2D(this._context,"AccumPingTexture"),new o.Texture2D(this._context,"AccumPongTexture")],b===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=b,this._ndcTriangleShared=!0);const E=new u.Shader(this._context,x.VERTEX_SHADER,"ndcvertices.vert (accumulate)");E.initialize(i(9657));const w=new u.Shader(this._context,x.FRAGMENT_SHADER,"accumulate.frag");return w.initialize(i(8058)),this._program=new s.Program(this._context,"AccumulateProgram"),this._program.initialize([E,w],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),x.uniform1f(this._uWeight,0),x.uniform1i(this._program.uniform("u_accumulationTexture"),0),x.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void(0,r.log)(r.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const b=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!b)return void(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const x=this._context.gl,E=this._context.gl2facade,w=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||b)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].reformat(S[0],x.RGBA,S[1]),this._accumulationTextures[1].reformat(S[0],x.RGBA,S[1])}}else{const S=m.Wizard.queryInternalTextureFormat(this._context,x.RGBA,this._precision);this._accumulationTextures[0].initialize(w[0],w[1],S[0],x.RGBA,S[1]),this._accumulationTextures[1].initialize(w[0],w[1],S[0],x.RGBA,S[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[E.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),(0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(b,x){if((0,r.assert)(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||this._texture===void 0)return;(0,r.logIf)(!this._texture||!this._texture.valid,r.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const E=this._context.gl;x!==void 0&&E.viewport(0,0,x[0],x[1]);const w=b%2,S=this._write=1-w,R=this._accumulationTextures[w],O=this._texture;R.bind(E.TEXTURE0),O.bind(E.TEXTURE1),this._program.bind(),E.uniform1f(this._uWeight,1/(b+1)),this._accumulationFBOs[S].bind(E.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[S].unbind(E.DRAW_FRAMEBUFFER),R.unbind(E.TEXTURE0),O.unbind(E.TEXTURE1)}set texture(b){this.assertInitialized(),this._texture!==b&&(this._texture=b,this._altered.alter("texture"))}set precision(b){this.assertInitialized(),this._precision!==b&&(this._precision=b,this._altered.alter("precision"))}set passThrough(b){this.assertInitialized(),this._passThrough!==b&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=b,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}t.AccumulatePass=_,n([d.Initializable.initialize()],_.prototype,"initialize",null),n([d.Initializable.uninitialize()],_.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],_.prototype,"update",null),n([d.Initializable.assert_initialized()],_.prototype,"frame",null)},7501:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AllocationRegister=void 0;const n=i(7032),r=i(9504);t.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new n.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(c){(0,r.assert)(this._bytesByIdentifier.has(c),"allocation identifier unknown")}createUniqueIdentifier(c){let f=c,d=2;for(;this._bytesByIdentifier.has(f);)f=`${c}-${d}`,++d;return this._bytesByIdentifier.set(f,0),f}deleteUniqueIdentifier(c){(0,r.assert)(this._bytesByIdentifier.has(c),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(c)}allocate(c,f){if(this.assertIdentifier(c),(0,r.assert)(f>=0,`positive number of bytes expected for allocation, given ${f}`),f===0)return;const d=this._bytesByIdentifier.get(c)+f;this._bytesByIdentifier.set(c,d),this._bytes=this._bytes+f,this.bytesNext()}deallocate(c,f){this.assertIdentifier(c);const d=this._bytesByIdentifier.get(c);(0,r.assert)(f>=0,`positive number of bytes expected for deallocation, given ${f}`),(0,r.assert)(f<=d,`deallocation cannot exceed previous allocations of ${d}, given ${f}`),f!==0&&(this._bytesByIdentifier.set(c,d-f),this._bytes=this._bytes-f,this.bytesNext())}reallocate(c,f){this.assertIdentifier(c),(0,r.assert)(f>=0,`positive number of bytes expected for reallocation, given ${f}`);const d=this._bytesByIdentifier.get(c);d!==f&&(this._bytes=this._bytes-d,this._bytesByIdentifier.set(c,f),this._bytes=this._bytes+f,this.bytesNext())}allocated(c){return c===void 0?this._bytes:(this.assertIdentifier(c),this._bytesByIdentifier.get(c))}toString(){const c=new Array;return this._bytesByIdentifier.forEach((f,d)=>{c.push(`${d}: ${(0,r.prettyPrintBytes)(f)}`)}),c.join(", ")}bytesToString(c){return(0,r.prettyPrintBytes)(this.allocated(c))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},2419:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiAliasingKernel=void 0;const n=i(3039);class r extends n.RandomSquareKernel{constructor(f){super(f)}generate(){switch(this._width){case 8:this.fromJSON(i(3058));break;case 64:this.fromJSON(i(9148));break;case 128:this.fromJSON(i(6399));break;default:super.generate()}}}t.AntiAliasingKernel=r},9504:(v,t,i)=>{const n=i(5150);var r;(function(c){let f,d=2;c.logVerbosity=function(E){return E!==void 0&&(d=Math.max(-1,E)),d},function(E){E[E.Debug=3]="Debug",E[E.Info=2]="Info",E[E.Warning=1]="Warning",E[E.Error=0]="Error"}(f=c.LogLevel||(c.LogLevel={}));const h=(E,w)=>{if(!E)throw new EvalError(w)},s=(E,w)=>{};function u(E,...w){E>d||console.log(`[${E}]`,...w)}function o(E){const w=`${E}-start`;c.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),c.assert(performance.getEntriesByName(w).length===0,`expected mark identifier to not already exists, given ${w}`),performance.mark(w)}function m(E,w,S=0){const R=`${E}-start`,O=`${E}-end`;c.assert(performance.getEntriesByName(E).length===0,`expected mark identifier to not already exists, given ${E}`),c.assert(performance.getEntriesByName(O).length===0,`expected mark identifier to not already exists, given ${O}`),performance.mark(O),performance.measure(E,R,O);const I=performance.getEntriesByName(E)[0];performance.clearMarks(R),performance.clearMarks(O),performance.clearMeasures(E);const D=w===void 0||w.length===0?0:2,j=Math.max(D,S-E.length-(w?w.length:0)-1),k=x(I.duration);u(f.Debug,`${E}${" ".repeat(j)}${w||""} | ${k}`)}c.assert=h,c.assertions=function(E){return E!==void 0&&(c.assert=E?h:s),c.assert!==s},c.log=u,c.logIf=function(E,w,...S){E&&u(w,...S)},c.logPerformanceStart=o,c.logPerformanceStartIf=function(E,w){E&&o(w)},c.logPerformanceStop=m,c.logPerformanceStopIf=function(E,w,S,R=0){E&&m(w,S,R)},c.rand=function(E=0,w=1){return Math.random()*(w-E)+E},c.isPowerOfTwo=function(E){return Number.isInteger(E)&&Number.isInteger(Math.log2(E))},c.upperPowerOfTwo=function(E){return--E,E|=E>>1,E|=E>>2,E|=E>>4,E|=E>>8,E|=E>>16,++E};const _=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];c.prettyPrintBytes=function(E){const w=E>0?Math.floor(Math.log(E)/Math.log(1024)):0,S=E/Math.pow(1024,w);return`${w>0?S.toFixed(3):S}${_[w]}B`};const p=["ms","ns","μs","ms","s"],b=[0,1e6,1e3,1,.001];function x(E){let w=E>0?Math.max(1,Math.floor(Math.log(10*E)/Math.log(1e3))+3):0;return w=(0,n.clamp)(w,0,4),`${(E*b[w]).toFixed(3)}${p[w]}`}c.prettyPrintMilliseconds=x,c.bitInBitfield=function(E,w){return w!==void 0&&(E&w)===w},c.RAD2DEG=57.29577951308232,c.DEG2RAD=.017453292519943295,c.GETsearch=function(){var w,S;let E=window.location.search;return E||(E=((S=(w=window.top)==null?void 0:w.location)==null?void 0:S.search)||""),E},c.GETparameter=function(E){var R,O;const w=new RegExp(`${E}=([^&]+)`);let S=window.location.search.match(w);if(S||(S=((O=(R=window.top)==null?void 0:R.location)==null?void 0:O.search.match(w))||null),S)return S[1]},c.PATH_SEPARATOR="/",c.dirname=function(E){return E.includes(c.PATH_SEPARATOR)===!1?"":E.substr(0,E.lastIndexOf(c.PATH_SEPARATOR)).trimLeft()},c.basename=function(E){return E.includes(c.PATH_SEPARATOR)===!1?E:E.substr(E.lastIndexOf(c.PATH_SEPARATOR)+1).trimRight()}})(r||(r={})),v.exports=r},8263:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Benchmark=void 0,t.Benchmark=class{constructor(){this._running=!1,this._results=new Array,this._framePrepare=void 0,this._runsFinished=void 0}initialize(i,n,r,c,f){this._running?console.log("benchmark already in progress"):(this._framePrepare=c,this._runsFinished=f,this._running=!0,this._frames=0,this._runs=Math.max(0,i),this._framesForWarmup=Math.max(0,n),this._framesPerCycle=Math.max(1,r),this._results.length=this._runs,this._results.fill(0))}frame(){if(this._running===!1)return;++this._frames;const i=this._frames-this._framesForWarmup,n=i<0?i:i%this._framesPerCycle,r=i>=0?Math.floor(i/this._framesPerCycle):-1;i===1-this._framesForWarmup&&console.log("---- benchmark warmup ------"),i===0&&console.log("---- benchmark started -----"),i%this._framesPerCycle==0&&r>0&&(this._results[r-1]=(performance.now()-this._results[r-1])/this._framesPerCycle,console.log(" --  cycle: "+r.toString().padStart(2,"0")+", tpf: "+this._results[r-1].toFixed(4).padStart(9,"0")+", fps: "+(1e3/this._results[r-1]).toFixed(4).padStart(9,"0"))),i%this._framesPerCycle==0&&r>=0&&r<this._runs&&(this._results[r]=performance.now()),r>=this._runs?(this._running=!1,console.log("---- benchmark stopped -----"),this._framePrepare=void 0,this._runsFinished(this._runs,this._framesForWarmup,this._framesPerCycle,this._results),this._runsFinished=void 0):this._framePrepare(n,this._framesForWarmup,this._framesPerCycle,r)}get running(){return this._running}}},8196:function(v,t,i){var n=this&&this.__decorate||function(m,_,p,b){var x,E=arguments.length,w=E<3?_:b===null?b=Object.getOwnPropertyDescriptor(_,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,_,p,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(_,p,w):x(_,p))||w);return E>3&&w&&Object.defineProperty(_,p,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.BlitPass=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(4127),h=i(1896),s=i(4168),u=i(771);class o extends d.Initializable{constructor(_){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=_}functionBlit(){const _=this._context.gl;if(this._target.bind(_.DRAW_FRAMEBUFFER),this._framebuffer.bind(_.READ_FRAMEBUFFER),_.readBuffer(this._readBuffer),this._drawBuffer>=_.COLOR_ATTACHMENT1&&this._drawBuffer<=_.COLOR_ATTACHMENT15){const x=this._drawBuffer-_.COLOR_ATTACHMENT0,E=new Array(x+1).fill(_.NONE);E[x]=this._drawBuffer,_.drawBuffers(E)}else _.drawBuffers([this._drawBuffer]);_.enable(_.SCISSOR_TEST),_.scissor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),_.disable(_.SCISSOR_TEST);const p=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],b=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];_.blitFramebuffer(p[0],p[1],p[2],p[3],b[0],b[1],b[2],b[3],_.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(_.READ_FRAMEBUFFER),this._target.unbind(_.DRAW_FRAMEBUFFER)}programBlit(){this._program===void 0&&this.createProgram(),(0,c.assert)(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const _=this._context.gl,p=this._srcBounds?this._srcBounds:r.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),b=this._dstBounds?this._dstBounds:r.vec4.fromValues(0,0,this._target.width,this._target.height),x=r.vec4.div((0,f.v4)(),p,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),E=r.vec4.div((0,f.v4)(),b,[this._target.width,this._target.height,this._target.width,this._target.height]);_.viewport(b[0],b[1],b[2]-b[0],b[3]-b[1]),_.disable(_.DEPTH_TEST),_.depthMask(!1),this._program.bind(),_.uniform4fv(this._uSrcBounds,x),_.uniform4fv(this._uDstBounds,E),_.uniform1i(this._uNearest,this.filter===_.nearest);const w=this._framebuffer.texture(this._readBuffer);w.bind(_.TEXTURE0);const S=this._context.isWebGL2?_.DRAW_FRAMEBUFFER:_.FRAMEBUFFER;this._target.bind(S),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(S),w.unbind(),_.enable(_.DEPTH_TEST),_.depthMask(!0)}createProgram(){(0,c.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const _=this._context.gl,p=new u.Shader(this._context,_.VERTEX_SHADER,"blit.vert (blit)");p.initialize(i(3354));const b=new u.Shader(this._context,_.FRAGMENT_SHADER,"blit.frag (blit)");return b.initialize(i(6523)),this._program=new s.Program(this._context,"BlitProgram"),this._program.initialize([p,b],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),_.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(_){const p=this._context.gl;return _===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=_,this._ndcTriangleShared=!0),this._filter=p.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){(0,c.logIf)(!this._target||!this._target.valid,c.LogLevel.Warning,`valid target expected, given ${this._target}`),(0,c.logIf)(!this._framebuffer||!this._framebuffer.valid,c.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const _=this._context.gl;switch(this._readBuffer){case _.DEPTH_ATTACHMENT:case _.STENCIL_ATTACHMENT:case _.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&this._enforceProgramBlit===!1)return this.functionBlit();this.programBlit()}set framebuffer(_){this.assertInitialized(),this._framebuffer=_}set readBuffer(_){this.assertInitialized(),this._readBuffer=_}set drawBuffer(_){this.assertInitialized(),this._drawBuffer=_}set target(_){this.assertInitialized(),this._target=_}set filter(_){this._filter=_}set srcBounds(_){this._srcBounds=_?r.vec4.clone(_):void 0}set dstBounds(_){this._dstBounds=_?r.vec4.clone(_):void 0}set enforceProgramBlit(_){this._enforceProgramBlit=_}}t.BlitPass=o,n([d.Initializable.initialize()],o.prototype,"initialize",null),n([d.Initializable.uninitialize()],o.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],o.prototype,"frame",null)},7340:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._target=d.DEFAULT_BUFFER}create(s){const u=this._context.gl;return this._object=u.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&((0,r.assert)(s===u.ARRAY_BUFFER||s===u.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=s),this._object}delete(){(0,r.assert)(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=d.DEFAULT_BUFFER}bind(){(0,r.assert)(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,d.DEFAULT_BUFFER)}data(s,u,o=!0,m=!0){const _=this.context.gl;o&&this.bind(),_.bufferData(this._target,s,u),m&&this.unbind(),this._valid=_.isBuffer(this._object)&&_.getError()===_.NO_ERROR;const p=typeof s=="number"?s:s.byteLength,b=this._valid?p:0;this.context.allocationRegister.reallocate(this._identifier,b)}subData(s,u,o=0,m=0,_=!0,p=!0){const b=this.context.gl;_&&this.bind(),this.context.gl2facade.bufferSubData(this._target,s,u,o,m),p&&this.unbind(),this._valid=b.getError()===b.NO_ERROR}attribEnable(s,u,o,m=!1,_=0,p=0,b=!0,x=!0){const E=this.context.gl;b&&this.bind(),E.vertexAttribPointer(s,u,o,m,_,p),E.enableVertexAttribArray(s),x&&this.unbind()}attribEnableInt(s,u,o,m=0,_=0,p=!0,b=!0){const x=this.context.gl;p&&this.bind(),x.vertexAttribIPointer(s,u,o,m,_),x.enableVertexAttribArray(s),b&&this.unbind()}attribDisable(s,u=!0,o=!0){const m=this.context.gl;u&&this.bind(),m.disableVertexAttribArray(s),o&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}t.Buffer=d,d.DEFAULT_BUFFER=void 0,n([c.Initializable.assert_initialized()],d.prototype,"bind",null),n([c.Initializable.assert_initialized()],d.prototype,"unbind",null),n([c.Initializable.assert_initialized()],d.prototype,"data",null),n([c.Initializable.assert_initialized()],d.prototype,"attribEnable",null),n([c.Initializable.assert_initialized()],d.prototype,"attribEnableInt",null),n([c.Initializable.assert_initialized()],d.prototype,"attribDisable",null)},3025:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const n=i(3557),r=i(5150),c=i(9504),f=i(2813);class d{static calculateFovY(s,u){return 2*Math.atan(.5*s/u)}constructor(s,u,o){this._fovy=d.DEFAULT_FOVY,this._near=d.DEFAULT_NEAR,this._far=d.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=s?n.vec3.clone(s):n.vec3.clone(d.DEFAULT_EYE),this._center=u?n.vec3.clone(u):n.vec3.clone(d.DEFAULT_CENTER),this._up=o?n.vec3.clone(o):n.vec3.clone(d.DEFAULT_UP)}invalidate(s,u,o=!1){s&&(this._view=void 0,this._viewInverse=void 0),u&&(this._projection=void 0,this._projectionInverse=void 0),(s||u||o)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(s){n.vec3.equals(this._eye,s)||(this._eye=n.vec3.clone(s),this.invalidate(!0,!1))}get center(){return this._center}set center(s){n.vec3.equals(this._center,s)||(this._center=n.vec3.clone(s),this.invalidate(!0,!1))}get up(){return this._up}set up(s){n.vec3.equals(this._up,s)||(this._up=n.vec3.clone(s),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(s){this._fovy!==s&&(this._fovy=s,this.invalidate(!1,!0))}set fovx(s){const u=s*c.DEG2RAD,o=2*Math.atan(Math.tan(u/2)*(1/this.aspect))*c.RAD2DEG;this._fovy!==o&&(this._fovy=o,this.invalidate(!1,!0))}fovFromLens(s,u){const o=2*Math.atan(s/(2*u));this.fovx=o*c.RAD2DEG}get near(){return this._near}set near(s){this._near!==s&&(s>=this._far&&(0,c.log)(c.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${s}`),this._near=s,this.invalidate(!1,!0))}get far(){return this._far}set far(s){this._far!==s&&(this._near>=s&&(0,c.log)(c.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${s}`),this._far=s,this.invalidate(!1,!0))}set viewport(s){this._viewport[0]===s[0]&&this._viewport[1]===s[1]||(this._viewport=(0,f.duplicate2)(s),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(s){this._aspect!==s&&(this._aspect=s)}get aspect(){return this._aspect}get view(){return this._view||(this._view=n.mat4.lookAt((0,r.m4)(),this._eye,this._center,this._up)),this._view}get viewInverse(){return this._viewInverse!==void 0||(this._viewInverse=n.mat4.invert((0,r.m4)(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=n.mat4.perspective((0,r.m4)(),this.fovy*c.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return this._projectionInverse!==void 0||(this._projectionInverse=n.mat4.invert((0,r.m4)(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=n.mat4.multiply((0,r.m4)(),this.projection,this.view),this._viewProjection=n.mat4.multiply((0,r.m4)(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return this._viewProjectionInverse!==void 0||(this._viewProjectionInverse=n.mat4.invert((0,r.m4)(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:n.mat4.identity((0,r.m4)())}set postViewProjection(s){this._postViewProjection=s,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(s){this._altered=s}}t.Camera=d,d.DEFAULT_EYE=n.vec3.fromValues(0,0,1),d.DEFAULT_CENTER=n.vec3.fromValues(0,0,0),d.DEFAULT_UP=n.vec3.fromValues(0,1,0),d.DEFAULT_FOVY=45,d.DEFAULT_NEAR=2,d.DEFAULT_FAR=8},7344:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CameraModifier=void 0;const n=i(3025);t.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new n.Camera}set camera(r){this._camera!==r&&(this._camera=r,r!==void 0&&(Object.assign(this._reference,r),this.update()))}}},7858:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;const n=i(7032),r=i(3557),c=i(5150),f=i(9504),d=i(2813),h=i(3847),s=i(2527),u=i(8234),o=i(3975),m=i(4602),_=i(8216),p=i(9137),b=i(8870),x=i(5678),E=i(9217);class w extends p.Resizable{constructor(R,O){super(),this._framePrecisionSubject=new n.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new n.ReplaySubject(1),this._frameScaleSubject=new n.ReplaySubject(1),this._frameSizeSubject=new n.ReplaySubject(1),this._element=R instanceof HTMLCanvasElement?R:document.getElementById(R),this._element.addEventListener("webglcontextcreationerror",k=>{console.log(k.statusMessage||"Unknown error")},!1),this.observe(this._element),this._mouseEventProvider=new m.MouseEventProvider(this._element,200),this._touchEventProvider=new b.TouchEventProvider(this._element,200),this._pointerEventProvider=new _.PointerEventProvider(this._element,200),this._keyboardEventProvider=new x.KeyboardEventProvider(this._element,200),this._element.style.touchAction="none";const I=this._element.dataset;let D;this._context=s.Context.request(this._element,O),this.configureController(I),this.configureSizeAndScale(I),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),I.clearColor&&(D=(0,c.parseVec4)(I.clearColor),(0,f.logIf)(D===void 0,f.LogLevel.Warning,`data-clear-color could not be parsed, given '${I.clearColor}'`)),this._clearColor=D?new h.Color((0,d.tuple4)(D)):w.DEFAULT_CLEAR_COLOR;let j=I.accumulationFormat?I.accumulationFormat:w.DEFAULT_FRAME_PRECISION;j in E.Wizard.Precision||(j=w.DEFAULT_FRAME_PRECISION,(0,f.log)(f.LogLevel.Warning,`unknown frame precision '${I.accumulationFormat}' changed to '${j}'`)),this._framePrecision=j,this.framePrecisionNext()}configureController(R){let O,I;this._controller=new u.Controller,this._controller.block(),R.multiFrameNumber&&(O=parseInt(R.multiFrameNumber,10),(0,f.logIf)(isNaN(O),f.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${R.multiFrameNumber}'`)),R.debugFrameNumber&&(I=parseInt(R.debugFrameNumber,10),(0,f.logIf)(isNaN(I),f.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${R.debugFrameNumber}'`)),this._controller.multiFrameNumber=O||w.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=I||0;const D=!!O&&O!==this._controller.multiFrameNumber;(0,f.logIf)(D,f.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${R.multiFrameNumber}'`);const j=!!I&&I!==this._controller.debugFrameNumber;(0,f.logIf)(j,f.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${R.debugFrameNumber}'`)}configureSizeAndScale(R){let O,I;R.frameScale&&(O=(0,c.parseVec2)(R.frameScale),(0,f.logIf)(R.frameScale!==void 0&&O===void 0,f.LogLevel.Warning,`data-frame-scale could not be parsed, given '${R.frameScale}'`)),this._frameScale=O?(0,d.tuple2)(O):[1,1],R.frameSize&&(I=(0,c.parseVec2)(R.frameSize),(0,f.logIf)(R.frameSize!==void 0&&I===void 0,f.LogLevel.Warning,`data-frame-size could not be parsed, given '${R.frameSize}'`)),this._favorSizeOverScale=I!==void 0,this._frameSize=I?(0,d.tuple2)(I):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",R=>{R.preventDefault(),this.onContextLost()},!1),this._element.addEventListener("webglcontextrestored",()=>{this.onContextRestore()},!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){(0,f.log)(f.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){(0,f.log)(f.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const R=this._renderer;this.unbind(),this.bind(R),this._controller.unblock();const O=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=O}retrieveSize(){const R=p.Resizable.elementSize(this._element);R!==void 0?(this._size=[R[0],R[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),this._size[0]===0||this._size[1]===0)return(0,f.log)(f.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(R){this._renderer!==R&&(this.unbind(),R!==void 0&&((0,f.assert)(this._controller.blocked,"expected controller to be blocked"),this._renderer=R,this._renderer.initialize(this.context,O=>this._controller.update(O),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider,keyboardEventProvider:this._keyboardEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){this._renderer!==void 0&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(R){this.bind(R)}get frameScale(){return this._frameScale}set frameScale(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,f.log)(f.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,f.logIf)(R[0]<0||R[0]>8,f.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${R[0]}`),(0,f.logIf)(R[1]<0||R[1]>8,f.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${R[0]}`);const O=r.vec2.create();(0,c.clamp2)(O,R,[0,0],[8,8]);const I=r.vec2.create();r.vec2.mul(I,this._size,O),r.vec2.max(I,[1,1],I),r.vec2.round(I,I),r.vec2.div(O,I,this._size),(0,f.logIf)(!r.vec2.exactEquals(O,R),2,`frame scale was adjusted to ${O.toString()}, given ${R.toString()}`),this._frameScale=(0,d.tuple2)(O),this._frameSize=(0,d.tuple2)(I),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(R){if(!isFinite(R[0])||!isFinite(R[1]))return void(0,f.log)(f.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${R}]`);(0,f.logIf)(R[0]<1||R[0]>8*this._size[0],f.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${R[0]}`),(0,f.logIf)(R[1]<1||R[1]>8*this._size[1],f.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${R[1]}`);const O=r.vec2.create();(0,c.clamp2)(O,R,[1,1],[8*this._size[0],8*this._size[1]]),r.vec2.round(O,O),(0,f.logIf)(!r.vec2.exactEquals(O,R),f.LogLevel.Warning,`frame size was adjusted to ${O.toString()}, given ${R.toString()}`);const I=r.vec2.create();r.vec2.div(I,O,this._size),this._frameScale=(0,d.tuple2)(I),this._frameSize=(0,d.tuple2)(O),this._favorSizeOverScale=!r.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(R){this._clearColor=R,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(R){this._framePrecision=R,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}get keyboardEventProvider(){return this._keyboardEventProvider}testLoseContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.loseContext()}testRestoreContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(R,O){this._eyeGazeEventProvider=new o.EyeGazeEventProvider(R,O)}}t.Canvas=w,w.DEFAULT_CLEAR_COLOR=new h.Color([.203,.227,.25,1]),w.DEFAULT_FRAME_PRECISION=E.Wizard.Precision.auto,w.DEFAULT_MULTI_FRAME_NUMBER=0},8596:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRecorder=void 0;const n=i(9504);class r{static isSupported(){return window.MediaRecorder!==void 0}static isMIMETypeSupported(f){return MediaRecorder.isTypeSupported(f)}constructor(f){(0,n.assert)(r.isSupported(),"Recording the canvas is not supported."),this._canvas=f,this._state=r.State.INACTIVE,this._images=new Array}start(f,d="video/webm",h=4194304){(0,n.assert)(f>=0,"FPS has to be positive"),(0,n.assert)(this._state===r.State.INACTIVE,"Recorder has to be inactive."),(0,n.assert)(r.isMIMETypeSupported(d),`MIME type: ${d} is not supported.`),this._stream=this._canvas.element.captureStream(f),this._recorder=new MediaRecorder(this._stream,{mimeType:d,bitsPerSecond:h}),this._images.length=0,this._mimeType=d,this._recorder.ondataavailable=s=>this._images.push(s.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=r.State.RECORDING}stop(){(0,n.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive.");const f=this._stream.getTracks();(0,n.assert)(f.length===1,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),f[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=r.State.INACTIVE}pause(){(0,n.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=r.State.PAUSED}resume(){(0,n.assert)(this._state!==r.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=r.State.RECORDING}frame(){(0,n.assert)(this._state===r.State.RECORDING,"Recorder has to be recording.");const f=this._stream.getTracks();(0,n.assert)(f.length===1,"CanvasRecorder uses unknown implementation of MediaStream API."),(0,n.assert)(this._stream.requestFrame||f[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():f[0].requestFrame()}download(f){const d=URL.createObjectURL(this.blob),h=document.createElement("a");h.style.display="none",h.setAttribute("href",d),h.setAttribute("download",f),document.body.appendChild(h),h.click(),setTimeout(()=>{document.body.removeChild(h),window.URL.revokeObjectURL(d)},256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(f){this._onImagesAvailable=f}}t.CanvasRecorder=r,function(c){(function(f){f[f.INACTIVE=0]="INACTIVE",f[f.RECORDING=1]="RECORDING",f[f.PAUSED=2]="PAUSED"})(c.State||(c.State={}))}(r||(t.CanvasRecorder=r={}))},7564:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeLookup=void 0;const n=i(9504);class r{static alter(f,d){(0,n.assert)(d.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),d.any=!0;const h=f.split("."),s=h.shift();if((0,n.assert)(s===""||d.hasOwnProperty(s),`expected object to have key '${s}' in order to capture alterations`),s!==""&&typeof d[s]!="object")return void(d[s]=!0);if(s!==""&&h.length>0)return void r.alter(h.join("."),d[s]);const u=s!==""?d[s]:d;for(const o of Object.getOwnPropertyNames(u))o!=="any"&&r.alter(o,u)}static reset(f){for(const d of Object.getOwnPropertyNames(f))typeof f[d]!="object"?f[d]=!1:r.reset(f[d])}alter(f){return r.alter(f,this)}reset(){return r.reset(this)}}t.ChangeLookup=r},3847:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const n=i(3557),r=i(5150),c=i(9504),f=i(2813);class d{static hue2rgb(s,u,o){return(0,c.assert)(o>=-1&&o<=2,"t is expected to be between -1 and 2"),o<0?o+=1:o>1&&(o-=1),6*o<1?s+6*(u-s)*o:2*o<1?u:3*o<2?s+6*(u-s)*(.6666666666666666-o):s}static to2CharHexCode(s){return(s<.060784313725490195?"0":"")+Math.round(255*s).toString(16)}static hsl2rgb(s){const u=(0,f.clampf3)(s,"HSL input");if(u[1]===0)return[u[2],u[2],u[2]];const o=u[2]<.5?u[2]*(1+u[1]):u[2]+u[1]-u[1]*u[2],m=2*u[2]-o;return[d.hue2rgb(m,o,u[0]+.3333333333333333),d.hue2rgb(m,o,u[0]),d.hue2rgb(m,o,u[0]-.3333333333333333)]}static rgb2hsl(s){const u=(0,f.clampf3)(s,"RGB input"),o=[0,0,0],m=Math.min(u[0],u[1],u[2]),_=Math.max(u[0],u[1],u[2]),p=_-m;if(o[2]=.5*(_+m),p===0)return o;o[1]=o[2]<.5?p/(_+m):p/(2-_-m);const b=((_-u[0])/6+p/2)/p,x=((_-u[1])/6+p/2)/p,E=((_-u[2])/6+p/2)/p;return u[0]===_?o[0]=E-x:u[1]===_?o[0]=b-E+.3333333333333333:o[0]=x-b+.6666666666666666,o}static lab2xyz(s){const u=(0,f.clampf3)(s,"LAB input"),o=(100*u[0]+16)/116,m=(256*u[1]-128)/500+o,_=o-(256*u[2]-128)/200,p=Math.pow(m,3),b=Math.pow(o,3),x=Math.pow(_,3);return[.95047*(p>.008856?p:(m-.13793103448275862)/7.787),1*(b>.008856?b:(o-.13793103448275862)/7.787),1.08883*(x>.008856?x:(_-.13793103448275862)/7.787)]}static xyz2lab(s){const u=[s[0]/.95047,s[1]/1,s[2]/1.08883],o=u[0]>.008856?Math.cbrt(u[0]):7.787*u[0]+16/116,m=u[1]>.008856?Math.cbrt(u[1]):7.787*u[1]+16/116,_=u[2]>.008856?Math.cbrt(u[2]):7.787*u[2]+16/116;return(0,f.clampf3)([(116*m-16)/100,(500*(o-m)+128)/256,(200*(m-_)+128)/256])}static xyz2rgb(s){const u=2.04137*s[0]+-.56495*s[1]+-.34469*s[2],o=-.96927*s[0]+1.87601*s[1]+.04156*s[2],m=.01345*s[0]+-.11839*s[1]+1.01541*s[2];return(0,f.clampf3)([u>0?Math.pow(u,.4547069271758437):0,o>0?Math.pow(o,.4547069271758437):0,m>0?Math.pow(m,.4547069271758437):0])}static rgb2xyz(s){const u=(0,f.clampf3)(s,"RGB input"),o=Math.pow(u[0],2.19921875),m=Math.pow(u[1],2.19921875),_=Math.pow(u[2],2.19921875);return[.57667*o+.18555*m+.18819*_,.29738*o+.62735*m+.07527*_,.02703*o+.07069*m+.9911*_]}static lab2rgb(s){return d.xyz2rgb(d.lab2xyz(s))}static rgb2lab(s){return d.xyz2lab(d.rgb2xyz(s))}static cmyk2rgb(s){const u=(0,f.clampf4)(s,"CMYK input"),o=1-u[3];return[(1-u[0])*o,(1-u[1])*o,(1-u[2])*o]}static rgb2cmyk(s){const u=(0,f.clampf3)(s,"RGB input"),o=1-Math.max(u[0],u[1],u[2]),m=1-o,_=m===0?0:1/m;return[(m-u[0])*_,(m-u[1])*_,(m-u[2])*_,o]}static hex2rgba(s){const u=[0,0,0,d.DEFAULT_ALPHA];if(!d.HEX_FORMAT_REGEX.test(s))return(0,c.log)(c.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${s}'`),u;const o=s.startsWith("0x")?2:s.startsWith("#")?1:0,m=Math.floor((s.length-o)/3),_=m-1;return u[0]=parseInt(s[o+0*m]+s[o+0*m+_],16)/255,u[1]=parseInt(s[o+1*m]+s[o+1*m+_],16)/255,u[2]=parseInt(s[o+2*m]+s[o+2*m+_],16)/255,s.length-o!=4&&s.length-o!=8||(u[3]=parseInt(s[o+3*m]+s[o+3*m+_],16)/255),(0,c.assert)(!(isNaN(u[0])||isNaN(u[1])||isNaN(u[2])||isNaN(u[3])),`expected well formated hexadecimal RGBA string, given '${s}'`),u}static rgb2hex(s){const u=(0,f.clampf3)(s,"RGB input");return"#"+d.to2CharHexCode(u[0])+d.to2CharHexCode(u[1])+d.to2CharHexCode(u[2])}static rgba2hex(s){const u=(0,f.clampf4)(s,"RGBA input");return"#"+d.to2CharHexCode(u[0])+d.to2CharHexCode(u[1])+d.to2CharHexCode(u[2])+d.to2CharHexCode(u[3])}static lerp(s,u,o,m=d.Space.LAB){if(o<=0)return new d(s.rgba);if(o>=1)return new d(u.rgba);const _=n.vec4.create();switch(m){case d.Space.CMYK:n.vec4.lerp(_,s.cmyk,u.cmyk,o);const p=(0,r.mix)(s.a,u.a,o);return new d().fromCMYK(_[0],_[1],_[2],_[3],p);case d.Space.LAB:return n.vec4.lerp(_,s.laba,u.laba,o),new d().fromLAB(_[0],_[1],_[2],_[3]);case d.Space.HSL:return n.vec4.lerp(_,s.hsla,u.hsla,o),new d().fromHSL(_[0],_[1],_[2],_[3]);case d.Space.RGB:return n.vec4.lerp(_,s.rgba,u.rgba,o),new d().fromRGB(_[0],_[1],_[2],_[3])}}constructor(s,u){this._rgba=[0,0,0,d.DEFAULT_ALPHA],this._altered=!1,s!==void 0&&(s.length===3&&u!==void 0?this.fromF32(s[0],s[1],s[2],u):s.length===4?(this.fromF32(s[0],s[1],s[2],s[3]),(0,c.assert)(u===void 0,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(s[0],s[1],s[2]))}equals(s){return(0,f.equals4)(this._rgba,s._rgba)}fromF32(s,u,o,m=d.DEFAULT_ALPHA){const _=(0,f.duplicate4)(this._rgba);return this._rgba[0]=(0,f.clampf)(s,"red value"),this._rgba[1]=(0,f.clampf)(u,"green value"),this._rgba[2]=(0,f.clampf)(o,"blue value"),this._rgba[3]=(0,f.clampf)(m,"alpha value"),this._altered=!(0,f.equals4)(this._rgba,_),this}fromUI8(s,u,o,m=Math.floor(255*d.DEFAULT_ALPHA)){const _=(0,f.duplicate4)(this._rgba);return this._rgba[0]=(0,r.clamp)(s,0,255)/255,this._rgba[1]=(0,r.clamp)(u,0,255)/255,this._rgba[2]=(0,r.clamp)(o,0,255)/255,this._rgba[3]=(0,r.clamp)(m,0,255)/255,this._altered=!(0,f.equals4)(this._rgba,_),this}fromRGB(s,u,o,m=d.DEFAULT_ALPHA){const _=(0,f.duplicate4)(this._rgba);return this._rgba=(0,f.clampf4)([s,u,o,m],"RGBA input"),this._altered=!(0,f.equals4)(this._rgba,_),this}fromHSL(s,u,o,m=d.DEFAULT_ALPHA){const _=(0,f.duplicate4)(this._rgba),p=d.hsl2rgb([s,u,o]),b=(0,f.clampf)(m,"ALPHA input");return this._rgba=[p[0],p[1],p[2],b],this._altered=!(0,f.equals4)(this._rgba,_),this}fromLAB(s,u,o,m=d.DEFAULT_ALPHA){const _=(0,f.duplicate4)(this._rgba),p=d.lab2rgb([s,u,o]),b=(0,f.clampf)(m,"ALPHA input");return this._rgba=[p[0],p[1],p[2],b],this._altered=!(0,f.equals4)(this._rgba,_),this}fromCMYK(s,u,o,m,_=d.DEFAULT_ALPHA){const p=(0,f.duplicate4)(this._rgba),b=d.cmyk2rgb([s,u,o,m]),x=(0,f.clampf)(_,"ALPHA input");return this._rgba=[b[0],b[1],b[2],x],this._altered=!(0,f.equals4)(this._rgba,p),this}fromHex(s){const u=(0,f.duplicate4)(this._rgba);return this._rgba=d.hex2rgba(s),this._altered=!(0,f.equals4)(this._rgba,u),this}gray(s=d.GrayscaleAlgorithm.LinearLuminance){switch(s){case d.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case d.GrayscaleAlgorithm.LeastSaturatedVariant:return .5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case d.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case d.GrayscaleAlgorithm.LinearLuminance:return .2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(s,u=!0){switch(s){case d.Space.RGB:return u?this.rgba:this.rgb;case d.Space.LAB:return u?this.laba:this.lab;case d.Space.CMYK:return u?this.cmyka:this.cmyk;case d.Space.HSL:return u?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const s=new Uint8Array(3);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s}get rgbF32(){const s=new Float32Array(3);return s[0]=this._rgba[0],s[1]=this._rgba[1],s[2]=this._rgba[2],s}get rgba(){return this._rgba}get rgbaUI8(){const s=new Uint8Array(4);return s[0]=Math.round(255*this._rgba[0]),s[1]=Math.round(255*this._rgba[1]),s[2]=Math.round(255*this._rgba[2]),s[3]=Math.round(255*this._rgba[3]),s}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return d.rgb2hex(this.rgb)}get hexRGBA(){return d.rgba2hex(this._rgba)}get hsl(){return d.rgb2hsl(this.rgb)}get hsla(){const s=d.rgb2hsl(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get lab(){return d.rgb2lab(this.rgb)}get laba(){const s=d.rgb2lab(this.rgb);return[s[0],s[1],s[2],this._rgba[3]]}get cmyk(){return d.rgb2cmyk(this.rgb)}get cmyka(){const s=d.rgb2cmyk(this.rgb);return[s[0],s[1],s[2],s[3],this._rgba[3]]}get altered(){return this._altered}set altered(s){this._altered=s}}t.Color=d,d.DEFAULT_ALPHA=1,d.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(h){(function(s){s.Average="average",s.LinearLuminance="linear-luminance",s.LeastSaturatedVariant="least-saturated-variant",s.MinimumDecomposition="minimum-decomposition",s.MaximumDecomposition="maximum-decomposition"})(h.GrayscaleAlgorithm||(h.GrayscaleAlgorithm={})),function(s){s.RGB="rgb",s.HSL="hsl",s.LAB="lab",s.CMYK="cmyk"}(h.Space||(h.Space={}))}(d||(t.Color=d={}))},5837:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScale=void 0;const n=i(5150),r=i(9504),c=i(3847),f=i(64);class d{constructor(){this._hint=d.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(s){switch(s){case d.ArrayType.RGBA:case d.ArrayType.RGBAf:return 4;case d.ArrayType.RGB:case d.ArrayType.RGBf:default:return 3}}static fromPreset(s,u,o){return(0,f.fetchJsonAsync)(s,m=>{let _;for(const O of m)if(O.identifier===u){_=O;break}if(_===void 0)return;const p=_.format,b=d.stride(p),x=_.colors;let E=x.length-1;for(let O=0;O<x.length;++O)if(x[O].length===o*b){E=O;break}const w=x[E],S=_.positions;if(S===void 0)return d.fromArray(w,p,o,void 0);let R;for(let O=0;O<S.length;++O)S[O].length===w.length&&(R=S[O]);return d.fromArray(w,p,o,R)},d.SCHEMA.properties)}static fromArray(s,u,o,m){if(o===0||s.length===0)return new d;const _=s,p=d.stride(u),b=_.length/p,x=new Array(b);for(let O=0;O<_.length;O+=p){const I=new c.Color;switch(u){case d.ArrayType.RGB:I.fromUI8(_[O+0],_[O+1],_[O+2]);break;case d.ArrayType.RGBA:I.fromUI8(_[O+0],_[O+1],_[O+2],_[O+3]);break;case d.ArrayType.RGBf:I.fromF32(_[O+0],_[O+1],_[O+2]);break;case d.ArrayType.RGBAf:I.fromF32(_[O+0],_[O+1],_[O+2],_[O+3])}x[O/p]=I}const E=new d;if(m===void 0&&o===b)return E._colors=x,E;if(o===1&&E._colors.push(x[0]),m===void 0){(m=new Array(b))[0]=0;for(let O=1;O<b;++O)m[O]=O/(b-1)}(0,r.assert)(m.length===x.length,`expected number of positions (${m.length}) to match number of colors (${x.length})`);let w=0,S=w+1;const R=b-1;for(let O=0;O<o;++O){const I=O===0?0:O/(o-1);if(I<=m[w]){E._colors.push(x[w]);continue}if(m[R]<=I){E._colors.push(x[R]);continue}for(let j=w+1;j<b;++j)if(!(m[j]<I)){S=j,w=j-1;break}const D=(I-m[w])/(m[S]-m[w]);E._colors.push(c.Color.lerp(x[w],x[S],D,c.Color.Space.LAB))}return E}lerp(s,u=c.Color.Space.LAB){if(this._colors.length===0)return;if(this._colors.length===1)return this._colors[0];const o=(0,n.clamp)(s,0,1);if(o<=0)return this._colors[0];if(o>=1)return this._colors[this._colors.length-1];const m=s*this._colors.length,_=Math.floor(m),p=_+1;return p>=this._colors.length?this._colors[this._colors.length-1]:((0,r.assert)(p<this._colors.length,`expected upper not exceed maximum color index: ${p} < ${this._colors.length}`),this._hint===d.InterpolationHint.Nearest?this._colors[m-_<=p-m?_:p]:c.Color.lerp(this._colors[_],this._colors[p],m-_,u))}color(s){if(!(s<0||s>=this._colors.length))return this._colors[s]}get colors(){return this._colors}set colors(s){this._colors=s}set hint(s){this._hint=s}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(s=c.Color.Space.RGB,u=!0){const o=this._colors.length,m=u?4:3,_=new Uint8Array(o*m);for(let p=0;p<o;++p){const b=this._colors[p].tuple(s,u);_[p*m+0]=255*b[0],_[p*m+1]=255*b[1],_[p*m+2]=255*b[2],u&&b.length===4&&(_[p*m+3]=255*b[3])}return _}bitsF32(s=c.Color.Space.RGB,u=!0){const o=this._colors.length,m=u?4:3,_=new Float32Array(o*m);for(let p=0;p<o;++p){const b=this._colors[p].tuple(s,u);_[p*m+0]=b[0],_[p*m+1]=b[1],_[p*m+2]=b[2],u&&b.length===4&&(_[p*m+3]=b[3])}return _}}t.ColorScale=d,d.SCHEMA=i(421),function(h){(function(s){s.Linear="linear",s.Nearest="nearest"})(h.InterpolationHint||(h.InterpolationHint={})),function(s){s.sequential="sequential",s.diverging="diverging",s.qualitative="qualitative"}(h.ScaleType||(h.ScaleType={})),function(s){s.RGB="rgb",s.RGBf="rgbf",s.RGBA="rgba",s.RGBAf="rgbaf"}(h.ArrayType||(h.ArrayType={}))}(d||(t.ColorScale=d={}))},2527:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const n=i(9504),r=i(3513),c=i(7501),f=i(5557),d=i(5304),h=i(5060),s=i(829);class u{static createMasqueradeFromGETorDataAttribute(m){return f.ContextMasquerade.fromGET()||(m.msqrdH?f.ContextMasquerade.fromHash(m.msqrdH):m.msqrdP?f.ContextMasquerade.fromPreset(m.msqrdP):void 0)}static request(m,_=u.DEFAULT_ATTRIBUTES){const p=m.dataset,b=u.createMasqueradeFromGETorDataAttribute(p);let x,E=b?b.backend:p.backend?p.backend.toLowerCase():"auto";switch(E in u.BackendRequestType||((0,n.log)(n.LogLevel.Warning,`unknown backend '${p.backend}' changed to '${u.BackendRequestType.auto}'`),E="auto"),E){case u.BackendRequestType.webgl:break;case u.BackendRequestType.experimental:case u.BackendRequestType.webgl1:case u.BackendRequestType.experimental1:E=u.BackendRequestType.webgl;break;case u.BackendRequestType.webgl2:case u.BackendRequestType.experimental2:E=u.BackendRequestType.webgl2;break;default:E=u.BackendRequestType.auto}return E!==u.BackendRequestType.webgl&&(x=this.requestWebGL2(m,_)),x||(x=this.requestWebGL1(m,_),(0,n.logIf)(x!==void 0&&E===u.BackendRequestType.webgl2,n.LogLevel.Info,`backend changed to '${u.BackendRequestType.webgl}', given '${E}'`)),(0,n.assert)(!!x,"creating a context failed"),new u(x,b)}static requestWebGL1(m,_=u.DEFAULT_ATTRIBUTES){let p=m.getContext(u.BackendRequestType.webgl,_);return p||(p=m.getContext(u.BackendRequestType.experimental,_),p===null?void 0:p)}static requestWebGL2(m,_=u.DEFAULT_ATTRIBUTES){let p=m.getContext(u.BackendRequestType.webgl2,_);return p||(p=m.getContext(u.BackendRequestType.experimental2,_),p===null?void 0:p)}queryAttributes(){const m=this._context.getContextAttributes();m!==null?this._attributes=m:(0,n.log)(n.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(m){if(this._mask&&this._mask.extensionsConceal.indexOf(m)>-1)return!1;switch(this._backend){case u.BackendType.WebGL1:(0,n.assert)(d.WEBGL1_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL1`);break;case u.BackendType.WebGL2:(0,n.assert)(d.WEBGL2_DEFAULT_EXTENSIONS.indexOf(m)===-1,`extension ${m} supported by default in WebGL2`),(0,n.assert)(d.WEBGL2_EXTENSIONS.indexOf(m)>-1,`extension ${m} not available to WebGL2`)}return this._extensions.indexOf(m)>-1}enable(m){for(const _ of m)this.isWebGL1&&d.WEBGL1_EXTENSIONS.indexOf(_)===-1||this.isWebGL2&&d.WEBGL2_EXTENSIONS.indexOf(_)===-1||this.supports(_)!==!1&&this.extension(void 0,_)}queryExtensionSupport(){const m=this._context.getSupportedExtensions();if(m!==null){for(const _ of m)this._mask&&this._mask.extensionsConceal.indexOf(_)>-1||this._extensions.push(_);this._backend===u.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===u.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else(0,n.log)(n.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(m,_){return m===void 0&&((0,n.assert)(this.supports(_),`extension ${_} expected to be supported`),m=this._context.getExtension(_)),m}constructor(m,_){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new c.AllocationRegister,this._context=m,this._mask=_;const p=m.toString();{const b=/WebGLRenderingContext/.test(p)||/CaptureContext/.test(p),x=/WebGL2RenderingContext/.test(p);this._backend=b?u.BackendType.WebGL1:x?u.BackendType.WebGL2:void 0}if((0,n.assert)(this._backend!==void 0&&this._backend.valueOf()!==u.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${p}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const b in this._mask.functionsUndefine)this._context[b]=void 0;this._gl2=new s.GL2Facade(this)}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case u.BackendType.WebGL1:return"WebGL";case u.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===u.BackendType.WebGL1}get isWebGL2(){return this._backend===u.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case u.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case u.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case u.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case u.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return this._context.blitFramebuffer!==void 0}get supportsReadBuffer(){return this._context.readBuffer!==void 0}get supportsTexImage3D(){return this._context.texImage3D!==void 0}param(m){return(0,n.assert)(!!this._context,"expected context to be valid"),this._context.getParameter(m)}hash(){return h.ExtensionsHash.encode(this._backend,this._extensions)}about(){const m="ok",_="na";if(this._backend===u.BackendType.Invalid)return new Array;(0,n.assert)(!!this._context,"expected context to be valid");const p=this._context,b=new Array;b.push(["BACKEND (GLOPERATE)",this.backend]),b.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),b.push(["RENDERER",this.param(p.RENDERER)]),b.push(["VENDOR",this.param(p.VENDOR)]),b.push(["VERSION",this.param(p.VERSION)]),b.push(["SHADING_LANGUAGE_VERSION",this.param(p.SHADING_LANGUAGE_VERSION)]),b.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):_]),b.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):_]),b.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),b.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),b.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),b.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),b.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),b.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),b.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),b.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),b.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),b.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),b.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),b.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),b.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),b.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),b.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),b.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(p.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(p.MAX_CUBE_MAP_TEXTURE_SIZE)]),b.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(p.MAX_FRAGMENT_UNIFORM_VECTORS)]),b.push(["MAX_RENDERBUFFER_SIZE",this.param(p.MAX_RENDERBUFFER_SIZE)]),b.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(p.MAX_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_TEXTURE_SIZE",this.param(p.MAX_TEXTURE_SIZE)]),b.push(["MAX_VARYING_VECTORS",this.param(p.MAX_VARYING_VECTORS)]),b.push(["MAX_VERTEX_ATTRIBS",this.param(p.MAX_VERTEX_ATTRIBS)]),b.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(p.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),b.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(p.MAX_VERTEX_UNIFORM_VECTORS)]);const x=this.param(p.MAX_VIEWPORT_DIMS);if(b.push(["MAX_VIEWPORT_DIMS (WIDTH)",x?x[0]:null]),b.push(["MAX_VIEWPORT_DIMS (HEIGHT)",x?x[1]:null]),this.isWebGL2){const E=this._context;b.push(["MAX_3D_TEXTURE_SIZE",this.param(E.MAX_3D_TEXTURE_SIZE)]),b.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(E.MAX_ARRAY_TEXTURE_LAYERS)]),b.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(E.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),b.push(["MAX_COLOR_ATTACHMENTS",this.param(E.MAX_COLOR_ATTACHMENTS)]),b.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),b.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(E.MAX_COMBINED_UNIFORM_BLOCKS)]),b.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),b.push(["MAX_DRAW_BUFFERS",this.param(E.MAX_DRAW_BUFFERS)]),b.push(["MAX_ELEMENT_INDEX",this.param(E.MAX_ELEMENT_INDEX)]),b.push(["MAX_ELEMENTS_INDICES",this.param(E.MAX_ELEMENTS_INDICES)]),b.push(["MAX_ELEMENTS_VERTICES",this.param(E.MAX_ELEMENTS_VERTICES)]),b.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(E.MAX_FRAGMENT_INPUT_COMPONENTS)]),b.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(E.MAX_FRAGMENT_UNIFORM_BLOCKS)]),b.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(E.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),b.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(E.MAX_PROGRAM_TEXEL_OFFSET)]),b.push(["MAX_SAMPLES",this.param(E.MAX_SAMPLES)]),b.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(E.MAX_SERVER_WAIT_TIMEOUT)]),b.push(["MAX_TEXTURE_LOD_BIAS",this.param(E.MAX_TEXTURE_LOD_BIAS)]),b.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),b.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),b.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(E.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),b.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(E.MAX_UNIFORM_BLOCK_SIZE)]),b.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(E.MAX_UNIFORM_BUFFER_BINDINGS)]),b.push(["MAX_VARYING_COMPONENTS",this.param(E.MAX_VARYING_COMPONENTS)]),b.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(E.MAX_VERTEX_OUTPUT_COMPONENTS)]),b.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(E.MAX_VERTEX_UNIFORM_BLOCKS)]),b.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(E.MAX_VERTEX_UNIFORM_COMPONENTS)]),b.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(E.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const E of d.WEBGL1_EXTENSIONS)b.push([E,this.supports(E)?m:_]);else if(this.isWebGL2){for(const E of d.WEBGL2_DEFAULT_EXTENSIONS)b.push([`${E} (default)`,m]);for(const E of d.WEBGL2_EXTENSIONS)b.push([E,this.supports(E)?m:_])}return b}aboutString(){const m=this.about();let _=0;for(const E of m)_=Math.max(E[0].length,_);let p=0,b="";const x=this.isWebGL2?63+d.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const E of m){switch(p){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case x:b+=`
`}b+=`  ${E[0]} ${"-".repeat(_-E[0].length)}-- ${E[1]}
`,++p}return b+=`
`,b}logAbout(m=n.LogLevel.Info){(0,n.log)(m,`context.about

`+this.aboutString())}logAboutIf(m,_=n.LogLevel.Info){(0,n.logIf)(m,_,`context.about

`+this.aboutString())}byteSizeOfFormat(m){return(0,r.byteSizeOfFormat)(this,m)}}t.Context=u,u.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(o){(function(m){m.Invalid="invalid",m.WebGL1="webgl1",m.WebGL2="webgl2"})(o.BackendType||(o.BackendType={})),function(m){m.auto="auto",m.webgl="webgl",m.experimental="experimental-webgl",m.webgl1="webgl1",m.experimental1="experimental-webgl1",m.webgl2="webgl2",m.experimental2="experimental-webgl2"}(o.BackendRequestType||(o.BackendRequestType={}))}(u||(t.Context=u={}))},5557:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMasquerade=void 0;const n=i(9504),r=i(5060);class c{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(d){const h=new c,s=r.ExtensionsHash.decode(d);return h._backend=s[0],h._extensionsStrive=s[1],h._extensionsConceal=r.ExtensionsHash.complement(h._backend,h._extensionsStrive),h}static fromPreset(d){const h=new c,s=new Array;let u;for(const o of c.presets())if(s.push(o.identifier),o.identifier===d){u=o;break}if(u===void 0&&(0,n.assert)(!1,`expected valid identifier, available ['${s.join("', '")}'], given '${d}'`),u.extensions_hash!==void 0){const o=r.ExtensionsHash.decode(u.extensions_hash);h._backend=o[0],h._extensionsStrive=o[1]}else h._backend=u.backend;return(0,n.assert)(h._backend!==void 0,"expected backend to be included in preset"),u.extensions_strive===void 0?(h._extensionsStrive=[],h._extensionsConceal=u.extensions_conceal?u.extensions_conceal:[]):(h._extensionsStrive=u.extensions_strive,h._extensionsConceal=r.ExtensionsHash.complement(h._backend,u.extensions_strive)),h._functionsUndefine=u.functions_undefine?u.functions_undefine:[],h}static fromGET(){const d=(0,n.GETparameter)("msqrd_h");if(d!==void 0)return c.fromHash(d);const h=(0,n.GETparameter)("msqrd_p");return h!==void 0?c.fromPreset(h):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}t.ContextMasquerade=c,c.MASQUERADE_JSON=i(7857)},8234:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;const n=i(7032),r=i(9504),c=i(5150);class f{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new n.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new n.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new n.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new n.Subject,this._postSwapEventSubject=new n.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(h){h&&(0,r.logVerbosity)()<r.LogLevel.Debug&&((0,r.logVerbosity)(r.LogLevel.Debug),(0,r.log)(r.LogLevel.Debug,`changed log verbosity to ${r.LogLevel.Debug} (debug)`)),f._debug=h}set batch(h){(0,r.log)(r.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,h)}request(h=f.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame(()=>this.invoke(h))}invoke(h){if(this._animationFrameID!==0){if((0,r.assert)(this._controllable!==void 0,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),h===f.RequestType.Frame&&this._frameNumber===1)return this._timeoutID===void 0&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return(0,r.logIf)(f._debug,r.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){(0,r.logIf)(f._debug,r.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const h=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=h,this._updateFrameTime=h}invokeFrameAndSwap(){(0,r.logIf)(f._debug,r.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const h=this._debugFrameNumber>0;(0,r.assert)(!h||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const s=performance.now();let u=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(u=Math.min(u,this._debugFrameNumber));this._frameNumber<u;++this._frameNumber)(0,r.logIf)(f._debug,r.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;(0,r.logIf)(f._debug,r.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const o=this._multiTime[1]-s;this._multiFrameTime+=o,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],o),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],o),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout(()=>{this.request(f.RequestType.MultiFrame),this._timeoutID=void 0},this._multiFrameDelay)}cancelWaitMultiFrame(){this._timeoutID!==void 0&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(h=!1){this._invalidated=!0,this._force=this._force||h,this._animationFrameID===0&&this.request()}block(){(0,r.logIf)(f._debug,r.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){(0,r.logIf)(f._debug,r.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){this._animationFrameID!==0&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(h){h!==this._controllable&&(this._controllable=h,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(h){const s=Math.max(1,isNaN(h)?1:h);s!==this._multiFrameNumber&&(this._multiFrameNumber=s,this.multiFrameNumberNext(),(0,r.logIf)(s!==h,r.LogLevel.Debug,`multi-frame number adjusted to ${s}, given ${h}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(h){const s=(0,c.clamp)(isNaN(h)?0:h,0,this.multiFrameNumber);s!==this._debugFrameNumber&&(this._debugFrameNumber=s,this.debugFrameNumberNext(),(0,r.logIf)(s!==h,r.LogLevel.Debug,`debug-frame number adjusted to ${s}, given ${h}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(h){const s=Math.max(0,h);s!==this._multiFrameDelay&&(this._multiFrameDelay=s)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return this._frameNumber===0?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return this._frameNumber===0?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return this._frameNumber===0?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}t.Controller=f,f._debug=!1,function(d){(function(h){h[h.Frame=0]="Frame",h[h.MultiFrame=1]="MultiFrame"})(d.RequestType||(d.RequestType={}))}(f||(t.Controller=f={}))},6710:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CuboidGeometry=void 0;const n=i(3557),r=i(7340),c=i(638);class f extends c.Geometry{constructor(h,s,u=!1,o=[1,1,1]){super(h,s),this._vertexLocation=0,this._extent=n.vec3.fromValues(1,1,1),this._uvCoordinates=!1,s=s!==void 0&&s!==""?s:this.constructor.name;const m=new r.Buffer(h,s+"VBO");this._buffers.push(m);const _=new r.Buffer(h,`${s}IndicesVBO`);this._buffers.push(_),this._extent=n.vec3.clone(o),this._uvCoordinates=u}bindBuffers(){this._uvCoordinates===!1?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(h=0,s=1){this._vertexLocation=h,this._uvCoordLocation=s;const u=this.context.gl,o=super.initialize([u.ARRAY_BUFFER,u.ELEMENT_ARRAY_BUFFER],[h,s]),m=this._uvCoordinates;let _=m?f.VERTICES_UV:f.VERTICES;return _=_.map((p,b)=>p*(m===!1?.5*this._extent[b%3]:b%5<3?.5*this._extent[b%5]:1)),this._buffers[0].data(_,u.STATIC_DRAW),this._buffers[1].data(m?f.INDICES_UV:f.INDICES,u.STATIC_DRAW),this._count=m?f.INDICES_UV.length:f.INDICES.length,o}draw(){const h=this.context.gl;h.drawElements(h.TRIANGLE_STRIP,this._count,h.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}get count(){return this._count}}t.CuboidGeometry=f,f.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),f.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),f.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),f.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},4890:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeosphereGeometry=void 0;const n=i(9504),r=i(7340),c=i(638),f=i(5431);class d extends c.Geometry{constructor(s,u,o=1,m=!0){super(s,u),this._diameter=1,this._textured=!1,this._size=0,u=u!==void 0&&u!==""?u:this.constructor.name,this._diameter=o,this._textured=m;const _=new r.Buffer(s,u+"IndexBuffer");this._buffers.push(_);const p=new r.Buffer(s,u+"VBO");if(this._buffers.push(p),this._textured){const b=new r.Buffer(s,u+"UV");this._buffers.push(b)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(s=0,u=1){const o=this.context.gl;this._vertexLocation=s,this._texCoordLocation=u;const m=super.initialize([o.ELEMENT_ARRAY_BUFFER,o.ARRAY_BUFFER,o.ARRAY_BUFFER],[8,s,u]);(0,n.assert)(this._buffers[0]!==void 0&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),(0,n.assert)(this._buffers[1]!==void 0&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&(0,n.assert)(this._buffers[2]!==void 0&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const _=new f.Icosahedron;_.generateGeometry(3),this._textured&&_.generateTextureCoordinates();const p=_.faces,b=new Uint16Array(3*p.length);let x=0;for(const S of p)b[x+0]=S[0],b[x+1]=S[1],b[x+2]=S[2],x+=3;this._buffers[0].data(b,o.STATIC_DRAW),this._size=3*p.length;const E=_.vertices,w=new Float32Array(3*E.length);x=0;for(const S of E)w[x+0]=S[0]*this._diameter,w[x+1]=S[1]*this._diameter,w[x+2]=S[2]*this._diameter,x+=3;if(this._buffers[1].data(w,o.STATIC_DRAW),this._textured){const S=_.texcoords,R=new Float32Array(2*S.length);if(S&&S.length>0){x=0;for(const O of S)R[x+0]=O[0],R[x+1]=O[1],x+=2}this._buffers[2].data(R,o.STATIC_DRAW)}return m}draw(){const s=this.context.gl;s.drawElements(s.TRIANGLES,this._size,s.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.GeosphereGeometry=d},5431:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Icosahedron=void 0;const n=i(3557),r=i(5150);t.Icosahedron=class{constructor(){}baseVertices(){const c=.5*(1+Math.sqrt(5)),f=1/Math.sqrt(c*c+1),d=c*f;return[n.vec3.fromValues(-f,+d,0),n.vec3.fromValues(+f,+d,0),n.vec3.fromValues(-f,-d,0),n.vec3.fromValues(+f,-d,0),n.vec3.fromValues(0,-f,+d),n.vec3.fromValues(0,+f,+d),n.vec3.fromValues(0,-f,-d),n.vec3.fromValues(0,+f,-d),n.vec3.fromValues(+d,0,-f),n.vec3.fromValues(+d,0,+f),n.vec3.fromValues(-d,0,-f),n.vec3.fromValues(-d,0,+f)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(c,f,d){const h=new Map;for(let s=0;s<d;s++){const u=f.length;for(let o=0;o<u;o++){const m=f[o],_=m[0],p=m[1],b=m[2],x=this.split(_,p,c,h),E=this.split(p,b,c,h),w=this.split(b,_,c,h);f[o]=[x,E,w],f.push([_,x,w]),f.push([p,E,x]),f.push([b,w,E])}}}split(c,f,d,h){const s=c<f,u=((s?c:f)<<16)+(s?f:c);if(h.has(u))return h.get(u);const o=n.vec3.add((0,r.v3)(),d[c],d[f]);n.vec3.normalize(o,o),d.push(o);const m=d.length-1;return h.set(u,m),m}generateGeometry(c){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),c>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(c,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const c of this._vertices){const f=n.vec3.normalize((0,r.v3)(),c),d=n.vec2.fromValues(.5-Math.atan2(f[2],f[0])/(2*Math.PI),Math.asin(f[1])/Math.PI+.5);this._texcoords.push(d)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},1854:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=t.PlaneGeometry=t.GeosphereGeometry=t.Icosahedron=t.CuboidGeometry=void 0;var n=i(6710);Object.defineProperty(t,"CuboidGeometry",{enumerable:!0,get:function(){return n.CuboidGeometry}});var r=i(5431);Object.defineProperty(t,"Icosahedron",{enumerable:!0,get:function(){return r.Icosahedron}});var c=i(4890);Object.defineProperty(t,"GeosphereGeometry",{enumerable:!0,get:function(){return c.GeosphereGeometry}});var f=i(8500);Object.defineProperty(t,"PlaneGeometry",{enumerable:!0,get:function(){return f.PlaneGeometry}});var d=i(6449);Object.defineProperty(t,"ResourceManager",{enumerable:!0,get:function(){return d.ResourceManager}})},8500:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneGeometry=void 0;const n=i(3557),r=i(7340),c=i(638);class f extends c.Geometry{constructor(h,s){super(h,s),this._vertexLocation=0,this._texCoordLocation=1,this._translation=n.vec3.fromValues(0,0,0),this._scale=n.vec3.fromValues(1,1,1),this._rotation=n.quat.create(),s=s!==void 0&&s!==""?s:this.constructor.name;const u=new r.Buffer(h,s+"VertexVBO"),o=new r.Buffer(h,s+"TexCoordVBO"),m=new r.Buffer(h,s+"IndexBuffer");this._buffers.push(u),this._buffers.push(o),this._buffers.push(m)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(h=0,s=1){const u=this.context.gl;this._vertexLocation=h,this._texCoordLocation=s;const o=super.initialize([u.ARRAY_BUFFER,u.ARRAY_BUFFER,u.ELEMENT_ARRAY_BUFFER],[h,s,8]);return this._buffers[0].data(f.VERTICES,u.STATIC_DRAW),this._buffers[1].data(f.UV,u.STATIC_DRAW),this._buffers[2].data(f.INDICES,u.STATIC_DRAW),o}draw(){const h=this.context.gl;h.drawElements(h.TRIANGLE_STRIP,f.INDICES.length,h.UNSIGNED_BYTE,0)}set translation(h){this._translation=h}set scale(h){this._scale=n.vec3.fromValues(h[0],1,h[1])}set rotation(h){this._rotation=h}get transformation(){const h=n.mat4.create();return n.mat4.fromRotationTranslationScale(h,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.PlaneGeometry=f,f.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),f.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),f.INDICES=new Uint8Array([0,1,2,3])},6449:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=void 0;const n=i(9504),r=i(7340),c=i(638),f=i(5315),d=i(8593);t.ResourceManager=class{constructor(h){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=h}fetchTexture2D(h,s,u=!1){if(this._texture2Ds.has(h))return;const o=new d.Texture2D(this._context,h);return(0,n.assert)(o.identifier===h,"expected object identifier to be unchanged"),this._texture2Ds.set(h,o),o.fetch(s,u)}add(h,s){const u=new Array;if(h instanceof d.Texture2D){const o=h;for(const m of s)this._texture2Ds.has(m)||(this._texture2Ds.set(m,o),u.push(m))}if(h instanceof f.Material){const o=h;for(const m of s)this._materials.has(m)||(this._materials.set(m,o),u.push(m))}if(h instanceof c.Geometry){const o=h;for(const m of s)this._geometries.has(m)||(this._geometries.set(m,o),u.push(m))}if(h instanceof r.Buffer){const o=h;for(const m of s)this._buffers.has(m)||(this._buffers.set(m,o),u.push(m))}return u}get(h){return this._texture2Ds.has(h)?this._texture2Ds.get(h):this._materials.has(h)?this._materials.get(h):this._geometries.has(h)?this._geometries.get(h):this._buffers.has(h)?this._buffers.get(h):void 0}uninitialize(){for(const h of Array.from(this._geometries.values()))h.initialized&&h.uninitialize();this._geometries.clear();for(const h of Array.from(this._texture2Ds.values()))h.initialized&&h.uninitialize();this._texture2Ds.clear();for(const h of Array.from(this._buffers.values()))h.initialized&&h.uninitialize();this._buffers.clear(),this._materials.clear()}}},2016:function(v,t,i){var n=this&&this.__createBinding||(Object.create?function(s,u,o,m){m===void 0&&(m=o);var _=Object.getOwnPropertyDescriptor(u,o);_&&!("get"in _?!u.__esModule:_.writable||_.configurable)||(_={enumerable:!0,get:function(){return u[o]}}),Object.defineProperty(s,m,_)}:function(s,u,o,m){m===void 0&&(m=o),s[m]=u[o]}),r=this&&this.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),c=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var o in s)o!=="default"&&Object.prototype.hasOwnProperty.call(s,o)&&n(u,s,o);return r(u,s),u};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const f=c(i(1728)),d=c(i(5657));var h;(function(s){s.TestRenderer=d.TestRenderer,s.TestNavigation=f.TestNavigation})(h||(t.debug=h={}))},1728:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TestNavigation=void 0;const n=i(2);t.TestNavigation=class{constructor(r,c){this._altered=!1,this._eventHandler=new n.EventHandler(r,c),this._eventHandler.pushMouseEnterHandler((f,d)=>this.onMouseEnter(f,d)),this._eventHandler.pushMouseLeaveHandler((f,d)=>this.onMouseLeave(f,d))}onMouseEnter(r,c){this._altered=!1}onMouseLeave(r,c){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},5657:(v,t,i)=>{const n=i(9504),r=i(9017),c=i(2419),f=i(8196),d=i(8386),h=i(8215),s=i(1896),u=i(4168),o=i(8400),m=i(3105),_=i(771),p=i(8593),b=i(1728);var x;(function(E){class w extends m.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(R,O,I){const D=this._context.gl,j=this._context.gl2facade;this._extensions===!1&&this._context.isWebGL1&&((0,n.assert)(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const k=new _.Shader(this._context,D.VERTEX_SHADER,"testrenderer.vert");k.initialize(i(5077));const G=new _.Shader(this._context,D.FRAGMENT_SHADER,"testrenderer.frag");G.initialize(i(6296)),this._program=new u.Program(this._context),this._program.initialize([k,G]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new s.NdcFillingTriangle(this._context);const Z=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(Z),this._ndcOffsetKernel=new c.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new d.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new p.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new o.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new h.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new r.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new f.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=j.COLOR_ATTACHMENT0,this._blit.drawBuffer=D.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new b.TestNavigation(()=>this.invalidate(),I),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const R=this._testNavigation.altered;return this._testNavigation.reset(),!(!R&&!this._altered.any)&&R}onPrepare(){const R=this._context.gl,O=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?R.RGBA8:R.RGBA,R.RGBA,R.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],R.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[O.COLOR_ATTACHMENT0,this._colorRenderTexture],[R.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(R){const O=this._context.gl;O.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const I=this._ndcOffsetKernel.get(R);I[0]=2*I[0]/this._frameSize[0],I[1]=2*I[1]/this._frameSize[1],O.uniform2fv(this._uNdcOffset,I),O.uniform1i(this._uFrameNumber,R),this._intermediateFBO.clear(O.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(R)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}E.TestRenderer=w})(x||(x={})),v.exports=x},3334:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPass=void 0;const n=i(9504),r=i(4168),c=i(771),f=i(8196);class d extends f.BlitPass{constructor(){super(...arguments),this._debug=d.Mode.Depth,this._near=0,this._far=0}createProgram(){(0,n.assert)(this._program===void 0,"expected blit program to be undefined before its creation");const s=this._context.gl,u=new c.Shader(this._context,s.VERTEX_SHADER,"blit.vert (debug)");u.initialize(i(3354));const o=new c.Shader(this._context,s.FRAGMENT_SHADER,"blit_debug.frag (debug)");return o.initialize(i(8359)),this._program=new r.Program(this._context,"DebugProgram"),this._program.initialize([u,o]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),s.uniform1i(this._program.uniform("u_source"),0),s.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(s){const u=super.initialize(s);return this.enforceProgramBlit=!0,u&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(s){this.assertInitialized(),this._debug!==s&&(this._debug=s,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(s){this._near=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(s){this._far=s||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}t.DebugPass=d,function(h){(function(s){s[s.None=0]="None",s[s.Depth=1]="Depth",s[s.DepthLinear=2]="DepthLinear",s[s.DepthPacked=3]="DepthPacked",s[s.DepthLinearPacked=4]="DepthLinearPacked"})(h.Mode||(h.Mode={}))}(d||(t.DebugPass=d={}))},8386:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFramebuffer=void 0;const r=i(9504),c=i(8215),f=i(4127);class d extends c.Framebuffer{create(){return this._object=c.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(s){return!1}bind(s=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(s,this._object)}clearColor(s){super.clearColor(s)}resize(){(0,r.assert)(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}t.DefaultFramebuffer=d,n([f.Initializable.assert_initialized()],d.prototype,"bind",null)},6464:function(v,t,i){var n=this&&this.__decorate||function(_,p,b,x){var E,w=arguments.length,S=w<3?p:x===null?x=Object.getOwnPropertyDescriptor(p,b):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(_,p,b,x);else for(var R=_.length-1;R>=0;R--)(E=_[R])&&(S=(w<3?E(S):w>3?E(p,b,S):E(p,b))||S);return w>3&&S&&Object.defineProperty(p,b,S),S};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentTextureType=t.EnvironmentRenderingPass=void 0;const r=i(9504),c=i(4127),f=i(1896),d=i(4168),h=i(771),s=i(8593),u=i(5186);class o extends c.Initializable{constructor(p){super(),this._skipCubeLod=!1,this._altered=!0,this._context=p,this._cubeMapProgram=new d.Program(p,"CubemapEnvironmentProgram"),this._equiMapProgram=new d.Program(p,"EquimapEnvironmentProgram"),this._polarMapProgram=new d.Program(p,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new d.Program(p,"SpheremapEnvironmentProgram"),this._ndcTriangle=new f.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const p=this._context.gl;this._ndcTriangle.initialize();const b=new h.Shader(this._context,p.VERTEX_SHADER,"env-projections.vert");b.initialize(i(3761));const x=new h.Shader(this._context,p.FRAGMENT_SHADER,"env-projections.frag");x.initialize(i(9196),!1),x.replace("PROJECTION_TYPE","CUBE_MAP"),x.compile(),this._cubeMapProgram.initialize([b,x],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),p.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const E=new h.Shader(this._context,p.FRAGMENT_SHADER,"env-projections.frag");E.initialize(i(9196),!1),E.replace("PROJECTION_TYPE","EQUI_MAP"),E.compile(),this._equiMapProgram.initialize([b,E],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),p.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const w=new h.Shader(this._context,p.FRAGMENT_SHADER,"env-projections.frag");w.initialize(i(9196),!1),w.replace("PROJECTION_TYPE","SPHERE_MAP"),w.compile(),this._sphereMapProgram.initialize([b,w],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),p.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const S=new h.Shader(this._context,p.FRAGMENT_SHADER,"env-projections.frag");return S.initialize(i(9196),!1),S.replace("PROJECTION_TYPE","POLAR_MAP"),S.compile(),this._polarMapProgram.initialize([b,S],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),p.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(this._altered===!1)return;const p=this._context.gl;this._cubeMapProgram.bind(),p.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const p=this._context.gl;(0,r.assert)(this._camera!==void 0,"Camera is undefined in environment rendering pass."),(0,r.assert)(this._environmentTexture!==void 0,"Environment texture is undefined in environment rendering pass.");let b=this._cubeMapProgram;this._envTextureType===m.EquirectangularMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(p.TEXTURE0),b=this._equiMapProgram):this._envTextureType===m.SphereMap?((0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(p.TEXTURE0),b=this._sphereMapProgram):this._envTextureType===m.CubeMap?((0,r.assert)(this._environmentTexture instanceof u.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(p.TEXTURE0),b=this._cubeMapProgram):this._envTextureType===m.PolarMap&&((0,r.assert)(this._environmentTexture2!==void 0,"Two input textures expected for polar mapping."),(0,r.assert)(this._environmentTexture instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),(0,r.assert)(this._environmentTexture2 instanceof s.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(p.TEXTURE0),this._environmentTexture2.bind(p.TEXTURE1),b=this._polarMapProgram),b.bind(),p.uniformMatrix4fv(b.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),b.unbind()}set environmentTextureType(p){this._envTextureType=p}set environmentTexture(p){this._environmentTexture=p}set environmentTexture2(p){this._environmentTexture2=p}set camera(p){this._camera=p}set skipCubeLod(p){this._skipCubeLod!==p&&(this._skipCubeLod=p,this._altered=!0)}}var m;t.EnvironmentRenderingPass=o,n([c.Initializable.initialize()],o.prototype,"initialize",null),n([c.Initializable.uninitialize()],o.prototype,"uninitialize",null),function(_){_[_.CubeMap=0]="CubeMap",_[_.EquirectangularMap=1]="EquirectangularMap",_[_.SphereMap=2]="SphereMap",_[_.PolarMap=3]="PolarMap"}(m||(t.EnvironmentTextureType=m={}))},2:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventHandler=void 0;const n=i(3557),r=i(9504),c=i(3975),f=i(4602),d=i(8216),h=i(8870),s=i(5678);t.EventHandler=class{constructor(u,o){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._latestKeyboardEventsByType=new Map,this._previousKeyboardEventsByType=new Map,this._keyboardEventHandlerByType=new Map,this._invalidate=u,this._mouseEventProvider=o.mouseEventProvider,this._mouseEventProvider.preventDefault(f.MouseEventProvider.Type.Wheel),this._pointerEventProvider=o.pointerEventProvider,this._eyeGazeEventProvider=o.eyeGazeEventProvider,this._keyboardEventProvider=o.keyboardEventProvider}invalidate(u=!1){this._invalidate&&this._invalidate(u)}pushMouseEventHandler(u,o){if(this._mouseEventHandlerByType.has(u))return void this._mouseEventHandlerByType.get(u).push(o);this._mouseEventHandlerByType.set(u,new Array),this._previousMouseEventsByType.set(u,new Array);const m=new Array;this._latestMouseEventsByType.set(u,m),(0,r.assert)(this._mouseEventProvider!==void 0,"expected valid mouse event provider");const _=this._mouseEventProvider.observable(u);f.MouseEventProvider.Type.Wheel,this._subscriptions.push(_.subscribe(p=>{m.push(p),this.invalidate()})),this._mouseEventHandlerByType.get(u).push(o)}invokeMouseEventHandler(u){const o=this._mouseEventHandlerByType.get(u);if(o===void 0||o.length===0)return;const m=this._latestMouseEventsByType.get(u);if(m.length===0)return;const _=this._previousMouseEventsByType.get(u);o.forEach(p=>p(m,_)),Object.assign(_,m),m.length=0}pushTouchEventHandler(u,o){if(this._touchEventHandlerByType.has(u))return void this._touchEventHandlerByType.get(u).push(o);this._touchEventHandlerByType.set(u,new Array),this._previousTouchEventsByType.set(u,new Array);const m=new Array;this._latestTouchEventsByType.set(u,m),(0,r.assert)(this._touchEventProvider!==void 0,"expected valid touch event provider");const _=this._touchEventProvider.observable(u);this._subscriptions.push(_.subscribe(p=>{m.push(p),this.invalidate()})),this._touchEventHandlerByType.get(u).push(o)}invokeTouchEventHandler(u){const o=this._touchEventHandlerByType.get(u);if(o===void 0||o.length===0)return;const m=this._latestTouchEventsByType.get(u);if(m.length===0)return;const _=this._previousTouchEventsByType.get(u);o.forEach(p=>p(m,_)),Object.assign(_,m),m.length=0}pushPointerEventHandler(u,o){if(this._pointerEventHandlerByType.has(u))return void this._pointerEventHandlerByType.get(u).push(o);this._pointerEventHandlerByType.set(u,new Array),this._previousPointerEventsByType.set(u,new Array);const m=new Array;this._latestPointerEventsByType.set(u,m),(0,r.assert)(this._pointerEventProvider!==void 0,"expected valid pointer event provider");const _=this._pointerEventProvider.observable(u);this._subscriptions.push(_.subscribe(p=>{m.push(p),this.invalidate()})),this._pointerEventHandlerByType.get(u).push(o)}invokePointerEventHandler(u){const o=this._pointerEventHandlerByType.get(u);if(o===void 0||o.length===0)return;const m=this._latestPointerEventsByType.get(u);if(m.length===0)return;const _=this._previousPointerEventsByType.get(u);o.forEach(p=>p(m,_)),Object.assign(_,m),m.length=0}pushEyeGazeEventHandler(u,o){if(this._eyeGazeEventHandlerByType.has(u))return void this._eyeGazeEventHandlerByType.get(u).push(o);this._eyeGazeEventHandlerByType.set(u,new Array),this._previousEyeGazeEventsByType.set(u,new Array);const m=new Array;this._latestEyeGazeEventsByType.set(u,m),(0,r.assert)(this._eyeGazeEventProvider!==void 0,"expected valid eye gaze event provider");const _=this._eyeGazeEventProvider.observable(u);this._subscriptions.push(_.subscribe(p=>{m.push(p),this.invalidate()})),this._eyeGazeEventHandlerByType.get(u).push(o)}invokeEyeGazeEventHandler(u){const o=this._eyeGazeEventHandlerByType.get(u);if(o===void 0||o.length===0)return;const m=this._latestEyeGazeEventsByType.get(u);if(m.length===0)return;const _=this._previousEyeGazeEventsByType.get(u);o.forEach(p=>p(m,_)),Object.assign(_,m),m.length=0}pushKeyboardEventHandler(u,o){if(this._keyboardEventHandlerByType.has(u))return void this._keyboardEventHandlerByType.get(u).push(o);this._keyboardEventHandlerByType.set(u,new Array),this._previousKeyboardEventsByType.set(u,new Array);const m=new Array;this._latestKeyboardEventsByType.set(u,m),(0,r.assert)(this._keyboardEventProvider!==void 0,"expected valid keyboard event provider");const _=this._keyboardEventProvider.observable(u);this._subscriptions.push(_.subscribe(p=>{m.push(p),this.invalidate()})),this._keyboardEventHandlerByType.get(u).push(o)}invokeKeyboardEventHandler(u){const o=this._keyboardEventHandlerByType.get(u);if(o===void 0||o.length===0)return;const m=this._latestKeyboardEventsByType.get(u);if(m.length===0)return;const _=this._previousKeyboardEventsByType.get(u);o.forEach(p=>p(m,_)),Object.assign(_,m),m.length=0}dispose(){this._latestMouseEventsByType.forEach(u=>u.length=0),this._previousMouseEventsByType.forEach(u=>u.length=0),this._latestTouchEventsByType.forEach(u=>u.length=0),this._previousTouchEventsByType.forEach(u=>u.length=0),this._latestPointerEventsByType.forEach(u=>u.length=0),this._previousPointerEventsByType.forEach(u=>u.length=0),this._previousEyeGazeEventsByType.forEach(u=>u.length=0),this._latestEyeGazeEventsByType.forEach(u=>u.length=0),this._latestKeyboardEventsByType.forEach(u=>u.length=0),this._previousKeyboardEventsByType.forEach(u=>u.length=0);for(const u of this._subscriptions)u.unsubscribe()}update(){this.invokeMouseEventHandler(f.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(f.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(h.TouchEventProvider.Type.End),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(h.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(d.PointerEventProvider.Type.Move),this.invokePointerEventHandler(d.PointerEventProvider.Type.Down),this.invokePointerEventHandler(d.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(d.PointerEventProvider.Type.Up),this.invokePointerEventHandler(d.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(d.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(c.EyeGazeEventProvider.Type.BinaryMessageParsingError),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyDown),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyPress),this.invokeKeyboardEventHandler(s.KeyboardEventType.KeyUp)}offsets(u,o=!0){const m=new Array;let _=!1;if(u instanceof MouseEvent){const b=u;_=b.offsetX!==0&&b.offsetY!==0,m.push(_?n.vec2.fromValues(b.offsetX,b.offsetY):n.vec2.fromValues(b.clientX,b.clientY))}else if(u instanceof WheelEvent){const b=u;_=b.offsetX!==0&&b.offsetY!==0,m.push(_?n.vec2.fromValues(b.offsetX,b.offsetY):n.vec2.fromValues(b.clientX,b.clientY))}else if(u instanceof TouchEvent){const b=u;for(let x=0;x<b.touches.length;++x){const E=b.touches.item(x);m.push(n.vec2.fromValues(E.clientX,E.clientY))}}if(_){if(o)for(const b of m)n.vec2.scale(b,b,window.devicePixelRatio);return m}const p=(u.target||u.currentTarget||u.srcElement).getBoundingClientRect();for(const b of m)b[0]=Math.floor(b[0]-p.left),b[1]=Math.floor(b[1]-p.top),o&&n.vec2.scale(b,b,window.devicePixelRatio);return m}pushClickHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Click,u)}pushMouseEnterHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Enter,u)}pushMouseLeaveHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Leave,u)}pushMouseDownHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Down,u)}pushMouseUpHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Up,u)}pushMouseMoveHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Move,u)}pushMouseWheelHandler(u){this.pushMouseEventHandler(f.MouseEventProvider.Type.Wheel,u)}pushTouchStartHandler(u){this.pushTouchEventHandler(h.TouchEventProvider.Type.Start,u)}pushTouchEndHandler(u){this.pushTouchEventHandler(h.TouchEventProvider.Type.End,u)}pushTouchMoveHandler(u){this.pushTouchEventHandler(h.TouchEventProvider.Type.Move,u)}pushTouchCancelHandler(u){this.pushTouchEventHandler(h.TouchEventProvider.Type.Cancel,u)}pushPointerUpHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Up,u)}pushPointerDownHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Down,u)}pushPointerEnterHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Enter,u)}pushPointerLeaveHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Leave,u)}pushPointerMoveHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Move,u)}pushPointerCancelHandler(u){this.pushPointerEventHandler(d.PointerEventProvider.Type.Cancel,u)}pushEyeGazeDataHandler(u){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.EyeGazeData,u)}pushEyeGazeServerMessageHandler(u){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.NewServerMessage,u)}pushEyeGazeConnectionStatusHandler(u){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.ConnectionStatus,u)}pushEyeGazeBinaryMessageParsingErrorHandler(u){this.pushEyeGazeEventHandler(c.EyeGazeEventProvider.Type.BinaryMessageParsingError,u)}pushKeyDownHandler(u){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyDown,u)}pushKeyPressHandler(u){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyPress,u)}pushKeyUpHandler(u){this.pushKeyboardEventHandler(s.KeyboardEventType.KeyUp,u)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},5304:v=>{var t;(function(i){i.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],i.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],i.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]})(t||(t={})),v.exports=t},5060:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsHash=void 0;const n=i(9504),r=i(5304);class c{static encode64(d){return(0,n.assert)(d>=0&&d<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${d}`),c.BASE64_ALPHABET[d]}static decode64(d){(0,n.assert)(d.length===1,`expected single base64 character, given '${d}'`);const h=c.BASE64_ALPHABET.indexOf(d);return(0,n.assert)(h>-1,`unknown base64 character, given '${d}'`),h}static encode(d,h){const s=c.LATEST_VERSION,u=c.EXTENSIONS_BY_VERSION.get(s),o=c.WEBGL_BACKENDS.indexOf(d);(0,n.assert)(o>-1,`expected valid backend ${c.WEBGL_BACKENDS}, given ${d} `);let m=c.encode64(s<<3|o+1);if(h.length===0)return m;let _=0;for(let p=0;p<u.length;++p)_|=h.indexOf(u[p])>-1?32>>p%6:0,p%6<5&&p<u.length-1||(m+=c.encode64(_),_=0);return m}static decode(d){const h=c.decode64(d[0]),s=h>>3,u=(7&h)-1;(0,n.assert)(u<c.WEBGL_BACKENDS.length,`expected valid backend index, given ${u}`);const o=c.WEBGL_BACKENDS[u];(0,n.assert)(c.EXTENSIONS_BY_VERSION.has(s),`expected valid hash version, given ${s}`);const m=c.EXTENSIONS_BY_VERSION.get(s),_=Math.ceil(m.length/6)+1;(0,n.assert)(d.length===_,`expected hash of version ${s} to have a length of ${_}, given ${d}`);const p=new Array;for(let b=1;b<d.length;++b){const x=c.decode64(d[b]),E=6*(b-1);32&x&&p.push(m[E+0]),16&x&&p.push(m[E+1]),8&x&&p.push(m[E+2]),4&x&&p.push(m[E+3]),2&x&&p.push(m[E+4]),1&x&&p.push(m[E+5])}return[o,p]}static complement(d,h){const s=c.WEBGL_BACKENDS.indexOf(d);return(0,n.assert)(s>-1,`expected valid backend ${c.WEBGL_BACKENDS}, given ${d} `),c.WEBGL_EXTENSIONS_BY_BACKEND.get(s).filter(u=>h.indexOf(u)<0)}}t.ExtensionsHash=c,c.WEBGL_BACKENDS=["webgl1","webgl2"],c.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,r.WEBGL1_EXTENSIONS],[1,r.WEBGL2_EXTENSIONS]]),c.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),c.LATEST_VERSION=0,c.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},3404:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeDataStreams=t.EyeGazeDataStream=t.EyeGazeEventTarget=void 0;const n=i(6662);class r extends EventTarget{}t.EyeGazeEventTarget=r;class c{constructor(){this._eyeGazeDataStreams=new f,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const h=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(h[0]=1|h[0]),this._eyeGazeDataStreams.gazeOrigin&&(h[0]=2|h[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(h[0]=4|h[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(h[0]=8|h[0]),this._eyeGazeDataStreams.userPresence&&(h[0]=16|h[0]),h}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const h=this.generateStreamConfigByte();this._webSocket.send(h)}parseEyeTrackingData(h){if(h.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(c.BINARY_MESSAGE_PARSING_ERROR);let s=0;const u=new n.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(u.gazePositionXY[0]=h[s++],u.gazePositionXY[1]=h[s++]),this._eyeGazeDataStreams.gazeOrigin&&(u.gazeOriginRightXYZ[0]=h[s++],u.gazeOriginRightXYZ[1]=h[s++],u.gazeOriginRightXYZ[2]=h[s++],u.gazeOriginLeftXYZ[0]=h[s++],u.gazeOriginLeftXYZ[1]=h[s++],u.gazeOriginLeftXYZ[2]=h[s++]),this._eyeGazeDataStreams.eyePositionNormalized&&(u.eyePositionRightNormalizedXYZ[0]=h[s++],u.eyePositionRightNormalizedXYZ[1]=h[s++],u.eyePositionRightNormalizedXYZ[2]=h[s++],u.eyePositionLeftNormalizedXYZ[0]=h[s++],u.eyePositionLeftNormalizedXYZ[1]=h[s++],u.eyePositionLeftNormalizedXYZ[2]=h[s++]),this._eyeGazeDataStreams.headPositionAndRotation&&(u.headPositionXYZ[0]=h[s++],u.headPositionXYZ[1]=h[s++],u.headPositionXYZ[2]=h[s++],u.headRotationXYZ[0]=h[s++],u.headRotationXYZ[1]=h[s++],u.headRotationXYZ[2]=h[s++]),this._eyeGazeDataStreams.userPresence&&(u.userPresence=h[s]!==0),new CustomEvent(c.EYE_GAZE_DATA,{detail:{eyeGazeData:u}})}onOpen(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.SUCCESSFULLY_CONNECTED_TO_SERVER,event:h}})),this.performHandshake()}onClose(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.DISCONNECTED_TO_SERVER,event:h}}))}onError(h){this.dispatchEvent(new CustomEvent(c.CONNECTION_STATUS,{detail:{message:c.CONNECTION_ERROR,event:h}}))}async onMessage(h){if(typeof h.data!="string"){const s=await h.data.arrayBuffer(),u=new Float32Array(s);this.dispatchEvent(this.parseEyeTrackingData(u))}else this.dispatchEvent(new CustomEvent(c.NEW_SERVER_MESSAGE,{detail:{message:h.data}}))}connect(h){this._webSocket=new WebSocket(h),this._webSocket.onopen=s=>{this.onOpen(s)},this._webSocket.onclose=s=>{this.onClose(s)},this._webSocket.onerror=s=>{this.onError(s)},this._webSocket.onmessage=s=>{this.onMessage(s)}}addEventListener(h,s,u){this._eyeGazeEventTarget.addEventListener(h,s||null,u)}dispatchEvent(h){return this._eyeGazeEventTarget.dispatchEvent(h)}removeEventListener(h,s,u){this._eyeGazeEventTarget.removeEventListener(h,s||null,u)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(h){this._eyeGazeDataStreams!==h&&(this._eyeGazeDataStreams=h)}}t.EyeGazeDataStream=c,c.EYE_GAZE_DATA="eyegazedata",c.NEW_SERVER_MESSAGE="newservermessage",c.CONNECTION_STATUS="connectionstatus",c.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",c.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",c.DISCONNECTED_TO_SERVER="disconnected to server",c.CONNECTION_ERROR="connection error with server";class f{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let h=0;this.gazePosition&&(h+=2),this.gazeOrigin&&(h+=6),this.eyePositionNormalized&&(h+=6),this.headPositionAndRotation&&(h+=6),this.userPresence&&(h+=1),this.expectedNumberOfFloats=h}}t.EyeGazeDataStreams=f},6662:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeData=void 0,t.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let i="";return i+=`Gaze Position: ${this.gazePositionXY}
`,i+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}
`,i+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}
`,i+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}
`,i+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}
`,i+=`Head Position: ${this.headPositionXYZ}
`,i+=`Head Rotation: ${this.headRotationXYZ}
`,i+=`User Presence: ${this.userPresence}
`,i}}},3975:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeEventProvider=void 0;const n=i(7032),r=i(9504),c=i(3404);class f{constructor(h,s){(0,r.assert)(h!==void 0,`expected a valid eye gaze data streams object on initialization, given ${h}.`),this._eyeGazeDataStream=new c.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=h,this._eyeGazeDataStream.connect(s)}preventDefaultOnEvent(h,s){(0,r.bitInBitfield)(this._preventDefaultMask,h)&&s.preventDefault()}allowDefault(...h){for(const s of h)(0,r.bitInBitfield)(this._preventDefaultMask,s)&&(this._preventDefaultMask&=~s)}preventDefault(...h){for(const s of h)(0,r.bitInBitfield)(this._preventDefaultMask,s)||(this._preventDefaultMask|=s)}observable(h){switch(h){case f.Type.EyeGazeData:return this.EyeGazeData$;case f.Type.NewServerMessage:return this.NewServerMessage$;case f.Type.ConnectionStatus:return this.ConnectionStatus$;case f.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return this._eyeGazeDataSubject===void 0&&(this._eyeGazeDataSubject=new n.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=h=>{this.preventDefaultOnEvent(f.Type.EyeGazeData,h),this._eyeGazeDataSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return this._newServerMessageSubject===void 0&&(this._newServerMessageSubject=new n.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=h=>{this.preventDefaultOnEvent(f.Type.NewServerMessage,h),this._newServerMessageSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return this._connectionStatusSubject===void 0&&(this._connectionStatusSubject=new n.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=h=>{this.preventDefaultOnEvent(f.Type.ConnectionStatus,h),this._connectionStatusSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return this._binaryMessageParsingErrorSubject===void 0&&(this._binaryMessageParsingErrorSubject=new n.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=h=>{this.preventDefaultOnEvent(f.Type.BinaryMessageParsingError,h),this._binaryMessageParsingErrorSubject.next(h)},this._eyeGazeDataStream.addEventListener(c.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}t.EyeGazeEventProvider=f,function(d){(function(h){h[h.EyeGazeData=1]="EyeGazeData",h[h.NewServerMessage=2]="NewServerMessage",h[h.ConnectionStatus=4]="ConnectionStatus",h[h.BinaryMessageParsingError=8]="BinaryMessageParsingError"})(d.Type||(d.Type={}))}(f||(t.EyeGazeEventProvider=f={}))},64:(v,t,i)=>{const n=i(1407);var r;(function(c){const f=(d,h)=>`fetching '${d}' failed (${h.status}): ${h.statusText}`;c.fetchAsync=function(d,h){return new Promise((s,u)=>{const o=new XMLHttpRequest;o.open("GET",d,!0),o.responseType=h,o.onload=()=>{o.status<200||o.status>=300?u(f(d,o)):s(o.response)},o.onerror=()=>u(f(d,o)),o.ontimeout=()=>u(f(d,o)),o.send()})},c.fetchJsonAsync=function(d,h,s){return new Promise((u,o)=>{const m=new XMLHttpRequest;m.open("GET",d,!0),m.onload=()=>{if(m.status<200||m.status>=300)return void o(f(d,m));const _=m.responseText;if(s!==void 0&&!(0,n.validate)(_,s))return;let p;try{p=JSON.parse(_)}catch(x){return void o(`fetching '${d}' failed (${x.name}): ${x.message}`)}const b=h(p);b!==void 0?u(b):o(`fetching '${d}' failed (TransformError): transforming the object failed.`)},m.onerror=()=>o(f(d,m)),m.ontimeout=()=>o(f(d,m)),m.send()})}})(r||(r={})),v.exports=r},4850:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPersonModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=n.mat4.create(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h}process(h,s){this._currentPoint=h;const u=n.vec2.create();s===void 0?n.vec2.subtract(u,this._initialPoint,this._currentPoint):n.vec2.copy(u,s),n.vec2.scale(u,u,window.devicePixelRatio*this._sensitivity),n.vec2.copy(this._initialPoint,this._currentPoint);const o=n.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(o,o);const m=n.vec3.cross((0,r.v3)(),o,this._reference.up),_=n.mat4.fromRotation((0,r.m4)(),-u[0],this._reference.up),p=n.mat4.fromRotation((0,r.m4)(),u[1],m);n.mat4.mul(this._rotation,p,_),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._reference.eye);n.mat4.multiply(h,h,this._rotation),n.mat4.translate(h,h,n.vec3.negate((0,r.v3)(),this._reference.eye));const s=n.vec3.transformMat4((0,r.v3)(),this._reference.center,h);this._camera.center=s,Object.assign(this._reference,this._camera)}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.FirstPersonModifier=f,f.DEFAULT_SENSITIVITY=8e-4},3513:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.byteSizeOfFormat=function(f,d){const h=f.gl;if(d===void 0)return(0,n.assert)(!1,"expected given format to be defined"),0;if(function(u,o){const m=u.gl,_=u.gl2facade;if(o===void 0)return!1;if(r===void 0){const p=u.supportsDepthTexture?u.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;r=new Array(m.UNSIGNED_BYTE,m.UNSIGNED_SHORT_5_6_5,m.UNSIGNED_SHORT_4_4_4_4,m.UNSIGNED_SHORT_5_5_5_1,m.UNSIGNED_SHORT,m.UNSIGNED_INT,p,m.FLOAT,_.HALF_FLOAT,m.BYTE,m.SHORT,m.INT,m.HALF_FLOAT,m.UNSIGNED_INT_2_10_10_10_REV,m.UNSIGNED_INT_10F_11F_11F_REV,m.UNSIGNED_INT_5_9_9_9_REV,m.UNSIGNED_INT_24_8,m.FLOAT_32_UNSIGNED_INT_24_8_REV)}return r.indexOf(o)>-1}(f,d))return(0,n.assert)(!1,`expected format instead of type ${d}`),0;if(d===h.DEPTH_COMPONENT||d===h.DEPTH_STENCIL)return(0,n.assert)(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const s=function(u){if(c.has(u))return c.get(u);const o=u.gl,m=new Map([[o.ALPHA,1],[o.LUMINANCE,1],[o.R8,1],[o.R8I,1],[o.R8UI,1],[o.STENCIL_INDEX8,1],[o.DEPTH_COMPONENT16,2],[o.LUMINANCE_ALPHA,2],[o.R16F,2],[o.R16I,2],[o.R16UI,2],[o.RG8,2],[o.RG8I,2],[o.RG8UI,2],[o.RGB565,2],[o.RGB5_A1,2],[o.RGBA4,2],[o.DEPTH_COMPONENT24,3],[o.RGB,3],[o.RGB8,3],[o.RGB8UI,3],[o.SRGB,3],[o.SRGB8,3],[o.DEPTH24_STENCIL8,4],[o.DEPTH_COMPONENT32F,4],[o.R11F_G11F_B10F,4],[o.R32F,4],[o.R32I,4],[o.R32UI,4],[o.RG16F,4],[o.RG16I,4],[o.RG16UI,4],[o.RGB10_A2,4],[o.RGB10_A2UI,4],[o.RGB9_E5,4],[o.RGBA,4],[o.RGBA8,4],[o.RGBA8I,4],[o.RGBA8UI,4],[o.SRGB8_ALPHA8,4],[o.SRGB_ALPHA,4],[o.SRGB_ALPHA8,4],[o.SRGB_APLHA8,4],[o.DEPTH32F_STENCIL8,5],[o.RGB16F,6],[o.RG32F,8],[o.RG32I,8],[o.RG32UI,8],[o.RGBA16F,8],[o.RGBA16I,8],[o.RGBA16UI,8],[o.RGB32F,12],[o.RGBA32F,16],[o.RGBA32I,16],[o.RGBA32UI,16]]);return u.isWebGL1&&u.supportsSRGB&&(m.set(u.sRGB.SRGB_EXT,3),m.set(u.sRGB.SRGB_ALPHA_EXT,4),m.set(u.sRGB.SRGB8_ALPHA8_EXT,4)),u.supportsColorBufferFloat&&(m.set(u.colorBufferFloat.RGB32F_EXT,12),m.set(u.colorBufferFloat.RGBA32F_EXT,16)),c.set(u,m),m}(f).get(d);return(0,n.assert)(s!==void 0,`size of format ${d} is unknown`),s||0};const n=i(9504);let r;const c=new Map},8215:function(v,t,i){var n=this&&this.__decorate||function(u,o,m,_){var p,b=arguments.length,x=b<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,m):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(u,o,m,_);else for(var E=u.length-1;E>=0;E--)(p=u[E])&&(x=(b<3?p(x):b>3?p(o,m,x):p(o,m))||x);return b>3&&x&&Object.defineProperty(o,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.Framebuffer=void 0;const r=i(9504),c=i(4127),f=i(9965),d=i(8400),h=i(8593);class s extends f.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(o,m){const _=o.gl;switch(m){case _.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case _.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case _.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case _.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case _.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case _.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return(0,r.assert)(!1,`expected known framebuffer status, given ${m}`),""}}create(o){const m=this._context.gl,_=this.context.gl2facade;this._object=m.createFramebuffer(),this._clearColors=new Array(_.COLOR_ATTACHMENT_MAX-_.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const b of o){const x=b[0],E=b[1];if(E instanceof d.Renderbuffer?this._buffersByAttachment.set(x,E):E instanceof h.Texture2D&&this._texturesByAttachment.set(x,E),x<_.COLOR_ATTACHMENT_MIN||x>_.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(x);const w=x-m.COLOR_ATTACHMENT0;this._colorClearQueue.push(w),this._clearColors[w]=[0,0,0,0]}this._drawBuffersChanged=!0,m.bindFramebuffer(m.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach((b,x)=>{m.framebufferRenderbuffer(m.FRAMEBUFFER,x,m.RENDERBUFFER,b.object)}),this._texturesByAttachment.forEach((b,x)=>{m.framebufferTexture2D(m.FRAMEBUFFER,x,m.TEXTURE_2D,b.object,0)});const p=m.checkFramebufferStatus(m.FRAMEBUFFER);return this._valid=m.isFramebuffer(this._object)&&p===m.FRAMEBUFFER_COMPLETE,(0,r.logIf)(!this._valid,r.LogLevel.Warning,s.statusString(this.context,p)),_.drawBuffers&&_.drawBuffers(this._drawBuffers),m.bindFramebuffer(m.FRAMEBUFFER,s.DEFAULT_FRAMEBUFFER),this._object}delete(){(0,r.assert)(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(o,m=!0,_=!0){const p=this.context.gl,b=(0,r.bitInBitfield)(o,p.DEPTH_BUFFER_BIT),x=(0,r.bitInBitfield)(o,p.STENCIL_BUFFER_BIT),E=(0,r.bitInBitfield)(o,p.COLOR_BUFFER_BIT);if(E||b||x){if(m&&this.bind(),E&&this._clearColors[0]!==void 0){const w=this._clearColors[0];p.clearColor(w[0],w[1],w[2],w[3])}b&&this._clearDepth!==void 0&&p.clearDepth(this._clearDepth),x&&this._clearStencil!==void 0&&p.clearStencil(this._clearStencil),p.clear(o),_&&this.unbind()}}es3Clear(o,m=!0,_=!0,p){const b=this.context.gl,x=(0,r.bitInBitfield)(o,b.DEPTH_BUFFER_BIT),E=(0,r.bitInBitfield)(o,b.STENCIL_BUFFER_BIT),w=(0,r.bitInBitfield)(o,b.COLOR_BUFFER_BIT);if(w||x||E){if(m&&this.bind(),w){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const S=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];b.clearColor(S[0],S[1],S[2],S[3]),b.clear(b.COLOR_BUFFER_BIT)}for(const S of p||this._colorClearQueue)b.clearBufferfv(b.COLOR,S,this._clearColors[S])}x&&E?(b.clearStencil(this._clearStencil),b.clearDepth(this._clearDepth),b.clear(b.STENCIL_BUFFER_BIT|b.DEPTH_BUFFER_BIT)):x?b.clearBufferfv(b.DEPTH,0,[this._clearDepth]):E&&(b.clearStencil(this._clearStencil),b.clear(b.STENCIL_BUFFER_BIT)),_&&this.unbind()}}hasAttachment(o){return this._texturesByAttachment.has(o)||this._buffersByAttachment.has(o)}bind(o=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(o,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(o=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(o,s.DEFAULT_FRAMEBUFFER)}clearColor(o,m){(0,r.assert)(m===void 0||m===0||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const _=o[3]<1&&!this.context.alpha;(0,r.logIf)(_,r.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const p=[o[0],o[1],o[2],_?1:o[3]];if(this.context.premultipliedAlpha&&!_&&(p[0]*=p[3],p[1]*=p[3],p[2]*=p[3]),m!==void 0)this._clearColors[m]=p;else for(let b=0;b<this._clearColors.length;++b)this._clearColors[b]=p}clearDepth(o){this._clearDepth=o}clearStencil(o){this._clearStencil=o}texture(o){return this._texturesByAttachment.get(o)}resize(o,m,_=!0,p=!0){this._buffersByAttachment.forEach(b=>{b.resize(o,m,_,p)}),this._texturesByAttachment.forEach(b=>{b.resize(o,m,_,p)})}get width(){this.assertInitialized();let o=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(o)||m.width<o)&&(o=m.width)}),this._texturesByAttachment.forEach(m=>{(isNaN(o)||m.width<o)&&(o=m.width)}),o}get height(){this.assertInitialized();let o=NaN;return this._buffersByAttachment.forEach(m=>{(isNaN(o)||m.height<o)&&(o=m.height)}),this._texturesByAttachment.forEach(m=>{(isNaN(o)||m.height<o)&&(o=m.height)}),o}get size(){return[this.width,this.height]}set drawBuffers(o){this.assertInitialized();const m=this.context.gl2facade;for(const _ of o)(0,r.assert)(this.hasAttachment(_),`valid attachment expected for draw buffer, given ${_}`),(0,r.assert)(_>=m.COLOR_ATTACHMENT_MIN&&_<=m.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${_}`),this._drawBuffersChanged=this._drawBuffersChanged||this._drawBuffers.indexOf(_)===-1;this._drawBuffersChanged=this._drawBuffersChanged||o.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=o)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}t.Framebuffer=s,s.DEFAULT_FRAMEBUFFER=void 0,n([c.Initializable.assert_initialized()],s.prototype,"es2Clear",null),n([c.Initializable.assert_initialized()],s.prototype,"es3Clear",null),n([c.Initializable.assert_initialized()],s.prototype,"bind",null),n([c.Initializable.assert_initialized()],s.prototype,"unbind",null),n([c.Initializable.assert_initialized()],s.prototype,"clearColor",null),n([c.Initializable.assert_initialized()],s.prototype,"clearDepth",null),n([c.Initializable.assert_initialized()],s.prototype,"clearStencil",null),n([c.Initializable.assert_initialized()],s.prototype,"texture",null),n([c.Initializable.assert_initialized()],s.prototype,"resize",null)},1215:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FrameCapture=void 0;const n=i(9504),r=i(8215),c=i(8386);class f{static createDataURL(h,s,u){const o=document.createElement("canvas"),m=o.getContext("2d");return o.width=h.width,o.height=h.height,m.putImageData(h,0,0),o.toDataURL(s,u)}static captureDefaultFramebuffer(h,s,u){const o=h.context.gl;h.bind(),o.readPixels(s.x,s.y,s.width,s.height,o.RGBA,o.UNSIGNED_BYTE,u),h.unbind()}static captureFramebuffer(h,s,u,o){const m=h.context.gl,_=h.texture(s);if((0,n.assert)(_!==void 0,`Framebuffer does not have given attachment ${s}.`),(0,n.assert)(_.format===m.RGBA,`Unsupported texture format ${_.format}.`),(0,n.assert)(_.type===m.UNSIGNED_BYTE||_.type===m.FLOAT||_.type===m.HALF_FLOAT,`Unsupported texture type ${_.type}.`),m.readBuffer(s),_.type===m.FLOAT||_.type===m.HALF_FLOAT){const p=new Float32Array(u.width*u.height*4);m.readPixels(u.x,u.y,u.width,u.height,m.RGBA,m.FLOAT,p),p.forEach((b,x)=>{o[x]=255*b})}else _.type===m.UNSIGNED_BYTE&&m.readPixels(u.x,u.y,u.width,u.height,m.RGBA,m.UNSIGNED_BYTE,o)}static flipImageDataVertically(h){const s=h.height,u=h.data.length/s,o=Math.floor(s/2);for(let m=0;m<o;++m){const _=h.data.slice(m*u,(m+1)*u);h.data.copyWithin(m*u,(s-m-1)*u,(s-m)*u),h.data.set(_,(s-m-1)*u)}}static capture(h,s,u){const o=h.context.gl,m=h.size;u===void 0&&(u={x:0,y:0,width:m[0],height:m[1]}),s===void 0&&(s=o.COLOR_ATTACHMENT0);const _=new ImageData(u.width,u.height),p=new Uint8Array(_.data.buffer);return h.bind(o.READ_FRAMEBUFFER),h instanceof c.DefaultFramebuffer?f.captureDefaultFramebuffer(h,u,p):h instanceof r.Framebuffer&&f.captureFramebuffer(h,s,u,p),h.unbind(o.READ_FRAMEBUFFER),f.flipImageDataVertically(_),_}}t.FrameCapture=f},3395:function(v,t,i){var n=this&&this.__decorate||function(m,_,p,b){var x,E=arguments.length,w=E<3?_:b===null?b=Object.getOwnPropertyDescriptor(_,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,_,p,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(_,p,w):x(_,p))||w);return E>3&&w&&Object.defineProperty(_,p,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.GaussFilter=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(4127),h=i(1896),s=i(4168),u=i(771);class o extends d.Initializable{constructor(_){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=_}recalculateWeights(){if(this._weights)return!1;const _=1/Math.sqrt(2*Math.PI)*this._standardDeviation,p=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let b=0;for(let x=0;x<=Math.floor(this._kernelSize/2);x++)this._weights[x]=_*Math.pow(Math.E,-Math.pow(x,2)/p),b+=x>0?2*this._weights[x]:this._weights[x];if(this._redistribute){const x=1-b;for(let E=0;E<=Math.floor(this._kernelSize/2);E++)this._weights[E]+=this._weights[E]/b*x}return!0}get kernelSize(){return this._kernelSize}set kernelSize(_){(0,c.assert)(_>0,"Kernel size has to be positive."),(0,c.assert)(_<=2*(o._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(o._MAXKERNELSIZEHALF-1)+2)+"."),(0,c.assert)(Number.isInteger(_),"Kernel size has to be an integer."),(0,c.assert)(_%2==1,"Kernel size has to be odd."),this._kernelSize=_,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(_){(0,c.assert)(_>0,"Standard deviation has to be positive."),this._standardDeviation=_,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(_){this._redistribute=_,this._weights=void 0}initialize(_){const p=this._context.gl,b=new u.Shader(this._context,p.VERTEX_SHADER,"gauss.vert");b.initialize(i(9214)),this._fragmentShader=new u.Shader(this._context,p.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(i(1687)),this._program=new s.Program(this._context),this._program.initialize([b,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const x=this._program.attribute("a_vertex",0);return _===void 0?this._ndcTriangle=new h.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=_,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(x),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(_,p){const b=this._context.gl,x=[r.vec2.fromValues(1,0),r.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),b.uniform1fv(this._uWeights,this._weights)),this._program.bind(),_.bind(b.TEXTURE0),b.uniform2fv(this._uDelta,r.vec2.divide((0,f.v2)(),x[p],_.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),_.unbind(b.TEXTURE0),this._program.unbind()}}t.GaussFilter=o,o._MAXKERNELSIZEHALF=32,n([d.Initializable.initialize()],o.prototype,"initialize",null),n([d.Initializable.uninitialize()],o.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],o.prototype,"filter",null),function(m){(function(_){_[_.Horizontal=0]="Horizontal",_[_.Vertical=1]="Vertical"})(m.Direction||(m.Direction={}))}(o||(t.GaussFilter=o={}))},638:function(v,t,i){var n=this&&this.__decorate||function(d,h,s,u){var o,m=arguments.length,_=m<3?h:u===null?u=Object.getOwnPropertyDescriptor(h,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,h,s,u);else for(var p=d.length-1;p>=0;p--)(o=d[p])&&(_=(m<3?o(_):m>3?o(h,s,_):o(h,s))||_);return m>3&&_&&Object.defineProperty(h,s,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.Geometry=void 0;const r=i(4127),c=i(5507);class f extends r.Initializable{constructor(h,s){super(),this._buffers=new Array,s=s!==void 0&&s!==""?s:this.constructor.name,this._vertexArray=new c.VertexArray(h,`${s}VAO`)}initialize(...h){const s=h[0],u=h[1];let o=!0;for(let m=0;m<this._buffers.length;++m)o=this._buffers[m].initialize(s[m])&&o;return this._vertexArray.initialize(()=>this.bindBuffers(u),()=>this.unbindBuffers(u)),this._vertexArray.valid&&o}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach(h=>h.uninitialize())}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}t.Geometry=f,n([r.Initializable.initialize()],f.prototype,"initialize",null),n([r.Initializable.uninitialize()],f.prototype,"uninitialize",null),n([r.Initializable.assert_initialized()],f.prototype,"bind",null),n([r.Initializable.assert_initialized()],f.prototype,"unbind",null)},5150:(v,t,i)=>{const n=i(3557);var r;(function(c){function f(h){return h>0?h-Math.floor(h):h-Math.ceil(h)}c.sign=function(h){return h>0?1:h<0?-1:0},c.clamp=function(h,s,u){return Math.max(s,Math.min(u,h))},c.fract=f,c.v2=function(){return n.vec2.create()},c.clamp2=function(h,s,u,o){return h[0]=Math.max(u[0],Math.min(o[0],s[0])),h[1]=Math.max(u[1],Math.min(o[1],s[1])),h},c.abs2=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h},c.v3=function(){return n.vec3.create()},c.clamp3=function(h,s,u,o){return h[0]=Math.max(u[0],Math.min(o[0],s[0])),h[1]=Math.max(u[1],Math.min(o[1],s[1])),h[2]=Math.max(u[2],Math.min(o[2],s[2])),h},c.abs3=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h[2]=Math.abs(s[2]),h};const d=1/256;c.encode_float24x1_to_uint8x3=function(h,s){return h[0]=Math.floor(256*s),h[1]=Math.floor(256*f(256*s)),h[2]=Math.floor(256*f(65536*s)),h},c.decode_float24x1_from_uint8x3=function(h){return(h[0]+(h[1]+h[2]*d)*d)*d},c.encode_uint24_to_rgb8=function(h,s){return h[0]=s>>>0&255,h[1]=s>>>8&255,h[2]=s>>>16&255,h},c.encode_uint32_to_rgba8=function(h,s){return h[0]=s>>>0&255,h[1]=s>>>8&255,h[2]=s>>>16&255,h[3]=s>>>24&255,h},c.decode_uint24_from_rgb8=function(h){return h[0]+(h[1]<<8)+(h[2]<<16)},c.decode_uint32_from_rgba8=function(h){return h[0]+(h[1]<<8)+(h[2]<<16)+(h[3]<<24)>>>0},c.fromVec4=function(h){return h[3]===0?n.vec3.fromValues(h[0],h[1],h[2]):n.vec3.fromValues(h[0]/h[3],h[1]/h[3],h[2]/h[3])},c.v4=function(){return n.vec4.create()},c.clamp4=function(h,s,u,o){return h[0]=Math.max(u[0],Math.min(o[0],s[0])),h[1]=Math.max(u[1],Math.min(o[1],s[1])),h[2]=Math.max(u[2],Math.min(o[2],s[2])),h[3]=Math.max(u[3],Math.min(o[3],s[3])),h},c.abs4=function(h,s){return h[0]=Math.abs(s[0]),h[1]=Math.abs(s[1]),h[2]=Math.abs(s[2]),h[3]=Math.abs(s[3]),h},c.fromVec3=function(h){return n.vec4.fromValues(h[0],h[1],h[2],1)},c.parseVec2=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==2||isNaN(s[0])||isNaN(s[1])?void 0:n.vec2.clone(s)},c.parseVec3=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==3||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?void 0:n.vec3.clone(s)},c.parseVec4=function(h){if(h===void 0||h==="")return;let s=[];try{s=JSON.parse(`[${h}]`)}catch{return}return s.length!==4||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?void 0:n.vec4.clone(s)},c.mix=function(h,s,u){return h*(1-u)+s*u},c.m2=function(){return n.mat2.create()},c.m3=function(){return n.mat3.create()},c.m4=function(){return n.mat4.create()}})(r||(r={})),v.exports=r},829:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GL2Facade=void 0;const n=i(9504),r=i(2527);t.GL2Facade=class{constructor(c){this.drawBuffers=void 0,(0,n.assert)(c!==void 0,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(c),this.queryColorAttachments(c),this.queryInstancedArraySupport(c),this.queryDrawBuffersSupport(c),this.queryVertexArrayObjectSupport(c),this.queryMaxUniformVec3Components(c),this.queryBufferSubDataInterface(c),this.queryTexImageInterface(c)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(c){switch(c.backend){case r.Context.BackendType.WebGL1:this._halfFloat=c.supportsTextureHalfFloat&&c.textureHalfFloat?c.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case r.Context.BackendType.WebGL2:default:this._halfFloat=c.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(c){const f=c.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=f.COLOR_ATTACHMENT0,c.backend){case r.Context.BackendType.WebGL1:const d=c.supportsDrawBuffers?c.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(d?f.getParameter(d.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=d?d.COLOR_ATTACHMENT0_WEBGL:f.COLOR_ATTACHMENT0,!d)break;for(let h=1;h<16;++h)this._colorAttachments[h]=d.COLOR_ATTACHMENT0_WEBGL+h;break;case r.Context.BackendType.WebGL2:default:this._colorAttachmentMin=c.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=c.gl.COLOR_ATTACHMENT0+f.getParameter(f.MAX_COLOR_ATTACHMENTS);for(let h=0;h<16;++h)this._colorAttachments[h]=f.COLOR_ATTACHMENT0+h}}queryInstancedArraySupport(c){(c.isWebGL2||c.supportsInstancedArrays)&&(this.drawArraysInstanced=c.isWebGL2?(f,d,h,s)=>c.gl.drawArraysInstanced(f,d,h,s):(f,d,h,s)=>c.instancedArrays.drawArraysInstancedANGLE(f,d,h,s),this.drawElementsInstanced=c.isWebGL2?(f,d,h,s,u)=>c.gl.drawElementsInstanced(f,d,h,s,u):(f,d,h,s,u)=>c.instancedArrays.drawElementsInstancedANGLE(f,d,h,s,u),this.vertexAttribDivisor=c.isWebGL2?(f,d)=>c.gl.vertexAttribDivisor(f,d):(f,d)=>c.instancedArrays.vertexAttribDivisorANGLE(f,d))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(c){(c.isWebGL2||c.supportsDrawBuffers)&&(this.drawBuffers=c.isWebGL2?f=>c.gl.drawBuffers(f):f=>c.drawBuffers.drawBuffersWEBGL(f),this._maxDrawBuffers=c.isWebGL2?c.gl.MAX_DRAW_BUFFERS:c.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(c){(c.isWebGL2||c.supportsVertexArrayObject)&&(this.createVertexArray=c.isWebGL2?()=>c.gl.createVertexArray():()=>c.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=c.isWebGL2?f=>c.gl.deleteVertexArray(f):f=>c.vertexArrayObject.deleteVertexArrayOES(f),this.isVertexArray=c.isWebGL2?f=>c.gl.isVertexArray(f):f=>c.vertexArrayObject.isVertexArrayOES(f),this.bindVertexArray=c.isWebGL2?f=>c.gl.bindVertexArray(f):f=>c.vertexArrayObject.bindVertexArrayOES(f))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(c){const f=c.gl;this._maxUniformVec3Components=c.isWebGL2?f.getParameter(f.MAX_VERTEX_UNIFORM_COMPONENTS):3*f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(c){const f=c.gl;c.isWebGL2?this.bufferSubData=(d,h,s,u,o=0)=>f.bufferSubData(d,h,s,u,o):this.bufferSubData=(d,h,s,u=0,o=0)=>((0,n.logIf)(u!==0,n.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),(0,n.logIf)(o!==0,n.LogLevel.Warning,"length ignored (not supported in WebGL)"),f.bufferSubData(d,h,s))}queryTexImageInterface(c){const f=c.gl;c.isWebGL2?this.texImage2D=(d,h,s,u,o,m,_,p,b,x)=>b instanceof ArrayBuffer?f.texImage2D(d,h,s,u,o,m,_,p,b===void 0?null:b,x):((0,n.assert)(x===void 0,"offset expected to be undefined for non ArrayBuffer source"),f.texImage2D(d,h,s,u,o,m,_,p,b===void 0?null:b)):this.texImage2D=(d,h,s,u,o,m,_,p,b,x)=>b===void 0?f.texImage2D(d,h,s,u,o,m,_,p,null):b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array||b instanceof DataView?f.texImage2D(d,h,s,u,o,m,_,p,b):f.texImage2D(d,h,s,_,p,b),c.supportsTexImage3D?this.texImage3D=(d,h,s,u,o,m,_,p,b,x,E)=>x instanceof ArrayBuffer?f.texImage3D(d,h,s,u,o,m,_,p,b,x===void 0?null:x,E):((0,n.assert)(E===void 0,"offset expected to be undefined for non ArrayBuffer source"),f.texImage3D(d,h,s,u,o,m,_,p,b,x===void 0?null:x)):this.texImage3D=(d,h,s,u,o,m,_,p,b,x,E)=>(0,n.assert)(!1,"texImage3D not supported on this context")}}},6119:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFHelper=void 0;const n=i(9504);t.GLTFHelper=class{static modeToEnum(r,c){return(c<0||c>6)&&(0,n.log)(n.LogLevel.Error,`Specified draw mode is ${c} but is required to be between 0 and 6`),c===0?r.POINTS:c===1?r.LINES:c===2?r.LINE_LOOP:c===3?r.LINE_STRIP:c===4?r.TRIANGLES:c===5?r.TRIANGLE_STRIP:c===6?r.TRIANGLE_FAN:r.TRIANGLES}static nameToAttributeIndex(r){return r==="POSITION"?0:r==="NORMAL"?1:r==="TANGENT"?2:r==="TEXCOORD_0"?3:r==="TEXCOORD_1"?4:r==="TEXCOORD_2"?5:r==="JOINTS_0"?6:r==="WEIGHTS_0"?7:r==="COLOR_0"?8:((0,n.log)(n.LogLevel.Warning,`Unknown attribute name '${r}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},2604:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFLoader=void 0;const n=i(3557),r=i(9504),c=i(4613),f=i(6119),d=i(122),h=i(9806),s=i(2078),u=i(7340),o=i(1854),m=i(4168),_=i(5315),p=i(651),b=i(771),x=i(8593);t.GLTFLoader=class{constructor(E){this._context=E;const w=this._context.gl;this._resourceManager=new o.ResourceManager(this._context),this._scenes=new Array;const S=new b.Shader(this._context,w.VERTEX_SHADER,"gltf_default.vert");S.initialize(i(6626));const R=new b.Shader(this._context,w.FRAGMENT_SHADER,"gltf_default.frag");R.initialize(i(5347)),this._pbrProgram=new m.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([S,R])}async loadTextures(E){const w=this._context.gl;this._uriTextureMap=new Map;const S=E.gltf.textures,R=E.gltf.images,O=E.gltf.samplers;if(!S||!R)return;let I=0;for(const D of S){if(D.source===void 0){(0,r.log)(r.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),I++;continue}const j=D.source,k=R[j],G=this._sceneName+"_texture_"+I,Z=k.name===void 0?k.uri:k.name;let K=await E.imageData.get(j);if(!(0,r.isPowerOfTwo)(K.width)||!(0,r.isPowerOfTwo)(K.height)){const Q=document.createElement("canvas");Q.width=(0,r.upperPowerOfTwo)(K.width),Q.height=(0,r.upperPowerOfTwo)(K.height);const ae=Q.getContext("2d");ae===void 0&&(0,r.log)(r.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),ae.drawImage(K,0,0,Q.width,Q.height),K=Q}const Y=new x.Texture2D(this._context,Z);if(Y.initialize(K.width,K.height,w.RGBA8,w.RGBA,w.UNSIGNED_BYTE),Y.data(K),O===void 0||D.sampler===void 0)Y.wrap(w.REPEAT,w.REPEAT),Y.filter(w.LINEAR,w.LINEAR);else{const Q=O[D.sampler];Y.wrap(Q.wrapS||w.REPEAT,Q.wrapT||w.REPEAT),Y.filter(Q.magFilter||w.LINEAR,Q.minFilter||w.LINEAR),Q.minFilter!==w.NEAREST_MIPMAP_NEAREST&&Q.minFilter!==w.LINEAR_MIPMAP_NEAREST&&Q.minFilter!==w.NEAREST_MIPMAP_LINEAR&&Q.minFilter!==w.LINEAR_MIPMAP_LINEAR||Y.generateMipMap()}this._resourceManager.add(Y,[Z,G]);const re=k.uri?k.uri:G;this._uriTextureMap.set(re,Y),I++}}getTexture(E){const w=this._sceneName+"_texture_"+E,S=this._resourceManager.get(w);if(S!==void 0)return S;(0,r.log)(r.LogLevel.Warning,`Texture with index ${E} could not be located.`)}async loadMaterials(E){this._pbrDefaultMaterial=new h.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const w=E.gltf.materials;if(!w)return;let S=0;for(const R of w){const O=this._sceneName+"_material_"+S,I=new h.GLTFPbrMaterial(this._context,R.name),D=R.normalTexture;D!==void 0&&(I.normalTexture=this.getTexture(D.index),I.normalTexCoord=D.texCoord||0,I.normalScale=D.scale||1);const j=R.occlusionTexture;j!==void 0&&(I.occlusionTexture=this.getTexture(j.index),I.occlusionTexCoord=j.texCoord||0);const k=R.emissiveTexture;k!==void 0&&(I.emissiveTexture=this.getTexture(k.index),I.emissiveTexCoord=k.texCoord||0),I.emissiveFactor=n.vec3.fromValues(0,0,0),R.emissiveFactor!==void 0&&(I.emissiveFactor=n.vec3.fromValues.apply(void 0,R.emissiveFactor)),I.alphaMode=h.GLTFAlphaMode.OPAQUE,R.alphaMode==="MASK"?(I.alphaMode=h.GLTFAlphaMode.MASK,R.alphaCutoff===void 0?I.alphaCutoff=.5:I.alphaCutoff=R.alphaCutoff):R.alphaMode==="BLEND"&&(I.alphaMode=h.GLTFAlphaMode.BLEND,I.isTransparent=!0),I.isDoubleSided=R.doubleSided||!1;const G=R.pbrMetallicRoughness;G===void 0&&(0,r.log)(r.LogLevel.Warning,"Model contains a material without PBR information");const Z=G.baseColorTexture;Z!==void 0&&(I.baseColorTexture=this.getTexture(Z.index),I.baseColorTexCoord=Z.texCoord||0);const K=G.metallicRoughnessTexture;K!==void 0&&(I.metallicRoughnessTexture=this.getTexture(K.index),I.metallicRoughnessTexCoord=K.texCoord||0),I.baseColorFactor=n.vec4.fromValues(1,1,1,1),G.baseColorFactor!==void 0&&(I.baseColorFactor=n.vec4.fromValues.apply(void 0,G.baseColorFactor)),I.metallicFactor=1,G.metallicFactor!==void 0&&(I.metallicFactor=G.metallicFactor),I.roughnessFactor=1,G.roughnessFactor!==void 0&&(I.roughnessFactor=G.roughnessFactor),this._resourceManager.add(I,[R.name,O]),S++}}inferBufferUsage(E,w){const S=this._context.gl,R=E.gltf.meshes,O=E.gltf.accessors;if(R===void 0||O===void 0)return(0,r.log)(r.LogLevel.Error,"Asset does not include any meshes or accessors"),S.ARRAY_BUFFER;for(const I of R)for(const D of I.primitives){const j=D.indices;if(j===void 0)continue;const k=O[j].bufferView;if(k!==void 0&&k===w)return S.ELEMENT_ARRAY_BUFFER}return S.ARRAY_BUFFER}async loadBuffers(E){const w=this._context.gl,S=E.gltf.bufferViews,R=E.gltf.accessors;if(!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any buffer view information.");if(!R)return void(0,r.log)(r.LogLevel.Warning,"The asset does not include any accessor information.");let O=0;for(const D of S){const j=this._sceneName+"_bufferView_"+O,k=await E.bufferViewData(O);let G=D.target;G===void 0&&(G=this.inferBufferUsage(E,O));const Z=new u.Buffer(this._context,j);Z.initialize(G),Z.data(k,w.STATIC_DRAW),this._resourceManager.add(Z,[j]),O++}let I=0;for(const D of R){const j=D.bufferView,k=D.sparse;if(j===void 0||k!==void 0){const G=this._sceneName+"_accessor_"+I,Z=new u.Buffer(this._context,G),K=await E.accessorData(I);Z.initialize(w.ARRAY_BUFFER),Z.data(K,w.STATIC_DRAW),this._resourceManager.add(Z,[G])}I++}}async loadMeshes(E){this._meshes=new Array,this._nameMeshMap=new Map;const w=E.gltf.meshes;if(w===void 0)return(0,r.log)(r.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let S=0;for(const R of w){const O=new d.GLTFMesh(R.name);for(const I of R.primitives){const D=await this.loadPrimitive(E,I,S);D!==void 0&&O.addPrimitive(D),S++}R.name&&this._nameMeshMap.set(R.name,O),this._meshes.push(O)}return this._meshes}async loadPrimitive(E,w,S){const R=this._context.gl,O=E.gltf.accessors,I=E.gltf.bufferViews;if(O===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any accessors.");if(I===void 0)return void(0,r.log)(r.LogLevel.Error,"GLTF asset does not have any buffer views.");let D=w.mode;const j=this._sceneName+"_primitive_"+S;D||(D=4);const k=f.GLTFHelper.modeToEnum(R,D),G=new Array;let Z=this._pbrDefaultMaterial;if(w.material!==void 0){const Q=this._sceneName+"_material_"+w.material,ae=this._resourceManager.get(Q);ae!==void 0?Z=ae:(0,r.log)(r.LogLevel.Warning,`Material ${Q} could not be found.`)}let K,Y=0;for(const Q in w.attributes){const ae=f.GLTFHelper.nameToAttributeIndex(Q);Q==="NORMAL"&&(Y|=h.GLTFShaderFlags.HAS_NORMALS),Q==="TANGENT"&&(Y|=h.GLTFShaderFlags.HAS_TANGENTS),Q==="COLOR_0"&&(Y|=h.GLTFShaderFlags.HAS_COLORS),Q!=="TEXCOORD_0"&&Q!=="TEXCOORD_1"&&Q!=="TEXCOORD_2"||(Y|=h.GLTFShaderFlags.HAS_UV);const se=w.attributes[Q],ee=O[se],le=ee.bufferView,ge=ee.sparse;let ve,ne=0;if(le===void 0||ge!==void 0){const Te=this._sceneName+"_accessor_"+se;ve=this._resourceManager.get(Te)}else{const Te=I[le],oe=this._sceneName+"_bufferView_"+le;ve=this._resourceManager.get(oe),ne=Te.byteStride||0}const be=new s.VertexBinding;be.buffer=ve,be.attributeIndex=ae,be.numVertices=ee.count,be.normalized=ee.normalized||!1,be.size=c.GLTF_ELEMENTS_PER_TYPE[ee.type],be.offset=ee.byteOffset||0,be.stride=ne,be.type=ee.componentType,G.push(be)}if(w.indices!==void 0){const Q=O[w.indices],ae=Q.bufferView;!ae===void 0&&(0,r.log)(r.LogLevel.Error,"Accessor does not reference a BufferView.");const se=this._sceneName+"_bufferView_"+ae,ee=this._resourceManager.get(se);K=new s.IndexBinding,K.buffer=ee,K.numIndices=Q.count,K.offset=Q.byteOffset||0,K.type=Q.componentType}const re=new s.GLTFPrimitive(this._context,G,K,k,Z,Y);return re.initialize(),this._resourceManager.add(re,[j]),re}async generateScenes(E){const w=E.gltf.nodes,S=E.gltf.scenes;if(!w||!S)return void(0,r.log)(r.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const R=new Map;let O=0;for(const j of w){const k=j.name||"node_"+O,G=new p.SceneNode(k);if(R.set(O,G),j.matrix){const Z=n.mat4.fromValues.apply(void 0,j.matrix),K=new _.TransformComponent(Z);G.addComponent(K)}else if(j.translation||j.rotation||j.scale){let Z=n.quat.create();j.rotation&&(Z=n.quat.fromValues.apply(void 0,j.rotation));let K=n.vec3.create();j.translation&&(K=n.vec3.fromValues.apply(void 0,j.translation));let Y=n.vec3.fromValues(1,1,1);j.scale&&(Y=n.vec3.fromValues.apply(void 0,j.scale));const re=n.mat4.fromRotationTranslationScale(n.mat4.create(),Z,K,Y),Q=new _.TransformComponent(re);G.addComponent(Q)}if(j.mesh!==void 0){const Z=this._meshes[j.mesh];for(const K of Z.primitives){const Y=new _.GeometryComponent;Y.material=K.material,Y.geometry=K,G.addComponent(Y)}}(j.skin||j.weights)&&(0,r.log)(r.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),O++}O=0;for(const j of w){const k=R.get(O);if((0,r.assert)(k!==void 0,"Scene node could not be found."),j.children)for(const G of j.children){const Z=R.get(G);Z||(0,r.log)(r.LogLevel.Error,"Model references a node that does not exist."),k.addNode(Z)}O++}let I=0;for(const j of S){const k=j.name||"scene_"+I,G=new p.SceneNode(k);if(j.nodes)for(const Z of j.nodes){const K=R.get(Z);K||(0,r.log)(r.LogLevel.Error,"Scene references a node that does not exist."),G.addNode(K)}else(0,r.log)(r.LogLevel.Warning,`Scene ${k} does not contain any nodes.`);this._scenes.push(G),I++}const D=E.gltf.scene;D!==void 0&&(this._defaultScene=this._scenes[D])}async loadAsset(E){const w=new c.GltfLoader,S=await w.load(E),R=S.gltf;this._sceneName="scene",R.scenes&&R.scene&&R.scenes[R.scene].name&&(this._sceneName=R.scenes[R.scene].name),await this.loadTextures(S).then(()=>this.loadMaterials(S)).then(()=>this.loadBuffers(S)).then(()=>this.loadMeshes(S)).then(()=>this.generateScenes(S))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(E){return this._nameMeshMap.get(E)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return this._defaultScene!==void 0?this._defaultScene:this._scenes!==void 0&&this._scenes.length>0?this._scenes[0]:((0,r.log)(r.LogLevel.Warning,"Default scene was requested, but none is available."),new p.SceneNode("EmptyScene"))}}},122:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=void 0,t.GLTFMesh=class{constructor(i){this._name=i,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(i){this._primitives.push(i)}}},9806:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFShaderFlags=void 0;const n=i(3557),r=i(5315);var c,f;(function(h){h[h.HAS_NORMALS=1]="HAS_NORMALS",h[h.HAS_TANGENTS=2]="HAS_TANGENTS",h[h.HAS_UV=4]="HAS_UV",h[h.HAS_COLORS=8]="HAS_COLORS",h[h.USE_IBL=16]="USE_IBL",h[h.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",h[h.HAS_NORMALMAP=64]="HAS_NORMALMAP",h[h.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",h[h.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",h[h.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",h[h.USE_TEX_LOD=1024]="USE_TEX_LOD"})(c||(t.GLTFShaderFlags=c={})),function(h){h[h.OPAQUE=0]="OPAQUE",h[h.MASK=1]="MASK",h[h.BLEND=2]="BLEND"}(f||(t.GLTFAlphaMode=f={}));class d extends r.Material{constructor(s,u){super(s,u),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=f.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=n.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=n.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(s){this._baseColorTexture=s}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(s){this._metallicRoughnessTexture=s}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(s){this._normalTexture=s}get normalTexture(){return this._normalTexture}set occlusionTexture(s){this._occlusionTexture=s}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(s){this._emissiveTexture=s}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(s){this._emissiveFactor=s}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(s){this._baseColorFactor=s}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(s){this._metallicFactor=s}get metallicFactor(){return this._metallicFactor}set roughnessFactor(s){this._roughnessFactor=s}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(s){this._normalScale=s}set isDoubleSided(s){this._isDoubleSided=s}get isDoubleSided(){return this._isDoubleSided}set alphaMode(s){this._alphaMode=s}get alphaMode(){return this._alphaMode}set alphaCutoff(s){this._alphaCutoff=s}get alphaCutoff(){return this._alphaCutoff}get flags(){let s=0;return this.baseColorTexture!==void 0&&(s|=c.HAS_BASECOLORMAP),this.metallicRoughnessTexture!==void 0&&(s|=c.HAS_METALROUGHNESSMAP),this.normalTexture!==void 0&&(s|=c.HAS_NORMALMAP),this.occlusionTexture!==void 0&&(s|=c.HAS_OCCLUSIONMAP),this.emissiveTexture!==void 0&&(s|=c.HAS_EMISSIVEMAP),s}}t.GLTFPbrMaterial=d},2078:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPrimitive=t.VertexBinding=t.IndexBinding=void 0;const n=i(638),r=i(6119);t.IndexBinding=class{},t.VertexBinding=class{};class c extends n.Geometry{constructor(d,h,s,u,o,m,_){super(d,_),this._bindings=h,this._indexBinding=s,this._material=o,this._geometryFlags=m,this._drawMode=u}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const d of this._bindings)d.buffer.attribEnable(d.attributeIndex,d.size,d.type,d.normalized,d.stride,d.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const d of this._bindings)d.buffer.attribDisable(d.attributeIndex,!0,!0)}draw(){const d=this.context.gl;this._indexBinding?d.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):d.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(d){const h=r.GLTFHelper.nameToAttributeIndex(d);for(const s of this._bindings)if(s.attributeIndex===h)return s}}t.GLTFPrimitive=c},8892:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=t.GLTFPrimitive=t.GLTFShaderFlags=t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFLoader=void 0;var n=i(2604);Object.defineProperty(t,"GLTFLoader",{enumerable:!0,get:function(){return n.GLTFLoader}});var r=i(9806);Object.defineProperty(t,"GLTFAlphaMode",{enumerable:!0,get:function(){return r.GLTFAlphaMode}}),Object.defineProperty(t,"GLTFPbrMaterial",{enumerable:!0,get:function(){return r.GLTFPbrMaterial}}),Object.defineProperty(t,"GLTFShaderFlags",{enumerable:!0,get:function(){return r.GLTFShaderFlags}});var c=i(2078);Object.defineProperty(t,"GLTFPrimitive",{enumerable:!0,get:function(){return c.GLTFPrimitive}});var f=i(122);Object.defineProperty(t,"GLTFMesh",{enumerable:!0,get:function(){return f.GLTFMesh}})},4127:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Initializable=void 0;const n=i(9504);class r{constructor(){this._initialized=!1,this.assertInitialized=()=>r.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(f,d,h)=>{const s=h.value;return h.value=function(){return(0,n.assert)(this._initialized===!1,"re-initialization of initialized object not anticipated"),this._initialized=s.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>r.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)),this._initialized},h}}static uninitialize(){return(f,d,h)=>{const s=h.value;return h.value=function(){(0,n.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},h}}static discard(){return(f,d,h)=>{const s=h.value;return h.value=function(){(0,n.assert)(this._initialized===!0,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>r.assertInitializedFalse(this)},h}}static assert_initialized(){return(f,d,h)=>{const s=h.value;return h.value=function(){return this.assertInitialized(),s.apply(this,arguments)},h}}static assert_uninitialized(){return(f,d,h)=>{const s=h.value;return h.value=function(){this.assertUninitialized(),s.apply(this,arguments)},h}}get initialized(){return this._initialized}}t.Initializable=r,r.assertInitializedFalse=c=>(0,n.assert)(!1,`instance of ${c.constructor.name} expected to be initialized`),r.assertUninitializedFalse=c=>(0,n.assert)(!1,`instance of ${c.constructor.name} not expected to be initialized`)},4287:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KernelI8=t.KernelUI8=t.KernelI32=t.KernelUI32=t.KernelF32=t.AbstractKernel=void 0;const n=i(9504);class r{constructor(f,d,h=1,s=1){this._components=f,this._width=isNaN(d)?1:Math.max(1,d),this._height=Math.max(1,h),this._depth=Math.max(1,s),this.resize()}get(f,d,h){let s;switch(s=d===void 0&&h===void 0?this._components*f:this.index(f,d,h||0),(0,n.assert)(s<this.length,`index expected to be in range [0, ${this.length-1}], given ${s}`),this._components){case 1:return[this._samples[s]];case 2:return[this._samples[s],this._samples[s+1]];case 3:return[this._samples[s],this._samples[s+1],this._samples[s+2]];case 4:return[this._samples[s],this._samples[s+1],this._samples[s+2],this._samples[s+3]]}}set(f,d,h,s){let u;switch((0,n.assert)(f.length===this._components,`number of components expected to be ${this._components}, given ${f.length}`),u=h===void 0&&s===void 0?this._components*Math.min(this.elements,Math.max(0,d)):this._components*this.index(d,h,s||0),(0,n.assert)(u<this.length,`index expected to be in range [0, ${this.length-1}], given ${u}`),this._components){case 4:this._samples[u+3]=f[3];case 3:this._samples[u+2]=f[2];case 2:this._samples[u+1]=f[1];case 1:this._samples[u+0]=f[0]}}fromJSON(f){(0,n.assert)(f.size&&f.size.width!==void 0&&f.size.height!==void 0&&f.size.depth!==void 0,`expected kernel width, height, and depth to be set, given '${f.size}'`);const d=s=>s.reduce((u,o)=>u.concat(Array.isArray(o)?d(o):o),[]);this._width=Math.max(1,f.size.width),this._height=Math.max(1,f.size.height),this._depth=Math.max(1,f.size.depth);const h=d(f.kernel);this._components=Math.floor(h.length/this.elements),this.resize(),this.fromArray(h)}index(f,d=0,h=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,h))+Math.min(this._height,Math.max(0,d)))+Math.min(this._width,Math.max(0,f))}position(f){let d=Math.min(this.elements,Math.max(0,f));const h=Math.floor(d/(this._width*this._height));d-=h*this._width*this._height;const s=Math.floor(d/this._width);return d-=s*this._width,[d,s,h]}sort(f){if(this.elements<2)return;const d=Array(this.elements);for(let s=0;s<this.elements;++s){let u=0;r.SortApproach.BySquaredLength;for(let o=0;o<this._components;++o){const m=this._samples[s*this._components+o];u+=m*m}d[s]=[s,u]}r.SortApproach.BySquaredLength,d.sort((s,u)=>s[1]-u[1]);const h=this._samples.slice();for(let s=0;s<d.length;++s)for(let u=0;u<this._components;++u){const o=d[s][0]*this._components+u,m=s*this._components+u;this._samples[m]=h[o]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const f=this._width*this._height*this._depth;return isNaN(f)?0:f}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}t.AbstractKernel=r,function(c){(function(f){f[f.BySquaredLength=0]="BySquaredLength"})(c.SortApproach||(c.SortApproach={}))}(r||(t.AbstractKernel=r={})),t.KernelF32=class extends r{resize(){this._samples=new Float32Array(this.length)}fromArray(c){(0,n.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(c))}get bytesPerComponent(){return 4}},t.KernelUI32=class extends r{resize(){this._samples=new Uint32Array(this.length)}fromArray(c){(0,n.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(c))}get bytesPerComponent(){return 4}},t.KernelI32=class extends r{resize(){this._samples=new Int32Array(this.length)}fromArray(c){(0,n.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(c))}get bytesPerComponent(){return 4}},t.KernelUI8=class extends r{resize(){this._samples=new Uint8Array(this.length)}fromArray(c){(0,n.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(c))}get bytesPerComponent(){return 4}},t.KernelI8=class extends r{resize(){this._samples=new Int8Array(this.length)}fromArray(c){(0,n.assert)(c.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(c))}get bytesPerComponent(){return 4}}},5678:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardEventType=t.KeyboardEventProvider=void 0;const n=i(7032),r=i(9504);var c;t.KeyboardEventProvider=class{constructor(f,d){(0,r.assert)(f!==void 0,`expected valid canvas element on initialization, given ${f}`),this._element=f,this._timeframe=d}preventDefaultOnEvent(f,d){(0,r.bitInBitfield)(this._preventDefaultMask,f)&&d.preventDefault()}preventDefault(...f){for(const d of f)(0,r.bitInBitfield)(this._preventDefaultMask,d)||(this._preventDefaultMask|=d)}allowDefault(...f){for(const d of f)(0,r.bitInBitfield)(this._preventDefaultMask,d)&&(this._preventDefaultMask&=~d)}observable(f){switch(f){case c.KeyDown:return this.keyDown$;case c.KeyPress:return this.keyPress$;case c.KeyUp:return this.keyUp$;default:return}}get keyDown$(){return this._keyDownSubject===void 0&&(this._keyDownSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyDownListener=f=>{this.preventDefaultOnEvent(c.KeyDown,f),this._keyDownSubject.next(f)},this._element.addEventListener("keydown",this._keyDownListener)),this._keyDownSubject.asObservable()}get keyPress$(){return this._keyPressSubject===void 0&&(this._keyPressSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyPressListener=f=>{this.preventDefaultOnEvent(c.KeyPress,f),this._keyPressSubject.next(f)},this._element.addEventListener("keypress",this._keyPressListener)),this._keyPressSubject.asObservable()}get keyUp$(){return this._keyUpSubject===void 0&&(this._keyUpSubject=new n.ReplaySubject(void 0,this._timeframe),this._keyUpListener=f=>{this.preventDefaultOnEvent(c.KeyUp,f),this._keyUpSubject.next(f)},this._element.addEventListener("keyup",this._keyUpListener)),this._keyUpSubject.asObservable()}},function(f){f[f.KeyDown=1]="KeyDown",f[f.KeyPress=2]="KeyPress",f[f.KeyUp=4]="KeyUp"}(c||(t.KeyboardEventType=c={}))},4602:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MouseEventProvider=void 0;const n=i(7032),r=i(9504),c=i(8853),f=i(2010);class d{constructor(s,u){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=u,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(c.IS_EDGE||c.IS_IE11)&&this._element.addEventListener("dragstart",o=>o.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&f.PointerLock.request(this._element)}preventDefaultOnEvent(s,u){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&u.preventDefault()}preventDefault(...s){for(const u of s)(0,r.bitInBitfield)(this._preventDefaultMask,u)||(this._preventDefaultMask|=u)}allowDefault(...s){for(const u of s)(0,r.bitInBitfield)(this._preventDefaultMask,u)&&(this._preventDefaultMask&=~u)}observable(s){switch(s){case d.Type.Click:return this.click$;case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Wheel:return this.wheel$;case d.Type.Drag:return this.drag$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,f.PointerLock.exit())}get pointerLock(){return f.PointerLock.active(this._element)}get click$(){return this._clickSubject===void 0&&(this._clickSubject=new n.ReplaySubject(void 0,this._timeframe),this._clickListener=s=>{this.preventDefaultOnEvent(d.Type.Click,s),this._clickSubject.next(s)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return this._wheelSubject===void 0&&(this._wheelSubject=new n.ReplaySubject(void 0,this._timeframe),this._wheelListener=s=>{this.preventDefaultOnEvent(d.Type.Wheel,s),this._wheelSubject.next(s)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return this._dragSubject===void 0&&(this._dragSubject=new n.ReplaySubject(void 0,this._timeframe),this._dragListener=s=>{this.preventDefaultOnEvent(d.Type.Drag,s),this._dragSubject.next(s)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}t.MouseEventProvider=d,function(h){(function(s){s[s.Click=1]="Click",s[s.Wheel=2]="Wheel",s[s.Enter=4]="Enter",s[s.Leave=8]="Leave",s[s.Move=16]="Move",s[s.Down=32]="Down",s[s.Up=64]="Up",s[s.Drag=128]="Drag"})(h.Type||(h.Type={}))}(d||(t.MouseEventProvider=d={}))},8853:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IS_EDGE=t.IS_IE11=void 0,t.IS_IE11=typeof navigator>"u"?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),t.IS_EDGE=typeof navigator>"u"?void 0:/Edge\/\d./i.test(navigator.userAgent)},4264:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Navigation=void 0;const n=i(3557),r=i(2),c=i(2010),f=i(9504),d=i(4850),h=i(506),s=i(5222),u=i(3151),o=i(9184),m=i(7137);class _{constructor(b,x){this._alwaysRotateOnMove=!1,this._invalidate=b,this._eventHandler=new r.EventHandler(b,x),this._eventHandler.pushPointerDownHandler((E,w)=>this.onPointerDown(E,w)),this._eventHandler.pushPointerUpHandler((E,w)=>this.onPointerUp(E,w)),this._eventHandler.pushPointerEnterHandler((E,w)=>this.onPointerEnter(E,w)),this._eventHandler.pushPointerLeaveHandler((E,w)=>this.onPointerLeave(E,w)),this._eventHandler.pushPointerMoveHandler((E,w)=>this.onPointerMove(E,w)),this._eventHandler.pushPointerCancelHandler((E,w)=>this.onPointerCancel(E,w)),this._eventHandler.pushMouseWheelHandler((E,w)=>this.onWheel(E,w)),this.rotationMetaphor=_.RotationMetaphor.Turntable,this._pan=new h.PanModifier,this._pinch=new s.PinchZoomModifier,this._wheelZoom=new m.WheelZoomModifier,this._activeEvents=new Map}mode(){const b=Array.from(this._activeEvents.values()),x=this.getPrimaryEvent(b);if(x===void 0)return void(0,f.log)(f.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const E=x.pointerType==="mouse",w=x.pointerType==="touch"||x.pointerType==="pen",S=1&x.buttons,R=x.shiftKey,O=c.PointerLock.active()&&this._alwaysRotateOnMove,I=this._activeEvents.size;return O?_.Modes.Rotate:E&&S&&R&&I===1?_.Modes.Pan:w&&I===2?_.Modes.MultiTouch:E&&S&&I===1||w&&I===1?_.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void(0,f.log)(f.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const b=Array.from(this._activeEvents.values()),x=n.vec2.fromValues(b[0].movementX,b[0].movementY),E=n.vec2.fromValues(b[1].movementX,b[1].movementY);return n.vec2.length(x)===0||n.vec2.length(E)===0?_.Modes.Zoom:(n.vec2.normalize(x,x),n.vec2.normalize(E,E),n.vec2.dot(x,E)>.2?_.Modes.Pan:_.Modes.Zoom)}rotate(b){if(this._activeEvents.size!==1)return void(0,f.log)(f.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0];switch(this._rotationMetaphor){case _.RotationMetaphor.FirstPerson:const w=this._firstPerson;let S;c.PointerLock.active()&&event instanceof MouseEvent&&(S=n.vec2.fromValues(event.movementX,event.movementY)),b?w.initiate(E):w.process(E,S);break;case _.RotationMetaphor.Trackball:const R=this._trackball;b?R.initiate(E):R.process(E);break;case _.RotationMetaphor.Turntable:const O=this._turntable;b?O.initiate(E):O.process(E)}}pan(b){const x=Array.from(this._activeEvents.values()),E=this.getPrimaryEvent(x);if(E===void 0)return void(0,f.log)(f.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const w=this._eventHandler.offsets(E)[0],S=this._pan;b?S.initiate(w):S.process(w)}pinch(b){if(this._activeEvents.size!==2)return void(0,f.log)(f.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const x=Array.from(this._activeEvents.values()),E=this._eventHandler.offsets(x[0])[0],w=this._eventHandler.offsets(x[1])[0],S=this._pinch;b?S.initiate(E,w):S.process(E,w)}getPrimaryEvent(b){for(const x of b)if(x.isPrimary)return x}onPointerDown(b,x){for(const E of b)this._activeEvents.set(E.pointerId,E);switch(this._mode=this.mode(),this._mode){case _.Modes.Rotate:this.rotate(!0);break;case _.Modes.Pan:this.pan(!0);break;case _.Modes.Zoom:this.pinch(!0)}}onPointerUp(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerEnter(b,x){}onPointerLeave(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerCancel(b,x){for(const E of b)this._activeEvents.delete(E.pointerId)}onPointerMove(b,x){for(const R of b)this._activeEvents.set(R.pointerId,R);if(this._mode===void 0)return;const E=Array.from(this._activeEvents.values()),w=this.getPrimaryEvent(E);w&&w.pointerType==="mouse"&&(this._mode=this.mode());let S=!1;switch(this._mode===_.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),S=!0),this._mode){case _.Modes.Rotate:this.rotate(S);break;case _.Modes.Pan:this.pan(S);break;case _.Modes.Zoom:this.pinch(S)}this._lastInteractionTime=performance.now()}onWheel(b,x){const E=b[0];this._wheelZoom.process(E.deltaY)}update(){this._eventHandler.update()}set camera(b){this._camera=b,this._firstPerson&&(this._firstPerson.camera=b),this._trackball&&(this._trackball.camera=b),this._turntable&&(this._turntable.camera=b),this._pan&&(this._pan.camera=b),this._pinch&&(this._pinch.camera=b),this._wheelZoom&&(this._wheelZoom.camera=b)}set rotationMetaphor(b){if(this._rotationMetaphor!==b){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=b,this._rotationMetaphor){case _.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new d.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case _.RotationMetaphor.Trackball:this._trackball=new u.TrackballModifier,this._trackball.camera=this._camera;break;case _.RotationMetaphor.Turntable:this._turntable=new o.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}t.Navigation=_,function(p){(function(b){b[b.Move=0]="Move",b[b.Pan=1]="Pan",b[b.MultiTouch=2]="MultiTouch",b[b.Rotate=3]="Rotate",b[b.Zoom=4]="Zoom",b[b.ZoomStep=5]="ZoomStep"})(p.Modes||(p.Modes={})),function(b){b.FirstPerson="firstperson",b.Flight="flight",b.Trackball="trackball",b.Turntable="turntable"}(p.RotationMetaphor||(p.RotationMetaphor={}))}(_||(t.Navigation=_={}))},5491:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingRectangle=void 0;const r=i(7340),c=i(638),f=i(4127);class d extends c.Geometry{constructor(s,u){super(s,u),u=u!==void 0&&u!==""?u:this.constructor.name;const o=new r.Buffer(s,`${u}VBO`);this._buffers.push(o)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const u=this.context.gl,o=super.initialize([u.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,u.STATIC_DRAW),o}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingRectangle=d,d.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),n([f.Initializable.assert_initialized()],d.prototype,"draw",null)},1896:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingTriangle=void 0;const r=i(7340),c=i(638),f=i(4127);class d extends c.Geometry{constructor(s,u){super(s,u),u=u!==void 0&&u!==""?u:this.constructor.name;const o=new r.Buffer(s,`${u}VBO`);this._buffers.push(o)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(s=0){this._vertexLocation=s;const u=this.context.gl,o=super.initialize([u.ARRAY_BUFFER]);return this._buffers[0].data(d.VERTICES,u.STATIC_DRAW),o}draw(){const s=this.context.gl;s.drawArrays(s.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}t.NdcFillingTriangle=d,d.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),n([f.Initializable.assert_initialized()],d.prototype,"draw",null)},9965:function(v,t,i){var n=this&&this.__decorate||function(d,h,s,u){var o,m=arguments.length,_=m<3?h:u===null?u=Object.getOwnPropertyDescriptor(h,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,h,s,u);else for(var p=d.length-1;p>=0;p--)(o=d[p])&&(_=(m<3?o(_):m>3?o(h,s,_):o(h,s))||_);return m>3&&_&&Object.defineProperty(h,s,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractObject=void 0;const r=i(9504),c=i(4127);class f extends c.Initializable{constructor(h,s){super(),this._valid=!1,this._referenceCount=0,this._context=h,this._identifier=s!==void 0&&s!==""?s:"Object"}initialize(...h){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...h),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),(0,r.log)(r.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),(0,r.assert)(this._object===void 0,`expected object '${this._identifier}' to be undefined after delete`),(0,r.assert)(this._valid===!1,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return(0,r.assert)(this._object!==void 0,"access to undefined object"),this._object}get valid(){return this._valid}ref(){(0,r.assert)(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){(0,r.assert)(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}t.AbstractObject=f,n([c.Initializable.initialize()],f.prototype,"initialize",null),n([c.Initializable.uninitialize()],f.prototype,"uninitialize",null)},506:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PanModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h}process(h){this._currentPoint=h;const s=n.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity);const u=n.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(u,u);const o=this._reference.up;n.vec3.normalize(o,o);const m=n.vec3.cross((0,r.v3)(),o,u),_=n.vec3.scale((0,r.v3)(),m,s[0]),p=n.vec3.scale((0,r.v3)(),o,s[1]);n.vec3.negate(p,p),this._translation=n.vec3.add((0,r.v3)(),p,_),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._translation),s=n.vec3.transformMat4((0,r.v3)(),this._reference.eye,h),u=n.vec3.transformMat4((0,r.v3)(),this._reference.center,h);this._camera.eye=s,this._camera.center=u}}t.PanModifier=f,f.DEFAULT_SENSITIVITY=.002},5222:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PinchZoomModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}initiate(h,s){Object.assign(this._reference,this._camera);const u=n.vec2.subtract((0,r.v2)(),h,s);this._initialDistance=n.vec2.length(u)}process(h,s){const u=n.vec2.subtract((0,r.v2)(),h,s);this._currentDistance=n.vec2.length(u);const o=(this._currentDistance/this._initialDistance-1)*f.DEFAULT_SENSITIVITY,m=n.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);n.vec3.normalize(m,m),this._translation=n.vec3.scale((0,r.v3)(),m,o),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._translation),s=n.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.eye=s}}t.PinchZoomModifier=f,f.DEFAULT_SENSITIVITY=2},8216:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerEventProvider=void 0;const n=i(7032),r=i(9504),c=i(8853),f=i(2010);class d{constructor(s,u){this._pointerLockRequestPending=!1,(0,r.assert)(s!==void 0,`expected valid canvas element on initialization, given ${s}`),this._element=s,this._timeframe=u,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(c.IS_EDGE||c.IS_IE11)&&this._element.addEventListener("dragstart",o=>o.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&f.PointerLock.request(this._element)}preventDefaultOnEvent(s,u){(0,r.bitInBitfield)(this._preventDefaultMask,s)&&u.preventDefault()}preventDefault(...s){for(const u of s)(0,r.bitInBitfield)(this._preventDefaultMask,u)||(this._preventDefaultMask|=u)}allowDefault(...s){for(const u of s)(0,r.bitInBitfield)(this._preventDefaultMask,u)&&(this._preventDefaultMask&=~u)}observable(s){switch(s){case d.Type.Enter:return this.enter$;case d.Type.Leave:return this.leave$;case d.Type.Down:return this.down$;case d.Type.Up:return this.up$;case d.Type.Move:return this.move$;case d.Type.Cancel:return this.cancel$;default:return}}set pointerLock(s){this._pointerLockRequestPending=s,s===!1&&(this._pointerLockRequestPending=!1,f.PointerLock.exit())}get pointerLock(){return f.PointerLock.active(this._element)}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=s=>{this.preventDefaultOnEvent(d.Type.Enter,s),this._enterSubject.next(s)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=s=>{this.preventDefaultOnEvent(d.Type.Leave,s),this._leaveSubject.next(s)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=s=>{this.preventDefaultOnEvent(d.Type.Down,s),this._downSubject.next(s)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=s=>{this.preventDefaultOnEvent(d.Type.Up,s),this._upSubject.next(s)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=s=>{this.preventDefaultOnEvent(d.Type.Move,s),this._moveSubject.next(s)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new n.ReplaySubject(void 0,this._timeframe),this._cancelListener=s=>{this.preventDefaultOnEvent(d.Type.Cancel,s),this._cancelSubject.next(s)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.PointerEventProvider=d,function(h){(function(s){s[s.Enter=1]="Enter",s[s.Leave=2]="Leave",s[s.Move=4]="Move",s[s.Down=8]="Down",s[s.Up=16]="Up",s[s.Cancel=32]="Cancel"})(h.Type||(h.Type={}))}(d||(t.PointerEventProvider=d={}))},2010:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PointerLock=void 0;const n=i(9504);class r{static queryAndCacheAPI(){if(r._exit!==void 0)return;const f=window.document,d=[f.exitPointerLock,f.mozExitPointerLock,f.webkitExitPointerLock,void 0];let h=0;for(;h<d.length&&d[h]===void 0;++h);switch(h){case 0:r._exit=()=>f.exitPointerLock(),r._request=s=>s.requestPointerLock(),r._element=()=>f.pointerLockElement;break;case 1:r._exit=()=>f.mozCancelPointerLock(),r._request=s=>s.mozRequestPointerLock(),r._element=()=>f.mozPointerLockElement;break;case 2:r._exit=()=>f.webkitExitPointerLock(),r._request=s=>s.webkitRequestPointerLock(),r._element=()=>f.webkitPointerLockElement;break;default:(0,n.assert)(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(f){return this._element!==void 0&&(f!==void 0&&r._element()===f||f===void 0&&r._element()!==void 0&&r._element()!==null)}static request(f,d){f!==void 0&&(r.queryAndCacheAPI(),r.active()&&r._element()!==f&&r._exit(),r.active()||r._request(f))}static exit(){r._exit&&r._exit()}}t.PointerLock=r},4985:function(){String.prototype.repeat===void 0&&(String.prototype.repeat=function(v){if(this===null)throw new TypeError("can't convert "+this+" to object");const t=""+this;if((v=+v)!=v&&(v=0),v<0)throw new RangeError("repeat count must be non-negative");if(v===1/0)throw new RangeError("repeat count must be less than infinity");if(v=Math.floor(v),t.length===0||v===0)return"";if(t.length*v>=268435456)throw new RangeError("repeat count must not overflow maximum string size");let i="";for(let n=0;n<v;n++)i+=t;return i}),String.prototype.startsWith===void 0&&(String.prototype.startsWith=function(v,t){return t=t||0,this.indexOf(v,t)===t}),String.prototype.endsWith===void 0&&(String.prototype.endsWith=function(v,t){return(t===void 0||t>this.length)&&(t=this.length),this.substring(t-v.length,t)===v}),String.prototype.includes===void 0&&(String.prototype.includes=function(v,t){return typeof t!="number"&&(t=0),!(t+v.length>this.length)&&this.indexOf(v,t)!==-1}),String.prototype.trimLeft===void 0&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight===void 0&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Array.prototype.forEach===void 0&&(Array.prototype.forEach=(v,t)=>{const i=this.length;for(let n=0;n<i;n++)n in this&&v.call(t,this[n],n,this)}),Array.prototype.fill===void 0&&(Array.prototype.fill=(v,t,i)=>{if(this===null)throw new TypeError("this is null or not defined");const n=Object(this),r=n.length>>>0,c=0|t;let f=c<0?Math.max(r+c,0):Math.min(c,r);const d=i===void 0?r:0|i,h=d<0?Math.max(r+d,0):Math.min(d,r);for(;f<h;)n[f]=v,++f;return n}),Math.log10===void 0&&(Math.log10=v=>Math.log(v)*Math.LOG10E),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach(v=>{v.prototype.slice||Object.defineProperty(v.prototype,"slice",{value:Array.prototype.slice}),v.prototype.reduce||Object.defineProperty(v.prototype,"reduce",{value:Array.prototype.reduce}),v.prototype.filter||Object.defineProperty(v.prototype,"filter",{value:Array.prototype.filter}),v.prototype.map||Object.defineProperty(v.prototype,"map",{value:Array.prototype.map}),v.prototype.indexOf||Object.defineProperty(v.prototype,"indexOf",{value:Array.prototype.indexOf})}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{value(v,t){if(v===void 0&&v===null)throw new TypeError("Cannot convert undefined or null to object");const i=Object(v);for(let n=1;n<arguments.length;n++){const r=arguments[n];if(r!=null)for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&(i[c]=r[c])}return i},configurable:!0,writable:!0})},4168:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(s=new Array,u=!0){const o=this._context.gl;let m=0,_=0;for(const p of s)switch(p.type){case o.VERTEX_SHADER:++m;break;case o.FRAGMENT_SHADER:++_;break;default:(0,r.assert)(!1,"Unknown shader type detected.")}if((0,r.logIf)(m<1,r.LogLevel.Error,"at least one vertex shader is expected"),(0,r.logIf)(_<1,r.LogLevel.Error,"at least one fragment shader is expected"),!(m<1||_<1))return this._object=o.createProgram(),this._valid=o.isProgram(this._object),(0,r.assert)(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),s.length>0&&this.attach(s,u),this._object}delete(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(s,u=!1){(0,r.assert)(this._object!==void 0,"expected a WebGLProgram object");const o=this._context.gl;for(const m of s instanceof Array?s:[s])this._shaders.indexOf(m)>-1||(this._shaders.push(m),m.initialized?(o.attachShader(this._object,m.object),m.ref()):(0,r.log)(r.LogLevel.Error,`shader '${m.identifier}' not initialized.`));return u&&this.link(),!0}detach(s){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const u=this._context.gl;for(const o of s instanceof Array?s:[s]){const m=this._shaders.indexOf(o);m>-1&&this._shaders.splice(m),(0,r.assert)(o.initialized,`expected shader '${o.identifier}' to be initialized`),u.detachShader(this._object,o.object),o.unref()}}link(){(0,r.assert)(this._object!==void 0,"expected WebGLProgram object");const s=this._context.gl;if(s.linkProgram(this._object),s.getProgramParameter(this._object,s.LINK_STATUS))this._linked=!0;else{const u=s.getProgramInfoLog(this._object);(0,r.log)(r.LogLevel.Error,`linking of program '${this._identifier}' failed: '${u}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(d.DEFAULT_PROGRAM)}uniform(s){return this._context.gl.getUniformLocation(this._object,s)}attribute(s,u){return u!==void 0?((0,r.logIf)(this._linked,r.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${s} -> ${u} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,u,s),u):this._context.gl.getAttribLocation(this._object,s)}get shaders(){return this._shaders}get linked(){return this._linked}}t.Program=d,d.DEFAULT_PROGRAM=void 0,n([c.Initializable.assert_initialized()],d.prototype,"bind",null),n([c.Initializable.assert_initialized()],d.prototype,"unbind",null),n([c.Initializable.assert_initialized()],d.prototype,"uniform",null),n([c.Initializable.assert_initialized()],d.prototype,"attribute",null)},1407:(v,t,i)=>{const n=i(3780),r=i(9504);function c(h,s){const u=s.properties,o=Object.getOwnPropertyNames(u);for(const m of o){const _=u[m],p=_.type==="object",b=h.hasOwnProperty(m),x=_.hasOwnProperty("properties"),E=_.hasOwnProperty("default");(0,r.assert)(x&&p||!x&&!p,`expected property '${m}' to be of type 'object', given '${_.type}'`),b&&x?d.complement(h[m],_):!b&&E&&Object.defineProperty(h,m,{value:_.default,writable:!0})}}function f(h,s){const u=s.items;if(u.type==="object")for(const o of Object.getOwnPropertyNames(h))o!=="length"&&d.complement(h[o],u)}var d;(function(h){h.validate=function(s,u,o){const m=new n.Validator;if(o!==void 0)for(const p of o)m.addSchema(p[0],p[1]);const _=m.validate(s,u);return(0,r.logIf)(!_.valid,r.LogLevel.Warning,`schema expected to be valid:
${_.toString()}`),_.valid},h.complement=function(s,u){if(s!==void 0)switch((0,r.assert)(u.hasOwnProperty("properties")&&u.type==="object"||u.hasOwnProperty("items")&&u.type==="array",`expected schema to have 'properties' or 'items', given ${u}`),u.type){case"object":c(s,u);break;case"array":f(s,u)}},h.compare=function s(u,o,m,_=""){const p=m!==void 0;if((0,r.assert)(!p||m.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),u===void 0&&o!==void 0||u!==void 0&&o===void 0)return p&&m.alter(_),!0;let b=!0,x=[typeof u,typeof o];const E=[u instanceof Array,o instanceof Array];if(!(E[0]&&E[1]||x[0]==="object"&&x[1]==="object"))return b=u===o,!b&&p&&m.alter(`${_}`),!b;const w=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(u),Object.getOwnPropertyNames(o))).values());for(const S of w){if(S==="length")continue;const R=[u[S],o[S]];x=[typeof R[0],typeof R[1]];const O=`${_}${_.length>0&&!E[0]?".":""}${E[0]?"":S}`;if(R[0]instanceof Array&&R[1]instanceof Array||x[0]==="object"&&x[1]==="object")b=b&&!s(R[0],R[1],m,O);else{if(x[0]===x[1]&&R[0]===R[1])continue;b=!1,p&&m.alter(O)}}return!b}})(d||(d={})),v.exports=d},3039:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSquareKernel=void 0;const n=i(9504),r=i(4287);class c extends r.KernelF32{constructor(d){super(2,d),this.generate()}generate(){(0,n.assert)(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let d=1;d<this.width;++d)this.set([(0,n.rand)(-.5,.5),(0,n.rand)(-.5,.5)],d)}get width(){return this._width}set width(d){this._width!==d&&(this._width=d,this.resize(),this.generate())}}t.RandomSquareKernel=c},8962:(v,t,i)=>{const n=i(3557),r=i(5150),c=i(9504);var f;(function(d){function h(m,_,p=1){const b=n.vec2.subtract((0,r.v2)(),_,m);if(n.vec2.equals(b,n.vec2.fromValues(0,0)))return;const x=n.vec2.squaredLength(b),E=2*n.vec2.dot(b,m),w=E*E-4*x*(n.vec2.squaredLength(m)-p*p);if(w<0)return;const S=Math.sqrt(w),R=Math.min((-E+S)/(2*x),(-E-S)/(2*x)),O=n.vec2.scale((0,r.v2)(),b,R);return n.vec2.add(O,O,m)}function s(m,_,p,b){const x=m,E=n.vec2.sub((0,r.v2)(),_,m),w=p,S=n.vec2.sub((0,r.v2)(),b,p),R=n.vec2.cross((0,r.v3)(),E,S)[2];if(R===0)return;const O=n.vec2.sub((0,r.v2)(),w,x),I=n.vec2.cross((0,r.v3)(),O,n.vec2.scale((0,r.v2)(),E,1/R))[2],D=n.vec2.cross((0,r.v3)(),O,n.vec2.scale((0,r.v2)(),S,1/R))[2];return I<0||I>1||D<0?void 0:[n.vec2.add((0,r.v2)(),w,n.vec2.scale((0,r.v2)(),S,I)),D]}function u(m,_,p=n.vec3.fromValues(0,0,0),b=n.vec3.fromValues(0,1,0)){const x=n.vec3.normalize((0,r.v3)(),n.vec3.subtract((0,r.v3)(),_,m)),E=n.vec3.dot(x,b);if(n.vec3.equals(x,[0,0,0])||E>=0)return;const w=n.vec3.dot(n.vec3.subtract((0,r.v3)(),p,m),b)/E;return n.vec3.add((0,r.v3)(),n.vec3.scale((0,r.v3)(),x,w),m)}function o(m,_,p){const b=n.vec3.subtract((0,r.v3)(),_,m),x=n.vec3.squaredLength(b);if(x===0)return 0;const E=n.vec3.subtract((0,r.v3)(),p,m);return n.vec3.dot(E,b)/x}d.rayCircleIntersection=h,d.pointSquareIntersection=function(m,_=1){const p=(0,r.abs2)((0,r.v2)(),m);return p[0]>=p[1]?n.vec2.fromValues((0,r.sign)(m[0])*_,m[1]/p[0]*_):n.vec2.fromValues(m[0]/p[1]*_,(0,r.sign)(m[1])*_)},d.raySquareIntersection=function(m,_,p=1){const b=[n.vec2.fromValues(-p,+p),n.vec2.fromValues(-p,-p),n.vec2.fromValues(+p,-p),n.vec2.fromValues(+p,+p)],x=new Array;for(let E=0;E<4;++E){const w=s(m,_,b[E],b[(E+1)%4]);w&&x.push(w[1])}return x},d.rayLineIntersection=s,d.rayPlaneIntersection=u,d.raySphereIntersection=function(m,_,p=n.vec3.fromValues(0,0,0),b=1){const x=n.vec3.subtract((0,r.v3)(),m,p),E=n.vec3.normalize((0,r.v3)(),n.vec3.subtract((0,r.v3)(),_,m)),w=n.vec3.dot(E,x),S=w*w-n.vec3.squaredLength(x)+b*b;if(!(S<=0))return n.vec3.add((0,r.v3)(),m,n.vec3.scale((0,r.v3)(),E,-w-Math.sqrt(S)))},d.rayPlaneIntersection_tube=function(m,_,p=1){const b=u(m,_);if(b!==void 0&&n.vec3.length(b)<p)return b;const x=h(n.vec2.fromValues(m[0],m[2]),n.vec2.fromValues(_[0],_[2]),p);return x?n.vec3.fromValues(x[0],0,x[1]):void 0},d.isPointWithinSquare=function(m,_=1){const p=(0,r.abs2)((0,r.v2)(),m);return p[0]<=_&&p[1]<=_},d.isPointWithinNDC=function(m,_){const p=n.vec3.transformMat4((0,r.v3)(),_,m),b=(0,r.abs3)((0,r.v3)(),p);return b[0]<=1&&b[1]<=1&&p[2]>=0&&p[2]<=1},d.distancePointToRay=o,d.eyeWithPointInView=function(m,_){const p=n.vec3.subtract((0,r.v3)(),m.center,m.eye),b=n.vec3.normalize((0,r.v3)(),p),x=n.vec3.normalize((0,r.v3)(),n.vec3.cross((0,r.v3)(),b,m.up)),E=n.vec3.normalize((0,r.v3)(),n.vec3.cross((0,r.v3)(),x,b)),w=o(m.eye,m.center,_),S=n.vec3.add((0,r.v3)(),m.eye,n.vec3.scale((0,r.v3)(),p,w)),R=n.vec3.subtract((0,r.v3)(),_,S),O=Math.abs(n.vec3.dot(R,x))/m.aspect,I=Math.abs(n.vec3.dot(R,E)),D=Math.max(O,I)/Math.tan(m.fovy*c.DEG2RAD*.5);return n.vec3.subtract((0,r.v3)(),S,n.vec3.scale((0,r.v3)(),b,D))}})(f||(f={})),v.exports=f},1900:function(v,t,i){var n=this&&this.__decorate||function(p,b,x,E){var w,S=arguments.length,R=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,b,x,E);else for(var O=p.length-1;O>=0;O--)(w=p[O])&&(R=(S<3?w(R):S>3?w(b,x,R):w(b,x))||R);return S>3&&R&&Object.defineProperty(b,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.ReadbackPass=void 0;const r=i(3557),c=i(9504),f=i(5150),d=i(8215),h=i(4127),s=i(1896),u=i(4168),o=i(771),m=i(8593);class _ extends h.Initializable{static maxClearDepth(){return(0,f.decode_float24x1_from_uint8x3)(r.vec3.fromValues(255,255,255))}constructor(b){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=b}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(b,x){return 65535*x+b}directReadDepthAt(b,x){(0,c.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),w=this._context.gl,S=E.size;this._depthFBO.bind();const R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&w.readBuffer(this._depthAttachment),w.readPixels(b*R[0],S[1]-x*R[1],1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(b,x){(0,c.assert)(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const E=this._depthFBO.texture(this._depthAttachment),w=this._context.gl,S=E.size,R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return w.viewport(0,0,1,1),this._program.bind(),w.uniform2f(this._uOffset,b*R[0]/S[0],(S[1]-x*R[1])/S[1]),w.uniform2f(this._uScale,1/S[0],1/S[1]),E.bind(w.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),E.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&w.readBuffer&&w.readBuffer(w.COLOR_ATTACHMENT0),w.readPixels(0,0,1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(b,x){const E=this._context.gl,w=this._context.gl2facade;if(x)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const S=new o.Shader(this._context,E.VERTEX_SHADER,"ndcvertices.vert (readback)");S.initialize(i(9657));const R=new o.Shader(this._context,E.FRAGMENT_SHADER,"readbackdepth.frag");return R.initialize(i(688)),this._program=new u.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([S,R],!1),b===void 0?this._ndcTriangle=new s.NdcFillingTriangle(this._context):(this._ndcTriangle=b,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),E.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new m.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,E.RGBA,E.RGBA,E.UNSIGNED_BYTE),this._framebuffer=new d.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[w.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(b,x){const E=this.hash(b,x);if(this._cache&&this._cachedDepths.has(E))return this._cachedDepths.get(E);const w=this.readDepthAt(b,x),S=w[0]===255&&w[1]===255&&w[2]===255?void 0:(0,f.decode_float24x1_from_uint8x3)(r.vec3.fromValues(w[0],w[1],w[2]));return this._cache&&this._cachedDepths.set(E,S),S}coordsAt(b,x,E,w){const S=this._depthFBO.texture(this._depthAttachment).size,R=E===void 0?this.depthAt(b,x):E;if(R===void 0)return;const O=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]],I=r.vec3.fromValues(b*O[0]*2/S[0]-1,1-x*O[1]*2/S[1],2*R-1);return r.vec3.transformMat4(r.vec3.create(),I,w)}idAt(b,x){const E=this.hash(b,x);if(this._cache&&this._cachedIDs.has(E))return this._cachedIDs.get(E);const w=this._context.gl,S=this._idFBO.texture(this._idAttachment).size,R=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&w.readBuffer(this._idAttachment),w.readPixels(b*R[0],S[1]-x*R[1],1,1,w.RGBA,w.UNSIGNED_BYTE,this._buffer);const O=(0,f.decode_uint32_from_rgba8)(r.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(E,O),O}frame(){this.onFrame()}set cache(b){this._cache=b}set depthFBO(b){this._depthFBO=b}set depthAttachment(b){this._depthAttachment=b}set idFBO(b){this._idFBO=b}set idAttachment(b){this._idAttachment=b}set coordinateReferenceSize(b){this._referenceSize=b}}t.ReadbackPass=_,n([h.Initializable.assert_initialized()],_.prototype,"directReadDepthAt",null),n([h.Initializable.assert_initialized()],_.prototype,"renderThenReadDepthAt",null),n([h.Initializable.initialize()],_.prototype,"initialize",null),n([h.Initializable.uninitialize()],_.prototype,"uninitialize",null),n([h.Initializable.assert_initialized()],_.prototype,"depthAt",null),n([h.Initializable.assert_initialized()],_.prototype,"coordsAt",null),n([h.Initializable.assert_initialized()],_.prototype,"idAt",null)},8400:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderbuffer=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(u,o,m,_=1){(0,r.assert)(u>0&&o>0,"renderbuffer object requires valid width and height greater than zero");const p=this.context.gl;this._object=p.createRenderbuffer(),this._width=u,this._height=o,this._internalFormat=m,this._samples=_,p.bindRenderbuffer(p.RENDERBUFFER,this._object),this._samples>1?p.renderbufferStorageMultisample(p.RENDERBUFFER,this._samples,m,u,o):p.renderbufferStorage(p.RENDERBUFFER,m,u,o),this._valid=p.isRenderbuffer(this._object),p.bindRenderbuffer(p.RENDERBUFFER,h.DEFAULT_RENDER_BUFFER);const b=u*o*(0,c.byteSizeOfFormat)(this.context,m);return this.context.allocationRegister.reallocate(this._identifier,b),this._object}delete(){(0,r.assert)(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,h.DEFAULT_RENDER_BUFFER)}resize(u,o,m=!1,_=!1){if(u===this._width&&o===this._height)return;this._width=u,this._height=o;const p=this.context.gl;m&&this.bind(),this._samples>1?p.renderbufferStorageMultisample(p.RENDERBUFFER,this._samples,this._internalFormat,u,o):p.renderbufferStorage(p.RENDERBUFFER,this._internalFormat,u,o),_&&this.unbind();const b=u*o*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,b)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}t.Renderbuffer=h,h.DEFAULT_RENDER_BUFFER=void 0,n([f.Initializable.assert_initialized()],h.prototype,"bind",null),n([f.Initializable.assert_initialized()],h.prototype,"unbind",null),n([f.Initializable.assert_initialized()],h.prototype,"resize",null)},3105:function(v,t,i){var n=this&&this.__decorate||function(p,b,x,E){var w,S=arguments.length,R=S<3?b:E===null?E=Object.getOwnPropertyDescriptor(b,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,b,x,E);else for(var O=p.length-1;O>=0;O--)(w=p[O])&&(R=(S<3?w(R):S>3?w(b,x,R):w(b,x))||R);return S>3&&R&&Object.defineProperty(b,x,R),R};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.LoadingStatus=void 0;const r=i(7032),c=i(3557),f=i(9504),d=i(5150),h=i(7564),s=i(4127),u=i(2813),o=i(9217);var m;(function(p){p[p.Started=0]="Started",p[p.Finished=1]="Finished"})(m||(t.LoadingStatus=m={}));class _ extends s.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new h.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=o.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new r.ReplaySubject(1)}invalidate(b=!1){this._invalidate(b)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(m.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(m.Finished)}initialize(b,x,E){return(0,f.assert)(b!==void 0,"valid webgl context required"),this._context=b,(0,f.assert)(x!==void 0,"valid multi-frame update callback required"),this._invalidate=x,this._isLoading=!0,this._loadingStatusSubscription=new r.ReplaySubject,this.onInitialize(b,x,E)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(b){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==b&&(this._multiFrameNumber=b,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(b){this.onFrame(b)}swap(){this.onSwap()}frameCoords(b,x){const E=c.vec2.divide((0,d.v2)(),this._frameSize,this.canvasSize);return c.vec2.floor(E,c.vec2.multiply(E,[b+.5,x+.5],E)),c.vec2.add(E,E,[.5,.5]),(0,u.tuple2)(E)}set frameSize(b){this.assertInitialized(),c.vec2.equals(this._frameSize,b)||(Object.assign(this._frameSize,b),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(b){this.assertInitialized(),this._framePrecision!==b&&(this._framePrecision=b,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(b){this.assertInitialized(),c.vec4.equals(this._clearColor,b)||(Object.assign(this._clearColor,b),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(b){this.assertInitialized(),this._debugTexture!==b&&((0,f.logIf)(b>=this._debugTextures.length,f.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${b} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=b<this._debugTextures.length?(0,d.clamp)(b,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}t.Renderer=_,n([s.Initializable.assert_initialized()],_.prototype,"invalidate",null),n([s.Initializable.initialize()],_.prototype,"initialize",null),n([s.Initializable.uninitialize()],_.prototype,"uninitialize",null),n([s.Initializable.discard()],_.prototype,"discard",null),n([s.Initializable.assert_initialized()],_.prototype,"update",null),n([s.Initializable.assert_initialized()],_.prototype,"prepare",null),n([s.Initializable.assert_initialized()],_.prototype,"frame",null),n([s.Initializable.assert_initialized()],_.prototype,"swap",null)},9137:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resizable=void 0;const n=i(9504);class r{static resize(){(0,n.assert)(r.instances.length>0,"resize event received without a single resizable registered"),r.instances.forEach(f=>f.onResize())}static elementSize(f){if(f===void 0||window===void 0||typeof window.devicePixelRatio!="number")return[0,0];const d=window.devicePixelRatio,h=getComputedStyle(f);if(h.width===null||!h.width.endsWith("px")||h.height===null||!h.height.endsWith("px"))return void(0,n.log)(n.LogLevel.Debug,`computed element size expected in 'px', given ${h.width} ${h.height}`);const s=[parseFloat(h.width),parseFloat(h.height)];return[Math.round(s[0]*d),Math.round(s[1]*d)]}constructor(){if(this._resizeEventListener=()=>r.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),r.resize()},r.instances.length===0){const f=`on${r.EVENT_IDENTIFIER}`;r.eventSupported=document&&(f in document.documentElement||f in document.body),(0,n.logIf)(!r.eventSupported,n.LogLevel.Warning,"resize event not supported")}r.instances.length===0&&r.eventSupported&&window.addEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),r.instances.push(this)}observe(f){f!==void 0&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(f,r.MUTATION_OBSERVER_CONFIG)}dispose(){const f=r.instances.indexOf(this);(0,n.assert)(f!==-1,"invalid reference counting of resizable instances"),r.instances.splice(f,1),r.instances.length===0&&r.eventSupported&&window.removeEventListener(r.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}t.Resizable=r,r.EVENT_IDENTIFIER="resize",r.instances=[],r.eventSupported=!1,r.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},6197:function(v,t,i){var n=this&&this.__decorate||function(u,o,m,_){var p,b=arguments.length,x=b<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,m):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(u,o,m,_);else for(var E=u.length-1;E>=0;E--)(p=u[E])&&(x=(b<3?p(x):b>3?p(o,m,x):p(o,m))||x);return b>3&&x&&Object.defineProperty(o,m,x),x};Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardSceneRenderPass=void 0;const r=i(3557),c=i(9504),f=i(7564),d=i(4127),h=i(5138);class s extends h.SceneRenderPass{constructor(o){super(),this._altered=Object.assign(new f.ChangeLookup,{any:!1,camera:!1}),this._context=o,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){(0,c.assert)(this._scene!==void 0,"Scene was undefined during preprocessing."),this._scene!==void 0&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,r.mat4.create()))}preprocessNode(o,m){const _=r.mat4.clone(m),p=o.componentsOfType("TransformComponent");if((0,c.assert)(p.length<=1,"SceneNode can not have more than one transform component"),p.length===1){const x=p[0];r.mat4.mul(_,_,x.transform)}const b=o.componentsOfType("GeometryComponent");for(const x of b){const E=x,w=E.material,S=E.geometry;if(w.isTransparent){let R=this._transparentGeometryMap.get(w);R===void 0&&(R=[]),R.push([S,_]),this._transparentGeometryMap.set(w,R)}else{let R=this._opaqueGeometryMap.get(w);R===void 0&&(R=[]),R.push([S,_]),this._opaqueGeometryMap.set(w,R)}}if(o.nodes!==void 0)for(const x of o.nodes)this.preprocessNode(x,_)}renderGeometryMap(o){for(const m of Array.from(o.keys())){this.bindMaterial(m);const _=o.get(m);for(const[p,b]of _)p.bind(),this.bindGeometry!==void 0&&this.bindGeometry(p),this.updateModelTransform(b),p.draw(),p.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(o=!1){}frame(){if((0,c.assert)(this._target&&this._target.valid,"valid target expected"),(0,c.assert)(this._program&&this._program.valid,"valid program expected"),(0,c.assert)(this.updateModelTransform!==void 0,"Model transform function needs to be initialized."),(0,c.assert)(this.updateViewProjectionTransform!==void 0,"View Projection transform function needs to be initialized."),(0,c.assert)(this.bindMaterial!==void 0,"Material binding function needs to be initialized."),this._scene===void 0)return;const o=this._context.gl;o.enable(o.DEPTH_TEST);const m=this._target.size;o.viewport(0,0,m[0],m[1]),this._program.bind(),this.bindUniforms!==void 0&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),o.disable(o.BLEND)}drawCalls(o=!0){this._scene!==void 0&&(this.renderGeometryMap(this._opaqueGeometryMap),o&&this.renderGeometryMap(this._transparentGeometryMap))}set target(o){this.assertInitialized(),this._target=o}set ndcOffset(o){this.assertInitialized(),this._ndcOffset=o}set camera(o){this.assertInitialized(),this._camera!==o&&(this._camera=o,this._altered.alter("camera"))}set clearColor(o){this._clearColor=o}set program(o){this._program=o}}t.ForwardSceneRenderPass=s,n([d.Initializable.initialize()],s.prototype,"initialize",null),n([d.Initializable.uninitialize()],s.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],s.prototype,"update",null),n([d.Initializable.assert_initialized()],s.prototype,"frame",null),n([d.Initializable.assert_initialized()],s.prototype,"drawCalls",null)},2384:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryComponent=void 0;const n=i(6344);class r extends n.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(f){this._geometry=f}get geometry(){return this._geometry}set material(f){this._material=f}get material(){return this._material}}t.GeometryComponent=r},5315:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=t.Material=t.GeometryComponent=t.TransformComponent=t.SceneNodeComponent=t.SceneNode=t.ForwardSceneRenderPass=void 0;var n=i(6197);Object.defineProperty(t,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return n.ForwardSceneRenderPass}});var r=i(651);Object.defineProperty(t,"SceneNode",{enumerable:!0,get:function(){return r.SceneNode}});var c=i(6344);Object.defineProperty(t,"SceneNodeComponent",{enumerable:!0,get:function(){return c.SceneNodeComponent}});var f=i(6244);Object.defineProperty(t,"TransformComponent",{enumerable:!0,get:function(){return f.TransformComponent}});var d=i(2384);Object.defineProperty(t,"GeometryComponent",{enumerable:!0,get:function(){return d.GeometryComponent}});var h=i(7874);Object.defineProperty(t,"Material",{enumerable:!0,get:function(){return h.Material}});var s=i(5138);Object.defineProperty(t,"SceneRenderPass",{enumerable:!0,get:function(){return s.SceneRenderPass}})},7874:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0,t.Material=class{constructor(i,n){this._context=i,this._name=n,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(i){this._isTransparent=i}}},651:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=void 0,t.SceneNode=class{constructor(i){this._nodes=new Array,this._components=new Array,this._name=i,this._parent=void 0}traverse(i){i(this);for(const n of this._nodes)n.traverse(i)}addNode(i){return i._parent=this,this._nodes.push(i),i}addComponent(i){return this._components.push(i),i}componentsOfType(i){return this._components.filter(n=>i===n.type)}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return this._nodes.length===0}get isRoot(){return this._parent===void 0}}},6344:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNodeComponent=void 0,t.SceneNodeComponent=class{constructor(i){this._type=i}get type(){return this._type}}},5138:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=void 0;const n=i(4127);class r extends n.Initializable{set scene(f){this._scene=f,this._scene!==void 0&&this.preprocessScene()}get scene(){return this._scene}}t.SceneRenderPass=r},6244:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformComponent=void 0;const n=i(6344);class r extends n.SceneNodeComponent{constructor(f){super("TransformComponent"),this._transform=f}get transform(){return this._transform}}t.TransformComponent=r},771:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;const n=i(9504),r=i(9965);class c extends r.AbstractObject{constructor(d,h,s){super(d,s),this._compiled=!1;const u=d.gl;if(s===void 0)switch(h){case d.gl.FRAGMENT_SHADER:s="FragmentShader";break;case d.gl.VERTEX_SHADER:s="VertexShader";break;default:(0,n.assert)(!1,`expected either a FRAGMENT_SHADER (${u.FRAGMENT_SHADER}) or a VERTEX_SHADER (${u.VERTEX_SHADER}), given ${h}`)}this._type=h}create(d,h=!0){const s=this._context.gl;return this._object=s.createShader(this._type),this._valid=s.isShader(this._object),this._compiled=!1,(0,n.assert)(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),d&&(this.source=d),d&&h&&this.compile(),this._object}delete(){(0,n.assert)(this._object!==void 0,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const d=this._context.gl;let h=this.sourceWithReplacements;if(this._context.isWebGL2&&(h=`#version 300 es
${h}`),d.shaderSource(this._object,h),d.compileShader(this._object),this._compiled=d.getShaderParameter(this._object,d.COMPILE_STATUS),!this._compiled){const s=d.getShaderInfoLog(this._object);(0,n.log)(n.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${s}`)}}replace(d,h){this._replacements===void 0&&(this._replacements=new Map),this._replacements.set(d,h)}get type(){return this.assertInitialized(),this._type}set source(d){this._source!==d&&(this._source=d)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(this._replacements===void 0)return this._source;let d=this._source;return this._replacements.forEach((h,s)=>{const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");d=d.replace(new RegExp(u,"g"),h)}),d}get compiled(){return this.assertInitialized(),this._compiled}}t.Shader=c},9011:function(v,t,i){var n=this&&this.__decorate||function(m,_,p,b){var x,E=arguments.length,w=E<3?_:b===null?b=Object.getOwnPropertyDescriptor(_,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,_,p,b);else for(var S=m.length-1;S>=0;S--)(x=m[S])&&(w=(E<3?x(w):E>3?x(_,p,w):x(_,p))||w);return E>3&&w&&Object.defineProperty(_,p,w),w};Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowPass=void 0;const r=i(9504),c=i(8215),f=i(3395),d=i(4127),h=i(8400),s=i(8593),u=i(9217);class o extends d.Initializable{constructor(_){super(),this._gaussFilterKernelSize=21,this._context=_}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==o.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(_){_!==this._gaussFilterKernelSize&&(this._gaussFilter!==void 0&&(this._gaussFilter.kernelSize=_,this._gaussFilter.standardDeviation=_/6),this._gaussFilterKernelSize=_)}resize(_,p=!0,b=!0){(0,r.assert)(_[0]>0&&_[1]>0,"Size has to be > 0."),this._shadowMapSize=_,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],p,b)}resizeBlurTexture(_,p=!0,b=!0){(0,r.assert)(_[0]>0&&_[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=_,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],p,b),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],p,b)}initialize(_,p,b){(0,r.assert)(p[0]>0&&p[1]>0,"Size has to be > 0."),this._shadowType=_,this._shadowMapSize=p,this._blurredShadowMapSize=b!==void 0?b:this._shadowMapSize;const x=this._context.gl,E=this._context.gl2facade;let w=x.RGBA;if(this._context.isWebGL2){const I=this._context.gl;switch(this._shadowType){case o.ShadowMappingType.HardLinear:case o.ShadowMappingType.HardExponential:w=I.RED;break;case o.ShadowMappingType.SoftLinear:w=I.RG;break;case o.ShadowMappingType.SoftExponential:w=I.RGBA;break;default:(0,r.assert)(!1,"Unexpected value for shadowType")}}const[S,R]=u.Wizard.queryInternalTextureFormat(this._context,w,u.Wizard.Precision.float);this._shadowType!==o.ShadowMappingType.HardLinear&&R!==x.FLOAT&&((0,r.log)(r.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=o.ShadowMappingType.HardLinear);let O=x.LINEAR;return R!==x.FLOAT||this._context.supportsTextureFloatLinear||(O=x.NEAREST),R!==E.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(O=x.NEAREST),this._shadowMapTexture=new s.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],S,w,x.FLOAT),this._shadowMapTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._shadowMapTexture.filter(O,O),this._shadowMapRenderbuffer=new h.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],x.DEPTH_COMPONENT16),this._shadowMapFBO=new c.Framebuffer(this._context),this._shadowMapFBO.initialize([[E.COLOR_ATTACHMENT0,this._shadowMapTexture],[x.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new f.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new s.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,w,x.FLOAT),this._intermediateBlurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(O,O),this._intermediateBlurFBO=new c.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[E.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new s.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,w,x.FLOAT),this._blurTexture.wrap(x.CLAMP_TO_EDGE,x.CLAMP_TO_EDGE),this._blurTexture.filter(O,O),this._blurFBO=new c.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[E.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(_){const p=this._context.gl;p.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),p.enable(p.DEPTH_TEST),p.depthFunc(p.LEQUAL),this._shadowMapFBO.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT,!0,!1),_(),p.disable(p.DEPTH_TEST),p.depthFunc(p.LESS),this.hasBlur&&(p.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,f.GaussFilter.Direction.Horizontal),p.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,f.GaussFilter.Direction.Vertical))}}t.ShadowPass=o,n([d.Initializable.assert_initialized()],o.prototype,"resize",null),n([d.Initializable.assert_initialized()],o.prototype,"resizeBlurTexture",null),n([d.Initializable.initialize()],o.prototype,"initialize",null),n([d.Initializable.uninitialize()],o.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],o.prototype,"frame",null),function(m){(function(_){_[_.HardLinear=0]="HardLinear",_[_.SoftLinear=1]="SoftLinear",_[_.HardExponential=2]="HardExponential",_[_.SoftExponential=3]="SoftExponential"})(m.ShadowMappingType||(m.ShadowMappingType={}))}(o||(t.ShadowPass=o={}))},8296:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFace=void 0;const n=i(9504),r=i(8593),c=i(9217),f=i(64),d=i(1575),h=i(2668);class s{static fromFile(o,m,_=!1,p){return(0,f.fetchAsync)(o,"text").then(b=>{const x=new s(m,p);return d.FontFaceLoader.process(x,b,o,void 0,_).then(E=>E).catch(E=>Promise.reject(`processing font face data failed: ${E}`))})}static fromFiles(o,m,_,p=!1,b){return(0,f.fetchAsync)(o,"text").then(x=>{const E=new s(_,b);return d.FontFaceLoader.process(E,x,o,m,p).then(w=>w).catch(w=>Promise.reject(`processing font face data failed: ${w}`))})}constructor(o,m){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=o;const _=o.gl;m=m!==void 0&&m!==""?m:this.constructor.name,this._glyphTexture=new r.Texture2D(o,`${m}GlyphAtlas`);const p=c.Wizard.queryInternalTextureFormat(o,_.RGBA,c.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,p[0],_.RGBA,p[1]),this._glyphTexture.filter(_.LINEAR,_.LINEAR)}hasGlyph(o){return!!this._glyphs.get(o)}glyph(o){const m=this._glyphs.get(o);if(m)return m;const _=new h.Glyph;return _.index=o,_}addGlyph(o){(0,n.assert)(!this._glyphs.get(o.index),"expected glyph to not already exist"),this._glyphs.set(o.index,o)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(o){return this.glyph(o).depictable()}kerning(o,m){const _=this._glyphs.get(o);return _?_.kerning(m):0}setKerning(o,m,_){const p=this._glyphs.get(o);p&&this.hasGlyph(m)?p.setKerning(m,_):(0,n.assert)(!1,`expected glyph or glyph of subsequent index to exist,                 given ${o} and ${m} respectively`)}set size(o){(0,n.assert)(o>0,`expected size to be greater than 0.0, given ${o}`),this._size=o}get size(){return this._size}set base(o){(0,n.assert)(o>0,`expected base to be greater than 0.0, given ${o}`),this._base=o}get base(){return this._base}set ascent(o){(0,n.assert)(o>0,`expected ascent to be greater than 0.0, given ${o}`),this._ascent=o}get ascent(){return this._ascent}set descent(o){this._descent=o}get descent(){return this._descent}set lineGap(o){this._lineGap=o}get lineGap(){return this._lineGap}set lineHeight(o){(0,n.assert)(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=o-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(o){this._lineGap=this.size*(o-1)}get lineSpace(){return this.lineHeight===0?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(o){(0,n.assert)(o[0]>0,`expected extent.x to be greater than 0.0, given ${o[0]}`),(0,n.assert)(o[1]>0,`expected extent.y to be greater than 0.0, given ${o[1]}`),this._glyphTextureExtent=o}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(o){(0,n.assert)(o[0]>=0,`expected padding[0] to be greater than 0.0, given ${o[0]}`),(0,n.assert)(o[1]>=0,`expected padding[1] to be greater than 0.0, given ${o[1]}`),(0,n.assert)(o[2]>=0,`expected padding[2] to be greater than 0.0, given ${o[2]}`),(0,n.assert)(o[3]>=0,`expected padding[3] to be greater than 0.0, given ${o[3]}`),this._glyphTexturePadding=o}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(o){this._glyphTexture=o}get glyphTexture(){return this._glyphTexture}}t.FontFace=s},1575:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontFaceLoader=void 0;const n=i(9504),r=i(2668);class c{static processInfo(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["size","padding"],s))return!1;h.size=parseFloat(s.get("size"));const u=s.get("padding").split(",");if(u.length!==4)return(0,n.log)(n.LogLevel.Warning,`expected 4 values for padding, given ${u} (${u.length})`),!1;const o=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])];return h.glyphTexturePadding=o,!0}static processCommon(d,h){const s=new Map;return!!this.readKeyValuePairs(d,["lineHeight","base","scaleW","scaleH"],s)&&(h.base=parseFloat(s.get("base")),s.has("ascent")&&(h.ascent=parseFloat(s.get("ascent"))),s.has("descent")&&(h.descent=parseFloat(s.get("descent"))),h.lineHeight=parseFloat(s.get("lineHeight")),h.glyphTextureExtent=[parseFloat(s.get("scaleW")),parseFloat(s.get("scaleH"))],!0)}static processPage(d,h,s){const u=new Map;if(!this.readKeyValuePairs(d,["file"],u))return;const o=(0,n.dirname)(s);let m=u.get("file");return m=m.replace(/['"]+/g,""),h.glyphTexture.fetch(`${o}/${m}`,!0,!0).catch(()=>Promise.reject(`page '${m}' referenced in font file '${s}' was not found`))}static processPages(d,h){(0,n.logIf)(h.size!==1,n.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),(0,n.assert)(h.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const s=h.get(0);if(s)return d.glyphTexture.fetch(`${s}`,!0,!0).catch(()=>Promise.reject(`fetching page '0' from '${s}' failed`))}static processChar(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["id","x","y","width","height","xoffset","yoffset","xadvance"],s))return!1;const u=parseInt(s.get("id"),10);(0,n.logIf)(u<=0,n.LogLevel.Warning,`expected glyph index to be greater than 0, given ${u}`);const o=new r.Glyph;o.index=u;const m=[1/h.glyphTextureExtent[0],1/h.glyphTextureExtent[1]],_=[parseFloat(s.get("width")),parseFloat(s.get("height"))];return o.subTextureOrigin=[parseFloat(s.get("x"))*m[0],1-(parseFloat(s.get("y"))+_[1])*m[1]],o.extent=_,o.subTextureExtent[0]=_[0]*m[0],o.subTextureExtent[1]=_[1]*m[1],o.bearingFromFontBaseAndOffset(h.base,parseFloat(s.get("xoffset")),parseFloat(s.get("yoffset"))),o.advance=parseFloat(s.get("xadvance")),h.addGlyph(o),!0}static processKerning(d,h){const s=new Map;if(!this.readKeyValuePairs(d,["first","second","amount"],s))return!1;const u=parseInt(s.get("first"),10);if(u<=0)return(0,n.log)(n.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${u}`),!1;const o=parseInt(s.get("second"),10);if(o<=0)return(0,n.log)(n.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${o}`),!1;const m=parseFloat(s.get("amount"));return h.setKerning(u,o,m),!0}static readKeyValuePairs(d,h,s){let u,o;for(const _ of d){const p=_.split("=");u=p[0],o=p[1],s.set(u,o)}let m=!0;return h.forEach(_=>m=m&&s.has(_)),m||(0,n.log)(n.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${h}`),m}static findAscentAndDescentIfNoneProvided(d,h){if(d.ascent>0&&d.descent<0)return;d.ascent>0&&(d.descent=d.ascent-h),d.descent<0&&(d.ascent=d.descent-h);let s=Number.MIN_VALUE;for(const u of d.arrayOfGlyphIndices())d.glyph(u).extent[1]!==0&&(s=Math.max(d.glyph(u).bearing[1],s));d.ascent=s,d.descent=d.ascent-h,(0,n.log)(n.LogLevel.Debug,`ascent not specified, derived ${d.ascent} from maximum y-offset`)}static process(d,h,s,u,o=!1){const m=h.split(`
`),_=new Array;let p=!0;if(!o&&u){const b=this.processPages(d,u);b!==void 0&&_.push(b)}for(const b of m){let x=b.split(" ");const E=x[0];switch(x=x.slice(1),E){case"info":p=this.processInfo(x,d);break;case"common":p=this.processCommon(x,d);break;case"page":if(o||u)break;const w=this.processPage(x,d,s);w!==void 0&&_.push(w);break;case"char":p=this.processChar(x,d);break;case"kerning":this.processKerning(x,d)}if(p===!1)break}return c.findAscentAndDescentIfNoneProvided(d,d.size),d.size<=0&&(0,n.log)(n.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${d.size}`),Promise.all(_).then(()=>d)}}t.FontFaceLoader=c},2668:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Glyph=void 0;const n=i(2813);t.Glyph=class{constructor(r=0,c=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=r,this._advance=c}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(r){const c=this._kernings.get(r);return c!==void 0?c:0}setKerning(r,c){this._kernings.set(r,c)}set index(r){this._index=r}get index(){return this._index}set subTextureOrigin(r){this._subTextureOrigin=(0,n.clampf2)(r,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(r){this._subTextureExtent=(0,n.clampf2)(r,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(r){this._bearing=r}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(r,c,f){this._bearing[0]=c,this._bearing[1]=r-f}set extent(r){this._extent=r}get extent(){return this._extent}set advance(r){this._advance=r}get advance(){return this._advance}}},9495:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphVertices=void 0;class i{static concat(r){let c=0;r.forEach(h=>c+=h?h.length:0);const f=new i(c);let d=0;for(let h=0;h<r.length;++h){const s=r[h];s!==void 0&&s.length!==0&&(f._texCoords.set(s._texCoords,d*i.FLOATS_PER_TEXCOORD),f._origins.set(s._origins,d*i.FLOATS_PER_ORIGIN),f._tangents.set(s._tangents,d*i.FLOATS_PER_TANGENT),f._ups.set(s._ups,d*i.FLOATS_PER_UP),d+=s.length)}return f}constructor(r){const c=Math.max(0,r);this._texCoords=new Float32Array(c*i.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(c*i.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(c*i.FLOATS_PER_TANGENT),this._ups=new Float32Array(c*i.FLOATS_PER_UP)}shrink(r){const c=Math.max(0,r);if(this.length===c)return;const f=(d,h,s)=>new Float32Array(d.buffer.slice(0,h*d.BYTES_PER_ELEMENT*s),0,h*s);f(this._texCoords,c,i.FLOATS_PER_TEXCOORD),f(this._origins,c,i.FLOATS_PER_ORIGIN),f(this._ups,c,i.FLOATS_PER_TANGENT),f(this._tangents,c,i.FLOATS_PER_UP)}uvLowerLeft(r){const c=r*i.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(c,c+2)}uvUpperRight(r){const c=r*i.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(c,c+2)}origin(r){const c=r*i.FLOATS_PER_ORIGIN;return this._origins.subarray(c,c+i.FLOATS_PER_ORIGIN)}tangent(r){const c=r*i.FLOATS_PER_TANGENT;return this._tangents.subarray(c,c+i.FLOATS_PER_TANGENT)}up(r){const c=r*i.FLOATS_PER_UP;return this._ups.subarray(c,c+i.FLOATS_PER_UP)}get length(){return this._origins.length/i.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}t.GlyphVertices=i,i.FLOATS_PER_TEXCOORD=4,i.FLOATS_PER_ORIGIN=3,i.FLOATS_PER_TANGENT=3,i.FLOATS_PER_UP=3},1058:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=t.Text=t.Projected3DLabel=t.Position3DLabel=t.Position2DLabel=t.LabelRenderPass=t.LabelGeometry=t.Label=t.GlyphVertices=t.FontFace=void 0;var n=i(8296);Object.defineProperty(t,"FontFace",{enumerable:!0,get:function(){return n.FontFace}});var r=i(9495);Object.defineProperty(t,"GlyphVertices",{enumerable:!0,get:function(){return r.GlyphVertices}});var c=i(7188);Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return c.Label}});var f=i(4128);Object.defineProperty(t,"LabelGeometry",{enumerable:!0,get:function(){return f.LabelGeometry}});var d=i(265);Object.defineProperty(t,"LabelRenderPass",{enumerable:!0,get:function(){return d.LabelRenderPass}});var h=i(5035);Object.defineProperty(t,"Position2DLabel",{enumerable:!0,get:function(){return h.Position2DLabel}});var s=i(5036);Object.defineProperty(t,"Position3DLabel",{enumerable:!0,get:function(){return s.Position3DLabel}});var u=i(135);Object.defineProperty(t,"Projected3DLabel",{enumerable:!0,get:function(){return u.Projected3DLabel}});var o=i(7623);Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return o.Text}});var m=i(967);Object.defineProperty(t,"Typesetter",{enumerable:!0,get:function(){return m.Typesetter}})},7188:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;const n=i(3557),r=i(7564),c=i(3847),f=i(9495),d=i(7623);class h{static devicePixelRatio(){return window===void 0||typeof window.devicePixelRatio!="number"?1:window.devicePixelRatio}constructor(u,o,m){this._alignment=h.Alignment.Left,this._lineAnchor=h.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=h.Unit.World,this._color=new c.Color(h.DEFAULT_COLOR),this._altered=Object.assign(new r.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=h.Elide.None,this._ellipsis=h.DEFAULT_ELLIPSIS,this._text=u,this._type=o,this._staticTransform=n.mat4.create(),this._dynamicTransform=n.mat4.create(),this._extent=[0,0],m&&(this._fontFace=m)}vertices(){return new f.GlyphVertices(this.length+this.ellipsis.length)}charAt(u){return this._text.charAt(u)}charCodeAt(u){return this._text.charCodeAt(u)}lineFeedAt(u){return this.charAt(u)===this.lineFeed}kerningBefore(u){return u<1||u>this.length?NaN:this._fontFace.kerning(this.charCodeAt(u-1),this.charCodeAt(u))}kerningAfter(u){return u<0||u>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(u),this.charCodeAt(u+1))}advance(u){return u<0||u>this.length?NaN:this._fontFace.glyph(this.charCodeAt(u)).advance}toString(){return this._text instanceof d.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(u){this._altered.alter("text"),this._text=u}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof d.Text?this._text.lineFeed:d.Text.DEFAULT_LINE_FEED}set wrap(u){this._wrap=u}get wrap(){return this._wrap}set elide(u){this._elide=u}get elide(){return this._elide}set ellipsis(u){this._ellipsis!==u&&(this._ellipsis=u,this._elide!==h.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(u){this._lineWidth!==u&&(this._lineWidth=u,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(u){this._alignment!==u&&(this._alignment=u,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(u){this._lineAnchor!==u&&(this._lineAnchor=u,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(u){this._fontSize!==u&&(this._fontSize=u,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(u){this._fontSizeUnit!==u&&(this._fontSizeUnit=u,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(u){this._fontFace!==u&&(this._fontFace=u,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(u){this._color.equals(u)||(this._color=u,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(u){this._backgroundColor.equals(u)||(this._backgroundColor=u,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(u){n.mat4.equals(this._staticTransform,u)||(this._staticTransform=u,this._altered.alter("static"))}get staticTransform(){const u=this.fontSize/this._fontFace.size,o=n.mat4.create();return n.mat4.scale(o,this._staticTransform,n.vec3.fromValues(u,u,u)),o}set dynamicTransform(u){this._altered.alter("dynamic"),this._dynamicTransform=u}get dynamicTransform(){return this._dynamicTransform}set extent(u){this._extent=u}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return this._fontFace!==void 0&&this._fontFace.glyphTexture.valid&&this._text.length>0}}t.Label=h,h.DEFAULT_COLOR=[.1098,.4588,.7373,1],h.DEFAULT_ELLIPSIS="...",function(s){(function(u){u.Static="static",u.Dynamic="dynamic"})(s.Type||(s.Type={})),function(u){u.None="none",u.Left="left",u.Middle="middle",u.Right="right"}(s.Elide||(s.Elide={})),function(u){u.Left="left",u.Center="center",u.Right="right"}(s.Alignment||(s.Alignment={})),function(u){u.Top="top",u.Ascent="ascent",u.Center="center",u.Baseline="baseline",u.Descent="descent",u.Bottom="bottom"}(s.LineAnchor||(s.LineAnchor={})),function(u){u.World="world",u.Pixel="pixel",u.Mixed="mixed"}(s.Unit||(s.Unit={}))}(h||(t.Label=h={}))},4128:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelGeometry=void 0;const r=i(9504),c=i(7340),f=i(638),d=i(4127);class h extends f.Geometry{constructor(u,o){super(u,o),this._numberOfGlyphs=0,(0,r.assert)(u.isWebGL2||u.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),o=o!==void 0&&o!==""?o:this.constructor.name,this._vertices=new c.Buffer(u,`${o}VBO`),this._buffers.push(this._vertices),this._texCoords=new c.Buffer(u,`${o}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new c.Buffer(u,`${o}OriginVBO`),this._buffers.push(this._origins),this._tangents=new c.Buffer(u,`${o}TangentVBO`),this._buffers.push(this._tangents),this._ups=new c.Buffer(u,`${o}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const u=this.context.gl,o=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,u.FLOAT,!1,8,0,!0,!1),o.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,u.FLOAT,!1,16,0,!0,!1),o.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,u.FLOAT,!1,12,0,!0,!1),o.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,u.FLOAT,!1,12,0,!0,!1),o.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,u.FLOAT,!1,12,0,!0,!1),o.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(u=0,o=1,m=2,_=3,p=4){this._vertexLocation=u,this._texCoordLocation=o,this._originLocation=m,this._tangentLocation=_,this._upLocation=p;const b=this.context.gl,x=super.initialize([b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER,b.ARRAY_BUFFER]);return this._vertices.data(h.VERTICES,b.STATIC_DRAW),x}update(u,o,m,_){this._numberOfGlyphs=u.length/3;const p=this.context.gl;this._texCoords.data(_,p.STATIC_DRAW),this._origins.data(u,p.STATIC_DRAW),this._tangents.data(o,p.STATIC_DRAW),this._ups.data(m,p.STATIC_DRAW)}draw(u=0,o=0){const m=this.context.gl,_=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,m.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,m.FLOAT,!1,16,16*u,!0,!1),this._origins.attribEnable(this._originLocation,3,m.FLOAT,!1,12,12*u,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,m.FLOAT,!1,12,12*u,!0,!1),this._ups.attribEnable(this._upLocation,3,m.FLOAT,!1,12,12*u,!0,!1),_.drawArraysInstanced(m.TRIANGLE_STRIP,0,4,o)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const u=this._vertices&&this._vertices.valid,o=this._texCoords&&this._texCoords.valid,m=this._origins&&this._origins.valid,_=this._tangents&&this._tangents.valid,p=this._ups&&this._ups.valid;return this.initialized&&u&&o&&m&&_&&p}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}t.LabelGeometry=h,h.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),n([d.Initializable.assert_initialized()],h.prototype,"draw",null)},265:function(v,t,i){var n=this&&this.__decorate||function(w,S,R,O){var I,D=arguments.length,j=D<3?S:O===null?O=Object.getOwnPropertyDescriptor(S,R):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(w,S,R,O);else for(var k=w.length-1;k>=0;k--)(I=w[k])&&(j=(D<3?I(j):D>3?I(S,R,j):I(S,R))||j);return D>3&&j&&Object.defineProperty(S,R,j),j};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelRenderPass=void 0;const r=i(3557),c=i(9504),f=i(7564),d=i(4127),h=i(4168),s=i(771),u=i(8593),o=i(9495),m=i(7188),_=i(4128),p=i(5035),b=i(5036),x=i(135);class E extends d.Initializable{constructor(S){super(),this._altered=Object.assign(new f.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=E.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=S,this._depthFunc=S.gl.LESS,this._program=new h.Program(S,"LabelRenderProgram"),this._geometry=new _.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=E.DEFAULT_AA_STEP_SCALE}prepare(){const S=this._camera.viewport;for(let O=0;O<this._labels.length;++O){const I=this._labels[O];let D;const j=this._altered.labels&&this._verticesPerLabel[O]===void 0;I instanceof p.Position2DLabel?(I.frameSize=S,D=I.typeset(j)):I instanceof x.Projected3DLabel?(I.camera=this._camera,D=I.typeset(j)):I instanceof b.Position3DLabel&&(D=I.typeset(j)),D===void 0?D=this._verticesPerLabel[O]:this._verticesPerLabel[O]=D;const k=O>0?this._ranges[O-1][1]:0,G=k+(D===void 0?0:D.length);this._ranges[O]=[k,G]}const R=o.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(R.origins,R.tangents,R.ups,R.texCoords)}draw(){const S=this._context.gl,R=[0,0];let O,I;const D=r.mat4.create();for(let j=0;j<this._labels.length;++j){const k=this._labels[j];if(R[1]=this._ranges[j][1],R[0]===R[1]||j<this._labels.length-1&&!k.valid)continue;const G=j<this._labels.length-1?this._labels[j+1]:void 0,Z=G&&k.type===m.Label.Type.Static&&G.type===m.Label.Type.Static,K=G&&k.color.equals(G.color),Y=G&&k.fontFace===G.fontFace,re=G&&k.fontSizeUnit===G.fontSizeUnit;if(G&&(this._ranges[j+1][0]===this._ranges[j+1][1]||Z&&K&&Y&&re))continue;const Q=k.type===m.Label.Type.Dynamic;switch(S.uniform1i(this._uDynamic,Q),Q&&S.uniformMatrix4fv(this._uTransform,!1,k.dynamicTransform),O!==void 0&&O.equals(k.color)||(S.uniform4fv(this._uColor,k.color.rgbaF32),O=k.color),I!==k.fontFace&&(k.fontFace.glyphTexture.bind(S.TEXTURE0),I=k.fontFace),k.fontSizeUnit){case m.Label.Unit.Pixel:S.uniformMatrix4fv(this._uViewProjection,!1,D);break;case m.Label.Unit.World:case m.Label.Unit.Mixed:default:S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(R[0],R[1]-R[0]),R[0]=R[1]}}initialize(){const S=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const R=new s.Shader(this._context,S.VERTEX_SHADER,"glyph.vert");R.initialize(i(1616));const O=new s.Shader(this._context,S.FRAGMENT_SHADER,"glyph.frag");return O.initialize(i(5389)),this._program.initialize([R,O],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),S.uniform1i(this._program.uniform("u_glyphs"),0),S.uniform1f(this._uAAStepScale,this._aaStepScale),S.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(S=!1){const R=this._context.gl;this._program.bind(),(S||this._altered.camera||this._camera.altered)&&R.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(S||this._altered.aaStepScale)&&R.uniform1f(this._uAAStepScale,this._aaStepScale),(S||this._altered.aaSampling)&&R.uniform1i(this._uAASampling,this._aaSampling);let O=S||this._altered.labels||this._altered.camera||this._camera.altered,I=0;for(;O===!1&&I<this._labels.length;)O=this._labels[I].altered,++I;O&&this.prepare(),this._altered.reset()}frame(){if(this._geometry.numGlyphs===0||this._labels.length===0)return;(0,c.assert)(this._target&&this._target.valid,"valid target expected");const S=this._context.gl,R=this._target.size;S.viewport(0,0,R[0],R[1]),S.enable(S.DEPTH_TEST),S.depthFunc(this._depthFunc),this._depthMask===!1&&S.depthMask(this._depthMask),S.enable(S.BLEND),S.blendFuncSeparate(S.SRC_ALPHA,S.ONE_MINUS_SRC_ALPHA,S.ONE,S.ONE_MINUS_SRC_ALPHA),this._program.bind(),S.uniform2fv(this._uNdcOffset,this._ndcOffset),S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),S.bindTexture(S.TEXTURE_2D,u.Texture2D.DEFAULT_TEXTURE),this._depthMask===!1&&S.depthMask(!0),S.depthFunc(S.LESS),S.disable(S.DEPTH_TEST),S.disable(S.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(S){this.assertInitialized(),this._target=S}set ndcOffset(S){this.assertInitialized(),this._ndcOffset=S}set camera(S){this.assertInitialized(),this._camera!==S&&(this._camera=S,this._altered.alter("camera"))}set depthMask(S){this._depthMask=S}get depthMask(){return this._depthMask}set depthFunc(S){this._depthFunc=S}get depthFunc(){return this._depthFunc}set labels(S){this._labels=S,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(S){this._aaStepScale!==S&&(this._aaStepScale=S,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(S){this._aaSampling!==S&&(this._aaSampling=S,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}t.LabelRenderPass=E,E.DEFAULT_AA_STEP_SCALE=.6666,n([d.Initializable.initialize()],E.prototype,"initialize",null),n([d.Initializable.uninitialize()],E.prototype,"uninitialize",null),n([d.Initializable.assert_initialized()],E.prototype,"update",null),n([d.Initializable.assert_initialized()],E.prototype,"frame",null),n([d.Initializable.assert_initialized()],E.prototype,"unbind",null),function(w){(function(S){S[S.None=0]="None",S[S.Smooth1=1]="Smooth1",S[S.Horizontal3=2]="Horizontal3",S[S.Vertical3=3]="Vertical3",S[S.Grid3x3=4]="Grid3x3",S[S.Grid4x4=5]="Grid4x4"})(w.Sampling||(w.Sampling={}))}(E||(t.LabelRenderPass=E={}))},5035:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position2DLabel=void 0;const n=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(o,m,_){super(o,m,_),this._position=n.vec2.fromValues(0,0),this._direction=n.vec2.fromValues(1,0),this._frameSize=n.vec2.create(),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Pixel}typeset(o=!1){const m=o||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!o)return;if(!this.valid)return new f.GlyphVertices(0);const _=n.vec4.create(),p=n.mat4.create();n.mat4.translate(p,(0,c.m4)(),n.vec3.fromValues(-1,-1,0)),n.mat4.scale(p,p,n.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const b=n.vec2.sub((0,c.v2)(),n.vec2.fromValues(this._frameSize[0],this._frameSize[1]),n.vec2.fromValues(_[3]+_[1],_[2]+_[0])),x=n.vec3.fromValues(.5*b[0],.5*b[1],0);n.vec3.add(x,x,n.vec3.fromValues(_[3],_[2],0)),n.mat4.translate(p,p,x),n.mat4.translate(p,p,n.vec3.fromValues(this._position[0],this._position[1],0));const E=n.vec2.fromValues(1,0);let w=n.vec2.angle(E,this._direction);switch(E[0]*this._direction[1]-E[1]*this._direction[0]<0&&(w=-w),n.mat4.rotateZ(p,p,w),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(p),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=n.mat4.clone(p)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const S=this.vertices();return h.Typesetter.typeset(this,S),S}set frameSize(o){n.vec2.equals(this._frameSize,o)||(n.vec2.max(this._frameSize,o,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(o){n.vec2.equals(this._position,o)||(this._position=n.vec2.clone(o),this._altered.alter(this._type))}get position(){return this._position}set direction(o){n.vec2.normalize(this._direction,o),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(o){(0,r.logIf)(o!==d.Label.Unit.Pixel,r.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${o}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position2DLabel=s,s.DEFAULT_FONTSIZE_PX=20},5036:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position3DLabel=void 0;const n=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(o,m,_){super(o,m,_),this._position=n.vec3.fromValues(0,0,0),this._direction=n.vec3.fromValues(1,0,0),this._up=n.vec3.fromValues(0,1,0),this._fontSize=s.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=d.Label.Unit.World}typeset(o=!1){const m=o||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!o)return;if(!this.valid)return new f.GlyphVertices(0);const _=n.mat4.create();n.mat4.translate(_,(0,c.m4)(),this._position);const p=n.vec3.cross((0,c.v3)(),this._direction,this._up),b=n.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,p[0],p[1],p[2],0,0,0,0,1);switch(n.mat4.mul(_,_,b),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(_),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=n.mat4.clone(_)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const x=this.vertices();return h.Typesetter.typeset(this,x),x}set position(o){this._position=n.vec3.clone(o),this._altered.alter(this._type)}get position(){return this._position}set direction(o){n.vec3.normalize(this._direction,o),this._altered.alter(this._type)}get direction(){return this._direction}set up(o){this._up=n.vec3.normalize(this._up,o),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(o){(0,r.logIf)(o!==d.Label.Unit.World,r.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${o}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position3DLabel=s,s.DEFAULT_FONTSIZE_WORLD=.05},135:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Projected3DLabel=void 0;const n=i(3557),r=i(9504),c=i(5150),f=i(9495),d=i(7188),h=i(967);class s extends d.Label{constructor(o,m,_){super(o,m,_),this._position=n.vec3.fromValues(0,0,0),this._direction=n.vec2.fromValues(1,0),this._fontSize=s.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=d.Label.Unit.Mixed}typeset(o=!1){const m=o||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!m&&!this._altered.dynamic&&!o)return;if(!this.valid||this._camera===void 0)return new f.GlyphVertices(0);const _=n.vec4.create(),p=n.mat4.create();n.mat4.translate(p,p,n.vec3.fromValues(-1,-1,0)),n.mat4.scale(p,p,n.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),n.mat4.scale(p,p,n.vec3.fromValues(1,1,1));const b=n.vec2.create();n.vec2.sub(b,n.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),n.vec2.fromValues(_[3]+_[1],_[2]+_[0]));const x=n.vec3.fromValues(.5*b[0],.5*b[1],0);n.vec3.add(x,x,n.vec3.fromValues(_[3],_[2],0)),n.mat4.translate(p,p,x);const E=n.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);n.vec4.transformMat4(E,E,this._camera.viewProjection);const w=n.mat4.create(),S=E[3];n.mat4.translate(w,w,n.vec3.fromValues(E[0]/S,E[1]/S,E[2]/S)),n.mat4.mul(p,w,p);const R=n.vec2.fromValues(1,0);let O=n.vec2.angle(R,this._direction);switch(R[0]*this._direction[1]-R[1]*this._direction[0]<0&&(O=-O),n.mat4.rotateZ(p,p,O),this._camera.viewProjectionInverse?n.mat4.mul(p,this._camera.viewProjectionInverse,p):(0,r.log)(r.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case d.Label.Type.Static:this.staticTransform=n.mat4.clone(p),this.dynamicTransform=(0,c.m4)();break;case d.Label.Type.Dynamic:this.staticTransform=(0,c.m4)(),this.dynamicTransform=n.mat4.clone(p)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!m)return;const I=this.vertices();return h.Typesetter.typeset(this,I),I}set camera(o){this._camera=o,this._altered.alter(this._type)}get camera(){return this._camera}set position(o){this._position=n.vec3.clone(o),this._altered.alter(this._type)}get position(){return this._position}set direction(o){n.vec2.normalize(this._direction,o),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(o){(0,r.logIf)(o!==d.Label.Unit.Mixed,r.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${o}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Projected3DLabel=s,s.DEFAULT_FONTSIZE_PX=20},7623:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;class i{constructor(r,c){this._lineFeed=i.DEFAULT_LINE_FEED,this._altered=!1,this._text=r||"",this._lineFeed=c!==void 0?c:this._lineFeed}get length(){return this._text.length}charAt(r){return this._text.charAt(r)}charCodeAt(r){return this._text.charCodeAt(r)}set text(r){this._text!==r&&(this._altered=!0,this._text=r)}get text(){return this._text}set lineFeed(r){this._lineFeed!==r&&(this._altered=!0,this._lineFeed=r)}get lineFeed(){return this._lineFeed}set altered(r){this._altered=r}get altered(){return this._altered}}t.Text=i,i.DEFAULT_LINE_FEED=`
`},967:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=void 0;const n=i(3557),r=i(9504),c=i(5150),f=i(7188);class d{static writeVertex(s,u,o,m,_){if(m===void 0||o.depictable()===!1)return;const p=s.glyphTexturePadding,b=m.origin(_);n.vec3.set(b,u[0],u[1],0),b[0]+=o.bearing[0]-p[3],b[1]+=o.bearing[1]-o.extent[1],n.vec3.set(m.tangent(_),o.extent[0],0,0),n.vec3.set(m.up(_),0,o.extent[1],0);const x=m.uvLowerLeft(_);n.vec2.copy(x,o.subTextureOrigin);const E=m.uvUpperRight(_);n.vec2.add(E,o.subTextureOrigin,o.subTextureExtent)}static lineAnchorOffset(s){let u=0;const o=s.fontFace.glyphTexturePadding,m=s.fontFace;switch(s.lineAnchor){case f.Label.LineAnchor.Ascent:u=m.ascent-o[0];break;case f.Label.LineAnchor.Descent:u=m.descent*(1+o[0]/m.ascent);break;case f.Label.LineAnchor.Center:u=m.ascent-o[0]-.5*m.size;break;case f.Label.LineAnchor.Top:u=m.ascent-o[0]+.5*m.lineGap;break;case f.Label.LineAnchor.Bottom:u=m.ascent-o[0]+.5*m.lineGap-m.lineHeight;break;case f.Label.LineAnchor.Baseline:default:u=-o[0]}return u}static advances(s,u){(0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve advances"),u===void 0&&(u=s.text.text);const o=new Float32Array(u.length);for(let m=0;m<u.length;++m){const _=u.charCodeAt(m);o[m]=s.fontFace.glyph(_).advance}return o}static kernings(s,u){if((0,r.assert)(s.fontFace!==void 0,"expected a font face for label in order to resolve kernings"),u===void 0){const _=new Float32Array(s.length);for(let p=0;p<s.length;++p){const b=s.kerningAfter(p);_[p]=isNaN(b)?0:b}return _}const o=new Float32Array(u.length);for(let _=0;_<u.length;++_){const p=(m=_)<0||m>u.length-1?NaN:s.fontFace.kerning(u.charCodeAt(m),u.charCodeAt(m+1));o[_]=isNaN(p)?0:p}var m;return o}static fragments(s){const u=new Array;let o,m=0;for(let _=0;_<s.length;++_){if(o=d.DELIMITERS.indexOf(s.charAt(_))>-1,!o)continue;m<_&&u.push([m,_,d.FragmentType.Word]);const p=s.lineFeedAt(_)?d.FragmentType.LineFeed:d.FragmentType.Delimiter;u.push([_,_+1,p]),m=_+1}return o||u.push([m,s.length,d.FragmentType.Word]),u}static fragmentWidths(s,u,o){const m=new Float32Array(s.length);for(let _=0;_<s.length;++_){const p=s[_];m[_]=u.subarray(p[0],p[1]).reduce((b,x,E)=>b+x+(E<p[1]?o[E+p[0]]:0),0)}return m}static elideThresholds(s,u){switch(s.elide){case f.Label.Elide.Right:return[s.lineWidth-u,0];case f.Label.Elide.Middle:const o=s.lineWidth/2-u/2;return[o,o];case f.Label.Elide.Left:return[0,s.lineWidth-u];default:return[0,0]}}static elideFragments(s,u,o,m,_,p){const b=new Array,x=new Array;let E=0,w=0;for(let S=p?u.length-1:0;p?S>-1:S<u.length;p?--S:++S){const R=u[S];if(R[2]!==d.FragmentType.LineFeed){if(!(E+o[S]<s)){if(R[2]===d.FragmentType.Delimiter||E+m[p?R[1]-1:R[0]]>s)break;for(let O=p?R[1]-1:R[0];p?O>=R[0]:O<R[1];p?--O:++O){if(!(E+w+m[O]+_[O]<s)){b.push([p?O+1:R[0],p?R[1]:O,R[2]]),x.push(w);break}w+=m[O]+_[O]}break}E+=o[S],b.push(R),x.push(o[S])}}return[b,x,E+w]}static transformVertices(s,u,o,m){if(u!==void 0&&!n.mat4.equals(s,n.mat4.create()))for(let _=o;_<m;++_){const p=u.origin(_),b=(0,c.v3)();n.vec3.transformMat4(b,p,s);const x=(0,c.v3)();n.vec3.transformMat4(x,n.vec3.add(x,p,u.tangent(_)),s);const E=(0,c.v3)();n.vec3.transformMat4(E,n.vec3.add(E,p,u.up(_)),s),n.vec3.copy(u.origin(_),b),n.vec3.sub(u.tangent(_),x,b),n.vec3.sub(u.up(_),E,b)}}static updateRectangleMinMax(s,u){(0,r.assert)(s.length===6&&u.length===6,"expected the rectangles to have 6 values!");let o=0;for(;o<3;o++)s[o]=Math.min(s[o],u[o]);for(;o<6;o++)s[o]=Math.max(s[o],u[o])}static minMax(s,u,o){const m=Math.min(s,...o),_=Math.max(u,...o);return n.vec2.fromValues(m,_)}static getMinMaxVertices(s,u,o){let m=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(let w=u;w<o;++w){const S=d.minMax(m,_,[s.origin(w)[0],s.origin(w)[0]+s.up(w)[0],s.origin(w)[0]+s.tangent(w)[0]]);m=S[0],_=S[1];const R=d.minMax(p,b,[s.origin(w)[1],s.origin(w)[1]+s.up(w)[1],s.origin(w)[1]+s.tangent(w)[1]]);p=R[0],b=R[1];const O=d.minMax(x,E,[s.origin(w)[2],s.origin(w)[2]+s.up(w)[2],s.origin(w)[2]+s.tangent(w)[2]]);x=O[0],E=O[1]}return[m,p,x,_,b,E]}static transformAlignment(s,u,o,m,_){if(o===void 0||u===f.Label.Alignment.Left)return;let p=-s;u===f.Label.Alignment.Center&&(p*=.5);for(let b=m;b<_;++b)o.origin(b)[0]+=p}static transform(s,u,o){const m=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const S of o)d.transformAlignment(S[2],s.alignment,u,S[0],S[1]),d.updateRectangleMinMax(m,d.getMinMaxVertices(u,S[0],S[1])),d.transformVertices(s.staticTransform,u,S[0],S[1]);const _=m[3]-m[0],p=m[4]-m[1],b=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(0,0,0,1),s.staticTransform),x=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(_,0,0,1),s.staticTransform),E=n.vec4.transformMat4(n.vec4.create(),n.vec4.fromValues(0,p,0,1),s.staticTransform),w=n.vec2.fromValues(n.vec4.distance(x,b),n.vec4.distance(E,b));s.extent=[w[0],w[1]]}static typeset(s,u){if(s.length===0)return 0;(0,r.assert)(s.fontFace!==void 0,"expected a font face for label before typesetting");const o=s.fontFace,m=D=>D<s.length?o.glyph(s.charCodeAt(D)):o.glyph(s.ellipsis.charCodeAt(D-s.length)),_=d.advances(s),p=d.kernings(s),b=d.fragments(s),x=d.fragmentWidths(b,_,p),E=n.vec2.fromValues(0,-d.lineAnchorOffset(s)),w=new Array;let S=0;const R=s.elide!==f.Label.Elide.None,O=(D,j,k=NaN,G=_,Z=p,K=0)=>{let Y=S;for(let re=0;re<D.length;++re){const Q=D[re];if(Q[0]>=Q[1])continue;const ae=!R&&Q[2]===d.FragmentType.LineFeed;let se=!1;if(!R&&!ae&&s.wrap){const ee=Q[2]!==d.FragmentType.Delimiter||m(Q[0]).depictable(),le=Q[2]===d.FragmentType.Word&&re<D.length-1&&D[re+1][2]===d.FragmentType.Delimiter&&m(D[re+1][0]).depictable();se=E[0]+(ee?j[re]:0)+(le?j[re+1]:0)>s.lineWidth}if(!ae&&!se||(w.push([Y,S,E[0]]),Y=S,E[0]=0,E[1]-=o.lineHeight,!ae))for(let ee=Q[0];ee<Q[1];++ee)m(ee).depictable()&&(d.writeVertex(o,E,m(ee),u,S),++S),E[0]+=G[ee-K]+Z[ee-K]}Y<S&&w.push([Y,S,E[0]])},I=x.reduce((D,j)=>D+j,0);if(R&&I>s.lineWidth){const D=[[s.length,s.length+s.ellipsis.length,d.FragmentType.Word]],j=d.advances(s,s.ellipsis),k=d.kernings(s,s.ellipsis),G=d.fragmentWidths([[0,s.ellipsis.length,d.FragmentType.Word]],j,k),Z=G[0];if(s.lineWidth<Z)return 0;const K=d.elideThresholds(s,Z),[Y,re,Q]=d.elideFragments(K[0],b,x,_,p,!1);s.elide===f.Label.Elide.Middle&&(K[1]+=K[0]-Q);const[ae,se]=d.elideFragments(K[1],b,x,_,p,!0);O(Y,new Float32Array(re)),O(D,G,NaN,j,k,s.length),O(ae.reverse(),new Float32Array(se.reverse())),(0,r.assert)(w.length<4,`expected at most 3-line-yield from advance, given ${w}`),w[0][1]=w[w.length-1][1],w[0][2]=E[0],w.length=1}else O(b,x,s.lineWidth);return d.transform(s,u,w),u.shrink(S),S}}t.Typesetter=d,d.DELIMITERS=`
 ,.-/()[]<>`,function(h){(function(s){s[s.Word=0]="Word",s[s.Delimiter=1]="Delimiter",s[s.LineFeed=2]="LineFeed"})(h.FragmentType||(h.FragmentType={}))}(d||(t.Typesetter=d={}))},8593:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2D=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(u,o,m,_,p){(0,r.assert)(u>0&&o>0,"texture requires valid width and height of greater than zero");const b=this._context.gl,x=this._context.gl2facade;if(this._object=b.createTexture(),this._width=u,this._height=o,this._internalFormat=m,this._format=_,this._type=p,b.bindTexture(b.TEXTURE_2D,this._object),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),h.MAX_ANISOTROPY===void 0)if(this._context.supportsTextureFilterAnisotropic){const E=this._context.textureFilterAnisotropic;h.MAX_ANISOTROPY=b.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else h.MAX_ANISOTROPY=0;return x.texImage2D(b.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),b.bindTexture(b.TEXTURE_2D,h.DEFAULT_TEXTURE),this._valid=b.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const u=this.context.gl,o=this._context.gl2facade;let m=this._width*this._height*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===o.HALF_FLOAT&&this._internalFormat!==u.RGBA16F?m*=2:this._type===u.FLOAT&&this._internalFormat!==u.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_2D,this._object)}unbind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_2D,h.DEFAULT_TEXTURE)}fetch(u,o=!1,m=!1){const _=this.context.gl;return new Promise((p,b)=>{const x=new Image;x.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${x.src}' failed`),b()},x.onload=()=>{this.resize(x.width,x.height),m||_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!0),this.data(x),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1),p()},o&&(x.crossOrigin="anonymous"),x.src=u})}data(u,o=!0,m=!0){const _=this.context.gl,p=this._context.gl2facade;o&&this.bind(),p.texImage2D(_.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,u),this._anisotropy!==void 0&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),m&&this.unbind(),this.reallocate()}filter(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),(0,r.logIf)(u===p.LINEAR_MIPMAP_LINEAR||u===p.LINEAR_MIPMAP_NEAREST,r.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,u),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,o),this._mipmap=o===p.LINEAR_MIPMAP_LINEAR||o===p.LINEAR_MIPMAP_NEAREST,this._mipmap&&p.generateMipmap(p.TEXTURE_2D),_&&this.unbind()}wrap(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,u),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,o),_&&this.unbind()}reformat(u,o,m,_=!0,p=!0){(u!==this._internalFormat||o!==void 0&&o!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(u!==void 0,"valid internal format expected"),this._internalFormat=u,o&&(this._format=o),m&&(this._type=m),this.data(void 0,_,p))}resize(u,o,m=!0,_=!0){u===this._width&&o===this._height||(this._width=u,this._height=o,this.data(void 0,m,_))}generateMipMap(u=!0,o=!0){const m=this.context.gl;u&&this.bind(),m.generateMipmap(m.TEXTURE_2D),o&&this.unbind(),this._mipmap=!0}maxAnisotropy(u,o=!0,m=!0){if(this._context.supportsTextureFilterAnisotropic===!1)return void(0,r.log)(r.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const _=this.context.gl,p=this._context.textureFilterAnisotropic;return this._anisotropy=u===void 0?void 0:Math.max(0,Math.min(h.MAX_ANISOTROPY,u)),(0,r.logIf)(u!==this._anisotropy,r.LogLevel.Debug,`value clamped to max supported anisotropy of ${h.MAX_ANISOTROPY}, given ${u}`),o&&this.bind(),_.texParameterf(_.TEXTURE_2D,p.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy===void 0?0:this._anisotropy),this.generateMipMap(!1,m),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}t.Texture2D=h,h.DEFAULT_TEXTURE=void 0,h.MAX_ANISOTROPY=void 0,n([f.Initializable.assert_initialized()],h.prototype,"bind",null),n([f.Initializable.assert_initialized()],h.prototype,"unbind",null),n([f.Initializable.assert_initialized()],h.prototype,"fetch",null),n([f.Initializable.assert_initialized()],h.prototype,"data",null),n([f.Initializable.assert_initialized()],h.prototype,"filter",null),n([f.Initializable.assert_initialized()],h.prototype,"wrap",null),n([f.Initializable.assert_initialized()],h.prototype,"reformat",null),n([f.Initializable.assert_initialized()],h.prototype,"resize",null)},7380:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2DArray=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(u,o,m,_,p,b){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(u>0&&o>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=u,this._height=o,this._depth=m,this._internalFormat=_,this._format=p,this._type=b,x.bindTexture(x.TEXTURE_2D_ARRAY,this._object),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D_ARRAY,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_2D_ARRAY,h.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const u=this.context.gl,o=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===o.HALF_FLOAT&&this._internalFormat!==u.RGBA16F?m*=2:this._type===u.FLOAT&&this._internalFormat!==u.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_2D_ARRAY,this._object)}unbind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_2D_ARRAY,h.DEFAULT_TEXTURE)}fetch(u,o,m=!1){return new Promise((_,p)=>{const b=new Image;b.onerror=()=>{(0,r.log)(r.LogLevel.Error,`loading image from '${b.src}' failed`),p()},b.onload=()=>{this.resize(b.width,b.height/o,o),this.data(b),_()},m&&(b.crossOrigin="anonymous"),b.src=u})}data(u,o=!0,m=!0){const _=this.context.gl,p=this._context.gl2facade;o&&this.bind(),p.texImage3D(_.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,u),m&&this.unbind(),this.reallocate()}filter(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_2D_ARRAY,p.TEXTURE_MAG_FILTER,u),p.texParameteri(p.TEXTURE_2D_ARRAY,p.TEXTURE_MIN_FILTER,o),_&&this.unbind()}wrap(u,o,m,_=!0,p=!0){const b=this.context.gl;_&&this.bind(),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_T,o),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_R,m),p&&this.unbind()}reformat(u,o,m,_=!0,p=!0){(u!==this._internalFormat||o!==void 0&&o!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(u!==void 0,"valid internal format expected"),this._internalFormat=u,o&&(this._format=o),m&&(this._type=m),this.data(void 0,_,p))}resize(u,o,m,_=!0,p=!0){u===this._width&&o===this._height&&m===this._depth||(this._width=u,this._height=o,this._depth=m,this.data(void 0,_,p))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture2DArray=h,h.DEFAULT_TEXTURE=void 0,n([f.Initializable.assert_initialized()],h.prototype,"bind",null),n([f.Initializable.assert_initialized()],h.prototype,"unbind",null),n([f.Initializable.assert_initialized()],h.prototype,"fetch",null),n([f.Initializable.assert_initialized()],h.prototype,"data",null),n([f.Initializable.assert_initialized()],h.prototype,"filter",null),n([f.Initializable.assert_initialized()],h.prototype,"wrap",null),n([f.Initializable.assert_initialized()],h.prototype,"reformat",null),n([f.Initializable.assert_initialized()],h.prototype,"resize",null)},9584:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture3D=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(u,o,m,_,p,b){(0,r.assert)(this._context.supportsTexImage3D,"expected texImage3D to be supported"),(0,r.assert)(u>0&&o>0&&m>0,"texture requires valid width, height, and depth of greater than zero");const x=this._context.gl,E=this._context.gl2facade;return this._object=x.createTexture(),this._width=u,this._height=o,this._depth=m,this._internalFormat=_,this._format=p,this._type=b,x.bindTexture(x.TEXTURE_3D,this._object),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_3D,x.TEXTURE_WRAP_R,x.CLAMP_TO_EDGE),E.texImage3D(x.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),x.bindTexture(x.TEXTURE_3D,h.DEFAULT_TEXTURE),this._valid=x.isTexture(this._object),this.reallocate(),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const u=this.context.gl,o=this._context.gl2facade;let m=this._width*this._height*this._depth*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);this._type===o.HALF_FLOAT&&this._internalFormat!==u.RGBA16F?m*=2:this._type===u.FLOAT&&this._internalFormat!==u.RGBA16F&&(m*=4),this.context.allocationRegister.reallocate(this._identifier,m)}bind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_3D,this._object)}unbind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_3D,h.DEFAULT_TEXTURE)}load(u,o,m=!1,_=!1){return new Promise((p,b)=>{const x=new Image;x.onerror=()=>b(),x.onload=()=>{const E=document.createElement("canvas"),w=E.getContext("2d");let S,R,O,I;if((0,r.assert)(w!==void 0,"expected auxiliary 2D context for temporary slicing"),_===!1){(0,r.assert)(x.height%o==0&&x.height/o>=1,"expected height to be a multitude of number of slices"),S=x.width,R=Math.floor(x.height/o),O=o,E.width=S,E.height=R,I=new Uint8Array(S*R*O);const D=S*R;for(let j=0;j<o;++j){w.drawImage(x,0,R*j,S,R,0,0,S,R);const k=w.getImageData(0,0,S,R).data;for(let G=0;G<D;++G)I[D*j+G]=k[4*G]}}else{(0,r.assert)(x.width%o==0&&x.width/o>=1,"expected width to be a multitude of number of slices"),S=Math.floor(x.width/o),R=x.height,O=o,E.width=S,E.height=R,I=new Uint8Array(S*R*O);const D=S*R;for(let j=0;j<o;++j){w.drawImage(x,S*j,0,S,R,0,0,S,R);const k=w.getImageData(0,0,S,R).data;for(let G=0;G<D;++G)I[D*j+G]=k[4*G]}}this.resize(S,R,O),this.data(I),p()},m&&(x.crossOrigin="anonymous"),x.src=u})}loadFromSingleImages(u,o,m=!1,_=!1){return new Promise((p,b)=>{const x=document.createElement("canvas"),E=x.getContext("2d"),w=[];let S,R;for(let O=0;O<u.length;O++){const I=new Image;I.onerror=()=>b();const D=new Promise((j,k)=>{try{I.onload=()=>{const G=I.width,Z=I.height;_===!1?(S===void 0?(S=G*u.length,x.width=S):(0,r.assert)(G*u.length===S,"The single images do not have the same width"),R===void 0?(R=Z,x.height=R):(0,r.assert)(Z===R,"The single images do not have the same height"),E.drawImage(I,G*O,0)):(S===void 0?(S=G,x.width=S):(0,r.assert)(G===S,"The single images do not have the same width"),R===void 0?(R=Z*u.length,x.height=R):(0,r.assert)(Z*u.length===R,"The single images do not have the same height"),E.drawImage(I,0,Z*O)),j()}}catch(G){k(G)}});w.push(D),m&&(I.crossOrigin="anonymous"),I.src=u[O]}Promise.all(w).then(()=>{const O=x.toDataURL("image/png",1);return this.load(O,o,m,_).then(()=>{p()})})})}data(u,o=!0,m=!0){const _=this.context.gl,p=this._context.gl2facade;o&&this.bind(),p.texImage3D(_.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,u),m&&this.unbind(),this.reallocate()}filter(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,u),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,o),_&&this.unbind()}wrap(u,o,m,_=!0,p=!0){const b=this.context.gl;_&&this.bind(),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_T,o),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_R,m),p&&this.unbind()}reformat(u,o,m,_=!0,p=!0){(u!==this._internalFormat||o!==void 0&&o!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(u!==void 0,"valid internal format expected"),this._internalFormat=u,o&&(this._format=o),m&&(this._type=m),this.data(void 0,_,p))}resize(u,o,m,_=!0,p=!0){u===this._width&&o===this._height&&m===this._depth||(this._width=u,this._height=o,this._depth=m,this.data(void 0,_,p))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}t.Texture3D=h,h.DEFAULT_TEXTURE=void 0,n([f.Initializable.assert_initialized()],h.prototype,"bind",null),n([f.Initializable.assert_initialized()],h.prototype,"unbind",null),n([f.Initializable.assert_initialized()],h.prototype,"load",null),n([f.Initializable.assert_initialized()],h.prototype,"loadFromSingleImages",null),n([f.Initializable.assert_initialized()],h.prototype,"data",null),n([f.Initializable.assert_initialized()],h.prototype,"filter",null),n([f.Initializable.assert_initialized()],h.prototype,"wrap",null),n([f.Initializable.assert_initialized()],h.prototype,"reformat",null),n([f.Initializable.assert_initialized()],h.prototype,"resize",null)},5186:function(v,t,i){var n=this&&this.__decorate||function(s,u,o,m){var _,p=arguments.length,b=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,o):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(s,u,o,m);else for(var x=s.length-1;x>=0;x--)(_=s[x])&&(b=(p<3?_(b):p>3?_(u,o,b):_(u,o))||b);return p>3&&b&&Object.defineProperty(u,o,b),b};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureCube=void 0;const r=i(9504),c=i(3513),f=i(4127),d=i(9965);class h extends d.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(u){const o=this._context.gl;switch(u){case o.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case o.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case o.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case o.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case o.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case o.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return(0,r.assert)(!1,`expected texture cube map identifier (${o.TEXTURE_CUBE_MAP_POSITIVE_X}, ${o.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${o.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${o.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${o.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${o.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${u}`),-1}}create(u,o,m,_){(0,r.assert)(u>0,"texture cube requires valid size (width/height) of greater than zero");const p=this._context.gl,b=this._context.gl2facade;return this._object=p.createTexture(),this._size=u,this._internalFormat=o,this._format=m,this._type=_,p.bindTexture(p.TEXTURE_CUBE_MAP,this._object),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),p.bindTexture(p.TEXTURE_CUBE_MAP,h.DEFAULT_TEXTURE),this._valid=p.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){(0,r.assert)(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(u,o,m,_,p){const b=document.createElement("canvas");b.width=_,b.height=p;const x=b.getContext("2d");return x?(x.drawImage(u,o,m,_,p,0,0,_,p),x.getImageData(0,0,_,p)):(console.log(r.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(u,o){const m=this.context.gl,_=u.height/2*Math.pow(.5,o),p=[0,0],b=[u.width,u.height];for(let I=0;I<o;++I)b[0]/=2,b[1]/=2,p[0]+=b[0],p[1]+=b[1];m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!0);const x=this.cropImage(u,p[0],p[1],_,_);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_X,x],o);const E=this.cropImage(u,p[0]+_,p[1],_,_);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Z,E],o);const w=this.cropImage(u,p[0]+2*_,p[1],_,_);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_X,w],o);const S=this.cropImage(u,p[0]+3*_,p[1],_,_);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Z,S],o);const R=this.cropImage(u,p[0],p[1]+_,_,_);this.data([m.TEXTURE_CUBE_MAP_POSITIVE_Y,R],o);const O=this.cropImage(u,p[0]+_,p[1]+_,_,_);this.data([m.TEXTURE_CUBE_MAP_NEGATIVE_Y,O],o),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1)}bind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_CUBE_MAP,this._object)}unbind(u){const o=this.context.gl;u&&o.activeTexture(u),o.bindTexture(o.TEXTURE_CUBE_MAP,h.DEFAULT_TEXTURE)}fetch(u,o=!1,m=0){const _=this.context.gl;return new Promise((p,b)=>{const x=new Array;u.positiveX&&x.push([_.TEXTURE_CUBE_MAP_POSITIVE_X,u.positiveX]),u.negativeX&&x.push([_.TEXTURE_CUBE_MAP_NEGATIVE_X,u.negativeX]),u.positiveY&&x.push([_.TEXTURE_CUBE_MAP_POSITIVE_Y,u.positiveY]),u.negativeY&&x.push([_.TEXTURE_CUBE_MAP_NEGATIVE_Y,u.negativeY]),u.positiveZ&&x.push([_.TEXTURE_CUBE_MAP_POSITIVE_Z,u.positiveZ]),u.negativeZ&&x.push([_.TEXTURE_CUBE_MAP_NEGATIVE_Z,u.negativeZ]);let E=x.length;for(const w of x){const S=new Image;S.crossOrigin="anonymous",S.onerror=()=>b(),S.onload=()=>{const R=this.calculateMipLevelSize(m);S.width===S.height?S.width===R?(_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!0),this.data([w[0],S],m),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1),E-=1,E===0&&p()):(0,r.log)(r.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${R}, given ${S.width}`):(0,r.log)(r.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},o&&(S.crossOrigin="anonymous"),S.src=w[1]}})}fetchMipmapAtlas(u,o=!1){return new Promise((m,_)=>{const p=new Image;p.onerror=()=>_(),p.onload=()=>{if(p.width!==2*p.height)return void(0,r.log)(r.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const b=p.height/2,x=Math.log2(b);for(let E=0;E<x;++E)this.extractMipLevelFromAtlas(p,E);m()},o&&(p.crossOrigin="anonymous"),p.src=u})}calculateMipLevelSize(u){return this._size*Math.pow(.5,u)}data(u,o=0,m=!0,_=!0){const p=this.context.gl,b=this.context.gl2facade,x=this.calculateMipLevelSize(o);let E=x*x*(0,c.byteSizeOfFormat)(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?E*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(E*=4),m&&this.bind(),u instanceof Array&&u.length===2){b.texImage2D(u[0],o,this._internalFormat,x,x,0,this._format,this._type,u[1]);const w=this.faceID(u[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[w]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[w]=E}else{const w=u;w.positiveX!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X,o,this._internalFormat,x,x,0,this._format,this._type,w.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[0]=E),w.negativeX!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_X,o,this._internalFormat,x,x,0,this._format,this._type,w.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[1]=E),w.positiveY!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Y,o,this._internalFormat,x,x,0,this._format,this._type,w.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[2]=E),w.negativeY!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,o,this._internalFormat,x,x,0,this._format,this._type,w.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[3]=E),w.positiveZ!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Z,o,this._internalFormat,x,x,0,this._format,this._type,w.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[4]=E),w.negativeZ!==void 0&&(b.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,o,this._internalFormat,x,x,0,this._format,this._type,w.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,E),this._bytes[5]=E)}_&&this.unbind()}filter(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MAG_FILTER,u),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MIN_FILTER,o),_&&this.unbind()}wrap(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_WRAP_S,u),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_WRAP_T,o),_&&this.unbind()}levels(u,o,m=!0,_=!0){const p=this.context.gl;m&&this.bind(),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_BASE_LEVEL,u),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MAX_LEVEL,o),_&&this.unbind()}reformat(u,o,m,_=!0,p=!0){(u!==this._internalFormat||o!==void 0&&o!==this._format||m!==void 0&&m!==this._type)&&((0,r.assert)(u!==void 0,"valid internal format expected"),this._internalFormat=u,o&&(this._format=o),m&&(this._type=m),this.data({clearOnUndefined:!0},0,_,p))}resize(u,o=!0,m=!0){u!==this._size&&(this._size=u,this.data({clearOnUndefined:!0},0,o,m))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}t.TextureCube=h,h.DEFAULT_TEXTURE=void 0,n([f.Initializable.assert_initialized()],h.prototype,"bind",null),n([f.Initializable.assert_initialized()],h.prototype,"unbind",null),n([f.Initializable.assert_initialized()],h.prototype,"fetch",null),n([f.Initializable.assert_initialized()],h.prototype,"fetchMipmapAtlas",null),n([f.Initializable.assert_initialized()],h.prototype,"data",null),n([f.Initializable.assert_initialized()],h.prototype,"filter",null),n([f.Initializable.assert_initialized()],h.prototype,"wrap",null),n([f.Initializable.assert_initialized()],h.prototype,"levels",null),n([f.Initializable.assert_initialized()],h.prototype,"reformat",null),n([f.Initializable.assert_initialized()],h.prototype,"resize",null)},5608:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TileCameraGenerator=void 0;const n=i(3557),r=i(5150),c=i(9504);class f{constructor(){this._tileSize=[0,0],this._padding=n.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=f.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(h,s,u,o,m,_,p,b,x,E,w){if(E>0)return w=this.hilbertIndices(h,s,u,o,m,b/2,x/2,_/2,p/2,E-1,w),w=this.hilbertIndices(h,s,u,o+_/2,m+p/2,_/2,p/2,b/2,x/2,E-1,w),w=this.hilbertIndices(h,s,u,o+_/2+b/2,m+p/2+x/2,_/2,p/2,b/2,x/2,E-1,w),this.hilbertIndices(h,s,u,o+_/2+b,m+p/2+x,-b/2,-x/2,-_/2,-p/2,E-1,w);if(m+=(p+x-1)/2,(o+=(_+b-1)/2)<s&&m<u){const S=2*w;h[S+0]=o,h[S+1]=m,++w}return w}static generateHilbertIndices(h,s,u){(0,c.assert)(h.length===2*s*u,`expected interleaved indices-array of length ${2*s*u}, given ${h.length}`);const o=Math.max(s,u),m=Math.ceil(Math.log2(o)),_=(0,c.upperPowerOfTwo)(o);this.hilbertIndices(h,s,u,0,0,_,0,0,_,m,0)}static generateScanLineIndices(h,s,u){(0,c.assert)(h.length===2*s*u,`expected interleaved indices-array of length ${2*s*u}, given ${h.length}`);for(let o=0;o<u;++o)for(let m=0;m<s;++m){const _=2*(m+o*s);h[_+0]=m,h[_+1]=o}}static generateZCurveIndices(h,s,u){(0,c.assert)(h.length===2*s*u,`expected interleaved indices-array of length ${2*s*u}, given ${h.length}`);const o=Math.max(s,u),m=2*Math.floor(Math.log2(o));let _=0;for(let p=0;p<s*u;++_){let b=0,x=0;for(let E=0;E<m;++E)b+=(_>>2*E&1)<<E,x+=(_>>2*E+1&1)<<E;if(b<s&&x<u){const E=2*p;h[E+0]=b,h[E+1]=x,++p}}}invalidate(h){h&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case f.Algorithm.ScanLine:f.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case f.Algorithm.HilbertCurve:f.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case f.Algorithm.ZCurve:f.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:f.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const h=2*this.tile;return[this._indices[h+0],this._indices[h+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){(0,c.assert)(this._sourceCamera!==void 0,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return(0,c.log)(c.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;(0,c.assert)(this._sourceViewport!==void 0&&this._sourceCamera!==void 0,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const h=this.tableIndices(),s=this.sourceViewport,u=this.getPaddedTileSize(),o=[0,0];o[0]=h[0]*this.tileSize[0]+u[0]/2,o[1]=h[1]*this.tileSize[1]+u[1]/2;const m=[0,0];m[0]=h[0]*this.tileSize[0],m[1]=h[1]*this.tileSize[1];const _=[2*o[0]/s[0]-1,2*o[1]/s[1]-1],p=n.vec3.fromValues(s[0]/u[0],s[1]/u[1],1),b=n.vec3.fromValues(-_[0],-_[1],0),x=n.mat4.scale((0,r.m4)(),n.mat4.identity((0,r.m4)()),p),E=n.mat4.translate((0,r.m4)(),x,b);return this._camera.postViewProjection=E,this._offset=m,m}get valid(){return this._camera!==void 0&&this._sourceCamera!==void 0&&this._valid}get numXTiles(){return(0,c.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return(0,c.assert)(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(h){h!==void 0?(this._sourceCamera=h,this._camera=Object.create(h),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(h){this._tile!==h&&(this._tile=h,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(h){this._sourceViewport!==void 0&&h!==void 0&&this._sourceViewport[0]===h[0]&&this._sourceViewport[1]===h[1]||(this._sourceViewport=h,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(h){this._tileSize[0]===h[0]&&this._tileSize[1]===h[1]||(this._tileSize=h,this.invalidate(!0))}get padding(){return this._padding}set padding(h){n.vec4.equals(this._padding,h)||(this._padding=n.vec4.clone(h),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(h){this._algorithm!==h&&(this._algorithm=h,this.invalidate(!0))}}t.TileCameraGenerator=f,function(d){(function(h){h.ScanLine="scanline",h.HilbertCurve="hilbertcurve",h.ZCurve="zcurve"})(d.Algorithm||(d.Algorithm={}))}(f||(t.TileCameraGenerator=f={}))},8870:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TouchEventProvider=void 0;const n=i(7032),r=i(9504);class c{constructor(d,h){(0,r.assert)(d!==void 0,`expected valid canvas element on initialization, given ${d}`),this._element=d,this._timeframe=h}preventDefaultOnEvent(d,h){(0,r.bitInBitfield)(this._preventDefaultMask,d)&&h.preventDefault()}preventDefault(...d){for(const h of d)(0,r.bitInBitfield)(this._preventDefaultMask,h)||(this._preventDefaultMask|=h)}allowDefault(...d){for(const h of d)(0,r.bitInBitfield)(this._preventDefaultMask,h)&&(this._preventDefaultMask&=~h)}observable(d){switch(d){case c.Type.Start:return this.start$;case c.Type.End:return this.end$;case c.Type.Move:return this.move$;case c.Type.Cancel:return this.cancel$}return(0,r.assert)(!1,"Encountered unknown touch event."),new n.Observable}get start$(){return this._startSubject===void 0&&(this._startSubject=new n.ReplaySubject(void 0,this._timeframe),this._startListener=d=>{this.preventDefaultOnEvent(c.Type.Start,d),this._startSubject.next(d)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return this._endSubject===void 0&&(this._endSubject=new n.ReplaySubject(void 0,this._timeframe),this._endListener=d=>{this.preventDefaultOnEvent(c.Type.End,d),this._endSubject.next(d)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=d=>{this.preventDefaultOnEvent(c.Type.Move,d),this._moveSubject.next(d)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new n.ReplaySubject(void 0,this._timeframe),this._cancelListener=d=>{this.preventDefaultOnEvent(c.Type.Cancel,d),this._cancelSubject.next(d)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.TouchEventProvider=c,function(f){(function(d){d[d.Start=1]="Start",d[d.End=2]="End",d[d.Move=4]="Move",d[d.Cancel=8]="Cancel"})(f.Type||(f.Type={}))}(c||(t.TouchEventProvider=c={}))},3151:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrackballModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=n.mat4.create(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){this._initialPoint=h}process(h){this._currentPoint=h;const s=n.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),n.vec2.copy(this._initialPoint,this._currentPoint);const u=n.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(u,u);const o=n.vec3.normalize((0,r.v3)(),this._reference.up),m=n.vec3.cross((0,r.v3)(),u,o);n.vec3.scale(o,o,s[1]),n.vec3.scale(m,m,s[0]);const _=n.vec3.cross((0,r.v3)(),n.vec3.add((0,r.v3)(),o,m),u);n.vec3.normalize(_,_);const p=n.quat.setAxisAngle(n.quat.create(),_,n.vec2.len(s));n.mat4.multiply(this._rotation,this._rotation,n.mat4.fromQuat((0,r.m4)(),p)),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._reference.center);n.mat4.multiply(h,h,this._rotation),n.mat4.translate(h,h,n.vec3.negate((0,r.v3)(),this._reference.center));const s=n.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),u=n.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.up=s,this._camera.eye=u}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.TrackballModifier=f,f.DEFAULT_SENSITIVITY=.002},2813:(v,t,i)=>{const n=i(3557),r=i(5150),c=i(9504);var f;(function(d){function h(o){return(0,c.assert)(o.length===2,`expected length of buffer to be 2, given ${o.length}`),[o[0],o[1]]}function s(o){return(0,c.assert)(o.length===3,`expected length of buffer to be 3, given ${o.length}`),[o[0],o[1],o[2]]}function u(o){return(0,c.assert)(o.length===4,`expected length of buffer to be 4, given ${o.length}`),[o[0],o[1],o[2],o[3]]}d.tuple2=h,d.tuple3=s,d.tuple4=u,d.clampf=function(o,m){const _=(0,r.clamp)(o,0,1);return(0,c.logIf)(m!==void 0&&o<0||o>1,c.LogLevel.Info,`${m} clamped to [${_}], given [${o}]`),_},d.clampf2=function(o,m){const _=n.vec2.fromValues(o[0],o[1]);return(o[0]<0||o[0]>1||o[1]<0||o[1]>1)&&((0,r.clamp2)(_,_,n.vec2.fromValues(0,0),n.vec2.fromValues(1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${_}], given [${o}]`)),h(_)},d.clampf3=function(o,m){const _=n.vec3.fromValues(o[0],o[1],o[2]);return(o[0]<0||o[0]>1||o[1]<0||o[1]>1||o[2]<0||o[2]>1)&&((0,r.clamp3)(_,_,n.vec3.fromValues(0,0,0),n.vec3.fromValues(1,1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${_}], given [${o}]`)),s(_)},d.clampf4=function(o,m){const _=n.vec4.fromValues(o[0],o[1],o[2],o[3]);return(o[0]<0||o[0]>1||o[1]<0||o[1]>1||o[2]<0||o[2]>1||o[3]<0||o[3]>1)&&((0,r.clamp4)(_,_,n.vec4.fromValues(0,0,0,0),n.vec4.fromValues(1,1,1,1)),(0,c.logIf)(m!==void 0,c.LogLevel.Info,`${m} clamped to [${_}], given [${o}]`)),u(_)},d.duplicate2=function(o){return[o[0],o[1]]},d.duplicate3=function(o){return[o[0],o[1],o[2]]},d.duplicate4=function(o){return[o[0],o[1],o[2],o[3]]},d.equals2=function(o,m){return o[0]===m[0]&&o[1]===m[1]},d.equals3=function(o,m){return o[0]===m[0]&&o[1]===m[1]&&o[2]===m[2]},d.equals4=function(o,m){return o[0]===m[0]&&o[1]===m[1]&&o[2]===m[2]&&o[3]===m[3]}})(f||(f={})),v.exports=f},9184:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TurntableModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._rotation=(0,r.m4)(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=(0,r.v3)(),this._sensitivity=f.DEFAULT_SENSITIVITY}initiate(h){Object.assign(this._reference,this._camera),this._initialPoint=h;const s=n.vec3.sub((0,r.v3)(),this._reference.eye,this._reference.center);n.vec3.normalize(s,s),this._xAxisScreenSpace=n.vec3.cross((0,r.v3)(),[0,1,0],s),this._azimuth=Math.acos(n.vec3.dot(s,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(h){this._currentPoint=h;const s=n.vec2.subtract((0,r.v2)(),this._initialPoint,this._currentPoint);n.vec2.scale(s,s,window.devicePixelRatio*this._sensitivity),Number.isFinite(this._minAzimuth)&&(s[1]=Math.min(this._azimuth-this._minAzimuth,s[1])),Number.isFinite(this._maxAzimuth)&&(s[1]=Math.max(this._azimuth-this._maxAzimuth,s[1])),n.mat4.rotateY(this._rotation,(0,r.m4)(),s[0]),n.mat4.rotate(this._rotation,this._rotation,s[1],this._xAxisScreenSpace),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._reference.center);n.mat4.multiply(h,h,this._rotation),n.mat4.translate(h,h,n.vec3.negate((0,r.v3)(),this._reference.center));const s=n.vec3.transformMat4((0,r.v3)(),[0,1,0],this._rotation),u=n.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.up=s,this._camera.eye=u}set sensitivity(h){this._sensitivity=h}get sensitivity(){return this._sensitivity}}t.TurntableModifier=f,f.DEFAULT_SENSITIVITY=.002},216:function(v,t,i){var n=this&&this.__decorate||function(d,h,s,u){var o,m=arguments.length,_=m<3?h:u===null?u=Object.getOwnPropertyDescriptor(h,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,h,s,u);else for(var p=d.length-1;p>=0;p--)(o=d[p])&&(_=(m<3?o(_):m>3?o(h,s,_):o(h,s))||_);return m>3&&_&&Object.defineProperty(h,s,_),_};Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedBuffer=void 0;const r=i(7340),c=i(4127);class f extends c.Initializable{static updatesNeedMerge(h,s,u){return s.begin-h.end<u||u===-1}constructor(h,s,u,o=0,m){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(s),this._gpuBuffer=new r.Buffer(h,m),this._usage=u,this._mergeThreshold=o}mergeUpdatesLeft(h){let s=0;const u=this._updates[h];for(let o=h-1;o>=0;o--){const m=this._updates[o];if(!f.updatesNeedMerge(m,u,this._mergeThreshold))break;u.begin=Math.min(u.begin,m.begin),u.end=Math.max(u.end,m.end),s++}return this._updates.splice(h-s,s),s+1}mergeUpdatesRight(h){let s=0;const u=this._updates[h];for(let o=h+1;o<this._updates.length;o++){const m=this._updates[o];if(!f.updatesNeedMerge(u,m,this._mergeThreshold))break;u.begin=Math.min(u.begin,m.begin),u.end=Math.max(u.end,m.end),s++}return this._updates.splice(h+1,s),s+1}addUpdate(h){const s=this._updates.findIndex(u=>h.begin<u.begin);s===-1?(this._updates.push(h),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(s,0,h),this.mergeUpdatesRight(s),this.mergeUpdatesLeft(s))}initialize(h){return this._gpuBuffer.initialize(h)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(h,s,u,o=!1,m=0,_=0,p=!0,b=!0){this._gpuBuffer.attribEnable(h,s,u,o,m,_,p,b)}attribDisable(h,s=!0,u=!0){this._gpuBuffer.attribDisable(h,s,u)}mergeSubDataRanges(){let h=0;for(;h<this._updates.length;)h+=this.mergeUpdatesRight(h)}subData(h,s){let u;u=s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),new Uint8Array(this._cpuBuffer).set(u,h),this.addUpdate({begin:h,end:h+u.byteLength})}update(h=!1,s=!1){if(h&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const u=new Uint8Array(this._cpuBuffer);for(const o of this._updates){const m=u.subarray(o.begin,o.end);this._gpuBuffer.subData(o.begin,m)}}s&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(h){const s=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(h);const u=new Uint8Array(s).slice(0,h);new Uint8Array(this._cpuBuffer).set(u)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(h){this._usage=h}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(h){this._mergeThreshold=h}}t.UnifiedBuffer=f,n([c.Initializable.initialize()],f.prototype,"initialize",null),n([c.Initializable.uninitialize()],f.prototype,"uninitialize",null),n([c.Initializable.assert_initialized()],f.prototype,"bind",null),n([c.Initializable.assert_initialized()],f.prototype,"unbind",null),n([c.Initializable.assert_initialized()],f.prototype,"attribEnable",null),n([c.Initializable.assert_initialized()],f.prototype,"attribDisable",null),n([c.Initializable.assert_initialized()],f.prototype,"update",null)},4536:(v,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.commit=t.branch=void 0,t.branch="master",t.commit="08005ba3cdde715e0e81bf865bd6014b95d74922",t.version="v0.9.0"},5507:function(v,t,i){var n=this&&this.__decorate||function(h,s,u,o){var m,_=arguments.length,p=_<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,u):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(h,s,u,o);else for(var b=h.length-1;b>=0;b--)(m=h[b])&&(p=(_<3?m(p):_>3?m(s,u,p):m(s,u))||p);return _>3&&p&&Object.defineProperty(s,u,p),p};Object.defineProperty(t,"__esModule",{value:!0}),t.VertexArray=void 0;const r=i(9504),c=i(4127),f=i(9965);class d extends f.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(s,u){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const o=this.context.gl2facade;this._object=o.createVertexArray(),this._valid=this._object!==void 0,this._bind=()=>{o.bindVertexArray(this.object),this._buffersBound||(s(),this._buffersBound=!0)},this._unbind=()=>o.bindVertexArray(d.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>s(),this._unbind=()=>u(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?((0,r.assert)(this._object!==void 0,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}t.VertexArray=d,d.DEFAULT_VERTEX_ARRAY=void 0,n([c.Initializable.assert_initialized()],d.prototype,"bind",null),n([c.Initializable.assert_initialized()],d.prototype,"unbind",null)},7645:v=>{var t;(function(i){i.EventBlocker=class{constructor(n,r){if(this._blockListenerByEvent=new Map,this._element=n,r!==void 0)for(const c of r)this.block(c)}block(n){this._blockListenerByEvent.has(n)||(this._blockListenerByEvent.set(n,r=>(r.preventDefault(),r.stopPropagation(),!1)),this._element.addEventListener(n,this._blockListenerByEvent.get(n)))}unblock(n){this._blockListenerByEvent.has(n)&&(this._element.removeEventListener(n,this._blockListenerByEvent.get(n)),this._blockListenerByEvent.delete(n))}}})(t||(t={})),v.exports=t},6378:(v,t,i)=>{const n=i(9504);var r;(function(c){class f{static queryAndCacheAPI(){if(f._exit!==void 0)return;const h=window.document,s=[h.exitFullScreen,h.msExitFullscreen,h.mozCancelFullScreen,h.webkitExitFullscreen,void 0];let u=0;for(;u<s.length&&s[u]===void 0;++u);switch(u){case 0:f._exit=()=>h.exitFullScreen(),f._request=o=>o.requestFullscreen(),f._element=()=>h.fullscreenElement,f._event="fullscreenchange";break;case 1:f._exit=()=>h.msExitFullscreen(),f._request=o=>o.msRequestFullscreen(),f._element=()=>h.msFullscreenElement,f._event="msfullscreenchange";break;case 2:f._exit=()=>h.mozCancelFullScreen(),f._request=o=>o.mozRequestFullScreen(),f._element=()=>h.mozFullScreenElement,f._event="mozfullscreenchange";break;case 3:f._exit=()=>h.webkitExitFullscreen(),f._request=o=>o.webkitRequestFullscreen(),f._element=()=>h.webkitFullscreenElement,f._event="webkitfullscreenchange";break;default:(0,n.assert)(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return f._element()!==void 0&&f._element()!==null}static toggle(h,s){if(h===void 0)return;f.queryAndCacheAPI();const u=f.active();if(!u){const o=getComputedStyle(h);f._size[0]=o.width,f._size[1]=o.height}s&&s(),u?(f._callback=void 0,window.removeEventListener(f._event,f.removeEventListener),h.style.width=f._size[0],h.style.height=f._size[1]):(f._callback=s,window.addEventListener(f._event,f.addEventListener)),u?f._exit():f._request(h)}}f._size=["0","0"],f.addEventListener=()=>{window.removeEventListener(f._event,f.addEventListener),window.addEventListener(f._event,f.removeEventListener)},f.removeEventListener=()=>{f._callback&&(f._callback(),f._callback=void 0),window.removeEventListener(f._event,f.removeEventListener)},c.Fullscreen=f})(r||(r={})),v.exports=r},5109:function(v,t,i){var n=this&&this.__createBinding||(Object.create?function(Ue,Je,it,wt){wt===void 0&&(wt=it);var Bt=Object.getOwnPropertyDescriptor(Je,it);Bt&&!("get"in Bt?!Je.__esModule:Bt.writable||Bt.configurable)||(Bt={enumerable:!0,get:function(){return Je[it]}}),Object.defineProperty(Ue,wt,Bt)}:function(Ue,Je,it,wt){wt===void 0&&(wt=it),Ue[wt]=Je[it]}),r=this&&this.__setModuleDefault||(Object.create?function(Ue,Je){Object.defineProperty(Ue,"default",{enumerable:!0,value:Je})}:function(Ue,Je){Ue.default=Je}),c=this&&this.__exportStar||function(Ue,Je){for(var it in Ue)it==="default"||Object.prototype.hasOwnProperty.call(Je,it)||n(Je,Ue,it)},f=this&&this.__importStar||function(Ue){if(Ue&&Ue.__esModule)return Ue;var Je={};if(Ue!=null)for(var it in Ue)it!=="default"&&Object.prototype.hasOwnProperty.call(Ue,it)&&n(Je,Ue,it);return r(Je,Ue),Je};Object.defineProperty(t,"__esModule",{value:!0}),t.KernelF32=t.RandomSquareKernel=t.AntiAliasingKernel=t.AbstractKernel=t.NdcFillingTriangle=t.NdcFillingRectangle=t.CanvasRecorder=t.WheelZoomModifier=t.PinchZoomModifier=t.TurntableModifier=t.TrackballModifier=t.PointerLock=t.PanModifier=t.FirstPersonModifier=t.Navigation=t.CameraModifier=t.TileCameraGenerator=t.Camera=t.Wizard=t.VertexArray=t.UnifiedBuffer=t.TextureCube=t.Texture2DArray=t.Texture3D=t.Texture2D=t.Shader=t.LoadingStatus=t.Renderer=t.Renderbuffer=t.Program=t.Geometry=t.Framebuffer=t.DefaultFramebuffer=t.ColorScale=t.Color=t.Buffer=t.EventHandler=t.PointerEventProvider=t.TouchEventProvider=t.MouseEventProvider=t.ChangeLookup=t.ExtensionsHash=t.ContextMasquerade=t.Initializable=t.Controller=t.Canvas=t.Context=t.version=t.commit=t.branch=void 0,t.tuples=t.gl_matrix_extensions=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.vec4=t.vec3=t.vec2=t.auxiliaries=t.FrameCapture=t.EyeGazeData=t.EyeGazeEventProvider=t.EyeGazeDataStreams=t.EyeGazeDataStream=t.ShadowPass=t.GaussFilter=t.ReadbackPass=t.EnvironmentTextureType=t.EnvironmentRenderingPass=t.DebugPass=t.BlitPass=t.AccumulatePass=t.KernelUI8=t.KernelUI32=t.KernelI8=t.KernelI32=void 0;var d=i(4536);Object.defineProperty(t,"branch",{enumerable:!0,get:function(){return d.branch}}),Object.defineProperty(t,"commit",{enumerable:!0,get:function(){return d.commit}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return d.version}});var h=i(2527);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return h.Context}});var s=i(7858);Object.defineProperty(t,"Canvas",{enumerable:!0,get:function(){return s.Canvas}});var u=i(8234);Object.defineProperty(t,"Controller",{enumerable:!0,get:function(){return u.Controller}});var o=i(4127);Object.defineProperty(t,"Initializable",{enumerable:!0,get:function(){return o.Initializable}});var m=i(5557);Object.defineProperty(t,"ContextMasquerade",{enumerable:!0,get:function(){return m.ContextMasquerade}});var _=i(5060);Object.defineProperty(t,"ExtensionsHash",{enumerable:!0,get:function(){return _.ExtensionsHash}});var p=i(7564);Object.defineProperty(t,"ChangeLookup",{enumerable:!0,get:function(){return p.ChangeLookup}});var b=i(4602);Object.defineProperty(t,"MouseEventProvider",{enumerable:!0,get:function(){return b.MouseEventProvider}});var x=i(8870);Object.defineProperty(t,"TouchEventProvider",{enumerable:!0,get:function(){return x.TouchEventProvider}});var E=i(8216);Object.defineProperty(t,"PointerEventProvider",{enumerable:!0,get:function(){return E.PointerEventProvider}});var w=i(2);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return w.EventHandler}});var S=i(7340);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return S.Buffer}});var R=i(3847);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return R.Color}});var O=i(5837);Object.defineProperty(t,"ColorScale",{enumerable:!0,get:function(){return O.ColorScale}});var I=i(8386);Object.defineProperty(t,"DefaultFramebuffer",{enumerable:!0,get:function(){return I.DefaultFramebuffer}});var D=i(8215);Object.defineProperty(t,"Framebuffer",{enumerable:!0,get:function(){return D.Framebuffer}});var j=i(638);Object.defineProperty(t,"Geometry",{enumerable:!0,get:function(){return j.Geometry}});var k=i(4168);Object.defineProperty(t,"Program",{enumerable:!0,get:function(){return k.Program}});var G=i(8400);Object.defineProperty(t,"Renderbuffer",{enumerable:!0,get:function(){return G.Renderbuffer}});var Z=i(3105);Object.defineProperty(t,"Renderer",{enumerable:!0,get:function(){return Z.Renderer}}),Object.defineProperty(t,"LoadingStatus",{enumerable:!0,get:function(){return Z.LoadingStatus}});var K=i(771);Object.defineProperty(t,"Shader",{enumerable:!0,get:function(){return K.Shader}});var Y=i(8593);Object.defineProperty(t,"Texture2D",{enumerable:!0,get:function(){return Y.Texture2D}});var re=i(9584);Object.defineProperty(t,"Texture3D",{enumerable:!0,get:function(){return re.Texture3D}});var Q=i(7380);Object.defineProperty(t,"Texture2DArray",{enumerable:!0,get:function(){return Q.Texture2DArray}});var ae=i(5186);Object.defineProperty(t,"TextureCube",{enumerable:!0,get:function(){return ae.TextureCube}});var se=i(216);Object.defineProperty(t,"UnifiedBuffer",{enumerable:!0,get:function(){return se.UnifiedBuffer}});var ee=i(5507);Object.defineProperty(t,"VertexArray",{enumerable:!0,get:function(){return ee.VertexArray}});var le=i(9217);Object.defineProperty(t,"Wizard",{enumerable:!0,get:function(){return le.Wizard}});var ge=i(3025);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return ge.Camera}});var ve=i(5608);Object.defineProperty(t,"TileCameraGenerator",{enumerable:!0,get:function(){return ve.TileCameraGenerator}});var ne=i(7344);Object.defineProperty(t,"CameraModifier",{enumerable:!0,get:function(){return ne.CameraModifier}});var be=i(4264);Object.defineProperty(t,"Navigation",{enumerable:!0,get:function(){return be.Navigation}});var Te=i(4850);Object.defineProperty(t,"FirstPersonModifier",{enumerable:!0,get:function(){return Te.FirstPersonModifier}});var oe=i(506);Object.defineProperty(t,"PanModifier",{enumerable:!0,get:function(){return oe.PanModifier}});var me=i(2010);Object.defineProperty(t,"PointerLock",{enumerable:!0,get:function(){return me.PointerLock}});var Ee=i(3151);Object.defineProperty(t,"TrackballModifier",{enumerable:!0,get:function(){return Ee.TrackballModifier}});var Oe=i(9184);Object.defineProperty(t,"TurntableModifier",{enumerable:!0,get:function(){return Oe.TurntableModifier}});var xe=i(5222);Object.defineProperty(t,"PinchZoomModifier",{enumerable:!0,get:function(){return xe.PinchZoomModifier}});var ke=i(7137);Object.defineProperty(t,"WheelZoomModifier",{enumerable:!0,get:function(){return ke.WheelZoomModifier}});var Le=i(8596);Object.defineProperty(t,"CanvasRecorder",{enumerable:!0,get:function(){return Le.CanvasRecorder}});var Re=i(5491);Object.defineProperty(t,"NdcFillingRectangle",{enumerable:!0,get:function(){return Re.NdcFillingRectangle}});var Ye=i(1896);Object.defineProperty(t,"NdcFillingTriangle",{enumerable:!0,get:function(){return Ye.NdcFillingTriangle}});var qe=i(4287);Object.defineProperty(t,"AbstractKernel",{enumerable:!0,get:function(){return qe.AbstractKernel}});var rt=i(2419);Object.defineProperty(t,"AntiAliasingKernel",{enumerable:!0,get:function(){return rt.AntiAliasingKernel}});var ht=i(3039);Object.defineProperty(t,"RandomSquareKernel",{enumerable:!0,get:function(){return ht.RandomSquareKernel}});var $e=i(4287);Object.defineProperty(t,"KernelF32",{enumerable:!0,get:function(){return $e.KernelF32}}),Object.defineProperty(t,"KernelI32",{enumerable:!0,get:function(){return $e.KernelI32}}),Object.defineProperty(t,"KernelI8",{enumerable:!0,get:function(){return $e.KernelI8}}),Object.defineProperty(t,"KernelUI32",{enumerable:!0,get:function(){return $e.KernelUI32}}),Object.defineProperty(t,"KernelUI8",{enumerable:!0,get:function(){return $e.KernelUI8}});var Me=i(9017);Object.defineProperty(t,"AccumulatePass",{enumerable:!0,get:function(){return Me.AccumulatePass}});var Be=i(8196);Object.defineProperty(t,"BlitPass",{enumerable:!0,get:function(){return Be.BlitPass}});var yt=i(3334);Object.defineProperty(t,"DebugPass",{enumerable:!0,get:function(){return yt.DebugPass}});var we=i(6464);Object.defineProperty(t,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return we.EnvironmentRenderingPass}}),Object.defineProperty(t,"EnvironmentTextureType",{enumerable:!0,get:function(){return we.EnvironmentTextureType}});var At=i(1900);Object.defineProperty(t,"ReadbackPass",{enumerable:!0,get:function(){return At.ReadbackPass}});var dt=i(3395);Object.defineProperty(t,"GaussFilter",{enumerable:!0,get:function(){return dt.GaussFilter}});var Et=i(9011);Object.defineProperty(t,"ShadowPass",{enumerable:!0,get:function(){return Et.ShadowPass}});var ft=i(3404);Object.defineProperty(t,"EyeGazeDataStream",{enumerable:!0,get:function(){return ft.EyeGazeDataStream}}),Object.defineProperty(t,"EyeGazeDataStreams",{enumerable:!0,get:function(){return ft.EyeGazeDataStreams}});var mt=i(3975);Object.defineProperty(t,"EyeGazeEventProvider",{enumerable:!0,get:function(){return mt.EyeGazeEventProvider}});var gt=i(6662);Object.defineProperty(t,"EyeGazeData",{enumerable:!0,get:function(){return gt.EyeGazeData}});var tt=i(1215);Object.defineProperty(t,"FrameCapture",{enumerable:!0,get:function(){return tt.FrameCapture}}),c(i(1854),t),c(i(5315),t),c(i(1058),t);const zt=f(i(9504));t.auxiliaries=zt;var Qe=i(3557);Object.defineProperty(t,"vec2",{enumerable:!0,get:function(){return Qe.vec2}}),Object.defineProperty(t,"vec3",{enumerable:!0,get:function(){return Qe.vec3}}),Object.defineProperty(t,"vec4",{enumerable:!0,get:function(){return Qe.vec4}});var Rt=i(3557);Object.defineProperty(t,"mat2",{enumerable:!0,get:function(){return Rt.mat2}}),Object.defineProperty(t,"mat2d",{enumerable:!0,get:function(){return Rt.mat2d}}),Object.defineProperty(t,"mat3",{enumerable:!0,get:function(){return Rt.mat3}}),Object.defineProperty(t,"mat4",{enumerable:!0,get:function(){return Rt.mat4}});var Gt=i(3557);Object.defineProperty(t,"quat",{enumerable:!0,get:function(){return Gt.quat}});const Nr=f(i(5150));t.gl_matrix_extensions=Nr;const zr=f(i(2813));t.tuples=zr},8184:function(v,t,i){var n=this&&this.__createBinding||(Object.create?function(p,b,x,E){E===void 0&&(E=x);var w=Object.getOwnPropertyDescriptor(b,x);w&&!("get"in w?!b.__esModule:w.writable||w.configurable)||(w={enumerable:!0,get:function(){return b[x]}}),Object.defineProperty(p,E,w)}:function(p,b,x,E){E===void 0&&(E=x),p[E]=b[x]}),r=this&&this.__setModuleDefault||(Object.create?function(p,b){Object.defineProperty(p,"default",{enumerable:!0,value:b})}:function(p,b){p.default=b}),c=this&&this.__exportStar||function(p,b){for(var x in p)x==="default"||Object.prototype.hasOwnProperty.call(b,x)||n(b,p,x)},f=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var b={};if(p!=null)for(var x in p)x!=="default"&&Object.prototype.hasOwnProperty.call(p,x)&&n(b,p,x);return r(b,p),b};Object.defineProperty(t,"__esModule",{value:!0}),t.viewer=t.Benchmark=t.ray_math=t.fetch=t.properties=void 0,c(i(5109),t),c(i(8892),t);const d=f(i(1407));t.properties=d;const h=f(i(64));t.fetch=h;const s=f(i(8962));t.ray_math=s;var u=i(8263);Object.defineProperty(t,"Benchmark",{enumerable:!0,get:function(){return u.Benchmark}}),c(i(2016),t);const o=f(i(7645)),m=f(i(6378));var _;(function(p){p.EventBlocker=o.EventBlocker,p.Fullscreen=m.Fullscreen})(_||(t.viewer=_={}))},7137:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WheelZoomModifier=void 0;const n=i(3557),r=i(5150),c=i(7344);class f extends c.CameraModifier{constructor(){super(...arguments),this._sensitivity=f.DEFAULT_SENSITIVITY,this._translation=(0,r.v3)()}process(h){Object.assign(this._reference,this._camera);const s=h*this._sensitivity,u=n.vec3.sub((0,r.v3)(),this._reference.center,this._reference.eye);n.vec3.normalize(u,u),this._translation=n.vec3.scale((0,r.v3)(),u,s),this.update()}update(){if(this._camera===void 0)return;const h=n.mat4.fromTranslation((0,r.m4)(),this._translation),s=n.vec3.transformMat4((0,r.v3)(),this._reference.eye,h);this._camera.eye=s}}t.WheelZoomModifier=f,f.DEFAULT_SENSITIVITY=.002},9217:(v,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wizard=void 0;const n=i(9504);class r{static queryPrecisionSupport(f,d){const h=f.gl,s=f.gl2facade,u=f.isWebGL1&&f.supportsTextureFloat||f.isWebGL2&&f.supportsColorBufferFloat,o=f.isWebGL1&&f.supportsTextureHalfFloat||f.isWebGL2&&f.supportsColorBufferFloat;let m=d;return d in r.Precision||((0,n.log)(n.LogLevel.Warning,`unknown precision '${m}' changed to '${r.Precision.auto}'`),d=r.Precision.auto),d===r.Precision.auto&&(m=u?r.Precision.float:o?r.Precision.half:r.Precision.byte),m===r.Precision.half&&o?(f.isWebGL2?f.colorBufferFloat:f.textureHalfFloat,[m,s.HALF_FLOAT,1]):m!==r.Precision.float&&m!==r.Precision.half||!u?[m,h.UNSIGNED_BYTE,2]:(f.isWebGL2?f.colorBufferFloat:f.textureFloat,[m,h.FLOAT,0])}static queryInternalTextureFormat(f,d,h=r.Precision.auto){const[s,u,o]=this.queryPrecisionSupport(f,h),m=f.gl;if(f.isWebGL1)return(0,n.assert)([m.RGB,m.RGBA].includes(d),"target must be gl.RGB or gl.RGBA in WebGL 1"),[d,u,s];switch(d){case m.RGBA:return[[m.RGBA32F,m.RGBA16F,m.RGBA8][o],u,s];case m.RGB:return[[m.RGB32F,m.RGB16F,m.RGB8][o],u,s];case m.RG:return[[m.RG32F,m.RG16F,m.RG8][o],u,s];case m.RED:return[[m.R32F,m.R16F,m.R8][o],u,s];default:(0,n.assert)(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[m.NONE,m.NONE,s]}}t.Wizard=r,function(c){(function(f){f.float="float",f.half="half",f.byte="byte",f.auto="auto"})(c.Precision||(c.Precision={}))}(r||(t.Wizard=r={}))},9983:(v,t,i)=>{var n=i(6751);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var c=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),s=["'"].concat(h),u=["%","/","?",";","#"].concat(s),o=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=i(8985);function w(S,R,O){if(S&&typeof S=="object"&&S instanceof r)return S;var I=new r;return I.parse(S,R,O),I}r.prototype.parse=function(S,R,O){if(typeof S!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof S);var I=S.indexOf("?"),D=I!==-1&&I<S.indexOf("#")?"?":"#",j=S.split(D);j[0]=j[0].replace(/\\/g,"/");var k=S=j.join(D);if(k=k.trim(),!O&&S.split("#").length===1){var G=d.exec(k);if(G)return this.path=k,this.href=k,this.pathname=G[1],G[2]?(this.search=G[2],this.query=R?E.parse(this.search.substr(1)):this.search.substr(1)):R&&(this.search="",this.query={}),this}var Z=c.exec(k);if(Z){var K=(Z=Z[0]).toLowerCase();this.protocol=K,k=k.substr(Z.length)}if(O||Z||k.match(/^\/\/[^@/]+@[^@/]+/)){var Y=k.substr(0,2)==="//";!Y||Z&&b[Z]||(k=k.substr(2),this.slashes=!0)}if(!b[Z]&&(Y||Z&&!x[Z])){for(var re,Q,ae=-1,se=0;se<o.length;se++)(ee=k.indexOf(o[se]))!==-1&&(ae===-1||ee<ae)&&(ae=ee);for((Q=ae===-1?k.lastIndexOf("@"):k.lastIndexOf("@",ae))!==-1&&(re=k.slice(0,Q),k=k.slice(Q+1),this.auth=decodeURIComponent(re)),ae=-1,se=0;se<u.length;se++){var ee;(ee=k.indexOf(u[se]))!==-1&&(ae===-1||ee<ae)&&(ae=ee)}ae===-1&&(ae=k.length),this.host=k.slice(0,ae),k=k.slice(ae),this.parseHost(),this.hostname=this.hostname||"";var le=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!le)for(var ge=this.hostname.split(/\./),ve=(se=0,ge.length);se<ve;se++){var ne=ge[se];if(ne&&!ne.match(m)){for(var be="",Te=0,oe=ne.length;Te<oe;Te++)ne.charCodeAt(Te)>127?be+="x":be+=ne[Te];if(!be.match(m)){var me=ge.slice(0,se),Ee=ge.slice(se+1),Oe=ne.match(_);Oe&&(me.push(Oe[1]),Ee.unshift(Oe[2])),Ee.length&&(k="/"+Ee.join(".")+k),this.hostname=me.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),le||(this.hostname=n.toASCII(this.hostname));var xe=this.port?":"+this.port:"",ke=this.hostname||"";this.host=ke+xe,this.href+=this.host,le&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),k[0]!=="/"&&(k="/"+k))}if(!p[K])for(se=0,ve=s.length;se<ve;se++){var Le=s[se];if(k.indexOf(Le)!==-1){var Re=encodeURIComponent(Le);Re===Le&&(Re=escape(Le)),k=k.split(Le).join(Re)}}var Ye=k.indexOf("#");Ye!==-1&&(this.hash=k.substr(Ye),k=k.slice(0,Ye));var qe=k.indexOf("?");if(qe!==-1?(this.search=k.substr(qe),this.query=k.substr(qe+1),R&&(this.query=E.parse(this.query)),k=k.slice(0,qe)):R&&(this.search="",this.query={}),k&&(this.pathname=k),x[K]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){xe=this.pathname||"";var rt=this.search||"";this.path=xe+rt}return this.href=this.format(),this},r.prototype.format=function(){var S=this.auth||"";S&&(S=(S=encodeURIComponent(S)).replace(/%3A/i,":"),S+="@");var R=this.protocol||"",O=this.pathname||"",I=this.hash||"",D=!1,j="";this.host?D=S+this.host:this.hostname&&(D=S+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(D+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(j=E.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var k=this.search||j&&"?"+j||"";return R&&R.substr(-1)!==":"&&(R+=":"),this.slashes||(!R||x[R])&&D!==!1?(D="//"+(D||""),O&&O.charAt(0)!=="/"&&(O="/"+O)):D||(D=""),I&&I.charAt(0)!=="#"&&(I="#"+I),k&&k.charAt(0)!=="?"&&(k="?"+k),R+D+(O=O.replace(/[?#]/g,function(G){return encodeURIComponent(G)}))+(k=k.replace("#","%23"))+I},r.prototype.resolve=function(S){return this.resolveObject(w(S,!1,!0)).format()},r.prototype.resolveObject=function(S){if(typeof S=="string"){var R=new r;R.parse(S,!1,!0),S=R}for(var O=new r,I=Object.keys(this),D=0;D<I.length;D++){var j=I[D];O[j]=this[j]}if(O.hash=S.hash,S.href==="")return O.href=O.format(),O;if(S.slashes&&!S.protocol){for(var k=Object.keys(S),G=0;G<k.length;G++){var Z=k[G];Z!=="protocol"&&(O[Z]=S[Z])}return x[O.protocol]&&O.hostname&&!O.pathname&&(O.pathname="/",O.path=O.pathname),O.href=O.format(),O}if(S.protocol&&S.protocol!==O.protocol){if(!x[S.protocol]){for(var K=Object.keys(S),Y=0;Y<K.length;Y++){var re=K[Y];O[re]=S[re]}return O.href=O.format(),O}if(O.protocol=S.protocol,S.host||b[S.protocol])O.pathname=S.pathname;else{for(var Q=(S.pathname||"").split("/");Q.length&&!(S.host=Q.shift()););S.host||(S.host=""),S.hostname||(S.hostname=""),Q[0]!==""&&Q.unshift(""),Q.length<2&&Q.unshift(""),O.pathname=Q.join("/")}if(O.search=S.search,O.query=S.query,O.host=S.host||"",O.auth=S.auth,O.hostname=S.hostname||S.host,O.port=S.port,O.pathname||O.search){var ae=O.pathname||"",se=O.search||"";O.path=ae+se}return O.slashes=O.slashes||S.slashes,O.href=O.format(),O}var ee=O.pathname&&O.pathname.charAt(0)==="/",le=S.host||S.pathname&&S.pathname.charAt(0)==="/",ge=le||ee||O.host&&S.pathname,ve=ge,ne=O.pathname&&O.pathname.split("/")||[],be=(Q=S.pathname&&S.pathname.split("/")||[],O.protocol&&!x[O.protocol]);if(be&&(O.hostname="",O.port=null,O.host&&(ne[0]===""?ne[0]=O.host:ne.unshift(O.host)),O.host="",S.protocol&&(S.hostname=null,S.port=null,S.host&&(Q[0]===""?Q[0]=S.host:Q.unshift(S.host)),S.host=null),ge=ge&&(Q[0]===""||ne[0]==="")),le)O.host=S.host||S.host===""?S.host:O.host,O.hostname=S.hostname||S.hostname===""?S.hostname:O.hostname,O.search=S.search,O.query=S.query,ne=Q;else if(Q.length)ne||(ne=[]),ne.pop(),ne=ne.concat(Q),O.search=S.search,O.query=S.query;else if(S.search!=null)return be&&(O.host=ne.shift(),O.hostname=O.host,(Oe=!!(O.host&&O.host.indexOf("@")>0)&&O.host.split("@"))&&(O.auth=Oe.shift(),O.hostname=Oe.shift(),O.host=O.hostname)),O.search=S.search,O.query=S.query,O.pathname===null&&O.search===null||(O.path=(O.pathname?O.pathname:"")+(O.search?O.search:"")),O.href=O.format(),O;if(!ne.length)return O.pathname=null,O.search?O.path="/"+O.search:O.path=null,O.href=O.format(),O;for(var Te=ne.slice(-1)[0],oe=(O.host||S.host||ne.length>1)&&(Te==="."||Te==="..")||Te==="",me=0,Ee=ne.length;Ee>=0;Ee--)(Te=ne[Ee])==="."?ne.splice(Ee,1):Te===".."?(ne.splice(Ee,1),me++):me&&(ne.splice(Ee,1),me--);if(!ge&&!ve)for(;me--;me)ne.unshift("..");!ge||ne[0]===""||ne[0]&&ne[0].charAt(0)==="/"||ne.unshift(""),oe&&ne.join("/").substr(-1)!=="/"&&ne.push("");var Oe,xe=ne[0]===""||ne[0]&&ne[0].charAt(0)==="/";return be&&(O.hostname=xe?"":ne.length?ne.shift():"",O.host=O.hostname,(Oe=!!(O.host&&O.host.indexOf("@")>0)&&O.host.split("@"))&&(O.auth=Oe.shift(),O.hostname=Oe.shift(),O.host=O.hostname)),(ge=ge||O.host&&ne.length)&&!xe&&ne.unshift(""),ne.length>0?O.pathname=ne.join("/"):(O.pathname=null,O.path=null),O.pathname===null&&O.search===null||(O.path=(O.pathname?O.pathname:"")+(O.search?O.search:"")),O.auth=S.auth||O.auth,O.slashes=O.slashes||S.slashes,O.href=O.format(),O},r.prototype.parseHost=function(){var S=this.host,R=f.exec(S);R&&((R=R[0])!==":"&&(this.port=R.substr(1)),S=S.substr(0,S.length-R.length)),S&&(this.hostname=S)},t.parse=w,t.resolve=function(S,R){return w(S,!1,!0).resolve(R)},t.resolveObject=function(S,R){return S?w(S,!1,!0).resolveObject(R):R},t.format=function(S){return typeof S=="string"&&(S=w(S)),S instanceof r?S.format():r.prototype.format.call(S)},t.Url=r},6296:v=>{v.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
    #extension GL_OES_standard_derivatives : enable\r
#else \r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
uniform int u_frameNumber;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r
    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r
\r
    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r
    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r
    if(!any(bvec2(cstep))) {\r
        discard;\r
    }\r
    fragColor = vec4(color, 1.0); \r
}\r
`},5077:v=>{v.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else \r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec2 u_ndcOffset;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex.xy * 0.5 + 0.5;\r
\r
    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r
    ndcOffset(vertex, u_ndcOffset);\r
\r
    gl_Position = vertex;\r
}\r
`},5347:v=>{v.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
// References:\r
// [1] Real Shading in Unreal Engine 4\r
//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r
// [2] Physically Based Shading at Disney\r
//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r
// [3] README.md - Environment Maps\r
//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r
// [4] "An Inexpensive BRDF Model for Physically based Rendering" by Christophe Schlick\r
//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
const int USE_IBL               = 1 << 4;\r
const int HAS_BASECOLORMAP      = 1 << 5;\r
const int HAS_NORMALMAP         = 1 << 6;\r
const int HAS_EMISSIVEMAP       = 1 << 7;\r
const int HAS_METALROUGHNESSMAP = 1 << 8;\r
const int HAS_OCCLUSIONMAP      = 1 << 9;\r
const int USE_TEX_LOD           = 1 << 10;\r
\r
const vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\r
const vec3 u_LightColor = vec3(1, 1, 1);\r
\r
const float M_PI = 3.141592653589793;\r
const float c_MinRoughness = 0.04;\r
\r
uniform sampler2D u_baseColor;\r
uniform sampler2D u_metallicRoughness;\r
uniform sampler2D u_normal;\r
uniform sampler2D u_emissive;\r
uniform sampler2D u_occlusion;\r
\r
uniform samplerCube u_specularEnvironment;\r
uniform sampler2D u_brdfLUT;\r
\r
uniform int u_baseColorTexCoord;\r
uniform int u_normalTexCoord;\r
uniform int u_metallicRoughnessTexCoord;\r
uniform int u_occlusionTexCoord;\r
uniform int u_emissiveTexCoord;\r
\r
uniform vec4 u_baseColorFactor;\r
uniform float u_metallicFactor;\r
uniform float u_roughnessFactor;\r
uniform vec3 u_emissiveFactor;\r
uniform float u_normalScale;\r
uniform int u_blendMode;\r
uniform float u_blendCutoff;\r
\r
uniform mediump int u_geometryFlags;\r
uniform mediump int u_pbrFlags;\r
uniform vec3 u_eye;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
// Encapsulate the various inputs used by the various functions in the shading equation\r
// We store values in this struct to simplify the integration of alternative implementations\r
// of the shading terms, outlined in the Readme.MD Appendix.\r
struct PBRInfo\r
{\r
    float NdotL;                  // cos angle between normal and light direction\r
    float NdotV;                  // cos angle between normal and view direction\r
    float NdotH;                  // cos angle between normal and half vector\r
    float LdotH;                  // cos angle between light direction and half vector\r
    float VdotH;                  // cos angle between view direction and half vector\r
    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r
    float metalness;              // metallic value at the surface\r
    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r
    vec3 reflectance90;           // reflectance color at grazing angle\r
    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r
    vec3 diffuseColor;            // color contribution from diffuse lighting\r
    vec3 specularColor;           // color contribution from specular lighting\r
};\r
\r
bool checkGeometryFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
bool checkFlag(int flag) {\r
    return (u_pbrFlags & flag) == flag;\r
}\r
\r
vec4 SRGBtoLINEAR(vec4 srgbIn)\r
{\r
    #ifdef MANUAL_SRGB\r
    #ifdef SRGB_FAST_APPROXIMATION\r
    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r
    #else //SRGB_FAST_APPROXIMATION\r
    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r
    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r
    #endif //SRGB_FAST_APPROXIMATION\r
    return vec4(linOut,srgbIn.w);;\r
    #else //MANUAL_SRGB\r
    return srgbIn;\r
    #endif //MANUAL_SRGB\r
}\r
\r
// Find the normal for this fragment, pulling either from a predefined normal map\r
// or from the interpolated mesh normal and tangent attributes.\r
vec3 getNormal()\r
{\r
    // Retrieve the tangent space matrix\r
    mat3 tbn;\r
    if (!checkGeometryFlag(HAS_TANGENTS)) {\r
        vec3 pos_dx = dFdx(v_position);\r
        vec3 pos_dy = dFdy(v_position);\r
        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\r
        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\r
        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r
\r
        vec3 ng;\r
        if (checkGeometryFlag(HAS_NORMALS))\r
            ng = normalize(v_normal);\r
        else\r
            ng = cross(pos_dx, pos_dy);\r
\r
            t = normalize(t - ng * dot(ng, t));\r
            vec3 b = normalize(cross(ng, t));\r
            tbn = mat3(t, b, ng);\r
        }\r
    else { // HAS_TANGENTS\r
        tbn = v_TBN;\r
    }\r
\r
    vec3 n;\r
    if (checkFlag(HAS_NORMALMAP)) {\r
        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\r
        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\r
    } else {\r
        // The tbn matrix is linearly interpolated, so we need to re-normalize\r
        n = normalize(tbn[2].xyz);\r
    }\r
\r
    // reverse backface normals\r
    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r
\r
    return n;\r
}\r
\r
// Basic Lambertian diffuse\r
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r
// See also [1], Equation 1\r
vec3 diffuse(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.diffuseColor / M_PI;\r
}\r
\r
 // The following equation models the Fresnel reflectance term of the spec equation (aka F())\r
// Implementation of fresnel from [4], Equation 15\r
vec3 specularReflection(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r
}\r
\r
 // This calculates the specular geometric attenuation (aka G()),\r
// where rougher material will reflect less light back to the viewer.\r
// This implementation is based on [1] Equation 4, and we adopt their modifications to\r
// alphaRoughness as input as originally proposed in [2].\r
float geometricOcclusion(PBRInfo pbrInputs)\r
{\r
    float NdotL = pbrInputs.NdotL;\r
    float NdotV = pbrInputs.NdotV;\r
    float r = pbrInputs.alphaRoughness;\r
\r
    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r
    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r
    return attenuationL * attenuationV;\r
}\r
\r
 // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r
// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\r
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r
float microfacetDistribution(PBRInfo pbrInputs)\r
{\r
    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r
    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r
    return roughnessSq / (M_PI * f * f);\r
}\r
\r
vec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\r
{\r
    float NdotV = clamp(dot(n, v), 0.0, 1.0);\r
\r
    // TODO: pass uniform for mip count\r
    const float MIP_COUNT = 8.0;\r
    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\r
    vec3 reflection = normalize(reflect(-v, n));\r
\r
    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\r
    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\r
\r
    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\r
    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\r
\r
    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\r
    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\r
\r
    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\r
    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\r
\r
    return specular;\r
    // return diffuse + specular;\r
}\r
\r
void main(void)\r
{\r
    float perceptualRoughness = u_roughnessFactor;\r
    float metallic = u_metallicFactor;\r
    if (checkFlag(HAS_METALROUGHNESSMAP)) {\r
        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r
        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r
        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\r
        perceptualRoughness = mrSample.g * perceptualRoughness;\r
        metallic = mrSample.b * metallic;\r
    }\r
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r
    metallic = clamp(metallic, 0.0, 1.0);\r
    // Roughness is authored as perceptual roughness; as is convention,\r
    // convert to material roughness by squaring the perceptual roughness [2].\r
    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r
\r
     // The albedo may be defined from a base texture or a flat color\r
    vec4 baseColor;\r
    if (checkFlag(HAS_BASECOLORMAP)) {\r
        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\r
    } else {\r
        baseColor = u_baseColorFactor;\r
    }\r
\r
    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r
    // TODO!: distinguish vec3/vec4 colors...\r
    baseColor *= vec4(v_color.rgb, 1.0);\r
\r
    vec3 f0 = vec3(0.04);\r
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r
    diffuseColor *= 1.0 - metallic;\r
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r
\r
    // Compute reflectance.\r
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r
\r
    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r
    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r
    vec3 specularEnvironmentR0 = specularColor.rgb;\r
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r
\r
    vec3 n = getNormal();                         // normal at surface point\r
    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\r
    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\r
    vec3 h = normalize(l+v);                       // Half vector between both l and v\r
    vec3 reflection = -normalize(reflect(v, n));\r
\r
    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r
    float NdotV = abs(dot(n, v)) + 0.001;\r
    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r
    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r
    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r
\r
    PBRInfo pbrInputs = PBRInfo(\r
        NdotL,\r
        NdotV,\r
        NdotH,\r
        LdotH,\r
        VdotH,\r
        perceptualRoughness,\r
        metallic,\r
        specularEnvironmentR0,\r
        specularEnvironmentR90,\r
        alphaRoughness,\r
        diffuseColor,\r
        specularColor\r
    );\r
\r
     // Calculate the shading terms for the microfacet specular shading model\r
    vec3 F = specularReflection(pbrInputs);\r
    float G = geometricOcclusion(pbrInputs);\r
    float D = microfacetDistribution(pbrInputs);\r
\r
     // Calculation of analytical lighting contribution\r
    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r
    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r
    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r
    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r
\r
    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\r
    color += environmentLight;\r
\r
    if (checkFlag(HAS_EMISSIVEMAP)) {\r
        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\r
        color += emissive;\r
    }\r
\r
    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r
    float alpha = 1.0;\r
    if (u_blendMode == 1) {\r
        if (baseColor.a < u_blendCutoff) {\r
            discard;\r
        }\r
    }\r
    else if (u_blendMode == 2) {\r
        alpha = baseColor.a;\r
    }\r
\r
    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\r
}\r
`},6626:v=>{v.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
\r
#if __VERSION__ == 100\r
    attribute vec4 a_position;\r
    attribute vec4 a_normal;\r
    attribute vec4 a_tangent;\r
    attribute vec2 a_texcoord_0;\r
    attribute vec2 a_texcoord_1;\r
    attribute vec2 a_texcoord_2;\r
    attribute vec4 a_joints;\r
    attribute vec4 a_weights;\r
    attribute vec4 a_color;\r
#else\r
    layout (location = 0) in vec4 a_position;\r
    layout (location = 1) in vec3 a_normal;\r
    layout (location = 2) in vec4 a_tangent;\r
    layout (location = 3) in vec2 a_texcoord_0;\r
    layout (location = 4) in vec2 a_texcoord_1;\r
    layout (location = 5) in vec2 a_texcoord_2;\r
    layout (location = 6) in vec4 a_joints;\r
    layout (location = 7) in vec4 a_weights;\r
    layout (location = 8) in vec4 a_color;\r
#endif\r
\r
uniform mat4 u_model;\r
uniform mat4 u_viewProjection;\r
uniform mat3 u_normalMatrix;\r
\r
uniform mediump int u_geometryFlags;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
bool checkFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
void main(void)\r
{\r
    vec4 pos = u_model * a_position;\r
    v_position = vec3(pos.xyz) / pos.w;\r
\r
    if (checkFlag(HAS_NORMALS)) {\r
        if (checkFlag(HAS_TANGENTS)) {\r
            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\r
            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\r
            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r
            v_TBN = mat3(tangentW, bitangentW, normalW);\r
        } else { // HAS_TANGENTS != 1\r
            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\r
        }\r
    }\r
\r
    if (checkFlag(HAS_UV)) {\r
        v_uv[0] = a_texcoord_0;\r
        v_uv[1] = a_texcoord_1;\r
        v_uv[2] = a_texcoord_2;\r
    } else {\r
        v_uv[0] = vec2(0., 0.);\r
        v_uv[1] = vec2(0., 0.);\r
        v_uv[2] = vec2(0., 0.);\r
    }\r
\r
    if (checkFlag(HAS_COLORS)) {\r
        v_color = a_color;\r
    } else {\r
        v_color = vec4(1.0);\r
    }\r
\r
    gl_Position = u_viewProjection * u_model * a_position;\r
}\r
`},8058:v=>{v.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weight;\r
uniform sampler2D u_accumulationTexture;\r
uniform sampler2D u_currentFrameTexture;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r
    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r
    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r
}\r
`},6523:v=>{v.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    fragColor = texture(u_source, v_uv);\r
}\r
`},3354:v=>{v.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec4 u_srcBounds; // normalized\r
uniform vec4 u_dstBounds; // normalized\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = a_vertex * 0.5 + 0.5;\r
\r
    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\r
    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\r
}\r
`},8359:v=>{v.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
float linearizeDepth(float zInNDC, float near, float far) {\r
    float zLinear = 2.0 * near;\r
    zLinear /= far + near - zInNDC * (far - near);\r
    return zLinear;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
uniform int u_mode; /* Debug mode. */\r
uniform vec2 u_linearize; /* [ zNear, zFar ] */\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 source = texture(u_source, v_uv);\r
\r
    /* u_mode == 0                 None */\r
\r
    if(u_mode == 1) {           /* Depth */\r
        source.rgb = vec3(source[0]);\r
\r
    } else if (u_mode == 2) {   /* DepthLinear */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = vec3(zLinear);\r
\r
    } else if(u_mode == 3) {    /* DepthPacked */\r
        source.rgb = float24x1_to_uint8x3(source[0]);\r
\r
    } else if (u_mode == 4) {   /* DepthLinearPacked */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = float24x1_to_uint8x3(zLinear);\r
    }\r
\r
    fragColor = source;\r
}\r
`},9196:v=>{v.exports=`precision highp float;\r
precision highp int;\r
\r
/**\r
  To be replaced via Shader.replace();\r
 */\r
#define PROJECTION_TYPE\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform int u_mode;\r
uniform bool u_skipLod;\r
\r
#if defined(CUBE_MAP)\r
    uniform samplerCube u_cubemap;\r
#elif defined(EQUI_MAP)\r
    uniform sampler2D u_equirectmap;\r
#elif defined(SPHERE_MAP)\r
    uniform sampler2D u_spheremap;\r
#elif defined(POLAR_MAP)\r
    uniform sampler2D u_polarmap[2];\r
#endif\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
const float PI = 3.141592653589793;\r
const float OneOver2PI = 0.1591549430918953357688837633725;\r
const float OneOverPI  = 0.3183098861837906715377675267450;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = v_uv;\r
    vec3 ray = normalize(v_ray.xyz);\r
\r
    #if defined(CUBE_MAP)\r
        #if __VERSION__ == 100\r
            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\r
        #else\r
            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\r
        #endif\r
    #endif\r
\r
    #if defined(EQUI_MAP)\r
        float v = acos(-ray.y) * OneOverPI;\r
        float m = atan(-ray.x, ray.z);\r
        uv = vec2(m * OneOver2PI + 0.5, v);\r
\r
        fragColor = texture(u_equirectmap, uv);\r
    #endif\r
\r
    #if defined(SPHERE_MAP)\r
        ray = -ray.xzy;\r
        ray.y *= -1.0;\r
        ray.z += +1.0;\r
        uv = 0.5 + 0.5 * ray.xy / length(ray);\r
\r
        fragColor = texture(u_spheremap, uv);\r
    #endif\r
\r
    #if defined(POLAR_MAP)\r
        ray.xz /= abs(ray.y) + 1.0;\r
        ray.xz = ray.xz * 0.5 + 0.5;\r
        ray.x *= -1.0;\r
\r
        fragColor = mix(texture(u_polarmap[1], ray.xz),\r
                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\r
                        step(0.0, ray.y));\r
    #endif\r
}\r
`},3761:v=>{v.exports=`precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    in vec2 a_vertex;\r
#endif\r
\r
\r
uniform mat4 u_viewProjectionInverse;\r
\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\r
\r
    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\r
}\r
`},1687:v=>{v.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  #define fragColor gl_FragColor\r
#else\r
  layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weights[32];\r
uniform vec2 u_delta;\r
\r
uniform sampler2D u_texture;\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\r
    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\r
    {\r
        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\r
        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\r
    }\r
\r
    fragColor = result;\r
}\r
`},9214:v=>{v.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  attribute vec2 a_vertex;\r
#else\r
  layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    v_texCoords = a_vertex * 0.5 + 0.5;\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},9657:v=>{v.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},688:v=>{v.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragDepth gl_FragColor\r
#else \r
    layout(location = 0) out vec4 fragDepth;\r
#endif\r
\r
\r
uniform sampler2D u_texture;\r
uniform vec2 u_offset;\r
uniform vec2 u_scale;\r
\r
varying vec2 v_uv;\r
\r
\r
\r
void main(void)\r
{\r
    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r
    float depth = texture(u_texture, uv).r;\r
\r
    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r
}\r
`},5389:v=>{v.exports=`precision mediump float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
\r
    #ifdef GL_OES_standard_derivatives\r
        #extension GL_OES_standard_derivatives : enable\r
        #define AASTEP\r
    #endif\r
\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
\r
    #define AASTEP\r
\r
#endif\r
\r
\r
uniform sampler2D u_glyphs;\r
uniform vec4 u_color;\r
uniform float u_aaStepScale;\r
uniform int u_aaSampling;\r
\r
varying vec2 v_uv;\r
\r
const int channel = 0;\r
\r
\r
float aastep(float t, float value)\r
{\r
#ifdef AASTEP\r
    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\r
    float afwidth = fwidth(value) * u_aaStepScale;\r
    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\r
     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\r
     */\r
\r
    return smoothstep(t - afwidth, t + afwidth, value);\r
#else\r
    return step(t, value);\r
#endif\r
}\r
\r
float texStep(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return step(t, distanceValue);\r
}\r
\r
float texSmooth(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return aastep(t, distanceValue);\r
}\r
\r
#ifdef AASTEP\r
\r
float aastep3h(float t, vec2 uv)\r
{\r
    float x = dFdy(uv.x) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( -x, 0.0))\r
            + texSmooth(t, uv + vec2(0.0, 0.0))\r
            + texSmooth(t, uv + vec2( +x, 0.0));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3v(float t, vec2 uv)\r
{\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( 0.0,  -y))\r
            + texSmooth(t, uv + vec2( 0.0, 0.0))\r
            + texSmooth(t, uv + vec2( 0.0,  +y));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3x3(float t, vec2 uv)\r
{\r
    float x = dFdx(uv.x) * 1.0 / 3.0;\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\r
            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\r
            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\r
\r
    return v / 9.0;\r
}\r
\r
float aastep4x4(float t, vec2 uv)\r
{\r
    float x0 = dFdx(uv.x);\r
    float y0 = dFdx(uv.y);\r
    float x1 = x0 * 1.0 / 8.0;\r
    float y1 = y0 * 1.0 / 8.0;\r
    float x2 = x0 * 3.0 / 8.0;\r
    float y2 = y0 * 3.0 / 8.0;\r
\r
    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\r
            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\r
\r
            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\r
            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\r
            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\r
            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\r
\r
    return v / 16.0;\r
}\r
\r
// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\r
// {\r
//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\r
// }\r
\r
#endif\r
\r
void main(void)\r
{\r
    /** @todo mipmap access? */\r
\r
    float a = 0.0;\r
    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\r
#ifdef AASTEP\r
    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\r
#endif\r
\r
        a = texStep(0.5, v_uv);\r
\r
#ifdef AASTEP\r
    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\r
        a = texSmooth(0.5, v_uv);\r
    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\r
        a = aastep3h(0.5, v_uv);\r
    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\r
        a = aastep3v(0.5, v_uv);\r
    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\r
        a = aastep3x3(0.5, v_uv);\r
    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\r
        a = aastep4x4(0.5, v_uv);\r
    }\r
#endif\r
\r
    /**\r
     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\r
     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\r
     * it's bad for IMR, TBR, TBDR and early-Z optimization\r
     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\r
     */\r
    if(a <= 0.0) {\r
        discard;\r
    }\r
    fragColor = vec4(u_color.rgb, u_color.a * a);\r
\r
    /* use when pre-multiplied color is required. */\r
    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\r
}\r
`},1616:v=>{v.exports=`precision mediump float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
\r
#extension GL_EXT_draw_buffers : enable\r
attribute vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ] */\r
attribute vec4 a_texCoord;\r
attribute vec3 a_origin;\r
attribute vec3 a_tangent;\r
attribute vec3 a_up;\r
\r
#else\r
\r
in vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ]*/\r
in vec4 a_texCoord;\r
in vec3 a_origin;\r
in vec3 a_tangent;\r
in vec3 a_up;\r
\r
#endif\r
\r
\r
uniform mat4 u_viewProjection;\r
uniform vec2 u_ndcOffset;\r
uniform mat4 u_transform;\r
uniform bool u_dynamic;\r
\r
varying vec2 v_uv;\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
void main(void)\r
{\r
    /* TEXTURE COORDS */\r
\r
    /* flip y-coordinates */\r
    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\r
\r
    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\r
\r
    /* POSITIONING */\r
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\r
     * 2-------4\r
     * |  \\    |\r
     * |    \\  |\r
     * 1-------3\r
     * The current vertex is calculated based on the current quad corners and the tangent attributes.\r
     * The following lines are optimized for MAD optimization.\r
     */\r
    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\r
    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\r
\r
    if(u_dynamic) {\r
        vertex = u_transform * vertex;\r
    }\r
    vertex = u_viewProjection * vertex;\r
\r
    ndcOffset(vertex, u_ndcOffset);\r
    gl_Position = vertex;\r
}\r
`},7032:v=>{v.exports=j_()},421:v=>{v.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},3058:v=>{v.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},6399:v=>{v.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},9148:v=>{v.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},7857:v=>{v.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')}},a={};function g(v){var t=a[v];if(t!==void 0)return t.exports;var i=a[v]={exports:{}};return T[v].call(i.exports,i,i.exports,g),i.exports}g.d=(v,t)=>{for(var i in t)g.o(t,i)&&!g.o(v,i)&&Object.defineProperty(v,i,{enumerable:!0,get:t[i]})},g.o=(v,t)=>Object.prototype.hasOwnProperty.call(v,t),g.r=v=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(v,"__esModule",{value:!0})},g(4985);var y=g(8184);Xf.exports=y})();var N=Xf.exports;const j2=Ov(N),hb=Sv({__proto__:null,default:j2},[N]),nt=class nt{constructor(a,g,y){this._lastChild=nt.INVALID_INDEX,this.index=nt.INVALID_INDEX,this.id=nt.INVALID_ID,this.depth=nt.INVALID_DEPTH,this.parent=nt.INVALID_INDEX,this.firstChild=nt.INVALID_INDEX,this.initialFirstChild=nt.INVALID_INDEX,this.nextSibling=nt.INVALID_INDEX,this.initialNextSibling=nt.INVALID_INDEX,this.id=a,this.index=g,y!==void 0?(this.depth=y.depth+1,this.parent=y.index,y.initialFirstChild===nt.INVALID_INDEX&&(y.initialFirstChild=g,y.firstChild=g),y._lastChild=g):this.depth=0}get lastChild(){return this._lastChild}get isLeaf(){return this.firstChild===nt.INVALID_INDEX}get isRoot(){return this.parent===nt.INVALID_INDEX}};nt.INVALID_ID=-1,nt.INVALID_INDEX=-1,nt.INVALID_DEPTH=-1,nt.INVALID_HEIGHT=-1;let Xe=nt;class k2{constructor(){this._slices=[]}clear(){this._slices=[]}slice(a){if(!(a<0||a>=this._slices.length))return this._slices[a]}startSlice(a){this._slices.push([a,a])}endSlice(a){this._slices[this._slices.length-1][1]=a}nextSlice(a){this.endSlice(a-1),this.startSlice(a)}addSliceByRange(a,g){this._slices.push([a,g])}addSliceByLength(a){if(this.length===0){this._slices.push([0,a-1]);return}const g=this._slices[this._slices.length-1][1];this._slices.push([g+1,g+a])}sliceDo(a,g){if(a<0||a>=this._slices.length)return;const y=this._slices[a];g(y[0],y[1])}slicesDo(a){for(const g of this._slices)a(g[0],g[1])}get slices(){return this._slices}get numberOfInnerNodes(){return this._slices[this._slices.length-1][0]}get numberOfLeafNodes(){return this.numberOfNodes-this.numberOfInnerNodes}get numberOfNodes(){return this._slices[this._slices.length-1][1]+1}get length(){return this._slices.length}}const Ht=N.auxiliaries.assert;class bt{constructor(){this._linearization=new k2,this._nodes=new Array,this._innerNodeIndicesById=new Map,this._leafNodeIndicesById=new Map,this._edgeIndexToTopologyIndexMap=new Array,this._topologyIndexToEdgeIndexMap=new Array}fromInterleavedEdgesIdById(a){Ht(a.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const g=new Array,y=new Map,v=new Array;g.push(new Xe(a[0],0)),y.set(g[0].id,g[0]),v.push(new Array),v[0].push(g[0]);let t=g[0];for(let i=0;i<a.length;i+=2){const n=[a[i+0],a[i+1]],r=i+2<a.length?[a[i+2],a[i+3]]:[Xe.INVALID_ID,Xe.INVALID_ID];if(t.lastChild!==Xe.INVALID_INDEX){const f=g[t.lastChild];Ht(f.nextSibling===Xe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),f.initialNextSibling=g.length,f.nextSibling=g.length}const c=new Xe(n[1],g.length,t);for(g.push(c);v.length<=c.depth;)v.push(new Array);v[c.depth].push(c),y.set(c.id,c),!(r[0]===Xe.INVALID_ID&&r[1]===Xe.INVALID_ID)&&(r[0]===n[1]?t=c:r[0]!==n[0]&&(Ht(y.has(r[0]),`expected next parent to be already created, given ${r[0]}`),t=y.get(r[0])))}this.fromNodes(g,v)}fromInterleavedEdgesIndexById(a){Ht(a.length%2===0,"expected length of interleaved edges list to be a multiple of 2");const g=new Array,y=new Array;let v=0;for(g.push(new Xe(0,0)),y.push(new Array),y[0].push(g[0]),a[0]===-1&&(v+=2);v<a.length;v+=2){const t=[a[v+0],a[v+1]];let i;if(t[0]<g.length&&a[0]===-1?i=g[t[0]]:(Ht(t[0]<g.length,"expected parent to be processed before child"),i=g[t[0]<0?0:t[0]+1]),i.lastChild!==Xe.INVALID_INDEX){const r=g[i.lastChild];Ht(r.nextSibling===Xe.INVALID_INDEX,"expected next sibling to be unset for last child of a node"),r.initialNextSibling=g.length,r.nextSibling=g.length}const n=new Xe(t[1],g.length,i);g.push(n),y.length===n.depth&&y.push(new Array),y[n.depth].push(n)}this.fromNodes(g,y)}fromNodes(a,g){this._linearization.clear(),this._innerNodeIndicesById.clear(),this._leafNodeIndicesById.clear(),this._edgeIndexToTopologyIndexMap.length=a.length,this._topologyIndexToEdgeIndexMap.length=a.length,this._edgeIndexToTopologyIndexMap.fill(-1),this._topologyIndexToEdgeIndexMap.fill(-1);const y=new Array,v=new Array;for(const n of g){const r=n.filter(f=>f.isLeaf);for(const f of r)y.push(f);const c=n.filter(f=>!f.isLeaf);c.length>0&&v.push(c)}v.push(y);for(const n of v)this._linearization.addSliceByLength(n.length);const t=new Map;this._nodes.length=a.length,t.set(-1,-1);let i=0;for(const n of v)for(const r of n)this._nodes[i]=r,(r.isLeaf?this._leafNodeIndicesById:this._innerNodeIndicesById).set(r.id,i),t.set(r.index,i),this._edgeIndexToTopologyIndexMap[r.index]=i,this._topologyIndexToEdgeIndexMap[i]=r.index,++i;for(const n of this._nodes)n.index=t.get(n.index),n.parent=t.get(n.parent),n.initialNextSibling=t.get(n.initialNextSibling),n.initialFirstChild=t.get(n.initialFirstChild),n.nextSibling=n.initialNextSibling,n.firstChild=n.initialFirstChild}sliceDo(a,g){const y=(v,t)=>{for(let i=v;i<=t;++i)g(this._nodes[i])};this.sliceRangeDo(a,y)}sliceRangeDo(a,g){this._linearization.sliceDo(a,g)}initialize(a,g,y){switch(g){case bt.InputSemantics.ParentIdId:switch(a){case bt.InputFormat.Tupled:this.fromInterleavedEdgesIdById([].concat(...y));break;case bt.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIdById(y);break}break;case bt.InputSemantics.ParentIndexId:switch(a){case bt.InputFormat.Tupled:this.fromInterleavedEdgesIndexById([].concat(...y));break;case bt.InputFormat.Interleaved:default:Ht(y.length%2===0,"Interleaved edges expect to be a multiple of two ids."),this.fromInterleavedEdgesIndexById(y);break}break}return!0}node(a){if(!(this._nodes.length<=a))return this._nodes[a]}innerNodeIndexById(a){return this._innerNodeIndicesById.get(a)}leafNodeIndexById(a){return this._leafNodeIndicesById.get(a)}innerNodeById(a){const g=this.innerNodeIndexById(a);if(g!==void 0)return this.node(g)}leafNodeById(a){const g=this.leafNodeIndexById(a);if(g!==void 0)return this.node(g)}forEachInnerNode(a){for(let g=0;g<this.depth-1;++g)this.sliceDo(g,a)}parentsDoUntilDepth(a,g){const y=Math.min(Math.max(a,0),this.depth-1);for(let v=0;v<y;++v)this.sliceDo(v,g)}forEachLeafNode(a){this.sliceDo(this.depth-1,a)}nodesDo(a){this.forEachInnerNode(a),this.forEachLeafNode(a)}reverseNodesDo(a){this.forEachLeafNode(a),this.reverseParentsDo(a)}depthFirstDo(a){a(this.root)}childrenDo(a,g){Ht(a!==void 0,"Parent is expected to be valid."),a.firstChild!==Xe.INVALID_INDEX&&this.siblingsDo(this.node(a.firstChild),g)}siblingsDo(a,g){let y=a;for(g(y);y.nextSibling!==Xe.INVALID_INDEX;)y=this.node(y.nextSibling),g(y)}siblingsRangeDo(a,g,y){if(g===void 0)return this.siblingsDo(a,y);for(let v=a;v!==void 0&&v!==g;v=this.node(v.nextSibling))y(v)}reverseParentsDo(a){for(let g=this.depth-2;g>=0;--g)this.sliceDo(g,a)}get linearization(){return this._linearization}get numberOfNodes(){return this._linearization.numberOfNodes}get numberOfInnerNodes(){return this._linearization.numberOfInnerNodes}get numberOfLeafNodes(){return this._linearization.numberOfLeafNodes}get depth(){return this._linearization.length}get root(){return this._nodes[0]}get nodes(){return this._nodes}get edgeIndexToTopologyIndexMap(){return this._edgeIndexToTopologyIndexMap}get topologyIndexToEdgeIndexMap(){return this._topologyIndexToEdgeIndexMap}}(T=>{(a=>{a.Interleaved="interleaved",a.Tupled="tupled"})(T.InputFormat||(T.InputFormat={})),(a=>{a.ParentIdId="parent-id-id",a.ParentIndexId="parent-index-id"})(T.InputSemantics||(T.InputSemantics={})),(a=>{a.TopDown="top-down",a.BottomUp="bottom-up",a.DepthFirst="depth-first"})(T.IterationDirection||(T.IterationDirection={}))})(bt||(bt={}));const Dt=N.auxiliaries.assert,U2=N.auxiliaries.log,ll=N.auxiliaries.logIf,Hs=N.auxiliaries.LogLevel;var vs;(T=>{function a(m,_){const p=new Array(m.numberOfNodes);let b;if(_.topology.format===bt.InputFormat.Interleaved){const x=_.topology.edges,E=2*(m.numberOfNodes-1);ll(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),b=w=>{const S=2*(w-1);return Dt(S<x.length,`expected an index within the ranges of edges but got ${w}`),S<x.length?[x[S+0],x[S+1]]:[Xe.INVALID_INDEX,Xe.INVALID_INDEX]}}else{const x=_.topology.edges,E=m.numberOfNodes-1;ll(x.length!==E,Hs.Warning,`expected an edgelist of size ${E} instead of ${x.length}`),b=w=>(Dt(w-1<x.length,`expected an index within the ranges of edges but got${w}`),w-1<x.length?x[w-1]:[Xe.INVALID_INDEX,Xe.INVALID_INDEX])}p[0]=0;for(let x=1;x<m.numberOfNodes;x++){let E;const w=b(x);x+1<m.numberOfNodes&&b(x+1)[0]===w[1]?E=m.innerNodeIndexById(w[1]):E=m.leafNodeIndexById(w[1]),Dt(E!==void 0,`expected a valid index, given ${E} for ${w[1]}`),p[x]=E}return p}T.normalization_backup=a;function g(m,_){const p=new Float32Array(_.length);ll(_.length!==m.length,Hs.Warning,`expected value buffer to be sized with the number of nodes but got ${m.length} instead of ${_.length}`);for(let b=0;b<p.length;++b)p[_[b]]=m[b];return p}T.renormalize=g;function y(m,_,p){const b=new Float32Array(p.length);switch(b.fill(NaN),_.type){case St.LinearizationMapping.IdMapping:Dt(!1,"Id-Mapping not yet implemented");break;case St.LinearizationMapping.IndexMapping:for(let x=0;x<m.length;++x){let E=_.mapping[x];E!==void 0&&(b[p[E]]=m[x])}break}return b}T.renormalize_using_intermediate_linearization=y;function v(m,_,p,b,x){for(const E of b)switch(E.type){case"normalize":T.applyNormalization(m,p,E);break;case"range-transform":T.applyRangeTransform(m,p,E);break;case"propagate-up":T.applyPropagation(m,p,E);break;case"fill-invalid":T.applyFill(m,p,E);break;case"mask":T.applyMask(m,p,E);break;case"clamp":T.applyClamp(m,p,E);break;case"threshold":T.applyThreshold(m,p,E);break;case"compare":T.applyCompare(m,p,E);break;case"transform":T.applyTransform(m,_,p,E,x);break;case"discretize":T.applyDiscretization(m,p,E);break;case"callback":T.applyCallback(m,p,E);break}return p}T.applyTransformations=v;function t(m,_,p){if(m.numberOfLeafNodes===0)return;let b=0,x=1;switch(p.operation){case"zero-to-max":{let E;m.forEachLeafNode(w=>{const S=_[w.index];E=E===void 0?S:Math.max(E,S)}),Dt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),b=0,x=1/E}break;case"min-to-max":{let E,w;m.forEachLeafNode(S=>{const R=_[S.index];E=E===void 0?R:Math.max(E,R),w=w===void 0?R:Math.min(w,R)}),Dt(E!==void 0,"Valid max expected"),Dt(w!==void 0,"Valid min expected"),w===void 0&&(w=0),E===void 0&&(E=1),b=-w,x=1/(E-w)}break;case"sign-agnostic-max":{let E;m.forEachLeafNode(w=>{const S=Math.abs(_[w.index]);E=E===void 0?S:Math.max(E,S)}),Dt(E!==void 0,"Valid max expected"),E===void 0&&(E=1),b=0,x=1/E}break}_.forEach((E,w)=>{_[w]=(_[w]+b)*x})}T.applyNormalization=t;function i(m,_,p){if(m.numberOfLeafNodes===0||p.sourceRange===void 0||p.targetRange===void 0)return;const b=p.sourceRange,x=p.targetRange,E=-b[0],w=x[0],S=b[1]===b[0]?0:(x[1]-x[0])/(b[1]-b[0]);for(let R=0;R<_.length;R++)_[R]<b[0]?_[R]=-1:_[R]=w+(_[R]+E)*S}T.applyRangeTransform=i;function n(m,_,p){if(m.numberOfLeafNodes!==0)switch(p.operation){case"average":m.reverseParentsDo(b=>{let x=0,E=0;m.childrenDo(b,w=>{const S=_[w.index];x+=S,++E}),_[b.index]=E===0?0:x/E});break;case"sum":m.reverseParentsDo(b=>{let x=0;m.childrenDo(b,E=>{const w=_[E.index];x+=w}),_[b.index]=x});break;case"min":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const w=_[E.index];x=x===void 0?w:Math.min(w,x)}),x===void 0&&(x=0),_[b.index]=x});break;case"max":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const w=_[E.index];x=x===void 0?w:Math.max(w,x)}),x===void 0&&(x=0),_[b.index]=x});break;case"median":m.reverseParentsDo(b=>{const x=new Array;m.childrenDo(b,E=>{const w=_[E.index];x.push(w)}),x.sort(),x.length%2===0?_[b.index]=(x[x.length/2]+x[x.length/2])/2:_[b.index]=x[x.length/2]});break;case"closest-to-zero":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const w=_[E.index];(x===void 0||Math.abs(w)<Math.abs(x))&&(x=w)}),x===void 0&&(x=0),_[b.index]=x});break;case"closest-to-infinity":m.reverseParentsDo(b=>{let x;m.childrenDo(b,E=>{const w=_[E.index];(x===void 0||Math.abs(w)>Math.abs(x))&&(x=w)}),x===void 0&&(x=0),_[b.index]=x});break;default:U2(Hs.Warning,"Transformation type not recognized.");break}}T.applyPropagation=n;function r(m,_,p){const b=p.value,x="invalidValue"in p?p.invalidValue:void 0;m.nodesDo(E=>{_[E.index]===x&&(_[E.index]=b)})}T.applyFill=r;function c(m,_,p){let b,x;"range"in p?(b=p.range[0],x=p.range[0]):(b=p.min,x=p.max),Dt(b<=x,"Require valid min-max range."),m.nodesDo(E=>{const w=_[E.index];w!==void 0&&(_[E.index]=Math.min(x,Math.max(b,w)))})}T.applyClamp=c;function f(m,_,p){const b=p.value;m.nodesDo(x=>{_[x.index]=_[x.index]===b?1:0})}T.applyMask=f;function d(m,_,p){const b=p.value;m.nodesDo(x=>{_[x.index]=_[x.index]>=b?1:0})}T.applyThreshold=d;function h(m,_,p){const b=p.value;m.nodesDo(x=>{_[x.index]=_[x.index]>b?1:_[x.index]<b?-1:0})}T.applyCompare=h;function s(m,_,p,b,x){const E=b.operation,w=b.parameter,S=b.buffer;let R=O=>w;if(S!==void 0){const O=St.create(m,_,S,x);O!==void 0&&(R=I=>O[I.index])}switch(E){case"min":m.nodesDo(O=>{p[O.index]=Math.min(p[O.index],R(O))});break;case"max":m.nodesDo(O=>{p[O.index]=Math.max(p[O.index],R(O))});break;case"add":m.nodesDo(O=>{p[O.index]=p[O.index]+R(O)});break;case"subtract":m.nodesDo(O=>{p[O.index]=p[O.index]-R(O)});break;case"multiply":m.nodesDo(O=>{p[O.index]=p[O.index]*R(O)});break;case"divide":m.nodesDo(O=>{p[O.index]=p[O.index]/R(O)});break;case"inverse":m.nodesDo(O=>{p[O.index]=1/p[O.index]});break;case"pow":m.nodesDo(O=>{p[O.index]=Math.pow(p[O.index],R(O))});break;case"nth-root":m.nodesDo(O=>{const I=1/R(O);p[O.index]=Math.pow(p[O.index],I)});break;case"log":w!==void 0&&w!==0?m.nodesDo(O=>{const I=Math.log(R(O));p[O.index]=Math.log(p[O.index])/I}):m.nodesDo(O=>{p[O.index]=Math.log(p[O.index])});break;case"square":m.nodesDo(O=>{p[O.index]=Math.pow(p[O.index],2)});break;case"square-root":m.nodesDo(O=>{p[O.index]=Math.sqrt(p[O.index])});break;case"as-multiplier":m.nodesDo(O=>{p[O.index]=Math.abs(p[O.index])});break;case"as-remainder":m.nodesDo(O=>{p[O.index]=1-Math.abs(p[O.index])});break;case"abs":m.nodesDo(O=>{p[O.index]=Math.abs(p[O.index])});break;case"compare":m.nodesDo(O=>{const I=p[O.index],D=R(O);I<D?p[O.index]=-1:I>D?p[O.index]=1:p[O.index]=0});break;default:return}}T.applyTransform=s;function u(m,_,p){Dt(!1,"Implementation missing")}T.applyDiscretization=u;function o(m,_,p){const b=p.operation;switch(p.iteration){case bt.IterationDirection.TopDown:m.nodesDo(E=>{_[E.index]=b(_[E.index],E,_,m)});break;case bt.IterationDirection.DepthFirst:m.reverseNodesDo(E=>{_[E.index]=b(_[E.index],E,_,m)});break;case bt.IterationDirection.BottomUp:default:m.depthFirstDo(E=>{_[E.index]=b(_[E.index],E,_,m)});break}}T.applyCallback=o})(vs||(vs={}));const Nf=N.auxiliaries.assert,zf=N.auxiliaries.log,Bf=N.auxiliaries.LogLevel;var St;(T=>{(i=>{i.String="string",i.Numbers="numbers",i.Uint8="uint8",i.Int8="int8",i.Uint16="uint16",i.Int16="int16",i.Uint32="uint32",i.Int32="int32",i.Float32="float32",i.Float64="float64"})(T.DataType||(T.DataType={})),(i=>{i.Native="native"})(T.Encoding||(T.Encoding={})),(i=>{i.Topology="topology",i.Identity="identity"})(T.Linearization||(T.Linearization={})),(i=>{i.IdMapping="id-mapping",i.IndexMapping="index-mapping"})(T.LinearizationMapping||(T.LinearizationMapping={}));function a(i,n){return i.edgeIndexToTopologyIndexMap}T.createNormalization=a;function g(i,n,r,c){const f=r.indexOf(":");if(f===void 0||f<0){zf(Bf.Error,"Buffer type not recognized.");return}switch(r.substr(0,f)){case"buffer":return T.createSourceBuffer(n,r.substr(f+1),c);case"bufferView":return T.createView(i,n,r.substr(f+1),c);default:zf(Bf.Error,"Buffer type not recognized.");break}}T.create=g;function y(i){if(i.length!==0)return Array.prototype.reduce.apply(i,[(n,r)=>[Math.min(r,n[0]),Math.max(r,n[1])],[1/0,-1/0]])}T.range=y;function v(i,n,r){const c=r.buffers.find(f=>f.identifier===n);if(!(!c||c.encoding!=="native"))return Nf(c.linearization!=="identity","Expect linearization to be of type topology or mapping. Identity is currently unsupported"),br.isLinearizationMapping(c.linearization)?vs.renormalize_using_intermediate_linearization(c.data,c.linearization,i):(Nf(c.linearization==="topology","Expect linearization to be of type topology or identity."),vs.renormalize(c.data,i))}T.createSourceBuffer=v;function t(i,n,r,c){const f=c.bufferViews.find(h=>h.identifier===r);if(f===void 0)return;const d=T.create(i,n,f.source,c);if(d!==void 0)return f.transformations===void 0||f.transformations.length===0?d:vs.applyTransformations(i,n,d,f.transformations,c)}T.createView=t})(St||(St={}));const G2="http://json-schema.org/draft-06/schema#",q2="Treemap Configuration Schema",W2="JSON schema for a treemap configuration object, targeting the treemap renderer module.",V2="object",$2={topology:{type:"object",properties:{format:{type:"string",enum:["interleaved","tupled"],default:"interleaved"},semantics:{type:"string",enum:["parent-id-id","parent-index-id"],default:"parent-id-id"},edges:{type:"array",items:{anyOf:[{type:"integer",minimum:0},{type:"array",items:{type:"integer",minimum:0},minItems:2,maxItems:2,uniqueItems:!0}]}}},required:["edges"],additionalProperties:!1},buffers:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},type:{type:"string",enum:["numbers","uint8","uint16","int16","uint32","int32","float32","float64"]},encoding:{type:"string",enum:["base64","native"],default:"native"},data:{anyOf:[{type:"array",items:{type:"number"}},{type:"Uint8Array"},{type:"Uint16Array"},{type:"Int16Array"},{type:"Uint32Array"},{type:"Int32Array"},{type:"Float32Array"},{type:"Float64Array"}]},linearization:{anyOf:[{type:"string",enum:["topology","identity"]},{type:"object",properties:{type:{type:"string",enum:["id-mapping","index-mapping"]},mapping:{type:"array",items:{type:"integer"}}},required:["type","mapping"],additionalProperties:!1}],default:"topology"}},required:["identifier","type","data"],additionalProperties:!1}},bufferViews:{type:"array",items:{type:"object",properties:{identifier:{type:"string"},source:{$ref:"/BufferReference"},transformations:{type:"array",items:{anyOf:[{type:"object",properties:{type:{type:"string",enum:["propagate-up"]},operation:{type:"string",enum:["average","sum","min","max","median","closest-to-zero","closest-to-infinity"]},weight:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["fill-invalid"]},value:{type:"number"},invalidValue:{anyOf:[{type:"number"},{type:"null"}]}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["mask"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},min:{type:"number"},max:{type:"number"}},required:["type","min","max"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["clamp"]},range:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","range"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["range-transform"]},sourceRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2},targetRange:{type:"array",items:{type:"number"},minItems:2,maxItems:2}},required:["type","sourceRange","targetRange"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["normalize"]},operation:{type:"string",enum:["zero-to-max","min-to-max","sign-agnostic-max"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["threshold"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["compare"]},value:{type:"number"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["transform"]},operation:{type:"string",enum:["add","subtract","multiply","divide","inverse","pow","nth-root","log","square","square-root","as-multiplier","as-remainder","abs"]},parameter:{type:"number",default:0},buffer:{$ref:"/BufferReference"}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},operation:{type:"string",enum:["quantiles","quartiles"]}},required:["type","operation"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["discretize"]},percentiles:{type:"array",items:{type:"number"}}},required:["type","percentiles"],additionalProperties:!1},{type:"object",properties:{type:{type:"string",enum:["callback"]}},required:["type","operation"],additionalProperties:!0}]}}},required:["identifier","source"],additionalProperties:!1}},colors:{type:"array",items:{oneOf:[{type:"object",properties:{identifier:{type:"string"},colorspace:{type:"string",enum:["rgb","hsl","lab","cmyk","hex"],description:"The color space is based on supported webgl-operate color spaces.",default:"hex"},value:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]},values:{type:"array",minItems:2,items:{oneOf:[{type:"array",minItems:3,maxItems:5,items:{type:"number",minimum:0,maximum:1}},{type:"string",pattern:"^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$"}]}}},required:["identifier","colorspace"],oneOf:[{type:"object",required:["value"]},{type:"object",required:["values"]}],additionalProperties:!1},{type:"object",properties:{identifier:{type:"string"},preset:{type:"string",description:"The preset from a webgl-operate Color Scheme Preset file."},steps:{type:"number",minimum:3,maximum:12,default:5}},required:["identifier","preset"],additionalProperties:!1}]}},layout:{type:"object",properties:{algorithm:{type:"string",enum:["strip","snake","codecity"]},weight:{$ref:"/BufferReference"},aspectRatio:{type:"number",exclusiveMinimum:0,default:1},sort:{type:"object",properties:{algorithm:{type:"string",enum:["ascending","descending","keep"],default:"keep"},key:{anyOf:[{type:"string",enum:["identity","weight"]},{$ref:"/BufferReference"}],default:"identity"}},required:["algorithm"],additionalProperties:!1},siblingMargin:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0}],default:0}},required:["type","value"],additionalProperties:!1},parentPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute","mixed"],default:"relative"},value:{anyOf:[{$ref:"/BufferReference"},{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0}},required:["type","value"],additionalProperties:!1},accessoryPadding:{type:"object",properties:{type:{type:"string",enum:["relative","absolute"],default:"absolute"},direction:{type:"string",enum:["top","left","bottom","right"],default:"bottom"},value:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}]},relativeAreaThreshold:{anyOf:[{type:"number",minimum:0},{type:"array",items:{type:"number",minimum:0},minItems:1}],default:0},targetAspectRatio:{anyOf:[{type:"number",minimum:0},{type:"null"}],default:null}},required:["value"],additionalProperties:!1}},required:["algorithm","weight"],additionalProperties:!1},geometry:{type:"object",properties:{parentLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:inner"},showRoot:{type:"boolean",default:!1}},additionalProperties:!1},leafLayer:{type:"object",properties:{colorMap:{$ref:"/ColorReference",default:"color:leaf"},height:{$ref:"/BufferReference"},colors:{$ref:"/BufferReference"}},additionalProperties:!1},auxiliary:{$ref:"/ColorReference",default:"color:auxiliary"},emphasis:{type:"object",properties:{outline:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},highlight:{type:"array",items:{type:"integer",minimum:0},uniqueItems:!0},color:{$ref:"/ColorReference",default:"color:emphasis"},outlineWidth:{type:"number",minimum:0,description:"unit: device-independent pixel",default:1.6}},additionalProperties:!1},heightScale:{anyOf:[{type:"string",enum:["SomethingInverseSqrt"]},{type:"number"}],default:.125},outlineWidth:{type:"number",minimum:0,description:"unit: native pixel",default:.8}},required:[],additionalProperties:!1},labels:{type:"object",properties:{names:{$ref:"/BufferReference"},additionallyLabelSet:{type:"array",items:{type:"number",minimum:0}},innerNodeLayerRange:{type:"array",items:{type:"number",minimum:0},minItems:2,maxItems:2,default:[1,2]},numTopInnerNodes:{type:"number",minimum:0,default:0},numTopWeightNodes:{type:"number",minimum:0,default:0},numTopHeightNodes:{type:"number",minimum:0,default:0},numTopColorNodes:{type:"number",minimum:0,default:0}},required:[]}},H2=["topology","layout"],X2=!1,Y2={$schema:G2,title:q2,description:W2,type:V2,properties:$2,required:H2,additionalProperties:X2},Z2="/BufferReference",K2="string",Q2="^(buffer|bufferView):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",J2="Named identifier used to reference a buffer or buffer view throughout the treemap configuration.",eg={id:Z2,type:K2,pattern:Q2,description:J2},tg="/ColorReference",rg="string",ig="^(color):[_a-zA-Z][_a-zA-Z0-9\\-]*[_a-zA-Z0-9]+$",ng="Named identifier used to reference a color throughout the treemap configuration.",ag={id:tg,type:rg,pattern:ig,description:ng},sg="/ColorScheme",og="object",ug={inverted:{type:"boolean",default:!1},classBounds:{type:"array",items:{type:"number"}}},lg={id:sg,type:og,properties:ug},et=class et{constructor(){this._altered=Object.assign(new N.ChangeLookup,{any:!1,topology:!1,buffers:!1,bufferViews:!1,colors:!1,layout:{any:!1,weight:!1,sort:!1,algorithm:!1,siblingMargin:!1,parentPadding:!1,accessoryPadding:!1},geometry:{any:!1,aggregation:!1,outlineWidth:!1,emphasis:{any:!1,outline:!1,highlight:!1,outlineWidth:!1},areaScale:!1,heights:!1,heightScale:!1,colors:!1,parentLayer:!1},labels:!1,animations:!1}),this._buffers=[],this._bufferViews=[],this._colors=[]}get altered(){return this._altered}set topology(a){const g=et.TREEMAP_SCHEMA.properties.topology;N.properties.complement(a,g),N.properties.compare(a,this._topology,this._altered,"topology"),this._topology=a}get topology(){return this._topology}set buffers(a){const g=et.TREEMAP_SCHEMA.properties.buffers;N.properties.validate(a,g,[])&&(N.properties.complement(a,g),N.properties.compare(a,this._buffers,this._altered,"buffers"),this._buffers=a)}get buffers(){return this._buffers}set bufferViews(a){const g=et.TREEMAP_SCHEMA.properties.bufferViews;N.properties.validate(a,g,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(a,g),N.properties.compare(a,this._bufferViews,this._altered,"bufferViews"),this._bufferViews=a)}get bufferViews(){return this._bufferViews}set colors(a){const g=et.TREEMAP_SCHEMA.properties.colors;N.properties.validate(a,g,[[et.COLOR_REFERENCE_SCHEMA,"/ColorReference"]])&&(N.properties.complement(a,g),N.properties.compare(a,this._colors,this._altered,"colors"),this._colors=a)}get colors(){return this._colors}set layout(a){const g=et.TREEMAP_SCHEMA.properties.layout;N.properties.validate(a,g,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(a,g),N.properties.compare(a,this._layout,this._altered,"layout"),this._layout=a)}get layout(){return this._layout}set geometry(a){const g=et.TREEMAP_SCHEMA.properties.geometry;N.properties.validate(a,g,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"],[et.COLOR_REFERENCE_SCHEMA,"/ColorReference"],[et.COLOR_SCHEMA_SCHEMA,"/ColorScheme"]])&&(N.properties.complement(a,g),N.properties.compare(a,this._geometry,this._altered,"geometry"),this._geometry=a)}get geometry(){return this._geometry}set labels(a){const g=et.TREEMAP_SCHEMA.properties.labels;N.properties.validate(a,g,[[et.BUFFER_REFERENCE_SCHEMA,"/BufferReference"]])&&(N.properties.complement(a,g),N.properties.compare(a,this._labels,this._altered,"labels"),this._labels=a)}get labels(){return this._labels}};et.TREEMAP_SCHEMA=Y2,et.BUFFER_REFERENCE_SCHEMA=eg,et.COLOR_REFERENCE_SCHEMA=ag,et.COLOR_SCHEMA_SCHEMA=lg;let br=et;(T=>{function a(v){return typeof v=="string"||v instanceof String||v in St.Linearization?!1:"type"in v&&v.type in St.LinearizationMapping&&"mapping"in v}T.isLinearizationMapping=a;function g(v){return typeof v!="object"?!1:"identifier"in v&&"colorspace"in v}T.isColorArray=g;function y(v){return typeof v!="object"?!1:"identifier"in v&&"preset"in v}T.isColorPreset=y})(br||(br={}));var wr;(T=>{function a(v,t="SomethingInverseSqrt"){switch(t){default:case"SomethingInverseSqrt":return N.gl_matrix_extensions.clamp(100/Math.sqrt(v.numberOfNodes)+.0125,.0625,.3333)}}T.heightScale=a,(v=>{v.SomethingInverseSqrt="SomethingInverseSqrt"})(T.HeightScaleApproach||(T.HeightScaleApproach={}));function g(v,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .04+(1-Math.log10(v.numberOfNodes+1)/6)*.12}}T.parentMargin=g;function y(v,t="SomethingLog10"){switch(t){default:case"SomethingLog10":return .01+(1-Math.log10(v.numberOfNodes+1)/6)*.12}}T.siblingMargin=y,(v=>{v.SomethingLog10="SomethingLog10"})(T.MarginApproach||(T.MarginApproach={}))})(wr||(wr={}));var cg=Object.defineProperty,hg=Object.getOwnPropertyDescriptor,dg=(T,a,g,y)=>{for(var v=hg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&cg(a,g,v),v},je;const k_=(je=class extends N.Geometry{static referenceVerticesVBO(a){let g;je.VERTICES_BY_CONTEXT.has(a)?g=je.VERTICES_BY_CONTEXT.get(a):(g=new N.Buffer(a,"CuboidVertexVBO"),je.VERTICES_BY_CONTEXT.set(a,g),je.REFCOUNT_BY_TEMPLATE.set(g,0));const y=je.REFCOUNT_BY_TEMPLATE.get(g)+1;return je.REFCOUNT_BY_TEMPLATE.set(g,y),g}static unreferenceTemplateVBO(a){if(!je.VERTICES_BY_CONTEXT.has(a))return;const g=je.VERTICES_BY_CONTEXT.get(a),y=je.REFCOUNT_BY_TEMPLATE.get(g)-1;je.REFCOUNT_BY_TEMPLATE.set(g,y),!(y>0)&&(g.uninitialize(),je.VERTICES_BY_CONTEXT.delete(a),je.REFCOUNT_BY_TEMPLATE.delete(g))}constructor(a,g){super(a,g),g=g!==void 0&&g!==""?g:"CuboidGeometry",this._vertices=je.referenceVerticesVBO(a),this._buffers.push(this._vertices),this._layout=new N.Buffer(a,`${g}LayoutVBO`),this._buffers.push(this._layout),this._ids=new N.Buffer(a,`${g}IdVBO`),this._buffers.push(this._ids),this._emphases=new N.Buffer(a,`${g}EmphasisVBO`),this._buffers.push(this._emphases),this._areaScales=new N.Buffer(a,`${g}AreaScaleVBO`),this._buffers.push(this._areaScales),this._colors=new N.Buffer(a,`${g}ColorVBO`),this._buffers.push(this._colors),this._heights=new N.Buffer(a,`${g}HeightVBO`),this._buffers.push(this._heights)}bindBuffers(a){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,20,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._vertices.attribEnable(this._texCoordLocation,2,g.FLOAT,!1,20,12,!0,!1),y.vertexAttribDivisor(this._texCoordLocation,0),this._layout.attribEnable(this._layoutLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._areaScales.attribEnable(this._areaScaleLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._areaScaleLocation,1),this._colors.attribEnable(this._colorLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1),this._heights.attribEnable(this._heightLocation,2,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._heightLocation,1)}unbindBuffers(a){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._vertices.attribDisable(this._texCoordLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._areaScales.attribDisable(this._areaScaleLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1),this._heights.attribDisable(this._heightLocation,!1,!1)}initialize(a=0,g=1,y=2,v=3,t=4,i=5,n=6,r=7){this._vertexLocation=a,this._texCoordLocation=g,this._idLocation=v,this._layoutLocation=y,this._emphasisLocation=t,this._areaScaleLocation=i,this._colorLocation=n,this._heightLocation=r;const c=this.context.gl,f=super.initialize([c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER,c.ARRAY_BUFFER]);return this._vertices.data(je.DATA,c.STATIC_DRAW),f&&this._vertices.valid}uninitialize(){je.unreferenceTemplateVBO(this.context),this._layout.uninitialize(),this._ids.uninitialize(),this._emphases.uninitialize(),this._areaScales.uninitialize(),this._colors.uninitialize(),this._heights.uninitialize(),super.uninitialize()}update(){this.bind()}draw(a=0,g=0,y=0){const v=this.context.gl,t=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,v.FLOAT,!1,20,g,!0,!1),this._vertices.attribEnable(this._texCoordLocation,2,v.FLOAT,!1,20,12+g,!0,!1),this._ids.attribEnable(this._idLocation,4,v.UNSIGNED_BYTE,!1,4,a*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,v.FLOAT,!1,16,a*16,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,v.UNSIGNED_BYTE,!1,1,a*1,!0,!1),this._areaScales.attribEnable(this._areaScaleLocation,1,v.UNSIGNED_BYTE,!1,1,a*1,!0,!1),this._colors.attribEnable(this._colorLocation,1,v.UNSIGNED_BYTE,!1,1,a*1,!0,!1),this._heights.attribEnable(this._heightLocation,2,v.UNSIGNED_BYTE,!1,2,a*2,!0,!1),t.drawArraysInstanced(v.TRIANGLE_STRIP,0,4,y)}set layout(a){const g=this.context.gl;this._layout.data(a,g.STATIC_DRAW)}set ids(a){const g=this.context.gl;this._ids.data(a,g.STATIC_DRAW)}set areaScales(a){const g=this.context.gl;this._areaScales.data(a,g.STATIC_DRAW)}set colors(a){const g=this.context.gl;this._colors.data(a,g.STATIC_DRAW)}set emphases(a){const g=this.context.gl;this._emphases.data(a,g.STATIC_DRAW)}set heights(a){const g=this.context.gl;this._heights.data(a,g.STATIC_DRAW)}get valid(){const a=this._layout&&this._layout.valid,g=this._ids&&this._ids.valid,y=this._areaScales&&this._areaScales.valid,v=this._colors&&this._colors.valid,t=this._emphases&&this._emphases.valid,i=this._heights&&this._heights.valid;return this.initialized&&this._vertices.valid&&a&&g&&y&&v&&t&&i}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get areaScaleLocation(){return this._areaScaleLocation}get colorLocation(){return this._colorLocation}get heightLocation(){return this._heightLocation}},je.VERTICES_BY_CONTEXT=new Map,je.REFCOUNT_BY_TEMPLATE=new Map,je.DATA=new Float32Array([0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,0,0,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,1,1,1,1]),je.BYTES_PER_VERTEX=je.DATA.length/6,je);dg([N.Initializable.assert_initialized()],k_.prototype,"draw");let Df=k_;var fg=Object.defineProperty,_g=Object.getOwnPropertyDescriptor,U_=(T,a,g,y)=>{for(var v=_g(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&fg(a,g,v),v};const _r=N.auxiliaries.assert;class Ut extends N.Initializable{constructor(a){super(),this._context=a}initializeES2_basic(a,g){const y=this._context.gl,v=this._context.gl2facade;this._drawRestricted=!0,this._colorRenderTexture.initialize(a,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(a,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(a,g,y.RGB,y.RGB,y.UNSIGNED_BYTE),this._depthStencilRenderbuffer.initialize(a,g,y.DEPTH_STENCIL),this._depthFBO=new N.Framebuffer(this._context,"DepthFBO"),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._primaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._secondaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.initialize([[v.COLOR_ATTACHMENT0,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO.clearColor([1,1,1,1],0),this._depthFBO.initialize([[v.COLOR_ATTACHMENT0,this._depthStencilRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._depthFBO.clearColor([1,1,1,1],0)}initializeES2_extensions(a,g){const y=this._context.gl,v=this._context.gl2facade;this._drawRestricted=!1,this._context.isWebGL1&&(_r(this._context.supportsDrawBuffers,"expected WEBGL_draw_buffers to be supported"),_r(this._context.supportsDepthTexture,"expected WEBGL_depth_texture to be supported")),this._colorRenderTexture.initialize(a,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(a,g,y.RGBA,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(a,g,y.DEPTH_STENCIL,y.DEPTH_STENCIL,this._context.depthTexture.UNSIGNED_INT_24_8_WEBGL),this._depthStencilRenderbuffer.initialize(a,g,y.DEPTH_STENCIL),this._primaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[v.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]]),this._idFBO=new N.Framebuffer(this._context,"IdFBO"),this._idFBO.initialize([[v.COLOR_ATTACHMENT0,this._idRenderTexture]])}initializeES3(a,g){const y=this._context.gl,v=this._context.gl2facade;this._drawRestricted=!1,_r(this._context.isWebGL2,"expected a webgl2 context"),this._colorRenderTexture.initialize(a,g,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._idRenderTexture.initialize(a,g,y.RGBA8,y.RGBA,y.UNSIGNED_BYTE),this._depthStencilRenderTexture.initialize(a,g,y.DEPTH24_STENCIL8,y.DEPTH_STENCIL,y.UNSIGNED_INT_24_8),this._depthStencilRenderbuffer.initialize(a,g,y.DEPTH24_STENCIL8),this._primaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[v.COLOR_ATTACHMENT1,this._idRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderTexture]]),this._primaryFBO.clearColor([1,1,1,1],1),this._secondaryFBO.initialize([[v.COLOR_ATTACHMENT0,this._colorRenderTexture],[y.DEPTH_STENCIL_ATTACHMENT,this._depthStencilRenderbuffer]])}initialize(){this._defaultFBO=new N.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new N.Texture2D(this._context,"ColorRenderTexture"),this._idRenderTexture=new N.Texture2D(this._context,"IdRenderTexture"),this._depthStencilRenderTexture=new N.Texture2D(this._context,"DepthStencilRenderTexture"),this._depthStencilRenderbuffer=new N.Renderbuffer(this._context,"DepthStencilRenderbuffer"),this._primaryFBO=new N.Framebuffer(this._context,"PrimaryFBO"),this._secondaryFBO=new N.Framebuffer(this._context,"SecondaryFBO");const a=this._defaultFBO.width,g=this._defaultFBO.height;return this._context.isWebGL2?this.initializeES3(a,g):this._context.supportsDepthTexture&&this._context.supportsDrawBuffers&&this._context.gl.getParameter(this._context.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)>=2?this.initializeES2_extensions(a,g):this.initializeES2_basic(a,g),this._primaryFBO.clearColor([0,0,0,1],0),this._secondaryFBO.clearColor([0,0,0,1],0),this._primaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._primaryFBO.clearStencil(0),this._secondaryFBO.clearDepth(N.ReadbackPass.maxClearDepth()),this._secondaryFBO.clearStencil(0),_r(this._primaryFBO.valid,`${this._primaryFBO.identifier} expected to be valid for rendering`),_r(this._secondaryFBO.valid,`${this._secondaryFBO.identifier} expected to be valid for rendering`),_r(this._idFBO===void 0||this._idFBO.valid,`${this._idFBO?this._idFBO.identifier:""} expected to be valid for rendering`),_r(this._depthFBO===void 0||this._depthFBO.valid,`${this._depthFBO?this._depthFBO.identifier:""} expected to be valid for rendering`),!0}uninitialize(){this._defaultFBO.uninitialize(),this._primaryFBO.uninitialize(),this._idFBO&&this._idFBO.uninitialize(),this._depthFBO&&this._depthFBO.uninitialize(),this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.uninitialize(),this._colorRenderTexture.uninitialize(),this._idRenderTexture.uninitialize(),this._depthStencilRenderTexture.uninitialize()}setClearColor(a){this._primaryFBO.clearColor(a,0),this._secondaryFBO.clearColor(a,0)}resize(a,g){this._primaryFBO.resize(a,g),this._secondaryFBO.resize(a,g),this._idFBO&&this._idFBO.resize(a,g),this._depthFBO&&this._depthFBO.resize(a,g)}get drawRestricted(){return this._drawRestricted}get primaryFBO(){return this._primaryFBO}get secondaryFBO(){return this._secondaryFBO}get defaultFBO(){return this._defaultFBO}get depthFBO(){return this._drawRestricted?this._depthFBO:void 0}get idFBO(){return this._drawRestricted?this._idFBO:void 0}get readBackIdFBO(){return this._idFBO}get colorRenderTexture(){return this._colorRenderTexture}get idRenderTexture(){return this._idRenderTexture}}U_([N.Initializable.initialize()],Ut.prototype,"initialize");U_([N.Initializable.uninitialize()],Ut.prototype,"uninitialize");(T=>{(a=>{a[a.Undefined=-1]="Undefined",a[a.Color=0]="Color",a[a.Id=1]="Id",a[a.Depth=2]="Depth"})(T.Attachment||(T.Attachment={}))})(Ut||(Ut={}));var pg=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec3  a_vertex;
attribute vec4  a_layout; 
attribute vec4  a_id; /* encoded uint32 id in byte4 */
attribute float a_areaScale;
attribute float a_color;
attribute float a_emphasis;
attribute vec2  a_heights; /* [ bottom: float, top: float ] */
attribute vec2  a_texCoord;

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec3  a_vertex;
in vec4  a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4  a_id; /* encoded uint32 id in byte4 */
in float a_areaScale;
in float a_color;
in float a_emphasis;
in vec2  a_heights; /* [ bottom: float, top: float ] */
in vec2  a_texCoord;

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform int u_face;
uniform vec4 u_normalAndLambert;

uniform float u_heightScale;
uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec4 v_uv;

const float ONE_OVER_255 = 1.0 / 255.0;
const int FACE_INDEX_TOP = 1; /* see CuboidRenderPass.FaceIndex.Top */

const vec3 AMBIENT = vec3(0.0, 0.0, 0.0); /* @todo expose to API */
const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

/**
 * Transforms the cuboid vertices based on the associated face and height mapping. An earlier implementation of this
 * used the same geometry template and transformed it to either orientation. The current implementation uses a pre-set
 * vertex sequence/orientation and has to adjust the height only.
 * Appart from that, each cuboid face is moved to its position and adjusted to the provided height values. ID, color,
 * and extent along the y-axis are encoded per vertex (or even per face/cuboid) to reduce per-fragment processing.
 */
void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    float height = (a_heights[1] - a_heights[0]) * u_heightScale;

    /* Compute the position and extend of the cuboid based on the face. */
    vec4 pos = vec4(a_layout[0], u_face == FACE_INDEX_TOP ?
        a_heights[1] * u_heightScale : a_heights[0] * u_heightScale, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], height, a_layout[3], 1.0);

    /* Area scaling */
    float shrinkage = 1.0 - a_areaScale * ONE_OVER_255;
    pos.x += ext.x * shrinkage * 0.5;
    pos.z += ext.z * shrinkage * 0.5;
    ext.x -= ext.x * shrinkage;
    ext.z -= ext.z * shrinkage;

    /* Compute the final vertex position and pass through texture coordinates and layout data. */
    vec4 vertex = vec4(a_vertex, 1.0) * ext + pos;

    v_uv.st = a_texCoord.st;
    v_id = a_id * ONE_OVER_255;

    /* The y-extent provides world-space height of the cuboid that can be used for fragment-processing. */
    v_uv[2] = 1.0; 
    v_uv[3] = height / mix(a_layout[2], a_layout[3], step(5.0, float(u_face)));

    /* REVIEW AND SIMPLIFY THE FOLLOWING COLOR COMPUTATION (probably to many states) */

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    int colorIndex = int(abs(a_color - 32.0));
    v_baseColor = mix(u_colorTable[colorIndex], emphasisColor, step(2.0, a_emphasis));

    vertex = u_viewProjection * vertex;

    v_uv[2] *= (a_texCoord.x - 0.5);
    v_uv[3] *= 1.0 - a_texCoord.y;

    v_baseColor = u_colorTable[colorIndex];
    v_baseColor = mix(v_baseColor, emphasisColor, step(2.0, a_emphasis));

    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline should be darkened based on the face orientation. */
    v_outlineColor.rgb = mix(AMBIENT, v_outlineColor.rgb, u_normalAndLambert[3]);
    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    v_baseColor = mix(vec4(AMBIENT, 1.0), v_baseColor, u_normalAndLambert[3]);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,vg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

uniform int u_face;

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;

varying vec4 v_id;
varying vec4 v_uv;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];
    vec2 awidth2 = fwidth(v_uv.zw);

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step(v_uv.st - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(1.0), v_uv.st + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,mg=Object.defineProperty,gg=Object.getOwnPropertyDescriptor,Mr=(T,a,g,y)=>{for(var v=gg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&mg(a,g,v),v},Ae;const Sr=(Ae=class extends N.Initializable{constructor(a){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!0,camera:!0,geometry:!0,colorTable:!0,colorTableLength:!0,emphases:!0,heightScale:!0,outlineWidth:!0,emphasisOutlineWidth:!0}),this._outlineWidth=Ae.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Ut.Attachment.Undefined,this._faceSequence=new Array,this._faceData=new Map,this._context=a,this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._program=new N.Program(a,"CuboidRenderProgram"),this._geometry=Ae.referenceGeometry(a)}static referenceGeometry(a){let g;Ae.GEOMETRY_BY_CONTEXT.has(a)?g=Ae.GEOMETRY_BY_CONTEXT.get(a):(g=new Df(a,"CuboidGeometry"),g.initialize(),Ae.GEOMETRY_BY_CONTEXT.set(a,g),Ae.REFCOUNT_BY_GEOMETRY.set(g,0));const y=Ae.REFCOUNT_BY_GEOMETRY.get(g)+1;return Ae.REFCOUNT_BY_GEOMETRY.set(g,y),g}static unreferenceGeometry(a){if(!Ae.GEOMETRY_BY_CONTEXT.has(a))return;const g=Ae.GEOMETRY_BY_CONTEXT.get(a),y=Ae.REFCOUNT_BY_GEOMETRY.get(g)-1;Ae.REFCOUNT_BY_GEOMETRY.set(g,y),!(y>0)&&(g.uninitialize(),Ae.GEOMETRY_BY_CONTEXT.delete(a),Ae.REFCOUNT_BY_GEOMETRY.delete(g))}relink(){if(this._colorTable!==void 0){for(const a of this._program.shaders)a.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_areaScale",this._geometry.areaScaleLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation),this._program.attribute("a_heights",this._geometry.heightLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation);for(const a of this._program.shaders)a.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uFace=this._program.uniform("u_face"),this._uNormalAndLambert=this._program.uniform("u_normalAndLambert"),this._uHeightScale=this._program.uniform("u_heightScale"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}}optimizeFaceSequence(){const a=this._camera.eye,g=this._camera.center;let y=new Array;const v=N.vec3.create();N.vec3.sub(v,a,g),N.vec3.normalize(v,v),a[1]>0&&y.push([Ae.Face.Top,Math.abs(N.vec3.dot(N.vec3.fromValues(0,1,0),v))]),a[2]>-1&&y.push([Ae.Face.Front,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,1),v))]),a[2]<1&&y.push([Ae.Face.Back,Math.abs(N.vec3.dot(N.vec3.fromValues(0,0,-1),v))]),a[0]>-1&&y.push([Ae.Face.Left,Math.abs(N.vec3.dot(N.vec3.fromValues(1,0,0),v))]),a[0]<1&&y.push([Ae.Face.Right,Math.abs(N.vec3.dot(N.vec3.fromValues(-1,0,0),v))]),y=y.sort((t,i)=>i[1]-t[1]),this._faceSequence=y.map(t=>t[0])}initialize(){const a=this._context.gl;this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const g=new N.Shader(this._context,a.VERTEX_SHADER,"cuboid.vert");g.initialize(pg,!1);const y=new N.Shader(this._context,a.FRAGMENT_SHADER,"cuboid.frag");return y.initialize(vg,!1),this._program.initialize([g,y],!1),this._faceData.set(Ae.Face.Top,[0,1,0,1]),this._faceData.set(Ae.Face.Bottom,[0,-1,0,.68]),this._faceData.set(Ae.Face.Front,[0,0,1,.88]),this._faceData.set(Ae.Face.Back,[0,0,-1,.88]),this._faceData.set(Ae.Face.Left,[1,0,0,.84]),this._faceData.set(Ae.Face.Right,[-1,0,0,.84]),!0}uninitialize(){Ae.unreferenceGeometry(this._context),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uFace=void 0,this._uNormalAndLambert=void 0,this._uHeightScale=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const a=this._context.gl;let g=!1;if(!this._program.initialized||!this._program.linked||this._altered.colorTableLength){if(this.relink(),!this._program.linked)return;g=!0}if(this._program.bind(),(g||this._altered.camera||this._camera.altered)&&(a.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this.optimizeFaceSequence()),(g||this._colorTable)&&a.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),(g||this._altered.heightScale)&&a.uniform1f(this._uHeightScale,this._heightScale/255),(g||this._altered.outlineWidth)&&a.uniform1f(this._uOutlineWidth,this._outlineWidth),g||this._altered.emphasisOutlineWidth){const y=window.devicePixelRatio;a.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*y)}this._altered.reset()}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0||this._geometry.valid===void 0)return;const a=this._context.gl,g=this._target.size;a.viewport(0,0,g[0],g[1]),a.enable(a.CULL_FACE),a.enable(a.DEPTH_TEST),a.enable(a.STENCIL_TEST),a.stencilFunc(a.ALWAYS,2,255),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),this._depthMask===!1&&(a.depthFunc(a.LEQUAL),a.depthMask(!1)),this._program.bind(),this._drawRestricted&&a.uniform1i(this._uAttachment,this._attachment),a.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind();for(const y of this._faceSequence){a.uniform1i(this._uFace,y),a.uniform4fv(this._uNormalAndLambert,this._faceData.get(y));const v=(y-1)*Df.BYTES_PER_VERTEX*4;this._topology.sliceRangeDo(this._topology.depth-1,(t,i)=>{const n=t-this._topology.numberOfInnerNodes,r=i-t+1;this._geometry.draw(n,v,r)})}this._depthMask===!1&&(a.depthFunc(a.LESS),a.depthMask(!0)),a.disable(a.STENCIL_TEST),a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE)}colorTableLengthAltered(){this._altered.alter("colorTableLength")}set target(a){this.assertInitialized(),this._target=a}set topology(a){this._topology=a}set ndcOffset(a){this.assertInitialized(),this._ndcOffset=a}set camera(a){this.assertInitialized(),this._camera!==a&&(this._camera=a,this._altered.alter("camera"))}set layoutData(a){this.assertInitialized(),this._geometry.layout=a,this._altered.alter("geometry")}set ids(a){this.assertInitialized(),this._geometry.ids=a,this._altered.alter("geometry")}set areaScales(a){this.assertInitialized(),this._geometry.areaScales=a,this._altered.alter("geometry")}set colors(a){this.assertInitialized(),this._geometry.colors=a,this._altered.alter("geometry")}set emphases(a){this.assertInitialized(),this._geometry.emphases=a,this._altered.alter("emphases")}set heights(a){this.assertInitialized(),this._geometry.heights=a,this._altered.alter("geometry")}set colorTable(a){this.assertInitialized(),this._colorTable=a,this._altered.alter("colorTable")}set outlineWidth(a){this.assertInitialized(),this._outlineWidth!==a&&(this._outlineWidth=a===void 0?Ae.OUTLINE_WIDTH_DEFAULT:Math.max(0,a),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(a){this.assertInitialized(),this._emphasisOutlineWidth!==a&&(this._emphasisOutlineWidth=a===void 0?Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,a),this._altered.alter("emphasisOutlineWidth"))}set heightScale(a){this.assertInitialized(),this._heightScale!==a&&(this._heightScale=a===void 0?0:N.gl_matrix_extensions.clamp(a,0,1),this._altered.alter("heightScale"))}set attachment(a){N.auxiliaries.logIf(a!==Ut.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=a}set depthMask(a){this._depthMask=a}},Ae.GEOMETRY_BY_CONTEXT=new Map,Ae.REFCOUNT_BY_GEOMETRY=new Map,Ae.OUTLINE_WIDTH_DEFAULT=.8,Ae.EMPHASIS_OUTLINE_WIDTH_DEFAULT=1.6,Ae);Mr([N.Initializable.assert_initialized()],Sr.prototype,"relink");Mr([N.Initializable.assert_initialized()],Sr.prototype,"optimizeFaceSequence");Mr([N.Initializable.initialize()],Sr.prototype,"initialize");Mr([N.Initializable.uninitialize()],Sr.prototype,"uninitialize");Mr([N.Initializable.assert_initialized()],Sr.prototype,"update");Mr([N.Initializable.assert_initialized()],Sr.prototype,"frame");let vr=Sr;(T=>{(a=>{a[a.Top=1]="Top",a[a.Bottom=2]="Bottom",a[a.Front=3]="Front",a[a.Back=4]="Back",a[a.Left=5]="Left",a[a.Right=6]="Right"})(T.Face||(T.Face={}))})(vr||(vr={}));var _s=j_();const ps=N.gl_matrix_extensions.v2,Ke=N.gl_matrix_extensions.v3,jf=N.gl_matrix_extensions.sign,kf=N.gl_matrix_extensions.clamp,cl=N.gl_matrix_extensions.clamp3,Or=N.auxiliaries.DEG2RAD,hl=N.auxiliaries.assert;class Xs{constructor(){this.screen=N.vec2.create(),this.world=N.vec3.create()}}const pt=class pt extends N.CameraModifier{constructor(){super(...arguments),this.initialPoints=[new Xs,new Xs],this.currentPoints=[new Xs,new Xs],this.initialEye=N.vec3.create(),this.initialCenter=N.vec3.create(),this.initialViewProjectionInverse=N.mat4.create(),this._xAxisScreenSpace=N.vec3.create(),this._maxAngles=[+Math.PI*.6666-Math.PI,60*Or-Math.PI],this._minAngles=[-Math.PI*.6666-Math.PI,-Math.PI+1*Or],this.referencePlane=[N.vec3.create(),N.vec3.create(),0]}get valid(){return this.initialPoints[0].world!==void 0}set camera(a){this._camera=a}needStart(){return this._maxAngles===void 0||this._minAngles===void 0}set coordsAccess(a){this._coordsAccess=a}static rayY0SquareIntersection(a,g){const y=N.ray_math.rayPlaneIntersection(a,g);if(y===void 0)return;const v=N.vec2.fromValues(y[0],y[2]);return N.ray_math.isPointWithinSquare(v,pt.HALF_SQUARE_LENGTH)?y:void 0}assert_valid(){}invalidate(){this.initialPoints[0].world=void 0,this.currentPoints[0].world=void 0,this.initialPoints[1].world=void 0,this.currentPoints[1].world=void 0}initiateTranslateConstraints(a){if(a){this._maxNegativeTranslate=void 0,this._maxPositiveTranslate=void 0;return}const g=N.vec3.fromValues(-1,0,-1),y=N.vec3.fromValues(1,0,1);this._maxNegativeTranslate=N.vec3.sub(Ke(),g,this.initialCenter),this._maxPositiveTranslate=N.vec3.sub(Ke(),y,this.initialCenter)}initiateScaleConstraints(a){const g=N.vec3.sub(Ke(),this.initialEye,this.initialCenter),y=1/N.vec3.length(g);if(a){this._minScale=this._camera.near*y-1,this._maxScale=this._camera.far*y-1;return}N.ray_math.rayPlaneIntersection(this.initialEye,this.initialCenter,[0,0,0],[0,1,0])&&(this._minScale=this._camera.near*pt.MIN_NEAR_PLANE_FACTOR*y-1,this._maxScale=pt.MAX_DISTANCE_TO_SQUARE*y-1)}initiateRotateConstraints(a){const g=N.vec3.normalize(Ke(),N.vec3.sub(Ke(),this.initialEye,this.initialCenter));this._xAxisScreenSpace=N.vec3.cross(Ke(),[0,1,0],g);const y=Math.acos(N.vec3.dot(g,[0,1,0]));if(this._maxAngles=[void 0,(90-.01)*Or-y],this._minAngles=[void 0,-y+.01*Or],a)return;const v=N.vec2.normalize(ps(),[g[0],g[2]]);let t=Math.asin(N.vec2.dot(v,[1,0]));v[1]<0&&(t=jf(t)*Math.PI-t),this._maxAngles=[+Math.PI*.6666-t,60*Or-y],this._minAngles=[-Math.PI*.6666-t,-y+1*Or]}initiate(a,g,y=[!1,!1,!1],v=!1){this._override=v;const t=this._camera.viewProjectionInverse;return t?(N.mat4.copy(this.initialViewProjectionInverse,t),N.vec3.copy(this.initialEye,this._camera.eye),N.vec3.copy(this.initialCenter,this._camera.center),N.vec2.copy(this.initialPoints[0].screen,a),this.initialPoints[0].world=this.coordsAt(a,!1),this.initialPoints[0].world===void 0?(this.invalidate(),!1):(this.initialPoints[1].screen=g===void 0?void 0:N.vec2.copy(ps(),g),this.initialPoints[1].world=this.coordsAt(g,!1),this.referencePlane[0]=this.initialPoints[0].world,this.referencePlane[1]=N.vec3.fromValues(0,1,0),this.referencePlane[2]=N.vec3.length(this.initialPoints[0].world),hl(this.initialCenter[1]===0,"camera center is expected to be on y = 0 (ground plane)"),y[0]&&this.initiateTranslateConstraints(v),y[1]&&this.initiateScaleConstraints(v),y[2]&&this.initiateRotateConstraints(v),!0)):!1}update_positions(a,g){return this.assert_valid(),this.currentPoints[0].world=this.coordsAt(a),this._override&&this.currentPoints[0].world===void 0?(this.invalidate(),!1):(N.vec2.copy(this.currentPoints[0].screen,a),g===void 0?!0:(this.currentPoints[1].world=this.coordsAt(g),this._override&&this.currentPoints[1].world===void 0?(this.invalidate(),!1):(this.currentPoints[1].screen=g===void 0?void 0:N.vec2.copy(ps(),g),!0)))}translate(){this.assert_valid();const a=this.initialPoints[0].world,g=this.currentPoints[0].world;if(!a||!g)return;const y=N.vec3.subtract(Ke(),a,g);this._maxNegativeTranslate&&this._maxPositiveTranslate&&cl(y,y,this._maxNegativeTranslate,this._maxPositiveTranslate),this._camera.eye=N.vec3.add(Ke(),this.initialEye,y);const v=N.vec3.add(Ke(),this.initialCenter,y),t=N.ray_math.rayPlaneIntersection(this._camera.eye,v);t&&(this._camera.center=t)}scale(a){this.assert_valid(),hl(this._minScale!==void 0&&this._maxScale!==void 0,"valid scale constraints expected");let g;if(a===void 0){const c=this.currentPoints[0].screen,f=this.initialPoints[0].screen;if(!f||!c)return;g=N.vec2.subtract(ps(),f,c)[1]/window.devicePixelRatio}else g=-jf(a)*pt.SCALE_STEP_FACTOR;g=kf(g*pt.SCALE_FACTOR,this._minScale,this._maxScale);const y=this.initialPoints[0].world;if(!y)return;const v=N.vec3.sub(Ke(),this.initialEye,y),t=N.vec3.sub(Ke(),this.initialCenter,y),i=N.vec3.add(Ke(),this.initialEye,N.vec3.scale(Ke(),v,g)),n=N.vec3.add(Ke(),this.initialCenter,N.vec3.scale(Ke(),t,g)),r=N.ray_math.rayPlaneIntersection(this._camera.eye,n);r&&(this._camera.center=this._override?r:cl(Ke(),r,[-1,0,-1],[1,0,1]),this._camera.eye=N.vec3.add(Ke(),i,N.vec3.sub(Ke(),this._camera.center,r)))}rotate(){this.assert_valid();const a=this.currentPoints[0].screen,g=this.initialPoints[0].screen;if(!g||!a)return;const y=N.vec2.subtract(ps(),g,a);N.vec2.scale(y,y,window.devicePixelRatio*pt.ROTATE_FACTOR),this._minAngles[1]&&this._maxAngles[1]&&(y[1]=kf(y[1],this._minAngles[1],this._maxAngles[1]));const v=this._override?this.initialCenter:cl(Ke(),this.initialCenter,[-1,0,-1],[1,0,1]),t=N.mat4.translate(N.mat4.create(),N.mat4.create(),v);N.mat4.rotateY(t,t,y[0]),N.mat4.rotate(t,t,y[1],this._xAxisScreenSpace),N.mat4.translate(t,t,N.vec3.negate(Ke(),v)),this._camera.center=v;const i=N.vec3.transformMat4(Ke(),this.initialEye,t);i&&(this._camera.eye=i)}coordsAt(a,g=!0){if(a===void 0)return;const y=g?this.initialViewProjectionInverse:this._camera.viewProjectionInverse;if(g){hl(this.referencePlane[0]!==void 0&&this.referencePlane[1]!==void 0,"valid reference plane expected for reference coordinate retrieval");const n=this._coordsAccess(a[0],a[1],0,y),r=this._coordsAccess(a[0],a[1],1,y);return N.ray_math.rayPlaneIntersection(n,r,this.referencePlane[0],this.referencePlane[1])}const v=this._coordsAccess(a[0],a[1],void 0,y);if(v!==void 0)return v;const t=this._coordsAccess(a[0],a[1],0,y),i=this._coordsAccess(a[0],a[1],1,y);return pt.rayY0SquareIntersection(t,i)}update(){}};pt.HALF_SQUARE_LENGTH=2,pt.SCALE_FACTOR=.004,pt.SCALE_STEP_FACTOR=16,pt.ROTATE_FACTOR=.002,pt.MAX_DISTANCE_TO_SQUARE=4,pt.MIN_NEAR_PLANE_FACTOR=4;let pl=pt;const Uf=N.auxiliaries.assert,Gf=N.gl_matrix_extensions.v2;class at{constructor(a,g){this._mouseMovedSinceDown=!1,this._cameraModifier=new pl,this._nodeEnterSubject=new _s.ReplaySubject(1),this._nodeMoveSubject=new _s.ReplaySubject(1),this._nodeLeaveSubject=new _s.ReplaySubject(1),this._nodeSelectSubject=new _s.ReplaySubject(1),this._navigationStartSubject=new _s.ReplaySubject(1),this._invalidate=a;const y="ontouchstart";this._touchSupported=document.documentElement&&y in document.documentElement||y in document.body,g.mouseEventProvider.preventDefault(N.MouseEventProvider.Type.Wheel,N.MouseEventProvider.Type.Click),g.pointerEventProvider.preventDefault(N.PointerEventProvider.Type.Down,N.PointerEventProvider.Type.Move,N.PointerEventProvider.Type.Up),this._eventHandler=new N.EventHandler(a,g),this._eventHandler.pushMouseDownHandler((v,t)=>this.onMouseDown(v,t)),this._eventHandler.pushMouseUpHandler((v,t)=>this.onMouseUp(v,t)),this._eventHandler.pushMouseMoveHandler((v,t)=>this.onMouseMove(v,t)),this._eventHandler.pushMouseWheelHandler((v,t)=>this.onMouseWheel(v,t)),this._eventHandler.pushClickHandler((v,t)=>this.onClick(v,t)),this._touchSupported&&(this._eventHandler.pushTouchStartHandler((v,t)=>this.onTouchStart(v,t)),this._eventHandler.pushTouchEndHandler((v,t)=>this.onTouchEnd(v,t)),this._eventHandler.pushTouchMoveHandler((v,t)=>this.onTouchMove(v,t)),this._eventHandler.pushTouchCancelHandler((v,t)=>this.onTouchCancel(v,t)))}mode(a){const g=a.type==="mousedown"||a.type==="mousemove",y=a.type==="wheel";if(g&&this.isPrimaryButtonDown(a))return at.Mode.Rotate;if(g&&this.isSecondaryButtonDown(a))return at.Mode.Pan;if(g&&this.isAuxiliaryButtonDown(a))return at.Mode.Zoom;if(y)return at.Mode.ZoomStep;if(this._touchSupported&&a instanceof TouchEvent&&a.touches.length===1)return at.Mode.Pan}rotate(a,g){const y=N.vec2.fromValues(a.clientX,a.clientY);g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!1,!0],a.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.rotate())}pan(a,g){const y=this._eventHandler.offsets(a)[0];g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!0,!1,!1],a.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.translate())}zoom(a,g){const y=this._eventHandler.offsets(a)[0];g||this._cameraModifier.needStart()?this._cameraModifier.initiate(y,void 0,[!1,!0,!1],a.shiftKey):(this._cameraModifier.update_positions(y),this._cameraModifier.scale())}emitNodeMovementEvents(a){if(this._idAccess===void 0)return;const g=this._eventHandler.offsets(a,!1)[0],y=N.vec2.scale(Gf(),g,window.devicePixelRatio),v=this._idAccess.idAt(y[0],y[1]);this._lastNode===v&&v!==void 0&&this._nodeMoveSubject.next({node:v,point:g}),this._lastNode!==v&&this._lastNode!==void 0&&this._nodeLeaveSubject.next({node:this._lastNode,point:g}),this._lastNode!==v&&v!==void 0&&this._nodeEnterSubject.next({node:v,point:g}),this._lastNode=v}emitNodeClick(a){if(this._idAccess===void 0)return;const g=this._eventHandler.offsets(a,!1)[0],y=N.vec2.scale(Gf(),g,window.devicePixelRatio),v=this._idAccess.idAt(y[0],y[1]);v!==void 0&&this._nodeSelectSubject.next({node:v,point:g})}applyZoomStep(a){const g=this._eventHandler.offsets(a)[0];this._cameraModifier.initiate(g,void 0,[!1,!0,!1],a.shiftKey),a.preventDefault(),this._cameraModifier.scale(a.deltaY)}onMouseDown(a,g){this._mouseMovedSinceDown=!1}onMouseUp(a,g){}onMouseMove(a,g){const y=a[a.length-1];this._mouseMovedSinceDown=!0;const v=this._mode===void 0;switch(this._mode=this.mode(y),this._mode){case at.Mode.Rotate:this.rotate(y,v),v&&this._navigationStartSubject.next();return;case at.Mode.Pan:this.pan(y,v),v&&this._navigationStartSubject.next();return;case at.Mode.Zoom:this.zoom(y,v),v&&this._navigationStartSubject.next();return;default:this.emitNodeMovementEvents(y);break}}onClick(a,g){const y=a[a.length-1];switch(this._mode){case at.Mode.Rotate:case at.Mode.Pan:case at.Mode.Zoom:return;default:this.emitNodeClick(y);break}}onMouseWheel(a,g){const y=a[a.length-1];switch(this._mode=this.mode(y),this._mode){case at.Mode.ZoomStep:this.applyZoomStep(y),this._navigationStartSubject.next();break}}onTouchStart(a,g){const y=a[a.length-1];if(this._mode=this.mode(y),this._mode===at.Mode.Pan){this.pan(y,!0);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchMove(a,g){const y=a[a.length-1],v=this._mode===void 0;if(this._mode=this.mode(y),this._mode===at.Mode.Pan){this.pan(y,v);return}Uf(this._mode===void 0,"Interactions other than pan are not implemented for touch events.")}onTouchEnd(a,g){}onTouchCancel(a,g){}isPrimaryButtonDown(a){return(a.buttons===void 0?a.which:a.buttons)===1}isSecondaryButtonDown(a){return a.buttons===void 0?a.which===3:a.buttons===2}isAuxiliaryButtonDown(a){return a.buttons===void 0?a.which===2:a.buttons===4}update(){this._eventHandler.update()}set camera(a){this._camera=a,this._cameraModifier.camera=a}set coordsAccess(a){this._coordsAccess=a,this._cameraModifier.coordsAccess=this._coordsAccess.coordsAt}set idAccess(a){this._idAccess=a}get nodeEnter$(){return this._nodeEnterSubject.asObservable()}get nodeMove$(){return this._nodeMoveSubject.asObservable()}get nodeLeave$(){return this._nodeLeaveSubject.asObservable()}get nodeSelect$(){return this._nodeSelectSubject.asObservable()}get navigationStart$(){return this._navigationStartSubject.asObservable()}}(T=>{(a=>{a[a.Move=0]="Move",a[a.Pan=1]="Pan",a[a.Rotate=2]="Rotate",a[a.Zoom=3]="Zoom",a[a.ZoomStep=4]="ZoomStep"})(T.Mode||(T.Mode={}))})(at||(at={}));var bg=Object.defineProperty,yg=Object.getOwnPropertyDescriptor,Eg=(T,a,g,y)=>{for(var v=yg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&bg(a,g,v),v};class G_ extends N.Geometry{constructor(a,g){super(a,g),g=g!==void 0&&g!==""?g:"PointGeometry",this._vertices=new N.Buffer(a,`${g}VertexVBO`),this._buffers.push(this._vertices),this._colors=new N.Buffer(a,`${g}ColorVBO`),this._buffers.push(this._colors)}bindBuffers(a){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._colors.attribEnable(this._colorLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,0)}unbindBuffers(a){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(a=0,g=1){this._vertexLocation=a,this._colorLocation=g;const y=this.context.gl;return super.initialize([y.ARRAY_BUFFER,y.ARRAY_BUFFER])&&this._vertices.valid}update(){this.bind()}draw(a=0){if(!this._count)return;const g=this.context.gl;this._vertices.attribEnable(this._vertexLocation,3,g.FLOAT,!1,0,a*4,!0,!1),this._colors.attribEnable(this._colorLocation,4,g.FLOAT,!1,0,a*4,!0,!1),g.drawArrays(g.POINTS,0,this._count)}set vertices(a){this._count=a.length/3,this._vertices.data(a,this.context.gl.STATIC_DRAW)}set colors(a){this._colors.data(a,this.context.gl.STATIC_DRAW)}get valid(){return this.initialized&&this._vertices.valid&&this._colors&&this._colors.valid}get vertexLocation(){return this._vertexLocation}get colorLocation(){return this._colorLocation}}Eg([N.Initializable.assert_initialized()],G_.prototype,"draw");var Tg=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100
attribute vec3 a_vertex;
attribute vec4 a_color;
#else

in vec3 a_vertex;
in vec4 a_color;
#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;
uniform float u_pointSize;

varying vec4 v_color;

void main(void)
{
    vec4 vertex = u_viewProjection * vec4(a_vertex, 1.0);

    v_color = a_color;

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
    gl_PointSize = u_pointSize;
}`,xg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
    #endif
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying vec4 v_color;

void main(void)
{
    
    
    

    float dist = distance(gl_PointCoord, vec2(0.5, 0.5));
    float alpha = v_color.a - step(0.5, dist);

    fragColor = vec4(v_color.xyz, alpha);
}`,Ag=Object.defineProperty,Sg=Object.getOwnPropertyDescriptor,Ss=(T,a,g,y)=>{for(var v=Sg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Ag(a,g,v),v};class Ir extends N.Initializable{constructor(a){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=a,this._program=new N.Program(a,"PointRenderProgram"),this._geometry=new G_(this._context,"Point")}relink(){for(const a of this._program.shaders)a.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uPointSize=this._program.uniform("u_pointSize"))}initialize(){const a=this._context.gl,g=new N.Shader(this._context,a.VERTEX_SHADER,"point.vert");g.initialize(Tg,!1);const y=new N.Shader(this._context,a.FRAGMENT_SHADER,"point.frag");return y.initialize(xg,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uPointSize=void 0}update(){const a=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&a.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const a=this._context.gl,g=this._target.size;a.viewport(0,0,g[0],g[1]),a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(a.depthFunc(a.LEQUAL),a.depthMask(!1)),this._program.bind(),a.uniform2fv(this._uNdcOffset,this._ndcOffset),a.uniform1f(this._uPointSize,this._pointSize*window.devicePixelRatio),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(a.depthFunc(a.LESS),a.depthMask(!0)),a.disable(a.BLEND)}set target(a){this.assertInitialized(),this._target=a}set ndcOffset(a){this.assertInitialized(),this._ndcOffset=a}set pointSize(a){this._pointSize=a}set camera(a){this.assertInitialized(),this._camera!==a&&(this._camera=a,this._altered.alter("camera"))}set positions(a){this._geometry.vertices=a,this._altered.alter("geometry")}set colors(a){this.assertInitialized(),this._geometry.colors=a,this._altered.alter("geometry")}set depthMask(a){this._depthMask=a}}Ss([N.Initializable.assert_initialized()],Ir.prototype,"relink");Ss([N.Initializable.initialize()],Ir.prototype,"initialize");Ss([N.Initializable.uninitialize()],Ir.prototype,"uninitialize");Ss([N.Initializable.assert_initialized()],Ir.prototype,"update");Ss([N.Initializable.assert_initialized()],Ir.prototype,"frame");var Og=Object.defineProperty,Rg=Object.getOwnPropertyDescriptor,wg=(T,a,g,y)=>{for(var v=Rg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Og(a,g,v),v},mr;const q_=(mr=class extends N.Geometry{constructor(a,g){super(a,g),g=g!==void 0&&g!==""?g:"QuadGeometry",this._vertices=new N.Buffer(a,g+"VertexVBO"),this._buffers.push(this._vertices),this._layout=new N.Buffer(a,g+"LayoutVBO"),this._buffers.push(this._layout),this._ids=new N.Buffer(a,g+"IdVBO"),this._buffers.push(this._ids),this._emphases=new N.Buffer(a,g+"EmphasisVBO"),this._buffers.push(this._emphases),this._colors=new N.Buffer(a,g+"ColorVBO"),this._buffers.push(this._colors)}bindBuffers(a){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._layout.attribEnable(this._layoutLocation,4,g.FLOAT,!1,0,0,!0,!1),y.vertexAttribDivisor(this._layoutLocation,1),this._ids.attribEnable(this._idLocation,4,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._idLocation,1),this._emphases.attribEnable(this._emphasisLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._emphasisLocation,1),this._colors.attribEnable(this._colorLocation,1,g.UNSIGNED_BYTE,!1,0,0,!0,!1),y.vertexAttribDivisor(this._colorLocation,1)}unbindBuffers(a){this._vertices.attribDisable(this.vertexLocation,!1,!1),this._layout.attribDisable(this._layoutLocation,!1,!1),this._ids.attribDisable(this._idLocation,!1,!1),this._emphases.attribDisable(this._emphasisLocation,!1,!1),this._colors.attribDisable(this._colorLocation,!1,!1)}initialize(a=0,g=2,y=3,v=4,t=5){this._vertexLocation=a,this._idLocation=y,this._layoutLocation=g,this._colorLocation=t,this._emphasisLocation=v;const i=this.context.gl,n=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(mr.DATA,i.STATIC_DRAW),n&&this._vertices.valid}update(){this.bind()}draw(a=0,g=0){const y=this.context.gl,v=this.context.gl2facade;this._ids.attribEnable(this._idLocation,4,y.UNSIGNED_BYTE,!1,4,a*4,!0,!1),this._layout.attribEnable(this._layoutLocation,4,y.FLOAT,!1,16,a*16,!0,!1),this._colors.attribEnable(this._colorLocation,1,y.UNSIGNED_BYTE,!1,1,a*1,!0,!1),this._emphases.attribEnable(this._emphasisLocation,1,y.UNSIGNED_BYTE,!1,1,a*1,!0,!1),v.drawArraysInstanced(y.TRIANGLE_STRIP,0,4,g)}set layout(a){this._layout.data(a,this.context.gl.STATIC_DRAW)}set ids(a){this._ids.data(a,this.context.gl.STATIC_DRAW)}set colors(a){this._colors.data(a,this.context.gl.STATIC_DRAW)}set emphases(a){this._emphases.data(a,this.context.gl.STATIC_DRAW)}get valid(){const a=this._layout&&this._layout.valid,g=this._ids&&this._ids.valid,y=this._colors&&this._colors.valid,v=this._emphases&&this._emphases.valid;return this.initialized&&this._vertices.valid&&a&&g&&y&&v}get vertexLocation(){return this._vertexLocation}get layoutLocation(){return this._layoutLocation}get idLocation(){return this._idLocation}get emphasisLocation(){return this._emphasisLocation}get colorLocation(){return this._colorLocation}},mr.DATA=new Float32Array([0,0,0,1,1,0,1,1]),mr);wg([N.Initializable.assert_initialized()],q_.prototype,"draw");let Pg=q_;var Lg=`#if __VERSION__ == 100
    #extension GL_EXT_draw_buffers : enable
#endif

precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

attribute vec2 a_vertex;
attribute vec4 a_layout; 
attribute vec4 a_id; /* encoded uint32 id in byte4 */
attribute float a_color; /* color index as unsigned byte */
attribute float a_emphasis; /* emphasis mode as unsigned byte */

#else

/* Note: do not use layout location specifier, since they take precedence over CPU managed locations. */
in vec2 a_vertex;
in vec4 a_layout; /* [ position: vec2, extent: vec2 ] */
in vec4 a_id; /* encoded uint32 id in byte4 */
in float a_color; /* color index as unsigned byte */
in float a_emphasis; /* emphasis mode as unsigned byte */

#endif

uniform mat4 u_viewProjection;
uniform vec2 u_ndcOffset;

uniform vec4 u_colorTable[$ColorTableLength];

uniform float u_outlineWidth;
uniform float u_emphasisOutlineWidth;

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying vec2 v_uv;
varying vec4 v_layout;

const float ONE_OVER_255 = 1.0 / 255.0;

const float OUTLINE_LAMBERT_SCALE = 0.88; /* @todo expose to API */

const int EMPHASIS_COLOR_INDEX = 0;

void main(void)
{
    vec4 emphasisColor = u_colorTable[EMPHASIS_COLOR_INDEX];

    vec4 pos = vec4(a_layout[0], 0.0, a_layout[1], 0.0);
    vec4 ext = vec4(a_layout[2], 0.0, a_layout[3], 1.0);

    vec4 vertex = vec4(a_vertex.x, 0.0, a_vertex.y, 1.0) * ext + pos;

    v_uv = vertex.xz;
    v_layout = a_layout;
    v_id = a_id * ONE_OVER_255;

    vertex = u_viewProjection * vertex;

    /* If emphasis is < 2 use the color lookup, else apply outline color. */
    v_baseColor = mix(u_colorTable[int(a_color)], emphasisColor, step(2.0, a_emphasis));
    v_outlineColor.rgb = mix(v_baseColor.rgb, emphasisColor.rgb, step(1.0, a_emphasis));

    /* The default outline (emphasis = 0.0) should be a little bit darker, when in outline mode (emphasis = 1.0) the
    outline should remain unchanged (except for face lambda), and when highlighting (emphasis = 2.0) the outline is
    lightened a little bit (invere darkening lambda). The mix is utilized to create this. */
    v_outlineColor.rgb *= mix(OUTLINE_LAMBERT_SCALE, (1.0 / OUTLINE_LAMBERT_SCALE), a_emphasis * 0.5);

    /* The outline width is encoded within the alpha channel of the outline (special if emphasized). */
    v_outlineColor[3] = mix(u_emphasisOutlineWidth, u_outlineWidth, step(0.5, abs(a_emphasis - 1.0)));

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,Mg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100

    #ifdef GL_EXT_draw_buffers
        #extension GL_EXT_draw_buffers : enable
        #define fragColor gl_FragData[0].rgba
        #define fragId gl_FragData[1].xyzw
    #else
        #define DRAW_RESTRICTED
        #define fragColor gl_FragColor.rgba
        #define fragId gl_FragColor.xyzw
        #define fragDepth gl_FragColor.xyz
    #endif

    #ifdef GL_OES_standard_derivatives
        #extension GL_OES_standard_derivatives : enable
        #define ANTIALIASED_CONTOUR
    #endif

#else
    layout(location = 0) out vec4 fragColor;
    layout(location = 1) out vec4 fragId;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

#ifdef DRAW_RESTRICTED
    const float one255ths = 1.0 / 255.0;

vec3 float24x1_to_uint8x3(const in float f) {
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));
    return floor(uint8x3 * 256.0) * one255ths;
}

vec4 float24x1_to_uint8x4(const in float f) {
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));
    return floor(uint8x4 * 256.0) * one255ths;
}

const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);
float uint8x3_to_float24x1(const in vec3 v) {
    return dot(v, premultUint8x3); 
}

const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);
float uint8x4_to_float24x1(const in vec4 v) {
    return dot(v, premultUint8x4); 
}
    uniform int u_attachment;
#endif

varying vec4 v_baseColor;
varying vec4 v_outlineColor;
varying vec4 v_id;

varying mediump vec2 v_uv;
varying mediump vec4 v_layout;

void main(void)
{
#ifdef DRAW_RESTRICTED
    if(u_attachment == 0) {
#endif

    
    vec2 awidth = fwidth(v_uv.st) * v_outlineColor[3];

    vec4 ctest; /* Used for countour/ctest testing. */
    ctest.xy = step((v_uv.st - v_layout.xy) - awidth.xy, vec2(0.0));
    ctest.zw = step(vec2(0.0), (v_uv.st - v_layout.xy) - v_layout.zw + awidth.xy);
    float outline = clamp(dot(ctest, vec4(1.0)), 0.0, 1.0);

    fragColor = mix(v_baseColor, vec4(v_outlineColor.rgb, 1.0), outline);

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 1) {
#endif

    fragId = v_id;

#ifdef DRAW_RESTRICTED
    } else if(u_attachment == 2) {
        fragDepth = float24x1_to_uint8x3(gl_FragCoord.z);
    }
#endif
}`,Ig=Object.defineProperty,Fg=Object.getOwnPropertyDescriptor,Os=(T,a,g,y)=>{for(var v=Fg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Ig(a,g,v),v};class Fr extends N.Initializable{constructor(a){super(),this._standardDerivatives=void 0,this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1,colorTable:!1,emphases:!1,outlineWidth:!0,emphasisOutlineWidth:!0}),this._showRoot=!1,this._outlineWidth=vr.OUTLINE_WIDTH_DEFAULT,this._emphasisOutlineWidth=vr.EMPHASIS_OUTLINE_WIDTH_DEFAULT,this._attachment=Ut.Attachment.Undefined,this._context=a,this._program=new N.Program(a,"QuadRenderProgram"),this._geometry=new Pg(this._context,"Quad")}relink(){if(this._colorTable!==void 0){for(const a of this._program.shaders)a.replace("$ColorTableLength",String(this._colorTable.length/4));this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_layout",this._geometry.layoutLocation),this._program.attribute("a_id",this._geometry.idLocation),this._program.attribute("a_color",this._geometry.colorLocation),this._program.attribute("a_emphasis",this._geometry.emphasisLocation);for(const a of this._program.shaders)a.compile();this._program.link(),this._program.linked&&(this._drawRestricted&&(this._uAttachment=this._program.uniform("u_attachment")),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColorTable=this._program.uniform("u_colorTable"),this._uOutlineWidth=this._program.uniform("u_outlineWidth"),this._uEmphasisOutlineWidth=this._program.uniform("u_emphasisOutlineWidth"))}}initialize(){const a=this._context.gl;this._drawRestricted=!this._context.isWebGL2&&!this._context.supportsDrawBuffers,this._context.isWebGL1&&this._standardDerivatives===void 0&&(this._context.enable(["OES_standard_derivatives"]),this._standardDerivatives=this._context.standardDerivatives);const g=new N.Shader(this._context,a.VERTEX_SHADER,"quad.vert");g.initialize(Lg,!1);const y=new N.Shader(this._context,a.FRAGMENT_SHADER,"quad.frag");return y.initialize(Mg,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uAttachment=void 0,this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColorTable=void 0,this._uOutlineWidth=void 0,this._uEmphasisOutlineWidth=void 0}update(){const a=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&a.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._colorTable&&a.uniform4fv(this._uColorTable,this._colorTable),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.outlineWidth&&a.uniform1f(this._uOutlineWidth,this._outlineWidth),this._target&&this._target.valid&&a.uniform1f(this._uEmphasisOutlineWidth,this._emphasisOutlineWidth*window.devicePixelRatio),this._altered.reset())}frame(){if(N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected"),this._colorTable===void 0)return;const a=this._context.gl,g=this._target.size;if(a.viewport(0,0,g[0],g[1]),a.enable(a.CULL_FACE),a.enable(a.DEPTH_TEST),a.enable(a.STENCIL_TEST),a.stencilFunc(a.GREATER,1,255),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),this._depthMask===!1&&(a.depthFunc(a.LEQUAL),a.depthMask(!1)),this._program.bind(),this._drawRestricted&&a.uniform1i(this._uAttachment,this._attachment),a.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid){const y=this._topology.linearization.slices,v=this._showRoot===!1?1:0;for(let t=y.length-2;t>=v;--t){const i=y[t][0],n=y[t][1]-y[t][0]+1;this._geometry.draw(i,n)}}this._depthMask===!1&&(a.depthFunc(a.LESS),a.depthMask(!0)),a.disable(a.STENCIL_TEST),a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE)}set target(a){this.assertInitialized(),this._target=a}set ndcOffset(a){this.assertInitialized(),this._ndcOffset=a}set camera(a){this.assertInitialized(),this._camera!==a&&(this._camera=a,this._altered.alter("camera"))}set layout(a){this.assertInitialized(),this._geometry.layout=a,this._altered.alter("geometry")}set ids(a){this.assertInitialized(),this._geometry.ids=a,this._altered.alter("geometry")}set colors(a){this.assertInitialized(),this._geometry.colors=a,this._altered.alter("geometry")}set emphases(a){this.assertInitialized(),this._geometry.emphases=a,this._altered.alter("emphases")}set showRoot(a){this._showRoot=a}set topology(a){this._topology=a}set colorTable(a){this.assertInitialized(),this._colorTable=a,this._altered.alter("colorTable")}set outlineWidth(a){this.assertInitialized(),this._outlineWidth!==a&&(this._outlineWidth=a===void 0?vr.OUTLINE_WIDTH_DEFAULT:Math.max(0,a),this._altered.alter("outlineWidth"))}set emphasisOutlineWidth(a){this.assertInitialized(),this._emphasisOutlineWidth!==a&&(this._emphasisOutlineWidth=a===void 0?vr.EMPHASIS_OUTLINE_WIDTH_DEFAULT:Math.max(0,a),this._altered.alter("emphasisOutlineWidth"))}set attachment(a){N.auxiliaries.logIf(a!==Ut.Attachment.Undefined&&!this._drawRestricted,N.auxiliaries.LogLevel.Debug,"expected WEBGL_draw_buffers to be unsupported"),this._attachment=a}set depthMask(a){this._depthMask=a}}Os([N.Initializable.assert_initialized()],Fr.prototype,"relink");Os([N.Initializable.initialize()],Fr.prototype,"initialize");Os([N.Initializable.uninitialize()],Fr.prototype,"uninitialize");Os([N.Initializable.assert_initialized()],Fr.prototype,"update");Os([N.Initializable.assert_initialized()],Fr.prototype,"frame");var Cg=Object.defineProperty,Ng=Object.getOwnPropertyDescriptor,zg=(T,a,g,y)=>{for(var v=Ng(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Cg(a,g,v),v};const Bg=N.auxiliaries.assert;var gr;const W_=(gr=class extends N.Geometry{constructor(a,g){super(a,g),Bg(a.isWebGL2||a.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),g=g!==void 0&&g!==""?g:"ScreenAlignedQuadGeometry",this._vertices=new N.Buffer(a,`${g}VertexVBO`),this._buffers.push(this._vertices),this._origins=new N.Buffer(a,`${g}OriginVBO`),this._buffers.push(this._origins),this._extents=new N.Buffer(a,`${g}ExtentVBO`),this._buffers.push(this._extents),this._offsets=new N.Buffer(a,`${g}OffsetVBO`),this._buffers.push(this._offsets),this._pointyCorners=new N.Buffer(a,`${g}PointyCornerVBO`),this._buffers.push(this._pointyCorners)}bindBuffers(a){const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._vertexLocation,0),this._origins.attribEnable(this._originLocation,3,g.FLOAT,!1,12,0,!0,!1),y.vertexAttribDivisor(this._originLocation,1),this._extents.attribEnable(this._extentLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._extentLocation,1),this._offsets.attribEnable(this._offsetLocation,2,g.FLOAT,!1,8,0,!0,!1),y.vertexAttribDivisor(this._offsetLocation,1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,g.UNSIGNED_BYTE,!1,1,0,!0,!1),y.vertexAttribDivisor(this._pointyCornerLocation,1)}unbindBuffers(a){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._extents.attribDisable(this._extentLocation,!1,!1),this._offsets.attribDisable(this._offsetLocation,!1,!1),this._pointyCorners.attribDisable(this._pointyCornerLocation,!1,!1)}initialize(a=0,g=1,y=2,v=3,t=4){this._vertexLocation=a,this._originLocation=g,this._extentLocation=y,this._offsetLocation=v,this._pointyCornerLocation=t;const i=this.context.gl,n=super.initialize([i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER]);return this._vertices.data(gr.VERTICES,i.STATIC_DRAW),n&&this._vertices.valid}updateData(a,g,y,v){this.bind(),this._count=a.length/3,this._origins.data(a,this.context.gl.STATIC_DRAW),this._extents.data(g,this.context.gl.STATIC_DRAW),this._offsets.data(y,this.context.gl.STATIC_DRAW),this._pointyCorners.data(v,this.context.gl.STATIC_DRAW)}update(){this.bind()}draw(a=0){if(!this._count)return;const g=this.context.gl,y=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,g.FLOAT,!1,8,0,!0,!1),this._origins.attribEnable(this._originLocation,3,g.FLOAT,!1,12,a*12,!0,!1),this._extents.attribEnable(this._extentLocation,2,g.FLOAT,!1,8,a*8,!0,!1),this._offsets.attribEnable(this._offsetLocation,2,g.FLOAT,!1,8,a*8,!0,!1),this._pointyCorners.attribEnable(this._pointyCornerLocation,1,g.UNSIGNED_BYTE,!1,1,a*1,!0,!1),y.drawArraysInstanced(g.TRIANGLE_STRIP,0,4,this._count)}get valid(){return this.initialized&&this._vertices.valid&&this._origins&&this._origins.valid&&this._offsets&&this._offsets.valid&&this._extents&&this._extents.valid&&this._pointyCorners&&this._pointyCorners.valid}get vertexLocation(){return this._vertexLocation}get originLocation(){return this._originLocation}get extentLocation(){return this._extentLocation}get offsetLocation(){return this._offsetLocation}get pointyCornerLocation(){return this._pointyCornerLocation}},gr.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),gr);zg([N.Initializable.assert_initialized()],W_.prototype,"draw");let Dg=W_;var jg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
#else 
    #define varying out
#endif
void ndcOffset(inout vec4 vertex, in vec2 offset) {
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;
}

#if __VERSION__ == 100

#extension GL_EXT_draw_buffers : enable
attribute vec2 a_vertex;
attribute vec3 a_origin;
attribute vec2 a_extent;
attribute vec2 a_offset;
attribute float a_pointyCorner;

#else

in vec2 a_vertex;
in vec3 a_origin;
in vec2 a_extent;
in vec2 a_offset;
in float a_pointyCorner; 

#endif

uniform vec2 u_ndcOffset;
uniform mat4 u_viewProjection;
uniform float u_aspectRatio;

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

float modI(float a, float b) {
    float m = a - floor((a + 0.5) / b) * b;
    return floor(m + 0.5);
}

void main(void)
{
    v_pointyCornerLeft = step(a_pointyCorner, 2.0);
    v_pointyCornerBottom = modI(a_pointyCorner, 2.0);

    /* POSITIONING */
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.
     * 2-------4
     * |  \\    |
     * |    \\  |
     * 1-------3
     * The current vertex is calculated based on the current quad corners and the extent attributes.
     */

    vec2 extent = a_extent;
    vec2 offset = a_offset;

    
    float radius = extent.y * u_aspectRatio * 0.5;
    extent.x += radius;
    offset.x -= mix(radius, 0.0, step(a_pointyCorner, 2.0));

    v_extent = vec2(extent.x, extent.y * u_aspectRatio);
    v_uv = a_vertex * vec2(extent.x, extent.y * u_aspectRatio);
    v_radius = radius;

    vec4 origin = u_viewProjection * vec4(a_origin, 1.0);
    vec2 originNDC = vec2(origin.x / origin.w, origin.y / origin.w);
    vec4 vertex = vec4(originNDC + a_vertex * extent + offset, origin.z/origin.w, 1.0);

    ndcOffset(vertex, u_ndcOffset);
    gl_Position = vertex;
}`,kg=`precision highp float;
precision lowp int;

#if __VERSION__ == 100
    #define fragColor gl_FragColor
#else
    layout(location = 0) out vec4 fragColor;
#endif

#if __VERSION__ == 100
    #define texture(sampler, coord) texture2D(sampler, coord)
#else
    #define varying in
#endif

varying float v_radius;
varying vec2 v_uv; 
varying vec2 v_extent;
varying float v_pointyCornerLeft; 
varying float v_pointyCornerBottom; 

const float ALPHA = 0.8;
const vec3 COLOR = vec3(1.0);

void main(void)
{
    

    
    vec2 mLeft =  vec2(v_radius);
    vec2 mRight = vec2(v_extent.x - v_radius, v_radius);

    
    float borderLeft =   step(v_uv.x, mLeft.x);
    float borderBottom = step(v_uv.y, mLeft.y);
    float borderRight =  step(mRight.x, v_uv.x);
    float borderTop =    step(mRight.y, v_uv.y);

    float alphaLeft =  step(v_radius, distance(v_uv, mLeft))  * borderLeft;
    float alphaRight = step(v_radius, distance(v_uv, mRight)) * borderRight;

    
    
    float alphaLeftBottom =  alphaLeft  * borderBottom;
    float alphaLeftTop =     alphaLeft  * borderTop;
    float alphaRightBottom = alphaRight * borderBottom;
    float alphaRightTop =    alphaRight * borderTop;

    
    float pointyLeftBottom =         v_pointyCornerLeft  *        v_pointyCornerBottom;
    float pointyLeftTop =            v_pointyCornerLeft  * (1.0 - v_pointyCornerBottom);
    float pointyRightBottom = (1.0 - v_pointyCornerLeft) *        v_pointyCornerBottom;
    float pointyRightTop =    (1.0 - v_pointyCornerLeft) * (1.0 - v_pointyCornerBottom);

    
    float shouldBeCutAway = sign(
          alphaLeftBottom  * (1.0 - pointyLeftBottom)
        + alphaLeftTop     * (1.0 - pointyLeftTop)
        + alphaRightBottom * (1.0 - pointyRightBottom)
        + alphaRightTop    * (1.0 - pointyRightTop));

    float alpha = mix(ALPHA, 0.0, shouldBeCutAway);
    fragColor = vec4(COLOR, alpha);
}`,Ug=Object.defineProperty,Gg=Object.getOwnPropertyDescriptor,Rs=(T,a,g,y)=>{for(var v=Gg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Ug(a,g,v),v};class Cr extends N.Initializable{constructor(a){super(),this._altered=Object.assign(new N.ChangeLookup,{any:!1,camera:!1,geometry:!1}),this._context=a,this._program=new N.Program(a,"ScreenAlignedQuadRenderProgram"),this._geometry=new Dg(this._context,"ScreenAlignedQuad")}relink(){for(const a of this._program.shaders)a.compile();this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_extent",this._geometry.extentLocation),this._program.attribute("a_offset",this._geometry.offsetLocation),this._program.attribute("a_pointyCorner",this._geometry.pointyCornerLocation),this._program.link(),this._program.linked&&(this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uAspectRatio=this._program.uniform("u_aspectRatio"))}initialize(){const a=this._context.gl,g=new N.Shader(this._context,a.VERTEX_SHADER,"screenalignedquad.vert");g.initialize(jg,!1);const y=new N.Shader(this._context,a.FRAGMENT_SHADER,"screenalignedquad.frag");return y.initialize(kg,!1),this._program.initialize([y,g],!1),this._geometry.initialize(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uAspectRatio=void 0}update(){const a=this._context.gl;(!this._program.initialized||!this._program.linked)&&(this.relink(),!this._program.linked)||(this._program.bind(),(this._altered.camera||this._camera.altered)&&(a.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),a.uniform1f(this._uAspectRatio,1/this._camera.aspect)),this._altered.geometry&&this._geometry.valid&&this._geometry.update(),this._altered.reset())}frame(){N.auxiliaries.assert(this._target&&this._target.valid,"valid target expected");const a=this._context.gl,g=this._target.size;a.viewport(0,0,g[0],g[1]),a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),this._depthMask===!1&&(a.depthFunc(a.LEQUAL),a.depthMask(!1)),this._program.bind(),a.uniform2fv(this._uNdcOffset,this._ndcOffset),this._geometry.bind(),this._target.bind(),this._geometry.valid&&this._geometry.draw(),this._depthMask===!1&&(a.depthFunc(a.LESS),a.depthMask(!0)),a.disable(a.BLEND)}set target(a){this.assertInitialized(),this._target=a}set ndcOffset(a){this.assertInitialized(),this._ndcOffset=a}set camera(a){this.assertInitialized(),this._camera!==a&&(this._camera=a,this._altered.alter("camera"))}updateData(a,g,y,v){this._geometry.updateData(a,g,y,v),this._altered.alter("geometry")}set depthMask(a){this._depthMask=a}}Rs([N.Initializable.assert_initialized()],Cr.prototype,"relink");Rs([N.Initializable.initialize()],Cr.prototype,"initialize");Rs([N.Initializable.uninitialize()],Cr.prototype,"uninitialize");Rs([N.Initializable.assert_initialized()],Cr.prototype,"update");Rs([N.Initializable.assert_initialized()],Cr.prototype,"frame");const qg="/treemap-renderer/assets/roboto-C39txIsk.fnt",Wg="/treemap-renderer/assets/roboto-Cij1YBZt.png",Vg=N.auxiliaries.log,$g=N.auxiliaries.LogLevel,Rr=N.auxiliaries.assert,dl=3.5,pr=class pr extends N.Renderer{constructor(a){super(),this._ndcOffsetScale=1,this.coordsAt=(g,y,v,t)=>this._readbackPass.coordsAt(g,y,v,t===void 0?this._camera.viewProjectionInverse:t),this.idAt=(g,y)=>{if(!this._geometry.initialized)return;const v=this._readbackPass.idAt(g,y);if(v===void 0||v===0)return;const t=this._geometry.topology.node(v);return t===void 0?void 0:t.id},this._visualization=a}get geometry(){return this._geometry}set geometry(a){this._geometry=a}get navigation(){return this._navigation}get camera(){return this._camera}set ndcOffsetScale(a){this._ndcOffsetScale!==a&&(this._ndcOffsetScale=a,this.invalidate())}get ndcOffsetScale(){return this._ndcOffsetScale}static verifyMinimumContextRequirements(a){return a.enable(["ANGLE_instanced_arrays","OES_standard_derivatives"]),!0}renderInnerNodes(a,g,y){this._geometry.valid&&(this._innerPass.target=a,this._innerPass.attachment=g,this._innerPass.depthMask=y,this._innerPass.frame())}renderLeafNodes(a,g,y){this._geometry.valid&&this._geometry.leafNodeHeights&&(this._leafPass.target=a,this._leafPass.attachment=g,this._leafPass.depthMask=y,this._leafPass.frame())}renderLeafLabelBackgrounds(a,g){this._labelBackgroundPass.target=a,this._labelBackgroundPass.depthMask=g,this._labelBackgroundPass.frame()}renderPoints(a,g){this._pointPass.target=a,this._pointPass.depthMask=g,this._pointPass.frame()}renderInnerLabels(a,g,y){if(!this._geometry.valid)return;this._innerLabelPass.target=a,this._innerLabelPass.depthMask=y;const v=this._context.gl;v.enable(v.STENCIL_TEST),v.enable(v.DEPTH_TEST),v.stencilFunc(v.EQUAL,1,255),v.stencilOp(v.KEEP,v.KEEP,v.KEEP),this._innerLabelPass.frame(),v.disable(v.STENCIL_TEST)}renderLeafLabels(a,g,y){this._geometry.valid&&(this._leafLabelPass.target=a,this._leafLabelPass.depthMask=y,this._leafLabelPass.frame())}initializeMultiRenderTarget(a){this.assertUninitialized(),this._multiRenderTarget=new Ut(a),this._multiRenderTarget.initialize(),this._multiRenderTarget.primaryFBO.clearStencil(0),this._multiRenderTarget.secondaryFBO.clearStencil(0)}initializeLeafPasses(a){this._leafPass=new vr(a),this._leafPass.initialize(),this._leafPass.camera=this._camera}initializeInnerPass(a){this.assertUninitialized(),this._innerPass=new Fr(a),this._innerPass.initialize(),this._innerPass.camera=this._camera}initializePointPass(a){this._pointPass=new Ir(a),this._pointPass.initialize(),this._pointPass.camera=this.camera,this._pointPass.pointSize=dl}initializeLeafLabelBackgroundPass(a){this._labelBackgroundPass=new Cr(a),this._labelBackgroundPass.initialize(),this._labelBackgroundPass.camera=this.camera}initializeLabelPasses(a){this.assertUninitialized(),this._innerLabelPass=new N.LabelRenderPass(a),this._innerLabelPass.initialize(),this._innerLabelPass.camera=this.camera,this._innerLabelPass.target=this._multiRenderTarget.defaultFBO,this._innerLabelPass.depthFunc=a.gl.ALWAYS,this._innerLabelPass.aaStepScale=.3,this._innerLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass=new N.LabelRenderPass(a),this._leafLabelPass.initialize(),this._leafLabelPass.camera=this.camera,this._leafLabelPass.target=this._multiRenderTarget.defaultFBO,this._leafLabelPass.aaStepScale=.3,this._leafLabelPass.aaSampling=N.LabelRenderPass.Sampling.Grid3x3,this._leafLabelPass.depthFunc=a.gl.ALWAYS,N.FontFace.fromFiles(qg,new Map([[0,Wg]]),a).then(g=>{for(const y of this._innerLabelPass.labels)y.fontFace=g;for(const y of this._leafLabelPass.labels)y.fontFace=g;this._fontFace=g,this._innerLabelPass.update(!0),this._leafLabelPass.update(!0),this._visualization.configuration&&(this._visualization.configuration.altered.alter("geometry"),this._visualization.configuration.altered.alter("labels")),this.invalidate()}).catch(g=>N.auxiliaries.log(N.auxiliaries.LogLevel.Error,g))}initializeAccumulationPass(a){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._accumulationPass=new N.AccumulatePass(a),this._accumulationPass.initialize(this._ndcTriangle),this._accumulationPass.precision=this._framePrecision,this._accumulationPass.texture=this._multiRenderTarget.colorRenderTexture}initializeBlitPass(a){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined");const g=this._context.gl,y=this._context.gl2facade;this._blitPass=new N.BlitPass(a),this._blitPass.initialize(this._ndcTriangle),this._blitPass.readBuffer=y.COLOR_ATTACHMENT0,this._blitPass.drawBuffer=g.BACK,this._blitPass.target=this._multiRenderTarget.defaultFBO}initializeReadbackPass(a){this.assertUninitialized(),Rr(this._multiRenderTarget.initialized,"expected multi-render target to be initialized"),Rr(this._ndcTriangle!==void 0,"expected NDC triangle to be defined"),this._readbackPass=new N.ReadbackPass(a),this._readbackPass.initialize(this._ndcTriangle,this._multiRenderTarget.depthFBO!==void 0),this._readbackPass.cache=!0;const g=this._context.gl,y=this._context.gl2facade;this._multiRenderTarget.depthFBO?(this._readbackPass.depthFBO=this._multiRenderTarget.depthFBO,this._readbackPass.depthAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.depthFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.depthAttachment=g.DEPTH_STENCIL_ATTACHMENT),this._multiRenderTarget.readBackIdFBO?(this._readbackPass.idFBO=this._multiRenderTarget.readBackIdFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT0):(this._readbackPass.idFBO=this._multiRenderTarget.primaryFBO,this._readbackPass.idAttachment=y.COLOR_ATTACHMENT1)}initializeCamera(){this.assertUninitialized(),this._camera=new N.Camera,this._camera.near=pr.CAMERA_NEAR_DEFAULT,this._camera.far=pr.CAMERA_FAR_DEFAULT,this._camera.eye=N.vec3.fromValues(0,1.5,2.2),this._camera.center=N.vec3.fromValues(0,0,.2),this._camera.up=N.vec3.fromValues(0,1,0),this._camera.fovy=2*N.Camera.calculateFovY(20,60)*N.auxiliaries.RAD2DEG}initializeNavigation(a,g){this.assertUninitialized(),this._navigation=new at(a,g),this._navigation.camera=this._camera,this._navigation.idAccess=this,this._navigation.coordsAccess=this}onInitialize(a,g,y){return pr.verifyMinimumContextRequirements(a)?(this._ndcOffsetKernel=new N.AntiAliasingKernel(this._multiFrameNumber),this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength),this._ndcTriangle=new N.NdcFillingTriangle(a,"NdcTriangle"),this._ndcTriangle.initialize(0),this.initializeMultiRenderTarget(a),this.initializeAccumulationPass(a),this.initializeBlitPass(a),this.initializeReadbackPass(a),this.initializeCamera(),this.initializeNavigation(g,y),this.initializeInnerPass(a),this.initializeLeafPasses(a),this.initializePointPass(a),this.initializeLeafLabelBackgroundPass(a),this.initializeLabelPasses(a),!0):!1}onUninitialize(){this._ndcTriangle.uninitialize(),this._multiRenderTarget.uninitialize(),this._accumulationPass.uninitialize(),this._blitPass.uninitialize(),this._readbackPass.uninitialize(),this._innerPass.uninitialize(),this._pointPass.uninitialize(),this._innerLabelPass.uninitialize(),this._leafLabelPass.uninitialize(),this._labelBackgroundPass.uninitialize()}onDiscarded(){}onUpdate(){this._navigation.update();let a=!1;try{a=this._visualization.update()}catch(y){Vg($g.Error,y)}let g=!1;for(const y of this._innerLabelPass.labels)if(y.altered||y.color.altered){g=!0;break}for(const y of this._leafLabelPass.labels)if(y.altered||y.color.altered){g=!0;break}return a||g||this._altered.any||this._camera.altered}onPrepare(){this._geometry.altered.any&&this._geometry.valid&&(this._innerPass.ids=this._geometry.innerNodeIndices,this._innerPass.layout=this._geometry.innerNodeLayouts,this._innerPass.colors=this._geometry.innerNodeColors,this._innerPass.emphases=this._geometry.innerNodeEmphases,this._innerPass.colorTable=this._geometry.colorTable,this._innerPass.topology=this._geometry.topology,this._innerPass.showRoot=this._geometry.showRoot,this._leafPass.ids=this._geometry.leafNodeIndices,this._leafPass.layoutData=this._geometry.leafNodeLayouts,this._leafPass.areaScales=this._geometry.leafNodeAreaScales,this._leafPass.colors=this._geometry.leafNodeColors,this._leafPass.emphases=this._geometry.leafNodeEmphases,this._leafPass.heights=this._geometry.leafNodeHeights,this._leafPass.colorTable=this._geometry.colorTable,this._leafPass.topology=this._geometry.topology),this._geometry.altered.colorTableLength&&this._leafPass.colorTableLengthAltered(),this._geometry.altered.outlineWidth&&(this._innerPass.outlineWidth=this._geometry.outlineWidth,this._leafPass.outlineWidth=this._geometry.outlineWidth),this._geometry.altered.emphasisOutlineWidth&&(this._innerPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth,this._leafPass.emphasisOutlineWidth=this._geometry.emphasisOutlineWidth),this._geometry.altered.heightScale&&(this._leafPass.heightScale=this._geometry.heightScale),this._altered.frameSize&&(this._multiRenderTarget.resize(this._frameSize[0],this._frameSize[1]),this._camera.viewport=[this._frameSize[0],this._frameSize[1]],this.invalidate()),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1],this._readbackPass.coordinateReferenceSize=this._canvasSize),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber,this._ndcOffsetKernel.sort(N.AbstractKernel.SortApproach.BySquaredLength)),this._altered.framePrecision&&(this._accumulationPass.precision=this._framePrecision),this._altered.clearColor&&this._multiRenderTarget.setClearColor(this._clearColor),this._innerPass.update(),this._leafPass.update(),this._pointPass.update(),this._labelBackgroundPass.update(),this._innerLabelPass.update(),this._leafLabelPass.update(),this._accumulationPass.update(),this._readbackPass.frame(),this._visualization.prepare(),this._camera.altered=!1,this._geometry.altered.reset(),this._altered.reset()}onFrame(a){const g=this._context.gl,y=this._context.gl2facade,v=this._ndcOffsetKernel.get(a);v[0]=this._ndcOffsetScale*2*v[0]/this._frameSize[0],v[1]=this._ndcOffsetScale*2*v[1]/this._frameSize[1],this._leafPass.ndcOffset=v,this._innerPass.ndcOffset=v,this._innerLabelPass.ndcOffset=v,this._leafLabelPass.ndcOffset=v,this._pointPass.ndcOffset=v,this._labelBackgroundPass.ndcOffset=v;const t=a===0,i=this._multiRenderTarget,n=t?i.primaryFBO:i.secondaryFBO;n.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT,!0,!1),g.viewport(0,0,this._camera.viewport[0],this._camera.viewport[1]),g.depthFunc(g.LESS);const r=Ut.Attachment;i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),this.renderLeafNodes(n,i.drawRestricted?r.Color:r.Undefined,!0),this.renderInnerNodes(n,i.drawRestricted?r.Color:r.Undefined,!0),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,g.NONE]),this.renderInnerLabels(n,i.drawRestricted?r.Color:r.Undefined,!1),this.renderLeafLabelBackgrounds(n,!1),this.renderLeafLabels(n,i.drawRestricted?r.Color:r.Undefined,!1),this.renderPoints(n,!1),i.drawRestricted||y.drawBuffers([y.COLOR_ATTACHMENT0,y.COLOR_ATTACHMENT1]),t&&i.idFBO&&(i.idFBO.clear(g.COLOR_BUFFER_BIT|g.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.idFBO,r.Id,!1),this.renderInnerNodes(i.idFBO,r.Id,!1)),t&&i.depthFBO&&(i.depthFBO.clear(g.COLOR_BUFFER_BIT|g.STENCIL_BUFFER_BIT),this.renderLeafNodes(i.depthFBO,r.Depth,!1),this.renderInnerNodes(i.depthFBO,r.Depth,!1)),this._accumulationPass.frame(a)}onSwap(){var g;if(!this._accumulationPass.initialized||!((g=this._accumulationPass.framebuffer)!=null&&g.initialized)||!this._blitPass.initialized)return;const a=this._blitPass;a.framebuffer=this._accumulationPass.framebuffer,a.readBuffer=this._context.gl2facade.COLOR_ATTACHMENT0,a.frame()}updateLabelsForPass(a,g){const y=[];for(const v of a)v!==void 0&&(v.fontFace=this._fontFace,y.push(v));g.labels=y,g.update()}updateLabels(a,g){this.updateLabelsForPass(a,this._innerLabelPass),this.updateLabelsForPass(g,this._leafLabelPass)}updateLeafLabelPass(){this._leafLabelPass.update()}updateLeafLabelBackgrounds(a){const g=[],y=[],v=[],t=[];let i=0;for(const n of a){if(!n||n.color.a===0)continue;const r=2*n.extent[1]/this._frameSize[1];i=Math.max(i,r)}for(const n of a){if(!n||n.color.a===0)continue;g.push(n.position[0],n.position[1],n.position[2]);const r=dl*.5,c=dl*.5,f=(2*n.extent[0]+r)/this._frameSize[0];y.push(f,i);const d=r/this._frameSize[1],h=n.alignment===N.Label.Alignment.Right?-d-f:d,s=c/this._frameSize[1],u=n.lineAnchor===N.Label.LineAnchor.Top?s-i:-s;v.push(h,u);let o=0;n.alignment===N.Label.Alignment.Left?n.lineAnchor===N.Label.LineAnchor.Bottom?o=1:n.lineAnchor===N.Label.LineAnchor.Top&&(o=2):n.alignment===N.Label.Alignment.Right&&(n.lineAnchor===N.Label.LineAnchor.Bottom?o=3:n.lineAnchor===N.Label.LineAnchor.Top&&(o=4)),t.push(o)}this._labelBackgroundPass.updateData(new Float32Array(g),new Float32Array(y),new Float32Array(v),new Uint8Array(t))}updatePoints(a){const g=[],y=[];for(const v of a)v&&(g.push(v.position[0],v.position[1],v.position[2]),y.push(v.color.r,v.color.g,v.color.b,v.color.a));this._pointPass.positions=new Float32Array(g),this._pointPass.colors=new Float32Array(y)}frameSizeAltered(){return this._altered.frameSize}setCameraEye(a,g,y){this._camera.eye=N.vec3.fromValues(a,g,y)}invalidate(){this.initialized&&super.invalidate(!0)}};pr.CAMERA_NEAR_DEFAULT=.01,pr.CAMERA_FAR_DEFAULT=10;let vl=pr;class Hg{static innerNodes(a,g,y){const v=new Uint8Array(a.numberOfInnerNodes);return a.forEachInnerNode(t=>{v[t.index]=g+t.depth%y}),v}}var Xg=Object.defineProperty,Yg=Object.getOwnPropertyDescriptor,V_=(T,a,g,y)=>{for(var v=Yg(a,g),t=T.length-1,i;t>=0;t--)(i=T[t])&&(v=i(a,g,v)||v);return v&&Xg(a,g,v),v};class Nt extends N.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new N.ChangeLookup,{any:!1,colorTableLength:!1,colorTable:!1,innerNodeIndices:!1,innerNodeLayouts:!1,innerNodeEmphases:!1,innerNodeColors:!1,leafNodeIndices:!1,leafNodeLayouts:!1,leafNodeEmphases:!1,leafNodeAreaScales:!1,leafNodeColors:!1,leafNodeHeights:!1,outlineWidth:!1,emphasisOutlineWidth:!1,heightScale:!1,labels:!1})}initialize(a){return this._topology=a,this._altered.alter("any"),this._topology.numberOfInnerNodes>0||this._topology.numberOfLeafNodes>0}uninitialize(){this._topology=void 0,this._colorTable=void 0,this._leafNodeAreaScales=void 0,this._leafNodeColors=void 0,this._leafNodeHeights=void 0,this._innerNodeIndices=void 0,this._innerNodeLayouts=void 0,this._innerNodeEmphases=void 0,this._innerNodeColors=void 0,this._leafNodeIndices=void 0,this._leafNodeLayouts=void 0,this._leafNodeEmphases=void 0,this._showRoot=!0}get altered(){return this._altered}get topology(){return this.assertInitialized(),this._topology}set innerNodeIndices(a){this.assertInitialized(),this._innerNodeIndices=a,this._altered.alter("innerNodeIndices")}get innerNodeIndices(){return this._innerNodeIndices}set innerNodeLayouts(a){this.assertInitialized(),this._innerNodeLayouts=a,this._altered.alter("innerNodeLayouts")}get innerNodeLayouts(){return this._innerNodeLayouts}set innerNodeEmphases(a){this.assertInitialized(),this._innerNodeEmphases=a,this._altered.alter("innerNodeEmphases")}get innerNodeEmphases(){return this._innerNodeEmphases}set innerNodeColors(a){this.assertInitialized(),this._innerNodeColors=a,this._altered.alter("innerNodeColors")}get innerNodeColors(){return this._innerNodeColors}set leafNodeIndices(a){this.assertInitialized(),this._leafNodeIndices=a,this._altered.alter("leafNodeIndices")}get leafNodeIndices(){return this._leafNodeIndices}set leafNodeLayouts(a){this.assertInitialized(),this._leafNodeLayouts=a,this._altered.alter("leafNodeLayouts")}get leafNodeLayouts(){return this._leafNodeLayouts}set leafNodeEmphases(a){this.assertInitialized(),this._leafNodeEmphases=a,this._altered.alter("leafNodeEmphases")}get leafNodeEmphases(){return this._leafNodeEmphases}get leafNodeAreaScales(){return this._leafNodeAreaScales}set leafNodeAreaScales(a){this._leafNodeAreaScales=a}get leafNodeColors(){return this._leafNodeColors}set leafNodeColors(a){this._leafNodeColors=a}set colorTable(a){this.assertInitialized(),this._colorTable=a,this._altered.alter("colorTable")}get colorTable(){return this._colorTable}get leafNodeHeights(){return this._leafNodeHeights}set leafNodeHeights(a){this._leafNodeHeights=a}get innerNodeCount(){return this.assertInitialized(),this._topology.numberOfInnerNodes}get leafNodeCount(){return this.assertInitialized(),this._topology.numberOfLeafNodes}set heightScale(a){this.assertInitialized(),this._heightScale=a,this._altered.alter("heightScale")}get heightScale(){return this._heightScale}set outlineWidth(a){this.assertInitialized(),this._outlineWidth=a,this._altered.alter("outlineWidth")}get outlineWidth(){return this._outlineWidth}set emphasisOutlineWidth(a){this.assertInitialized(),this._emphasisOutlineWidth=a,this._altered.alter("emphasisOutlineWidth")}get emphasisOutlineWidth(){return this._emphasisOutlineWidth}set showRoot(a){this.assertInitialized(),this._showRoot=a,this._altered.alter("any")}get showRoot(){return this._showRoot}get valid(){return this.initialized}}V_([N.Initializable.initialize()],Nt.prototype,"initialize");V_([N.Initializable.uninitialize()],Nt.prototype,"uninitialize");(T=>{(a=>{a[a.None=0]="None",a[a.Outline=1]="Outline",a[a.Highlight=2]="Highlight"})(T.Emphasis||(T.Emphasis={}))})(Nt||(Nt={}));class qf{static innerNodes(a,g,y){const v=new Uint8Array(a.numberOfInnerNodes);return a.forEachInnerNode(t=>{y&&y.has(t.id)?v[t.index]=Nt.Emphasis.Highlight:g&&g.has(t.id)?v[t.index]=Nt.Emphasis.Outline:v[t.index]=Nt.Emphasis.None}),v}static leafNodes(a,g,y){const v=new Uint8Array(a.numberOfLeafNodes);return a.forEachLeafNode(t=>{const i=t.index-a.numberOfInnerNodes;y&&y.has(t.id)?v[i]=Nt.Emphasis.Highlight:g&&g.has(t.id)?v[i]=Nt.Emphasis.Outline:v[i]=Nt.Emphasis.None}),v}}class Wf{static innerNodes(a){const g=new Uint8Array(4*a.numberOfInnerNodes);return a.forEachInnerNode(y=>{const v=y.index,t=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(t,y.index),g[4*v+0]=t[0],g[4*v+1]=t[1],g[4*v+2]=t[2],g[4*v+3]=t[3]}),g}static leafNodes(a){const g=new Uint8Array(4*a.numberOfLeafNodes),y=a.numberOfInnerNodes;return a.forEachLeafNode(v=>{const t=v.index-y,i=N.vec4.create();N.gl_matrix_extensions.encode_uint32_to_rgba8(i,v.index),g[4*t+0]=i[0],g[4*t+1]=i[1],g[4*t+2]=i[2],g[4*t+3]=i[3]}),g}}class Vf{constructor(){this.outer=0,this.inner=0}next(a){++this.inner,this.inner===a[this.outer].length&&(++this.outer,this.inner=0)}end(a){return this.outer===a.length}element(a){return a[this.outer][this.inner]}}const $f=N.auxiliaries.assert,Ys=N.gl_matrix_extensions.v2;var Ne;(T=>{(v=>{v.UpperRight="upper-right",v.UpperLeft="upper-left",v.LowerRight="lower-right",v.LowerLeft="lower-left",v.Hidden="hidden"})(T.Type||(T.Type={}));function a(v,t,i){switch(v){case"upper-right":return t;case"upper-left":return N.vec2.sub(Ys(),t,[i[0],0]);case"lower-left":return N.vec2.sub(Ys(),t,i);case"lower-right":return N.vec2.sub(Ys(),t,[0,i[1]]);case"hidden":return t;default:$f(!1,"No valid type for relative label position, given"+v)}return N.vec2.create()}T.labelOrigin=a;function g(v){return v!=="hidden"}T.isVisible=g;function y(v,t){const i=N.vec2.add(Ys(),v,[t[0]/2,t[1]/2]);return i[0]>0&&i[1]>0?"upper-right":i[0]<0&&i[1]>0?"upper-left":i[0]<0&&i[1]<0?"lower-left":i[0]>0&&i[1]<0?"lower-right":($f(!1,`midpointOffset is ${i}, given offset ${v} and extent ${t}`),"hidden")}T.relativeLabelPosition=y})(Ne||(Ne={}));const Ge=N.gl_matrix_extensions.v2;class fl{constructor(a,g,y){this.origin=a,this.extent=g,this.position=y}areBothPositionsHidden(a){return this.position===Ne.Type.Hidden||a===Ne.Type.Hidden}overlaps(a){if(this.areBothPositionsHidden(a.position))return!1;const g=N.vec2.add(Ge(),this.origin,this.extent),y=N.vec2.add(Ge(),a.origin,a.extent);return this.origin[0]<y[0]&&g[0]>a.origin[0]&&this.origin[1]<y[1]&&g[1]>a.origin[1]}paddedOverlaps(a,g){if(this.areBothPositionsHidden(a.position))return!1;const y=N.vec2.fromValues(g[0]+1,g[1]+1),v=N.vec2.sub(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,g)),t=N.vec2.sub(Ge(),a.origin,N.vec2.mul(Ge(),a.extent,g)),i=N.vec2.add(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,y)),n=N.vec2.add(Ge(),a.origin,N.vec2.mul(Ge(),a.extent,y));return v[0]<n[0]&&i[0]>t[0]&&v[1]<n[1]&&i[1]>t[1]}overlapArea(a){if(this.areBothPositionsHidden(a.position))return 0;const g=N.vec2.max(Ge(),this.origin,a.origin),y=N.vec2.min(Ge(),N.vec2.add(Ge(),this.origin,this.extent),N.vec2.add(Ge(),a.origin,a.extent));return Math.max(0,y[0]-g[0])*Math.max(0,y[1]-g[1])}paddedOverlapArea(a,g){if(this.areBothPositionsHidden(a.position))return 0;const y=N.vec2.max(Ge(),N.vec2.sub(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,g)),N.vec2.sub(Ge(),a.origin,N.vec2.mul(Ge(),a.extent,g))),v=N.vec2.fromValues(g[0]+1,g[1]+1),t=N.vec2.min(Ge(),N.vec2.add(Ge(),this.origin,N.vec2.mul(Ge(),this.extent,v)),N.vec2.add(Ge(),a.origin,N.vec2.mul(Ge(),a.extent,v)));return Math.max(0,t[0]-y[0])*Math.max(0,t[1]-y[1])}area(){return this.extent[0]*this.extent[1]}}const Zg=N.auxiliaries.assert,Kg=N.auxiliaries.log,Qg=N.auxiliaries.LogLevel,Jg=20;function Zs(T,a,g){T.length>0&&T[T.length-1].value<a&&(T[T.length-1]={nodeId:g,value:a},T.sort((y,v)=>v.value-y.value))}function Ks(T,a){a.filter(g=>g.nodeId!==void 0&&g.nodeId!=Xe.INVALID_INDEX).map(g=>{T.add(g.nodeId)})}class vt{static createLeafLabel(a,g){const y=new N.Projected3DLabel(new N.Text("  "+a+"  "),N.Label.Type.Dynamic);return y.color.fromF32(...vt.leafLabelColor),y.lineAnchor=N.Label.LineAnchor.Bottom,y.fontSize=Jg*window.devicePixelRatio,Zg(g.length===3,`Expected a 3D position for leaf label anchor, got ${g}`),y.position=g,y}static createInnerNodeLabel(a,g,y){const v=new N.Position3DLabel(new N.Text(a),N.Label.Type.Static);v.color.fromF32(...vt.innerLabelColor),v.alignment=N.Label.Alignment.Center,v.lineAnchor=N.Label.LineAnchor.Bottom;const t=0;let i=0;const n=0;let r=0;switch(v.fontSize=y*2,v.elide=N.Label.Elide.Middle,t){case 0:i=g.left+g.right-1,r=(g.bottom-y)*2-1,v.lineWidth=g.width*2,v.direction=[1,0,0],v.up=[0,0,-1];break;case 1:i=g.left+g.right-1,r=(g.top+y)*2-1,v.lineWidth=g.width*2,v.direction=[-1,0,0],v.up=[0,0,1];break;case 2:i=(g.left-y)*2-1,r=g.top+g.bottom-1,v.lineWidth=g.height*2,v.direction=[0,0,1],v.up=[1,0,0];break;case 3:i=(g.right+y)*2-1,r=g.top+g.bottom-1,v.lineWidth=g.height*2,v.direction=[0,0,-1],v.up=[-1,0,0];break;default:v.fontSize=0,Kg(Qg.Warning,`${t} is not a valid value of LabelPaddingSide, skip label '${a}'`)}return v.position=[i,n,-r],v}static createInnerNodeLabelOnAccessory(a,g){const y=new N.Position3DLabel(new N.Text(a),N.Label.Type.Static);y.color.fromF32(...vt.innerLabelColor),y.alignment=N.Label.Alignment.Center,y.lineAnchor=N.Label.LineAnchor.Bottom;const v=g.left+g.right-1,t=0,i=g.bottom*2-1;return y.fontSize=g.height*2,y.elide=N.Label.Elide.Middle,y.lineWidth=g.width*2,y.position=[v,t,-i],y.direction=[1,0,0],y.up=[0,0,-1],y}static fillLeafLabelArray(a,g,y,v,t,i){const n=new Array(a.numberOfInnerNodes);return y.forEach(r=>{const c=a.leafNodeById(r),f=g.get(r);if(c===void 0||f===void 0||f.length===0)return;const d=c.index-a.numberOfInnerNodes,h=d*4,s=t[h+0],u=t[h+1],o=t[h+2],m=t[h+3],_=d*2,p=i[_+1];if(o>0&&m>0){const b=s+o*.5,x=p*v/255,E=u+m*.5;n[c.index]=vt.createLeafLabel(f,[b,x,E])}}),n}static fillInnerNodeLabelArrayOnAccessory(a,g,y,v){const t=new Array(a.numberOfInnerNodes);return y.forEach(i=>{const n=a.innerNodeById(i);if(n!==void 0&&v[n.index]!==void 0&&v[n.index].area>0){const r=g.get(i);if(r===void 0||r.length===0)return;t[n.index]=vt.createInnerNodeLabelOnAccessory(r,v[n.index])}}),t}static fillInnerNodeLabelArray(a,g,y,v,t){const i=new Array(a.numberOfInnerNodes);return y.forEach(n=>{const r=a.innerNodeById(n);if(r!==void 0&&v[r.index]!==void 0){const c=g.get(n);if(c===void 0||c.length===0)return;!r.isLeaf&&v[r.index].area>0&&(i[r.index]=vt.createInnerNodeLabel(c,v[r.index],t[r.index]))}}),i}static createLabelSelection(a,g,y,v,t,i,n,r,c,f){const d=new Set(t),h=new Array(n),s=new Array(r),u=new Array(c),o=new Array(f);return h.fill({nodeId:void 0,value:-1}),s.fill({nodeId:void 0,value:-1}),u.fill({nodeId:void 0,value:-1}),o.fill({nodeId:void 0,value:-1}),a.parentsDoUntilDepth(i[1],m=>{m.depth<i[0]||Zs(h,g[m.index],m.id)}),a.forEachLeafNode(m=>{m.id!==void 0&&(Zs(s,g[m.index],m.id),Zs(u,y[m.index],m.id),Zs(o,v[m.index],m.id))}),Ks(d,h),Ks(d,s),Ks(d,u),Ks(d,o),d}static fillLeafLabelArrayByExplicitNames(a,g,y,v,t){const i=new Set;return g.forEach((n,r)=>{i.add(r)}),vt.fillLeafLabelArray(a,g,i,y,v,t)}static fillInnerNodeLabelArrayOnAccessoryByExplicitNames(a,g,y){const v=new Set;return g.forEach((t,i)=>{v.add(i)}),vt.fillInnerNodeLabelArrayOnAccessory(a,g,v,y)}}(T=>{T.leafLabelColor=[0,0,0,.8],T.innerLabelColor=[0,0,0,.54]})(vt||(vt={}));const to=N.auxiliaries.assert,eb=N.gl_matrix_extensions.v2;var ro;(T=>{T.leafLabelsTreemap=(a,g,y,v)=>{let t=0;switch(y){case Ne.Type.UpperRight:t=0*v;break;case Ne.Type.LowerRight:t=1*v;break;case Ne.Type.UpperLeft:t=1*v;break;case Ne.Type.LowerLeft:t=3*v;break;case Ne.Type.Hidden:t=60*v;break;default:to(!1,`No valid relative position type, given ${y}`)}return 15*g+.3*t}})(ro||(ro={}));class tb{static getNDCExtentForLeafLabel(a,g){to(g.width!==0&&g.height!==0,`camera viewport is invalid: ${g.width} ${g.height}`);const y=a.label.extent[0]/g.width,v=a.label.extent[1]/g.height;return N.vec2.fromValues(y,v)}static placementFor(a,g){const y=N.vec2.sub(eb(),a.origin,g);let v=!0,t=N.Label.Alignment.Left,i=N.Label.LineAnchor.Bottom;switch(a.position){case Ne.Type.UpperRight:break;case Ne.Type.LowerRight:i=N.Label.LineAnchor.Top;break;case Ne.Type.UpperLeft:t=N.Label.Alignment.Right;break;case Ne.Type.LowerLeft:i=N.Label.LineAnchor.Top,t=N.Label.Alignment.Right;break;case Ne.Type.Hidden:v=!1;break;default:to(!1,"No valid type for relative label position, given"+y)}return{offset:y,alignment:t,lineAnchor:i,display:v}}static createCollisionGraph(a,g){g||(g=N.vec2.fromValues(1,1));const y=[];for(let t=0;t<a.length;t++){y.push([]);for(const i of a[t])y[t].push([])}const v=new Vf;for(;!v.end(a);v.next(a)){const t=v.element(y),i=v.element(a),n=new Vf;for(;!n.end(a);n.next(a)){if(v.outer===n.outer)continue;const r=n.element(a);if(i.paddedOverlaps(r,g)){const c=i.paddedOverlapArea(r,g);t.push({index:n.outer,position:n.inner,overlapArea:c});const f=v.element(y).length;to(f>0,`Size expected to be greater than zero, given ${f.length}`)}}}return y}static computeLabelAreas(a,g,y){const v=[];for(const t of a){v.push([]);const i=this.getNDCExtentForLeafLabel(t,y);for(const n of g){const r=Ne.labelOrigin(n,t.pointLocation,i);v[v.length-1].push(new fl(r,i,n))}}return v}static getRandomInt(a){return Math.floor(Math.random()*Math.floor(a))}static randomIndexExcept(a,g){const y=this.getRandomInt(g-1);return y===a?g-1:y}static randomStartLabelAreas(a){const g=[];for(const y of a)g.push(this.getRandomInt(y.length));return g}static computePenalty(a,g,y,v,t){if(a.extent[0]===0||a.extent[1]===0)return 0;let i=0,n=0;for(const r of g)t[r.index]===r.position&&(i+=r.overlapArea,++n);return i/=a.area(),v(n,i,a.position,y)}static simulatedAnnealing(a,g,y,v){const t=[Ne.Type.UpperRight,Ne.Type.UpperLeft,Ne.Type.LowerLeft,Ne.Type.LowerRight,Ne.Type.Hidden],i=this.computeLabelAreas(a,t,v),n=this.randomStartLabelAreas(i),r=this.createCollisionGraph(i,y),c=.91023922662,f=50,d=.9,h=5*a.length,s=20*a.length;let u=c,o=0,m=0,_=0;for(;;){const p=this.getRandomInt(a.length),b=n[p],x=this.randomIndexExcept(b,i[p].length),E=this.computePenalty(i[p][b],r[p][b],a[p].priority,g,n),w=this.computePenalty(i[p][x],r[p][x],a[p].priority,g,n),S=E-w,R=Math.exp(S/u),O=Math.max(0,Math.min(R,1)),I=Math.random()<O;if((S>0||I)&&(n[p]=x,++m),++_,m>h||_>s){if(m===0||o===f)break;u*=d,m=0,_=0,++o}}for(let p=0;p<a.length;++p)a[p].placement=this.placementFor(i[p][n[p]],a[p].pointLocation)}static greedy(a,g,y,v){const t=[],i=[Ne.Type.UpperRight,Ne.Type.UpperLeft,Ne.Type.LowerLeft,Ne.Type.LowerRight,Ne.Type.Hidden];for(const n of a){const r=this.getNDCExtentForLeafLabel(n,v);let c=Number.POSITIVE_INFINITY,f=new fl(N.vec2.create(),N.vec2.create(),Ne.Type.LowerLeft);for(const d of i){const h=Ne.labelOrigin(d,n.pointLocation,r),s=new fl(h,r,d);let u=0,o=0;for(const _ of t)u+=s.paddedOverlapArea(_,y),o+=s.paddedOverlaps(_,y)?1:0;u/=s.area();const m=g(o,u,d,n.priority);m<c&&(c=m,f=s)}n.placement=this.placementFor(f,n.pointLocation),t.push(f)}}static prepareLeafLabels(a,g){const y=[];for(const v of a)if(v){const t=N.vec4.fromValues(v.position[0],v.position[1],v.position[2],1);N.vec4.transformMat4(t,t,g.viewProjection);const i=t[3],n=N.vec2.fromValues(t[0]/i,t[1]/i);y.push({label:v,pointLocation:n,priority:v.position[1]*9+1,placement:{offset:N.vec2.create(),alignment:v.alignment,lineAnchor:v.lineAnchor,display:!0}})}return y}static applyNewPlacements(a){let g=!1,y=!1;for(const v of a){const t=v.label.alignment!==v.placement.alignment,i=v.label.lineAnchor!==v.placement.lineAnchor;v.label.alignment=v.placement.alignment,v.label.lineAnchor=v.placement.lineAnchor;const n=v.placement.display?vt.leafLabelColor[3]:0;v.label.color.fromRGB(v.label.color.r,v.label.color.g,v.label.color.b,n),g=g?!0:v.label.color.altered,y=y?!0:t||i}return{visibility:g,positioning:y}}static adaptPositionToPreventOverlapGreedy(a,g){const y=this.prepareLeafLabels(a,g);y.sort((t,i)=>i.priority-t.priority);const v=N.vec2.fromValues(1,1);return this.greedy(y,ro.leafLabelsTreemap,v,g),this.applyNewPlacements(y)}static adaptPositionToPreventOverlapSimulatedAnnealing(a,g){const y=this.prepareLeafLabels(a,g),v=N.vec2.fromValues(1,1);return this.simulatedAnnealing(y,ro.leafLabelsTreemap,v,g),this.applyNewPlacements(y)}}class rb{constructor(a){this._topology=a}resolve(a,g,y,v){if(v&&(a===void 0||a===""))return v();const t=St.create(this._topology,y,a,g);return v&&t===void 0?v():t}constBufferCallback(a=0){return()=>{const g=new Float32Array(this._topology.numberOfNodes);return g.fill(a),g}}}class ib{constructor(a,g,y,v){this._emphasis=a.rgbaF32,this._auxiliary=new Float32Array(g.length*4);for(let t=0;t<g.length;++t)this._auxiliary.set(g[t].rgbaF32,t*4);this._inner=new Float32Array(y.length*4);for(let t=0;t<y.length;++t)this._inner.set(y[t].rgbaF32,t*4);this._leaf=new Float32Array(v.length*4);for(let t=0;t<v.length;++t)this._leaf.set(v[t].rgbaF32,t*4)}get innerNodeColorOffset(){return this.auxiliaryColorCount}get innerNodeColorCount(){return this._inner.length/4}get leafColorOffset(){return this.innerNodeColorOffset+this.innerNodeColorCount}get leafColorCount(){return this._leaf.length/4}get auxiliaryColorOffset(){return 0}get auxiliaryColorCount(){return this._auxiliary.length/4+1}get selectionColorIndex(){return 0}get bits(){const a=new Float32Array((this.auxiliaryColorCount+this.innerNodeColorCount+this.leafColorCount)*4);return a.set(this._emphasis,0),a.set(this._auxiliary,4),a.set(this._inner,this.innerNodeColorOffset*4),a.set(this._leaf,this.leafColorOffset*4),a}get length(){return this.auxiliaryColorCount+this.leafColorCount+this.innerNodeColorCount}}class jt{static getColorIndex(a,g,y){const t=(a-y[0])/(y[1]-y[0]);return Math.min(g-1,Math.floor(Math.max(0,g*t-1e-4)))}static getColorIndexInverted(a,g,y){return g-1-this.getColorIndex(a,g,y)}static getColorIndexComputation(a,g){return y=>this.getColorIndex(y,a,g)}static insertLayoutIntoBuffer(a,g,y){const v=4*g;a[v+0]=-1+2*y.left,a[v+1]=1-2*y.bottom-2*y.height,a[v+2]=2*y.width,a[v+3]=2*y.height}static createLeafLayoutBuffer(a,g,y){const v=new Float32Array(4*a.numberOfLeafNodes),t=a.numberOfInnerNodes;return a.forEachLeafNode(i=>{const n=i.index-t,r=g[i.index];jt.insertLayoutIntoBuffer(v,n,r)}),v}static createLayerHeightBuffer(a,g,y,v){const t=new Uint8Array(2*a.numberOfLeafNodes),i=a.numberOfInnerNodes;let n=!1;return a.forEachLeafNode(r=>{const c=r.index-i,f=y!==void 0?Math.max(y[2*c+1],0):0,d=Math.max(g[r.index],0);let h=f+d*255;f>0&&d>0&&(h=Math.ceil(h)),h>255&&(n=!0,h=255),t[2*c+0]=f,t[2*c+1]=h}),n&&console.error("Height value overflow"),t}static createEmptyLayerHeightBuffer(a){return new Uint8Array(2*a.numberOfLeafNodes)}static createLeafAreaScalesBuffer(a,g){const y=new Uint8Array(a.numberOfLeafNodes),v=a.numberOfInnerNodes;return a.forEachLeafNode(t=>{const i=t.index-v,n=Math.min(g[t.index]*255,255);y[i]=n}),y}static createDefaultLeafAreaScalesBuffer(a,g=1){const y=new Uint8Array(a.numberOfLeafNodes);return y.fill(g*255),y}static createParentLayoutBuffer(a,g,y){const v=new Float32Array(4*a.numberOfInnerNodes);return a.forEachInnerNode(t=>{const i=t.index,n=g[t.index];jt.insertLayoutIntoBuffer(v,i,n)}),v}static defaultLeafNodeColors(a,g){const y=new Uint8Array(a.numberOfLeafNodes);return y.fill(g),y}static createLeafNodeColors(a,g,y,v,t){const i=new Uint8Array(a.numberOfLeafNodes),n=a.numberOfInnerNodes,r=this.getColorIndexComputation(v,t);return a.forEachLeafNode(c=>{const f=c.index-n,d=g[c.index];i[f]=y+r(d)+32}),i}static createLeafNodeHeights(){return new Uint8Array(0)}static createLeafNodeAreaScales(){return new Uint8Array(0)}}class nb{constructor(){this.topology=new bt}}const _t=N.auxiliaries.assert;class Se{static clone(a){return new Se(a.left,a.bottom,a.right,a.top)}constructor(a,g,y,v,t){this._left=a,this._right=y,this._top=v,this._bottom=g,this.orientation=t}get area(){return this.width*this.height}get center(){return[(this._left+this._right)/2,(this._bottom+this._top)/2]}get shorterSide(){return Math.min(this.width,this.height)}get longerSide(){return Math.max(this.width,this.height)}get isReversed(){return this.orientation===void 0?!1:this.orientation>=Se.Orientation.DC}get top(){return this._top}set top(a){_t(a>=this.bottom,"Non-negative height expected"),this._top=a}get left(){return this._left}set left(a){_t(a<=this.right,"Non-negative width expected"),this._left=a}get right(){return this._right}set right(a){_t(a>=this.left,"Non-negative width expected"),this._right=a}get bottom(){return this._bottom}set bottom(a){_t(a<=this.top,"Non-negative height expected"),this._bottom=a}get width(){return this._right-this._left}get height(){return this._top-this._bottom}get isHorizontal(){return this.width>this.height}get isVertical(){return this.width<=this.height}relativeTop(a){return this.relativeRect(0,1-a,1,a)}truncateTop(a){return _t(a<=this._top&&a>=this._bottom,"Expect new top to be within rectangle"),new Se(this._left,this._bottom,this._right,a)}relativeLeft(a){return this.relativeRect(0,0,a,1)}truncateLeft(a){return _t(a<=this._right&&a>=this._left,"Expect new top to be within rectangle"),new Se(a,this._bottom,this._right,this._top)}relativeRight(a){return this.relativeRect(1-a,0,a,1)}truncateRight(a){return _t(a<=this._right&&a>=this._left,"Expect new top to be within rectangle"),new Se(this._left,this._bottom,a,this._top)}relativeBottom(a){return this.relativeRect(0,0,1,a)}truncateBottom(a){return _t(a<=this._top&&a>=this._bottom,"Expect new top to be within rectangle"),new Se(this._left,a,this._right,this._top)}applyOffset(a,g){this._left+=a,this._right+=a,this._top+=g,this._bottom+=g}relativeRect(a,g,y,v,t){_t(a>=0&&a<=1,"Expect posX to be in [0, 1]"),_t(g>=0&&g<=1,"Expect posY to be in [0, 1]"),_t(y>=0&&y<=1,"Expect extX to be in [0, 1]"),_t(v>=0&&v<=1,"Expect extY to be in [0, 1]"),_t(a+y<=1,"Final width must not exceed given width"),_t(g+v<=1,"Final height must not exceed given height");const i=this._left+a*this.width,n=this._bottom+g*this.height,r=Math.min(i+y*this.width,this._right),c=Math.min(n+v*this.height,this._top);return new Se(i,n,r,c,t)}equalizedMargin(a,g,y){if(this.area<=0)return 0;let v=a;const t=2*this.width*a+2*this.height*a-4*a*a;if(t<0||t/this.area>=g||this.shorterSide<2*a){let i;const n=this.area*g*.99,r=.25*(this.width+this.height),c=.25*n,f=r*r-c;if(f<=0)i=r;else{const d=Math.sqrt(f),h=r+d,s=r-d;i=Math.min(h,s),i=i<0?0:i}_t(i<v,`expected ${i} to be smaller than ${v}`),v=i}return v}equalizedRelativeMargin(a){if(this.area<=0)return 0;const g=this.area*(1-a),y=this.width/this.height,v=Math.sqrt(g*y),t=Math.sqrt(g/y),i=this.area-g,n=-(v+t)*.5,r=i*.25,c=n*n*.25-r,f=c<0?0:Math.sqrt(c),d=-n*.5+f,h=-n*.5-f;return d<0||h<0?Math.max(d,h):Math.min(d,h)}padded(a){return this.width<2*a||this.height<2*a?new Se(this.left,this.bottom,this.left,this.bottom):new Se(this.left+a,this.bottom+a,this.right-a,this.top-a)}paddedWithMinArea(a,g){return a<=0?this.padded(a):1-(2*this.width*a+2*this.height*a-4*a*a)/this.area>=g&&this.shorterSide>4*a?this.padded(a):this.padded(this.shorterSide/4).relativePadded(Math.max(0,1-a/(4*this.shorterSide)))}relativePadded(a){const g=a/2;return this.relativeRect(g,g,1-a,1-a)}map(a,g){const y=(this.left-a.left)/a.width*g.width+g.left,v=g.right-(a.right-this.right)/a.width*g.width,t=g.top-(a.top-this.top)/a.height*g.height,i=(this.bottom-a.bottom)/a.height*g.height+g.bottom;return new Se(y,i,v,t)}enclose(a){const g=Math.min(this.left,a.left),y=Math.max(this.top,a.top),v=Math.max(this.right,a.right),t=Math.min(this.bottom,a.bottom);this._left=g,this._right=v,this._top=y,this._bottom=t}intersects(a){return!(a.left+Number.EPSILON>=this.right||a.right<=this.left+Number.EPSILON||a.top<=this.bottom+Number.EPSILON||a.bottom+Number.EPSILON>=this.top)}comprises(a){return this.left-Number.EPSILON<=a.left+Number.EPSILON&&this.right+Number.EPSILON>=a.right-Number.EPSILON&&this.bottom-Number.EPSILON<=a.bottom+Number.EPSILON&&this.top+Number.EPSILON>=a.top-Number.EPSILON}get aspectRatio(){return this.width/this.height}centerAround(a){const g=this.center,y=[a[0]-g[0],a[1]-g[1]];this.applyOffset(y[0],y[1])}}(T=>{(a=>{a[a.CD=0]="CD",a[a.AC=1]="AC",a[a.BA=2]="BA",a[a.DB=3]="DB",a[a.DC=4]="DC",a[a.CA=5]="CA",a[a.AB=6]="AB",a[a.BD=7]="BD"})(T.Orientation||(T.Orientation={}))})(Se||(Se={}));class Ct{static compute(a,g,y,v,t,i,n,r){const c=g[a.root.index];a.nodesDo(s=>{const u=g[s.index],o=Math.sqrt(u/c);v[s.index]=new Se(0,0,o*y,o)});const f=new Array;f[a.root.index]=[0,0],a.reverseParentsDo(s=>{let u=0,o=0,m=u,_=o,p=Ct.Direction.Y;a.childrenDo(s,x=>{const E=v[x.index]=t.siblingMarginAfterCallback(v[x.index],v[s.index],v[s.index],x);switch(p){case Ct.Direction.X:u+E.width>=m&&(u=m,o=0,p=Ct.Direction.Y);break;default:case Ct.Direction.Y:o+E.height>=_&&(u=0,o=_,p=Ct.Direction.X);break}switch(f[x.index]=[u,o],p){case Ct.Direction.X:u+=E.width,m=Math.max(m,u),_=Math.max(_,Math.max(o+E.height,E.top));break;default:case Ct.Direction.Y:o+=E.height,m=Math.max(m,Math.max(u+E.width,E.right)),_=Math.max(_,o);break}});const b=t.parentPaddingCallback(new Se(0,0,m,_),s,a,v,n,r);v[s.index]=t.accessoryPaddingCallback(b,s,a,v,i)}),a.nodesDo(s=>{const u=v[s.index],o=f[s.index];u.applyOffset(o[0],o[1]),a.childrenDo(s,m=>{const _=f[m.index];_[0]+=o[0],_[1]+=o[1]})});const d=v[a.root.index],h=new Se(0,0,d.aspectRatio,1);h.centerAround([.5,.5]),a.reverseNodesDo(s=>{v[s.index]=v[s.index].map(d,h)})}}(T=>{(a=>{a[a.X=0]="X",a[a.Y=1]="Y"})(T.Direction||(T.Direction={}))})(Ct||(Ct={}));const Qs=N.auxiliaries.assert;class ms{static aspectRatio(a,g,y){const v=a*g,t=y;return v>t?v/t:t/v}constructor(a,g,y,v,t){this._tree=a,this._weights=g,this._availableSpace=y,this._availableWeight=v,this._horizontal=t,this._insertedChildrenCount=0,this._overallChildrenCount=0,this._parentWeight=v,this._childrenWeight=0,this._overallChildrenWeight=0}optimizedAverageAspectRatio(a){if(a){const g=Math.min(this._childrenWeight+a,this._availableWeight),y=Math.min(g/this._availableWeight,1),v=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/(this._insertedChildrenCount+1),v,t)}else{const g=this._childrenWeight,y=Math.min(g/this._availableWeight,1),v=this._horizontal?this._availableSpace.width:this._availableSpace.height,t=(this._horizontal?this._availableSpace.height:this._availableSpace.width)*y;return ms.aspectRatio(1/this._insertedChildrenCount,v,t)}}insert(a,g){this._firstChild||(this._firstChild=a),Qs(this._lastChild===void 0||this._lastChild===a,"Next node invariant not held."),this._lastChild=this._tree.node(a.nextSibling),g>Number.EPSILON&&(this._childrenWeight=Math.min(this._childrenWeight+g,this._availableWeight),this._overallChildrenWeight=Math.min(this._overallChildrenWeight+g,this._parentWeight),this._insertedChildrenCount+=1)}layoutNodes(a){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,y=>{a[y.index]=new Se(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const g=this.currentSpace;if(this._horizontal){let y=g.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,v=>{const t=this._weights[v.index],i=g.width*t/this._childrenWeight,n=Math.min(y+i,g.right);a[v.index]=new Se(y,g.bottom,n,g.top),Qs(this._availableSpace.comprises(a[v.index]),"Expect that child rect is within parent rect"),y=n})}else{let y=g.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,v=>{const t=this._weights[v.index],i=g.height*t/this._childrenWeight,n=Math.min(y+i,g.top);a[v.index]=new Se(g.left,y,g.right,n),Qs(this._availableSpace.comprises(a[v.index]),"Expect that child rect is within parent rect"),y=n})}}get isDisabled(){return this._availableWeight<=0||this._availableSpace.width<=0||this._availableSpace.height<=0}get availableWeight(){return this._availableWeight}get remainingWeight(){return this.isDisabled?0:Math.max(this._parentWeight-this._overallChildrenWeight,0)}get availableSpace(){return this._availableSpace}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return Se.clone(this.availableSpace);const a=this._childrenWeight/this._availableWeight;if(this._horizontal){const g=this._availableSpace.bottom+a*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else{const g=this._availableSpace.left+a*this._availableSpace.width;return this._availableSpace.truncateRight(g)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const a=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal){const g=this._availableSpace.bottom+a*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else{const g=this._availableSpace.left+a*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}}get isHorizontal(){return this._horizontal}increasesAverageAspectRatio(a){return this.isDisabled||this._firstChild===void 0||a<=Number.EPSILON?!1:this.optimizedAverageAspectRatio(a)>this.optimizedAverageAspectRatio()+Number.EPSILON}next(a){const g=this.remainingSpace;Qs(this._availableSpace.comprises(g),"Remaining Space should not exceed available space"),this._availableSpace=g,this._availableWeight=this.remainingWeight,this._horizontal=a,this._firstChild=void 0,this._lastChild=void 0,this._insertedChildrenCount=0,this._childrenWeight=0}}const Js=N.auxiliaries.assert;class ab extends ms{constructor(a,g,y,v,t,i,n){super(a,g,y,v,t),this._reverse=i,this._parentReverse=n}get reverse(){return this._reverse}set reverse(a){this._reverse=a}get parentReverse(){return this._parentReverse}set parentReverse(a){this._parentReverse=a}layoutNodes(a){if(this._firstChild===void 0)return;if(this.isDisabled){this._tree.siblingsRangeDo(this._firstChild,this._lastChild,v=>{a[v.index]=new Se(this._availableSpace.left,this._availableSpace.bottom,this._availableSpace.left,this._availableSpace.bottom)});return}const g=this.currentSpace,y=this._reverse?Se.Orientation.DC:Se.Orientation.CD;if(this._horizontal)if(this._parentReverse){let v=g.right;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],n=g.width*i/this._childrenWeight,r=Math.max(v-n,g.left);a[t.index]=new Se(r,g.bottom,v,g.top,y),Js(this._availableSpace.comprises(a[t.index]),"Expect that child rect is within parent rect"),v=r})}else{let v=g.left;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],n=g.width*i/this._childrenWeight,r=Math.min(v+n,g.right);a[t.index]=new Se(v,g.bottom,r,g.top,y),Js(this._availableSpace.comprises(a[t.index]),"Expect that child rect is within parent rect"),v=r})}else if(this._parentReverse){let v=g.top;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],n=g.height*i/this._childrenWeight,r=Math.max(v-n,g.bottom);a[t.index]=new Se(g.left,r,g.right,v,y),Js(this._availableSpace.comprises(a[t.index]),"Expect that child rect is within parent rect"),v=r})}else{let v=g.bottom;this._tree.siblingsRangeDo(this._firstChild,this._lastChild,t=>{const i=this._weights[t.index],n=g.height*i/this._childrenWeight,r=Math.min(v+n,g.top);a[t.index]=new Se(g.left,v,g.right,r,y),Js(this._availableSpace.comprises(a[t.index]),"Expect that child rect is within parent rect"),v=r})}}get currentSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);if(this._childrenWeight>=this._availableWeight||this._lastChild===void 0)return Se.clone(this.availableSpace);const a=this._childrenWeight/this._availableWeight;if(this._horizontal)if(this._parentReverse){const g=this._availableSpace.top-a*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else{const g=this._availableSpace.bottom+a*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else if(this._parentReverse){const g=this._availableSpace.right-a*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}else{const g=this._availableSpace.left+a*this._availableSpace.width;return this._availableSpace.truncateRight(g)}}get remainingSpace(){if(this.isDisabled)return this._availableSpace.truncateBottom(this._availableSpace.top);const a=Math.min(this._childrenWeight/this._availableWeight,1);if(this._horizontal)if(this._parentReverse){const g=this._availableSpace.top-a*this._availableSpace.height;return this._availableSpace.truncateTop(g)}else{const g=this._availableSpace.bottom+a*this._availableSpace.height;return this._availableSpace.truncateBottom(g)}else if(this._parentReverse){const g=this._availableSpace.right-a*this._availableSpace.width;return this._availableSpace.truncateRight(g)}else{const g=this._availableSpace.left+a*this._availableSpace.width;return this._availableSpace.truncateLeft(g)}}next(a){super.next(a),this._reverse=!this._reverse}}class sb{static compute(a,g,y,v,t,i,n,r){v[a.root.index]=new Se(0,0,y,1),v[a.root.index].centerAround([.5,.5]),a.forEachInnerNode(c=>{let f=t.accessoryPaddingCallback(v[c.index],c,a,v,i);f=t.parentPaddingCallback(f,c,a,v,n,r);const d=t.siblingMarginBeforeCallback(f,c,a,v,n,r),h=d.isReversed,s=h,u=new ab(a,g,d,g[c.index],d.isVertical,s,h);a.childrenDo(c,o=>{const m=g[o.index];u.increasesAverageAspectRatio(m)&&(u.layoutNodes(v),u.next(d.isVertical)),u.insert(o,m)}),u.layoutNodes(v),a.childrenDo(c,o=>{v[o.index]=t.siblingMarginAfterCallback(v[o.index],d,f,o)})})}}class ob{static compute(a,g,y,v,t,i,n,r){v[a.root.index]=new Se(0,0,y,1),v[a.root.index].centerAround([.5,.5]),a.forEachInnerNode(c=>{let f=t.accessoryPaddingCallback(v[c.index],c,a,v,i);f=t.parentPaddingCallback(f,c,a,v,n,r);const d=t.siblingMarginBeforeCallback(f,c,a,v,n,r),h=new ms(a,g,d,g[c.index],f.isVertical);a.childrenDo(c,s=>{const u=g[s.index];h.increasesAverageAspectRatio(u)&&(h.layoutNodes(v),h.next(d.isVertical)),h.insert(s,u)}),h.layoutNodes(v),a.childrenDo(c,s=>{v[s.index]=t.siblingMarginAfterCallback(v[s.index],d,f,s)})})}}const Hf=N.auxiliaries.assert,Pe=class Pe{static createLayout(a,g,y,v,t,i){const n=new Array(a.numberOfNodes);if(Hf(g!==void 0,"Valid weights expected"),g===void 0)return n;const r=g[0];if(N.auxiliaries.assertions()&&a.numberOfNodes>1){let f=0;a.forEachLeafNode(d=>{f+=g[d.index]}),Hf(r!==void 0&&(f===0||r>0),"Accumulated leaf weights as root weight expected")}const c=y.aspectRatio;switch(y.algorithm){case Pe.LayoutAlgorithm.Strip:ob.compute(a,g,c,n,Pe.splittingLayoutPostprocessing(y),v,t,i);break;case Pe.LayoutAlgorithm.Snake:sb.compute(a,g,c,n,Pe.splittingLayoutPostprocessing(y),v,t,i);break;case Pe.LayoutAlgorithm.CodeCity:Ct.compute(a,g,c,n,Pe.packingLayoutPostprocessing(y),v,t,i);break}return n}static splittingLayoutPostprocessing(a){const g={parentPaddingCallback:Pe.emptyParentCallback,siblingMarginBeforeCallback:Pe.emptyParentCallback,siblingMarginAfterCallback:Pe.emptySiblingCallback,accessoryPaddingCallback:Pe.emptyAccessoryParentCallback};let y=[0],v=0;if(a.siblingMargin!==void 0&&(v=a.siblingMargin.value,v>=0))switch(a.siblingMargin.type){case Pe.SiblingMarginType.Absolute:g.siblingMarginAfterCallback=(t,i,n,r)=>{if(r.isRoot)return t;const c=v;return t.map(i,n).paddedWithMinArea(c*.5,0)};break;case Pe.SiblingMarginType.Relative:g.siblingMarginAfterCallback=(t,i,n,r)=>{if(r.isRoot)return t;const c=t.equalizedRelativeMargin(v);return t.map(i,n).paddedWithMinArea(c*.5,0)};break}if(a.parentPadding!==void 0&&(a.parentPadding.value instanceof Array?y=a.parentPadding.value:y=[a.parentPadding.value],y[0]>=0))switch(a.parentPadding.type){case Pe.ParentPaddingType.Mixed:g.parentPaddingCallback=(t,i,n,r,c,f)=>{let d,h;if(y.length-1>i.depth){const s=y[i.depth];d=t.equalizedMargin(s,.5,.9),h=t.padded(d),c!==void 0&&f!==void 0&&(c[i.index]=h,f[i.index]=d)}else d=t.equalizedRelativeMargin(y[y.length-1]),h=t.padded(d);return h},g.siblingMarginBeforeCallback=(t,i,n,r)=>{let c;return y.length>i.depth?c=v:c=t.equalizedRelativeMargin(v),t.padded(-c*.5)};break;case Pe.ParentPaddingType.Absolute:g.parentPaddingCallback=(t,i,n,r)=>{const c=t.equalizedMargin(y[0],.5,.6);return t.padded(c)},g.siblingMarginBeforeCallback=(t,i,n,r)=>{const c=v;return t.padded(-c*.5)};break;case Pe.ParentPaddingType.Relative:g.parentPaddingCallback=(t,i,n,r)=>{const c=t.equalizedRelativeMargin(y[0]);return t.padded(c)},g.siblingMarginBeforeCallback=(t,i,n,r)=>{const c=t.equalizedRelativeMargin(v);return t.padded(-c*.5)};break}if(a.accessoryPadding!==void 0){const t=a.accessoryPadding.type,i=a.accessoryPadding.value,n=a.accessoryPadding.direction,r=a.accessoryPadding.relativeAreaThreshold!==void 0?a.accessoryPadding.relativeAreaThreshold:0,c=a.accessoryPadding.targetAspectRatio!==void 0?a.accessoryPadding.targetAspectRatio:Number.NaN;if(i!==void 0)switch(t){case Pe.AccessoryPaddingType.Absolute:{switch(n){case Pe.AccessoryPaddingDirection.Bottom:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;if(i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i,o>f.height)return u[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.truncateBottom(f.bottom+o),p=f.truncateTop(_.bottom);return _.area/f.area<=m||p.aspectRatio<c?(u[d.index]=new Se(0,0,0,0),f):(u[d.index]=p,_)};break}case Pe.AccessoryPaddingDirection.Top:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;if(i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i,o>f.height)return u[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.truncateTop(f.top-o),p=f.truncateBottom(_.top);return _.area/f.area<=m||p.aspectRatio<c?(u[d.index]=new Se(0,0,0,0),f):(u[d.index]=p,_)};break}case Pe.AccessoryPaddingDirection.Left:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;if(i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i,o>f.width)return u[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.truncateLeft(f.left+o),p=f.truncateRight(_.left);return _.area/f.area<=m||p.aspectRatio<c?(u[d.index]=new Se(0,0,0,0),f):(u[d.index]=p,_)};break}case Pe.AccessoryPaddingDirection.Right:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;if(i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i,o>f.width)return u[d.index]=new Se(0,0,0,0),f;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.truncateRight(f.right+o),p=f.truncateLeft(_.right);return _.area/f.area<=m||p.aspectRatio<c?(u[d.index]=new Se(0,0,0,0),f):(u[d.index]=p,_)};break}}break}case Pe.AccessoryPaddingType.Relative:{switch(n){case Pe.AccessoryPaddingDirection.Bottom:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.relativeTop(1-o);return _.area/f.area>m?_:f};break}case Pe.AccessoryPaddingDirection.Top:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.relativeBottom(1-o);return _.area/f.area>m?_:f};break}case Pe.AccessoryPaddingDirection.Left:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.relativeRight(1-o);return _.area/f.area>m?_:f};break}case Pe.AccessoryPaddingDirection.Right:{g.accessoryPaddingCallback=(f,d,h,s,u)=>{let o;i instanceof Array?o=i.length>d.depth?i[d.depth]:0:o=i;let m;r instanceof Array?m=r.length>d.depth?r[d.depth]:1:m=r;const _=f.relativeLeft(1-o);return _.area/f.area>m?_:f};break}}break}}}return g}static packingLayoutPostprocessing(a){return{parentPaddingCallback:Pe.emptyParentCallback,siblingMarginBeforeCallback:Pe.emptyParentCallback,siblingMarginAfterCallback:Pe.emptySiblingCallback,accessoryPaddingCallback:Pe.emptyAccessoryParentCallback}}};Pe.emptyParentCallback=(a,g,y,v)=>a,Pe.emptyAccessoryParentCallback=(a,g,y,v,t)=>a,Pe.emptySiblingCallback=(a,g,y,v)=>a;let gs=Pe;(T=>{(a=>{a.Strip="strip",a.Snake="snake",a.CodeCity="codecity"})(T.LayoutAlgorithm||(T.LayoutAlgorithm={})),(a=>{a.Relative="relative",a.Absolute="absolute"})(T.SiblingMarginType||(T.SiblingMarginType={})),(a=>{a.Relative="relative",a.Absolute="absolute",a.Mixed="mixed"})(T.ParentPaddingType||(T.ParentPaddingType={})),(a=>{a.Relative="relative",a.Absolute="absolute"})(T.AccessoryPaddingType||(T.AccessoryPaddingType={})),(a=>{a.Top="top",a.Bottom="bottom",a.Left="left",a.Right="right"})(T.AccessoryPaddingDirection||(T.AccessoryPaddingDirection={}))})(gs||(gs={}));const ot=class ot{static byValue(a,g,y){if(!(g.length<2)){g.sort(y);for(let v=0;v<g.length-1;++v)g[v][0].nextSibling=g[v+1][0].index;g[g.length-1][0].nextSibling=Xe.INVALID_INDEX,a.firstChild=g[0][0].index}}static byValues(a,g,y,v){const t=new Array;let i=a.node(g.firstChild);do t.push([i,y[i.index]]),i=a.node(i.nextSibling);while(i!==void 0);ot.byValue(g,t,v)}static byIdentifier(a,g,y){const v=new Array;let t=a.node(g.firstChild);for(;t!==void 0;)v.push([t,t.id]),t=a.node(t.nextSibling);ot.byValue(g,v,y)}static restoreOriginalSortOrder(a,g){g.firstChild=g.initialFirstChild;for(let y=a.node(g.initialFirstChild);y!==void 0;y=a.node(y.initialNextSibling))y.nextSibling=y.initialNextSibling}static sortNodes(a,g,y,v){const t=v.layout.sort;if(t===void 0||t.algorithm===ot.Algorithm.Keep)return a.forEachInnerNode(n=>ot.restoreOriginalSortOrder(a,n)),!0;let i;switch(t.algorithm){case ot.Algorithm.Ascending:i=ot.ASCENDING_COMPARATOR;break;case ot.Algorithm.Descending:default:i=ot.DESCENDING_COMPARATOR;break}switch(t.key){case ot.Key.Weight:const n=St.create(a,g,v.layout.weight,v);n&&a.forEachInnerNode(r=>ot.byValues(a,r,n,i));break;case ot.Key.Identity:a.forEachInnerNode(r=>ot.byIdentifier(a,r,i));break;default:y!==void 0&&a.forEachInnerNode(r=>ot.byValues(a,r,y,i))}return!0}};ot.ASCENDING_COMPARATOR=(a,g)=>a[1]-g[1],ot.DESCENDING_COMPARATOR=(a,g)=>g[1]-a[1];let bs=ot;(T=>{(a=>{a.Keep="keep",a.Ascending="ascending",a.Descending="descending"})(T.Algorithm||(T.Algorithm={})),(a=>{a.Identity="identity",a.Weight="weight"})(T.Key||(T.Key={}))})(bs||(bs={}));const ub=[{identifier:"Spectral",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,153,213,148],[215,25,28,253,174,97,171,221,164,43,131,186],[215,25,28,253,174,97,255,255,191,171,221,164,43,131,186],[213,62,79,252,141,89,254,224,139,230,245,152,153,213,148,50,136,189],[213,62,79,252,141,89,254,224,139,255,255,191,230,245,152,153,213,148,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189],[213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162],[158,1,66,213,62,79,244,109,67,253,174,97,254,224,139,255,255,191,230,245,152,171,221,164,102,194,165,50,136,189,94,79,162]]},{identifier:"RdYlGn",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,207,96],[215,25,28,253,174,97,166,217,106,26,150,65],[215,25,28,253,174,97,255,255,191,166,217,106,26,150,65],[215,48,39,252,141,89,254,224,139,217,239,139,145,207,96,26,152,80],[215,48,39,252,141,89,254,224,139,255,255,191,217,239,139,145,207,96,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80],[215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,139,255,255,191,217,239,139,166,217,106,102,189,99,26,152,80,0,104,55]]},{identifier:"RdBu",type:"diverging",format:"rgb",colors:[[239,138,98,247,247,247,103,169,207],[202,0,32,244,165,130,146,197,222,5,113,176],[202,0,32,244,165,130,247,247,247,146,197,222,5,113,176],[178,24,43,239,138,98,253,219,199,209,229,240,103,169,207,33,102,172],[178,24,43,239,138,98,253,219,199,247,247,247,209,229,240,103,169,207,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172],[178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,247,247,247,209,229,240,146,197,222,67,147,195,33,102,172,5,48,97]]},{identifier:"PiYG",type:"diverging",format:"rgb",colors:[[233,163,201,247,247,247,161,215,106],[208,28,139,241,182,218,184,225,134,77,172,38],[208,28,139,241,182,218,247,247,247,184,225,134,77,172,38],[197,27,125,233,163,201,253,224,239,230,245,208,161,215,106,77,146,33],[197,27,125,233,163,201,253,224,239,247,247,247,230,245,208,161,215,106,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33],[197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25],[142,1,82,197,27,125,222,119,174,241,182,218,253,224,239,247,247,247,230,245,208,184,225,134,127,188,65,77,146,33,39,100,25]]},{identifier:"PRGn",type:"diverging",format:"rgb",colors:[[175,141,195,247,247,247,127,191,123],[123,50,148,194,165,207,166,219,160,0,136,55],[123,50,148,194,165,207,247,247,247,166,219,160,0,136,55],[118,42,131,175,141,195,231,212,232,217,240,211,127,191,123,27,120,55],[118,42,131,175,141,195,231,212,232,247,247,247,217,240,211,127,191,123,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55],[118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27],[64,0,75,118,42,131,153,112,171,194,165,207,231,212,232,247,247,247,217,240,211,166,219,160,90,174,97,27,120,55,0,68,27]]},{identifier:"RdYlBu",type:"diverging",format:"rgb",colors:[[252,141,89,255,255,191,145,191,219],[215,25,28,253,174,97,171,217,233,44,123,182],[215,25,28,253,174,97,255,255,191,171,217,233,44,123,182],[215,48,39,252,141,89,254,224,144,224,243,248,145,191,219,69,117,180],[215,48,39,252,141,89,254,224,144,255,255,191,224,243,248,145,191,219,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180],[215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149],[165,0,38,215,48,39,244,109,67,253,174,97,254,224,144,255,255,191,224,243,248,171,217,233,116,173,209,69,117,180,49,54,149]]},{identifier:"BrBG",type:"diverging",format:"rgb",colors:[[216,179,101,245,245,245,90,180,172],[166,97,26,223,194,125,128,205,193,1,133,113],[166,97,26,223,194,125,245,245,245,128,205,193,1,133,113],[140,81,10,216,179,101,246,232,195,199,234,229,90,180,172,1,102,94],[140,81,10,216,179,101,246,232,195,245,245,245,199,234,229,90,180,172,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94],[140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48],[84,48,5,140,81,10,191,129,45,223,194,125,246,232,195,245,245,245,199,234,229,128,205,193,53,151,143,1,102,94,0,60,48]]},{identifier:"RdGy",type:"diverging",format:"rgb",colors:[[239,138,98,255,255,255,153,153,153],[202,0,32,244,165,130,186,186,186,64,64,64],[202,0,32,244,165,130,255,255,255,186,186,186,64,64,64],[178,24,43,239,138,98,253,219,199,224,224,224,153,153,153,77,77,77],[178,24,43,239,138,98,253,219,199,255,255,255,224,224,224,153,153,153,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77],[178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26],[103,0,31,178,24,43,214,96,77,244,165,130,253,219,199,255,255,255,224,224,224,186,186,186,135,135,135,77,77,77,26,26,26]]},{identifier:"PuOr",type:"diverging",format:"rgb",colors:[[241,163,64,247,247,247,153,142,195],[230,97,1,253,184,99,178,171,210,94,60,153],[230,97,1,253,184,99,247,247,247,178,171,210,94,60,153],[179,88,6,241,163,64,254,224,182,216,218,235,153,142,195,84,39,136],[179,88,6,241,163,64,254,224,182,247,247,247,216,218,235,153,142,195,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136],[179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75],[127,59,8,179,88,6,224,130,20,253,184,99,254,224,182,247,247,247,216,218,235,178,171,210,128,115,172,84,39,136,45,0,75]]},{identifier:"Set2",type:"qualitative",format:"rgb",colors:[[102,194,165,252,141,98,141,160,203],[102,194,165,252,141,98,141,160,203,231,138,195],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148],[102,194,165,252,141,98,141,160,203,231,138,195,166,216,84,255,217,47,229,196,148,179,179,179]]},{identifier:"Accent",type:"qualitative",format:"rgb",colors:[[127,201,127,190,174,212,253,192,134],[127,201,127,190,174,212,253,192,134,255,255,153],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23],[127,201,127,190,174,212,253,192,134,255,255,153,56,108,176,240,2,127,191,91,23,102,102,102]]},{identifier:"Set1",type:"qualitative",format:"rgb",colors:[[228,26,28,55,126,184,77,175,74],[228,26,28,55,126,184,77,175,74,152,78,163],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191],[228,26,28,55,126,184,77,175,74,152,78,163,255,127,0,255,255,51,166,86,40,247,129,191,153,153,153]]},{identifier:"Set3",type:"qualitative",format:"rgb",colors:[[141,211,199,255,255,179,190,186,218],[141,211,199,255,255,179,190,186,218,251,128,114],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197],[141,211,199,255,255,179,190,186,218,251,128,114,128,177,211,253,180,98,179,222,105,252,205,229,217,217,217,188,128,189,204,235,197,255,237,111]]},{identifier:"Dark2",type:"qualitative",format:"rgb",colors:[[27,158,119,217,95,2,117,112,179],[27,158,119,217,95,2,117,112,179,231,41,138],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29],[27,158,119,217,95,2,117,112,179,231,41,138,102,166,30,230,171,2,166,118,29,102,102,102]]},{identifier:"Paired",type:"qualitative",format:"rgb",colors:[[166,206,227,31,120,180,178,223,138],[166,206,227,31,120,180,178,223,138,51,160,44],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153],[166,206,227,31,120,180,178,223,138,51,160,44,251,154,153,227,26,28,253,191,111,255,127,0,202,178,214,106,61,154,255,255,153,177,89,40]]},{identifier:"Pastel2",type:"qualitative",format:"rgb",colors:[[179,226,205,253,205,172,203,213,232],[179,226,205,253,205,172,203,213,232,244,202,228],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204],[179,226,205,253,205,172,203,213,232,244,202,228,230,245,201,255,242,174,241,226,204,204,204,204]]},{identifier:"Pastel1",type:"qualitative",format:"rgb",colors:[[251,180,174,179,205,227,204,235,197],[251,180,174,179,205,227,204,235,197,222,203,228],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236],[251,180,174,179,205,227,204,235,197,222,203,228,254,217,166,255,255,204,229,216,189,253,218,236,242,242,242]]},{identifier:"OrRd",type:"sequential",format:"rgb",colors:[[254,232,200,253,187,132,227,74,51],[254,240,217,253,204,138,252,141,89,215,48,31],[254,240,217,253,204,138,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,227,74,51,179,0,0],[254,240,217,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,153,0,0],[255,247,236,254,232,200,253,212,158,253,187,132,252,141,89,239,101,72,215,48,31,179,0,0,127,0,0]]},{identifier:"PuBu",type:"sequential",format:"rgb",colors:[[236,231,242,166,189,219,43,140,190],[241,238,246,189,201,225,116,169,207,5,112,176],[241,238,246,189,201,225,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,43,140,190,4,90,141],[241,238,246,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,3,78,123],[255,247,251,236,231,242,208,209,230,166,189,219,116,169,207,54,144,192,5,112,176,4,90,141,2,56,88]]},{identifier:"BuPu",type:"sequential",format:"rgb",colors:[[224,236,244,158,188,218,136,86,167],[237,248,251,179,205,227,140,150,198,136,65,157],[237,248,251,179,205,227,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,136,86,167,129,15,124],[237,248,251,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,110,1,107],[247,252,253,224,236,244,191,211,230,158,188,218,140,150,198,140,107,177,136,65,157,129,15,124,77,0,75]]},{identifier:"Oranges",type:"sequential",format:"rgb",colors:[[254,230,206,253,174,107,230,85,13],[254,237,222,253,190,133,253,141,60,217,71,1],[254,237,222,253,190,133,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,230,85,13,166,54,3],[254,237,222,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,140,45,4],[255,245,235,254,230,206,253,208,162,253,174,107,253,141,60,241,105,19,217,72,1,166,54,3,127,39,4]]},{identifier:"BuGn",type:"sequential",format:"rgb",colors:[[229,245,249,153,216,201,44,162,95],[237,248,251,178,226,226,102,194,164,35,139,69],[237,248,251,178,226,226,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,44,162,95,0,109,44],[237,248,251,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,88,36],[247,252,253,229,245,249,204,236,230,153,216,201,102,194,164,65,174,118,35,139,69,0,109,44,0,68,27]]},{identifier:"YlOrBr",type:"sequential",format:"rgb",colors:[[255,247,188,254,196,79,217,95,14],[255,255,212,254,217,142,254,153,41,204,76,2],[255,255,212,254,217,142,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,217,95,14,153,52,4],[255,255,212,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,140,45,4],[255,255,229,255,247,188,254,227,145,254,196,79,254,153,41,236,112,20,204,76,2,153,52,4,102,37,6]]},{identifier:"YlGn",type:"sequential",format:"rgb",colors:[[247,252,185,173,221,142,49,163,84],[255,255,204,194,230,153,120,198,121,35,132,67],[255,255,204,194,230,153,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,49,163,84,0,104,55],[255,255,204,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,90,50],[255,255,229,247,252,185,217,240,163,173,221,142,120,198,121,65,171,93,35,132,67,0,104,55,0,69,41]]},{identifier:"Reds",type:"sequential",format:"rgb",colors:[[254,224,210,252,146,114,222,45,38],[254,229,217,252,174,145,251,106,74,203,24,29],[254,229,217,252,174,145,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,222,45,38,165,15,21],[254,229,217,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,153,0,13],[255,245,240,254,224,210,252,187,161,252,146,114,251,106,74,239,59,44,203,24,29,165,15,21,103,0,13]]},{identifier:"RdPu",type:"sequential",format:"rgb",colors:[[253,224,221,250,159,181,197,27,138],[254,235,226,251,180,185,247,104,161,174,1,126],[254,235,226,251,180,185,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,197,27,138,122,1,119],[254,235,226,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119],[255,247,243,253,224,221,252,197,192,250,159,181,247,104,161,221,52,151,174,1,126,122,1,119,73,0,106]]},{identifier:"Greens",type:"sequential",format:"rgb",colors:[[229,245,224,161,217,155,49,163,84],[237,248,233,186,228,179,116,196,118,35,139,69],[237,248,233,186,228,179,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,49,163,84,0,109,44],[237,248,233,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,90,50],[247,252,245,229,245,224,199,233,192,161,217,155,116,196,118,65,171,93,35,139,69,0,109,44,0,68,27]]},{identifier:"YlGnBu",type:"sequential",format:"rgb",colors:[[237,248,177,127,205,187,44,127,184],[255,255,204,161,218,180,65,182,196,34,94,168],[255,255,204,161,218,180,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,44,127,184,37,52,148],[255,255,204,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,12,44,132],[255,255,217,237,248,177,199,233,180,127,205,187,65,182,196,29,145,192,34,94,168,37,52,148,8,29,88]]},{identifier:"Purples",type:"sequential",format:"rgb",colors:[[239,237,245,188,189,220,117,107,177],[242,240,247,203,201,226,158,154,200,106,81,163],[242,240,247,203,201,226,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,117,107,177,84,39,143],[242,240,247,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,74,20,134],[252,251,253,239,237,245,218,218,235,188,189,220,158,154,200,128,125,186,106,81,163,84,39,143,63,0,125]]},{identifier:"GnBu",type:"sequential",format:"rgb",colors:[[224,243,219,168,221,181,67,162,202],[240,249,232,186,228,188,123,204,196,43,140,190],[240,249,232,186,228,188,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,67,162,202,8,104,172],[240,249,232,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,88,158],[247,252,240,224,243,219,204,235,197,168,221,181,123,204,196,78,179,211,43,140,190,8,104,172,8,64,129]]},{identifier:"Greys",type:"sequential",format:"rgb",colors:[[240,240,240,189,189,189,99,99,99],[247,247,247,204,204,204,150,150,150,82,82,82],[247,247,247,204,204,204,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,99,99,99,37,37,37],[247,247,247,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37],[255,255,255,240,240,240,217,217,217,189,189,189,150,150,150,115,115,115,82,82,82,37,37,37,0,0,0]]},{identifier:"YlOrRd",type:"sequential",format:"rgb",colors:[[255,237,160,254,178,76,240,59,32],[255,255,178,254,204,92,253,141,60,227,26,28],[255,255,178,254,204,92,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,240,59,32,189,0,38],[255,255,178,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,177,0,38],[255,255,204,255,237,160,254,217,118,254,178,76,253,141,60,252,78,42,227,26,28,189,0,38,128,0,38]]},{identifier:"PuRd",type:"sequential",format:"rgb",colors:[[231,225,239,201,148,199,221,28,119],[241,238,246,215,181,216,223,101,176,206,18,86],[241,238,246,215,181,216,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,221,28,119,152,0,67],[241,238,246,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,145,0,63],[247,244,249,231,225,239,212,185,218,201,148,199,223,101,176,231,41,138,206,18,86,152,0,67,103,0,31]]},{identifier:"Blues",type:"sequential",format:"rgb",colors:[[222,235,247,158,202,225,49,130,189],[239,243,255,189,215,231,107,174,214,33,113,181],[239,243,255,189,215,231,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,49,130,189,8,81,156],[239,243,255,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,69,148],[247,251,255,222,235,247,198,219,239,158,202,225,107,174,214,66,146,198,33,113,181,8,81,156,8,48,107]]},{identifier:"PuBuGn",type:"sequential",format:"rgb",colors:[[236,226,240,166,189,219,28,144,153],[246,239,247,189,201,225,103,169,207,2,129,138],[246,239,247,189,201,225,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,28,144,153,1,108,89],[246,239,247,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,100,80],[255,247,251,236,226,240,208,209,230,166,189,219,103,169,207,54,144,192,2,129,138,1,108,89,1,70,54]]}],lb=[{identifier:"magma",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002258,.001295,.018331,.003279,.002305,.023708,.004512,.00349,.029965,.00595,.004843,.03713,.007588,.006356,.044973,.009426,.008022,.052844,.011465,.009828,.06075,.013708,.011771,.068667,.016156,.01384,.076603,.018815,.016026,.084584,.021692,.01832,.09261,.024792,.020715,.100676,.028123,.023201,.108787,.031696,.025765,.116965,.03552,.028397,.125209,.039608,.03109,.133515,.04383,.03383,.141886,.048062,.036607,.150327,.05232,.039407,.158841,.056615,.04216,.167446,.060949,.044794,.176129,.06533,.047318,.184892,.069764,.049726,.193735,.074257,.052017,.20266,.078815,.054184,.211667,.083446,.056225,.220755,.088155,.058133,.229922,.092949,.059904,.239164,.097833,.061531,.248477,.102815,.06301,.257854,.107899,.064335,.267289,.113094,.065492,.276784,.118405,.066479,.286321,.123833,.067295,.295879,.12938,.067935,.305443,.135053,.068391,.315,.140858,.068654,.324538,.146785,.068738,.334011,.152839,.068637,.343404,.159018,.068354,.352688,.165308,.067911,.361816,.171713,.067305,.370771,.178212,.066576,.379497,.184801,.065732,.387973,.19146,.064818,.396152,.198177,.063862,.404009,.204935,.062907,.411514,.211718,.061992,.418647,.218512,.061158,.425392,.225302,.060445,.431742,.232077,.059889,.437695,.238826,.059517,.443256,.245543,.059352,.448436,.25222,.059415,.453248,.258857,.059706,.45771,.265447,.060237,.46184,.271994,.060994,.46566,.278493,.061978,.46919,.284951,.063168,.472451,.291366,.064553,.475462,.29774,.066117,.478243,.304081,.067835,.480812,.310382,.069702,.483186,.316654,.07169,.48538,.322899,.073782,.487408,.329114,.075972,.489287,.335308,.078236,.491024,.341482,.080564,.492631,.347636,.082946,.494121,.353773,.085373,.495501,.359898,.087831,.496778,.366012,.090314,.49796,.372116,.092816,.499053,.378211,.095332,.500067,.384299,.097855,.501002,.390384,.100379,.501864,.396467,.102902,.502658,.402548,.10542,.503386,.408629,.10793,.504052,.414709,.110431,.504662,.420791,.11292,.505215,.426877,.115395,.505714,.432967,.117855,.50616,.439062,.120298,.506555,.445163,.122724,.506901,.451271,.125132,.507198,.457386,.127522,.507448,.463508,.129893,.507652,.46964,.132245,.507809,.47578,.134577,.507921,.481929,.136891,.507989,.488088,.139186,.508011,.494258,.141462,.507988,.500438,.143719,.50792,.506629,.145958,.507806,.512831,.148179,.507648,.519045,.150383,.507443,.52527,.152569,.507192,.531507,.154739,.506895,.537755,.156894,.506551,.544015,.159033,.506159,.550287,.161158,.505719,.556571,.163269,.50523,.562866,.165368,.504692,.569172,.167454,.504105,.57549,.16953,.503466,.581819,.171596,.502777,.588158,.173652,.502035,.594508,.175701,.501241,.600868,.177743,.500394,.607238,.179779,.499492,.613617,.181811,.498536,.620005,.18384,.497524,.626401,.185867,.496456,.632805,.187893,.495332,.639216,.189921,.49415,.645633,.191952,.49291,.652056,.193986,.491611,.658483,.196027,.490253,.664915,.198075,.488836,.671349,.200133,.487358,.677786,.202203,.485819,.684224,.204286,.484219,.690661,.206384,.482558,.697098,.208501,.480835,.703532,.210638,.479049,.709962,.212797,.477201,.716387,.214982,.47529,.722805,.217194,.473316,.729216,.219437,.471279,.735616,.221713,.46918,.742004,.224025,.467018,.748378,.226377,.464794,.754737,.228772,.462509,.761077,.231214,.460162,.767398,.233705,.457755,.773695,.236249,.455289,.779968,.238851,.452765,.786212,.241514,.450184,.792427,.244242,.447543,.798608,.24704,.444848,.804752,.249911,.442102,.810855,.252861,.439305,.816914,.255895,.436461,.822926,.259016,.433573,.828886,.262229,.430644,.834791,.26554,.427671,.840636,.268953,.424666,.846416,.272473,.421631,.852126,.276106,.418573,.857763,.279857,.415496,.86332,.283729,.412403,.868793,.287728,.409303,.874176,.291859,.406205,.879464,.296125,.403118,.884651,.30053,.400047,.889731,.305079,.397002,.8947,.309773,.393995,.899552,.314616,.391037,.904281,.31961,.388137,.908884,.324755,.385308,.913354,.330052,.382563,.917689,.3355,.379915,.921884,.341098,.377376,.925937,.346844,.374959,.929845,.352734,.372677,.933606,.358764,.370541,.937221,.364929,.368567,.940687,.371224,.366762,.944006,.377643,.365136,.94718,.384178,.363701,.95021,.39082,.362468,.953099,.397563,.361438,.955849,.4044,.360619,.958464,.411324,.360014,.960949,.418323,.35963,.96331,.42539,.359469,.965549,.432519,.359529,.967671,.439703,.35981,.96968,.446936,.360311,.971582,.45421,.36103,.973381,.46152,.361965,.975082,.468861,.363111,.97669,.476226,.364466,.97821,.483612,.366025,.979645,.491014,.367783,.981,.498428,.369734,.982279,.505851,.371874,.983485,.51328,.374198,.984622,.520713,.376698,.985693,.528148,.379371,.9867,.535582,.38221,.987646,.543015,.38521,.988533,.550446,.388365,.989363,.557873,.391671,.990138,.565296,.395122,.990871,.572706,.398714,.991558,.580107,.402441,.992196,.587502,.406299,.992785,.594891,.410283,.993326,.602275,.41439,.993834,.609644,.418613,.994309,.616999,.42295,.994738,.62435,.427397,.995122,.631696,.431951,.99548,.639027,.436607,.99581,.646344,.441361,.996096,.653659,.446213,.996341,.660969,.45116,.99658,.668256,.456192,.996775,.675541,.461314,.996925,.682828,.466526,.997077,.690088,.471811,.997186,.697349,.477182,.997254,.704611,.482635,.997325,.711848,.488154,.997351,.719089,.493755,.997351,.726324,.499428,.997341,.733545,.505167,.997285,.740772,.510983,.997228,.747981,.516859,.997138,.75519,.522806,.997019,.762398,.528821,.996898,.769591,.534892,.996727,.776795,.541039,.996571,.783977,.547233,.996369,.791167,.553499,.996162,.798348,.55982,.995932,.805527,.566202,.99568,.812706,.572645,.995424,.819875,.57914,.995131,.827052,.585701,.994851,.834213,.592307,.994524,.841387,.598983,.994222,.84854,.605696,.993866,.855711,.612482,.993545,.862859,.619299,.99317,.870024,.626189,.992831,.877168,.633109,.99244,.88433,.640099,.992089,.89147,.647116,.991688,.898627,.654202,.991332,.905763,.661309,.99093,.912915,.668481,.99057,.920049,.675675,.990175,.927196,.682926,.989815,.934329,.690198,.989434,.94147,.697519,.989077,.948604,.704863,.988717,.955742,.712242,.988367,.962878,.719649,.988033,.970012,.727077,.987691,.977154,.734536,.987387,.984288,.742002,.987053,.991438,.7495]]},{identifier:"inferno",type:"sequential",format:"rgbf",colors:[[.001462,466e-6,.013866,.002267,.00127,.01857,.003299,.002249,.024239,.004547,.003392,.030909,.006006,.004692,.038558,.007676,.006136,.046836,.009561,.007713,.055143,.011663,.009417,.06346,.013995,.011225,.071862,.016561,.013136,.080282,.019373,.015133,.088767,.022447,.017199,.097327,.025793,.019331,.10593,.029432,.021503,.114621,.033385,.023702,.123397,.037668,.025921,.132232,.042253,.028139,.141141,.046915,.030324,.150164,.051644,.032474,.159254,.056449,.034569,.168414,.06134,.03659,.177642,.066331,.038504,.186962,.071429,.040294,.196354,.076637,.041905,.205799,.081962,.043328,.215289,.087411,.044556,.224813,.09299,.045583,.234358,.098702,.046402,.243904,.104551,.047008,.25343,.110536,.047399,.262912,.116656,.047574,.272321,.122908,.047536,.281624,.129285,.047293,.290788,.135778,.046856,.299776,.142378,.046242,.308553,.149073,.045468,.317085,.15585,.044559,.325338,.162689,.043554,.333277,.169575,.042489,.340874,.176493,.041402,.348111,.183429,.040329,.354971,.190367,.039309,.361447,.197297,.0384,.367535,.204209,.037632,.373238,.211095,.03703,.378563,.217949,.036615,.383522,.224763,.036405,.388129,.231538,.036405,.3924,.238273,.036621,.396353,.244967,.037055,.400007,.25162,.037705,.403378,.258234,.038571,.406485,.26481,.039647,.409345,.271347,.040922,.411976,.27785,.042353,.414392,.284321,.043933,.416608,.290763,.045644,.418637,.297178,.04747,.420491,.303568,.049396,.422182,.309935,.051407,.423721,.316282,.05349,.425116,.32261,.055634,.426377,.328921,.057827,.427511,.335217,.06006,.428524,.3415,.062325,.429425,.347771,.064616,.430217,.354032,.066925,.430906,.360284,.069247,.431497,.366529,.071579,.431994,.372768,.073915,.4324,.379001,.076253,.432719,.385228,.078591,.432955,.391453,.080927,.433109,.397674,.083257,.433183,.403894,.08558,.433179,.410113,.087896,.433098,.416331,.090203,.432943,.422549,.092501,.432714,.428768,.09479,.432412,.434987,.097069,.432039,.441207,.099338,.431594,.447428,.101597,.43108,.453651,.103848,.430498,.459875,.106089,.429846,.4661,.108322,.429125,.472328,.110547,.428334,.478558,.112764,.427475,.484789,.114974,.426548,.491022,.117179,.425552,.497257,.119379,.424488,.503493,.121575,.423356,.50973,.123769,.422156,.515967,.12596,.420887,.522206,.12815,.419549,.528444,.130341,.418142,.534683,.132534,.416667,.54092,.134729,.415123,.547157,.136929,.413511,.553392,.139134,.411829,.559624,.141346,.410078,.565854,.143567,.408258,.572081,.145797,.406369,.578304,.148039,.404411,.584521,.150294,.402385,.590734,.152563,.40029,.59694,.154848,.398125,.603139,.157151,.395891,.60933,.159474,.393589,.615513,.161817,.391219,.621685,.164184,.388781,.627847,.166575,.386276,.633998,.168992,.383704,.640135,.171438,.381065,.64626,.173914,.378359,.652369,.176421,.375586,.658463,.178962,.372748,.66454,.181539,.369846,.670599,.184153,.366879,.676638,.186807,.363849,.682656,.189501,.360757,.688653,.192239,.357603,.694627,.195021,.354388,.700576,.197851,.351113,.7065,.200728,.347777,.712396,.203656,.344383,.718264,.206636,.340931,.724103,.20967,.337424,.729909,.212759,.333861,.735683,.215906,.330245,.741423,.219112,.326576,.747127,.222378,.322856,.752794,.225706,.319085,.758422,.229097,.315266,.76401,.232554,.311399,.769556,.236077,.307485,.775059,.239667,.303526,.780517,.243327,.299523,.785929,.247056,.295477,.791293,.250856,.29139,.796607,.254728,.287264,.801871,.258674,.283099,.807082,.262692,.278898,.812239,.266786,.274661,.817341,.270954,.27039,.822386,.275197,.266085,.827372,.279517,.26175,.832299,.283913,.257383,.837165,.288385,.252988,.841969,.292933,.248564,.846709,.297559,.244113,.851384,.30226,.239636,.855992,.307038,.235133,.860533,.311892,.230606,.865006,.316822,.226055,.869409,.321827,.221482,.873741,.326906,.216886,.878001,.33206,.212268,.882188,.337287,.207628,.886302,.342586,.202968,.890341,.347957,.198286,.894305,.353399,.193584,.898192,.358911,.18886,.902003,.364492,.184116,.905735,.37014,.17935,.90939,.375856,.174563,.912966,.381636,.169755,.916462,.387481,.164924,.919879,.393389,.16007,.923215,.399359,.155193,.92647,.405389,.150292,.929644,.411479,.145367,.932737,.417627,.140417,.935747,.423831,.13544,.938675,.430091,.130438,.941521,.436405,.125409,.944285,.442772,.120354,.946965,.449191,.115272,.949562,.45566,.110164,.952075,.462178,.105031,.954506,.468744,.099874,.956852,.475356,.094695,.959114,.482014,.089499,.961293,.488716,.084289,.963387,.495462,.079073,.965397,.502249,.073859,.967322,.509078,.068659,.969163,.515946,.063488,.970919,.522853,.058367,.97259,.529798,.053324,.974176,.53678,.048392,.975677,.543798,.043618,.977092,.55085,.03905,.978422,.557937,.034931,.979666,.565057,.031409,.980824,.572209,.028508,.981895,.579392,.02625,.982881,.586606,.024661,.983779,.593849,.02377,.984591,.601122,.023606,.985315,.608422,.024202,.985952,.61575,.025592,.986502,.623105,.027814,.986964,.630485,.030908,.987337,.63789,.034916,.987622,.64532,.039886,.987819,.652773,.045581,.987926,.66025,.05175,.987945,.667748,.058329,.987874,.675267,.065257,.987714,.682807,.072489,.987464,.690366,.07999,.987124,.697944,.087731,.986694,.70554,.095694,.986175,.713153,.103863,.985566,.720782,.112229,.984865,.728427,.120785,.984075,.736087,.129527,.983196,.743758,.138453,.982228,.751442,.147565,.981173,.759135,.156863,.980032,.766837,.166353,.978806,.774545,.176037,.977497,.782258,.185923,.976108,.789974,.196018,.974638,.797692,.206332,.973088,.805409,.216877,.971468,.813122,.227658,.969783,.820825,.238686,.968041,.828515,.249972,.966243,.836191,.261534,.964394,.843848,.273391,.962517,.851476,.285546,.960626,.859069,.29801,.95872,.866624,.31082,.956834,.874129,.323974,.954997,.881569,.337475,.953215,.888942,.351369,.951546,.896226,.365627,.950018,.903409,.380271,.948683,.910473,.395289,.947594,.917399,.410665,.946809,.924168,.426373,.946392,.930761,.442367,.946403,.937159,.458592,.946903,.943348,.47497,.947937,.949318,.491426,.949545,.955063,.50786,.95174,.960587,.524203,.954529,.965896,.540361,.957896,.971003,.556275,.961812,.975924,.571925,.966249,.980678,.587206,.971162,.985282,.602154,.976511,.989753,.61676,.982257,.994109,.631017,.988362,.998364,.644924]]},{identifier:"plasma",type:"diverging",format:"rgbf",colors:[[.050383,.029803,.527975,.063536,.028426,.533124,.075353,.027206,.538007,.086222,.026125,.542658,.096379,.025165,.547103,.10598,.024309,.551368,.115124,.023556,.555468,.123903,.022878,.559423,.132381,.022258,.56325,.140603,.021687,.566959,.148607,.021154,.570562,.156421,.020651,.574065,.16407,.020171,.577478,.171574,.019706,.580806,.17895,.019252,.584054,.186213,.018803,.587228,.193374,.018354,.59033,.200445,.017902,.593364,.207435,.017442,.596333,.21435,.016973,.599239,.221197,.016497,.602083,.227983,.016007,.604867,.234715,.015502,.607592,.241396,.014979,.610259,.248032,.014439,.612868,.254627,.013882,.615419,.261183,.013308,.617911,.267703,.012716,.620346,.274191,.012109,.622722,.280648,.011488,.625038,.287076,.010855,.627295,.293478,.010213,.62949,.299855,.009561,.631624,.30621,.008902,.633694,.312543,.008239,.6357,.318856,.007576,.63764,.32515,.006915,.639512,.331426,.006261,.641316,.337683,.005618,.643049,.343925,.004991,.64471,.35015,.004382,.646298,.356359,.003798,.64781,.362553,.003243,.649245,.368733,.002724,.650601,.374897,.002245,.651876,.381047,.001814,.653068,.387183,.001434,.654177,.393304,.001114,.655199,.399411,859e-6,.656133,.405503,678e-6,.656977,.41158,577e-6,.65773,.417642,564e-6,.65839,.423689,646e-6,.658956,.429719,831e-6,.659425,.435734,.001127,.659797,.441732,.00154,.660069,.447714,.00208,.66024,.453677,.002755,.66031,.459623,.003574,.660277,.46555,.004545,.660139,.471457,.005678,.659897,.477344,.00698,.659549,.48321,.00846,.659095,.489055,.010127,.658534,.494877,.01199,.657865,.500678,.014055,.657088,.506454,.016333,.656202,.512206,.018833,.655209,.517933,.021563,.654109,.523633,.024532,.652901,.529306,.027747,.651586,.534952,.031217,.650165,.54057,.03495,.64864,.546157,.038954,.64701,.551715,.043136,.645277,.557243,.047331,.643443,.562738,.051545,.641509,.568201,.055778,.639477,.573632,.060028,.637349,.579029,.064296,.635126,.584391,.068579,.632812,.589719,.072878,.630408,.595011,.07719,.627917,.600266,.081516,.625342,.605485,.085854,.622686,.610667,.090204,.619951,.615812,.094564,.61714,.620919,.098934,.614257,.625987,.103312,.611305,.631017,.107699,.608287,.636008,.112092,.605205,.640959,.116492,.602065,.645872,.120898,.598867,.650746,.125309,.595617,.65558,.129725,.592317,.660374,.134144,.588971,.665129,.138566,.585582,.669845,.142992,.582154,.674522,.147419,.578688,.67916,.151848,.575189,.683758,.156278,.57166,.688318,.160709,.568103,.69284,.165141,.564522,.697324,.169573,.560919,.701769,.174005,.557296,.706178,.178437,.553657,.710549,.182868,.550004,.714883,.187299,.546338,.719181,.191729,.542663,.723444,.196158,.538981,.72767,.200586,.535293,.731862,.205013,.531601,.736019,.209439,.527908,.740143,.213864,.524216,.744232,.218288,.520524,.748289,.222711,.516834,.752312,.227133,.513149,.756304,.231555,.509468,.760264,.235976,.505794,.764193,.240396,.502126,.76809,.244817,.498465,.771958,.249237,.494813,.775796,.253658,.491171,.779604,.258078,.487539,.783383,.2625,.483918,.787133,.266922,.480307,.790855,.271345,.476706,.794549,.27577,.473117,.798216,.280197,.469538,.801855,.284626,.465971,.805467,.289057,.462415,.809052,.293491,.45887,.812612,.297928,.455338,.816144,.302368,.451816,.819651,.306812,.448306,.823132,.311261,.444806,.826588,.315714,.441316,.830018,.320172,.437836,.833422,.324635,.434366,.836801,.329105,.430905,.840155,.33358,.427455,.843484,.338062,.424013,.846788,.342551,.420579,.850066,.347048,.417153,.853319,.351553,.413734,.856547,.356066,.410322,.85975,.360588,.406917,.862927,.365119,.403519,.866078,.36966,.400126,.869203,.374212,.396738,.872303,.378774,.393355,.875376,.383347,.389976,.878423,.387932,.3866,.881443,.392529,.383229,.884436,.397139,.37986,.887402,.401762,.376494,.89034,.406398,.37313,.89325,.411048,.369768,.896131,.415712,.366407,.898984,.420392,.363047,.901807,.425087,.359688,.904601,.429797,.356329,.907365,.434524,.35297,.910098,.439268,.34961,.9128,.444029,.346251,.915471,.448807,.34289,.918109,.453603,.339529,.920714,.458417,.336166,.923287,.463251,.332801,.925825,.468103,.329435,.928329,.472975,.326067,.930798,.477867,.322697,.933232,.48278,.319325,.93563,.487712,.315952,.93799,.492667,.312575,.940313,.497642,.309197,.942598,.502639,.305816,.944844,.507658,.302433,.947051,.512699,.299049,.949217,.517763,.295662,.951344,.52285,.292275,.953428,.52796,.288883,.95547,.533093,.28549,.957469,.53825,.282096,.959424,.543431,.278701,.961336,.548636,.275305,.963203,.553865,.271909,.965024,.559118,.268513,.966798,.564396,.265118,.968526,.5697,.261721,.970205,.575028,.258325,.971835,.580382,.254931,.973416,.585761,.25154,.974947,.591165,.248151,.976428,.596595,.244767,.977856,.602051,.241387,.979233,.607532,.238013,.980556,.613039,.234646,.981826,.618572,.231287,.983041,.624131,.227937,.984199,.629718,.224595,.985301,.63533,.221265,.986345,.640969,.217948,.987332,.646633,.214648,.98826,.652325,.211364,.989128,.658043,.2081,.989935,.663787,.204859,.990681,.669558,.201642,.991365,.675355,.198453,.991985,.681179,.195295,.992541,.68703,.19217,.993032,.692907,.189084,.993456,.69881,.186041,.993814,.704741,.183043,.994103,.710698,.180097,.994324,.716681,.177208,.994474,.722691,.174381,.994553,.728728,.171622,.994561,.734791,.168938,.994495,.74088,.166335,.994355,.746995,.163821,.994141,.753137,.161404,.993851,.759304,.159092,.993482,.765499,.156891,.993033,.77172,.154808,.992505,.777967,.152855,.991897,.784239,.151042,.991209,.790537,.149377,.990439,.796859,.14787,.989587,.803205,.146529,.988648,.809579,.145357,.987621,.815978,.144363,.986509,.822401,.143557,.985314,.828846,.142945,.984031,.835315,.142528,.982653,.841812,.142303,.98119,.848329,.142279,.979644,.854866,.142453,.977995,.861432,.142808,.976265,.868016,.143351,.974443,.874622,.144061,.97253,.88125,.144923,.970533,.887896,.145919,.968443,.894564,.147014,.966271,.901249,.14818,.964021,.90795,.14937,.961681,.914672,.15052,.959276,.921407,.151566,.956808,.928152,.152409,.954287,.934908,.152921,.951726,.941671,.152925,.949151,.948435,.152178,.946602,.95519,.150328,.944152,.961916,.146861,.941896,.96859,.140956,.940015,.975158,.131326]]},{identifier:"viridis",type:"diverging",format:"rgbf",colors:[[.267004,.004874,.329415,.26851,.009605,.335427,.269944,.014625,.341379,.271305,.019942,.347269,.272594,.025563,.353093,.273809,.031497,.358853,.274952,.037752,.364543,.276022,.044167,.370164,.277018,.050344,.375715,.277941,.056324,.381191,.278791,.062145,.386592,.279566,.067836,.391917,.280267,.073417,.397163,.280894,.078907,.402329,.281446,.08432,.407414,.281924,.089666,.412415,.282327,.094955,.417331,.282656,.100196,.42216,.28291,.105393,.426902,.283091,.110553,.431554,.283197,.11568,.436115,.283229,.120777,.440584,.283187,.125848,.44496,.283072,.130895,.449241,.282884,.13592,.453427,.282623,.140926,.457517,.28229,.145912,.46151,.281887,.150881,.465405,.281412,.155834,.469201,.280868,.160771,.472899,.280255,.165693,.476498,.279574,.170599,.479997,.278826,.17549,.483397,.278012,.180367,.486697,.277134,.185228,.489898,.276194,.190074,.493001,.275191,.194905,.496005,.274128,.199721,.498911,.273006,.20452,.501721,.271828,.209303,.504434,.270595,.214069,.507052,.269308,.218818,.509577,.267968,.223549,.512008,.26658,.228262,.514349,.265145,.232956,.516599,.263663,.237631,.518762,.262138,.242286,.520837,.260571,.246922,.522828,.258965,.251537,.524736,.257322,.25613,.526563,.255645,.260703,.528312,.253935,.265254,.529983,.252194,.269783,.531579,.250425,.27429,.533103,.248629,.278775,.534556,.246811,.283237,.535941,.244972,.287675,.53726,.243113,.292092,.538516,.241237,.296485,.539709,.239346,.300855,.540844,.237441,.305202,.541921,.235526,.309527,.542944,.233603,.313828,.543914,.231674,.318106,.544834,.229739,.322361,.545706,.227802,.326594,.546532,.225863,.330805,.547314,.223925,.334994,.548053,.221989,.339161,.548752,.220057,.343307,.549413,.21813,.347432,.550038,.21621,.351535,.550627,.214298,.355619,.551184,.212395,.359683,.55171,.210503,.363727,.552206,.208623,.367752,.552675,.206756,.371758,.553117,.204903,.375746,.553533,.203063,.379716,.553925,.201239,.38367,.554294,.19943,.387607,.554642,.197636,.391528,.554969,.19586,.395433,.555276,.1941,.399323,.555565,.192357,.403199,.555836,.190631,.407061,.556089,.188923,.41091,.556326,.187231,.414746,.556547,.185556,.41857,.556753,.183898,.422383,.556944,.182256,.426184,.55712,.180629,.429975,.557282,.179019,.433756,.55743,.177423,.437527,.557565,.175841,.44129,.557685,.174274,.445044,.557792,.172719,.448791,.557885,.171176,.45253,.557965,.169646,.456262,.55803,.168126,.459988,.558082,.166617,.463708,.558119,.165117,.467423,.558141,.163625,.471133,.558148,.162142,.474838,.55814,.160665,.47854,.558115,.159194,.482237,.558073,.157729,.485932,.558013,.15627,.489624,.557936,.154815,.493313,.55784,.153364,.497,.557724,.151918,.500685,.557587,.150476,.504369,.55743,.149039,.508051,.55725,.147607,.511733,.557049,.14618,.515413,.556823,.144759,.519093,.556572,.143343,.522773,.556295,.141935,.526453,.555991,.140536,.530132,.555659,.139147,.533812,.555298,.13777,.537492,.554906,.136408,.541173,.554483,.135066,.544853,.554029,.133743,.548535,.553541,.132444,.552216,.553018,.131172,.555899,.552459,.129933,.559582,.551864,.128729,.563265,.551229,.127568,.566949,.550556,.126453,.570633,.549841,.125394,.574318,.549086,.124395,.578002,.548287,.123463,.581687,.547445,.122606,.585371,.546557,.121831,.589055,.545623,.121148,.592739,.544641,.120565,.596422,.543611,.120092,.600104,.54253,.119738,.603785,.5414,.119512,.607464,.540218,.119423,.611141,.538982,.119483,.614817,.537692,.119699,.61849,.536347,.120081,.622161,.534946,.120638,.625828,.533488,.12138,.629492,.531973,.122312,.633153,.530398,.123444,.636809,.528763,.12478,.640461,.527068,.126326,.644107,.525311,.128087,.647749,.523491,.130067,.651384,.521608,.132268,.655014,.519661,.134692,.658636,.517649,.137339,.662252,.515571,.14021,.665859,.513427,.143303,.669459,.511215,.146616,.67305,.508936,.150148,.676631,.506589,.153894,.680203,.504172,.157851,.683765,.501686,.162016,.687316,.499129,.166383,.690856,.496502,.170948,.694384,.493803,.175707,.6979,.491033,.180653,.701402,.488189,.185783,.704891,.485273,.19109,.708366,.482284,.196571,.711827,.479221,.202219,.715272,.476084,.20803,.718701,.472873,.214,.722114,.469588,.220124,.725509,.466226,.226397,.728888,.462789,.232815,.732247,.459277,.239374,.735588,.455688,.24607,.73891,.452024,.252899,.742211,.448284,.259857,.745492,.444467,.266941,.748751,.440573,.274149,.751988,.436601,.281477,.755203,.432552,.288921,.758394,.428426,.296479,.761561,.424223,.304148,.764704,.419943,.311925,.767822,.415586,.319809,.770914,.411152,.327796,.77398,.40664,.335885,.777018,.402049,.344074,.780029,.397381,.35236,.783011,.392636,.360741,.785964,.387814,.369214,.788888,.382914,.377779,.791781,.377939,.386433,.794644,.372886,.395174,.797475,.367757,.404001,.800275,.362552,.412913,.803041,.357269,.421908,.805774,.35191,.430983,.808473,.346476,.440137,.811138,.340967,.449368,.813768,.335384,.458674,.816363,.329727,.468053,.818921,.323998,.477504,.821444,.318195,.487026,.823929,.312321,.496615,.826376,.306377,.506271,.828786,.300362,.515992,.831158,.294279,.525776,.833491,.288127,.535621,.835785,.281908,.545524,.838039,.275626,.555484,.840254,.269281,.565498,.84243,.262877,.575563,.844566,.256415,.585678,.846661,.249897,.595839,.848717,.243329,.606045,.850733,.236712,.616293,.852709,.230052,.626579,.854645,.223353,.636902,.856542,.21662,.647257,.8584,.209861,.657642,.860219,.203082,.668054,.861999,.196293,.678489,.863742,.189503,.688944,.865448,.182725,.699415,.867117,.175971,.709898,.868751,.169257,.720391,.87035,.162603,.730889,.871916,.156029,.741388,.873449,.149561,.751884,.874951,.143228,.762373,.876424,.137064,.772852,.877868,.131109,.783315,.879285,.125405,.79376,.880678,.120005,.804182,.882046,.114965,.814576,.883393,.110347,.82494,.88472,.106217,.83527,.886029,.102646,.845561,.887322,.099702,.85581,.888601,.097452,.866013,.889868,.095953,.876168,.891125,.09525,.886271,.892374,.095374,.89632,.893616,.096335,.906311,.894855,.098125,.916242,.896091,.100717,.926106,.89733,.104071,.935904,.89857,.108131,.945636,.899815,.112838,.9553,.901065,.118128,.964894,.902323,.123941,.974417,.90359,.130215,.983868,.904867,.136897,.993248,.906157,.143936]]}],eo=N.auxiliaries.assert,cb=[...ub,...lb];class db{constructor(){this._intermediaries=new nb,this._labelsChanged=!1,this._bufferResolver=new rb(this._intermediaries.topology),this._geometry=new Nt,this._renderer=new vl(this),this._renderer.geometry=this._geometry}applyInnerNodeColorMapping(a){const g=a.geometry,y=a.altered.geometry;if(eo(this._geometry.innerNodeColors!==void 0||y.any,"expected any alteration when inner-node color mapping is yet to be defined"),!y.any&&!a.altered.topology)return;eo(this._geometry!==void 0&&this._geometry.colorTable!==void 0,"expected color lookup-table to be specified (cached)");const v=this._intermediaries.topology;(a.altered.topology||y.emphasis.any)&&(this._geometry.innerNodeEmphases=qf.innerNodes(v,g.emphasis?new Set(g.emphasis.outline):void 0,g.emphasis?new Set(g.emphasis.highlight):void 0)),a.altered.topology&&(this._geometry.innerNodeColors=Hg.innerNodes(v,this._colorLUT.innerNodeColorOffset,this._colorLUT.innerNodeColorCount))}applyLeafNodeColorMapping(a){const g=a.geometry,y=a.altered.geometry;if(!y.any&&!a.altered.topology)return;if(eo(this._geometry!==void 0&&this._geometry.colorTable!==void 0,"expected color lookup-table to be specified (cached)"),!(g.leafLayer!==void 0)){this._geometry.leafNodeColors=jt.defaultLeafNodeColors(this._intermediaries.topology,this._colorLUT.leafColorOffset);return}if((a.altered.topology||y.emphasis.any)&&(this._geometry.leafNodeEmphases=qf.leafNodes(this._intermediaries.topology,g.emphasis?new Set(g.emphasis.outline):void 0,g.emphasis?new Set(g.emphasis.highlight):void 0)),!y.colors)return;const t=this._bufferResolver.resolve(g.leafLayer.colors,a,this._normalization,this._bufferResolver.constBufferCallback(0));this._intermediaries.aggregatedColors=t;const i=St.range(t),n=this._colorLUT.leafColorCount,r=this._colorLUT.leafColorOffset;this._geometry.leafNodeColors=jt.createLeafNodeColors(this._intermediaries.topology,t,r,n,i),this._geometry.altered.alter("leafNodeColors")}createLayout(a,g,y,v,t,i){return gs.createLayout(a,g,y.layout,v,t,i)}updateLabels(){const a=this._intermediaries.innerNodeLabels,g=this._intermediaries.leafLabels;if(this._geometry===void 0||!this._geometry.valid||g===void 0||a===void 0)return;let y=!1;if(this._labelsChanged&&(this._renderer.updateLabels(a,g),this._renderer.updatePoints(g),y=!0),this._renderer.camera.altered||this._labelsChanged){const v=tb.adaptPositionToPreventOverlapGreedy(g,this._renderer.camera);v.visibility||v.positioning?(this._renderer.updateLeafLabelBackgrounds(g),this._renderer.updateLeafLabelPass()):this._renderer.frameSizeAltered()?this._renderer.updateLeafLabelBackgrounds(g):y&&this._renderer.updateLeafLabelBackgrounds(g),v.visibility&&this._renderer.updatePoints(g)}this._labelsChanged&&(this._labelsChanged=!1)}update(){if(this._configuration===void 0||this._configuration.topology===void 0)return this._geometry.initialized&&this._geometry.uninitialize(),!0;const a=this._configuration,g=a.altered;if(!g.any)return!1;eo(a.topology!==void 0,"Valid topology expected");let y=g.layout.sort;const v=this._intermediaries.topology;let t;g.topology&&(v.initialize(a.topology.format,a.topology.semantics,a.topology.edges),this._intermediaries.aggregatedWeights=void 0,this._intermediaries.aggregatedHeights=void 0,this._intermediaries.aggregatedColors=void 0,this._intermediaries.accessorySpaces=void 0,this._intermediaries.labelRects=void 0,this._intermediaries.labelPaddingSpaces=void 0,t=void 0,this._geometry.initialized&&this._geometry.uninitialize(),this._geometry.initialize(v),y=!0),this._normalization=St.createNormalization(v,a);let i=this._intermediaries.aggregatedWeights;(i===void 0||g.layout.weight)&&(i=this._intermediaries.aggregatedWeights=this._bufferResolver.resolve(a.layout.weight,a,this._normalization),t=void 0,y=!0),y&&(bs.sortNodes(v,this._normalization,i,a),t=void 0);let n=this._intermediaries.accessorySpaces,r=this._intermediaries.labelRects,c=this._intermediaries.labelPaddingSpaces;if((t===void 0||g.layout.any)&&(n=this._intermediaries.accessorySpaces=new Array(v.numberOfInnerNodes),r=this._intermediaries.labelRects=new Array(v.numberOfInnerNodes),c=this._intermediaries.labelPaddingSpaces=new Array(v.numberOfInnerNodes),t=this.createLayout(v,i,a,n,r,c),this._geometry.innerNodeLayouts=void 0,this._geometry.leafNodeLayouts=void 0),this._geometry.innerNodeIndices===void 0&&(this._geometry.innerNodeIndices=Wf.innerNodes(v)),this._geometry.leafNodeIndices===void 0&&(this._geometry.leafNodeIndices=Wf.leafNodes(v)),this._geometry.innerNodeLayouts===void 0&&(this._geometry.innerNodeLayouts=jt.createParentLayoutBuffer(v,t,this._configuration.geometry)),this._geometry.leafNodeLayouts===void 0&&(this._geometry.leafNodeLayouts=jt.createLeafLayoutBuffer(v,t,this._configuration.geometry)),this._geometry.leafNodeAreaScales===void 0){const o=this._bufferResolver.resolve(this._configuration.geometry.leafLayer.areaScale,a,this._normalization,this._bufferResolver.constBufferCallback(1));this._geometry.leafNodeAreaScales=jt.createLeafAreaScalesBuffer(v,o)}const f=(o,m)=>{switch(m){case N.Color.Space.CMYK:{const _=o.fill(1,o.length,5);return new N.Color().fromCMYK(_[0],_[1],_[2],_[3],_[4])}case N.Color.Space.LAB:{const _=o.fill(1,o.length,4);return new N.Color().fromLAB(_[0],_[1],_[2],_[3])}case N.Color.Space.HSL:{const _=o.fill(1,o.length,4);return new N.Color().fromHSL(_[0],_[1],_[2],_[3])}case"hex":return new N.Color().fromHex(o);default:case N.Color.Space.RGB:{const _=o.fill(1,o.length,4);return new N.Color().fromRGB(_[0],_[1],_[2],_[3])}}},d=(o,m)=>{const _=new Array(o.length);for(let p=0;p<_.length;++p)_[p]=f(o[p],m);return _},h=(o,m,_)=>{if(o===void 0||m===void 0)return _;const p=o.find(b=>b.identifier===m.split(":")[1]);if(p===void 0)return _;if(br.isColorArray(p))return p.value!==void 0?f(p.value,p.colorspace):d(p.values,p.colorspace);if(br.isColorPreset(p)){const b=cb.find(w=>w.identifier==p.preset);if(!b)return _;const x=p.steps&&b.colors.find(w=>w.length===p.steps*3)||b.colors[0];return N.ColorScale.fromArray(x,b.format,x.length/3,void 0).colors}else return _};if(a.altered.colors){const o=h(a.colors,a.geometry.emphasis?a.geometry.emphasis.color:void 0,new N.Color),m=h(a.colors,a.geometry.auxiliary,new N.Color),_=h(a.colors,a.geometry.parentLayer.colorMap,[new N.Color,new N.Color]),p=h(a.colors,a.geometry.leafLayer.colorMap,[new N.Color,new N.Color]);this._colorLUT=new ib(o,m,_,p),(!this._geometry.colorTable||this._geometry.colorTable.length!==this._colorLUT.bits.length)&&(this._geometry.altered.alter("colorTableLength"),this._renderer.invalidate()),this._geometry.colorTable=this._colorLUT.bits}this.applyInnerNodeColorMapping(a),this.applyLeafNodeColorMapping(a);let s=this._geometry.heightScale;if(s===void 0||g.geometry.heightScale){const o=a.geometry.heightScale;o!==void 0&&o in wr.HeightScaleApproach?s=this._geometry.heightScale=wr.heightScale(v,o):o!==void 0?s=this._geometry.heightScale=o:s=this._geometry.heightScale=wr.heightScale(v,wr.HeightScaleApproach.SomethingInverseSqrt),this._geometry.altered.alter("heightScale")}a.altered.geometry.outlineWidth&&(this._geometry.outlineWidth=a.geometry.outlineWidth,this._geometry.altered.alter("outlineWidth")),a.geometry.emphasis&&a.altered.geometry.emphasis.outlineWidth&&(this._geometry.emphasisOutlineWidth=a.geometry.emphasis.outlineWidth,this._geometry.altered.alter("emphasisOutlineWidth")),this._geometry.showRoot=a.geometry.parentLayer.showRoot;let u;if(a.geometry.leafLayer!==void 0){if(g.geometry.heights||g.buffers||g.bufferViews||u===void 0){const o=a.geometry.leafLayer;u=this._bufferResolver.resolve(o.height!==void 0?o.height:"",a,this._normalization,this._bufferResolver.constBufferCallback()),this._intermediaries.aggregatedHeights=u;const m=jt.createLayerHeightBuffer(v,u,void 0,this._configuration.geometry);this._geometry.leafNodeHeights=m,this._geometry.altered.alter("leafNodeHeights")}}else u=void 0,this._geometry.leafNodeHeights=jt.createEmptyLayerHeightBuffer(v);if((this._intermediaries.leafLabels===void 0||this._intermediaries.innerNodeLabels===void 0||a.altered.labels)&&a.labels!==void 0&&a.labels.names!==void 0){let o=new Map;if(typeof a.labels.names=="string"){const m=St.create(v,this._normalization,a.labels.names,a);Object.keys(m).forEach(_=>{const p=parseInt(_,10);o.set(p,m[p])})}else o=a.labels.names;if(o!==void 0&&this._intermediaries.aggregatedHeights&&this._intermediaries.aggregatedWeights&&this._intermediaries.aggregatedColors){const m=vt.createLabelSelection(v,this._intermediaries.aggregatedWeights,this._intermediaries.aggregatedHeights,this._intermediaries.aggregatedColors,new Set,a.labels.innerNodeLayerRange,a.labels.numTopInnerNodes,a.labels.numTopWeightNodes,a.labels.numTopHeightNodes,a.labels.numTopColorNodes);this._intermediaries.leafLabels=vt.fillLeafLabelArray(v,o,m,this._geometry.heightScale,this._geometry.leafNodeLayouts,this._geometry.leafNodeHeights),this._intermediaries.innerNodeLabels=vt.fillInnerNodeLabelArrayOnAccessory(v,o,m,this._intermediaries.accessorySpaces),this._labelsChanged=!0,this._renderer.invalidate()}}return a.altered.reset(),!0}prepare(){this.updateLabels()}get renderer(){return this._renderer}get configuration(){return this._configuration}set configuration(a){this._configuration=a}}function fb(T,a,g=new N.Color().fromHex("fafafa")){const y=T instanceof HTMLCanvasElement?T:document.getElementById(T),v=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);navigator.appVersion.indexOf("Mac")!==-1&&v&&(y.dataset.msqrdP="no-WEBGL_draw_buffers",console.warn("detected Chrome on MacOS, disabling WEBGL_draw_buffers"));const t=new N.Canvas(y,{alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1});return new N.viewer.EventBlocker(t.element).block("contextmenu"),t.clearColor=g,t.framePrecision=N.Wizard.Precision.byte,t.controller.multiFrameNumber=64,t.context.gl.clearColor(g.r,g.g,g.b,g.a),t.context.gl.clear(t.context.gl.COLOR_BUFFER_BIT),t}typeof LOG_VERBOSITY_THRESHOLD<"u"&&N.auxiliaries.logVerbosity(LOG_VERBOSITY_THRESHOLD);typeof DISABLE_ASSERTIONS<"u"&&N.auxiliaries.assertions(!DISABLE_ASSERTIONS);var $_={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(T,a){(function(g,y){T.exports=y()})(H,function g(){var y=typeof self<"u"?self:typeof window<"u"?window:y!==void 0?y:{},v=!y.document&&!!y.postMessage,t=y.IS_PAPA_WORKER||!1,i={},n=0,r={parse:function(R,O){var I=(O=O||{}).dynamicTyping||!1;if(S(I)&&(O.dynamicTypingFunction=I,I={}),O.dynamicTyping=I,O.transform=!!S(O.transform)&&O.transform,O.worker&&r.WORKERS_SUPPORTED){var D=function(){if(!r.WORKERS_SUPPORTED)return!1;var k=(Z=y.URL||y.webkitURL||null,K=g.toString(),r.BLOB_URL||(r.BLOB_URL=Z.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",K,")();"],{type:"text/javascript"})))),G=new y.Worker(k),Z,K;return G.onmessage=p,G.id=n++,i[G.id]=G}();return D.userStep=O.step,D.userChunk=O.chunk,D.userComplete=O.complete,D.userError=O.error,O.step=S(O.step),O.chunk=S(O.chunk),O.complete=S(O.complete),O.error=S(O.error),delete O.worker,void D.postMessage({input:R,config:O,workerId:D.id})}var j=null;return r.NODE_STREAM_INPUT,typeof R=="string"?(R=function(k){return k.charCodeAt(0)===65279?k.slice(1):k}(R),j=O.download?new d(O):new s(O)):R.readable===!0&&S(R.read)&&S(R.on)?j=new u(O):(y.File&&R instanceof File||R instanceof Object)&&(j=new h(O)),j.stream(R)},unparse:function(R,O){var I=!1,D=!0,j=",",k=`\r
`,G='"',Z=G+G,K=!1,Y=null,re=!1;(function(){if(typeof O=="object"){if(typeof O.delimiter!="string"||r.BAD_DELIMITERS.filter(function(ee){return O.delimiter.indexOf(ee)!==-1}).length||(j=O.delimiter),(typeof O.quotes=="boolean"||typeof O.quotes=="function"||Array.isArray(O.quotes))&&(I=O.quotes),typeof O.skipEmptyLines!="boolean"&&typeof O.skipEmptyLines!="string"||(K=O.skipEmptyLines),typeof O.newline=="string"&&(k=O.newline),typeof O.quoteChar=="string"&&(G=O.quoteChar),typeof O.header=="boolean"&&(D=O.header),Array.isArray(O.columns)){if(O.columns.length===0)throw new Error("Option columns is empty");Y=O.columns}O.escapeChar!==void 0&&(Z=O.escapeChar+G),(typeof O.escapeFormulae=="boolean"||O.escapeFormulae instanceof RegExp)&&(re=O.escapeFormulae instanceof RegExp?O.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Q=new RegExp(m(G),"g");if(typeof R=="string"&&(R=JSON.parse(R)),Array.isArray(R)){if(!R.length||Array.isArray(R[0]))return ae(null,R,K);if(typeof R[0]=="object")return ae(Y||Object.keys(R[0]),R,K)}else if(typeof R=="object")return typeof R.data=="string"&&(R.data=JSON.parse(R.data)),Array.isArray(R.data)&&(R.fields||(R.fields=R.meta&&R.meta.fields||Y),R.fields||(R.fields=Array.isArray(R.data[0])?R.fields:typeof R.data[0]=="object"?Object.keys(R.data[0]):[]),Array.isArray(R.data[0])||typeof R.data[0]=="object"||(R.data=[R.data])),ae(R.fields||[],R.data||[],K);throw new Error("Unable to serialize unrecognized input");function ae(ee,le,ge){var ve="";typeof ee=="string"&&(ee=JSON.parse(ee)),typeof le=="string"&&(le=JSON.parse(le));var ne=Array.isArray(ee)&&0<ee.length,be=!Array.isArray(le[0]);if(ne&&D){for(var Te=0;Te<ee.length;Te++)0<Te&&(ve+=j),ve+=se(ee[Te],Te);0<le.length&&(ve+=k)}for(var oe=0;oe<le.length;oe++){var me=ne?ee.length:le[oe].length,Ee=!1,Oe=ne?Object.keys(le[oe]).length===0:le[oe].length===0;if(ge&&!ne&&(Ee=ge==="greedy"?le[oe].join("").trim()==="":le[oe].length===1&&le[oe][0].length===0),ge==="greedy"&&ne){for(var xe=[],ke=0;ke<me;ke++){var Le=be?ee[ke]:ke;xe.push(le[oe][Le])}Ee=xe.join("").trim()===""}if(!Ee){for(var Re=0;Re<me;Re++){0<Re&&!Oe&&(ve+=j);var Ye=ne&&be?ee[Re]:Re;ve+=se(le[oe][Ye],Re)}oe<le.length-1&&(!ge||0<me&&!Oe)&&(ve+=k)}}return ve}function se(ee,le){if(ee==null)return"";if(ee.constructor===Date)return JSON.stringify(ee).slice(1,25);var ge=!1;re&&typeof ee=="string"&&re.test(ee)&&(ee="'"+ee,ge=!0);var ve=ee.toString().replace(Q,Z);return(ge=ge||I===!0||typeof I=="function"&&I(ee,le)||Array.isArray(I)&&I[le]||function(ne,be){for(var Te=0;Te<be.length;Te++)if(-1<ne.indexOf(be[Te]))return!0;return!1}(ve,r.BAD_DELIMITERS)||-1<ve.indexOf(j)||ve.charAt(0)===" "||ve.charAt(ve.length-1)===" ")?G+ve+G:ve}}};if(r.RECORD_SEP="",r.UNIT_SEP="",r.BYTE_ORDER_MARK="\uFEFF",r.BAD_DELIMITERS=["\r",`
`,'"',r.BYTE_ORDER_MARK],r.WORKERS_SUPPORTED=!v&&!!y.Worker,r.NODE_STREAM_INPUT=1,r.LocalChunkSize=10485760,r.RemoteChunkSize=5242880,r.DefaultDelimiter=",",r.Parser=_,r.ParserHandle=o,r.NetworkStreamer=d,r.FileStreamer=h,r.StringStreamer=s,r.ReadableStreamStreamer=u,y.jQuery){var c=y.jQuery;c.fn.parse=function(R){var O=R.config||{},I=[];return this.each(function(k){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&y.FileReader)||!this.files||this.files.length===0)return!0;for(var G=0;G<this.files.length;G++)I.push({file:this.files[G],inputElem:this,instanceConfig:c.extend({},O)})}),D(),this;function D(){if(I.length!==0){var k,G,Z,K,Y=I[0];if(S(R.before)){var re=R.before(Y.file,Y.inputElem);if(typeof re=="object"){if(re.action==="abort")return k="AbortError",G=Y.file,Z=Y.inputElem,K=re.reason,void(S(R.error)&&R.error({name:k},G,Z,K));if(re.action==="skip")return void j();typeof re.config=="object"&&(Y.instanceConfig=c.extend(Y.instanceConfig,re.config))}else if(re==="skip")return void j()}var Q=Y.instanceConfig.complete;Y.instanceConfig.complete=function(ae){S(Q)&&Q(ae,Y.file,Y.inputElem),j()},r.parse(Y.file,Y.instanceConfig)}else S(R.complete)&&R.complete()}function j(){I.splice(0,1),D()}}}function f(R){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(O){var I=E(O);I.chunkSize=parseInt(I.chunkSize),O.step||O.chunk||(I.chunkSize=null),this._handle=new o(I),(this._handle.streamer=this)._config=I}).call(this,R),this.parseChunk=function(O,I){if(this.isFirstChunk&&S(this._config.beforeFirstChunk)){var D=this._config.beforeFirstChunk(O);D!==void 0&&(O=D)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+O;this._partialLine="";var k=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var G=k.meta.cursor;this._finished||(this._partialLine=j.substring(G-this._baseIndex),this._baseIndex=G),k&&k.data&&(this._rowCount+=k.data.length);var Z=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(t)y.postMessage({results:k,workerId:r.WORKER_ID,finished:Z});else if(S(this._config.chunk)&&!I){if(this._config.chunk(k,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);k=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(k.data),this._completeResults.errors=this._completeResults.errors.concat(k.errors),this._completeResults.meta=k.meta),this._completed||!Z||!S(this._config.complete)||k&&k.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Z||k&&k.meta.paused||this._nextChunk(),k}this._halted=!0},this._sendError=function(O){S(this._config.error)?this._config.error(O):t&&this._config.error&&y.postMessage({workerId:r.WORKER_ID,error:O,finished:!1})}}function d(R){var O;(R=R||{}).chunkSize||(R.chunkSize=r.RemoteChunkSize),f.call(this,R),this._nextChunk=v?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(O=new XMLHttpRequest,this._config.withCredentials&&(O.withCredentials=this._config.withCredentials),v||(O.onload=w(this._chunkLoaded,this),O.onerror=w(this._chunkError,this)),O.open(this._config.downloadRequestBody?"POST":"GET",this._input,!v),this._config.downloadRequestHeaders){var I=this._config.downloadRequestHeaders;for(var D in I)O.setRequestHeader(D,I[D])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;O.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{O.send(this._config.downloadRequestBody)}catch(k){this._chunkError(k.message)}v&&O.status===0&&this._chunkError()}},this._chunkLoaded=function(){O.readyState===4&&(O.status<200||400<=O.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:O.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(I){var D=I.getResponseHeader("Content-Range");return D===null?-1:parseInt(D.substring(D.lastIndexOf("/")+1))}(O),this.parseChunk(O.responseText)))},this._chunkError=function(I){var D=O.statusText||I;this._sendError(new Error(D))}}function h(R){var O,I;(R=R||{}).chunkSize||(R.chunkSize=r.LocalChunkSize),f.call(this,R);var D=typeof FileReader<"u";this.stream=function(j){this._input=j,I=j.slice||j.webkitSlice||j.mozSlice,D?((O=new FileReader).onload=w(this._chunkLoaded,this),O.onerror=w(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var k=Math.min(this._start+this._config.chunkSize,this._input.size);j=I.call(j,this._start,k)}var G=O.readAsText(j,this._config.encoding);D||this._chunkLoaded({target:{result:G}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(O.error)}}function s(R){var O;f.call(this,R=R||{}),this.stream=function(I){return O=I,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var I,D=this._config.chunkSize;return D?(I=O.substring(0,D),O=O.substring(D)):(I=O,O=""),this._finished=!O,this.parseChunk(I)}}}function u(R){f.call(this,R=R||{});var O=[],I=!0,D=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){D&&O.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):I=!0},this._streamData=w(function(j){try{O.push(typeof j=="string"?j:j.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(k){this._streamError(k)}},this),this._streamError=w(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=w(function(){this._streamCleanUp(),D=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function o(R){var O,I,D,j=Math.pow(2,53),k=-j,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Z=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,Y=0,re=0,Q=!1,ae=!1,se=[],ee={data:[],errors:[],meta:{}};if(S(R.step)){var le=R.step;R.step=function(oe){if(ee=oe,ne())ve();else{if(ve(),ee.data.length===0)return;Y+=oe.data.length,R.preview&&Y>R.preview?I.abort():(ee.data=ee.data[0],le(ee,K))}}}function ge(oe){return R.skipEmptyLines==="greedy"?oe.join("").trim()==="":oe.length===1&&oe[0].length===0}function ve(){return ee&&D&&(Te("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+r.DefaultDelimiter+"'"),D=!1),R.skipEmptyLines&&(ee.data=ee.data.filter(function(oe){return!ge(oe)})),ne()&&function(){if(!ee)return;function oe(Ee,Oe){S(R.transformHeader)&&(Ee=R.transformHeader(Ee,Oe)),se.push(Ee)}if(Array.isArray(ee.data[0])){for(var me=0;ne()&&me<ee.data.length;me++)ee.data[me].forEach(oe);ee.data.splice(0,1)}else ee.data.forEach(oe)}(),function(){if(!ee||!R.header&&!R.dynamicTyping&&!R.transform)return ee;function oe(Ee,Oe){var xe,ke=R.header?{}:[];for(xe=0;xe<Ee.length;xe++){var Le=xe,Re=Ee[xe];R.header&&(Le=xe>=se.length?"__parsed_extra":se[xe]),R.transform&&(Re=R.transform(Re,Le)),Re=be(Le,Re),Le==="__parsed_extra"?(ke[Le]=ke[Le]||[],ke[Le].push(Re)):ke[Le]=Re}return R.header&&(xe>se.length?Te("FieldMismatch","TooManyFields","Too many fields: expected "+se.length+" fields but parsed "+xe,re+Oe):xe<se.length&&Te("FieldMismatch","TooFewFields","Too few fields: expected "+se.length+" fields but parsed "+xe,re+Oe)),ke}var me=1;return!ee.data.length||Array.isArray(ee.data[0])?(ee.data=ee.data.map(oe),me=ee.data.length):ee.data=oe(ee.data,0),R.header&&ee.meta&&(ee.meta.fields=se),re+=me,ee}()}function ne(){return R.header&&se.length===0}function be(oe,me){return Ee=oe,R.dynamicTypingFunction&&R.dynamicTyping[Ee]===void 0&&(R.dynamicTyping[Ee]=R.dynamicTypingFunction(Ee)),(R.dynamicTyping[Ee]||R.dynamicTyping)===!0?me==="true"||me==="TRUE"||me!=="false"&&me!=="FALSE"&&(function(Oe){if(G.test(Oe)){var xe=parseFloat(Oe);if(k<xe&&xe<j)return!0}return!1}(me)?parseFloat(me):Z.test(me)?new Date(me):me===""?null:me):me;var Ee}function Te(oe,me,Ee,Oe){var xe={type:oe,code:me,message:Ee};Oe!==void 0&&(xe.row=Oe),ee.errors.push(xe)}this.parse=function(oe,me,Ee){var Oe=R.quoteChar||'"';if(R.newline||(R.newline=function(Le,Re){Le=Le.substring(0,1048576);var Ye=new RegExp(m(Re)+"([^]*?)"+m(Re),"gm"),qe=(Le=Le.replace(Ye,"")).split("\r"),rt=Le.split(`
`),ht=1<rt.length&&rt[0].length<qe[0].length;if(qe.length===1||ht)return`
`;for(var $e=0,Me=0;Me<qe.length;Me++)qe[Me][0]===`
`&&$e++;return $e>=qe.length/2?`\r
`:"\r"}(oe,Oe)),D=!1,R.delimiter)S(R.delimiter)&&(R.delimiter=R.delimiter(oe),ee.meta.delimiter=R.delimiter);else{var xe=function(Le,Re,Ye,qe,rt){var ht,$e,Me,Be;rt=rt||[",","	","|",";",r.RECORD_SEP,r.UNIT_SEP];for(var yt=0;yt<rt.length;yt++){var we=rt[yt],At=0,dt=0,Et=0;Me=void 0;for(var ft=new _({comments:qe,delimiter:we,newline:Re,preview:10}).parse(Le),mt=0;mt<ft.data.length;mt++)if(Ye&&ge(ft.data[mt]))Et++;else{var gt=ft.data[mt].length;dt+=gt,Me!==void 0?0<gt&&(At+=Math.abs(gt-Me),Me=gt):Me=gt}0<ft.data.length&&(dt/=ft.data.length-Et),($e===void 0||At<=$e)&&(Be===void 0||Be<dt)&&1.99<dt&&($e=At,ht=we,Be=dt)}return{successful:!!(R.delimiter=ht),bestDelimiter:ht}}(oe,R.newline,R.skipEmptyLines,R.comments,R.delimitersToGuess);xe.successful?R.delimiter=xe.bestDelimiter:(D=!0,R.delimiter=r.DefaultDelimiter),ee.meta.delimiter=R.delimiter}var ke=E(R);return R.preview&&R.header&&ke.preview++,O=oe,I=new _(ke),ee=I.parse(O,me,Ee),ve(),Q?{meta:{paused:!0}}:ee||{meta:{paused:!1}}},this.paused=function(){return Q},this.pause=function(){Q=!0,I.abort(),O=S(R.chunk)?"":O.substring(I.getCharIndex())},this.resume=function(){K.streamer._halted?(Q=!1,K.streamer.parseChunk(O,!0)):setTimeout(K.resume,3)},this.aborted=function(){return ae},this.abort=function(){ae=!0,I.abort(),ee.meta.aborted=!0,S(R.complete)&&R.complete(ee),O=""}}function m(R){return R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(R){var O,I=(R=R||{}).delimiter,D=R.newline,j=R.comments,k=R.step,G=R.preview,Z=R.fastMode,K=O=R.quoteChar===void 0||R.quoteChar===null?'"':R.quoteChar;if(R.escapeChar!==void 0&&(K=R.escapeChar),(typeof I!="string"||-1<r.BAD_DELIMITERS.indexOf(I))&&(I=","),j===I)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<r.BAD_DELIMITERS.indexOf(j))&&(j=!1),D!==`
`&&D!=="\r"&&D!==`\r
`&&(D=`
`);var Y=0,re=!1;this.parse=function(Q,ae,se){if(typeof Q!="string")throw new Error("Input must be a string");var ee=Q.length,le=I.length,ge=D.length,ve=j.length,ne=S(k),be=[],Te=[],oe=[],me=Y=0;if(!Q)return tt();if(R.header&&!ae){var Ee=Q.split(D)[0].split(I),Oe=[],xe={},ke=!1;for(var Le in Ee){var Re=Ee[Le];S(R.transformHeader)&&(Re=R.transformHeader(Re,Le));var Ye=Re,qe=xe[Re]||0;for(0<qe&&(ke=!0,Ye=Re+"_"+qe),xe[Re]=qe+1;Oe.includes(Ye);)Ye=Ye+"_"+qe;Oe.push(Ye)}if(ke){var rt=Q.split(D);rt[0]=Oe.join(I),Q=rt.join(D)}}if(Z||Z!==!1&&Q.indexOf(O)===-1){for(var ht=Q.split(D),$e=0;$e<ht.length;$e++){if(oe=ht[$e],Y+=oe.length,$e!==ht.length-1)Y+=D.length;else if(se)return tt();if(!j||oe.substring(0,ve)!==j){if(ne){if(be=[],Et(oe.split(I)),zt(),re)return tt()}else Et(oe.split(I));if(G&&G<=$e)return be=be.slice(0,G),tt(!0)}}return tt()}for(var Me=Q.indexOf(I,Y),Be=Q.indexOf(D,Y),yt=new RegExp(m(K)+m(O),"g"),we=Q.indexOf(O,Y);;)if(Q[Y]!==O)if(j&&oe.length===0&&Q.substring(Y,Y+ve)===j){if(Be===-1)return tt();Y=Be+ge,Be=Q.indexOf(D,Y),Me=Q.indexOf(I,Y)}else if(Me!==-1&&(Me<Be||Be===-1))oe.push(Q.substring(Y,Me)),Y=Me+le,Me=Q.indexOf(I,Y);else{if(Be===-1)break;if(oe.push(Q.substring(Y,Be)),gt(Be+ge),ne&&(zt(),re))return tt();if(G&&be.length>=G)return tt(!0)}else for(we=Y,Y++;;){if((we=Q.indexOf(O,we+1))===-1)return se||Te.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:be.length,index:Y}),mt();if(we===ee-1)return mt(Q.substring(Y,we).replace(yt,O));if(O!==K||Q[we+1]!==K){if(O===K||we===0||Q[we-1]!==K){Me!==-1&&Me<we+1&&(Me=Q.indexOf(I,we+1)),Be!==-1&&Be<we+1&&(Be=Q.indexOf(D,we+1));var At=ft(Be===-1?Me:Math.min(Me,Be));if(Q.substr(we+1+At,le)===I){oe.push(Q.substring(Y,we).replace(yt,O)),Q[Y=we+1+At+le]!==O&&(we=Q.indexOf(O,Y)),Me=Q.indexOf(I,Y),Be=Q.indexOf(D,Y);break}var dt=ft(Be);if(Q.substring(we+1+dt,we+1+dt+ge)===D){if(oe.push(Q.substring(Y,we).replace(yt,O)),gt(we+1+dt+ge),Me=Q.indexOf(I,Y),we=Q.indexOf(O,Y),ne&&(zt(),re))return tt();if(G&&be.length>=G)return tt(!0);break}Te.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:be.length,index:Y}),we++}}else we++}return mt();function Et(Qe){be.push(Qe),me=Y}function ft(Qe){var Rt=0;if(Qe!==-1){var Gt=Q.substring(we+1,Qe);Gt&&Gt.trim()===""&&(Rt=Gt.length)}return Rt}function mt(Qe){return se||(Qe===void 0&&(Qe=Q.substring(Y)),oe.push(Qe),Y=ee,Et(oe),ne&&zt()),tt()}function gt(Qe){Y=Qe,Et(oe),oe=[],Be=Q.indexOf(D,Y)}function tt(Qe){return{data:be,errors:Te,meta:{delimiter:I,linebreak:D,aborted:re,truncated:!!Qe,cursor:me+(ae||0)}}}function zt(){k(tt()),be=[],Te=[]}},this.abort=function(){re=!0},this.getCharIndex=function(){return Y}}function p(R){var O=R.data,I=i[O.workerId],D=!1;if(O.error)I.userError(O.error,O.file);else if(O.results&&O.results.data){var j={abort:function(){D=!0,b(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(S(I.userStep)){for(var k=0;k<O.results.data.length&&(I.userStep({data:O.results.data[k],errors:O.results.errors,meta:O.results.meta},j),!D);k++);delete O.results}else S(I.userChunk)&&(I.userChunk(O.results,j,O.file),delete O.results)}O.finished&&!D&&b(O.workerId,O.results)}function b(R,O){var I=i[R];S(I.userComplete)&&I.userComplete(O),I.terminate(),delete i[R]}function x(){throw new Error("Not implemented.")}function E(R){if(typeof R!="object"||R===null)return R;var O=Array.isArray(R)?[]:{};for(var I in R)O[I]=E(R[I]);return O}function w(R,O){return function(){R.apply(O,arguments)}}function S(R){return typeof R=="function"}return t&&(y.onmessage=function(R){var O=R.data;if(r.WORKER_ID===void 0&&O&&(r.WORKER_ID=O.workerId),typeof O.input=="string")y.postMessage({workerId:r.WORKER_ID,results:r.parse(O.input,O.config),finished:!0});else if(y.File&&O.input instanceof File||O.input instanceof Object){var I=r.parse(O.input,O.config);I&&y.postMessage({workerId:r.WORKER_ID,results:I,finished:!0})}}),(d.prototype=Object.create(f.prototype)).constructor=d,(h.prototype=Object.create(f.prototype)).constructor=h,(s.prototype=Object.create(s.prototype)).constructor=s,(u.prototype=Object.create(f.prototype)).constructor=u,r})})($_);var _b=$_.exports;class pb extends N.Initializable{expose(){}}export{br as C,pb as E,bs as N,bt as T,db as V,hb as g,fb as i,_b as p,N as w};
